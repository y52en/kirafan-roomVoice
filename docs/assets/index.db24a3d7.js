import{H as w,E as k}from"./vendor.ae175ca4.js";const A=function(){const u=document.createElement("link").relList;if(u&&u.supports&&u.supports("modulepreload"))return;for(const t of document.querySelectorAll('link[rel="modulepreload"]'))r(t);new MutationObserver(t=>{for(const o of t)if(o.type==="childList")for(const s of o.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&r(s)}).observe(document,{childList:!0,subtree:!0});function a(t){const o={};return t.integrity&&(o.integrity=t.integrity),t.referrerpolicy&&(o.referrerPolicy=t.referrerpolicy),t.crossorigin==="use-credentials"?o.credentials="include":t.crossorigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function r(t){if(t.ep)return;t.ep=!0;const o=a(t);fetch(t.href,o)}};A();(async()=>{const i=fetch("https://database.kirafan.cn/database/NamedList.json").then(e=>e.json()),u=fetch("https://database.kirafan.cn/database/RoomObjectList.json").then(e=>e.json()),a=fetch("https://database.kirafan.cn/database/TweetList.json").then(e=>e.json()),[r,t,o]=await Promise.all([i,u,a]),s=e=>r.find(c=>c.m_NamedType===e).m_FullName,m=o.filter(e=>e.m_ID.toString().length===9||e.m_ID.toString().match(/^(21|22)\d{3}$/)).map(e=>{const c=(()=>{const n=e.m_ID.toString();if(n.length===9)return[0,"\u7279\u5B9A\u306E\u5BB6\u5177"];if(n.match(/^21\d{3}$/))return[1,"\u5E73\u65E5"];if(n.match(/^22\d{3}$/))return[2,"\u571F\u65E5"];throw new Error("unknown type")})();return[s(e.m_NamedType),c[1],e.m_Text,t.filter(n=>n.m_ObjEventArgs[1]===e.m_ID).map(n=>n.m_Name).join(`
`),e.m_LimitedCharaId.length>0?"\u9650\u5B9A\u30AD\u30E3\u30E9":""]}),y=["\u30AD\u30E3\u30E9\u540D","\u65B9\u6CD5","\u30BB\u30EA\u30D5","\u5BFE\u5FDC\u3059\u308B\u5BB6\u5177","\u9650\u5B9A\u30AD\u30E3\u30E9\u306E\u307F\u306E\u30BB\u30EA\u30D5"],E=[...m],f=document.getElementById("table");if(!f)throw new Error("container not found");document.querySelectorAll(".loading").forEach(e=>e.classList.add("display-none")),document.querySelectorAll(".loaded").forEach(e=>e.classList.remove("display-none")),new w(f,{data:E,colHeaders:y,columns:[{type:"text"},{type:"text"},{type:"text"},{type:"text"},{type:"text"}],colWidths:[100,100,200,200,150],rowHeaders:!0,width:"auto",filters:!0,dropdownMenu:["filter_by_condition","filter_action_bar","filter_by_value"],contextMenu:!0,manualRowMove:!0,licenseKey:"non-commercial-and-evaluation"}),document.querySelectorAll(".download_xlsx").forEach(async e=>e.addEventListener("click",async c=>{const n=new k.Workbook;n.addWorksheet("sheet1");const l=n.getWorksheet("sheet1");l.columns=[{header:"\u30AD\u30E3\u30E9\u540D",key:"0"},{header:"\u65B9\u6CD5",key:"1"},{header:"\u30BB\u30EA\u30D5",key:"2"},{header:"\u5BFE\u5FDC\u3059\u308B\u5BB6\u5177",key:"3"},{header:"\u9650\u5B9A\u30AD\u30E3\u30E9\u306E\u307F\u306E\u30BB\u30EA\u30D5",key:"4"}];const h=m.map((d,B)=>{if(B===0)return;const p={};return d.forEach((L,g)=>p[String(g)]=L),p}).filter(d=>d);l.addRows(h),l.autoFilter="A1:E"+h.length;const _=await n.xlsx.writeBuffer(),b=new Blob([_],{type:"application/octet-binary"});D(b,"RoomVoice.xlsx")}))})();function D(i,u="img.png"){const a=URL.createObjectURL(i),r=document.createElement("a");r.href=a,r.download=u,r.click(),URL.revokeObjectURL(a)}
