var At=typeof globalThis!="undefined"?globalThis:typeof window!="undefined"?window:typeof global!="undefined"?global:typeof self!="undefined"?self:{};function WD(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function fo(t){throw new Error('Could not dynamically require "'+t+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var wc=function(t){return t&&t.Math==Math&&t},ot=wc(typeof globalThis=="object"&&globalThis)||wc(typeof window=="object"&&window)||wc(typeof self=="object"&&self)||wc(typeof At=="object"&&At)||function(){return this}()||Function("return this")(),Yn={},Mt=function(t){try{return!!t()}catch{return!0}},UD=Mt,Dr=!UD(function(){return Object.defineProperty({},1,{get:function(){return 7}})[1]!=7}),ol=Function.prototype.call,$r=ol.bind?ol.bind(ol):function(){return ol.apply(ol,arguments)},al={},qk={}.propertyIsEnumerable,Xk=Object.getOwnPropertyDescriptor,zD=Xk&&!qk.call({1:2},1);al.f=zD?function(r){var e=Xk(this,r);return!!e&&e.enumerable}:qk;var sl=function(t,r){return{enumerable:!(t&1),configurable:!(t&2),writable:!(t&4),value:r}},Zk=Function.prototype,sv=Zk.bind,uv=Zk.call,YD=sv&&sv.bind(uv),ht=sv?function(t){return t&&YD(uv,t)}:function(t){return t&&function(){return uv.apply(t,arguments)}},Jk=ht,GD=Jk({}.toString),KD=Jk("".slice),co=function(t){return KD(GD(t),8,-1)},qD=ot,XD=ht,ZD=Mt,JD=co,lv=qD.Object,QD=XD("".split),ul=ZD(function(){return!lv("z").propertyIsEnumerable(0)})?function(t){return JD(t)=="String"?QD(t,""):lv(t)}:lv,e9=ot,t9=e9.TypeError,Jr=function(t){if(t==null)throw t9("Can't call method on "+t);return t},r9=ul,n9=Jr,an=function(t){return r9(n9(t))},ur=function(t){return typeof t=="function"},i9=ur,gr=function(t){return typeof t=="object"?t!==null:i9(t)},fv=ot,o9=ur,a9=function(t){return o9(t)?t:void 0},ho=function(t,r){return arguments.length<2?a9(fv[t]):fv[t]&&fv[t][r]},s9=ht,po=s9({}.isPrototypeOf),u9=ho,ia=u9("navigator","userAgent")||"",Qk=ot,cv=ia,eO=Qk.process,tO=Qk.Deno,rO=eO&&eO.versions||tO&&tO.version,nO=rO&&rO.v8,Pn,_c;nO&&(Pn=nO.split("."),_c=Pn[0]>0&&Pn[0]<4?1:+(Pn[0]+Pn[1]));!_c&&cv&&(Pn=cv.match(/Edge\/(\d+)/),(!Pn||Pn[1]>=74)&&(Pn=cv.match(/Chrome\/(\d+)/),Pn&&(_c=+Pn[1])));var ll=_c,iO=ll,l9=Mt,hv=!!Object.getOwnPropertySymbols&&!l9(function(){var t=Symbol();return!String(t)||!(Object(t)instanceof Symbol)||!Symbol.sham&&iO&&iO<41}),f9=hv,oO=f9&&!Symbol.sham&&typeof Symbol.iterator=="symbol",c9=ot,h9=ho,d9=ur,p9=po,y9=oO,m9=c9.Object,Sc=y9?function(t){return typeof t=="symbol"}:function(t){var r=h9("Symbol");return d9(r)&&p9(r.prototype,m9(t))},v9=ot,g9=v9.String,Cc=function(t){try{return g9(t)}catch{return"Object"}},b9=ot,w9=ur,_9=Cc,S9=b9.TypeError,Cs=function(t){if(w9(t))return t;throw S9(_9(t)+" is not a function")},C9=Cs,oa=function(t,r){var e=t[r];return e==null?void 0:C9(e)},k9=ot,dv=$r,pv=ur,yv=gr,O9=k9.TypeError,R9=function(t,r){var e,n;if(r==="string"&&pv(e=t.toString)&&!yv(n=dv(e,t))||pv(e=t.valueOf)&&!yv(n=dv(e,t))||r!=="string"&&pv(e=t.toString)&&!yv(n=dv(e,t)))return n;throw O9("Can't convert object to primitive value")},fl={exports:{}},aO=ot,E9=Object.defineProperty,mv=function(t,r){try{E9(aO,t,{value:r,configurable:!0,writable:!0})}catch{aO[t]=r}return r},T9=ot,x9=mv,sO="__core-js_shared__",A9=T9[sO]||x9(sO,{}),vv=A9,uO=vv;(fl.exports=function(t,r){return uO[t]||(uO[t]=r!==void 0?r:{})})("versions",[]).push({version:"3.20.0",mode:"global",copyright:"\xA9 2021 Denis Pushkarev (zloirock.ru)"});var M9=ot,P9=Jr,I9=M9.Object,Qr=function(t){return I9(P9(t))},D9=ht,N9=Qr,$9=D9({}.hasOwnProperty),Tr=Object.hasOwn||function(r,e){return $9(N9(r),e)},j9=ht,L9=0,H9=Math.random(),F9=j9(1 .toString),kc=function(t){return"Symbol("+(t===void 0?"":t)+")_"+F9(++L9+H9,36)},B9=ot,V9=fl.exports,lO=Tr,W9=kc,fO=hv,cO=oO,ks=V9("wks"),aa=B9.Symbol,hO=aa&&aa.for,U9=cO?aa:aa&&aa.withoutSetter||W9,ir=function(t){if(!lO(ks,t)||!(fO||typeof ks[t]=="string")){var r="Symbol."+t;fO&&lO(aa,t)?ks[t]=aa[t]:cO&&hO?ks[t]=hO(r):ks[t]=U9(r)}return ks[t]},z9=ot,Y9=$r,dO=gr,pO=Sc,G9=oa,K9=R9,q9=ir,X9=z9.TypeError,Z9=q9("toPrimitive"),yO=function(t,r){if(!dO(t)||pO(t))return t;var e=G9(t,Z9),n;if(e){if(r===void 0&&(r="default"),n=Y9(e,t,r),!dO(n)||pO(n))return n;throw X9("Can't convert object to primitive value")}return r===void 0&&(r="number"),K9(t,r)},J9=yO,Q9=Sc,Oc=function(t){var r=J9(t,"string");return Q9(r)?r:r+""},eN=ot,mO=gr,gv=eN.document,tN=mO(gv)&&mO(gv.createElement),Rc=function(t){return tN?gv.createElement(t):{}},rN=Dr,nN=Mt,iN=Rc,vO=!rN&&!nN(function(){return Object.defineProperty(iN("div"),"a",{get:function(){return 7}}).a!=7}),oN=Dr,aN=$r,sN=al,uN=sl,lN=an,fN=Oc,cN=Tr,hN=vO,gO=Object.getOwnPropertyDescriptor;Yn.f=oN?gO:function(r,e){if(r=lN(r),e=fN(e),hN)try{return gO(r,e)}catch{}if(cN(r,e))return uN(!aN(sN.f,r,e),r[e])};var jr={},bO=ot,dN=gr,pN=bO.String,yN=bO.TypeError,br=function(t){if(dN(t))return t;throw yN(pN(t)+" is not an object")},mN=ot,vN=Dr,gN=vO,wO=br,bN=Oc,wN=mN.TypeError,_O=Object.defineProperty;jr.f=vN?_O:function(r,e,n){if(wO(r),e=bN(e),wO(n),gN)try{return _O(r,e,n)}catch{}if("get"in n||"set"in n)throw wN("Accessors not supported");return"value"in n&&(r[e]=n.value),r};var _N=Dr,SN=jr,CN=sl,yo=_N?function(t,r,e){return SN.f(t,r,CN(1,e))}:function(t,r,e){return t[r]=e,t},gn={exports:{}},kN=ht,ON=ur,bv=vv,RN=kN(Function.toString);ON(bv.inspectSource)||(bv.inspectSource=function(t){return RN(t)});var wv=bv.inspectSource,EN=ot,TN=ur,xN=wv,SO=EN.WeakMap,CO=TN(SO)&&/native code/.test(xN(SO)),AN=fl.exports,MN=kc,kO=AN("keys"),Ec=function(t){return kO[t]||(kO[t]=MN(t))},cl={},PN=CO,OO=ot,_v=ht,IN=gr,DN=yo,Sv=Tr,Cv=vv,NN=Ec,$N=cl,RO="Object already initialized",kv=OO.TypeError,jN=OO.WeakMap,Tc,hl,xc,LN=function(t){return xc(t)?hl(t):Tc(t,{})},HN=function(t){return function(r){var e;if(!IN(r)||(e=hl(r)).type!==t)throw kv("Incompatible receiver, "+t+" required");return e}};if(PN||Cv.state){var sa=Cv.state||(Cv.state=new jN),FN=_v(sa.get),EO=_v(sa.has),BN=_v(sa.set);Tc=function(t,r){if(EO(sa,t))throw new kv(RO);return r.facade=t,BN(sa,t,r),r},hl=function(t){return FN(sa,t)||{}},xc=function(t){return EO(sa,t)}}else{var Os=NN("state");$N[Os]=!0,Tc=function(t,r){if(Sv(t,Os))throw new kv(RO);return r.facade=t,DN(t,Os,r),r},hl=function(t){return Sv(t,Os)?t[Os]:{}},xc=function(t){return Sv(t,Os)}}var yi={set:Tc,get:hl,has:xc,enforce:LN,getterFor:HN},Ov=Dr,VN=Tr,TO=Function.prototype,WN=Ov&&Object.getOwnPropertyDescriptor,Rv=VN(TO,"name"),UN=Rv&&function(){}.name==="something",zN=Rv&&(!Ov||Ov&&WN(TO,"name").configurable),dl={EXISTS:Rv,PROPER:UN,CONFIGURABLE:zN},YN=ot,xO=ur,GN=Tr,AO=yo,KN=mv,qN=wv,MO=yi,XN=dl.CONFIGURABLE,ZN=MO.get,JN=MO.enforce,QN=String(String).split("String");(gn.exports=function(t,r,e,n){var i=n?!!n.unsafe:!1,o=n?!!n.enumerable:!1,a=n?!!n.noTargetGet:!1,s=n&&n.name!==void 0?n.name:r,l;if(xO(e)&&(String(s).slice(0,7)==="Symbol("&&(s="["+String(s).replace(/^Symbol\(([^)]*)\)/,"$1")+"]"),(!GN(e,"name")||XN&&e.name!==s)&&AO(e,"name",s),l=JN(e),l.source||(l.source=QN.join(typeof s=="string"?s:""))),t===YN){o?t[r]=e:KN(r,e);return}else i?!a&&t[r]&&(o=!0):delete t[r];o?t[r]=e:AO(t,r,e)})(Function.prototype,"toString",function(){return xO(this)&&ZN(this).source||qN(this)});var ua={},e$=Math.ceil,t$=Math.floor,mo=function(t){var r=+t;return r!==r||r===0?0:(r>0?t$:e$)(r)},r$=mo,n$=Math.max,i$=Math.min,pl=function(t,r){var e=r$(t);return e<0?n$(e+r,0):i$(e,r)},o$=mo,a$=Math.min,la=function(t){return t>0?a$(o$(t),9007199254740991):0},s$=la,bn=function(t){return s$(t.length)},u$=an,l$=pl,f$=bn,PO=function(t){return function(r,e,n){var i=u$(r),o=f$(i),a=l$(n,o),s;if(t&&e!=e){for(;o>a;)if(s=i[a++],s!=s)return!0}else for(;o>a;a++)if((t||a in i)&&i[a]===e)return t||a||0;return!t&&-1}},Ev={includes:PO(!0),indexOf:PO(!1)},c$=ht,Tv=Tr,h$=an,d$=Ev.indexOf,p$=cl,IO=c$([].push),DO=function(t,r){var e=h$(t),n=0,i=[],o;for(o in e)!Tv(p$,o)&&Tv(e,o)&&IO(i,o);for(;r.length>n;)Tv(e,o=r[n++])&&(~d$(i,o)||IO(i,o));return i},xv=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"],y$=DO,m$=xv,v$=m$.concat("length","prototype");ua.f=Object.getOwnPropertyNames||function(r){return y$(r,v$)};var Ac={};Ac.f=Object.getOwnPropertySymbols;var g$=ho,b$=ht,w$=ua,_$=Ac,S$=br,C$=b$([].concat),NO=g$("Reflect","ownKeys")||function(r){var e=w$.f(S$(r)),n=_$.f;return n?C$(e,n(r)):e},$O=Tr,k$=NO,O$=Yn,R$=jr,jO=function(t,r,e){for(var n=k$(r),i=R$.f,o=O$.f,a=0;a<n.length;a++){var s=n[a];!$O(t,s)&&!(e&&$O(e,s))&&i(t,s,o(r,s))}},E$=Mt,T$=ur,x$=/#|\.prototype\./,yl=function(t,r){var e=M$[A$(t)];return e==I$?!0:e==P$?!1:T$(r)?E$(r):!!r},A$=yl.normalize=function(t){return String(t).replace(x$,".").toLowerCase()},M$=yl.data={},P$=yl.NATIVE="N",I$=yl.POLYFILL="P",Mc=yl,Av=ot,D$=Yn.f,N$=yo,$$=gn.exports,j$=mv,L$=jO,H$=Mc,pt=function(t,r){var e=t.target,n=t.global,i=t.stat,o,a,s,l,p,d;if(n?a=Av:i?a=Av[e]||j$(e,{}):a=(Av[e]||{}).prototype,a)for(s in r){if(p=r[s],t.noTargetGet?(d=D$(a,s),l=d&&d.value):l=a[s],o=H$(n?s:e+(i?".":"#")+s,t.forced),!o&&l!==void 0){if(typeof p==typeof l)continue;L$(p,l)}(t.sham||l&&l.sham)&&N$(p,"sham",!0),$$(a,s,p,t)}},Pc={},F$=Oc,B$=jr,V$=sl,Rs=function(t,r,e){var n=F$(r);n in t?B$.f(t,n,V$(0,e)):t[n]=e},W$=ot,LO=pl,U$=bn,z$=Rs,Y$=W$.Array,G$=Math.max,Mv=function(t,r,e){for(var n=U$(t),i=LO(r,n),o=LO(e===void 0?n:e,n),a=Y$(G$(o-i,0)),s=0;i<o;i++,s++)z$(a,s,t[i]);return a.length=s,a},K$=co,q$=an,HO=ua.f,X$=Mv,FO=typeof window=="object"&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[],Z$=function(t){try{return HO(t)}catch{return X$(FO)}};Pc.f=function(r){return FO&&K$(r)=="Window"?Z$(r):HO(q$(r))};var J$=pt,Q$=Mt,ej=Pc.f,tj=Q$(function(){return!Object.getOwnPropertyNames(1)});J$({target:"Object",stat:!0,forced:tj},{getOwnPropertyNames:ej});var rj=ir,nj=rj("toStringTag"),BO={};BO[nj]="z";var Pv=String(BO)==="[object z]",ij=ot,oj=Pv,aj=ur,Ic=co,sj=ir,uj=sj("toStringTag"),lj=ij.Object,fj=Ic(function(){return arguments}())=="Arguments",cj=function(t,r){try{return t[r]}catch{}},Dc=oj?Ic:function(t){var r,e,n;return t===void 0?"Undefined":t===null?"Null":typeof(e=cj(r=lj(t),uj))=="string"?e:fj?Ic(r):(n=Ic(r))=="Object"&&aj(r.callee)?"Arguments":n},hj=ot,dj=Dc,pj=hj.String,xr=function(t){if(dj(t)==="Symbol")throw TypeError("Cannot convert a Symbol value to a string");return pj(t)},VO=Mv,yj=Math.floor,Iv=function(t,r){var e=t.length,n=yj(e/2);return e<8?mj(t,r):vj(t,Iv(VO(t,0,n),r),Iv(VO(t,n),r),r)},mj=function(t,r){for(var e=t.length,n=1,i,o;n<e;){for(o=n,i=t[n];o&&r(t[o-1],i)>0;)t[o]=t[--o];o!==n++&&(t[o]=i)}return t},vj=function(t,r,e,n){for(var i=r.length,o=e.length,a=0,s=0;a<i||s<o;)t[a+s]=a<i&&s<o?n(r[a],e[s])<=0?r[a++]:e[s++]:a<i?r[a++]:e[s++];return t},gj=Iv,bj=Mt,Es=function(t,r){var e=[][t];return!!e&&bj(function(){e.call(null,r||function(){throw 1},1)})},wj=ia,WO=wj.match(/firefox\/(\d+)/i),_j=!!WO&&+WO[1],Sj=ia,Cj=/MSIE|Trident/.test(Sj),kj=ia,UO=kj.match(/AppleWebKit\/(\d+)\./),Oj=!!UO&&+UO[1],Rj=pt,zO=ht,Ej=Cs,Tj=Qr,xj=bn,YO=xr,Dv=Mt,Aj=gj,Mj=Es,GO=_j,Pj=Cj,KO=ll,qO=Oj,vo=[],XO=zO(vo.sort),Ij=zO(vo.push),Dj=Dv(function(){vo.sort(void 0)}),Nj=Dv(function(){vo.sort(null)}),$j=Mj("sort"),ZO=!Dv(function(){if(KO)return KO<70;if(!(GO&&GO>3)){if(Pj)return!0;if(qO)return qO<603;var t="",r,e,n,i;for(r=65;r<76;r++){switch(e=String.fromCharCode(r),r){case 66:case 69:case 70:case 72:n=3;break;case 68:case 71:n=4;break;default:n=2}for(i=0;i<47;i++)vo.push({k:e+i,v:n})}for(vo.sort(function(o,a){return a.v-o.v}),i=0;i<vo.length;i++)e=vo[i].k.charAt(0),t.charAt(t.length-1)!==e&&(t+=e);return t!=="DGBEFHACIJK"}}),jj=Dj||!Nj||!$j||!ZO,Lj=function(t){return function(r,e){return e===void 0?-1:r===void 0?1:t!==void 0?+t(r,e)||0:YO(r)>YO(e)?1:-1}};Rj({target:"Array",proto:!0,forced:jj},{sort:function(r){r!==void 0&&Ej(r);var e=Tj(this);if(ZO)return r===void 0?XO(e):XO(e,r);var n=[],i=xj(e),o,a;for(a=0;a<i;a++)a in e&&Ij(n,e[a]);for(Aj(n,Lj(r)),o=n.length,a=0;a<o;)e[a]=n[a++];for(;a<i;)delete e[a++];return e}});var Hj=co,ml=Array.isArray||function(r){return Hj(r)=="Array"},Fj=ht,Bj=Mt,JO=ur,Vj=Dc,Wj=ho,Uj=wv,QO=function(){},zj=[],e2=Wj("Reflect","construct"),Nv=/^\s*(?:class|function)\b/,Yj=Fj(Nv.exec),Gj=!Nv.exec(QO),vl=function(r){if(!JO(r))return!1;try{return e2(QO,zj,r),!0}catch{return!1}},t2=function(r){if(!JO(r))return!1;switch(Vj(r)){case"AsyncFunction":case"GeneratorFunction":case"AsyncGeneratorFunction":return!1}try{return Gj||!!Yj(Nv,Uj(r))}catch{return!0}};t2.sham=!0;var Nc=!e2||Bj(function(){var t;return vl(vl.call)||!vl(Object)||!vl(function(){t=!0})||t})?t2:vl,Kj=ot,r2=ml,qj=Nc,Xj=gr,Zj=ir,Jj=Zj("species"),n2=Kj.Array,Qj=function(t){var r;return r2(t)&&(r=t.constructor,qj(r)&&(r===n2||r2(r.prototype))?r=void 0:Xj(r)&&(r=r[Jj],r===null&&(r=void 0))),r===void 0?n2:r},eL=Qj,$v=function(t,r){return new(eL(t))(r===0?0:r)},tL=Mt,rL=ir,nL=ll,iL=rL("species"),gl=function(t){return nL>=51||!tL(function(){var r=[],e=r.constructor={};return e[iL]=function(){return{foo:1}},r[t](Boolean).foo!==1})},oL=pt,aL=ot,sL=pl,uL=mo,lL=bn,fL=Qr,cL=$v,hL=Rs,dL=gl,pL=dL("splice"),yL=aL.TypeError,mL=Math.max,vL=Math.min,gL=9007199254740991,bL="Maximum allowed length exceeded";oL({target:"Array",proto:!0,forced:!pL},{splice:function(r,e){var n=fL(this),i=lL(n),o=sL(r,i),a=arguments.length,s,l,p,d,g,y;if(a===0?s=l=0:a===1?(s=0,l=i-o):(s=a-2,l=vL(mL(uL(e),0),i-o)),i+s-l>gL)throw yL(bL);for(p=cL(n,l),d=0;d<l;d++)g=o+d,g in n&&hL(p,d,n[g]);if(p.length=l,s<l){for(d=o;d<i-l;d++)g=d+l,y=d+s,g in n?n[y]=n[g]:delete n[y];for(d=i;d>i-l+s;d--)delete n[d-1]}else if(s>l)for(d=i-l;d>o;d--)g=d+l-1,y=d+s-1,g in n?n[y]=n[g]:delete n[y];for(d=0;d<s;d++)n[d+o]=arguments[d+2];return n.length=i-l+s,p}});var wL=gr,_L=Math.floor,SL=Number.isInteger||function(r){return!wL(r)&&isFinite(r)&&_L(r)===r},CL=pt,kL=SL;CL({target:"Number",stat:!0},{isInteger:kL});var i2=ot,OL=ur,RL=i2.String,EL=i2.TypeError,TL=function(t){if(typeof t=="object"||OL(t))return t;throw EL("Can't set "+RL(t)+" as a prototype")},xL=ht,AL=br,ML=TL,jv=Object.setPrototypeOf||("__proto__"in{}?function(){var t=!1,r={},e;try{e=xL(Object.getOwnPropertyDescriptor(Object.prototype,"__proto__").set),e(r,[]),t=r instanceof Array}catch{}return function(i,o){return AL(i),ML(o),t?e(i,o):i.__proto__=o,i}}():void 0),PL=ur,IL=gr,o2=jv,Lv=function(t,r,e){var n,i;return o2&&PL(n=r.constructor)&&n!==e&&IL(i=n.prototype)&&i!==e.prototype&&o2(t,i),t},DL=ht,a2=DL(1 .valueOf),s2=`	
\v\f\r \xA0\u1680\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200A\u202F\u205F\u3000\u2028\u2029\uFEFF`,NL=ht,$L=Jr,jL=xr,LL=s2,u2=NL("".replace),$c="["+LL+"]",HL=RegExp("^"+$c+$c+"*"),FL=RegExp($c+$c+"*$"),Hv=function(t){return function(r){var e=jL($L(r));return t&1&&(e=u2(e,HL,"")),t&2&&(e=u2(e,FL,"")),e}},l2={start:Hv(1),end:Hv(2),trim:Hv(3)},BL=Dr,Fv=ot,f2=ht,VL=Mc,WL=gn.exports,c2=Tr,UL=Lv,zL=po,YL=Sc,h2=yO,GL=Mt,KL=ua.f,qL=Yn.f,XL=jr.f,ZL=a2,JL=l2.trim,Bv="Number",go=Fv[Bv],Vv=go.prototype,QL=Fv.TypeError,eH=f2("".slice),jc=f2("".charCodeAt),tH=function(t){var r=h2(t,"number");return typeof r=="bigint"?r:rH(r)},rH=function(t){var r=h2(t,"number"),e,n,i,o,a,s,l,p;if(YL(r))throw QL("Cannot convert a Symbol value to a number");if(typeof r=="string"&&r.length>2){if(r=JL(r),e=jc(r,0),e===43||e===45){if(n=jc(r,2),n===88||n===120)return NaN}else if(e===48){switch(jc(r,1)){case 66:case 98:i=2,o=49;break;case 79:case 111:i=8,o=55;break;default:return+r}for(a=eH(r,2),s=a.length,l=0;l<s;l++)if(p=jc(a,l),p<48||p>o)return NaN;return parseInt(a,i)}}return+r};if(VL(Bv,!go(" 0o1")||!go("0b1")||go("+0x1"))){for(var Ts=function(r){var e=arguments.length<1?0:go(tH(r)),n=this;return zL(Vv,n)&&GL(function(){ZL(n)})?UL(Object(e),n,Ts):e},d2=BL?KL(go):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,isFinite,isInteger,isNaN,isSafeInteger,parseFloat,parseInt,fromString,range".split(","),Wv=0,Lc;d2.length>Wv;Wv++)c2(go,Lc=d2[Wv])&&!c2(Ts,Lc)&&XL(Ts,Lc,qL(go,Lc));Ts.prototype=Vv,Vv.constructor=Ts,WL(Fv,Bv,Ts)}var nH=ht,bl=nH([].slice),iH=pt,oH=ot,p2=ml,aH=Nc,sH=gr,y2=pl,uH=bn,lH=an,fH=Rs,cH=ir,hH=gl,dH=bl,pH=hH("slice"),yH=cH("species"),Uv=oH.Array,mH=Math.max;iH({target:"Array",proto:!0,forced:!pH},{slice:function(r,e){var n=lH(this),i=uH(n),o=y2(r,i),a=y2(e===void 0?i:e,i),s,l,p;if(p2(n)&&(s=n.constructor,aH(s)&&(s===Uv||p2(s.prototype))?s=void 0:sH(s)&&(s=s[yH],s===null&&(s=void 0)),s===Uv||s===void 0))return dH(n,o,a);for(l=new(s===void 0?Uv:s)(mH(a-o,0)),p=0;o<a;o++,p++)o in n&&fH(l,p,n[o]);return l.length=p,l}});var vH=pt,gH=ot,bH=Mt,wH=ml,_H=gr,SH=Qr,CH=bn,m2=Rs,kH=$v,OH=gl,RH=ir,EH=ll,v2=RH("isConcatSpreadable"),g2=9007199254740991,b2="Maximum allowed index exceeded",w2=gH.TypeError,TH=EH>=51||!bH(function(){var t=[];return t[v2]=!1,t.concat()[0]!==t}),xH=OH("concat"),AH=function(t){if(!_H(t))return!1;var r=t[v2];return r!==void 0?!!r:wH(t)},MH=!TH||!xH;vH({target:"Array",proto:!0,forced:MH},{concat:function(r){var e=SH(this),n=kH(e,0),i=0,o,a,s,l,p;for(o=-1,s=arguments.length;o<s;o++)if(p=o===-1?e:arguments[o],AH(p)){if(l=CH(p),i+l>g2)throw w2(b2);for(a=0;a<l;a++,i++)a in p&&m2(n,i,p[a])}else{if(i>=g2)throw w2(b2);m2(n,i++,p)}return n.length=i,n}});var PH=Qr,_2=pl,IH=bn,DH=function(r){for(var e=PH(this),n=IH(e),i=arguments.length,o=_2(i>1?arguments[1]:void 0,n),a=i>2?arguments[2]:void 0,s=a===void 0?n:_2(a,n);s>o;)e[o++]=r;return e},NH=DO,$H=xv,wl=Object.keys||function(r){return NH(r,$H)},jH=Dr,LH=jr,HH=br,FH=an,BH=wl,VH=jH?Object.defineProperties:function(r,e){HH(r);for(var n=FH(e),i=BH(e),o=i.length,a=0,s;o>a;)LH.f(r,s=i[a++],n[s]);return r},WH=ho,S2=WH("document","documentElement"),UH=br,zH=VH,C2=xv,YH=cl,GH=S2,KH=Rc,qH=Ec,k2=">",O2="<",zv="prototype",Yv="script",R2=qH("IE_PROTO"),Gv=function(){},E2=function(t){return O2+Yv+k2+t+O2+"/"+Yv+k2},T2=function(t){t.write(E2("")),t.close();var r=t.parentWindow.Object;return t=null,r},XH=function(){var t=KH("iframe"),r="java"+Yv+":",e;return t.style.display="none",GH.appendChild(t),t.src=String(r),e=t.contentWindow.document,e.open(),e.write(E2("document.F=Object")),e.close(),e.F},Hc,Fc=function(){try{Hc=new ActiveXObject("htmlfile")}catch{}Fc=typeof document!="undefined"?document.domain&&Hc?T2(Hc):XH():T2(Hc);for(var t=C2.length;t--;)delete Fc[zv][C2[t]];return Fc()};YH[R2]=!0;var xs=Object.create||function(r,e){var n;return r!==null?(Gv[zv]=UH(r),n=new Gv,Gv[zv]=null,n[R2]=r):n=Fc(),e===void 0?n:zH(n,e)},ZH=ir,JH=xs,QH=jr,Kv=ZH("unscopables"),qv=Array.prototype;qv[Kv]==null&&QH.f(qv,Kv,{configurable:!0,value:JH(null)});var _l=function(t){qv[Kv][t]=!0},eF=pt,tF=DH,rF=_l;eF({target:"Array",proto:!0},{fill:tF});rF("fill");var x2=ht,nF=Cs,A2=x2(x2.bind),Sl=function(t,r){return nF(t),r===void 0?t:A2?A2(t,r):function(){return t.apply(r,arguments)}},iF=Sl,oF=ht,aF=ul,sF=Qr,uF=bn,lF=$v,M2=oF([].push),bo=function(t){var r=t==1,e=t==2,n=t==3,i=t==4,o=t==6,a=t==7,s=t==5||o;return function(l,p,d,g){for(var y=sF(l),h=aF(y),u=iF(p,d),f=uF(h),c=0,v=g||lF,m=r?v(l,f):e||a?v(l,0):void 0,b,w;f>c;c++)if((s||c in h)&&(b=h[c],w=u(b,c,y),t))if(r)m[c]=w;else if(w)switch(t){case 3:return!0;case 5:return b;case 6:return c;case 2:M2(m,b)}else switch(t){case 4:return!1;case 7:M2(m,b)}return o?-1:n||i?i:m}},fa={forEach:bo(0),map:bo(1),filter:bo(2),some:bo(3),every:bo(4),find:bo(5),findIndex:bo(6),filterReject:bo(7)},fF=pt,cF=fa.map,hF=gl,dF=hF("map");fF({target:"Array",proto:!0,forced:!dF},{map:function(r){return cF(this,r,arguments.length>1?arguments[1]:void 0)}});var pF=br,Xv=function(){var t=pF(this),r="";return t.global&&(r+="g"),t.ignoreCase&&(r+="i"),t.multiline&&(r+="m"),t.dotAll&&(r+="s"),t.unicode&&(r+="u"),t.sticky&&(r+="y"),r},Zv=Mt,yF=ot,Jv=yF.RegExp,Qv=Zv(function(){var t=Jv("a","y");return t.lastIndex=2,t.exec("abcd")!=null}),mF=Qv||Zv(function(){return!Jv("a","y").sticky}),vF=Qv||Zv(function(){var t=Jv("^r","gy");return t.lastIndex=2,t.exec("str")!=null}),eg={BROKEN_CARET:vF,MISSED_STICKY:mF,UNSUPPORTED_Y:Qv},gF=Mt,bF=ot,wF=bF.RegExp,P2=gF(function(){var t=wF(".","s");return!(t.dotAll&&t.exec(`
`)&&t.flags==="s")}),_F=Mt,SF=ot,CF=SF.RegExp,I2=_F(function(){var t=CF("(?<a>b)","g");return t.exec("b").groups.a!=="b"||"b".replace(t,"$<a>c")!=="bc"}),As=$r,Bc=ht,kF=xr,OF=Xv,RF=eg,EF=fl.exports,TF=xs,xF=yi.get,AF=P2,MF=I2,PF=EF("native-string-replace",String.prototype.replace),Vc=RegExp.prototype.exec,tg=Vc,IF=Bc("".charAt),DF=Bc("".indexOf),NF=Bc("".replace),rg=Bc("".slice),ng=function(){var t=/a/,r=/b*/g;return As(Vc,t,"a"),As(Vc,r,"a"),t.lastIndex!==0||r.lastIndex!==0}(),D2=RF.BROKEN_CARET,ig=/()??/.exec("")[1]!==void 0,$F=ng||ig||D2||AF||MF;$F&&(tg=function(r){var e=this,n=xF(e),i=kF(r),o=n.raw,a,s,l,p,d,g,y;if(o)return o.lastIndex=e.lastIndex,a=As(tg,o,i),e.lastIndex=o.lastIndex,a;var h=n.groups,u=D2&&e.sticky,f=As(OF,e),c=e.source,v=0,m=i;if(u&&(f=NF(f,"y",""),DF(f,"g")===-1&&(f+="g"),m=rg(i,e.lastIndex),e.lastIndex>0&&(!e.multiline||e.multiline&&IF(i,e.lastIndex-1)!==`
`)&&(c="(?: "+c+")",m=" "+m,v++),s=new RegExp("^(?:"+c+")",f)),ig&&(s=new RegExp("^"+c+"$(?!\\s)",f)),ng&&(l=e.lastIndex),p=As(Vc,u?s:e,m),u?p?(p.input=rg(p.input,v),p[0]=rg(p[0],v),p.index=e.lastIndex,e.lastIndex+=p[0].length):e.lastIndex=0:ng&&p&&(e.lastIndex=e.global?p.index+p[0].length:l),ig&&p&&p.length>1&&As(PF,p[0],s,function(){for(d=1;d<arguments.length-2;d++)arguments[d]===void 0&&(p[d]=void 0)}),p&&h)for(p.groups=g=TF(null),d=0;d<h.length;d++)y=h[d],g[y[0]]=p[y[1]];return p});var Wc=tg,jF=pt,N2=Wc;jF({target:"RegExp",proto:!0,forced:/./.exec!==N2},{exec:N2});var og=Function.prototype,$2=og.apply,LF=og.bind,j2=og.call,ca=typeof Reflect=="object"&&Reflect.apply||(LF?j2.bind($2):function(){return j2.apply($2,arguments)}),L2=ht,H2=gn.exports,HF=Wc,F2=Mt,B2=ir,FF=yo,BF=B2("species"),ag=RegExp.prototype,Uc=function(t,r,e,n){var i=B2(t),o=!F2(function(){var p={};return p[i]=function(){return 7},""[t](p)!=7}),a=o&&!F2(function(){var p=!1,d=/a/;return t==="split"&&(d={},d.constructor={},d.constructor[BF]=function(){return d},d.flags="",d[i]=/./[i]),d.exec=function(){return p=!0,null},d[i](""),!p});if(!o||!a||e){var s=L2(/./[i]),l=r(i,""[t],function(p,d,g,y,h){var u=L2(p),f=d.exec;return f===HF||f===ag.exec?o&&!h?{done:!0,value:s(d,g,y)}:{done:!0,value:u(g,d,y)}:{done:!1}});H2(String.prototype,t,l[0]),H2(ag,i,l[1])}n&&FF(ag[i],"sham",!0)},sg=ht,VF=mo,WF=xr,UF=Jr,zF=sg("".charAt),V2=sg("".charCodeAt),YF=sg("".slice),W2=function(t){return function(r,e){var n=WF(UF(r)),i=VF(e),o=n.length,a,s;return i<0||i>=o?t?"":void 0:(a=V2(n,i),a<55296||a>56319||i+1===o||(s=V2(n,i+1))<56320||s>57343?t?zF(n,i):a:t?YF(n,i,i+2):(a-55296<<10)+(s-56320)+65536)}},ug={codeAt:W2(!1),charAt:W2(!0)},GF=ug.charAt,lg=function(t,r,e){return r+(e?GF(t,r).length:1)},fg=ht,KF=Qr,qF=Math.floor,cg=fg("".charAt),XF=fg("".replace),hg=fg("".slice),ZF=/\$([$&'`]|\d{1,2}|<[^>]*>)/g,JF=/\$([$&'`]|\d{1,2})/g,QF=function(t,r,e,n,i,o){var a=e+t.length,s=n.length,l=JF;return i!==void 0&&(i=KF(i),l=ZF),XF(o,l,function(p,d){var g;switch(cg(d,0)){case"$":return"$";case"&":return t;case"`":return hg(r,0,e);case"'":return hg(r,a);case"<":g=i[hg(d,1,-1)];break;default:var y=+d;if(y===0)return p;if(y>s){var h=qF(y/10);return h===0?p:h<=s?n[h-1]===void 0?cg(d,1):n[h-1]+cg(d,1):p}g=n[y-1]}return g===void 0?"":g})},eB=ot,U2=$r,tB=br,rB=ur,nB=co,iB=Wc,oB=eB.TypeError,zc=function(t,r){var e=t.exec;if(rB(e)){var n=U2(e,t,r);return n!==null&&tB(n),n}if(nB(t)==="RegExp")return U2(iB,t,r);throw oB("RegExp#exec called on incompatible receiver")},aB=ca,z2=$r,Yc=ht,sB=Uc,uB=Mt,lB=br,fB=ur,cB=mo,hB=la,Ms=xr,dB=Jr,pB=lg,yB=oa,mB=QF,vB=zc,gB=ir,dg=gB("replace"),bB=Math.max,wB=Math.min,_B=Yc([].concat),pg=Yc([].push),Y2=Yc("".indexOf),G2=Yc("".slice),SB=function(t){return t===void 0?t:String(t)},CB=function(){return"a".replace(/./,"$0")==="$0"}(),K2=function(){return/./[dg]?/./[dg]("a","$0")==="":!1}(),kB=!uB(function(){var t=/./;return t.exec=function(){var r=[];return r.groups={a:"7"},r},"".replace(t,"$<a>")!=="7"});sB("replace",function(t,r,e){var n=K2?"$":"$0";return[function(o,a){var s=dB(this),l=o==null?void 0:yB(o,dg);return l?z2(l,o,s,a):z2(r,Ms(s),o,a)},function(i,o){var a=lB(this),s=Ms(i);if(typeof o=="string"&&Y2(o,n)===-1&&Y2(o,"$<")===-1){var l=e(r,a,s,o);if(l.done)return l.value}var p=fB(o);p||(o=Ms(o));var d=a.global;if(d){var g=a.unicode;a.lastIndex=0}for(var y=[];;){var h=vB(a,s);if(h===null||(pg(y,h),!d))break;var u=Ms(h[0]);u===""&&(a.lastIndex=pB(s,hB(a.lastIndex),g))}for(var f="",c=0,v=0;v<y.length;v++){h=y[v];for(var m=Ms(h[0]),b=bB(wB(cB(h.index),s.length),0),w=[],_=1;_<h.length;_++)pg(w,SB(h[_]));var C=h.groups;if(p){var R=_B([m],w,b,s);C!==void 0&&pg(R,C);var I=Ms(aB(o,void 0,R))}else I=mB(m,s,b,w,C,o);b>=c&&(f+=G2(s,c,b)+I,c=b+m.length)}return f+G2(s,c)}]},!kB||!CB||K2);var OB=$r,q2=br,RB=oa,X2=function(t,r,e){var n,i;q2(t);try{if(n=RB(t,"return"),!n){if(r==="throw")throw e;return e}n=OB(n,t)}catch(o){i=!0,n=o}if(r==="throw")throw e;if(i)throw n;return q2(n),e},EB=br,TB=X2,xB=function(t,r,e,n){try{return n?r(EB(e)[0],e[1]):r(e)}catch(i){TB(t,"throw",i)}},Cl={},AB=ir,MB=Cl,PB=AB("iterator"),IB=Array.prototype,Z2=function(t){return t!==void 0&&(MB.Array===t||IB[PB]===t)},DB=Dc,J2=oa,NB=Cl,$B=ir,jB=$B("iterator"),yg=function(t){if(t!=null)return J2(t,jB)||J2(t,"@@iterator")||NB[DB(t)]},LB=ot,HB=$r,FB=Cs,BB=br,VB=Cc,WB=yg,UB=LB.TypeError,Q2=function(t,r){var e=arguments.length<2?WB(t):r;if(FB(e))return BB(HB(e,t));throw UB(VB(t)+" is not iterable")},zB=ot,YB=Sl,GB=$r,KB=Qr,qB=xB,XB=Z2,ZB=Nc,JB=bn,eR=Rs,QB=Q2,eV=yg,tR=zB.Array,tV=function(r){var e=KB(r),n=ZB(this),i=arguments.length,o=i>1?arguments[1]:void 0,a=o!==void 0;a&&(o=YB(o,i>2?arguments[2]:void 0));var s=eV(e),l=0,p,d,g,y,h,u;if(s&&!(this==tR&&XB(s)))for(y=QB(e,s),h=y.next,d=n?new this:[];!(g=GB(h,y)).done;l++)u=a?qB(y,o,[g.value,l],!0):g.value,eR(d,l,u);else for(p=JB(e),d=n?new this(p):tR(p);p>l;l++)u=a?o(e[l],l):e[l],eR(d,l,u);return d.length=l,d},rV=ir,rR=rV("iterator"),nR=!1;try{var nV=0,iR={next:function(){return{done:!!nV++}},return:function(){nR=!0}};iR[rR]=function(){return this},Array.from(iR,function(){throw 2})}catch{}var oR=function(t,r){if(!r&&!nR)return!1;var e=!1;try{var n={};n[rR]=function(){return{next:function(){return{done:e=!0}}}},t(n)}catch{}return e},iV=pt,oV=tV,aV=oR,sV=!aV(function(t){Array.from(t)});iV({target:"Array",stat:!0,forced:sV},{from:oV});var uV=Mt,aR=!uV(function(){function t(){}return t.prototype.constructor=null,Object.getPrototypeOf(new t)!==t.prototype}),lV=ot,fV=Tr,cV=ur,hV=Qr,dV=Ec,pV=aR,sR=dV("IE_PROTO"),mg=lV.Object,yV=mg.prototype,Gc=pV?mg.getPrototypeOf:function(t){var r=hV(t);if(fV(r,sR))return r[sR];var e=r.constructor;return cV(e)&&r instanceof e?e.prototype:r instanceof mg?yV:null},mV=Mt,vV=ur,uR=Gc,gV=gn.exports,bV=ir,vg=bV("iterator"),lR=!1,ha,gg,bg;[].keys&&(bg=[].keys(),"next"in bg?(gg=uR(uR(bg)),gg!==Object.prototype&&(ha=gg)):lR=!0);var wV=ha==null||mV(function(){var t={};return ha[vg].call(t)!==t});wV&&(ha={});vV(ha[vg])||gV(ha,vg,function(){return this});var fR={IteratorPrototype:ha,BUGGY_SAFARI_ITERATORS:lR},_V=jr.f,SV=Tr,CV=ir,cR=CV("toStringTag"),Kc=function(t,r,e){t&&!e&&(t=t.prototype),t&&!SV(t,cR)&&_V(t,cR,{configurable:!0,value:r})},kV=fR.IteratorPrototype,OV=xs,RV=sl,EV=Kc,TV=Cl,xV=function(){return this},AV=function(t,r,e,n){var i=r+" Iterator";return t.prototype=OV(kV,{next:RV(+!n,e)}),EV(t,i,!1),TV[i]=xV,t},MV=pt,PV=$r,hR=dl,IV=ur,DV=AV,dR=Gc,pR=jv,NV=Kc,$V=yo,wg=gn.exports,jV=ir,LV=Cl,yR=fR,HV=hR.PROPER,FV=hR.CONFIGURABLE,mR=yR.IteratorPrototype,qc=yR.BUGGY_SAFARI_ITERATORS,kl=jV("iterator"),vR="keys",Ol="values",gR="entries",BV=function(){return this},_g=function(t,r,e,n,i,o,a){DV(e,r,n);var s=function(v){if(v===i&&y)return y;if(!qc&&v in d)return d[v];switch(v){case vR:return function(){return new e(this,v)};case Ol:return function(){return new e(this,v)};case gR:return function(){return new e(this,v)}}return function(){return new e(this)}},l=r+" Iterator",p=!1,d=t.prototype,g=d[kl]||d["@@iterator"]||i&&d[i],y=!qc&&g||s(i),h=r=="Array"&&d.entries||g,u,f,c;if(h&&(u=dR(h.call(new t)),u!==Object.prototype&&u.next&&(dR(u)!==mR&&(pR?pR(u,mR):IV(u[kl])||wg(u,kl,BV)),NV(u,l,!0))),HV&&i==Ol&&g&&g.name!==Ol&&(FV?$V(d,"name",Ol):(p=!0,y=function(){return PV(g,this)})),i)if(f={values:s(Ol),keys:o?y:s(vR),entries:s(gR)},a)for(c in f)(qc||p||!(c in d))&&wg(d,c,f[c]);else MV({target:r,proto:!0,forced:qc||p},f);return d[kl]!==y&&wg(d,kl,y,{name:i}),LV[r]=y,f},VV=ug.charAt,WV=xr,bR=yi,UV=_g,wR="String Iterator",zV=bR.set,YV=bR.getterFor(wR);UV(String,"String",function(t){zV(this,{type:wR,string:WV(t),index:0})},function(){var r=YV(this),e=r.string,n=r.index,i;return n>=e.length?{value:void 0,done:!0}:(i=VV(e,n),r.index+=i.length,{value:i,done:!1})});var GV=pt,KV=ht,qV=Ev.indexOf,XV=Es,Sg=KV([].indexOf),_R=!!Sg&&1/Sg([1],1,-0)<0,ZV=XV("indexOf");GV({target:"Array",proto:!0,forced:_R||!ZV},{indexOf:function(r){var e=arguments.length>1?arguments[1]:void 0;return _R?Sg(this,r,e)||0:qV(this,r,e)}});var JV=pt,QV=ht,eW=ml,tW=QV([].reverse),SR=[1,2];JV({target:"Array",proto:!0,forced:String(SR)===String(SR.reverse())},{reverse:function(){return eW(this)&&(this.length=this.length),tW(this)}});var rW=Pv,nW=Dc,iW=rW?{}.toString:function(){return"[object "+nW(this)+"]"},oW=Pv,aW=gn.exports,sW=iW;oW||aW(Object.prototype,"toString",sW,{unsafe:!0});var CR={CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0},uW=Rc,Cg=uW("span").classList,kR=Cg&&Cg.constructor&&Cg.constructor.prototype,OR=kR===Object.prototype?void 0:kR,lW=fa.forEach,fW=Es,cW=fW("forEach"),hW=cW?[].forEach:function(r){return lW(this,r,arguments.length>1?arguments[1]:void 0)},RR=ot,ER=CR,dW=OR,kg=hW,pW=yo,TR=function(t){if(t&&t.forEach!==kg)try{pW(t,"forEach",kg)}catch{t.forEach=kg}};for(var Og in ER)ER[Og]&&TR(RR[Og]&&RR[Og].prototype);TR(dW);var yW=pt,Rg=ot,mW=ca,vW=ur,gW=ia,bW=bl,wW=/MSIE .\./.test(gW),_W=Rg.Function,xR=function(t){return function(r,e){var n=arguments.length>2,i=n?bW(arguments,2):void 0;return t(n?function(){mW(vW(r)?r:_W(r),this,i)}:r,e)}};yW({global:!0,bind:!0,forced:wW},{setTimeout:xR(Rg.setTimeout),setInterval:xR(Rg.setInterval)});var SW=ia,CW=/(?:ipad|iphone|ipod).*applewebkit/i.test(SW),kW=co,OW=ot,AR=kW(OW.process)=="process",sn=ot,RW=ca,EW=Sl,MR=ur,TW=Tr,xW=Mt,PR=S2,AW=bl,IR=Rc,MW=CW,PW=AR,Eg=sn.setImmediate,Tg=sn.clearImmediate,IW=sn.process,xg=sn.Dispatch,DW=sn.Function,DR=sn.MessageChannel,NW=sn.String,Ag=0,Rl={},NR="onreadystatechange",El,da,Mg,Pg;try{El=sn.location}catch{}var Ig=function(t){if(TW(Rl,t)){var r=Rl[t];delete Rl[t],r()}},Dg=function(t){return function(){Ig(t)}},$R=function(t){Ig(t.data)},jR=function(t){sn.postMessage(NW(t),El.protocol+"//"+El.host)};(!Eg||!Tg)&&(Eg=function(r){var e=AW(arguments,1);return Rl[++Ag]=function(){RW(MR(r)?r:DW(r),void 0,e)},da(Ag),Ag},Tg=function(r){delete Rl[r]},PW?da=function(t){IW.nextTick(Dg(t))}:xg&&xg.now?da=function(t){xg.now(Dg(t))}:DR&&!MW?(Mg=new DR,Pg=Mg.port2,Mg.port1.onmessage=$R,da=EW(Pg.postMessage,Pg)):sn.addEventListener&&MR(sn.postMessage)&&!sn.importScripts&&El&&El.protocol!=="file:"&&!xW(jR)?(da=jR,sn.addEventListener("message",$R,!1)):NR in IR("script")?da=function(t){PR.appendChild(IR("script"))[NR]=function(){PR.removeChild(this),Ig(t)}}:da=function(t){setTimeout(Dg(t),0)});var $W={set:Eg,clear:Tg},jW=pt,LR=ot,HR=$W,LW=!LR.setImmediate||!LR.clearImmediate;jW({global:!0,bind:!0,enumerable:!0,forced:LW},{setImmediate:HR.set,clearImmediate:HR.clear});var Ng={},HW=ir;Ng.f=HW;var FW=ot,BW=FW,FR=BW,VW=Tr,WW=Ng,UW=jr.f,BR=function(t){var r=FR.Symbol||(FR.Symbol={});VW(r,t)||UW(r,t,{value:WW.f(t)})},Ps=pt,$g=ot,zW=ho,YW=ca,Tl=$r,GW=ht,Is=Dr,pa=hv,jg=Mt,kr=Tr,KW=ml,qW=ur,XW=gr,ZW=po,Lg=Sc,Hg=br,JW=Qr,Xc=an,Fg=Oc,VR=xr,Bg=sl,xl=xs,WR=wl,QW=ua,UR=Pc,Vg=Ac,zR=Yn,YR=jr,GR=al,eU=bl,Zc=gn.exports,Al=fl.exports,tU=Ec,KR=cl,qR=kc,XR=ir,rU=Ng,nU=BR,iU=Kc,ZR=yi,Jc=fa.forEach,en=tU("hidden"),Qc="Symbol",Ml="prototype",JR=XR("toPrimitive"),oU=ZR.set,QR=ZR.getterFor(Qc),wn=Object[Ml],mi=$g.Symbol,wo=mi&&mi[Ml],eE=$g.TypeError,Wg=$g.QObject,Pl=zW("JSON","stringify"),tE=zR.f,_o=YR.f,rE=UR.f,aU=GR.f,nE=GW([].push),vi=Al("symbols"),Il=Al("op-symbols"),Ug=Al("string-to-symbol-registry"),zg=Al("symbol-to-string-registry"),sU=Al("wks"),Yg=!Wg||!Wg[Ml]||!Wg[Ml].findChild,Gg=Is&&jg(function(){return xl(_o({},"a",{get:function(){return _o(this,"a",{value:7}).a}})).a!=7})?function(t,r,e){var n=tE(wn,r);n&&delete wn[r],_o(t,r,e),n&&t!==wn&&_o(wn,r,n)}:_o,Kg=function(t,r){var e=vi[t]=xl(wo);return oU(e,{type:Qc,tag:t,description:r}),Is||(e.description=r),e},eh=function(r,e,n){r===wn&&eh(Il,e,n),Hg(r);var i=Fg(e);return Hg(n),kr(vi,i)?(n.enumerable?(kr(r,en)&&r[en][i]&&(r[en][i]=!1),n=xl(n,{enumerable:Bg(0,!1)})):(kr(r,en)||_o(r,en,Bg(1,{})),r[en][i]=!0),Gg(r,i,n)):_o(r,i,n)},iE=function(r,e){Hg(r);var n=Xc(e),i=WR(n).concat(Xg(n));return Jc(i,function(o){(!Is||Tl(qg,n,o))&&eh(r,o,n[o])}),r},uU=function(r,e){return e===void 0?xl(r):iE(xl(r),e)},qg=function(r){var e=Fg(r),n=Tl(aU,this,e);return this===wn&&kr(vi,e)&&!kr(Il,e)?!1:n||!kr(this,e)||!kr(vi,e)||kr(this,en)&&this[en][e]?n:!0},oE=function(r,e){var n=Xc(r),i=Fg(e);if(!(n===wn&&kr(vi,i)&&!kr(Il,i))){var o=tE(n,i);return o&&kr(vi,i)&&!(kr(n,en)&&n[en][i])&&(o.enumerable=!0),o}},aE=function(r){var e=rE(Xc(r)),n=[];return Jc(e,function(i){!kr(vi,i)&&!kr(KR,i)&&nE(n,i)}),n},Xg=function(r){var e=r===wn,n=rE(e?Il:Xc(r)),i=[];return Jc(n,function(o){kr(vi,o)&&(!e||kr(wn,o))&&nE(i,vi[o])}),i};pa||(mi=function(){if(ZW(wo,this))throw eE("Symbol is not a constructor");var r=!arguments.length||arguments[0]===void 0?void 0:VR(arguments[0]),e=qR(r),n=function(i){this===wn&&Tl(n,Il,i),kr(this,en)&&kr(this[en],e)&&(this[en][e]=!1),Gg(this,e,Bg(1,i))};return Is&&Yg&&Gg(wn,e,{configurable:!0,set:n}),Kg(e,r)},wo=mi[Ml],Zc(wo,"toString",function(){return QR(this).tag}),Zc(mi,"withoutSetter",function(t){return Kg(qR(t),t)}),GR.f=qg,YR.f=eh,zR.f=oE,QW.f=UR.f=aE,Vg.f=Xg,rU.f=function(t){return Kg(XR(t),t)},Is&&(_o(wo,"description",{configurable:!0,get:function(){return QR(this).description}}),Zc(wn,"propertyIsEnumerable",qg,{unsafe:!0})));Ps({global:!0,wrap:!0,forced:!pa,sham:!pa},{Symbol:mi});Jc(WR(sU),function(t){nU(t)});Ps({target:Qc,stat:!0,forced:!pa},{for:function(t){var r=VR(t);if(kr(Ug,r))return Ug[r];var e=mi(r);return Ug[r]=e,zg[e]=r,e},keyFor:function(r){if(!Lg(r))throw eE(r+" is not a symbol");if(kr(zg,r))return zg[r]},useSetter:function(){Yg=!0},useSimple:function(){Yg=!1}});Ps({target:"Object",stat:!0,forced:!pa,sham:!Is},{create:uU,defineProperty:eh,defineProperties:iE,getOwnPropertyDescriptor:oE});Ps({target:"Object",stat:!0,forced:!pa},{getOwnPropertyNames:aE,getOwnPropertySymbols:Xg});Ps({target:"Object",stat:!0,forced:jg(function(){Vg.f(1)})},{getOwnPropertySymbols:function(r){return Vg.f(JW(r))}});if(Pl){var lU=!pa||jg(function(){var t=mi();return Pl([t])!="[null]"||Pl({a:t})!="{}"||Pl(Object(t))!="{}"});Ps({target:"JSON",stat:!0,forced:lU},{stringify:function(r,e,n){var i=eU(arguments),o=e;if(!(!XW(e)&&r===void 0||Lg(r)))return KW(e)||(e=function(a,s){if(qW(o)&&(s=Tl(o,this,a,s)),!Lg(s))return s}),i[1]=e,YW(Pl,null,i)}})}if(!wo[JR]){var fU=wo.valueOf;Zc(wo,JR,function(t){return Tl(fU,this)})}iU(mi,Qc);KR[en]=!0;var cU=pt,hU=Dr,dU=ot,th=ht,pU=Tr,yU=ur,mU=po,vU=xr,gU=jr.f,bU=jO,gi=dU.Symbol,ya=gi&&gi.prototype;if(hU&&yU(gi)&&(!("description"in ya)||gi().description!==void 0)){var sE={},rh=function(){var r=arguments.length<1||arguments[0]===void 0?void 0:vU(arguments[0]),e=mU(ya,this)?new gi(r):r===void 0?gi():gi(r);return r===""&&(sE[e]=!0),e};bU(rh,gi),rh.prototype=ya,ya.constructor=rh;var wU=String(gi("test"))=="Symbol(test)",_U=th(ya.toString),SU=th(ya.valueOf),CU=/^Symbol\((.*)\)[^)]+$/,kU=th("".replace),OU=th("".slice);gU(ya,"description",{configurable:!0,get:function(){var r=SU(this),e=_U(r);if(pU(sE,r))return"";var n=wU?OU(e,7,-1):kU(e,CU,"$1");return n===""?void 0:n}}),cU({global:!0,forced:!0},{Symbol:rh})}var RU=BR;RU("iterator");var EU=an,Zg=_l,uE=Cl,lE=yi,TU=jr.f,xU=_g,AU=Dr,fE="Array Iterator",MU=lE.set,PU=lE.getterFor(fE),IU=xU(Array,"Array",function(t,r){MU(this,{type:fE,target:EU(t),index:0,kind:r})},function(){var t=PU(this),r=t.target,e=t.kind,n=t.index++;return!r||n>=r.length?(t.target=void 0,{value:void 0,done:!0}):e=="keys"?{value:n,done:!1}:e=="values"?{value:r[n],done:!1}:{value:[n,r[n]],done:!1}},"values"),cE=uE.Arguments=uE.Array;Zg("keys");Zg("values");Zg("entries");if(AU&&cE.name!=="values")try{TU(cE,"name",{value:"values"})}catch{}var hE=ot,dE=CR,DU=OR,Dl=IU,Jg=yo,pE=ir,Qg=pE("iterator"),yE=pE("toStringTag"),eb=Dl.values,mE=function(t,r){if(t){if(t[Qg]!==eb)try{Jg(t,Qg,eb)}catch{t[Qg]=eb}if(t[yE]||Jg(t,yE,r),dE[r]){for(var e in Dl)if(t[e]!==Dl[e])try{Jg(t,e,Dl[e])}catch{t[e]=Dl[e]}}}};for(var tb in dE)mE(hE[tb]&&hE[tb].prototype,tb);mE(DU,"DOMTokenList");var NU=Dr,$U=dl.EXISTS,vE=ht,jU=jr.f,gE=Function.prototype,LU=vE(gE.toString),bE=/function\b(?:\s|\/\*[\S\s]*?\*\/|\/\/[^\n\r]*[\n\r]+)*([^\s(/]*)/,HU=vE(bE.exec),FU="name";NU&&!$U&&jU(gE,FU,{configurable:!0,get:function(){try{return HU(bE,LU(this))[1]}catch{return""}}});var BU=pt,VU=Mt,WU=Qr,wE=Gc,UU=aR,zU=VU(function(){wE(1)});BU({target:"Object",stat:!0,forced:zU,sham:!UU},{getPrototypeOf:function(r){return wE(WU(r))}});var YU=pt,GU=Ev.includes,KU=_l;YU({target:"Array",proto:!0},{includes:function(r){return GU(this,r,arguments.length>1?arguments[1]:void 0)}});KU("includes");var qU=gr,XU=co,ZU=ir,JU=ZU("match"),rb=function(t){var r;return qU(t)&&((r=t[JU])!==void 0?!!r:XU(t)=="RegExp")},QU=ot,ez=rb,tz=QU.TypeError,nb=function(t){if(ez(t))throw tz("The method doesn't accept regular expressions");return t},rz=ir,nz=rz("match"),ib=function(t){var r=/./;try{"/./"[t](r)}catch{try{return r[nz]=!1,"/./"[t](r)}catch{}}return!1},iz=pt,oz=ht,az=nb,sz=Jr,_E=xr,uz=ib,lz=oz("".indexOf);iz({target:"String",proto:!0,forced:!uz("includes")},{includes:function(r){return!!~lz(_E(sz(this)),_E(az(r)),arguments.length>1?arguments[1]:void 0)}});var fz=pt,cz=fa.filter,hz=gl,dz=hz("filter");fz({target:"Array",proto:!0,forced:!dz},{filter:function(r){return cz(this,r,arguments.length>1?arguments[1]:void 0)}});var pz=ot,yz=Nc,mz=Cc,vz=pz.TypeError,SE=function(t){if(yz(t))return t;throw vz(mz(t)+" is not a constructor")},CE=br,gz=SE,bz=ir,wz=bz("species"),_z=function(t,r){var e=CE(t).constructor,n;return e===void 0||(n=CE(e)[wz])==null?r:gz(n)},Sz=ca,Nl=$r,ob=ht,Cz=Uc,kz=rb,Oz=br,kE=Jr,Rz=_z,Ez=lg,Tz=la,ab=xr,xz=oa,OE=Mv,RE=zc,Az=Wc,Mz=eg,Pz=Mt,Ds=Mz.UNSUPPORTED_Y,EE=4294967295,Iz=Math.min,TE=[].push,Dz=ob(/./.exec),Ns=ob(TE),$l=ob("".slice),Nz=!Pz(function(){var t=/(?:)/,r=t.exec;t.exec=function(){return r.apply(this,arguments)};var e="ab".split(t);return e.length!==2||e[0]!=="a"||e[1]!=="b"});Cz("split",function(t,r,e){var n;return"abbc".split(/(b)*/)[1]=="c"||"test".split(/(?:)/,-1).length!=4||"ab".split(/(?:ab)*/).length!=2||".".split(/(.?)(.?)/).length!=4||".".split(/()()/).length>1||"".split(/.?/).length?n=function(i,o){var a=ab(kE(this)),s=o===void 0?EE:o>>>0;if(s===0)return[];if(i===void 0)return[a];if(!kz(i))return Nl(r,a,i,s);for(var l=[],p=(i.ignoreCase?"i":"")+(i.multiline?"m":"")+(i.unicode?"u":"")+(i.sticky?"y":""),d=0,g=new RegExp(i.source,p+"g"),y,h,u;(y=Nl(Az,g,a))&&(h=g.lastIndex,!(h>d&&(Ns(l,$l(a,d,y.index)),y.length>1&&y.index<a.length&&Sz(TE,l,OE(y,1)),u=y[0].length,d=h,l.length>=s)));)g.lastIndex===y.index&&g.lastIndex++;return d===a.length?(u||!Dz(g,""))&&Ns(l,""):Ns(l,$l(a,d)),l.length>s?OE(l,0,s):l}:"0".split(void 0,0).length?n=function(i,o){return i===void 0&&o===0?[]:Nl(r,this,i,o)}:n=r,[function(o,a){var s=kE(this),l=o==null?void 0:xz(o,t);return l?Nl(l,o,s,a):Nl(n,ab(s),o,a)},function(i,o){var a=Oz(this),s=ab(i),l=e(n,a,s,o,n!==r);if(l.done)return l.value;var p=Rz(a,RegExp),d=a.unicode,g=(a.ignoreCase?"i":"")+(a.multiline?"m":"")+(a.unicode?"u":"")+(Ds?"g":"y"),y=new p(Ds?"^(?:"+a.source+")":a,g),h=o===void 0?EE:o>>>0;if(h===0)return[];if(s.length===0)return RE(y,s)===null?[s]:[];for(var u=0,f=0,c=[];f<s.length;){y.lastIndex=Ds?0:f;var v=RE(y,Ds?$l(s,f):s),m;if(v===null||(m=Iz(Tz(y.lastIndex+(Ds?f:0)),s.length))===u)f=Ez(s,f,d);else{if(Ns(c,$l(s,u,f)),c.length===h)return c;for(var b=1;b<=v.length-1;b++)if(Ns(c,v[b]),c.length===h)return c;f=u=m}}return Ns(c,$l(s,u)),c}]},!Nz,Ds);var $z=ho,jz=jr,Lz=ir,Hz=Dr,xE=Lz("species"),AE=function(t){var r=$z(t),e=jz.f;Hz&&r&&!r[xE]&&e(r,xE,{configurable:!0,get:function(){return this}})},Fz=Dr,sb=ot,$s=ht,Bz=Mc,Vz=Lv,Wz=yo,Uz=jr.f,zz=ua.f,ME=po,Yz=rb,PE=xr,Gz=Xv,IE=eg,Kz=gn.exports,qz=Mt,Xz=Tr,Zz=yi.enforce,Jz=AE,Qz=ir,DE=P2,NE=I2,eY=Qz("match"),bi=sb.RegExp,js=bi.prototype,tY=sb.SyntaxError,rY=$s(Gz),nY=$s(js.exec),nh=$s("".charAt),$E=$s("".replace),jE=$s("".indexOf),iY=$s("".slice),oY=/^\?<[^\s\d!#%&*+<=>@^][^\s!#%&*+<=>@^]*>/,ma=/a/g,ub=/a/g,aY=new bi(ma)!==ma,LE=IE.MISSED_STICKY,sY=IE.UNSUPPORTED_Y,uY=Fz&&(!aY||LE||DE||NE||qz(function(){return ub[eY]=!1,bi(ma)!=ma||bi(ub)==ub||bi(ma,"i")!="/a/i"})),lY=function(t){for(var r=t.length,e=0,n="",i=!1,o;e<=r;e++){if(o=nh(t,e),o==="\\"){n+=o+nh(t,++e);continue}!i&&o==="."?n+="[\\s\\S]":(o==="["?i=!0:o==="]"&&(i=!1),n+=o)}return n},fY=function(t){for(var r=t.length,e=0,n="",i=[],o={},a=!1,s=!1,l=0,p="",d;e<=r;e++){if(d=nh(t,e),d==="\\")d=d+nh(t,++e);else if(d==="]")a=!1;else if(!a)switch(!0){case d==="[":a=!0;break;case d==="(":nY(oY,iY(t,e+1))&&(e+=2,s=!0),n+=d,l++;continue;case(d===">"&&s):if(p===""||Xz(o,p))throw new tY("Invalid capture group name");o[p]=!0,i[i.length]=[p,l],s=!1,p="";continue}s?p+=d:n+=d}return[n,i]};if(Bz("RegExp",uY)){for(var So=function(r,e){var n=ME(js,this),i=Yz(r),o=e===void 0,a=[],s=r,l,p,d,g,y,h;if(!n&&i&&o&&r.constructor===So)return r;if((i||ME(js,r))&&(r=r.source,o&&(e="flags"in s?s.flags:rY(s))),r=r===void 0?"":PE(r),e=e===void 0?"":PE(e),s=r,DE&&"dotAll"in ma&&(p=!!e&&jE(e,"s")>-1,p&&(e=$E(e,/s/g,""))),l=e,LE&&"sticky"in ma&&(d=!!e&&jE(e,"y")>-1,d&&sY&&(e=$E(e,/y/g,""))),NE&&(g=fY(r),r=g[0],a=g[1]),y=Vz(bi(r,e),n?this:js,So),(p||d||a.length)&&(h=Zz(y),p&&(h.dotAll=!0,h.raw=So(lY(r),l)),d&&(h.sticky=!0),a.length&&(h.groups=a)),r!==s)try{Wz(y,"source",s===""?"(?:)":s)}catch{}return y},cY=function(t){t in So||Uz(So,t,{configurable:!0,get:function(){return bi[t]},set:function(r){bi[t]=r}})},HE=zz(bi),FE=0;HE.length>FE;)cY(HE[FE++]);js.constructor=So,So.prototype=js,Kz(sb,"RegExp",So)}Jz("RegExp");var hY=ht,dY=dl.PROPER,pY=gn.exports,yY=br,mY=po,BE=xr,vY=Mt,gY=Xv,lb="toString",fb=RegExp.prototype,VE=fb[lb],bY=hY(gY),wY=vY(function(){return VE.call({source:"a",flags:"b"})!="/a/b"}),_Y=dY&&VE.name!=lb;(wY||_Y)&&pY(RegExp.prototype,lb,function(){var r=yY(this),e=BE(r.source),n=r.flags,i=BE(n===void 0&&mY(fb,r)&&!("flags"in fb)?bY(r):n);return"/"+e+"/"+i},{unsafe:!0});var SY=pt,CY=ht,kY=ul,OY=an,RY=Es,EY=CY([].join),TY=kY!=Object,xY=RY("join",",");SY({target:"Array",proto:!0,forced:TY||!xY},{join:function(r){return EY(OY(this),r===void 0?",":r)}});var AY=dl.PROPER,MY=Mt,WE=s2,UE="\u200B\x85\u180E",PY=function(t){return MY(function(){return!!WE[t]()||UE[t]()!==UE||AY&&WE[t].name!==t})},IY=pt,DY=l2.trim,NY=PY;IY({target:"String",proto:!0,forced:NY("trim")},{trim:function(){return DY(this)}});function ih(t){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?ih=function(e){return typeof e}:ih=function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ih(t)}var zE=0,oh=["ms","moz","webkit","o"],jl=window.requestAnimationFrame,ah=window.cancelAnimationFrame;for(var Ll=0;Ll<oh.length&&!jl;++Ll)jl=window["".concat(oh[Ll],"RequestAnimationFrame")],ah=window["".concat(oh[Ll],"CancelAnimationFrame")]||window["".concat(oh[Ll],"CancelRequestAnimationFrame")];jl||(jl=function(r){var e=new Date().getTime(),n=Math.max(0,16-(e-zE)),i=window.setTimeout(function(){r(e+n)},n);return zE=e+n,i});ah||(ah=function(r){clearTimeout(r)});function cb(t){return jl.call(window,t)}function YE(){return!!document.documentElement.classList}function GE(){return!!document.createTextNode("test").textContent}function KE(){return!!window.getComputedStyle}function Hl(t){ah.call(window,t)}function hb(){return"ontouchstart"in window}var db;function $Y(){var t=document.createElement("TABLE");t.style.borderSpacing="0",t.style.borderWidth="0",t.style.padding="0";var r=document.createElement("TBODY");t.appendChild(r),r.appendChild(document.createElement("TR")),r.firstChild.appendChild(document.createElement("TD")),r.firstChild.firstChild.innerHTML="<tr><td>t<br>t</td></tr>";var e=document.createElement("CAPTION");e.innerHTML="c<br>c<br>c<br>c",e.style.padding="0",e.style.margin="0",t.insertBefore(e,r),document.body.appendChild(t),db=t.offsetHeight<2*t.lastChild.offsetHeight,document.body.removeChild(t)}function pb(){return db===void 0&&$Y(),db}var Ls;function qE(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return Ls||((typeof Intl=="undefined"?"undefined":ih(Intl))==="object"?Ls=new Intl.Collator(t,r).compare:typeof String.prototype.localeCompare=="function"?Ls=function(n,i){return"".concat(n).localeCompare(i)}:Ls=function(n,i){return n===i?0:n>i?-1:1},Ls)}var Fl;function XE(){if(Fl!==void 0)return Fl;try{var t={get passive(){Fl=!0}};window.addEventListener("test",t,t),window.removeEventListener("test",t,t)}catch{Fl=!1}return Fl}var jY=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",requestAnimationFrame:cb,isClassListSupported:YE,isTextContentSupported:GE,isGetComputedStyleSupported:KE,cancelAnimationFrame:Hl,isTouchSupported:hb,hasCaptionProblem:pb,getComparisonFunction:qE,isPassiveEventSupported:XE}),Hs={exports:{}},LY=Mt,HY=LY(function(){if(typeof ArrayBuffer=="function"){var t=new ArrayBuffer(8);Object.isExtensible(t)&&Object.defineProperty(t,"a",{value:8})}}),FY=Mt,BY=gr,VY=co,ZE=HY,sh=Object.isExtensible,WY=FY(function(){sh(1)}),JE=WY||ZE?function(r){return!BY(r)||ZE&&VY(r)=="ArrayBuffer"?!1:sh?sh(r):!0}:sh,UY=Mt,QE=!UY(function(){return Object.isExtensible(Object.preventExtensions({}))}),zY=pt,YY=ht,GY=cl,KY=gr,yb=Tr,qY=jr.f,eT=ua,XY=Pc,mb=JE,ZY=kc,JY=QE,tT=!1,wi=ZY("meta"),QY=0,vb=function(t){qY(t,wi,{value:{objectID:"O"+QY++,weakData:{}}})},eG=function(t,r){if(!KY(t))return typeof t=="symbol"?t:(typeof t=="string"?"S":"P")+t;if(!yb(t,wi)){if(!mb(t))return"F";if(!r)return"E";vb(t)}return t[wi].objectID},tG=function(t,r){if(!yb(t,wi)){if(!mb(t))return!0;if(!r)return!1;vb(t)}return t[wi].weakData},rG=function(t){return JY&&tT&&mb(t)&&!yb(t,wi)&&vb(t),t},nG=function(){iG.enable=function(){},tT=!0;var t=eT.f,r=YY([].splice),e={};e[wi]=1,t(e).length&&(eT.f=function(n){for(var i=t(n),o=0,a=i.length;o<a;o++)if(i[o]===wi){r(i,o,1);break}return i},zY({target:"Object",stat:!0,forced:!0},{getOwnPropertyNames:XY.f}))},iG=Hs.exports={enable:nG,fastKey:eG,getWeakData:tG,onFreeze:rG};GY[wi]=!0;var oG=ot,aG=Sl,sG=$r,uG=br,lG=Cc,fG=Z2,cG=bn,rT=po,hG=Q2,dG=yg,nT=X2,pG=oG.TypeError,uh=function(t,r){this.stopped=t,this.result=r},iT=uh.prototype,gb=function(t,r,e){var n=e&&e.that,i=!!(e&&e.AS_ENTRIES),o=!!(e&&e.IS_ITERATOR),a=!!(e&&e.INTERRUPTED),s=aG(r,n),l,p,d,g,y,h,u,f=function(v){return l&&nT(l,"normal",v),new uh(!0,v)},c=function(v){return i?(uG(v),a?s(v[0],v[1],f):s(v[0],v[1])):a?s(v,f):s(v)};if(o)l=t;else{if(p=dG(t),!p)throw pG(lG(t)+" is not iterable");if(fG(p)){for(d=0,g=cG(t);g>d;d++)if(y=c(t[d]),y&&rT(iT,y))return y;return new uh(!1)}l=hG(t,p)}for(h=l.next;!(u=sG(h,l)).done;){try{y=c(u.value)}catch(v){nT(l,"throw",v)}if(typeof y=="object"&&y&&rT(iT,y))return y}return new uh(!1)},yG=ot,mG=po,vG=yG.TypeError,bb=function(t,r){if(mG(r,t))return t;throw vG("Incorrect invocation")},gG=pt,bG=ot,wG=ht,oT=Mc,_G=gn.exports,SG=Hs.exports,CG=gb,kG=bb,OG=ur,wb=gr,_b=Mt,RG=oR,EG=Kc,TG=Lv,lh=function(t,r,e){var n=t.indexOf("Map")!==-1,i=t.indexOf("Weak")!==-1,o=n?"set":"add",a=bG[t],s=a&&a.prototype,l=a,p={},d=function(v){var m=wG(s[v]);_G(s,v,v=="add"?function(w){return m(this,w===0?0:w),this}:v=="delete"?function(b){return i&&!wb(b)?!1:m(this,b===0?0:b)}:v=="get"?function(w){return i&&!wb(w)?void 0:m(this,w===0?0:w)}:v=="has"?function(w){return i&&!wb(w)?!1:m(this,w===0?0:w)}:function(w,_){return m(this,w===0?0:w,_),this})},g=oT(t,!OG(a)||!(i||s.forEach&&!_b(function(){new a().entries().next()})));if(g)l=e.getConstructor(r,t,n,o),SG.enable();else if(oT(t,!0)){var y=new l,h=y[o](i?{}:-0,1)!=y,u=_b(function(){y.has(1)}),f=RG(function(v){new a(v)}),c=!i&&_b(function(){for(var v=new a,m=5;m--;)v[o](m,m);return!v.has(-0)});f||(l=r(function(v,m){kG(v,s);var b=TG(new a,v,l);return m!=null&&CG(m,b[o],{that:b,AS_ENTRIES:n}),b}),l.prototype=s,s.constructor=l),(u||c)&&(d("delete"),d("has"),n&&d("get")),(c||h)&&d(o),i&&s.clear&&delete s.clear}return p[t]=l,gG({global:!0,forced:l!=a},p),EG(l,t),i||e.setStrong(l,t,n),l},xG=gn.exports,Sb=function(t,r,e){for(var n in r)xG(t,n,r[n],e);return t},AG=jr.f,MG=xs,aT=Sb,PG=Sl,IG=bb,DG=gb,NG=_g,$G=AE,Bl=Dr,sT=Hs.exports.fastKey,uT=yi,lT=uT.set,Cb=uT.getterFor,fT={getConstructor:function(t,r,e,n){var i=t(function(p,d){IG(p,o),lT(p,{type:r,index:MG(null),first:void 0,last:void 0,size:0}),Bl||(p.size=0),d!=null&&DG(d,p[n],{that:p,AS_ENTRIES:e})}),o=i.prototype,a=Cb(r),s=function(p,d,g){var y=a(p),h=l(p,d),u,f;return h?h.value=g:(y.last=h={index:f=sT(d,!0),key:d,value:g,previous:u=y.last,next:void 0,removed:!1},y.first||(y.first=h),u&&(u.next=h),Bl?y.size++:p.size++,f!=="F"&&(y.index[f]=h)),p},l=function(p,d){var g=a(p),y=sT(d),h;if(y!=="F")return g.index[y];for(h=g.first;h;h=h.next)if(h.key==d)return h};return aT(o,{clear:function(){for(var d=this,g=a(d),y=g.index,h=g.first;h;)h.removed=!0,h.previous&&(h.previous=h.previous.next=void 0),delete y[h.index],h=h.next;g.first=g.last=void 0,Bl?g.size=0:d.size=0},delete:function(p){var d=this,g=a(d),y=l(d,p);if(y){var h=y.next,u=y.previous;delete g.index[y.index],y.removed=!0,u&&(u.next=h),h&&(h.previous=u),g.first==y&&(g.first=h),g.last==y&&(g.last=u),Bl?g.size--:d.size--}return!!y},forEach:function(d){for(var g=a(this),y=PG(d,arguments.length>1?arguments[1]:void 0),h;h=h?h.next:g.first;)for(y(h.value,h.key,this);h&&h.removed;)h=h.previous},has:function(d){return!!l(this,d)}}),aT(o,e?{get:function(d){var g=l(this,d);return g&&g.value},set:function(d,g){return s(this,d===0?0:d,g)}}:{add:function(d){return s(this,d=d===0?0:d,d)}}),Bl&&AG(o,"size",{get:function(){return a(this).size}}),i},setStrong:function(t,r,e){var n=r+" Iterator",i=Cb(r),o=Cb(n);NG(t,r,function(a,s){lT(this,{type:n,target:a,state:i(a),kind:s,last:void 0})},function(){for(var a=o(this),s=a.kind,l=a.last;l&&l.removed;)l=l.previous;return!a.target||!(a.last=l=l?l.next:a.state.first)?(a.target=void 0,{value:void 0,done:!0}):s=="keys"?{value:l.key,done:!1}:s=="values"?{value:l.value,done:!1}:{value:[l.key,l.value],done:!1}},e?"entries":"values",!e,!0),$G(r)}},jG=lh,LG=fT;jG("Set",function(t){return function(){return t(this,arguments.length?arguments[0]:void 0)}},LG);function cT(t){for(var r=t.length,e=0;e<r;)t[e]=[t[e]],e+=1}function kb(t,r){for(var e=r.length,n=0;n<e;)t.push(r[n]),n+=1}function Vl(t){var r=[];if(!t||t.length===0||!t[0]||t[0].length===0)return r;for(var e=t.length,n=t[0].length,i=0;i<e;i++)for(var o=0;o<n;o++)r[o]||(r[o]=[]),r[o][i]=t[i][o];return r}function pr(t,r,e,n){var i=-1,o=t,a=e;Array.isArray(t)||(o=Array.from(t));var s=o.length;for(n&&s&&(i+=1,a=o[i]),i+=1;i<s;)a=r(a,o[i],i,o),i+=1;return a}function un(t,r){var e=0,n=t;Array.isArray(t)||(n=Array.from(t));for(var i=n.length,o=[],a=-1;e<i;){var s=n[e];r(s,e,n)&&(a+=1,o[a]=s),e+=1}return o}function bt(t,r){var e=0,n=t;Array.isArray(t)||(n=Array.from(t));for(var i=n.length,o=[],a=-1;e<i;){var s=n[e];a+=1,o[a]=r(s,e,n),e+=1}return o}function he(t,r){var e=0,n=t;Array.isArray(t)||(n=Array.from(t));for(var i=n.length;e<i&&r(n[e],e,n)!==!1;)e+=1;return t}function hT(t){return pr(t,function(r,e){return r+e},0)}function HG(t){return pr(t,function(r,e){return r>e?r:e},Array.isArray(t)?t[0]:void 0)}function FG(t){return pr(t,function(r,e){return r<e?r:e},Array.isArray(t)?t[0]:void 0)}function BG(t){return t.length?hT(t)/t.length:0}function dT(t){return pr(t,function(r,e){return r.concat(Array.isArray(e)?dT(e):e)},[])}function Ob(t){var r=[];return he(t,function(e){r.indexOf(e)===-1&&r.push(e)}),r}function Rb(){for(var t=arguments.length,r=new Array(t),e=0;e<t;e++)r[e]=arguments[e];var n=[].concat(r),i=n[0],o=n.slice(1),a=i;return he(o,function(s){a=a.filter(function(l){return!s.includes(l)})}),a}function VG(){for(var t=arguments.length,r=new Array(t),e=0;e<t;e++)r[e]=arguments[e];var n=[].concat(r),i=n[0],o=n.slice(1),a=i;return he(o,function(s){a=a.filter(function(l){return s.includes(l)})}),a}function WG(){for(var t=arguments.length,r=new Array(t),e=0;e<t;e++)r[e]=arguments[e];var n=[].concat(r),i=n[0],o=n.slice(1),a=new Set(i);return he(o,function(s){he(s,function(l){a.has(l)||a.add(l)})}),Array.from(a)}function Eb(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:" ";return t.split(r)}var UG=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",to2dArray:cT,extendArray:kb,pivot:Vl,arrayReduce:pr,arrayFilter:un,arrayMap:bt,arrayEach:he,arraySum:hT,arrayMax:HG,arrayMin:FG,arrayAvg:BG,arrayFlatten:dT,arrayUnique:Ob,getDifferenceOfArrays:Rb,getIntersectionOfArrays:VG,getUnionOfArrays:WG,stringToArray:Eb});function pT(t,r,e){return r in t?Object.defineProperty(t,r,{value:e,enumerable:!0,configurable:!0,writable:!0}):t[r]=e,t}function va(t){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?va=function(e){return typeof e}:va=function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},va(t)}function Fs(t){var r;return Array.isArray(t)?r=[]:(r={},Ot(t,function(e,n){n!=="__children"&&(e&&va(e)==="object"&&!Array.isArray(e)?r[n]=Fs(e):Array.isArray(e)?e.length&&va(e[0])==="object"&&!Array.isArray(e[0])?r[n]=[Fs(e[0])]:r[n]=[]:r[n]=null)})),r}function _i(t,r){return r.prototype.constructor=r,t.prototype=new r,t.prototype.constructor=t,t}function or(t,r,e){var n=Array.isArray(e);return Ot(r,function(i,o){(n===!1||e.includes(o))&&(t[o]=i)}),t}function Wl(t,r){Ot(r,function(e,n){r[n]&&va(r[n])==="object"?(t[n]||(Array.isArray(r[n])?t[n]=[]:Object.prototype.toString.call(r[n])==="[object Date]"?t[n]=r[n]:t[n]={}),Wl(t[n],r[n])):t[n]=r[n]})}function zr(t){return va(t)==="object"?JSON.parse(JSON.stringify(t)):t}function Br(t){var r={};return Ot(t,function(e,n){r[n]=e}),r}function Ut(t){t.MIXINS||(t.MIXINS=[]);for(var r=arguments.length,e=new Array(r>1?r-1:0),n=1;n<r;n++)e[n-1]=arguments[n];return he(e,function(i){t.MIXINS.push(i.MIXIN_NAME),Ot(i,function(o,a){if(t.prototype[a]!==void 0)throw new Error("Mixin conflict. Property '".concat(a,"' already exist and cannot be overwritten."));if(typeof o=="function")t.prototype[a]=o;else{var s=function(d,g){var y="_".concat(d),h=function(f){var c=f;return(Array.isArray(c)||vt(c))&&(c=zr(c)),c};return function(){return this[y]===void 0&&(this[y]=h(g)),this[y]}},l=function(d){var g="_".concat(d);return function(y){this[g]=y}};Object.defineProperty(t.prototype,a,{get:s(a,o),set:l(a),configurable:!0})}})}),t}function Tb(t,r){return JSON.stringify(t)===JSON.stringify(r)}function vt(t){return Object.prototype.toString.call(t)==="[object Object]"}function Gn(t,r,e,n){n.value=e,n.writable=n.writable!==!1,n.enumerable=n.enumerable!==!1,n.configurable=n.configurable!==!1,Object.defineProperty(t,r,n)}function Ot(t,r){for(var e in t)if((!t.hasOwnProperty||t.hasOwnProperty&&Object.prototype.hasOwnProperty.call(t,e))&&r(t[e],e,t)===!1)break;return t}function yT(t,r){var e=r.split("."),n=t;return Ot(e,function(i){if(n=n[i],n===void 0)return n=void 0,!1}),n}function fh(t,r,e){var n=r.split("."),i=t;n.forEach(function(o,a){a!==n.length-1?(Yt(i,o)||(i[o]={}),i=i[o]):i[o]=e})}function ch(t){if(!vt(t))return 0;var r=function e(n){var i=0;return vt(n)?Ot(n,function(o,a){a!=="__children"&&(i+=e(o))}):i+=1,i};return r(t)}function ga(t){var r,e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"value",n="_".concat(e),i=(r={_touched:!1},pT(r,n,t),pT(r,"isTouched",function(){return this._touched}),r);return Object.defineProperty(i,e,{get:function(){return this[n]},set:function(a){this._touched=!0,this[n]=a},enumerable:!0,configurable:!0}),i}function Yt(t,r){return Object.prototype.hasOwnProperty.call(t,r)}var zG=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",duckSchema:Fs,inherit:_i,extend:or,deepExtend:Wl,deepClone:zr,clone:Br,mixin:Ut,isObjectEqual:Tb,isObject:vt,defineGetter:Gn,objectEach:Ot,getProperty:yT,setProperty:fh,deepObjectSize:ch,createObjectPropListener:ga,hasOwnProperty:Yt}),tn=function(r){var e={value:!1};return e.test=function(n,i){e.value=r(n,i)},e},ln={chrome:tn(function(t,r){return/Chrome/.test(t)&&/Google/.test(r)}),chromeWebKit:tn(function(t){return/CriOS/.test(t)}),edge:tn(function(t){return/Edge/.test(t)}),edgeWebKit:tn(function(t){return/EdgiOS/.test(t)}),firefox:tn(function(t){return/Firefox/.test(t)}),firefoxWebKit:tn(function(t){return/FxiOS/.test(t)}),ie:tn(function(t){return/Trident/.test(t)}),ie9:tn(function(){return!!document.documentMode}),mobile:tn(function(t){return/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(t)}),safari:tn(function(t,r){return/Safari/.test(t)&&/Apple Computer/.test(r)})},Bs={mac:tn(function(t){return/^Mac/.test(t)}),win:tn(function(t){return/^Win/.test(t)}),linux:tn(function(t){return/^Linux/.test(t)}),ios:tn(function(t){return/iPhone|iPad|iPod/i.test(t)})};function mT(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},r=t.userAgent,e=r===void 0?navigator.userAgent:r,n=t.vendor,i=n===void 0?navigator.vendor:n;Ot(ln,function(o){var a=o.test;return void a(e,i)})}function vT(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},r=t.platform,e=r===void 0?navigator.platform:r;Ot(Bs,function(n){var i=n.test;return void i(e)})}mT();vT();function gT(){return ln.chrome.value}function bT(){return ln.chromeWebKit.value}function hh(){return ln.firefox.value}function wT(){return ln.firefoxWebKit.value}function _T(){return ln.safari.value}function ST(){return ln.edge.value}function YG(){return ln.edgeWebKit.value}function CT(){return ln.ie.value}function kT(){return ln.ie9.value}function GG(){return ln.ie.value||ln.edge.value}function In(){return ln.mobile.value}function xb(){return Bs.ios.value}function Ab(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:navigator,r=t.maxTouchPoints;return r>2&&Bs.mac.value}function Mb(){return Bs.win.value}function OT(){return Bs.mac.value}function KG(){return Bs.linux.value}var qG=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",setBrowserMeta:mT,setPlatformMeta:vT,isChrome:gT,isChromeWebKit:bT,isFirefox:hh,isFirefoxWebKit:wT,isSafari:_T,isEdge:ST,isEdgeWebKit:YG,isIE:CT,isIE9:kT,isMSBrowser:GG,isMobileBrowser:In,isIOS:xb,isIpadOS:Ab,isWindowsOS:Mb,isMacOS:OT,isLinuxOS:KG});/*! @license DOMPurify 2.3.4 | (c) Cure53 and other contributors | Released under the Apache license 2.0 and Mozilla Public License 2.0 | github.com/cure53/DOMPurify/blob/2.3.4/LICENSE */function XG(t){if(Array.isArray(t)){for(var r=0,e=Array(t.length);r<t.length;r++)e[r]=t[r];return e}else return Array.from(t)}var ZG=Object.hasOwnProperty,RT=Object.setPrototypeOf,JG=Object.isFrozen,QG=Object.getPrototypeOf,eK=Object.getOwnPropertyDescriptor,Yr=Object.freeze,Si=Object.seal,tK=Object.create,ET=typeof Reflect!="undefined"&&Reflect,dh=ET.apply,Pb=ET.construct;dh||(dh=function(r,e,n){return r.apply(e,n)});Yr||(Yr=function(r){return r});Si||(Si=function(r){return r});Pb||(Pb=function(r,e){return new(Function.prototype.bind.apply(r,[null].concat(XG(e))))});var rK=Dn(Array.prototype.forEach),TT=Dn(Array.prototype.pop),Ul=Dn(Array.prototype.push),ph=Dn(String.prototype.toLowerCase),xT=Dn(String.prototype.match),Co=Dn(String.prototype.replace),nK=Dn(String.prototype.indexOf),iK=Dn(String.prototype.trim),fn=Dn(RegExp.prototype.test),AT=oK(TypeError);function Dn(t){return function(r){for(var e=arguments.length,n=Array(e>1?e-1:0),i=1;i<e;i++)n[i-1]=arguments[i];return dh(t,r,n)}}function oK(t){return function(){for(var r=arguments.length,e=Array(r),n=0;n<r;n++)e[n]=arguments[n];return Pb(t,e)}}function Tt(t,r){RT&&RT(t,null);for(var e=r.length;e--;){var n=r[e];if(typeof n=="string"){var i=ph(n);i!==n&&(JG(r)||(r[e]=i),n=i)}t[n]=!0}return t}function ba(t){var r=tK(null),e=void 0;for(e in t)dh(ZG,t,[e])&&(r[e]=t[e]);return r}function yh(t,r){for(;t!==null;){var e=eK(t,r);if(e){if(e.get)return Dn(e.get);if(typeof e.value=="function")return Dn(e.value)}t=QG(t)}function n(i){return console.warn("fallback value for",i),null}return n}var MT=Yr(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),Ib=Yr(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),Db=Yr(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),aK=Yr(["animate","color-profile","cursor","discard","fedropshadow","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),Nb=Yr(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover"]),sK=Yr(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),PT=Yr(["#text"]),IT=Yr(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","xmlns","slot"]),$b=Yr(["accent-height","accumulate","additive","alignment-baseline","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","targetx","targety","transform","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),DT=Yr(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),mh=Yr(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),uK=Si(/\{\{[\s\S]*|[\s\S]*\}\}/gm),lK=Si(/<%[\s\S]*|[\s\S]*%>/gm),fK=Si(/^data-[\-\w.\u00B7-\uFFFF]/),cK=Si(/^aria-[\-\w]+$/),hK=Si(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|cid|xmpp):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),dK=Si(/^(?:\w+script|data):/i),pK=Si(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),zl=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};function Kn(t){if(Array.isArray(t)){for(var r=0,e=Array(t.length);r<t.length;r++)e[r]=t[r];return e}else return Array.from(t)}var yK=function(){return typeof window=="undefined"?null:window},mK=function(r,e){if((typeof r=="undefined"?"undefined":zl(r))!=="object"||typeof r.createPolicy!="function")return null;var n=null,i="data-tt-policy-suffix";e.currentScript&&e.currentScript.hasAttribute(i)&&(n=e.currentScript.getAttribute(i));var o="dompurify"+(n?"#"+n:"");try{return r.createPolicy(o,{createHTML:function(s){return s}})}catch{return console.warn("TrustedTypes policy "+o+" could not be created."),null}};function NT(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:yK(),r=function(ce){return NT(ce)};if(r.version="2.3.4",r.removed=[],!t||!t.document||t.document.nodeType!==9)return r.isSupported=!1,r;var e=t.document,n=t.document,i=t.DocumentFragment,o=t.HTMLTemplateElement,a=t.Node,s=t.Element,l=t.NodeFilter,p=t.NamedNodeMap,d=p===void 0?t.NamedNodeMap||t.MozNamedAttrMap:p,g=t.HTMLFormElement,y=t.DOMParser,h=t.trustedTypes,u=s.prototype,f=yh(u,"cloneNode"),c=yh(u,"nextSibling"),v=yh(u,"childNodes"),m=yh(u,"parentNode");if(typeof o=="function"){var b=n.createElement("template");b.content&&b.content.ownerDocument&&(n=b.content.ownerDocument)}var w=mK(h,e),_=w&&ge?w.createHTML(""):"",C=n,R=C.implementation,I=C.createNodeIterator,P=C.createDocumentFragment,N=C.getElementsByTagName,A=e.importNode,$={};try{$=ba(n).documentMode?n.documentMode:{}}catch{}var T={};r.isSupported=typeof m=="function"&&R&&typeof R.createHTMLDocument!="undefined"&&$!==9;var M=uK,S=lK,E=fK,k=cK,O=dK,x=pK,j=hK,H=null,F=Tt({},[].concat(Kn(MT),Kn(Ib),Kn(Db),Kn(Nb),Kn(PT))),V=null,W=Tt({},[].concat(Kn(IT),Kn($b),Kn(DT),Kn(mh))),U=Object.seal(Object.create(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),Y=null,K=null,D=!0,L=!0,B=!1,z=!1,q=!1,X=!1,ee=!1,ye=!1,de=!1,ge=!1,we=!0,be=!0,J=!1,te={},ie=null,fe=Tt({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]),se=null,oe=Tt({},["audio","video","img","source","image","track"]),G=null,Z=Tt({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),Q="http://www.w3.org/1998/Math/MathML",re="http://www.w3.org/2000/svg",ne="http://www.w3.org/1999/xhtml",ue=ne,le=!1,ve=void 0,Se=["application/xhtml+xml","text/html"],Oe="text/html",xe=void 0,Ce=null,Le=n.createElement("form"),Ve=function(ce){return ce instanceof RegExp||ce instanceof Function},Je=function(ce){Ce&&Ce===ce||((!ce||(typeof ce=="undefined"?"undefined":zl(ce))!=="object")&&(ce={}),ce=ba(ce),H="ALLOWED_TAGS"in ce?Tt({},ce.ALLOWED_TAGS):F,V="ALLOWED_ATTR"in ce?Tt({},ce.ALLOWED_ATTR):W,G="ADD_URI_SAFE_ATTR"in ce?Tt(ba(Z),ce.ADD_URI_SAFE_ATTR):Z,se="ADD_DATA_URI_TAGS"in ce?Tt(ba(oe),ce.ADD_DATA_URI_TAGS):oe,ie="FORBID_CONTENTS"in ce?Tt({},ce.FORBID_CONTENTS):fe,Y="FORBID_TAGS"in ce?Tt({},ce.FORBID_TAGS):{},K="FORBID_ATTR"in ce?Tt({},ce.FORBID_ATTR):{},te="USE_PROFILES"in ce?ce.USE_PROFILES:!1,D=ce.ALLOW_ARIA_ATTR!==!1,L=ce.ALLOW_DATA_ATTR!==!1,B=ce.ALLOW_UNKNOWN_PROTOCOLS||!1,z=ce.SAFE_FOR_TEMPLATES||!1,q=ce.WHOLE_DOCUMENT||!1,ye=ce.RETURN_DOM||!1,de=ce.RETURN_DOM_FRAGMENT||!1,ge=ce.RETURN_TRUSTED_TYPE||!1,ee=ce.FORCE_BODY||!1,we=ce.SANITIZE_DOM!==!1,be=ce.KEEP_CONTENT!==!1,J=ce.IN_PLACE||!1,j=ce.ALLOWED_URI_REGEXP||j,ue=ce.NAMESPACE||ne,ce.CUSTOM_ELEMENT_HANDLING&&Ve(ce.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(U.tagNameCheck=ce.CUSTOM_ELEMENT_HANDLING.tagNameCheck),ce.CUSTOM_ELEMENT_HANDLING&&Ve(ce.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(U.attributeNameCheck=ce.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),ce.CUSTOM_ELEMENT_HANDLING&&typeof ce.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements=="boolean"&&(U.allowCustomizedBuiltInElements=ce.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),ve=Se.indexOf(ce.PARSER_MEDIA_TYPE)===-1?ve=Oe:ve=ce.PARSER_MEDIA_TYPE,xe=ve==="application/xhtml+xml"?function(Ee){return Ee}:ph,z&&(L=!1),de&&(ye=!0),te&&(H=Tt({},[].concat(Kn(PT))),V=[],te.html===!0&&(Tt(H,MT),Tt(V,IT)),te.svg===!0&&(Tt(H,Ib),Tt(V,$b),Tt(V,mh)),te.svgFilters===!0&&(Tt(H,Db),Tt(V,$b),Tt(V,mh)),te.mathMl===!0&&(Tt(H,Nb),Tt(V,DT),Tt(V,mh))),ce.ADD_TAGS&&(H===F&&(H=ba(H)),Tt(H,ce.ADD_TAGS)),ce.ADD_ATTR&&(V===W&&(V=ba(V)),Tt(V,ce.ADD_ATTR)),ce.ADD_URI_SAFE_ATTR&&Tt(G,ce.ADD_URI_SAFE_ATTR),ce.FORBID_CONTENTS&&(ie===fe&&(ie=ba(ie)),Tt(ie,ce.FORBID_CONTENTS)),be&&(H["#text"]=!0),q&&Tt(H,["html","head","body"]),H.table&&(Tt(H,["tbody"]),delete Y.tbody),Yr&&Yr(ce),Ce=ce)},ft=Tt({},["mi","mo","mn","ms","mtext"]),Ct=Tt({},["foreignobject","desc","title","annotation-xml"]),Ye=Tt({},Ib);Tt(Ye,Db),Tt(Ye,aK);var et=Tt({},Nb);Tt(et,sK);var Te=function(ce){var Ee=m(ce);(!Ee||!Ee.tagName)&&(Ee={namespaceURI:ne,tagName:"template"});var Re=ph(ce.tagName),Ge=ph(Ee.tagName);if(ce.namespaceURI===re)return Ee.namespaceURI===ne?Re==="svg":Ee.namespaceURI===Q?Re==="svg"&&(Ge==="annotation-xml"||ft[Ge]):Boolean(Ye[Re]);if(ce.namespaceURI===Q)return Ee.namespaceURI===ne?Re==="math":Ee.namespaceURI===re?Re==="math"&&Ct[Ge]:Boolean(et[Re]);if(ce.namespaceURI===ne){if(Ee.namespaceURI===re&&!Ct[Ge]||Ee.namespaceURI===Q&&!ft[Ge])return!1;var Xe=Tt({},["title","style","font","a","script"]);return!et[Re]&&(Xe[Re]||!Ye[Re])}return!1},We=function(ce){Ul(r.removed,{element:ce});try{ce.parentNode.removeChild(ce)}catch{try{ce.outerHTML=_}catch{ce.remove()}}},rt=function(ce,Ee){try{Ul(r.removed,{attribute:Ee.getAttributeNode(ce),from:Ee})}catch{Ul(r.removed,{attribute:null,from:Ee})}if(Ee.removeAttribute(ce),ce==="is"&&!V[ce])if(ye||de)try{We(Ee)}catch{}else try{Ee.setAttribute(ce,"")}catch{}},Rt=function(ce){var Ee=void 0,Re=void 0;if(ee)ce="<remove></remove>"+ce;else{var Ge=xT(ce,/^[\r\n\t ]+/);Re=Ge&&Ge[0]}ve==="application/xhtml+xml"&&(ce='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+ce+"</body></html>");var Xe=w?w.createHTML(ce):ce;if(ue===ne)try{Ee=new y().parseFromString(Xe,ve)}catch{}if(!Ee||!Ee.documentElement){Ee=R.createDocument(ue,"template",null);try{Ee.documentElement.innerHTML=le?"":Xe}catch{}}var qe=Ee.body||Ee.documentElement;return ce&&Re&&qe.insertBefore(n.createTextNode(Re),qe.childNodes[0]||null),ue===ne?N.call(Ee,q?"html":"body")[0]:q?Ee.documentElement:qe},ut=function(ce){return I.call(ce.ownerDocument||ce,ce,l.SHOW_ELEMENT|l.SHOW_COMMENT|l.SHOW_TEXT,null,!1)},$t=function(ce){return ce instanceof g&&(typeof ce.nodeName!="string"||typeof ce.textContent!="string"||typeof ce.removeChild!="function"||!(ce.attributes instanceof d)||typeof ce.removeAttribute!="function"||typeof ce.setAttribute!="function"||typeof ce.namespaceURI!="string"||typeof ce.insertBefore!="function")},Et=function(ce){return(typeof a=="undefined"?"undefined":zl(a))==="object"?ce instanceof a:ce&&(typeof ce=="undefined"?"undefined":zl(ce))==="object"&&typeof ce.nodeType=="number"&&typeof ce.nodeName=="string"},nt=function(ce,Ee,Re){!T[ce]||rK(T[ce],function(Ge){Ge.call(r,Ee,Re,Ce)})},Ft=function(ce){var Ee=void 0;if(nt("beforeSanitizeElements",ce,null),$t(ce)||xT(ce.nodeName,/[\u0080-\uFFFF]/))return We(ce),!0;var Re=xe(ce.nodeName);if(nt("uponSanitizeElement",ce,{tagName:Re,allowedTags:H}),!Et(ce.firstElementChild)&&(!Et(ce.content)||!Et(ce.content.firstElementChild))&&fn(/<[/\w]/g,ce.innerHTML)&&fn(/<[/\w]/g,ce.textContent)||Re==="select"&&fn(/<template/i,ce.innerHTML))return We(ce),!0;if(!H[Re]||Y[Re]){if(be&&!ie[Re]){var Ge=m(ce)||ce.parentNode,Xe=v(ce)||ce.childNodes;if(Xe&&Ge)for(var qe=Xe.length,kt=qe-1;kt>=0;--kt)Ge.insertBefore(f(Xe[kt],!0),c(ce))}return!Y[Re]&&me(Re)&&(U.tagNameCheck instanceof RegExp&&fn(U.tagNameCheck,Re)||U.tagNameCheck instanceof Function&&U.tagNameCheck(Re))?!1:(We(ce),!0)}return ce instanceof s&&!Te(ce)||(Re==="noscript"||Re==="noembed")&&fn(/<\/no(script|embed)/i,ce.innerHTML)?(We(ce),!0):(z&&ce.nodeType===3&&(Ee=ce.textContent,Ee=Co(Ee,M," "),Ee=Co(Ee,S," "),ce.textContent!==Ee&&(Ul(r.removed,{element:ce.cloneNode()}),ce.textContent=Ee)),nt("afterSanitizeElements",ce,null),!1)},pe=function(ce,Ee,Re){if(we&&(Ee==="id"||Ee==="name")&&(Re in n||Re in Le))return!1;if(!(L&&!K[Ee]&&fn(E,Ee))){if(!(D&&fn(k,Ee))){if(!V[Ee]||K[Ee]){if(!(me(ce)&&(U.tagNameCheck instanceof RegExp&&fn(U.tagNameCheck,ce)||U.tagNameCheck instanceof Function&&U.tagNameCheck(ce))&&(U.attributeNameCheck instanceof RegExp&&fn(U.attributeNameCheck,Ee)||U.attributeNameCheck instanceof Function&&U.attributeNameCheck(Ee))||Ee==="is"&&U.allowCustomizedBuiltInElements&&(U.tagNameCheck instanceof RegExp&&fn(U.tagNameCheck,Re)||U.tagNameCheck instanceof Function&&U.tagNameCheck(Re))))return!1}else if(!G[Ee]){if(!fn(j,Co(Re,x,""))){if(!((Ee==="src"||Ee==="xlink:href"||Ee==="href")&&ce!=="script"&&nK(Re,"data:")===0&&se[ce])){if(!(B&&!fn(O,Co(Re,x,"")))){if(Re)return!1}}}}}}return!0},me=function(ce){return ce.indexOf("-")>0},Me=function(ce){var Ee=void 0,Re=void 0,Ge=void 0,Xe=void 0;nt("beforeSanitizeAttributes",ce,null);var qe=ce.attributes;if(!!qe){var kt={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:V};for(Xe=qe.length;Xe--;){Ee=qe[Xe];var Ht=Ee,jt=Ht.name,dr=Ht.namespaceURI;if(Re=iK(Ee.value),Ge=xe(jt),kt.attrName=Ge,kt.attrValue=Re,kt.keepAttr=!0,kt.forceKeepAttr=void 0,nt("uponSanitizeAttribute",ce,kt),Re=kt.attrValue,!kt.forceKeepAttr&&(rt(jt,ce),!!kt.keepAttr)){if(fn(/\/>/i,Re)){rt(jt,ce);continue}z&&(Re=Co(Re,M," "),Re=Co(Re,S," "));var vr=xe(ce.nodeName);if(!!pe(vr,Ge,Re))try{dr?ce.setAttributeNS(dr,jt,Re):ce.setAttribute(jt,Re),TT(r.removed)}catch{}}}nt("afterSanitizeAttributes",ce,null)}},He=function Ae(ce){var Ee=void 0,Re=ut(ce);for(nt("beforeSanitizeShadowDOM",ce,null);Ee=Re.nextNode();)nt("uponSanitizeShadowNode",Ee,null),!Ft(Ee)&&(Ee.content instanceof i&&Ae(Ee.content),Me(Ee));nt("afterSanitizeShadowDOM",ce,null)};return r.sanitize=function(Ae,ce){var Ee=void 0,Re=void 0,Ge=void 0,Xe=void 0,qe=void 0;if(le=!Ae,le&&(Ae="<!-->"),typeof Ae!="string"&&!Et(Ae)){if(typeof Ae.toString!="function")throw AT("toString is not a function");if(Ae=Ae.toString(),typeof Ae!="string")throw AT("dirty is not a string, aborting")}if(!r.isSupported){if(zl(t.toStaticHTML)==="object"||typeof t.toStaticHTML=="function"){if(typeof Ae=="string")return t.toStaticHTML(Ae);if(Et(Ae))return t.toStaticHTML(Ae.outerHTML)}return Ae}if(X||Je(ce),r.removed=[],typeof Ae=="string"&&(J=!1),!J)if(Ae instanceof a)Ee=Rt("<!---->"),Re=Ee.ownerDocument.importNode(Ae,!0),Re.nodeType===1&&Re.nodeName==="BODY"||Re.nodeName==="HTML"?Ee=Re:Ee.appendChild(Re);else{if(!ye&&!z&&!q&&Ae.indexOf("<")===-1)return w&&ge?w.createHTML(Ae):Ae;if(Ee=Rt(Ae),!Ee)return ye?null:_}Ee&&ee&&We(Ee.firstChild);for(var kt=ut(J?Ae:Ee);Ge=kt.nextNode();)Ge.nodeType===3&&Ge===Xe||Ft(Ge)||(Ge.content instanceof i&&He(Ge.content),Me(Ge),Xe=Ge);if(Xe=null,J)return Ae;if(ye){if(de)for(qe=P.call(Ee.ownerDocument);Ee.firstChild;)qe.appendChild(Ee.firstChild);else qe=Ee;return V.shadowroot&&(qe=A.call(e,qe,!0)),qe}var Ht=q?Ee.outerHTML:Ee.innerHTML;return z&&(Ht=Co(Ht,M," "),Ht=Co(Ht,S," ")),w&&ge?w.createHTML(Ht):Ht},r.setConfig=function(Ae){Je(Ae),X=!0},r.clearConfig=function(){Ce=null,X=!1},r.isValidAttribute=function(Ae,ce,Ee){Ce||Je({});var Re=xe(Ae),Ge=xe(ce);return pe(Re,Ge,Ee)},r.addHook=function(Ae,ce){typeof ce=="function"&&(T[Ae]=T[Ae]||[],Ul(T[Ae],ce))},r.removeHook=function(Ae){T[Ae]&&TT(T[Ae])},r.removeHooks=function(Ae){T[Ae]&&(T[Ae]=[])},r.removeAllHooks=function(){T={}},r}var vK=NT(),gK=pt,bK=QE,wK=Mt,_K=gr,SK=Hs.exports.onFreeze,jb=Object.freeze,CK=wK(function(){jb(1)});gK({target:"Object",stat:!0,forced:CK,sham:!bK},{freeze:function(r){return jb&&_K(r)?jb(SK(r)):r}});var kK=pt,OK=ug.codeAt;kK({target:"String",proto:!0},{codePointAt:function(r){return OK(this,r)}});var RK=ot,EK=mo,TK=xr,xK=Jr,AK=RK.RangeError,$T=function(r){var e=TK(xK(this)),n="",i=EK(r);if(i<0||i==1/0)throw AK("Wrong number of repetitions");for(;i>0;(i>>>=1)&&(e+=e))i&1&&(n+=e);return n},jT=ht,MK=la,LT=xr,PK=$T,IK=Jr,DK=jT(PK),NK=jT("".slice),$K=Math.ceil,HT=function(t){return function(r,e,n){var i=LT(IK(r)),o=MK(e),a=i.length,s=n===void 0?" ":LT(n),l,p;return o<=a||s==""?i:(l=o-a,p=DK(s,$K(l/s.length)),p.length>l&&(p=NK(p,0,l)),t?i+p:p+i)}},jK={start:HT(!1),end:HT(!0)},LK=ia,HK=/Version\/10(?:\.\d+){1,2}(?: [\w./]+)?(?: Mobile\/\w+)? Safari\//.test(LK),FK=pt,BK=jK.start,VK=HK;FK({target:"String",proto:!0,forced:VK},{padStart:function(r){return BK(this,r,arguments.length>1?arguments[1]:void 0)}});var FT;function $e(){return FT.apply(null,arguments)}function WK(t){FT=t}function qn(t){return t instanceof Array||Object.prototype.toString.call(t)==="[object Array]"}function Yl(t){return t!=null&&Object.prototype.toString.call(t)==="[object Object]"}function UK(t){if(Object.getOwnPropertyNames)return Object.getOwnPropertyNames(t).length===0;var r;for(r in t)if(t.hasOwnProperty(r))return!1;return!0}function rn(t){return t===void 0}function wa(t){return typeof t=="number"||Object.prototype.toString.call(t)==="[object Number]"}function vh(t){return t instanceof Date||Object.prototype.toString.call(t)==="[object Date]"}function BT(t,r){var e=[],n;for(n=0;n<t.length;++n)e.push(r(t[n],n));return e}function wr(t,r){return Object.prototype.hasOwnProperty.call(t,r)}function ko(t,r){for(var e in r)wr(r,e)&&(t[e]=r[e]);return wr(r,"toString")&&(t.toString=r.toString),wr(r,"valueOf")&&(t.valueOf=r.valueOf),t}function Xn(t,r,e,n){return mx(t,r,e,n,!0).utc()}function zK(){return{empty:!1,unusedTokens:[],unusedInput:[],overflow:-2,charsLeftOver:0,nullInput:!1,invalidMonth:null,invalidFormat:!1,userInvalidated:!1,iso:!1,parsedDateParts:[],meridiem:null,rfc2822:!1,weekdayMismatch:!1}}function xt(t){return t._pf==null&&(t._pf=zK()),t._pf}var Lb;Array.prototype.some?Lb=Array.prototype.some:Lb=function(t){for(var r=Object(this),e=r.length>>>0,n=0;n<e;n++)if(n in r&&t.call(this,r[n],n,r))return!0;return!1};function Hb(t){if(t._isValid==null){var r=xt(t),e=Lb.call(r.parsedDateParts,function(i){return i!=null}),n=!isNaN(t._d.getTime())&&r.overflow<0&&!r.empty&&!r.invalidMonth&&!r.invalidWeekday&&!r.weekdayMismatch&&!r.nullInput&&!r.invalidFormat&&!r.userInvalidated&&(!r.meridiem||r.meridiem&&e);if(t._strict&&(n=n&&r.charsLeftOver===0&&r.unusedTokens.length===0&&r.bigHour===void 0),Object.isFrozen==null||!Object.isFrozen(t))t._isValid=n;else return n}return t._isValid}function gh(t){var r=Xn(NaN);return t!=null?ko(xt(r),t):xt(r).userInvalidated=!0,r}var Fb=$e.momentProperties=[];function Bb(t,r){var e,n,i;if(rn(r._isAMomentObject)||(t._isAMomentObject=r._isAMomentObject),rn(r._i)||(t._i=r._i),rn(r._f)||(t._f=r._f),rn(r._l)||(t._l=r._l),rn(r._strict)||(t._strict=r._strict),rn(r._tzm)||(t._tzm=r._tzm),rn(r._isUTC)||(t._isUTC=r._isUTC),rn(r._offset)||(t._offset=r._offset),rn(r._pf)||(t._pf=xt(r)),rn(r._locale)||(t._locale=r._locale),Fb.length>0)for(e=0;e<Fb.length;e++)n=Fb[e],i=r[n],rn(i)||(t[n]=i);return t}var Vb=!1;function Gl(t){Bb(this,t),this._d=new Date(t._d!=null?t._d.getTime():NaN),this.isValid()||(this._d=new Date(NaN)),Vb===!1&&(Vb=!0,$e.updateOffset(this),Vb=!1)}function Zn(t){return t instanceof Gl||t!=null&&t._isAMomentObject!=null}function _n(t){return t<0?Math.ceil(t)||0:Math.floor(t)}function Pt(t){var r=+t,e=0;return r!==0&&isFinite(r)&&(e=_n(r)),e}function VT(t,r,e){var n=Math.min(t.length,r.length),i=Math.abs(t.length-r.length),o=0,a;for(a=0;a<n;a++)(e&&t[a]!==r[a]||!e&&Pt(t[a])!==Pt(r[a]))&&o++;return o+i}function WT(t){$e.suppressDeprecationWarnings===!1&&typeof console!="undefined"&&console.warn&&console.warn("Deprecation warning: "+t)}function Sn(t,r){var e=!0;return ko(function(){if($e.deprecationHandler!=null&&$e.deprecationHandler(null,t),e){for(var n=[],i,o=0;o<arguments.length;o++){if(i="",typeof arguments[o]=="object"){i+=`
[`+o+"] ";for(var a in arguments[0])i+=a+": "+arguments[0][a]+", ";i=i.slice(0,-2)}else i=arguments[o];n.push(i)}WT(t+`
Arguments: `+Array.prototype.slice.call(n).join("")+`
`+new Error().stack),e=!1}return r.apply(this,arguments)},r)}var UT={};function zT(t,r){$e.deprecationHandler!=null&&$e.deprecationHandler(t,r),UT[t]||(WT(r),UT[t]=!0)}$e.suppressDeprecationWarnings=!1;$e.deprecationHandler=null;function Jn(t){return t instanceof Function||Object.prototype.toString.call(t)==="[object Function]"}function YK(t){var r,e;for(e in t)r=t[e],Jn(r)?this[e]=r:this["_"+e]=r;this._config=t,this._dayOfMonthOrdinalParseLenient=new RegExp((this._dayOfMonthOrdinalParse.source||this._ordinalParse.source)+"|"+/\d{1,2}/.source)}function YT(t,r){var e=ko({},t),n;for(n in r)wr(r,n)&&(Yl(t[n])&&Yl(r[n])?(e[n]={},ko(e[n],t[n]),ko(e[n],r[n])):r[n]!=null?e[n]=r[n]:delete e[n]);for(n in t)wr(t,n)&&!wr(r,n)&&Yl(t[n])&&(e[n]=ko({},e[n]));return e}function Wb(t){t!=null&&this.set(t)}var Ub;Object.keys?Ub=Object.keys:Ub=function(t){var r,e=[];for(r in t)wr(t,r)&&e.push(r);return e};var GK={sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"};function KK(t,r,e){var n=this._calendar[t]||this._calendar.sameElse;return Jn(n)?n.call(r,e):n}var qK={LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"};function XK(t){var r=this._longDateFormat[t],e=this._longDateFormat[t.toUpperCase()];return r||!e?r:(this._longDateFormat[t]=e.replace(/MMMM|MM|DD|dddd/g,function(n){return n.slice(1)}),this._longDateFormat[t])}var ZK="Invalid date";function JK(){return this._invalidDate}var QK="%d",eq=/\d{1,2}/;function tq(t){return this._ordinal.replace("%d",t)}var rq={future:"in %s",past:"%s ago",s:"a few seconds",ss:"%d seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"};function nq(t,r,e,n){var i=this._relativeTime[e];return Jn(i)?i(t,r,e,n):i.replace(/%d/i,t)}function iq(t,r){var e=this._relativeTime[t>0?"future":"past"];return Jn(e)?e(r):e.replace(/%s/i,r)}var Kl={};function Vr(t,r){var e=t.toLowerCase();Kl[e]=Kl[e+"s"]=Kl[r]=t}function Cn(t){return typeof t=="string"?Kl[t]||Kl[t.toLowerCase()]:void 0}function zb(t){var r={},e,n;for(n in t)wr(t,n)&&(e=Cn(n),e&&(r[e]=t[n]));return r}var GT={};function Wr(t,r){GT[t]=r}function oq(t){var r=[];for(var e in t)r.push({unit:e,priority:GT[e]});return r.sort(function(n,i){return n.priority-i.priority}),r}function Ci(t,r,e){var n=""+Math.abs(t),i=r-n.length,o=t>=0;return(o?e?"+":"":"-")+Math.pow(10,Math.max(0,i)).toString().substr(1)+n}var KT=/(\[[^\[]*\])|(\\)?([Hh]mm(ss)?|Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|Qo?|YYYYYY|YYYYY|YYYY|YY|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|kk?|mm?|ss?|S{1,9}|x|X|zz?|ZZ?|.)/g,bh=/(\[[^\[]*\])|(\\)?(LTS|LT|LL?L?L?|l{1,4})/g,Yb={},Vs={};function ct(t,r,e,n){var i=n;typeof n=="string"&&(i=function(){return this[n]()}),t&&(Vs[t]=i),r&&(Vs[r[0]]=function(){return Ci(i.apply(this,arguments),r[1],r[2])}),e&&(Vs[e]=function(){return this.localeData().ordinal(i.apply(this,arguments),t)})}function aq(t){return t.match(/\[[\s\S]/)?t.replace(/^\[|\]$/g,""):t.replace(/\\/g,"")}function sq(t){var r=t.match(KT),e,n;for(e=0,n=r.length;e<n;e++)Vs[r[e]]?r[e]=Vs[r[e]]:r[e]=aq(r[e]);return function(i){var o="",a;for(a=0;a<n;a++)o+=Jn(r[a])?r[a].call(i,t):r[a];return o}}function wh(t,r){return t.isValid()?(r=qT(r,t.localeData()),Yb[r]=Yb[r]||sq(r),Yb[r](t)):t.localeData().invalidDate()}function qT(t,r){var e=5;function n(i){return r.longDateFormat(i)||i}for(bh.lastIndex=0;e>=0&&bh.test(t);)t=t.replace(bh,n),bh.lastIndex=0,e-=1;return t}var XT=/\d/,cn=/\d\d/,ZT=/\d{3}/,Gb=/\d{4}/,_h=/[+-]?\d{6}/,Zt=/\d\d?/,JT=/\d\d\d\d?/,QT=/\d\d\d\d\d\d?/,Sh=/\d{1,3}/,Kb=/\d{1,4}/,Ch=/[+-]?\d{1,6}/,uq=/\d+/,kh=/[+-]?\d+/,lq=/Z|[+-]\d\d:?\d\d/gi,Oh=/Z|[+-]\d\d(?::?\d\d)?/gi,fq=/[+-]?\d+(\.\d{1,3})?/,ql=/[0-9]{0,256}['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFF07\uFF10-\uFFEF]{1,256}|[\u0600-\u06FF\/]{1,256}(\s*?[\u0600-\u06FF]{1,256}){1,2}/i,qb={};function it(t,r,e){qb[t]=Jn(r)?r:function(n,i){return n&&e?e:r}}function cq(t,r){return wr(qb,t)?qb[t](r._strict,r._locale):new RegExp(hq(t))}function hq(t){return _a(t.replace("\\","").replace(/\\(\[)|\\(\])|\[([^\]\[]*)\]|\\(.)/g,function(r,e,n,i,o){return e||n||i||o}))}function _a(t){return t.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}var Xb={};function Jt(t,r){var e,n=r;for(typeof t=="string"&&(t=[t]),wa(r)&&(n=function(i,o){o[r]=Pt(i)}),e=0;e<t.length;e++)Xb[t[e]]=n}function Xl(t,r){Jt(t,function(e,n,i,o){i._w=i._w||{},r(e,i._w,i,o)})}function dq(t,r,e){r!=null&&wr(Xb,t)&&Xb[t](r,e._a,e,t)}var Nn=0,ki=1,Qn=2,Ar=3,$n=4,Oi=5,Sa=6,pq=7,yq=8;ct("Y",0,0,function(){var t=this.year();return t<=9999?""+t:"+"+t});ct(0,["YY",2],0,function(){return this.year()%100});ct(0,["YYYY",4],0,"year");ct(0,["YYYYY",5],0,"year");ct(0,["YYYYYY",6,!0],0,"year");Vr("year","y");Wr("year",1);it("Y",kh);it("YY",Zt,cn);it("YYYY",Kb,Gb);it("YYYYY",Ch,_h);it("YYYYYY",Ch,_h);Jt(["YYYYY","YYYYYY"],Nn);Jt("YYYY",function(t,r){r[Nn]=t.length===2?$e.parseTwoDigitYear(t):Pt(t)});Jt("YY",function(t,r){r[Nn]=$e.parseTwoDigitYear(t)});Jt("Y",function(t,r){r[Nn]=parseInt(t,10)});function Zl(t){return Rh(t)?366:365}function Rh(t){return t%4==0&&t%100!=0||t%400==0}$e.parseTwoDigitYear=function(t){return Pt(t)+(Pt(t)>68?1900:2e3)};var ex=Ws("FullYear",!0);function mq(){return Rh(this.year())}function Ws(t,r){return function(e){return e!=null?(tx(this,t,e),$e.updateOffset(this,r),this):Eh(this,t)}}function Eh(t,r){return t.isValid()?t._d["get"+(t._isUTC?"UTC":"")+r]():NaN}function tx(t,r,e){t.isValid()&&!isNaN(e)&&(r==="FullYear"&&Rh(t.year())&&t.month()===1&&t.date()===29?t._d["set"+(t._isUTC?"UTC":"")+r](e,t.month(),Th(e,t.month())):t._d["set"+(t._isUTC?"UTC":"")+r](e))}function vq(t){return t=Cn(t),Jn(this[t])?this[t]():this}function gq(t,r){if(typeof t=="object"){t=zb(t);for(var e=oq(t),n=0;n<e.length;n++)this[e[n].unit](t[e[n].unit])}else if(t=Cn(t),Jn(this[t]))return this[t](r);return this}function bq(t,r){return(t%r+r)%r}var _r;Array.prototype.indexOf?_r=Array.prototype.indexOf:_r=function(t){var r;for(r=0;r<this.length;++r)if(this[r]===t)return r;return-1};function Th(t,r){if(isNaN(t)||isNaN(r))return NaN;var e=bq(r,12);return t+=(r-e)/12,e===1?Rh(t)?29:28:31-e%7%2}ct("M",["MM",2],"Mo",function(){return this.month()+1});ct("MMM",0,0,function(t){return this.localeData().monthsShort(this,t)});ct("MMMM",0,0,function(t){return this.localeData().months(this,t)});Vr("month","M");Wr("month",8);it("M",Zt);it("MM",Zt,cn);it("MMM",function(t,r){return r.monthsShortRegex(t)});it("MMMM",function(t,r){return r.monthsRegex(t)});Jt(["M","MM"],function(t,r){r[ki]=Pt(t)-1});Jt(["MMM","MMMM"],function(t,r,e,n){var i=e._locale.monthsParse(t,n,e._strict);i!=null?r[ki]=i:xt(e).invalidMonth=t});var rx=/D[oD]?(\[[^\[\]]*\]|\s)+MMMM?/,wq="January_February_March_April_May_June_July_August_September_October_November_December".split("_");function _q(t,r){return t?qn(this._months)?this._months[t.month()]:this._months[(this._months.isFormat||rx).test(r)?"format":"standalone"][t.month()]:qn(this._months)?this._months:this._months.standalone}var nx="Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_");function Sq(t,r){return t?qn(this._monthsShort)?this._monthsShort[t.month()]:this._monthsShort[rx.test(r)?"format":"standalone"][t.month()]:qn(this._monthsShort)?this._monthsShort:this._monthsShort.standalone}function Cq(t,r,e){var n,i,o,a=t.toLocaleLowerCase();if(!this._monthsParse)for(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[],n=0;n<12;++n)o=Xn([2e3,n]),this._shortMonthsParse[n]=this.monthsShort(o,"").toLocaleLowerCase(),this._longMonthsParse[n]=this.months(o,"").toLocaleLowerCase();return e?r==="MMM"?(i=_r.call(this._shortMonthsParse,a),i!==-1?i:null):(i=_r.call(this._longMonthsParse,a),i!==-1?i:null):r==="MMM"?(i=_r.call(this._shortMonthsParse,a),i!==-1?i:(i=_r.call(this._longMonthsParse,a),i!==-1?i:null)):(i=_r.call(this._longMonthsParse,a),i!==-1?i:(i=_r.call(this._shortMonthsParse,a),i!==-1?i:null))}function kq(t,r,e){var n,i,o;if(this._monthsParseExact)return Cq.call(this,t,r,e);for(this._monthsParse||(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[]),n=0;n<12;n++){if(i=Xn([2e3,n]),e&&!this._longMonthsParse[n]&&(this._longMonthsParse[n]=new RegExp("^"+this.months(i,"").replace(".","")+"$","i"),this._shortMonthsParse[n]=new RegExp("^"+this.monthsShort(i,"").replace(".","")+"$","i")),!e&&!this._monthsParse[n]&&(o="^"+this.months(i,"")+"|^"+this.monthsShort(i,""),this._monthsParse[n]=new RegExp(o.replace(".",""),"i")),e&&r==="MMMM"&&this._longMonthsParse[n].test(t))return n;if(e&&r==="MMM"&&this._shortMonthsParse[n].test(t))return n;if(!e&&this._monthsParse[n].test(t))return n}}function ix(t,r){var e;if(!t.isValid())return t;if(typeof r=="string"){if(/^\d+$/.test(r))r=Pt(r);else if(r=t.localeData().monthsParse(r),!wa(r))return t}return e=Math.min(t.date(),Th(t.year(),r)),t._d["set"+(t._isUTC?"UTC":"")+"Month"](r,e),t}function ox(t){return t!=null?(ix(this,t),$e.updateOffset(this,!0),this):Eh(this,"Month")}function Oq(){return Th(this.year(),this.month())}var Rq=ql;function Eq(t){return this._monthsParseExact?(wr(this,"_monthsRegex")||ax.call(this),t?this._monthsShortStrictRegex:this._monthsShortRegex):(wr(this,"_monthsShortRegex")||(this._monthsShortRegex=Rq),this._monthsShortStrictRegex&&t?this._monthsShortStrictRegex:this._monthsShortRegex)}var Tq=ql;function xq(t){return this._monthsParseExact?(wr(this,"_monthsRegex")||ax.call(this),t?this._monthsStrictRegex:this._monthsRegex):(wr(this,"_monthsRegex")||(this._monthsRegex=Tq),this._monthsStrictRegex&&t?this._monthsStrictRegex:this._monthsRegex)}function ax(){function t(a,s){return s.length-a.length}var r=[],e=[],n=[],i,o;for(i=0;i<12;i++)o=Xn([2e3,i]),r.push(this.monthsShort(o,"")),e.push(this.months(o,"")),n.push(this.months(o,"")),n.push(this.monthsShort(o,""));for(r.sort(t),e.sort(t),n.sort(t),i=0;i<12;i++)r[i]=_a(r[i]),e[i]=_a(e[i]);for(i=0;i<24;i++)n[i]=_a(n[i]);this._monthsRegex=new RegExp("^("+n.join("|")+")","i"),this._monthsShortRegex=this._monthsRegex,this._monthsStrictRegex=new RegExp("^("+e.join("|")+")","i"),this._monthsShortStrictRegex=new RegExp("^("+r.join("|")+")","i")}function Aq(t,r,e,n,i,o,a){var s;return t<100&&t>=0?(s=new Date(t+400,r,e,n,i,o,a),isFinite(s.getFullYear())&&s.setFullYear(t)):s=new Date(t,r,e,n,i,o,a),s}function Jl(t){var r;if(t<100&&t>=0){var e=Array.prototype.slice.call(arguments);e[0]=t+400,r=new Date(Date.UTC.apply(null,e)),isFinite(r.getUTCFullYear())&&r.setUTCFullYear(t)}else r=new Date(Date.UTC.apply(null,arguments));return r}function xh(t,r,e){var n=7+r-e,i=(7+Jl(t,0,n).getUTCDay()-r)%7;return-i+n-1}function sx(t,r,e,n,i){var o=(7+e-n)%7,a=xh(t,n,i),s=1+7*(r-1)+o+a,l,p;return s<=0?(l=t-1,p=Zl(l)+s):s>Zl(t)?(l=t+1,p=s-Zl(t)):(l=t,p=s),{year:l,dayOfYear:p}}function Ql(t,r,e){var n=xh(t.year(),r,e),i=Math.floor((t.dayOfYear()-n-1)/7)+1,o,a;return i<1?(a=t.year()-1,o=i+Ca(a,r,e)):i>Ca(t.year(),r,e)?(o=i-Ca(t.year(),r,e),a=t.year()+1):(a=t.year(),o=i),{week:o,year:a}}function Ca(t,r,e){var n=xh(t,r,e),i=xh(t+1,r,e);return(Zl(t)-n+i)/7}ct("w",["ww",2],"wo","week");ct("W",["WW",2],"Wo","isoWeek");Vr("week","w");Vr("isoWeek","W");Wr("week",5);Wr("isoWeek",5);it("w",Zt);it("ww",Zt,cn);it("W",Zt);it("WW",Zt,cn);Xl(["w","ww","W","WW"],function(t,r,e,n){r[n.substr(0,1)]=Pt(t)});function Mq(t){return Ql(t,this._week.dow,this._week.doy).week}var Pq={dow:0,doy:6};function Iq(){return this._week.dow}function Dq(){return this._week.doy}function Nq(t){var r=this.localeData().week(this);return t==null?r:this.add((t-r)*7,"d")}function $q(t){var r=Ql(this,1,4).week;return t==null?r:this.add((t-r)*7,"d")}ct("d",0,"do","day");ct("dd",0,0,function(t){return this.localeData().weekdaysMin(this,t)});ct("ddd",0,0,function(t){return this.localeData().weekdaysShort(this,t)});ct("dddd",0,0,function(t){return this.localeData().weekdays(this,t)});ct("e",0,0,"weekday");ct("E",0,0,"isoWeekday");Vr("day","d");Vr("weekday","e");Vr("isoWeekday","E");Wr("day",11);Wr("weekday",11);Wr("isoWeekday",11);it("d",Zt);it("e",Zt);it("E",Zt);it("dd",function(t,r){return r.weekdaysMinRegex(t)});it("ddd",function(t,r){return r.weekdaysShortRegex(t)});it("dddd",function(t,r){return r.weekdaysRegex(t)});Xl(["dd","ddd","dddd"],function(t,r,e,n){var i=e._locale.weekdaysParse(t,n,e._strict);i!=null?r.d=i:xt(e).invalidWeekday=t});Xl(["d","e","E"],function(t,r,e,n){r[n]=Pt(t)});function jq(t,r){return typeof t!="string"?t:isNaN(t)?(t=r.weekdaysParse(t),typeof t=="number"?t:null):parseInt(t,10)}function Lq(t,r){return typeof t=="string"?r.weekdaysParse(t)%7||7:isNaN(t)?null:t}function Zb(t,r){return t.slice(r,7).concat(t.slice(0,r))}var Hq="Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_");function Fq(t,r){var e=qn(this._weekdays)?this._weekdays:this._weekdays[t&&t!==!0&&this._weekdays.isFormat.test(r)?"format":"standalone"];return t===!0?Zb(e,this._week.dow):t?e[t.day()]:e}var ux="Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_");function Bq(t){return t===!0?Zb(this._weekdaysShort,this._week.dow):t?this._weekdaysShort[t.day()]:this._weekdaysShort}var Vq="Su_Mo_Tu_We_Th_Fr_Sa".split("_");function Wq(t){return t===!0?Zb(this._weekdaysMin,this._week.dow):t?this._weekdaysMin[t.day()]:this._weekdaysMin}function Uq(t,r,e){var n,i,o,a=t.toLocaleLowerCase();if(!this._weekdaysParse)for(this._weekdaysParse=[],this._shortWeekdaysParse=[],this._minWeekdaysParse=[],n=0;n<7;++n)o=Xn([2e3,1]).day(n),this._minWeekdaysParse[n]=this.weekdaysMin(o,"").toLocaleLowerCase(),this._shortWeekdaysParse[n]=this.weekdaysShort(o,"").toLocaleLowerCase(),this._weekdaysParse[n]=this.weekdays(o,"").toLocaleLowerCase();return e?r==="dddd"?(i=_r.call(this._weekdaysParse,a),i!==-1?i:null):r==="ddd"?(i=_r.call(this._shortWeekdaysParse,a),i!==-1?i:null):(i=_r.call(this._minWeekdaysParse,a),i!==-1?i:null):r==="dddd"?(i=_r.call(this._weekdaysParse,a),i!==-1||(i=_r.call(this._shortWeekdaysParse,a),i!==-1)?i:(i=_r.call(this._minWeekdaysParse,a),i!==-1?i:null)):r==="ddd"?(i=_r.call(this._shortWeekdaysParse,a),i!==-1||(i=_r.call(this._weekdaysParse,a),i!==-1)?i:(i=_r.call(this._minWeekdaysParse,a),i!==-1?i:null)):(i=_r.call(this._minWeekdaysParse,a),i!==-1||(i=_r.call(this._weekdaysParse,a),i!==-1)?i:(i=_r.call(this._shortWeekdaysParse,a),i!==-1?i:null))}function zq(t,r,e){var n,i,o;if(this._weekdaysParseExact)return Uq.call(this,t,r,e);for(this._weekdaysParse||(this._weekdaysParse=[],this._minWeekdaysParse=[],this._shortWeekdaysParse=[],this._fullWeekdaysParse=[]),n=0;n<7;n++){if(i=Xn([2e3,1]).day(n),e&&!this._fullWeekdaysParse[n]&&(this._fullWeekdaysParse[n]=new RegExp("^"+this.weekdays(i,"").replace(".","\\.?")+"$","i"),this._shortWeekdaysParse[n]=new RegExp("^"+this.weekdaysShort(i,"").replace(".","\\.?")+"$","i"),this._minWeekdaysParse[n]=new RegExp("^"+this.weekdaysMin(i,"").replace(".","\\.?")+"$","i")),this._weekdaysParse[n]||(o="^"+this.weekdays(i,"")+"|^"+this.weekdaysShort(i,"")+"|^"+this.weekdaysMin(i,""),this._weekdaysParse[n]=new RegExp(o.replace(".",""),"i")),e&&r==="dddd"&&this._fullWeekdaysParse[n].test(t))return n;if(e&&r==="ddd"&&this._shortWeekdaysParse[n].test(t))return n;if(e&&r==="dd"&&this._minWeekdaysParse[n].test(t))return n;if(!e&&this._weekdaysParse[n].test(t))return n}}function Yq(t){if(!this.isValid())return t!=null?this:NaN;var r=this._isUTC?this._d.getUTCDay():this._d.getDay();return t!=null?(t=jq(t,this.localeData()),this.add(t-r,"d")):r}function Gq(t){if(!this.isValid())return t!=null?this:NaN;var r=(this.day()+7-this.localeData()._week.dow)%7;return t==null?r:this.add(t-r,"d")}function Kq(t){if(!this.isValid())return t!=null?this:NaN;if(t!=null){var r=Lq(t,this.localeData());return this.day(this.day()%7?r:r-7)}else return this.day()||7}var qq=ql;function Xq(t){return this._weekdaysParseExact?(wr(this,"_weekdaysRegex")||Jb.call(this),t?this._weekdaysStrictRegex:this._weekdaysRegex):(wr(this,"_weekdaysRegex")||(this._weekdaysRegex=qq),this._weekdaysStrictRegex&&t?this._weekdaysStrictRegex:this._weekdaysRegex)}var Zq=ql;function Jq(t){return this._weekdaysParseExact?(wr(this,"_weekdaysRegex")||Jb.call(this),t?this._weekdaysShortStrictRegex:this._weekdaysShortRegex):(wr(this,"_weekdaysShortRegex")||(this._weekdaysShortRegex=Zq),this._weekdaysShortStrictRegex&&t?this._weekdaysShortStrictRegex:this._weekdaysShortRegex)}var Qq=ql;function eX(t){return this._weekdaysParseExact?(wr(this,"_weekdaysRegex")||Jb.call(this),t?this._weekdaysMinStrictRegex:this._weekdaysMinRegex):(wr(this,"_weekdaysMinRegex")||(this._weekdaysMinRegex=Qq),this._weekdaysMinStrictRegex&&t?this._weekdaysMinStrictRegex:this._weekdaysMinRegex)}function Jb(){function t(d,g){return g.length-d.length}var r=[],e=[],n=[],i=[],o,a,s,l,p;for(o=0;o<7;o++)a=Xn([2e3,1]).day(o),s=this.weekdaysMin(a,""),l=this.weekdaysShort(a,""),p=this.weekdays(a,""),r.push(s),e.push(l),n.push(p),i.push(s),i.push(l),i.push(p);for(r.sort(t),e.sort(t),n.sort(t),i.sort(t),o=0;o<7;o++)e[o]=_a(e[o]),n[o]=_a(n[o]),i[o]=_a(i[o]);this._weekdaysRegex=new RegExp("^("+i.join("|")+")","i"),this._weekdaysShortRegex=this._weekdaysRegex,this._weekdaysMinRegex=this._weekdaysRegex,this._weekdaysStrictRegex=new RegExp("^("+n.join("|")+")","i"),this._weekdaysShortStrictRegex=new RegExp("^("+e.join("|")+")","i"),this._weekdaysMinStrictRegex=new RegExp("^("+r.join("|")+")","i")}function Qb(){return this.hours()%12||12}function tX(){return this.hours()||24}ct("H",["HH",2],0,"hour");ct("h",["hh",2],0,Qb);ct("k",["kk",2],0,tX);ct("hmm",0,0,function(){return""+Qb.apply(this)+Ci(this.minutes(),2)});ct("hmmss",0,0,function(){return""+Qb.apply(this)+Ci(this.minutes(),2)+Ci(this.seconds(),2)});ct("Hmm",0,0,function(){return""+this.hours()+Ci(this.minutes(),2)});ct("Hmmss",0,0,function(){return""+this.hours()+Ci(this.minutes(),2)+Ci(this.seconds(),2)});function lx(t,r){ct(t,0,0,function(){return this.localeData().meridiem(this.hours(),this.minutes(),r)})}lx("a",!0);lx("A",!1);Vr("hour","h");Wr("hour",13);function fx(t,r){return r._meridiemParse}it("a",fx);it("A",fx);it("H",Zt);it("h",Zt);it("k",Zt);it("HH",Zt,cn);it("hh",Zt,cn);it("kk",Zt,cn);it("hmm",JT);it("hmmss",QT);it("Hmm",JT);it("Hmmss",QT);Jt(["H","HH"],Ar);Jt(["k","kk"],function(t,r,e){var n=Pt(t);r[Ar]=n===24?0:n});Jt(["a","A"],function(t,r,e){e._isPm=e._locale.isPM(t),e._meridiem=t});Jt(["h","hh"],function(t,r,e){r[Ar]=Pt(t),xt(e).bigHour=!0});Jt("hmm",function(t,r,e){var n=t.length-2;r[Ar]=Pt(t.substr(0,n)),r[$n]=Pt(t.substr(n)),xt(e).bigHour=!0});Jt("hmmss",function(t,r,e){var n=t.length-4,i=t.length-2;r[Ar]=Pt(t.substr(0,n)),r[$n]=Pt(t.substr(n,2)),r[Oi]=Pt(t.substr(i)),xt(e).bigHour=!0});Jt("Hmm",function(t,r,e){var n=t.length-2;r[Ar]=Pt(t.substr(0,n)),r[$n]=Pt(t.substr(n))});Jt("Hmmss",function(t,r,e){var n=t.length-4,i=t.length-2;r[Ar]=Pt(t.substr(0,n)),r[$n]=Pt(t.substr(n,2)),r[Oi]=Pt(t.substr(i))});function rX(t){return(t+"").toLowerCase().charAt(0)==="p"}var nX=/[ap]\.?m?\.?/i;function iX(t,r,e){return t>11?e?"pm":"PM":e?"am":"AM"}var oX=Ws("Hours",!0),cx={calendar:GK,longDateFormat:qK,invalidDate:ZK,ordinal:QK,dayOfMonthOrdinalParse:eq,relativeTime:rq,months:wq,monthsShort:nx,week:Pq,weekdays:Hq,weekdaysMin:Vq,weekdaysShort:ux,meridiemParse:nX},Mr={},ef={},tf;function hx(t){return t&&t.toLowerCase().replace("_","-")}function aX(t){for(var r=0,e,n,i,o;r<t.length;){for(o=hx(t[r]).split("-"),e=o.length,n=hx(t[r+1]),n=n?n.split("-"):null;e>0;){if(i=Ah(o.slice(0,e).join("-")),i)return i;if(n&&n.length>=e&&VT(o,n,!0)>=e-1)break;e--}r++}return tf}function Ah(t){var r=null;if(!Mr[t]&&typeof module!="undefined"&&module&&module.exports)try{r=tf._abbr;var e=require;e("./locale/"+t),Us(r)}catch{}return Mr[t]}function Us(t,r){var e;return t&&(rn(r)?e=Oo(t):e=e0(t,r),e?tf=e:typeof console!="undefined"&&console.warn&&console.warn("Locale "+t+" not found. Did you forget to load it?")),tf._abbr}function e0(t,r){if(r!==null){var e,n=cx;if(r.abbr=t,Mr[t]!=null)zT("defineLocaleOverride","use moment.updateLocale(localeName, config) to change an existing locale. moment.defineLocale(localeName, config) should only be used for creating a new locale See http://momentjs.com/guides/#/warnings/define-locale/ for more info."),n=Mr[t]._config;else if(r.parentLocale!=null)if(Mr[r.parentLocale]!=null)n=Mr[r.parentLocale]._config;else if(e=Ah(r.parentLocale),e!=null)n=e._config;else return ef[r.parentLocale]||(ef[r.parentLocale]=[]),ef[r.parentLocale].push({name:t,config:r}),null;return Mr[t]=new Wb(YT(n,r)),ef[t]&&ef[t].forEach(function(i){e0(i.name,i.config)}),Us(t),Mr[t]}else return delete Mr[t],null}function sX(t,r){if(r!=null){var e,n,i=cx;n=Ah(t),n!=null&&(i=n._config),r=YT(i,r),e=new Wb(r),e.parentLocale=Mr[t],Mr[t]=e,Us(t)}else Mr[t]!=null&&(Mr[t].parentLocale!=null?Mr[t]=Mr[t].parentLocale:Mr[t]!=null&&delete Mr[t]);return Mr[t]}function Oo(t){var r;if(t&&t._locale&&t._locale._abbr&&(t=t._locale._abbr),!t)return tf;if(!qn(t)){if(r=Ah(t),r)return r;t=[t]}return aX(t)}function uX(){return Ub(Mr)}function t0(t){var r,e=t._a;return e&&xt(t).overflow===-2&&(r=e[ki]<0||e[ki]>11?ki:e[Qn]<1||e[Qn]>Th(e[Nn],e[ki])?Qn:e[Ar]<0||e[Ar]>24||e[Ar]===24&&(e[$n]!==0||e[Oi]!==0||e[Sa]!==0)?Ar:e[$n]<0||e[$n]>59?$n:e[Oi]<0||e[Oi]>59?Oi:e[Sa]<0||e[Sa]>999?Sa:-1,xt(t)._overflowDayOfYear&&(r<Nn||r>Qn)&&(r=Qn),xt(t)._overflowWeeks&&r===-1&&(r=pq),xt(t)._overflowWeekday&&r===-1&&(r=yq),xt(t).overflow=r),t}function zs(t,r,e){return t!=null?t:r!=null?r:e}function lX(t){var r=new Date($e.now());return t._useUTC?[r.getUTCFullYear(),r.getUTCMonth(),r.getUTCDate()]:[r.getFullYear(),r.getMonth(),r.getDate()]}function r0(t){var r,e,n=[],i,o,a;if(!t._d){for(i=lX(t),t._w&&t._a[Qn]==null&&t._a[ki]==null&&fX(t),t._dayOfYear!=null&&(a=zs(t._a[Nn],i[Nn]),(t._dayOfYear>Zl(a)||t._dayOfYear===0)&&(xt(t)._overflowDayOfYear=!0),e=Jl(a,0,t._dayOfYear),t._a[ki]=e.getUTCMonth(),t._a[Qn]=e.getUTCDate()),r=0;r<3&&t._a[r]==null;++r)t._a[r]=n[r]=i[r];for(;r<7;r++)t._a[r]=n[r]=t._a[r]==null?r===2?1:0:t._a[r];t._a[Ar]===24&&t._a[$n]===0&&t._a[Oi]===0&&t._a[Sa]===0&&(t._nextDay=!0,t._a[Ar]=0),t._d=(t._useUTC?Jl:Aq).apply(null,n),o=t._useUTC?t._d.getUTCDay():t._d.getDay(),t._tzm!=null&&t._d.setUTCMinutes(t._d.getUTCMinutes()-t._tzm),t._nextDay&&(t._a[Ar]=24),t._w&&typeof t._w.d!="undefined"&&t._w.d!==o&&(xt(t).weekdayMismatch=!0)}}function fX(t){var r,e,n,i,o,a,s,l;if(r=t._w,r.GG!=null||r.W!=null||r.E!=null)o=1,a=4,e=zs(r.GG,t._a[Nn],Ql(Qt(),1,4).year),n=zs(r.W,1),i=zs(r.E,1),(i<1||i>7)&&(l=!0);else{o=t._locale._week.dow,a=t._locale._week.doy;var p=Ql(Qt(),o,a);e=zs(r.gg,t._a[Nn],p.year),n=zs(r.w,p.week),r.d!=null?(i=r.d,(i<0||i>6)&&(l=!0)):r.e!=null?(i=r.e+o,(r.e<0||r.e>6)&&(l=!0)):i=o}n<1||n>Ca(e,o,a)?xt(t)._overflowWeeks=!0:l!=null?xt(t)._overflowWeekday=!0:(s=sx(e,n,i,o,a),t._a[Nn]=s.year,t._dayOfYear=s.dayOfYear)}var cX=/^\s*((?:[+-]\d{6}|\d{4})-(?:\d\d-\d\d|W\d\d-\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?::\d\d(?::\d\d(?:[.,]\d+)?)?)?)([\+\-]\d\d(?::?\d\d)?|\s*Z)?)?$/,hX=/^\s*((?:[+-]\d{6}|\d{4})(?:\d\d\d\d|W\d\d\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?:\d\d(?:\d\d(?:[.,]\d+)?)?)?)([\+\-]\d\d(?::?\d\d)?|\s*Z)?)?$/,dX=/Z|[+-]\d\d(?::?\d\d)?/,Mh=[["YYYYYY-MM-DD",/[+-]\d{6}-\d\d-\d\d/],["YYYY-MM-DD",/\d{4}-\d\d-\d\d/],["GGGG-[W]WW-E",/\d{4}-W\d\d-\d/],["GGGG-[W]WW",/\d{4}-W\d\d/,!1],["YYYY-DDD",/\d{4}-\d{3}/],["YYYY-MM",/\d{4}-\d\d/,!1],["YYYYYYMMDD",/[+-]\d{10}/],["YYYYMMDD",/\d{8}/],["GGGG[W]WWE",/\d{4}W\d{3}/],["GGGG[W]WW",/\d{4}W\d{2}/,!1],["YYYYDDD",/\d{7}/]],n0=[["HH:mm:ss.SSSS",/\d\d:\d\d:\d\d\.\d+/],["HH:mm:ss,SSSS",/\d\d:\d\d:\d\d,\d+/],["HH:mm:ss",/\d\d:\d\d:\d\d/],["HH:mm",/\d\d:\d\d/],["HHmmss.SSSS",/\d\d\d\d\d\d\.\d+/],["HHmmss,SSSS",/\d\d\d\d\d\d,\d+/],["HHmmss",/\d\d\d\d\d\d/],["HHmm",/\d\d\d\d/],["HH",/\d\d/]],pX=/^\/?Date\((\-?\d+)/i;function dx(t){var r,e,n=t._i,i=cX.exec(n)||hX.exec(n),o,a,s,l;if(i){for(xt(t).iso=!0,r=0,e=Mh.length;r<e;r++)if(Mh[r][1].exec(i[1])){a=Mh[r][0],o=Mh[r][2]!==!1;break}if(a==null){t._isValid=!1;return}if(i[3]){for(r=0,e=n0.length;r<e;r++)if(n0[r][1].exec(i[3])){s=(i[2]||" ")+n0[r][0];break}if(s==null){t._isValid=!1;return}}if(!o&&s!=null){t._isValid=!1;return}if(i[4])if(dX.exec(i[4]))l="Z";else{t._isValid=!1;return}t._f=a+(s||"")+(l||""),i0(t)}else t._isValid=!1}var yX=/^(?:(Mon|Tue|Wed|Thu|Fri|Sat|Sun),?\s)?(\d{1,2})\s(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\s(\d{2,4})\s(\d\d):(\d\d)(?::(\d\d))?\s(?:(UT|GMT|[ECMP][SD]T)|([Zz])|([+-]\d{4}))$/;function mX(t,r,e,n,i,o){var a=[vX(t),nx.indexOf(r),parseInt(e,10),parseInt(n,10),parseInt(i,10)];return o&&a.push(parseInt(o,10)),a}function vX(t){var r=parseInt(t,10);return r<=49?2e3+r:r<=999?1900+r:r}function gX(t){return t.replace(/\([^)]*\)|[\n\t]/g," ").replace(/(\s\s+)/g," ").replace(/^\s\s*/,"").replace(/\s\s*$/,"")}function bX(t,r,e){if(t){var n=ux.indexOf(t),i=new Date(r[0],r[1],r[2]).getDay();if(n!==i)return xt(e).weekdayMismatch=!0,e._isValid=!1,!1}return!0}var wX={UT:0,GMT:0,EDT:-4*60,EST:-5*60,CDT:-5*60,CST:-6*60,MDT:-6*60,MST:-7*60,PDT:-7*60,PST:-8*60};function _X(t,r,e){if(t)return wX[t];if(r)return 0;var n=parseInt(e,10),i=n%100,o=(n-i)/100;return o*60+i}function px(t){var r=yX.exec(gX(t._i));if(r){var e=mX(r[4],r[3],r[2],r[5],r[6],r[7]);if(!bX(r[1],e,t))return;t._a=e,t._tzm=_X(r[8],r[9],r[10]),t._d=Jl.apply(null,t._a),t._d.setUTCMinutes(t._d.getUTCMinutes()-t._tzm),xt(t).rfc2822=!0}else t._isValid=!1}function SX(t){var r=pX.exec(t._i);if(r!==null){t._d=new Date(+r[1]);return}if(dx(t),t._isValid===!1)delete t._isValid;else return;if(px(t),t._isValid===!1)delete t._isValid;else return;$e.createFromInputFallback(t)}$e.createFromInputFallback=Sn("value provided is not in a recognized RFC2822 or ISO format. moment construction falls back to js Date(), which is not reliable across all browsers and versions. Non RFC2822/ISO date formats are discouraged and will be removed in an upcoming major release. Please refer to http://momentjs.com/guides/#/warnings/js-date/ for more info.",function(t){t._d=new Date(t._i+(t._useUTC?" UTC":""))});$e.ISO_8601=function(){};$e.RFC_2822=function(){};function i0(t){if(t._f===$e.ISO_8601){dx(t);return}if(t._f===$e.RFC_2822){px(t);return}t._a=[],xt(t).empty=!0;var r=""+t._i,e,n,i,o,a,s=r.length,l=0;for(i=qT(t._f,t._locale).match(KT)||[],e=0;e<i.length;e++)o=i[e],n=(r.match(cq(o,t))||[])[0],n&&(a=r.substr(0,r.indexOf(n)),a.length>0&&xt(t).unusedInput.push(a),r=r.slice(r.indexOf(n)+n.length),l+=n.length),Vs[o]?(n?xt(t).empty=!1:xt(t).unusedTokens.push(o),dq(o,n,t)):t._strict&&!n&&xt(t).unusedTokens.push(o);xt(t).charsLeftOver=s-l,r.length>0&&xt(t).unusedInput.push(r),t._a[Ar]<=12&&xt(t).bigHour===!0&&t._a[Ar]>0&&(xt(t).bigHour=void 0),xt(t).parsedDateParts=t._a.slice(0),xt(t).meridiem=t._meridiem,t._a[Ar]=CX(t._locale,t._a[Ar],t._meridiem),r0(t),t0(t)}function CX(t,r,e){var n;return e==null?r:t.meridiemHour!=null?t.meridiemHour(r,e):(t.isPM!=null&&(n=t.isPM(e),n&&r<12&&(r+=12),!n&&r===12&&(r=0)),r)}function kX(t){var r,e,n,i,o;if(t._f.length===0){xt(t).invalidFormat=!0,t._d=new Date(NaN);return}for(i=0;i<t._f.length;i++)o=0,r=Bb({},t),t._useUTC!=null&&(r._useUTC=t._useUTC),r._f=t._f[i],i0(r),!!Hb(r)&&(o+=xt(r).charsLeftOver,o+=xt(r).unusedTokens.length*10,xt(r).score=o,(n==null||o<n)&&(n=o,e=r));ko(t,e||r)}function OX(t){if(!t._d){var r=zb(t._i);t._a=BT([r.year,r.month,r.day||r.date,r.hour,r.minute,r.second,r.millisecond],function(e){return e&&parseInt(e,10)}),r0(t)}}function RX(t){var r=new Gl(t0(yx(t)));return r._nextDay&&(r.add(1,"d"),r._nextDay=void 0),r}function yx(t){var r=t._i,e=t._f;return t._locale=t._locale||Oo(t._l),r===null||e===void 0&&r===""?gh({nullInput:!0}):(typeof r=="string"&&(t._i=r=t._locale.preparse(r)),Zn(r)?new Gl(t0(r)):(vh(r)?t._d=r:qn(e)?kX(t):e?i0(t):EX(t),Hb(t)||(t._d=null),t))}function EX(t){var r=t._i;rn(r)?t._d=new Date($e.now()):vh(r)?t._d=new Date(r.valueOf()):typeof r=="string"?SX(t):qn(r)?(t._a=BT(r.slice(0),function(e){return parseInt(e,10)}),r0(t)):Yl(r)?OX(t):wa(r)?t._d=new Date(r):$e.createFromInputFallback(t)}function mx(t,r,e,n,i){var o={};return(e===!0||e===!1)&&(n=e,e=void 0),(Yl(t)&&UK(t)||qn(t)&&t.length===0)&&(t=void 0),o._isAMomentObject=!0,o._useUTC=o._isUTC=i,o._l=e,o._i=t,o._f=r,o._strict=n,RX(o)}function Qt(t,r,e,n){return mx(t,r,e,n,!1)}var TX=Sn("moment().min is deprecated, use moment.max instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var t=Qt.apply(null,arguments);return this.isValid()&&t.isValid()?t<this?this:t:gh()}),xX=Sn("moment().max is deprecated, use moment.min instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var t=Qt.apply(null,arguments);return this.isValid()&&t.isValid()?t>this?this:t:gh()});function vx(t,r){var e,n;if(r.length===1&&qn(r[0])&&(r=r[0]),!r.length)return Qt();for(e=r[0],n=1;n<r.length;++n)(!r[n].isValid()||r[n][t](e))&&(e=r[n]);return e}function AX(){var t=[].slice.call(arguments,0);return vx("isBefore",t)}function MX(){var t=[].slice.call(arguments,0);return vx("isAfter",t)}var PX=function(){return Date.now?Date.now():+new Date},rf=["year","quarter","month","week","day","hour","minute","second","millisecond"];function IX(t){for(var r in t)if(!(_r.call(rf,r)!==-1&&(t[r]==null||!isNaN(t[r]))))return!1;for(var e=!1,n=0;n<rf.length;++n)if(t[rf[n]]){if(e)return!1;parseFloat(t[rf[n]])!==Pt(t[rf[n]])&&(e=!0)}return!0}function DX(){return this._isValid}function NX(){return jn(NaN)}function Ph(t){var r=zb(t),e=r.year||0,n=r.quarter||0,i=r.month||0,o=r.week||r.isoWeek||0,a=r.day||0,s=r.hour||0,l=r.minute||0,p=r.second||0,d=r.millisecond||0;this._isValid=IX(r),this._milliseconds=+d+p*1e3+l*6e4+s*1e3*60*60,this._days=+a+o*7,this._months=+i+n*3+e*12,this._data={},this._locale=Oo(),this._bubble()}function o0(t){return t instanceof Ph}function a0(t){return t<0?Math.round(-1*t)*-1:Math.round(t)}function gx(t,r){ct(t,0,0,function(){var e=this.utcOffset(),n="+";return e<0&&(e=-e,n="-"),n+Ci(~~(e/60),2)+r+Ci(~~e%60,2)})}gx("Z",":");gx("ZZ","");it("Z",Oh);it("ZZ",Oh);Jt(["Z","ZZ"],function(t,r,e){e._useUTC=!0,e._tzm=s0(Oh,t)});var $X=/([\+\-]|\d\d)/gi;function s0(t,r){var e=(r||"").match(t);if(e===null)return null;var n=e[e.length-1]||[],i=(n+"").match($X)||["-",0,0],o=+(i[1]*60)+Pt(i[2]);return o===0?0:i[0]==="+"?o:-o}function u0(t,r){var e,n;return r._isUTC?(e=r.clone(),n=(Zn(t)||vh(t)?t.valueOf():Qt(t).valueOf())-e.valueOf(),e._d.setTime(e._d.valueOf()+n),$e.updateOffset(e,!1),e):Qt(t).local()}function l0(t){return-Math.round(t._d.getTimezoneOffset()/15)*15}$e.updateOffset=function(){};function jX(t,r,e){var n=this._offset||0,i;if(!this.isValid())return t!=null?this:NaN;if(t!=null){if(typeof t=="string"){if(t=s0(Oh,t),t===null)return this}else Math.abs(t)<16&&!e&&(t=t*60);return!this._isUTC&&r&&(i=l0(this)),this._offset=t,this._isUTC=!0,i!=null&&this.add(i,"m"),n!==t&&(!r||this._changeInProgress?Sx(this,jn(t-n,"m"),1,!1):this._changeInProgress||(this._changeInProgress=!0,$e.updateOffset(this,!0),this._changeInProgress=null)),this}else return this._isUTC?n:l0(this)}function LX(t,r){return t!=null?(typeof t!="string"&&(t=-t),this.utcOffset(t,r),this):-this.utcOffset()}function HX(t){return this.utcOffset(0,t)}function FX(t){return this._isUTC&&(this.utcOffset(0,t),this._isUTC=!1,t&&this.subtract(l0(this),"m")),this}function BX(){if(this._tzm!=null)this.utcOffset(this._tzm,!1,!0);else if(typeof this._i=="string"){var t=s0(lq,this._i);t!=null?this.utcOffset(t):this.utcOffset(0,!0)}return this}function VX(t){return this.isValid()?(t=t?Qt(t).utcOffset():0,(this.utcOffset()-t)%60==0):!1}function WX(){return this.utcOffset()>this.clone().month(0).utcOffset()||this.utcOffset()>this.clone().month(5).utcOffset()}function UX(){if(!rn(this._isDSTShifted))return this._isDSTShifted;var t={};if(Bb(t,this),t=yx(t),t._a){var r=t._isUTC?Xn(t._a):Qt(t._a);this._isDSTShifted=this.isValid()&&VT(t._a,r.toArray())>0}else this._isDSTShifted=!1;return this._isDSTShifted}function zX(){return this.isValid()?!this._isUTC:!1}function YX(){return this.isValid()?this._isUTC:!1}function bx(){return this.isValid()?this._isUTC&&this._offset===0:!1}var GX=/^(\-|\+)?(?:(\d*)[. ])?(\d+)\:(\d+)(?:\:(\d+)(\.\d*)?)?$/,KX=/^(-|\+)?P(?:([-+]?[0-9,.]*)Y)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)W)?(?:([-+]?[0-9,.]*)D)?(?:T(?:([-+]?[0-9,.]*)H)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)S)?)?$/;function jn(t,r){var e=t,n=null,i,o,a;return o0(t)?e={ms:t._milliseconds,d:t._days,M:t._months}:wa(t)?(e={},r?e[r]=t:e.milliseconds=t):(n=GX.exec(t))?(i=n[1]==="-"?-1:1,e={y:0,d:Pt(n[Qn])*i,h:Pt(n[Ar])*i,m:Pt(n[$n])*i,s:Pt(n[Oi])*i,ms:Pt(a0(n[Sa]*1e3))*i}):(n=KX.exec(t))?(i=n[1]==="-"?-1:1,e={y:ka(n[2],i),M:ka(n[3],i),w:ka(n[4],i),d:ka(n[5],i),h:ka(n[6],i),m:ka(n[7],i),s:ka(n[8],i)}):e==null?e={}:typeof e=="object"&&("from"in e||"to"in e)&&(a=qX(Qt(e.from),Qt(e.to)),e={},e.ms=a.milliseconds,e.M=a.months),o=new Ph(e),o0(t)&&wr(t,"_locale")&&(o._locale=t._locale),o}jn.fn=Ph.prototype;jn.invalid=NX;function ka(t,r){var e=t&&parseFloat(t.replace(",","."));return(isNaN(e)?0:e)*r}function wx(t,r){var e={};return e.months=r.month()-t.month()+(r.year()-t.year())*12,t.clone().add(e.months,"M").isAfter(r)&&--e.months,e.milliseconds=+r-+t.clone().add(e.months,"M"),e}function qX(t,r){var e;return t.isValid()&&r.isValid()?(r=u0(r,t),t.isBefore(r)?e=wx(t,r):(e=wx(r,t),e.milliseconds=-e.milliseconds,e.months=-e.months),e):{milliseconds:0,months:0}}function _x(t,r){return function(e,n){var i,o;return n!==null&&!isNaN(+n)&&(zT(r,"moment()."+r+"(period, number) is deprecated. Please use moment()."+r+"(number, period). See http://momentjs.com/guides/#/warnings/add-inverted-param/ for more info."),o=e,e=n,n=o),e=typeof e=="string"?+e:e,i=jn(e,n),Sx(this,i,t),this}}function Sx(t,r,e,n){var i=r._milliseconds,o=a0(r._days),a=a0(r._months);!t.isValid()||(n=n==null?!0:n,a&&ix(t,Eh(t,"Month")+a*e),o&&tx(t,"Date",Eh(t,"Date")+o*e),i&&t._d.setTime(t._d.valueOf()+i*e),n&&$e.updateOffset(t,o||a))}var XX=_x(1,"add"),ZX=_x(-1,"subtract");function JX(t,r){var e=t.diff(r,"days",!0);return e<-6?"sameElse":e<-1?"lastWeek":e<0?"lastDay":e<1?"sameDay":e<2?"nextDay":e<7?"nextWeek":"sameElse"}function QX(t,r){var e=t||Qt(),n=u0(e,this).startOf("day"),i=$e.calendarFormat(this,n)||"sameElse",o=r&&(Jn(r[i])?r[i].call(this,e):r[i]);return this.format(o||this.localeData().calendar(i,this,Qt(e)))}function eZ(){return new Gl(this)}function tZ(t,r){var e=Zn(t)?t:Qt(t);return this.isValid()&&e.isValid()?(r=Cn(r)||"millisecond",r==="millisecond"?this.valueOf()>e.valueOf():e.valueOf()<this.clone().startOf(r).valueOf()):!1}function rZ(t,r){var e=Zn(t)?t:Qt(t);return this.isValid()&&e.isValid()?(r=Cn(r)||"millisecond",r==="millisecond"?this.valueOf()<e.valueOf():this.clone().endOf(r).valueOf()<e.valueOf()):!1}function nZ(t,r,e,n){var i=Zn(t)?t:Qt(t),o=Zn(r)?r:Qt(r);return this.isValid()&&i.isValid()&&o.isValid()?(n=n||"()",(n[0]==="("?this.isAfter(i,e):!this.isBefore(i,e))&&(n[1]===")"?this.isBefore(o,e):!this.isAfter(o,e))):!1}function iZ(t,r){var e=Zn(t)?t:Qt(t),n;return this.isValid()&&e.isValid()?(r=Cn(r)||"millisecond",r==="millisecond"?this.valueOf()===e.valueOf():(n=e.valueOf(),this.clone().startOf(r).valueOf()<=n&&n<=this.clone().endOf(r).valueOf())):!1}function oZ(t,r){return this.isSame(t,r)||this.isAfter(t,r)}function aZ(t,r){return this.isSame(t,r)||this.isBefore(t,r)}function sZ(t,r,e){var n,i,o;if(!this.isValid())return NaN;if(n=u0(t,this),!n.isValid())return NaN;switch(i=(n.utcOffset()-this.utcOffset())*6e4,r=Cn(r),r){case"year":o=f0(this,n)/12;break;case"month":o=f0(this,n);break;case"quarter":o=f0(this,n)/3;break;case"second":o=(this-n)/1e3;break;case"minute":o=(this-n)/6e4;break;case"hour":o=(this-n)/36e5;break;case"day":o=(this-n-i)/864e5;break;case"week":o=(this-n-i)/6048e5;break;default:o=this-n}return e?o:_n(o)}function f0(t,r){var e=(r.year()-t.year())*12+(r.month()-t.month()),n=t.clone().add(e,"months"),i,o;return r-n<0?(i=t.clone().add(e-1,"months"),o=(r-n)/(n-i)):(i=t.clone().add(e+1,"months"),o=(r-n)/(i-n)),-(e+o)||0}$e.defaultFormat="YYYY-MM-DDTHH:mm:ssZ";$e.defaultFormatUtc="YYYY-MM-DDTHH:mm:ss[Z]";function uZ(){return this.clone().locale("en").format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ")}function lZ(t){if(!this.isValid())return null;var r=t!==!0,e=r?this.clone().utc():this;return e.year()<0||e.year()>9999?wh(e,r?"YYYYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYYYY-MM-DD[T]HH:mm:ss.SSSZ"):Jn(Date.prototype.toISOString)?r?this.toDate().toISOString():new Date(this.valueOf()+this.utcOffset()*60*1e3).toISOString().replace("Z",wh(e,"Z")):wh(e,r?"YYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYY-MM-DD[T]HH:mm:ss.SSSZ")}function fZ(){if(!this.isValid())return"moment.invalid(/* "+this._i+" */)";var t="moment",r="";this.isLocal()||(t=this.utcOffset()===0?"moment.utc":"moment.parseZone",r="Z");var e="["+t+'("]',n=0<=this.year()&&this.year()<=9999?"YYYY":"YYYYYY",i="-MM-DD[T]HH:mm:ss.SSS",o=r+'[")]';return this.format(e+n+i+o)}function cZ(t){t||(t=this.isUtc()?$e.defaultFormatUtc:$e.defaultFormat);var r=wh(this,t);return this.localeData().postformat(r)}function hZ(t,r){return this.isValid()&&(Zn(t)&&t.isValid()||Qt(t).isValid())?jn({to:this,from:t}).locale(this.locale()).humanize(!r):this.localeData().invalidDate()}function dZ(t){return this.from(Qt(),t)}function pZ(t,r){return this.isValid()&&(Zn(t)&&t.isValid()||Qt(t).isValid())?jn({from:this,to:t}).locale(this.locale()).humanize(!r):this.localeData().invalidDate()}function yZ(t){return this.to(Qt(),t)}function Cx(t){var r;return t===void 0?this._locale._abbr:(r=Oo(t),r!=null&&(this._locale=r),this)}var kx=Sn("moment().lang() is deprecated. Instead, use moment().localeData() to get the language configuration. Use moment().locale() to change languages.",function(t){return t===void 0?this.localeData():this.locale(t)});function Ox(){return this._locale}var Ih=1e3,Ys=60*Ih,Dh=60*Ys,Rx=(365*400+97)*24*Dh;function Gs(t,r){return(t%r+r)%r}function Ex(t,r,e){return t<100&&t>=0?new Date(t+400,r,e)-Rx:new Date(t,r,e).valueOf()}function Tx(t,r,e){return t<100&&t>=0?Date.UTC(t+400,r,e)-Rx:Date.UTC(t,r,e)}function mZ(t){var r;if(t=Cn(t),t===void 0||t==="millisecond"||!this.isValid())return this;var e=this._isUTC?Tx:Ex;switch(t){case"year":r=e(this.year(),0,1);break;case"quarter":r=e(this.year(),this.month()-this.month()%3,1);break;case"month":r=e(this.year(),this.month(),1);break;case"week":r=e(this.year(),this.month(),this.date()-this.weekday());break;case"isoWeek":r=e(this.year(),this.month(),this.date()-(this.isoWeekday()-1));break;case"day":case"date":r=e(this.year(),this.month(),this.date());break;case"hour":r=this._d.valueOf(),r-=Gs(r+(this._isUTC?0:this.utcOffset()*Ys),Dh);break;case"minute":r=this._d.valueOf(),r-=Gs(r,Ys);break;case"second":r=this._d.valueOf(),r-=Gs(r,Ih);break}return this._d.setTime(r),$e.updateOffset(this,!0),this}function vZ(t){var r;if(t=Cn(t),t===void 0||t==="millisecond"||!this.isValid())return this;var e=this._isUTC?Tx:Ex;switch(t){case"year":r=e(this.year()+1,0,1)-1;break;case"quarter":r=e(this.year(),this.month()-this.month()%3+3,1)-1;break;case"month":r=e(this.year(),this.month()+1,1)-1;break;case"week":r=e(this.year(),this.month(),this.date()-this.weekday()+7)-1;break;case"isoWeek":r=e(this.year(),this.month(),this.date()-(this.isoWeekday()-1)+7)-1;break;case"day":case"date":r=e(this.year(),this.month(),this.date()+1)-1;break;case"hour":r=this._d.valueOf(),r+=Dh-Gs(r+(this._isUTC?0:this.utcOffset()*Ys),Dh)-1;break;case"minute":r=this._d.valueOf(),r+=Ys-Gs(r,Ys)-1;break;case"second":r=this._d.valueOf(),r+=Ih-Gs(r,Ih)-1;break}return this._d.setTime(r),$e.updateOffset(this,!0),this}function gZ(){return this._d.valueOf()-(this._offset||0)*6e4}function bZ(){return Math.floor(this.valueOf()/1e3)}function wZ(){return new Date(this.valueOf())}function _Z(){var t=this;return[t.year(),t.month(),t.date(),t.hour(),t.minute(),t.second(),t.millisecond()]}function SZ(){var t=this;return{years:t.year(),months:t.month(),date:t.date(),hours:t.hours(),minutes:t.minutes(),seconds:t.seconds(),milliseconds:t.milliseconds()}}function CZ(){return this.isValid()?this.toISOString():null}function kZ(){return Hb(this)}function OZ(){return ko({},xt(this))}function RZ(){return xt(this).overflow}function EZ(){return{input:this._i,format:this._f,locale:this._locale,isUTC:this._isUTC,strict:this._strict}}ct(0,["gg",2],0,function(){return this.weekYear()%100});ct(0,["GG",2],0,function(){return this.isoWeekYear()%100});function Nh(t,r){ct(0,[t,t.length],0,r)}Nh("gggg","weekYear");Nh("ggggg","weekYear");Nh("GGGG","isoWeekYear");Nh("GGGGG","isoWeekYear");Vr("weekYear","gg");Vr("isoWeekYear","GG");Wr("weekYear",1);Wr("isoWeekYear",1);it("G",kh);it("g",kh);it("GG",Zt,cn);it("gg",Zt,cn);it("GGGG",Kb,Gb);it("gggg",Kb,Gb);it("GGGGG",Ch,_h);it("ggggg",Ch,_h);Xl(["gggg","ggggg","GGGG","GGGGG"],function(t,r,e,n){r[n.substr(0,2)]=Pt(t)});Xl(["gg","GG"],function(t,r,e,n){r[n]=$e.parseTwoDigitYear(t)});function TZ(t){return xx.call(this,t,this.week(),this.weekday(),this.localeData()._week.dow,this.localeData()._week.doy)}function xZ(t){return xx.call(this,t,this.isoWeek(),this.isoWeekday(),1,4)}function AZ(){return Ca(this.year(),1,4)}function MZ(){var t=this.localeData()._week;return Ca(this.year(),t.dow,t.doy)}function xx(t,r,e,n,i){var o;return t==null?Ql(this,n,i).year:(o=Ca(t,n,i),r>o&&(r=o),PZ.call(this,t,r,e,n,i))}function PZ(t,r,e,n,i){var o=sx(t,r,e,n,i),a=Jl(o.year,0,o.dayOfYear);return this.year(a.getUTCFullYear()),this.month(a.getUTCMonth()),this.date(a.getUTCDate()),this}ct("Q",0,"Qo","quarter");Vr("quarter","Q");Wr("quarter",7);it("Q",XT);Jt("Q",function(t,r){r[ki]=(Pt(t)-1)*3});function IZ(t){return t==null?Math.ceil((this.month()+1)/3):this.month((t-1)*3+this.month()%3)}ct("D",["DD",2],"Do","date");Vr("date","D");Wr("date",9);it("D",Zt);it("DD",Zt,cn);it("Do",function(t,r){return t?r._dayOfMonthOrdinalParse||r._ordinalParse:r._dayOfMonthOrdinalParseLenient});Jt(["D","DD"],Qn);Jt("Do",function(t,r){r[Qn]=Pt(t.match(Zt)[0])});var Ax=Ws("Date",!0);ct("DDD",["DDDD",3],"DDDo","dayOfYear");Vr("dayOfYear","DDD");Wr("dayOfYear",4);it("DDD",Sh);it("DDDD",ZT);Jt(["DDD","DDDD"],function(t,r,e){e._dayOfYear=Pt(t)});function DZ(t){var r=Math.round((this.clone().startOf("day")-this.clone().startOf("year"))/864e5)+1;return t==null?r:this.add(t-r,"d")}ct("m",["mm",2],0,"minute");Vr("minute","m");Wr("minute",14);it("m",Zt);it("mm",Zt,cn);Jt(["m","mm"],$n);var NZ=Ws("Minutes",!1);ct("s",["ss",2],0,"second");Vr("second","s");Wr("second",15);it("s",Zt);it("ss",Zt,cn);Jt(["s","ss"],Oi);var $Z=Ws("Seconds",!1);ct("S",0,0,function(){return~~(this.millisecond()/100)});ct(0,["SS",2],0,function(){return~~(this.millisecond()/10)});ct(0,["SSS",3],0,"millisecond");ct(0,["SSSS",4],0,function(){return this.millisecond()*10});ct(0,["SSSSS",5],0,function(){return this.millisecond()*100});ct(0,["SSSSSS",6],0,function(){return this.millisecond()*1e3});ct(0,["SSSSSSS",7],0,function(){return this.millisecond()*1e4});ct(0,["SSSSSSSS",8],0,function(){return this.millisecond()*1e5});ct(0,["SSSSSSSSS",9],0,function(){return this.millisecond()*1e6});Vr("millisecond","ms");Wr("millisecond",16);it("S",Sh,XT);it("SS",Sh,cn);it("SSS",Sh,ZT);var Ro;for(Ro="SSSS";Ro.length<=9;Ro+="S")it(Ro,uq);function jZ(t,r){r[Sa]=Pt(("0."+t)*1e3)}for(Ro="S";Ro.length<=9;Ro+="S")Jt(Ro,jZ);var LZ=Ws("Milliseconds",!1);ct("z",0,0,"zoneAbbr");ct("zz",0,0,"zoneName");function HZ(){return this._isUTC?"UTC":""}function FZ(){return this._isUTC?"Coordinated Universal Time":""}var Be=Gl.prototype;Be.add=XX;Be.calendar=QX;Be.clone=eZ;Be.diff=sZ;Be.endOf=vZ;Be.format=cZ;Be.from=hZ;Be.fromNow=dZ;Be.to=pZ;Be.toNow=yZ;Be.get=vq;Be.invalidAt=RZ;Be.isAfter=tZ;Be.isBefore=rZ;Be.isBetween=nZ;Be.isSame=iZ;Be.isSameOrAfter=oZ;Be.isSameOrBefore=aZ;Be.isValid=kZ;Be.lang=kx;Be.locale=Cx;Be.localeData=Ox;Be.max=xX;Be.min=TX;Be.parsingFlags=OZ;Be.set=gq;Be.startOf=mZ;Be.subtract=ZX;Be.toArray=_Z;Be.toObject=SZ;Be.toDate=wZ;Be.toISOString=lZ;Be.inspect=fZ;Be.toJSON=CZ;Be.toString=uZ;Be.unix=bZ;Be.valueOf=gZ;Be.creationData=EZ;Be.year=ex;Be.isLeapYear=mq;Be.weekYear=TZ;Be.isoWeekYear=xZ;Be.quarter=Be.quarters=IZ;Be.month=ox;Be.daysInMonth=Oq;Be.week=Be.weeks=Nq;Be.isoWeek=Be.isoWeeks=$q;Be.weeksInYear=MZ;Be.isoWeeksInYear=AZ;Be.date=Ax;Be.day=Be.days=Yq;Be.weekday=Gq;Be.isoWeekday=Kq;Be.dayOfYear=DZ;Be.hour=Be.hours=oX;Be.minute=Be.minutes=NZ;Be.second=Be.seconds=$Z;Be.millisecond=Be.milliseconds=LZ;Be.utcOffset=jX;Be.utc=HX;Be.local=FX;Be.parseZone=BX;Be.hasAlignedHourOffset=VX;Be.isDST=WX;Be.isLocal=zX;Be.isUtcOffset=YX;Be.isUtc=bx;Be.isUTC=bx;Be.zoneAbbr=HZ;Be.zoneName=FZ;Be.dates=Sn("dates accessor is deprecated. Use date instead.",Ax);Be.months=Sn("months accessor is deprecated. Use month instead",ox);Be.years=Sn("years accessor is deprecated. Use year instead",ex);Be.zone=Sn("moment().zone is deprecated, use moment().utcOffset instead. http://momentjs.com/guides/#/warnings/zone/",LX);Be.isDSTShifted=Sn("isDSTShifted is deprecated. See http://momentjs.com/guides/#/warnings/dst-shifted/ for more information",UX);function BZ(t){return Qt(t*1e3)}function VZ(){return Qt.apply(null,arguments).parseZone()}function Mx(t){return t}var Gt=Wb.prototype;Gt.calendar=KK;Gt.longDateFormat=XK;Gt.invalidDate=JK;Gt.ordinal=tq;Gt.preparse=Mx;Gt.postformat=Mx;Gt.relativeTime=nq;Gt.pastFuture=iq;Gt.set=YK;Gt.months=_q;Gt.monthsShort=Sq;Gt.monthsParse=kq;Gt.monthsRegex=xq;Gt.monthsShortRegex=Eq;Gt.week=Mq;Gt.firstDayOfYear=Dq;Gt.firstDayOfWeek=Iq;Gt.weekdays=Fq;Gt.weekdaysMin=Wq;Gt.weekdaysShort=Bq;Gt.weekdaysParse=zq;Gt.weekdaysRegex=Xq;Gt.weekdaysShortRegex=Jq;Gt.weekdaysMinRegex=eX;Gt.isPM=rX;Gt.meridiem=iX;function $h(t,r,e,n){var i=Oo(),o=Xn().set(n,r);return i[e](o,t)}function Px(t,r,e){if(wa(t)&&(r=t,t=void 0),t=t||"",r!=null)return $h(t,r,e,"month");var n,i=[];for(n=0;n<12;n++)i[n]=$h(t,n,e,"month");return i}function c0(t,r,e,n){typeof t=="boolean"?(wa(r)&&(e=r,r=void 0),r=r||""):(r=t,e=r,t=!1,wa(r)&&(e=r,r=void 0),r=r||"");var i=Oo(),o=t?i._week.dow:0;if(e!=null)return $h(r,(e+o)%7,n,"day");var a,s=[];for(a=0;a<7;a++)s[a]=$h(r,(a+o)%7,n,"day");return s}function WZ(t,r){return Px(t,r,"months")}function UZ(t,r){return Px(t,r,"monthsShort")}function zZ(t,r,e){return c0(t,r,e,"weekdays")}function YZ(t,r,e){return c0(t,r,e,"weekdaysShort")}function GZ(t,r,e){return c0(t,r,e,"weekdaysMin")}Us("en",{dayOfMonthOrdinalParse:/\d{1,2}(th|st|nd|rd)/,ordinal:function(t){var r=t%10,e=Pt(t%100/10)===1?"th":r===1?"st":r===2?"nd":r===3?"rd":"th";return t+e}});$e.lang=Sn("moment.lang is deprecated. Use moment.locale instead.",Us);$e.langData=Sn("moment.langData is deprecated. Use moment.localeData instead.",Oo);var Ri=Math.abs;function KZ(){var t=this._data;return this._milliseconds=Ri(this._milliseconds),this._days=Ri(this._days),this._months=Ri(this._months),t.milliseconds=Ri(t.milliseconds),t.seconds=Ri(t.seconds),t.minutes=Ri(t.minutes),t.hours=Ri(t.hours),t.months=Ri(t.months),t.years=Ri(t.years),this}function Ix(t,r,e,n){var i=jn(r,e);return t._milliseconds+=n*i._milliseconds,t._days+=n*i._days,t._months+=n*i._months,t._bubble()}function qZ(t,r){return Ix(this,t,r,1)}function XZ(t,r){return Ix(this,t,r,-1)}function Dx(t){return t<0?Math.floor(t):Math.ceil(t)}function ZZ(){var t=this._milliseconds,r=this._days,e=this._months,n=this._data,i,o,a,s,l;return t>=0&&r>=0&&e>=0||t<=0&&r<=0&&e<=0||(t+=Dx(h0(e)+r)*864e5,r=0,e=0),n.milliseconds=t%1e3,i=_n(t/1e3),n.seconds=i%60,o=_n(i/60),n.minutes=o%60,a=_n(o/60),n.hours=a%24,r+=_n(a/24),l=_n(Nx(r)),e+=l,r-=Dx(h0(l)),s=_n(e/12),e%=12,n.days=r,n.months=e,n.years=s,this}function Nx(t){return t*4800/146097}function h0(t){return t*146097/4800}function JZ(t){if(!this.isValid())return NaN;var r,e,n=this._milliseconds;if(t=Cn(t),t==="month"||t==="quarter"||t==="year")switch(r=this._days+n/864e5,e=this._months+Nx(r),t){case"month":return e;case"quarter":return e/3;case"year":return e/12}else switch(r=this._days+Math.round(h0(this._months)),t){case"week":return r/7+n/6048e5;case"day":return r+n/864e5;case"hour":return r*24+n/36e5;case"minute":return r*1440+n/6e4;case"second":return r*86400+n/1e3;case"millisecond":return Math.floor(r*864e5)+n;default:throw new Error("Unknown unit "+t)}}function QZ(){return this.isValid()?this._milliseconds+this._days*864e5+this._months%12*2592e6+Pt(this._months/12)*31536e6:NaN}function Ei(t){return function(){return this.as(t)}}var eJ=Ei("ms"),tJ=Ei("s"),rJ=Ei("m"),nJ=Ei("h"),iJ=Ei("d"),oJ=Ei("w"),aJ=Ei("M"),sJ=Ei("Q"),uJ=Ei("y");function lJ(){return jn(this)}function fJ(t){return t=Cn(t),this.isValid()?this[t+"s"]():NaN}function Oa(t){return function(){return this.isValid()?this._data[t]:NaN}}var cJ=Oa("milliseconds"),hJ=Oa("seconds"),dJ=Oa("minutes"),pJ=Oa("hours"),yJ=Oa("days"),mJ=Oa("months"),vJ=Oa("years");function gJ(){return _n(this.days()/7)}var Eo=Math.round,ei={ss:44,s:45,m:45,h:22,d:26,M:11};function bJ(t,r,e,n,i){return i.relativeTime(r||1,!!e,t,n)}function wJ(t,r,e){var n=jn(t).abs(),i=Eo(n.as("s")),o=Eo(n.as("m")),a=Eo(n.as("h")),s=Eo(n.as("d")),l=Eo(n.as("M")),p=Eo(n.as("y")),d=i<=ei.ss&&["s",i]||i<ei.s&&["ss",i]||o<=1&&["m"]||o<ei.m&&["mm",o]||a<=1&&["h"]||a<ei.h&&["hh",a]||s<=1&&["d"]||s<ei.d&&["dd",s]||l<=1&&["M"]||l<ei.M&&["MM",l]||p<=1&&["y"]||["yy",p];return d[2]=r,d[3]=+t>0,d[4]=e,bJ.apply(null,d)}function _J(t){return t===void 0?Eo:typeof t=="function"?(Eo=t,!0):!1}function SJ(t,r){return ei[t]===void 0?!1:r===void 0?ei[t]:(ei[t]=r,t==="s"&&(ei.ss=r-1),!0)}function CJ(t){if(!this.isValid())return this.localeData().invalidDate();var r=this.localeData(),e=wJ(this,!t,r);return t&&(e=r.pastFuture(+this,e)),r.postformat(e)}var d0=Math.abs;function Ks(t){return(t>0)-(t<0)||+t}function jh(){if(!this.isValid())return this.localeData().invalidDate();var t=d0(this._milliseconds)/1e3,r=d0(this._days),e=d0(this._months),n,i,o;n=_n(t/60),i=_n(n/60),t%=60,n%=60,o=_n(e/12),e%=12;var a=o,s=e,l=r,p=i,d=n,g=t?t.toFixed(3).replace(/\.?0+$/,""):"",y=this.asSeconds();if(!y)return"P0D";var h=y<0?"-":"",u=Ks(this._months)!==Ks(y)?"-":"",f=Ks(this._days)!==Ks(y)?"-":"",c=Ks(this._milliseconds)!==Ks(y)?"-":"";return h+"P"+(a?u+a+"Y":"")+(s?u+s+"M":"")+(l?f+l+"D":"")+(p||d||g?"T":"")+(p?c+p+"H":"")+(d?c+d+"M":"")+(g?c+g+"S":"")}var Dt=Ph.prototype;Dt.isValid=DX;Dt.abs=KZ;Dt.add=qZ;Dt.subtract=XZ;Dt.as=JZ;Dt.asMilliseconds=eJ;Dt.asSeconds=tJ;Dt.asMinutes=rJ;Dt.asHours=nJ;Dt.asDays=iJ;Dt.asWeeks=oJ;Dt.asMonths=aJ;Dt.asQuarters=sJ;Dt.asYears=uJ;Dt.valueOf=QZ;Dt._bubble=ZZ;Dt.clone=lJ;Dt.get=fJ;Dt.milliseconds=cJ;Dt.seconds=hJ;Dt.minutes=dJ;Dt.hours=pJ;Dt.days=yJ;Dt.weeks=gJ;Dt.months=mJ;Dt.years=vJ;Dt.humanize=CJ;Dt.toISOString=jh;Dt.toString=jh;Dt.toJSON=jh;Dt.locale=Cx;Dt.localeData=Ox;Dt.toIsoString=Sn("toIsoString() is deprecated. Please use toISOString() instead (notice the capitals)",jh);Dt.lang=kx;ct("X",0,0,"unix");ct("x",0,0,"valueOf");it("x",kh);it("X",fq);Jt("X",function(t,r,e){e._d=new Date(parseFloat(t,10)*1e3)});Jt("x",function(t,r,e){e._d=new Date(Pt(t))});//! moment.js
$e.version="2.24.0";WK(Qt);$e.fn=Be;$e.min=AX;$e.max=MX;$e.now=PX;$e.utc=Xn;$e.unix=BZ;$e.months=WZ;$e.isDate=vh;$e.locale=Us;$e.invalid=gh;$e.duration=jn;$e.isMoment=Zn;$e.weekdays=zZ;$e.parseZone=VZ;$e.localeData=Oo;$e.isDuration=o0;$e.monthsShort=UZ;$e.weekdaysMin=GZ;$e.defineLocale=e0;$e.updateLocale=sX;$e.locales=uX;$e.weekdaysShort=YZ;$e.normalizeUnits=Cn;$e.relativeTimeRounding=_J;$e.relativeTimeThreshold=SJ;$e.calendarFormat=JX;$e.prototype=Be;$e.HTML5_FMT={DATETIME_LOCAL:"YYYY-MM-DDTHH:mm",DATETIME_LOCAL_SECONDS:"YYYY-MM-DDTHH:mm:ss",DATETIME_LOCAL_MS:"YYYY-MM-DDTHH:mm:ss.SSS",DATE:"YYYY-MM-DD",TIME:"HH:mm",TIME_SECONDS:"HH:mm:ss",TIME_MS:"HH:mm:ss.SSS",WEEK:"GGGG-[W]WW",MONTH:"YYYY-MM"};function Kt(t){for(var r=arguments.length,e=new Array(r>1?r-1:0),n=1;n<r;n++)e[n-1]=arguments[n];var i=pr(t,function(o,a,s){var l=a.replace(/\r?\n\s*/g,""),p=e[s]?e[s]:"";return o+l+p},"");return i.trim()}var $x,jx,Lx,Hx,Fx,Bx;function qs(t,r){return r||(r=t.slice(0)),Object.freeze(Object.defineProperties(t,{raw:{value:Object.freeze(r)}}))}function Lh(t){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?Lh=function(e){return typeof e}:Lh=function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Lh(t)}function lr(t){var r;switch(Lh(t)){case"string":case"number":r="".concat(t);break;case"object":r=t===null?"":t.toString();break;case"undefined":r="";break;default:r=t.toString();break}return r}function at(t){return typeof t!="undefined"}function er(t){return typeof t=="undefined"}function Or(t){return t===null||t===""||er(t)}function Vx(t){return Object.prototype.toString.call(t)==="[object RegExp]"}var nf="length",of=function(r){return parseInt(r,16)},Wx=function(r){return parseInt(r,10)},Hh=function(r,e,n){return r.substr(e,n)},af=function(r){return r.codePointAt(0)-65},p0=function(r){return"".concat(r).replace(/\-/g,"")},kJ=function(r){return of(Hh(p0(r),of("12"),af("F")))/(of(Hh(p0(r),af("B"),~~![][nf]))||9)},OJ=function(){return typeof location!="undefined"&&/^([a-z0-9\-]+\.)?\x68\x61\x6E\x64\x73\x6F\x6E\x74\x61\x62\x6C\x65\x2E\x63\x6F\x6D$/i.test(location.host)},Ux=!1,zx={invalid:function(){return Kt($x||($x=qs([`
    The license key for Handsontable is invalid. 
    If you need any help, contact us at support@handsontable.com.`],[`
    The license key for Handsontable is invalid.\\x20
    If you need any help, contact us at support@handsontable.com.`])))},expired:function(r){var e=r.keyValidityDate,n=r.hotVersion;return Kt(jx||(jx=qs([`
    The license key for Handsontable expired on `,`, and is not valid for the installed 
    version `,`. Renew your license key at handsontable.com or downgrade to a version released prior 
    to `,". If you need any help, contact us at sales@handsontable.com."],[`
    The license key for Handsontable expired on `,`, and is not valid for the installed\\x20
    version `,`. Renew your license key at handsontable.com or downgrade to a version released prior\\x20
    to `,". If you need any help, contact us at sales@handsontable.com."])),e,n,e)},missing:function(){return Kt(Lx||(Lx=qs([`
    The license key for Handsontable is missing. Use your purchased key to activate the product. 
    Alternatively, you can activate Handsontable to use for non-commercial purposes by 
    passing the key: 'non-commercial-and-evaluation'. If you need any help, contact 
    us at support@handsontable.com.`],[`
    The license key for Handsontable is missing. Use your purchased key to activate the product.\\x20
    Alternatively, you can activate Handsontable to use for non-commercial purposes by\\x20
    passing the key: 'non-commercial-and-evaluation'. If you need any help, contact\\x20
    us at support@handsontable.com.`])))},non_commercial:function(){return""}},Yx={invalid:function(){return Kt(Hx||(Hx=qs([`
    The license key for Handsontable is invalid. 
    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> on how to 
    install it properly or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.`],[`
    The license key for Handsontable is invalid.\\x20
    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> on how to\\x20
    install it properly or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.`])))},expired:function(r){var e=r.keyValidityDate,n=r.hotVersion;return Kt(Fx||(Fx=qs([`
    The license key for Handsontable expired on `,`, and is not valid for the installed 
    version `,`. <a href="https://handsontable.com/pricing" target="_blank">Renew</a> your 
    license key or downgrade to a version released prior to `,`. If you need any 
    help, contact us at <a href="mailto:sales@handsontable.com">sales@handsontable.com</a>.`],[`
    The license key for Handsontable expired on `,`, and is not valid for the installed\\x20
    version `,`. <a href="https://handsontable.com/pricing" target="_blank">Renew</a> your\\x20
    license key or downgrade to a version released prior to `,`. If you need any\\x20
    help, contact us at <a href="mailto:sales@handsontable.com">sales@handsontable.com</a>.`])),e,n,e)},missing:function(){return Kt(Bx||(Bx=qs([`
    The license key for Handsontable is missing. Use your purchased key to activate the product. 
    Alternatively, you can activate Handsontable to use for non-commercial purposes by 
    passing the key: 'non-commercial-and-evaluation'. 
    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> about it in 
    the documentation or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.`],[`
    The license key for Handsontable is missing. Use your purchased key to activate the product.\\x20
    Alternatively, you can activate Handsontable to use for non-commercial purposes by\\x20
    passing the key: 'non-commercial-and-evaluation'.\\x20
    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> about it in\\x20
    the documentation or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.`])))},non_commercial:function(){return""}};function Gx(t,r){var e=!Or(t),n=typeof t=="string"&&t.toLowerCase()==="non-commercial-and-evaluation",i="11.0.1",o,a="invalid",s="invalid";t=p0(t||"");var l=RJ(t);if(e||n||l)if(l){var p=$e("17/11/2021","DD/MM/YYYY"),d=Math.floor(p.toDate().getTime()/864e5),g=kJ(t);if(o=$e((g+1)*864e5,"x").format("MMMM DD, YYYY"),d>g){var y=$e().diff(p,"days");a=y<=1?"valid":"expired",s=y<=15?"valid":"expired"}else a="valid",s="valid"}else n?(a="non_commercial",s="valid"):(a="invalid",s="invalid");else a="missing",s="missing";if(OJ()&&(a="valid",s="valid"),!Ux&&a!=="valid"){var h=zx[a]({keyValidityDate:o,hotVersion:i});h&&console[a==="non_commercial"?"info":"warn"](zx[a]({keyValidityDate:o,hotVersion:i})),Ux=!0}if(s!=="valid"&&r.parentNode){var u=Yx[s]({keyValidityDate:o,hotVersion:i});if(u){var f=document.createElement("div");f.id="hot-display-license-info",f.innerHTML=Yx[s]({keyValidityDate:o,hotVersion:i}),r.parentNode.insertBefore(f,r.nextSibling)}}}function RJ(t){var r=[][nf],e=r;if(t[nf]!==af("Z"))return!1;for(var n="",i="B<H4P+".split(""),o=af(i.shift());o;o=af(i.shift()||"A"))--o<""[nf]?e=e|(Wx("".concat(Wx(of(n)+(of(Hh(t,Math.abs(o),2))+[]).padStart(2,"0"))))%97||2)>>1:n=Hh(t,o,o?i[nf]===1?9:8:6);return e===r}var EJ=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",stringify:lr,isDefined:at,isUndefined:er,isEmpty:Or,isRegExp:Vx,_injectProductInfo:Gx});function Ln(t){return t[0].toUpperCase()+t.substr(1)}function TJ(){for(var t=[],r=arguments.length,e=new Array(r),n=0;n<r;n++)e[n]=arguments[n];for(var i=e.length;i;){i-=1;var o=lr(e[i]).toLowerCase();t.indexOf(o)===-1&&t.push(o)}return t.length===1}function y0(){function t(){return Math.floor((1+Math.random())*65536).toString(16).substring(1)}return t()+t()+t()+t()}function m0(t){return/^([0-9][0-9]?%$)|(^100%$)/.test(t)}function v0(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return"".concat(t).replace(/(?:\\)?\[([^[\]]+)]/g,function(e,n){return e.charAt(0)==="\\"?e.substr(1,e.length-1):r[n]===void 0?"":r[n]})}function g0(t){return Fh("".concat(t),{ALLOWED_TAGS:[]})}function Fh(t,r){return vK.sanitize(t,r)}var xJ=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",toUpperCaseFirst:Ln,equalsIgnoreCase:TJ,randomString:y0,isPercentValue:m0,substitute:v0,stripTags:g0,sanitize:Fh});function Kx(t){return IJ(t)||PJ(t)||MJ(t)||AJ()}function AJ(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function MJ(t,r){if(!!t){if(typeof t=="string")return b0(t,r);var e=Object.prototype.toString.call(t).slice(8,-1);if(e==="Object"&&t.constructor&&(e=t.constructor.name),e==="Map"||e==="Set")return Array.from(t);if(e==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return b0(t,r)}}function PJ(t){if(typeof Symbol!="undefined"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function IJ(t){if(Array.isArray(t))return b0(t)}function b0(t,r){(r==null||r>t.length)&&(r=t.length);for(var e=0,n=new Array(r);e<r;e++)n[e]=t[e];return n}function qx(t){for(var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,e=-1,n=null,i=t;i!==null;){if(e===r){n=i;break}i.host&&i.nodeType===Node.DOCUMENT_FRAGMENT_NODE?i=i.host:(e+=1,i=i.parentNode)}return n}function Xx(t){return Object.getPrototypeOf(t.parent)&&t.frameElement}function Bh(t){return Xx(t)&&t.parent}function DJ(t){return!!Object.getPrototypeOf(t.parent)}function Ti(t){for(var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],e=arguments.length>2?arguments[2]:void 0,n=Node,i=n.ELEMENT_NODE,o=n.DOCUMENT_FRAGMENT_NODE,a=t;a!=null&&a!==e;){var s=a,l=s.nodeType,p=s.nodeName;if(l===i&&(r.includes(p)||r.includes(a)))return a;var d=a,g=d.host;g&&l===o?a=g:a=a.parentNode}return null}function sf(t,r,e){for(var n=[],i=t;i&&(i=Ti(i,r,e),!(!i||e&&!e.contains(i)));)n.push(i),i.host&&i.nodeType===Node.DOCUMENT_FRAGMENT_NODE?i=i.host:i=i.parentNode;var o=n.length;return o?n[o-1]:null}function To(t,r){var e=t.parentNode,n=[];for(typeof r=="string"?t.defaultView?n=Array.prototype.slice.call(t.querySelectorAll(r),0):n=Array.prototype.slice.call(t.ownerDocument.querySelectorAll(r),0):n.push(r);e!==null;){if(n.indexOf(e)>-1)return!0;e=e.parentNode}return!1}function Zx(t){var r=0,e=t;if(e.previousSibling)for(;e=e.previousSibling;)r+=1;return r}function xo(t,r,e){var n=e.parentElement.querySelector(".ht_clone_".concat(t));return n?n.contains(r):null}var w0,_0,S0;function Vh(t){return!t||!t.length?[]:t.filter(function(r){return!!r})}if(YE()){var Jx=function(r){var e=r.createElement("div");return e.classList.add("test","test2"),e.classList.contains("test2")};w0=function(r,e){return r.classList===void 0||typeof e!="string"||e===""?!1:r.classList.contains(e)},_0=function(r,e){var n=r.ownerDocument,i=e;if(typeof i=="string"&&(i=i.split(" ")),i=Vh(i),i.length>0)if(Jx(n)){var o;(o=r.classList).add.apply(o,Kx(i))}else for(var a=0;i[a];)r.classList.add(i[a]),a+=1},S0=function(r,e){var n=r.ownerDocument,i=e;if(typeof i=="string"&&(i=i.split(" ")),i=Vh(i),i.length>0)if(Jx(n)){var o;(o=r.classList).remove.apply(o,Kx(i))}else for(var a=0;i[a];)r.classList.remove(i[a]),a+=1}}else{var C0=function(r){return new RegExp("(\\s|^)".concat(r,"(\\s|$)"))};w0=function(r,e){return r.className!==void 0&&C0(e).test(r.className)},_0=function(r,e){var n=r.className,i=e;if(typeof i=="string"&&(i=i.split(" ")),i=Vh(i),n==="")n=i.join(" ");else for(var o=0;o<i.length;o++)i[o]&&!C0(i[o]).test(n)&&(n+=" ".concat(i[o]));r.className=n},S0=function(r,e){var n=0,i=r.className,o=e;for(typeof o=="string"&&(o=o.split(" ")),o=Vh(o);o[n];)i=i.replace(C0(o[n])," ").trim(),n+=1;r.className!==i&&(r.className=i)}}function lt(t,r){return w0(t,r)}function Ie(t,r){_0(t,r)}function dt(t,r){S0(t,r)}function k0(t){if(t.nodeType===3)t.parentNode.removeChild(t);else if(["TABLE","THEAD","TBODY","TFOOT","TR"].indexOf(t.nodeName)>-1)for(var r=t.childNodes,e=r.length-1;e>=0;e--)k0(r[e])}function kn(t){for(var r;r=t.lastChild;)t.removeChild(r)}var Qx=/(<(.*)>|&(.*);)/;function Ao(t,r){var e=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;Qx.test(r)?t.innerHTML=e?Fh(r):r:Mo(t,r)}function Mo(t,r){var e=t.firstChild;e&&e.nodeType===3&&e.nextSibling===null?GE?e.textContent=r:e.data=r:(kn(t),t.appendChild(t.ownerDocument.createTextNode(r)))}function Xs(t){for(var r=t.ownerDocument.documentElement,e=t;e!==r;){if(e===null)return!1;if(e.nodeType===Node.DOCUMENT_FRAGMENT_NODE)if(e.host){if(e.host.impl)return Xs(e.host.impl);if(e.host)return Xs(e.host);throw new Error("Lost in Web Components world")}else return!1;else if(e.style&&e.style.display==="none")return!1;e=e.parentNode}return!0}function ar(t){var r=t.ownerDocument,e=r.defaultView,n=r.documentElement,i=t,o,a,s,l;if(pb()&&i.firstChild&&i.firstChild.nodeName==="CAPTION")return l=i.getBoundingClientRect(),{top:l.top+(e.pageYOffset||n.scrollTop)-(n.clientTop||0),left:l.left+(e.pageXOffset||n.scrollLeft)-(n.clientLeft||0)};for(o=i.offsetLeft,a=i.offsetTop,s=i;(i=i.offsetParent)&&i!==r.body;)o+=i.offsetLeft,a+=i.offsetTop,s=i;return s&&s.style.position==="fixed"&&(o+=e.pageXOffset||n.scrollLeft,a+=e.pageYOffset||n.scrollTop),{left:o,top:a}}function Ra(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:window,r=t.scrollY;return r===void 0&&(r=t.document.documentElement.scrollTop),r}function Po(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:window,r=t.scrollX;return r===void 0&&(r=t.document.documentElement.scrollLeft),r}function uf(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;return t===r?Ra(r):t.scrollTop}function Wh(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;return t===r?Po(r):t.scrollLeft}function lf(t){var r=t.ownerDocument,e=r?r.defaultView:void 0;r||(r=t.document?t.document:t,e=r.defaultView);for(var n=["auto","scroll"],i=KE(),o=t.parentNode;o&&o.style&&r.body!==o;){var a=o.style,s=a.overflow,l=a.overflowX,p=a.overflowY;if([s,l,p].includes("scroll"))return o;if(i){var d=e.getComputedStyle(o);if(s=d.overflow,l=d.overflowX,p=d.overflowY,n.includes(s)||n.includes(l)||n.includes(p))return o}if(o.clientHeight<=o.scrollHeight+1&&(n.includes(p)||n.includes(s))||o.clientWidth<=o.scrollWidth+1&&(n.includes(l)||n.includes(s)))return o;o=o.parentNode}return e}function Zs(t){for(var r=t.ownerDocument,e=r.defaultView,n=t.parentNode;n&&n.style&&r.body!==n;){if(n.style.overflow!=="visible"&&n.style.overflow!=="")return n;var i=Ea(n,e),o=["scroll","hidden","auto"],a=i.getPropertyValue("overflow"),s=i.getPropertyValue("overflow-y"),l=i.getPropertyValue("overflow-x");if(o.includes(a)||o.includes(s)||o.includes(l))return n;n=n.parentNode}return e}function Uh(t,r){var e=arguments.length>2&&arguments[2]!==void 0?arguments[2]:window;if(t){if(t===e)return r==="width"?"".concat(e.innerWidth,"px"):r==="height"?"".concat(e.innerHeight,"px"):void 0}else return;var n=t.style[r];if(n!==""&&n!==void 0)return n;var i=Ea(t,e);if(i[r]!==""&&i[r]!==void 0)return i[r]}function NJ(t,r){var e=r.selectorText,n=!1;return r.type===CSSRule.STYLE_RULE&&e&&(t.msMatchesSelector?n=t.msMatchesSelector(e):t.matches&&(n=t.matches(e))),n}function Ea(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;return t.currentStyle||r.getComputedStyle(t)}function sr(t){return Math.ceil(t.getBoundingClientRect().width)}function yr(t){return pb()&&t.firstChild&&t.firstChild.nodeName==="CAPTION"?t.offsetHeight+t.firstChild.offsetHeight:t.offsetHeight}function xi(t){return t.clientHeight||t.innerHeight}function Js(t){return t.clientWidth||t.innerWidth}function $J(t,r,e){t.addEventListener(r,e,!1)}function jJ(t,r,e){t.removeEventListener(r,e,!1)}function O0(t){var r=t.ownerDocument;if(t.selectionStart)return t.selectionStart;if(r.selection){t.focus();var e=r.selection.createRange();if(e===null)return 0;var n=t.createTextRange(),i=n.duplicate();return n.moveToBookmark(e.getBookmark()),i.setEndPoint("EndToStart",n),i.text.length}return 0}function e3(t){var r=t.ownerDocument;if(t.selectionEnd)return t.selectionEnd;if(r.selection){var e=r.selection.createRange();if(e===null)return 0;var n=t.createTextRange();return n.text.indexOf(e.text)+e.text.length}return 0}function t3(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:window,r=t.document,e="";return t.getSelection?e=t.getSelection().toString():r.selection&&r.selection.type!=="Control"&&(e=r.selection.createRange().text),e}function R0(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:window,r=t.document;t.getSelection?t.getSelection().empty?t.getSelection().empty():t.getSelection().removeAllRanges&&t.getSelection().removeAllRanges():r.selection&&r.selection.empty()}function ff(t,r,e){if(e===void 0&&(e=r),t.setSelectionRange){t.focus();try{t.setSelectionRange(r,e)}catch{var n=t.parentNode,i=n.style.display;n.style.display="block",t.setSelectionRange(r,e),n.style.display=i}}}var E0;function LJ(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:document,r=t.createElement("div");r.style.height="200px",r.style.width="100%";var e=t.createElement("div");e.style.boxSizing="content-box",e.style.height="150px",e.style.left="0px",e.style.overflow="hidden",e.style.position="absolute",e.style.top="0px",e.style.width="200px",e.style.visibility="hidden",e.appendChild(r),(t.body||t.documentElement).appendChild(e);var n=r.offsetWidth;e.style.overflow="scroll";var i=r.offsetWidth;return n===i&&(i=e.clientWidth),(t.body||t.documentElement).removeChild(e),n-i}function Pr(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:document;return E0===void 0&&(E0=LJ(t)),E0}function r3(t){return t.offsetWidth!==t.clientWidth}function n3(t){return t.offsetHeight!==t.clientHeight}function zh(t,r,e){kT()?(t.style.top=e,t.style.left=r):_T()?t.style["-webkit-transform"]="translate3d(".concat(r,",").concat(e,",0)"):t.style.transform="translate3d(".concat(r,",").concat(e,",0)")}function Hn(t){var r;return t.style.transform&&(r=t.style.transform)!==""?["transform",r]:t.style["-webkit-transform"]&&(r=t.style["-webkit-transform"])!==""?["-webkit-transform",r]:-1}function Ta(t){t.style.transform&&t.style.transform!==""?t.style.transform="":t.style["-webkit-transform"]&&t.style["-webkit-transform"]!==""&&(t.style["-webkit-transform"]="")}function cf(t){var r=["INPUT","SELECT","TEXTAREA"];return t&&(r.indexOf(t.nodeName)>-1||t.contentEditable==="true")}function T0(t){return cf(t)&&t.hasAttribute("data-hot-input")===!1}function i3(t){var r=t.ownerDocument.activeElement;T0(r)||t.select()}function x0(t){return!t.parentNode}var HJ=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",getParent:qx,getFrameElement:Xx,getParentWindow:Bh,hasAccessToParentWindow:DJ,closest:Ti,closestDown:sf,isChildOf:To,index:Zx,overlayContainsElement:xo,hasClass:lt,addClass:Ie,removeClass:dt,removeTextNodes:k0,empty:kn,HTML_CHARACTERS:Qx,fastInnerHTML:Ao,fastInnerText:Mo,isVisible:Xs,offset:ar,getWindowScrollTop:Ra,getWindowScrollLeft:Po,getScrollTop:uf,getScrollLeft:Wh,getScrollableElement:lf,getTrimmingContainer:Zs,getStyle:Uh,matchesCSSRules:NJ,getComputedStyle:Ea,outerWidth:sr,outerHeight:yr,innerHeight:xi,innerWidth:Js,addEvent:$J,removeEvent:jJ,getCaretPosition:O0,getSelectionEndPosition:e3,getSelectionText:t3,clearTextSelection:R0,setCaretPosition:ff,getScrollbarWidth:Pr,hasVerticalScrollbar:r3,hasHorizontalScrollbar:n3,setOverlayPosition:zh,getCssTransform:Hn,resetCssTransform:Ta,isInput:cf,isOutsideInput:T0,selectElementIfAllowed:i3,isDetached:x0});function qt(t){return typeof t=="function"}function o3(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:200,e=0,n={lastCallThrottled:!0},i=null;function o(){for(var a=this,s=arguments.length,l=new Array(s),p=0;p<s;p++)l[p]=arguments[p];var d=Date.now(),g=!1;n.lastCallThrottled=!0,e||(e=d,g=!0);var y=r-(d-e);return g?(n.lastCallThrottled=!1,t.apply(this,l)):(i&&clearTimeout(i),i=setTimeout(function(){n.lastCallThrottled=!1,t.apply(a,l),e=0,i=void 0},y)),n}return o}function FJ(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:200,e=arguments.length>2&&arguments[2]!==void 0?arguments[2]:10,n=o3(t,r),i=e;function o(){i=e}function a(){for(var s=arguments.length,l=new Array(s),p=0;p<s;p++)l[p]=arguments[p];return i?(i-=1,t.apply(this,l)):n.apply(this,l)}return a.clearHits=o,a}function A0(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:200,e=null,n;function i(){for(var o=this,a=arguments.length,s=new Array(a),l=0;l<a;l++)s[l]=arguments[l];return e&&clearTimeout(e),e=setTimeout(function(){n=t.apply(o,s)},r),n}return i}function BJ(){for(var t=arguments.length,r=new Array(t),e=0;e<t;e++)r[e]=arguments[e];var n=r[0],i=r.slice(1);return function(){for(var a=arguments.length,s=new Array(a),l=0;l<a;l++)s[l]=arguments[l];return pr(i,function(p,d){return d(p)},n.apply(this,s))}}function hf(t){for(var r=arguments.length,e=new Array(r>1?r-1:0),n=1;n<r;n++)e[n-1]=arguments[n];return function(){for(var o=arguments.length,a=new Array(o),s=0;s<o;s++)a[s]=arguments[s];return t.apply(this,e.concat(a))}}function a3(t){var r=t.length;function e(n){return function(){for(var o=arguments.length,a=new Array(o),s=0;s<o;s++)a[s]=arguments[s];var l=n.concat(a),p;return l.length>=r?p=t.apply(this,l):p=e(l),p}}return e([])}function VJ(t){var r=t.length;function e(n){return function(){for(var o=arguments.length,a=new Array(o),s=0;s<o;s++)a[s]=arguments[s];var l=n.concat(a.reverse()),p;return l.length>=r?p=t.apply(this,l):p=e(l),p}}return e([])}function Yh(t,r,e,n,i,o,a,s){return at(s)?t.call(r,e,n,i,o,a,s):at(a)?t.call(r,e,n,i,o,a):at(o)?t.call(r,e,n,i,o):at(i)?t.call(r,e,n,i):at(n)?t.call(r,e,n):at(e)?t.call(r,e):t.call(r)}var WJ=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",isFunction:qt,throttle:o3,throttleAfterHits:FJ,debounce:A0,pipe:BJ,partial:hf,curry:a3,curryRight:VJ,fastCall:Yh}),UJ=ht,s3=Sb,Gh=Hs.exports.getWeakData,zJ=br,M0=gr,YJ=bb,GJ=gb,u3=fa,l3=Tr,f3=yi,KJ=f3.set,qJ=f3.getterFor,XJ=u3.find,ZJ=u3.findIndex,JJ=UJ([].splice),QJ=0,Kh=function(t){return t.frozen||(t.frozen=new c3)},c3=function(){this.entries=[]},P0=function(t,r){return XJ(t.entries,function(e){return e[0]===r})};c3.prototype={get:function(t){var r=P0(this,t);if(r)return r[1]},has:function(t){return!!P0(this,t)},set:function(t,r){var e=P0(this,t);e?e[1]=r:this.entries.push([t,r])},delete:function(t){var r=ZJ(this.entries,function(e){return e[0]===t});return~r&&JJ(this.entries,r,1),!!~r}};var h3={getConstructor:function(t,r,e,n){var i=t(function(l,p){YJ(l,o),KJ(l,{type:r,id:QJ++,frozen:void 0}),p!=null&&GJ(p,l[n],{that:l,AS_ENTRIES:e})}),o=i.prototype,a=qJ(r),s=function(l,p,d){var g=a(l),y=Gh(zJ(p),!0);return y===!0?Kh(g).set(p,d):y[g.id]=d,l};return s3(o,{delete:function(l){var p=a(this);if(!M0(l))return!1;var d=Gh(l);return d===!0?Kh(p).delete(l):d&&l3(d,p.id)&&delete d[p.id]},has:function(p){var d=a(this);if(!M0(p))return!1;var g=Gh(p);return g===!0?Kh(d).has(p):g&&l3(g,d.id)}}),s3(o,e?{get:function(p){var d=a(this);if(M0(p)){var g=Gh(p);return g===!0?Kh(d).get(p):g?g[d.id]:void 0}},set:function(p,d){return s(this,p,d)}}:{add:function(p){return s(this,p,!0)}}),i}},d3=ot,qh=ht,eQ=Sb,tQ=Hs.exports,rQ=lh,p3=h3,Xh=gr,Zh=JE,Jh=yi.enforce,nQ=CO,iQ=!d3.ActiveXObject&&"ActiveXObject"in d3,df,y3=function(t){return function(){return t(this,arguments.length?arguments[0]:void 0)}},oQ=rQ("WeakMap",y3,p3);if(nQ&&iQ){df=p3.getConstructor(y3,"WeakMap",!0),tQ.enable();var pf=oQ.prototype,m3=qh(pf.delete),Qh=qh(pf.has),v3=qh(pf.get),g3=qh(pf.set);eQ(pf,{delete:function(t){if(Xh(t)&&!Zh(t)){var r=Jh(this);return r.frozen||(r.frozen=new df),m3(this,t)||r.frozen.delete(t)}return m3(this,t)},has:function(r){if(Xh(r)&&!Zh(r)){var e=Jh(this);return e.frozen||(e.frozen=new df),Qh(this,r)||e.frozen.has(r)}return Qh(this,r)},get:function(r){if(Xh(r)&&!Zh(r)){var e=Jh(this);return e.frozen||(e.frozen=new df),Qh(this,r)?v3(this,r):e.frozen.get(r)}return v3(this,r)},set:function(r,e){if(Xh(r)&&!Zh(r)){var n=Jh(this);n.frozen||(n.frozen=new df),Qh(this,r)?g3(this,r,e):n.frozen.set(r,e)}else g3(this,r,e);return this}})}var xa=1,On=2;function aQ(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}function b3(t,r){for(var e=0;e<r.length;e++){var n=r[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function sQ(t,r,e){return r&&b3(t.prototype,r),e&&b3(t,e),t}var Qs=new WeakMap,uQ=function(){function t(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},e=r.viewportSize,n=r.scrollOffset,i=r.totalItems,o=r.itemSizeFn,a=r.overrideFn,s=r.calculationType,l=r.stretchMode,p=r.stretchingItemWidthFn,d=p===void 0?function(g){return g}:p;aQ(this,t),Qs.set(this,{viewportWidth:e,scrollOffset:n,totalColumns:i,columnWidthFn:o,overrideFn:a,calculationType:s,stretchingColumnWidthFn:d}),this.count=0,this.startColumn=null,this.endColumn=null,this.startPosition=null,this.stretchAllRatio=0,this.stretchLastWidth=0,this.stretch=l,this.totalTargetWidth=0,this.needVerifyLastColumnWidth=!0,this.stretchAllColumnsWidth=[],this.calculate()}return sQ(t,[{key:"calculate",value:function(){for(var e=0,n=!0,i=[],o,a=Qs.get(this),s=a.calculationType,l=a.overrideFn,p=a.scrollOffset,d=a.totalColumns,g=a.viewportWidth,y=0;y<d;y++){o=this._getColumnWidth(y),e<=p&&s!==On&&(this.startColumn=y);var h=p>0?g+1:g;if(e>=p&&e+(s===On?o:0)<=p+h&&((this.startColumn===null||this.startColumn===void 0)&&(this.startColumn=y),this.endColumn=y),i.push(e),e+=o,s!==On&&(this.endColumn=y),e>=p+g){n=!1;break}}if(this.endColumn===d-1&&n)for(this.startColumn=this.endColumn;this.startColumn>0;){var u=i[this.endColumn]+o-i[this.startColumn-1];if((u<=g||s!==On)&&(this.startColumn-=1),u>g)break}s===xa&&this.startColumn!==null&&l&&l(this),this.startPosition=i[this.startColumn],this.startPosition===void 0&&(this.startPosition=null),d<this.endColumn&&(this.endColumn=d-1),this.startColumn!==null&&(this.count=this.endColumn-this.startColumn+1)}},{key:"refreshStretching",value:function(e){if(this.stretch!=="none"){var n=e;this.totalTargetWidth=n;for(var i=Qs.get(this),o=i.totalColumns,a=0,s=0;s<o;s++){var l=this._getColumnWidth(s),p=i.stretchingColumnWidthFn(void 0,s);typeof p=="number"?n-=p:a+=l}var d=n-a;if(this.stretch==="all"&&d>0)this.stretchAllRatio=n/a,this.stretchAllColumnsWidth=[],this.needVerifyLastColumnWidth=!0;else if(this.stretch==="last"&&n!==1/0){var g=this._getColumnWidth(o-1),y=d+g;this.stretchLastWidth=y>=0?y:g}}}},{key:"getStretchedColumnWidth",value:function(e,n){var i=null;return this.stretch==="all"&&this.stretchAllRatio!==0?i=this._getStretchedAllColumnWidth(e,n):this.stretch==="last"&&this.stretchLastWidth!==0&&(i=this._getStretchedLastColumnWidth(e)),i}},{key:"_getStretchedAllColumnWidth",value:function(e,n){var i=0,o=Qs.get(this),a=o.totalColumns;if(!this.stretchAllColumnsWidth[e]){var s=Math.round(n*this.stretchAllRatio),l=o.stretchingColumnWidthFn(s,e);l===void 0?this.stretchAllColumnsWidth[e]=s:this.stretchAllColumnsWidth[e]=isNaN(l)?this._getColumnWidth(e):l}if(this.stretchAllColumnsWidth.length===a&&this.needVerifyLastColumnWidth){this.needVerifyLastColumnWidth=!1;for(var p=0;p<this.stretchAllColumnsWidth.length;p++)i+=this.stretchAllColumnsWidth[p];i!==this.totalTargetWidth&&(this.stretchAllColumnsWidth[this.stretchAllColumnsWidth.length-1]+=this.totalTargetWidth-i)}return this.stretchAllColumnsWidth[e]}},{key:"_getStretchedLastColumnWidth",value:function(e){var n=Qs.get(this),i=n.totalColumns;return e===i-1?this.stretchLastWidth:null}},{key:"_getColumnWidth",value:function(e){var n=Qs.get(this).columnWidthFn(e);return isNaN(n)&&(n=t.DEFAULT_WIDTH),n}}],[{key:"DEFAULT_WIDTH",get:function(){return 50}}]),t}(),I0=uQ;function lQ(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}function w3(t,r){for(var e=0;e<r.length;e++){var n=r[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function fQ(t,r,e){return r&&w3(t.prototype,r),e&&w3(t,e),t}var _3=new WeakMap,cQ=function(){function t(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},e=r.viewportSize,n=r.scrollOffset,i=r.totalItems,o=r.itemSizeFn,a=r.overrideFn,s=r.calculationType,l=r.scrollbarHeight;lQ(this,t),_3.set(this,{viewportHeight:e,scrollOffset:n,totalRows:i,rowHeightFn:o,overrideFn:a,calculationType:s,horizontalScrollbarHeight:l}),this.count=0,this.startRow=null,this.endRow=null,this.startPosition=null,this.calculate()}return fQ(t,[{key:"calculate",value:function(){for(var e=0,n=!0,i=[],o=_3.get(this),a=o.calculationType,s=o.overrideFn,l=o.rowHeightFn,p=o.scrollOffset,d=o.totalRows,g=o.viewportHeight,y=o.horizontalScrollbarHeight||0,h,u=0;u<d;u++)if(h=l(u),isNaN(h)&&(h=t.DEFAULT_HEIGHT),e<=p&&a!==On&&(this.startRow=u),e>=p&&e+(a===On?h:0)<=p+g-y&&(this.startRow===null&&(this.startRow=u),this.endRow=u),i.push(e),e+=h,a!==On&&(this.endRow=u),e>=p+g-y){n=!1;break}if(this.endRow===d-1&&n)for(this.startRow=this.endRow;this.startRow>0;){var f=i[this.endRow]+h-i[this.startRow-1];if((f<=g-y||a!==On)&&(this.startRow-=1),f>=g-y)break}a===xa&&this.startRow!==null&&s&&s(this),this.startPosition=i[this.startRow],this.startPosition===void 0&&(this.startPosition=null),d<this.endRow&&(this.endRow=d-1),this.startRow!==null&&(this.count=this.endRow-this.startRow+1)}}],[{key:"DEFAULT_HEIGHT",get:function(){return 23}}]),t}(),S3=cQ;function hQ(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}function C3(t,r){for(var e=0;e<r.length;e++){var n=r[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function dQ(t,r,e){return r&&C3(t.prototype,r),e&&C3(t,e),t}var pQ=function(){function t(r,e){hQ(this,t),this.row=null,this.col=null,typeof r!="undefined"&&typeof e!="undefined"&&(this.row=r,this.col=e)}return dQ(t,[{key:"isValid",value:function(e){return!(this.row<0||this.col<0||this.row>=e.getSetting("totalRows")||this.col>=e.getSetting("totalColumns"))}},{key:"isEqual",value:function(e){return e===this?!0:this.row===e.row&&this.col===e.col}},{key:"isSouthEastOf",value:function(e){return this.row>=e.row&&this.col>=e.col}},{key:"isNorthWestOf",value:function(e){return this.row<=e.row&&this.col<=e.col}},{key:"isSouthWestOf",value:function(e){return this.row>=e.row&&this.col<=e.col}},{key:"isNorthEastOf",value:function(e){return this.row<=e.row&&this.col>=e.col}},{key:"normalize",value:function(){return this.row=this.row===null?this.row:Math.max(this.row,0),this.col=this.col===null?this.col:Math.max(this.col,0),this}},{key:"clone",value:function(){return new t(this.row,this.col)}},{key:"toObject",value:function(){return{row:this.row,col:this.col}}}]),t}(),ke=pQ;function yQ(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}function k3(t,r){for(var e=0;e<r.length;e++){var n=r[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function mQ(t,r,e){return r&&k3(t.prototype,r),e&&k3(t,e),t}var vQ=function(){function t(r){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:r,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:r;yQ(this,t),this.highlight=r.clone().normalize(),this.from=e.clone(),this.to=n.clone()}return mQ(t,[{key:"setHighlight",value:function(e){return this.highlight=e.clone().normalize(),this}},{key:"setFrom",value:function(e){return this.from=e.clone(),this}},{key:"setTo",value:function(e){return this.to=e.clone(),this}},{key:"isValid",value:function(e){return this.from.isValid(e)&&this.to.isValid(e)}},{key:"isSingle",value:function(){return this.from.row>=0&&this.from.row===this.to.row&&this.from.col>=0&&this.from.col===this.to.col}},{key:"getOuterHeight",value:function(){return Math.max(this.from.row,this.to.row)-Math.min(this.from.row,this.to.row)+1}},{key:"getOuterWidth",value:function(){return Math.max(this.from.col,this.to.col)-Math.min(this.from.col,this.to.col)+1}},{key:"getHeight",value:function(){var e=Math.max(this.from.row,0),n=Math.max(this.to.row,0);return Math.max(e,n)-Math.min(e,n)+1}},{key:"getWidth",value:function(){var e=Math.max(this.from.col,0),n=Math.max(this.to.col,0);return Math.max(e,n)-Math.min(e,n)+1}},{key:"includes",value:function(e){var n=e.row,i=e.col,o=this.getOuterTopLeftCorner(),a=this.getOuterBottomRightCorner();return o.row<=n&&a.row>=n&&o.col<=i&&a.col>=i}},{key:"includesRange",value:function(e){return this.includes(e.getOuterTopLeftCorner())&&this.includes(e.getOuterBottomRightCorner())}},{key:"isEqual",value:function(e){return Math.min(this.from.row,this.to.row)===Math.min(e.from.row,e.to.row)&&Math.max(this.from.row,this.to.row)===Math.max(e.from.row,e.to.row)&&Math.min(this.from.col,this.to.col)===Math.min(e.from.col,e.to.col)&&Math.max(this.from.col,this.to.col)===Math.max(e.from.col,e.to.col)}},{key:"overlaps",value:function(e){return e.isSouthEastOf(this.getOuterTopLeftCorner())&&e.isNorthWestOf(this.getOuterBottomRightCorner())}},{key:"isSouthEastOf",value:function(e){return this.getOuterTopLeftCorner().isSouthEastOf(e)||this.getOuterBottomRightCorner().isSouthEastOf(e)}},{key:"isNorthWestOf",value:function(e){return this.getOuterTopLeftCorner().isNorthWestOf(e)||this.getOuterBottomRightCorner().isNorthWestOf(e)}},{key:"isOverlappingHorizontally",value:function(e){return this.getOuterTopRightCorner().col>=e.getOuterTopLeftCorner().col&&this.getOuterTopRightCorner().col<=e.getOuterTopRightCorner().col||this.getOuterTopLeftCorner().col<=e.getOuterTopRightCorner().col&&this.getOuterTopLeftCorner().col>=e.getOuterTopLeftCorner().col}},{key:"isOverlappingVertically",value:function(e){return this.getOuterBottomRightCorner().row>=e.getOuterTopRightCorner().row&&this.getOuterBottomRightCorner().row<=e.getOuterBottomRightCorner().row||this.getOuterTopRightCorner().row<=e.getOuterBottomRightCorner().row&&this.getOuterTopRightCorner().row>=e.getOuterTopRightCorner().row}},{key:"expand",value:function(e){var n=this.getOuterTopLeftCorner(),i=this.getOuterBottomRightCorner();return e.row<n.row||e.col<n.col||e.row>i.row||e.col>i.col?(this.from=new ke(Math.min(n.row,e.row),Math.min(n.col,e.col)),this.to=new ke(Math.max(i.row,e.row),Math.max(i.col,e.col)),!0):!1}},{key:"expandByRange",value:function(e){if(this.includesRange(e)||!this.overlaps(e))return!1;var n=this.getOuterTopLeftCorner(),i=this.getOuterBottomRightCorner(),o=this.getDirection(),a=e.getOuterTopLeftCorner(),s=e.getOuterBottomRightCorner(),l=Math.min(n.row,a.row),p=Math.min(n.col,a.col),d=Math.max(i.row,s.row),g=Math.max(i.col,s.col),y=new ke(l,p),h=new ke(d,g);return this.from=y,this.to=h,this.setDirection(o),this.highlight.row===this.getOuterBottomRightCorner().row&&this.getVerticalDirection()==="N-S"&&this.flipDirectionVertically(),this.highlight.col===this.getOuterTopRightCorner().col&&this.getHorizontalDirection()==="W-E"&&this.flipDirectionHorizontally(),!0}},{key:"getDirection",value:function(){if(this.from.isNorthWestOf(this.to))return"NW-SE";if(this.from.isNorthEastOf(this.to))return"NE-SW";if(this.from.isSouthEastOf(this.to))return"SE-NW";if(this.from.isSouthWestOf(this.to))return"SW-NE"}},{key:"setDirection",value:function(e){switch(e){case"NW-SE":var n=[this.getOuterTopLeftCorner(),this.getOuterBottomRightCorner()];this.from=n[0],this.to=n[1];break;case"NE-SW":var i=[this.getOuterTopRightCorner(),this.getOuterBottomLeftCorner()];this.from=i[0],this.to=i[1];break;case"SE-NW":var o=[this.getOuterBottomRightCorner(),this.getOuterTopLeftCorner()];this.from=o[0],this.to=o[1];break;case"SW-NE":var a=[this.getOuterBottomLeftCorner(),this.getOuterTopRightCorner()];this.from=a[0],this.to=a[1];break}}},{key:"getVerticalDirection",value:function(){return["NE-SW","NW-SE"].indexOf(this.getDirection())>-1?"N-S":"S-N"}},{key:"getHorizontalDirection",value:function(){return["NW-SE","SW-NE"].indexOf(this.getDirection())>-1?"W-E":"E-W"}},{key:"flipDirectionVertically",value:function(){var e=this.getDirection();switch(e){case"NW-SE":this.setDirection("SW-NE");break;case"NE-SW":this.setDirection("SE-NW");break;case"SE-NW":this.setDirection("NE-SW");break;case"SW-NE":this.setDirection("NW-SE");break}}},{key:"flipDirectionHorizontally",value:function(){var e=this.getDirection();switch(e){case"NW-SE":this.setDirection("NE-SW");break;case"NE-SW":this.setDirection("NW-SE");break;case"SE-NW":this.setDirection("SW-NE");break;case"SW-NE":this.setDirection("SE-NW");break}}},{key:"getTopLeftCorner",value:function(){return new ke(Math.min(this.from.row,this.to.row),Math.min(this.from.col,this.to.col)).normalize()}},{key:"getBottomRightCorner",value:function(){return new ke(Math.max(this.from.row,this.to.row),Math.max(this.from.col,this.to.col)).normalize()}},{key:"getTopRightCorner",value:function(){return new ke(Math.min(this.from.row,this.to.row),Math.max(this.from.col,this.to.col)).normalize()}},{key:"getBottomLeftCorner",value:function(){return new ke(Math.max(this.from.row,this.to.row),Math.min(this.from.col,this.to.col)).normalize()}},{key:"getOuterTopLeftCorner",value:function(){return new ke(Math.min(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))}},{key:"getOuterBottomRightCorner",value:function(){return new ke(Math.max(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))}},{key:"getOuterTopRightCorner",value:function(){return new ke(Math.min(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))}},{key:"getOuterBottomLeftCorner",value:function(){return new ke(Math.max(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))}},{key:"isCorner",value:function(e,n){return n&&n.includes(e)&&(this.getOuterTopLeftCorner().isEqual(new ke(n.from.row,n.from.col))||this.getOuterTopRightCorner().isEqual(new ke(n.from.row,n.to.col))||this.getOuterBottomLeftCorner().isEqual(new ke(n.to.row,n.from.col))||this.getOuterBottomRightCorner().isEqual(new ke(n.to.row,n.to.col)))?!0:e.isEqual(this.getOuterTopLeftCorner())||e.isEqual(this.getOuterTopRightCorner())||e.isEqual(this.getOuterBottomLeftCorner())||e.isEqual(this.getOuterBottomRightCorner())}},{key:"getOppositeCorner",value:function(e,n){if(!(e instanceof ke))return!1;if(n&&n.includes(e)){if(this.getOuterTopLeftCorner().isEqual(new ke(n.from.row,n.from.col)))return this.getOuterBottomRightCorner();if(this.getOuterTopRightCorner().isEqual(new ke(n.from.row,n.to.col)))return this.getOuterBottomLeftCorner();if(this.getOuterBottomLeftCorner().isEqual(new ke(n.to.row,n.from.col)))return this.getOuterTopRightCorner();if(this.getOuterBottomRightCorner().isEqual(new ke(n.to.row,n.to.col)))return this.getOuterTopLeftCorner()}if(e.isEqual(this.getOuterBottomRightCorner()))return this.getOuterTopLeftCorner();if(e.isEqual(this.getOuterTopLeftCorner()))return this.getOuterBottomRightCorner();if(e.isEqual(this.getOuterTopRightCorner()))return this.getOuterBottomLeftCorner();if(e.isEqual(this.getOuterBottomLeftCorner()))return this.getOuterTopRightCorner()}},{key:"getBordersSharedWith",value:function(e){if(!this.includesRange(e))return[];var n={top:Math.min(this.from.row,this.to.row),bottom:Math.max(this.from.row,this.to.row),left:Math.min(this.from.col,this.to.col),right:Math.max(this.from.col,this.to.col)},i={top:Math.min(e.from.row,e.to.row),bottom:Math.max(e.from.row,e.to.row),left:Math.min(e.from.col,e.to.col),right:Math.max(e.from.col,e.to.col)},o=[];return n.top===i.top&&o.push("top"),n.right===i.right&&o.push("right"),n.bottom===i.bottom&&o.push("bottom"),n.left===i.left&&o.push("left"),o}},{key:"getInner",value:function(){for(var e=this.getOuterTopLeftCorner(),n=this.getOuterBottomRightCorner(),i=[],o=e.row;o<=n.row;o++)for(var a=e.col;a<=n.col;a++)!(this.from.row===o&&this.from.col===a)&&!(this.to.row===o&&this.to.col===a)&&i.push(new ke(o,a));return i}},{key:"getAll",value:function(){for(var e=this.getOuterTopLeftCorner(),n=this.getOuterBottomRightCorner(),i=[],o=e.row;o<=n.row;o++)for(var a=e.col;a<=n.col;a++)e.row===o&&e.col===a?i.push(e):n.row===o&&n.col===a?i.push(n):i.push(new ke(o,a));return i}},{key:"forAll",value:function(e){for(var n=this.getOuterTopLeftCorner(),i=this.getOuterBottomRightCorner(),o=n.row;o<=i.row;o++)for(var a=n.col;a<=i.col;a++){var s=e(o,a);if(s===!1)return}}},{key:"clone",value:function(){return new t(this.highlight,this.from,this.to)}},{key:"toObject",value:function(){return{from:this.from.toObject(),to:this.to.toObject()}}}]),t}(),Rr=vQ;function gQ(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}function O3(t,r){for(var e=0;e<r.length;e++){var n=r[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function bQ(t,r,e){return r&&O3(t.prototype,r),e&&O3(t,e),t}var wQ=function(){function t(r,e,n){gQ(this,t),this.offset=r,this.total=e,this.countTH=n}return bQ(t,[{key:"offsetted",value:function(e){return e+this.offset}},{key:"unOffsetted",value:function(e){return e-this.offset}},{key:"renderedToSource",value:function(e){return this.offsetted(e)}},{key:"sourceToRendered",value:function(e){return this.unOffsetted(e)}},{key:"offsettedTH",value:function(e){return e-this.countTH}},{key:"unOffsettedTH",value:function(e){return e+this.countTH}},{key:"visibleRowHeadedColumnToSourceColumn",value:function(e){return this.renderedToSource(this.offsettedTH(e))}},{key:"sourceColumnToVisibleRowHeadedColumn",value:function(e){return this.unOffsettedTH(this.sourceToRendered(e))}}]),t}(),_Q=wQ;function SQ(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}function R3(t,r){for(var e=0;e<r.length;e++){var n=r[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function CQ(t,r,e){return r&&R3(t.prototype,r),e&&R3(t,e),t}var kQ=function(){function t(r,e,n){SQ(this,t),this.offset=r,this.total=e,this.countTH=n}return CQ(t,[{key:"offsetted",value:function(e){return e+this.offset}},{key:"unOffsetted",value:function(e){return e-this.offset}},{key:"renderedToSource",value:function(e){return this.offsetted(e)}},{key:"sourceToRendered",value:function(e){return this.unOffsetted(e)}},{key:"offsettedTH",value:function(e){return e-this.countTH}},{key:"unOffsettedTH",value:function(e){return e+this.countTH}},{key:"visibleColHeadedRowToSourceRow",value:function(e){return this.renderedToSource(this.offsettedTH(e))}},{key:"sourceRowToVisibleColHeadedRow",value:function(e){return this.unOffsettedTH(this.sourceToRendered(e))}}]),t}(),OQ=kQ,RQ=pt,EQ=jv;RQ({target:"Object",stat:!0},{setPrototypeOf:EQ});var TQ=ot,E3=ht,xQ=Cs,AQ=gr,MQ=Tr,T3=bl,x3=TQ.Function,PQ=E3([].concat),IQ=E3([].join),D0={},DQ=function(t,r,e){if(!MQ(D0,r)){for(var n=[],i=0;i<r;i++)n[i]="a["+i+"]";D0[r]=x3("C,a","return new C("+IQ(n,",")+")")}return D0[r](t,e)},NQ=x3.bind||function(r){var e=xQ(this),n=e.prototype,i=T3(arguments,1),o=function(){var s=PQ(i,T3(arguments));return this instanceof o?DQ(e,s.length,s):e.apply(r,s)};return AQ(n)&&(o.prototype=n),o},$Q=pt,jQ=ho,N0=ca,LQ=NQ,A3=SE,HQ=br,M3=gr,FQ=xs,P3=Mt,$0=jQ("Reflect","construct"),BQ=Object.prototype,VQ=[].push,I3=P3(function(){function t(){}return!($0(function(){},[],t)instanceof t)}),D3=!P3(function(){$0(function(){})}),N3=I3||D3;$Q({target:"Reflect",stat:!0,forced:N3,sham:N3},{construct:function(r,e){A3(r),HQ(e);var n=arguments.length<3?r:A3(arguments[2]);if(D3&&!I3)return $0(r,e,n);if(r==n){switch(e.length){case 0:return new r;case 1:return new r(e[0]);case 2:return new r(e[0],e[1]);case 3:return new r(e[0],e[1],e[2]);case 4:return new r(e[0],e[1],e[2],e[3])}var i=[null];return N0(VQ,i,e),new(N0(LQ,r,i))}var o=n.prototype,a=FQ(M3(o)?o:BQ),s=N0(r,a,e);return M3(s)?s:a}});var WQ=0,ed=1,td=2;function UQ(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}function $3(t,r){for(var e=0;e<r.length;e++){var n=r[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function zQ(t,r,e){return r&&$3(t.prototype,r),e&&$3(t,e),t}var j3=function(){function t(){UQ(this,t),this.currentSize=0,this.nextSize=0,this.currentOffset=0,this.nextOffset=0}return zQ(t,[{key:"setSize",value:function(e){this.currentSize=this.nextSize,this.nextSize=e}},{key:"setOffset",value:function(e){this.currentOffset=this.nextOffset,this.nextOffset=e}}]),t}();function YQ(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}function L3(t,r){for(var e=0;e<r.length;e++){var n=r[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function GQ(t,r,e){return r&&L3(t.prototype,r),e&&L3(t,e),t}var KQ=function(){function t(){YQ(this,t),this.size=new j3,this.workingSpace=WQ,this.sharedSize=null}return GQ(t,[{key:"setSize",value:function(e){this.size.setSize(e)}},{key:"setOffset",value:function(e){this.size.setOffset(e)}},{key:"getViewSize",value:function(){return this.size}},{key:"isShared",value:function(){return this.sharedSize instanceof j3}},{key:"isPlaceOn",value:function(e){return this.workingSpace===e}},{key:"append",value:function(e){this.workingSpace=ed,e.workingSpace=td,this.sharedSize=e.getViewSize()}},{key:"prepend",value:function(e){this.workingSpace=td,e.workingSpace=ed,this.sharedSize=e.getViewSize()}}]),t}();function qQ(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}function H3(t,r){for(var e=0;e<r.length;e++){var n=r[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function XQ(t,r,e){return r&&H3(t.prototype,r),e&&H3(t,e),t}var F3=function(){function t(r,e,n){qQ(this,t),this.rootNode=r,this.nodesPool=e,this.sizeSet=new KQ,this.childNodeType=n.toUpperCase(),this.visualIndex=0,this.collectedNodes=[]}return XQ(t,[{key:"setSize",value:function(e){return this.sizeSet.setSize(e),this}},{key:"setOffset",value:function(e){return this.sizeSet.setOffset(e),this}},{key:"isSharedViewSet",value:function(){return this.sizeSet.isShared()}},{key:"getNode",value:function(e){return e<this.collectedNodes.length?this.collectedNodes[e]:null}},{key:"getCurrentNode",value:function(){var e=this.collectedNodes.length;return e>0?this.collectedNodes[e-1]:null}},{key:"getRenderedChildCount",value:function(){var e=this.rootNode,n=this.sizeSet,i=0;if(this.isSharedViewSet())for(var o=e.firstElementChild;o;){if(o.tagName===this.childNodeType)i+=1;else if(n.isPlaceOn(ed))break;o=o.nextElementSibling}else i=e.childElementCount;return i}},{key:"start",value:function(){this.collectedNodes.length=0,this.visualIndex=0;for(var e=this.rootNode,n=this.sizeSet,i=this.isSharedViewSet(),o=n.getViewSize(),a=o.nextSize,s=this.getRenderedChildCount();s<a;){var l=this.nodesPool();!i||i&&n.isPlaceOn(td)?e.appendChild(l):e.insertBefore(l,e.firstChild),s+=1}for(var p=i&&n.isPlaceOn(ed);s>a;)e.removeChild(p?e.firstChild:e.lastChild),s-=1}},{key:"render",value:function(){var e=this.rootNode,n=this.sizeSet,i=this.visualIndex;this.isSharedViewSet()&&n.isPlaceOn(td)&&(i+=n.sharedSize.nextSize);var o=e.childNodes[i];if(o.tagName!==this.childNodeType){var a=this.nodesPool();e.replaceChild(a,o),o=a}this.collectedNodes.push(o),this.visualIndex+=1}},{key:"end",value:function(){}}]),t}();function rd(t){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?rd=function(e){return typeof e}:rd=function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},rd(t)}function ZQ(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}function B3(t,r){for(var e=0;e<r.length;e++){var n=r[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function JQ(t,r,e){return r&&B3(t.prototype,r),e&&B3(t,e),t}function QQ(t,r){if(typeof r!="function"&&r!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(r&&r.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),r&&j0(t,r)}function j0(t,r){return j0=Object.setPrototypeOf||function(n,i){return n.__proto__=i,n},j0(t,r)}function eee(t){var r=nee();return function(){var n=nd(t),i;if(r){var o=nd(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return tee(this,i)}}function tee(t,r){if(r&&(rd(r)==="object"||typeof r=="function"))return r;if(r!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return ree(t)}function ree(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function nee(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function nd(t){return nd=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},nd(t)}var V3=function(t){QQ(e,t);var r=eee(e);function e(){return ZQ(this,e),r.apply(this,arguments)}return JQ(e,[{key:"prependView",value:function(i){return this.sizeSet.prepend(i.sizeSet),i.sizeSet.append(this.sizeSet),this}},{key:"appendView",value:function(i){return this.sizeSet.append(i.sizeSet),i.sizeSet.prepend(this.sizeSet),this}}]),e}(F3);function iee(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}function W3(t,r){for(var e=0;e<r.length;e++){var n=r[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function oee(t,r,e){return r&&W3(t.prototype,r),e&&W3(t,e),t}var aee=function(){function t(r){iee(this,t),this.nodeType=r.toUpperCase()}return oee(t,[{key:"setRootDocument",value:function(e){this.rootDocument=e}},{key:"obtain",value:function(){return this.rootDocument.createElement(this.nodeType)}}]),t}();function see(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}function U3(t,r){for(var e=0;e<r.length;e++){var n=r[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function uee(t,r,e){return r&&U3(t.prototype,r),e&&U3(t,e),t}var yf=function(){function t(r,e){see(this,t),this.nodesPool=typeof r=="string"?new aee(r):null,this.nodeType=r,this.rootNode=e,this.table=null,this.renderedNodes=0}return uee(t,[{key:"setTable",value:function(e){this.nodesPool&&this.nodesPool.setRootDocument(e.rootDocument),this.table=e}},{key:"adjust",value:function(){}},{key:"render",value:function(){}}]),t}();function id(t){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?id=function(e){return typeof e}:id=function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},id(t)}function lee(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}function z3(t,r){for(var e=0;e<r.length;e++){var n=r[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function fee(t,r,e){return r&&z3(t.prototype,r),e&&z3(t,e),t}function cee(t,r){if(typeof r!="function"&&r!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(r&&r.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),r&&L0(t,r)}function L0(t,r){return L0=Object.setPrototypeOf||function(n,i){return n.__proto__=i,n},L0(t,r)}function hee(t){var r=yee();return function(){var n=od(t),i;if(r){var o=od(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return dee(this,i)}}function dee(t,r){if(r&&(id(r)==="object"||typeof r=="function"))return r;if(r!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return pee(t)}function pee(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function yee(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function od(t){return od=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},od(t)}var mee=function(t){cee(e,t);var r=hee(e);function e(){var n;return lee(this,e),n=r.call(this,"TH"),n.orderViews=new WeakMap,n.sourceRowIndex=0,n}return fee(e,[{key:"obtainOrderView",value:function(i){var o=this,a;return this.orderViews.has(i)?a=this.orderViews.get(i):(a=new V3(i,function(s){return o.nodesPool.obtain(o.sourceRowIndex,s)},this.nodeType),this.orderViews.set(i,a)),a}},{key:"render",value:function(){for(var i=this.table,o=i.rowsToRender,a=i.rowHeaderFunctions,s=i.rowHeadersCount,l=i.rows,p=i.cells,d=0;d<o;d++){var g=this.table.renderedRowToSource(d),y=l.getRenderedNode(d);this.sourceRowIndex=g;var h=this.obtainOrderView(y),u=p.obtainOrderView(y);h.appendView(u).setSize(s).setOffset(this.table.renderedColumnToSource(0)).start();for(var f=0;f<s;f++){h.render();var c=h.getCurrentNode();c.className="",c.removeAttribute("style"),a[f](g,c,f)}h.end()}}}]),e}(yf);function ad(t){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?ad=function(e){return typeof e}:ad=function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ad(t)}function vee(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}function Y3(t,r){for(var e=0;e<r.length;e++){var n=r[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function gee(t,r,e){return r&&Y3(t.prototype,r),e&&Y3(t,e),t}function bee(t,r){if(typeof r!="function"&&r!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(r&&r.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),r&&H0(t,r)}function H0(t,r){return H0=Object.setPrototypeOf||function(n,i){return n.__proto__=i,n},H0(t,r)}function wee(t){var r=Cee();return function(){var n=sd(t),i;if(r){var o=sd(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return _ee(this,i)}}function _ee(t,r){if(r&&(ad(r)==="object"||typeof r=="function"))return r;if(r!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return See(t)}function See(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Cee(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function sd(t){return sd=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},sd(t)}var kee=function(t){bee(e,t);var r=wee(e);function e(n){return vee(this,e),r.call(this,null,n)}return gee(e,[{key:"adjust",value:function(){var i=this.table,o=i.columnHeadersCount,a=i.rowHeadersCount,s=this.rootNode.firstChild;if(o){for(var l=this.table.columnsToRender,p=l+a,d=0,g=o;d<g;d++){for(s=this.rootNode.childNodes[d],s||(s=this.table.rootDocument.createElement("tr"),this.rootNode.appendChild(s)),this.renderedNodes=s.childNodes.length;this.renderedNodes<p;)s.appendChild(this.table.rootDocument.createElement("th")),this.renderedNodes+=1;for(;this.renderedNodes>p;)s.removeChild(s.lastChild),this.renderedNodes-=1}var y=this.rootNode.childNodes.length;if(y>o)for(var h=o;h<y;h++)this.rootNode.removeChild(this.rootNode.lastChild)}else s&&kn(s)}},{key:"render",value:function(){for(var i=this.table.columnHeadersCount,o=0;o<i;o+=1)for(var a=this.table,s=a.columnHeaderFunctions,l=a.columnsToRender,p=a.rowHeadersCount,d=this.rootNode.childNodes[o],g=-1*p;g<l;g+=1){var y=this.table.renderedColumnToSource(g),h=d.childNodes[g+p];h.className="",h.removeAttribute("style"),s[o](y,h,o)}}}]),e}(yf);function ud(t){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?ud=function(e){return typeof e}:ud=function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ud(t)}function Oee(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}function G3(t,r){for(var e=0;e<r.length;e++){var n=r[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function Ree(t,r,e){return r&&G3(t.prototype,r),e&&G3(t,e),t}function Eee(t,r){if(typeof r!="function"&&r!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(r&&r.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),r&&F0(t,r)}function F0(t,r){return F0=Object.setPrototypeOf||function(n,i){return n.__proto__=i,n},F0(t,r)}function Tee(t){var r=Mee();return function(){var n=ld(t),i;if(r){var o=ld(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return xee(this,i)}}function xee(t,r){if(r&&(ud(r)==="object"||typeof r=="function"))return r;if(r!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Aee(t)}function Aee(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Mee(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function ld(t){return ld=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},ld(t)}var Pee=function(t){Eee(e,t);var r=Tee(e);function e(n){return Oee(this,e),r.call(this,null,n)}return Ree(e,[{key:"adjust",value:function(){for(var i=this.table,o=i.columnsToRender,a=i.rowHeadersCount,s=o+a;this.renderedNodes<s;)this.rootNode.appendChild(this.table.rootDocument.createElement("col")),this.renderedNodes+=1;for(;this.renderedNodes>s;)this.rootNode.removeChild(this.rootNode.lastChild),this.renderedNodes-=1}},{key:"render",value:function(){this.adjust();for(var i=this.table,o=i.columnsToRender,a=i.rowHeadersCount,s=0;s<a;s++){var l=this.table.renderedColumnToSource(s),p=this.table.columnUtils.getHeaderWidth(l);this.rootNode.childNodes[s].style.width="".concat(p,"px")}for(var d=0;d<o;d++){var g=this.table.renderedColumnToSource(d),y=this.table.columnUtils.getStretchedColumnWidth(g);this.rootNode.childNodes[d+a].style.width="".concat(y,"px")}var h=this.rootNode.firstChild;h&&Ie(h,"rowHeader")}}]),e}(yf);function tr(){if(at(console)){var t;(t=console).warn.apply(t,arguments)}}function B0(){if(at(console)){var t;(t=console).error.apply(t,arguments)}}function fd(t){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?fd=function(e){return typeof e}:fd=function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},fd(t)}var K3;function Iee(t,r){return r||(r=t.slice(0)),Object.freeze(Object.defineProperties(t,{raw:{value:Object.freeze(r)}}))}function Dee(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}function q3(t,r){for(var e=0;e<r.length;e++){var n=r[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function Nee(t,r,e){return r&&q3(t.prototype,r),e&&q3(t,e),t}function $ee(t,r){if(typeof r!="function"&&r!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(r&&r.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),r&&V0(t,r)}function V0(t,r){return V0=Object.setPrototypeOf||function(n,i){return n.__proto__=i,n},V0(t,r)}function jee(t){var r=Fee();return function(){var n=cd(t),i;if(r){var o=cd(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return Lee(this,i)}}function Lee(t,r){if(r&&(fd(r)==="object"||typeof r=="function"))return r;if(r!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Hee(t)}function Hee(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Fee(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function cd(t){return cd=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},cd(t)}var X3=!1,Bee=function(t){$ee(e,t);var r=jee(e);function e(n){var i;return Dee(this,e),i=r.call(this,"TR",n),i.orderView=new F3(n,function(o){return i.nodesPool.obtain(o)},i.nodeType),i}return Nee(e,[{key:"getRenderedNode",value:function(i){return this.orderView.getNode(i)}},{key:"render",value:function(){var i=this.table.rowsToRender;!X3&&i>1e3&&(X3=!0,tr(Kt(K3||(K3=Iee([`Performance tip: Handsontable rendered more than 1000 visible rows. Consider limiting 
        the number of rendered rows by specifying the table height and/or turning off the "renderAllRows" option.`],[`Performance tip: Handsontable rendered more than 1000 visible rows. Consider limiting\\x20
        the number of rendered rows by specifying the table height and/or turning off the "renderAllRows" option.`]))))),this.orderView.setSize(i).setOffset(this.table.renderedRowToSource(0)).start();for(var o=0;o<i;o++)this.orderView.render();this.orderView.end()}}]),e}(yf);function hd(t){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?hd=function(e){return typeof e}:hd=function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},hd(t)}function Vee(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}function Z3(t,r){for(var e=0;e<r.length;e++){var n=r[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function Wee(t,r,e){return r&&Z3(t.prototype,r),e&&Z3(t,e),t}function Uee(t,r){if(typeof r!="function"&&r!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(r&&r.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),r&&W0(t,r)}function W0(t,r){return W0=Object.setPrototypeOf||function(n,i){return n.__proto__=i,n},W0(t,r)}function zee(t){var r=Kee();return function(){var n=dd(t),i;if(r){var o=dd(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return Yee(this,i)}}function Yee(t,r){if(r&&(hd(r)==="object"||typeof r=="function"))return r;if(r!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Gee(t)}function Gee(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Kee(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function dd(t){return dd=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},dd(t)}var qee=function(t){Uee(e,t);var r=zee(e);function e(){var n;return Vee(this,e),n=r.call(this,"TD"),n.orderViews=new WeakMap,n.sourceRowIndex=0,n}return Wee(e,[{key:"obtainOrderView",value:function(i){var o=this,a;return this.orderViews.has(i)?a=this.orderViews.get(i):(a=new V3(i,function(s){return o.nodesPool.obtain(o.sourceRowIndex,s)},this.nodeType),this.orderViews.set(i,a)),a}},{key:"render",value:function(){for(var i=this.table,o=i.rowsToRender,a=i.columnsToRender,s=i.rows,l=i.rowHeaders,p=0;p<o;p++){var d=this.table.renderedRowToSource(p),g=s.getRenderedNode(p);this.sourceRowIndex=d;var y=this.obtainOrderView(g),h=l.obtainOrderView(g);y.prependView(h).setSize(a).setOffset(this.table.renderedColumnToSource(0)).start();for(var u=0;u<a;u++){y.render();var f=y.getCurrentNode(),c=this.table.renderedColumnToSource(u);lt(f,"hide")||(f.className=""),f.removeAttribute("style"),this.table.cellRenderer(d,c,f)}y.end()}}}]),e}(yf);function Xee(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}function J3(t,r){for(var e=0;e<r.length;e++){var n=r[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function Zee(t,r,e){return r&&J3(t.prototype,r),e&&J3(t,e),t}var Jee=function(){function t(r){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n=e.cellRenderer;Xee(this,t),this.rootNode=r,this.rootDocument=this.rootNode.ownerDocument,this.rowHeaders=null,this.columnHeaders=null,this.colGroup=null,this.rows=null,this.cells=null,this.rowFilter=null,this.columnFilter=null,this.rowUtils=null,this.columnUtils=null,this.rowsToRender=0,this.columnsToRender=0,this.rowHeaderFunctions=[],this.rowHeadersCount=0,this.columnHeaderFunctions=[],this.columnHeadersCount=0,this.cellRenderer=n}return Zee(t,[{key:"setAxisUtils",value:function(e,n){this.rowUtils=e,this.columnUtils=n}},{key:"setViewportSize",value:function(e,n){this.rowsToRender=e,this.columnsToRender=n}},{key:"setFilters",value:function(e,n){this.rowFilter=e,this.columnFilter=n}},{key:"setHeaderContentRenderers",value:function(e,n){this.rowHeaderFunctions=e,this.rowHeadersCount=e.length,this.columnHeaderFunctions=n,this.columnHeadersCount=n.length}},{key:"setRenderers",value:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},n=e.rowHeaders,i=e.columnHeaders,o=e.colGroup,a=e.rows,s=e.cells;n.setTable(this),i.setTable(this),o.setTable(this),a.setTable(this),s.setTable(this),this.rowHeaders=n,this.columnHeaders=i,this.colGroup=o,this.rows=a,this.cells=s}},{key:"renderedRowToSource",value:function(e){return this.rowFilter.renderedToSource(e)}},{key:"renderedColumnToSource",value:function(e){return this.columnFilter.renderedToSource(e)}},{key:"render",value:function(){this.colGroup.adjust(),this.columnHeaders.adjust(),this.rows.adjust(),this.rowHeaders.adjust(),this.columnHeaders.render(),this.rows.render(),this.rowHeaders.render(),this.cells.render(),this.columnUtils.calculateWidths(),this.colGroup.render();for(var e=this.rowsToRender,n=this.rows,i=0;i<e;i++){var o=n.getRenderedNode(i);if(o.firstChild){var a=this.renderedRowToSource(i),s=this.rowUtils.getHeight(a);s?o.firstChild.style.height="".concat(s-1,"px"):o.firstChild.style.height=""}}}}]),t}();function Qee(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}function Q3(t,r){for(var e=0;e<r.length;e++){var n=r[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function ete(t,r,e){return r&&Q3(t.prototype,r),e&&Q3(t,e),t}var tte=function(){function t(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},e=r.TABLE,n=r.THEAD,i=r.COLGROUP,o=r.TBODY,a=r.rowUtils,s=r.columnUtils,l=r.cellRenderer;Qee(this,t),this.renderer=new Jee(e,{cellRenderer:l}),this.renderer.setRenderers({rowHeaders:new mee,columnHeaders:new kee(n),colGroup:new Pee(i),rows:new Bee(o),cells:new qee}),this.renderer.setAxisUtils(a,s)}return ete(t,[{key:"setFilters",value:function(e,n){return this.renderer.setFilters(e,n),this}},{key:"setViewportSize",value:function(e,n){return this.renderer.setViewportSize(e,n),this}},{key:"setHeaderContentRenderers",value:function(e,n){return this.renderer.setHeaderContentRenderers(e,n),this}},{key:"adjust",value:function(){this.renderer.adjust()}},{key:"render",value:function(){this.renderer.render()}}]),t}(),rte=lh,nte=fT;rte("Map",function(t){return function(){return t(this,arguments.length?arguments[0]:void 0)}},nte);function pd(t){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?pd=function(e){return typeof e}:pd=function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},pd(t)}function ite(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}function e6(t,r){for(var e=0;e<r.length;e++){var n=r[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function ote(t,r,e){return r&&e6(t.prototype,r),e&&e6(t,e),t}var ate=function(){function t(r){ite(this,t),this.wot=r,this.headerWidths=new Map}return ote(t,[{key:"getWidth",value:function(e){var n=this.wot.wtSettings.settings.columnWidth;return typeof n=="function"?n=n(e):pd(n)==="object"&&(n=n[e]),n||this.wot.wtSettings.settings.defaultColumnWidth}},{key:"getStretchedColumnWidth",value:function(e){var n=this.getWidth(e),i=this.wot.wtViewport.columnsRenderCalculator,o=n!=null?n:this.wot.wtSettings.settings.defaultColumnWidth;if(i){var a=i.getStretchedColumnWidth(e,o);a&&(o=a)}return o}},{key:"getHeaderHeight",value:function(e){var n=this.wot.wtSettings.settings.defaultRowHeight,i=this.wot.wtViewport.oversizedColumnHeaders[e];return i!==void 0&&(n=n?Math.max(n,i):i),n}},{key:"getHeaderWidth",value:function(e){return this.headerWidths.get(this.wot.wtTable.columnFilter.sourceToRendered(e))}},{key:"calculateWidths",value:function(){var e=this.wot,n=e.wtTable,i=e.wtViewport,o=e.cloneSource,a=o?o.wtTable.holder:n.holder,s=a.offsetHeight<a.scrollHeight?Pr():0,l=e.getSetting("rowHeaderWidth");if(i.columnsRenderCalculator.refreshStretching(i.getViewportWidth()-s),l=e.getSetting("onModifyRowHeaderWidth",l),l!=null)for(var p=e.getSetting("rowHeaders").length,d=e.getSetting("defaultColumnWidth"),g=0;g<p;g++){var y=Array.isArray(l)?l[g]:l;y=y==null?d:y,this.headerWidths.set(g,y)}}}]),t}();function ste(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}function t6(t,r){for(var e=0;e<r.length;e++){var n=r[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function ute(t,r,e){return r&&t6(t.prototype,r),e&&t6(t,e),t}var lte=function(){function t(r){ste(this,t),this.wot=r}return ute(t,[{key:"getHeight",value:function(e){var n=this.wot.wtSettings.settings.rowHeight(e),i=this.wot.wtViewport.oversizedRows[e];return i!==void 0&&(n=n===void 0?i:Math.max(n,i)),n}}]),t}(),eu="top",ti="bottom",tu="left",ru="top_left_corner",Io="bottom_left_corner",r6=[eu,ti,tu,ru,Io],mf={};function vf(t){var r=t.OVERLAY_NAME;if(r6.indexOf(r)===-1)throw new Error("Unsupported overlay (".concat(r,")."));U0(r)||(mf[r]=t)}function gf(t,r){return new mf[t](r)}function U0(t){return mf[t]!==void 0}function fte(t,r){return!t||!mf[r]?!1:t instanceof mf[r]}function cte(t){return pte(t)||dte(t)||n6(t)||hte()}function hte(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function dte(t){if(typeof Symbol!="undefined"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function pte(t){if(Array.isArray(t))return z0(t)}function yte(t,r){return gte(t)||vte(t,r)||n6(t,r)||mte()}function mte(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function n6(t,r){if(!!t){if(typeof t=="string")return z0(t,r);var e=Object.prototype.toString.call(t).slice(8,-1);if(e==="Object"&&t.constructor&&(e=t.constructor.name),e==="Map"||e==="Set")return Array.from(t);if(e==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return z0(t,r)}}function z0(t,r){(r==null||r>t.length)&&(r=t.length);for(var e=0,n=new Array(r);e<r;e++)n[e]=t[e];return n}function vte(t,r){var e=t==null?null:typeof Symbol!="undefined"&&t[Symbol.iterator]||t["@@iterator"];if(e!=null){var n=[],i=!0,o=!1,a,s;try{for(e=e.call(t);!(i=(a=e.next()).done)&&(n.push(a.value),!(r&&n.length===r));i=!0);}catch(l){o=!0,s=l}finally{try{!i&&e.return!=null&&e.return()}finally{if(o)throw s}}return n}}function gte(t){if(Array.isArray(t))return t}function bte(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}function i6(t,r){for(var e=0;e<r.length;e++){var n=r[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function wte(t,r,e){return r&&i6(t.prototype,r),e&&i6(t,e),t}var _te=function(){function t(r,e){var n=this;bte(this,t),this.isMaster=!r.cloneOverlay,this.wot=r,this.instance=this.wot,this.TABLE=e,this.TBODY=null,this.THEAD=null,this.COLGROUP=null,this.tableOffset=0,this.holderOffset=0,this.hasTableHeight=!0,this.hasTableWidth=!0,this.isTableVisible=!1,k0(this.TABLE),this.spreader=this.createSpreader(this.TABLE),this.hider=this.createHider(this.spreader),this.holder=this.createHolder(this.hider),this.wtRootElement=this.holder.parentNode,this.isMaster&&this.alignOverlaysWithTrimmingContainer(),this.fixTableDomTree(),this.rowFilter=null,this.columnFilter=null,this.correctHeaderWidth=!1;var i=this.wot.wtSettings.settings.rowHeaderWidth;this.wot.wtSettings.settings.rowHeaderWidth=function(){return n._modifyRowHeaderWidth(i)},this.rowUtils=new lte(this.wot),this.columnUtils=new ate(this.wot),this.tableRenderer=new tte({TABLE:this.TABLE,THEAD:this.THEAD,COLGROUP:this.COLGROUP,TBODY:this.TBODY,rowUtils:this.rowUtils,columnUtils:this.columnUtils,cellRenderer:this.wot.wtSettings.settings.cellRenderer})}return wte(t,[{key:"is",value:function(e){return fte(this.wot.cloneOverlay,e)}},{key:"fixTableDomTree",value:function(){var e=this.wot.rootDocument;this.TBODY=this.TABLE.querySelector("tbody"),this.TBODY||(this.TBODY=e.createElement("tbody"),this.TABLE.appendChild(this.TBODY)),this.THEAD=this.TABLE.querySelector("thead"),this.THEAD||(this.THEAD=e.createElement("thead"),this.TABLE.insertBefore(this.THEAD,this.TBODY)),this.COLGROUP=this.TABLE.querySelector("colgroup"),this.COLGROUP||(this.COLGROUP=e.createElement("colgroup"),this.TABLE.insertBefore(this.COLGROUP,this.THEAD)),this.wot.getSetting("columnHeaders").length&&!this.THEAD.childNodes.length&&this.THEAD.appendChild(e.createElement("TR"))}},{key:"createSpreader",value:function(e){var n=e.parentNode,i;return(!n||n.nodeType!==Node.ELEMENT_NODE||!lt(n,"wtHolder"))&&(i=this.wot.rootDocument.createElement("div"),i.className="wtSpreader",n&&n.insertBefore(i,e),i.appendChild(e)),i.style.position="relative",i}},{key:"createHider",value:function(e){var n=e.parentNode,i;return(!n||n.nodeType!==Node.ELEMENT_NODE||!lt(n,"wtHolder"))&&(i=this.wot.rootDocument.createElement("div"),i.className="wtHider",n&&n.insertBefore(i,e),i.appendChild(e)),i}},{key:"createHolder",value:function(e){var n=e.parentNode,i;return(!n||n.nodeType!==Node.ELEMENT_NODE||!lt(n,"wtHolder"))&&(i=this.wot.rootDocument.createElement("div"),i.style.position="relative",i.className="wtHolder",n&&n.insertBefore(i,e),this.isMaster&&(i.parentNode.className+="ht_master handsontable"),i.appendChild(e)),i}},{key:"draw",value:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,n=this.wot,i=n.wtOverlays,o=n.wtViewport,a=n.getSetting("totalRows"),s=n.getSetting("totalColumns"),l=n.getSetting("rowHeaders"),p=l.length,d=n.getSetting("columnHeaders"),g=d.length,y=!1,h=e;if(this.isMaster&&(this.holderOffset=ar(this.holder),h=o.createRenderCalculators(h),p&&!n.getSetting("fixedColumnsLeft"))){var u=i.leftOverlay.getScrollPosition(),f=this.correctHeaderWidth;this.correctHeaderWidth=u>0,f!==this.correctHeaderWidth&&(h=!1)}if(this.isMaster&&(y=i.prepareOverlays()),h)this.isMaster&&o.createVisibleCalculators(),i&&i.refresh(!0);else{this.isMaster?this.tableOffset=ar(this.TABLE):this.tableOffset=this.wot.cloneSource.wtTable.tableOffset;var c=a>0?this.getFirstRenderedRow():0,v=s>0?this.getFirstRenderedColumn():0;this.rowFilter=new OQ(c,a,g),this.columnFilter=new _Q(v,s,p);var m=!0;if(this.isMaster){this.alignOverlaysWithTrimmingContainer();var b={};this.wot.getSetting("beforeDraw",!0,b),m=b.skipRender!==!0}if(m){this.tableRenderer.setHeaderContentRenderers(l,d),(this.is(ti)||this.is(Io))&&this.tableRenderer.setHeaderContentRenderers(l,[]),this.resetOversizedRows(),this.tableRenderer.setViewportSize(this.getRenderedRowsCount(),this.getRenderedColumnsCount()).setFilters(this.rowFilter,this.columnFilter).render();var w;if(this.isMaster&&(w=this.wot.wtViewport.getWorkspaceWidth(),this.wot.wtViewport.containerWidth=null,this.markOversizedColumnHeaders()),this.adjustColumnHeaderHeights(),(this.isMaster||this.is(ti))&&this.markOversizedRows(),this.isMaster){this.wot.wtViewport.createVisibleCalculators(),this.wot.wtOverlays.refresh(!1),this.wot.wtOverlays.applyToDOM();var _=sr(this.hider),C=sr(this.TABLE);_!==0&&C!==_&&(this.columnUtils.calculateWidths(),this.tableRenderer.renderer.colGroup.render()),w!==this.wot.wtViewport.getWorkspaceWidth()&&(this.wot.wtViewport.containerWidth=null,this.columnUtils.calculateWidths(),this.tableRenderer.renderer.colGroup.render()),this.wot.getSetting("onDraw",!0)}else this.is(ti)&&this.wot.cloneSource.wtOverlays.adjustElementsSize()}}if(this.isMaster){var R=i.topOverlay.resetFixedPosition();i.bottomOverlay.clone&&(R=i.bottomOverlay.resetFixedPosition()||R),R=i.leftOverlay.resetFixedPosition()||R,i.topLeftCornerOverlay&&i.topLeftCornerOverlay.resetFixedPosition(),i.bottomLeftCornerOverlay&&i.bottomLeftCornerOverlay.clone&&i.bottomLeftCornerOverlay.resetFixedPosition(),R&&(i.refreshAll(),i.adjustElementsSize())}return this.refreshSelections(h),y&&i.syncScrollWithMaster(),n.drawn=!0,this}},{key:"markIfOversizedColumnHeader",value:function(e){for(var n=this.wot.wtTable.columnFilter.renderedToSource(e),i=this.wot.getSetting("columnHeaders").length,o=this.wot.wtSettings.settings.defaultRowHeight,a,s,l,p=this.wot.getSetting("columnHeaderHeight")||[];i;)i-=1,a=this.wot.wtTable.getColumnHeaderHeight(i),s=this.wot.wtTable.getColumnHeader(n,i),!!s&&(l=xi(s),(!a&&o<l||a<l)&&(this.wot.wtViewport.oversizedColumnHeaders[i]=l),Array.isArray(p)?p[i]!==null&&p[i]!==void 0&&(this.wot.wtViewport.oversizedColumnHeaders[i]=p[i]):isNaN(p)||(this.wot.wtViewport.oversizedColumnHeaders[i]=p),this.wot.wtViewport.oversizedColumnHeaders[i]<(p[i]||p)&&(this.wot.wtViewport.oversizedColumnHeaders[i]=p[i]||p))}},{key:"adjustColumnHeaderHeights",value:function(){for(var e=this.wot,n=e.wtTable.THEAD.childNodes,i=e.wtViewport.oversizedColumnHeaders,o=e.getSetting("columnHeaders"),a=0,s=o.length;a<s;a++)if(i[a]){if(!n[a]||n[a].childNodes.length===0)return;n[a].childNodes[0].style.height="".concat(i[a],"px")}}},{key:"resetOversizedRows",value:function(){var e=this.wot;if(!(!this.isMaster&&!this.is(ti))&&!e.getSetting("externalRowCalculator"))for(var n=this.getRenderedRowsCount(),i=0;i<n;i++){var o=this.rowFilter.renderedToSource(i);e.wtViewport.oversizedRows&&e.wtViewport.oversizedRows[o]&&(e.wtViewport.oversizedRows[o]=void 0)}}},{key:"removeClassFromCells",value:function(e){for(var n=this.TABLE.querySelectorAll(".".concat(e)),i=0,o=n.length;i<o;i++)dt(n[i],e)}},{key:"refreshSelections",value:function(e){var n=this.wot;if(!!n.selections){var i=Array.from(n.selections),o=i.length;if(e){for(var a=[],s=0;s<o;s++){for(var l=i[s].settings,p=l.highlightHeaderClassName,d=l.highlightRowClassName,g=l.highlightColumnClassName,y=i[s].classNames,h=y.length,u=0;u<h;u++)a.includes(y[u])||a.push(y[u]);p&&!a.includes(p)&&a.push(p),d&&!a.includes(d)&&a.push(d),g&&!a.includes(g)&&a.push(g)}var f=n.getSetting("onBeforeRemoveCellClassNames");if(Array.isArray(f))for(var c=0;c<f.length;c++)a.push(f[c]);for(var v=a.length,m=0;m<v;m++)this.removeClassFromCells(a[m])}for(var b=0;b<o;b++)i[b].draw(n,e)}}},{key:"getCell",value:function(e){var n=e.row,i=e.col,o=this.wot.getSetting("onModifyGetCellCoords",n,i);if(o&&Array.isArray(o)){var a=yte(o,2);n=a[0],i=a[1]}if(this.isRowBeforeRenderedRows(n))return-1;if(this.isRowAfterRenderedRows(n))return-2;if(this.isColumnBeforeRenderedColumns(i))return-3;if(this.isColumnAfterRenderedColumns(i))return-4;var s;if(n<0?s=this.THEAD.childNodes[this.rowFilter.sourceRowToVisibleColHeadedRow(n)]:s=this.TBODY.childNodes[this.rowFilter.sourceToRendered(n)],!s&&n>=0)throw new Error("TR was expected to be rendered but is not");var l=s.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(i)];if(!l&&i>=0)throw new Error("TD or TH was expected to be rendered but is not");return l}},{key:"getColumnHeader",value:function(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,i=this.THEAD.childNodes[n];return i==null?void 0:i.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(e)]}},{key:"getColumnHeaders",value:function(e){var n=[],i=this.columnFilter.sourceColumnToVisibleRowHeadedColumn(e);return this.THEAD.childNodes.forEach(function(o){var a=o.childNodes[i];a&&n.push(a)}),n}},{key:"getRowHeader",value:function(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;if(this.columnFilter.sourceColumnToVisibleRowHeadedColumn(0)!==0){var i=this.wot.getSetting("rowHeaders").length;if(!(n>=i)){var o=this.TBODY.childNodes[this.rowFilter.sourceToRendered(e)];return o==null?void 0:o.childNodes[n]}}}},{key:"getRowHeaders",value:function(e){if(this.columnFilter.sourceColumnToVisibleRowHeadedColumn(0)===0)return[];for(var n=[],i=this.wot.getSetting("rowHeaders").length,o=0;o<i;o++){var a=this.TBODY.childNodes[this.rowFilter.sourceToRendered(e)],s=a==null?void 0:a.childNodes[o];s&&n.push(s)}return n}},{key:"getCoords",value:function(e){var n=e;if(n.nodeName!=="TD"&&n.nodeName!=="TH"&&(n=Ti(n,["TD","TH"])),n===null)return null;var i=n.parentNode,o=i.parentNode,a=Zx(i),s=n.cellIndex;if(xo(ru,n,this.wtRootElement)||xo(eu,n,this.wtRootElement))o.nodeName==="THEAD"&&(a-=o.childNodes.length);else if(xo(Io,n,this.wtRootElement)||xo(ti,n,this.wtRootElement)){var l=this.wot.getSetting("totalRows");a=l-o.childNodes.length+a}else o===this.THEAD?a=this.rowFilter.visibleColHeadedRowToSourceRow(a):a=this.rowFilter.renderedToSource(a);return xo(ru,n,this.wtRootElement)||xo(tu,n,this.wtRootElement)||xo(Io,n,this.wtRootElement)?s=this.columnFilter.offsettedTH(s):s=this.columnFilter.visibleRowHeadedColumnToSourceColumn(s),new ke(a,s)}},{key:"markOversizedRows",value:function(){if(!this.wot.getSetting("externalRowCalculator")){var e=this.TBODY.childNodes.length,n=e*this.wot.wtSettings.settings.defaultRowHeight,i=xi(this.TBODY)-1,o,a,s,l,p;if(!(n===i&&!this.wot.getSetting("fixedRowsBottom")))for(;e;)e-=1,s=this.rowFilter.renderedToSource(e),o=this.getRowHeight(s),l=this.getTrForRow(s),p=l.querySelector("th"),p?a=xi(p):a=xi(l)-1,(!o&&this.wot.wtSettings.settings.defaultRowHeight<a||o<a)&&(a+=1,this.wot.wtViewport.oversizedRows[s]=a)}}},{key:"getTrForRow",value:function(e){return this.TBODY.childNodes[this.rowFilter.sourceToRendered(e)]}},{key:"isColumnHeaderRendered",value:function(e){if(e>=0)return!1;var n=this.wot.getSetting("rowHeaders"),i=n.length;return Math.abs(e)<=i}},{key:"isRowHeaderRendered",value:function(e){if(e>=0)return!1;var n=this.wot.getSetting("columnHeaders"),i=n.length;return Math.abs(e)<=i}},{key:"isRowBeforeRenderedRows",value:function(e){var n=this.getFirstRenderedRow();return e<0&&n<=0?!this.isRowHeaderRendered(e):e<n}},{key:"isRowAfterRenderedRows",value:function(e){return e>this.getLastRenderedRow()}},{key:"isColumnBeforeRenderedColumns",value:function(e){var n=this.getFirstRenderedColumn();return e<0&&n<=0?!this.isColumnHeaderRendered(e):e<n}},{key:"isColumnAfterRenderedColumns",value:function(e){return this.columnFilter&&e>this.getLastRenderedColumn()}},{key:"isColumnAfterViewport",value:function(e){return this.columnFilter&&e>this.getLastVisibleColumn()}},{key:"isRowAfterViewport",value:function(e){return this.rowFilter&&e>this.getLastVisibleRow()}},{key:"isColumnBeforeViewport",value:function(e){return this.columnFilter&&this.columnFilter.sourceToRendered(e)<0&&e>=0}},{key:"isLastRowFullyVisible",value:function(){return this.getLastVisibleRow()===this.getLastRenderedRow()}},{key:"isLastColumnFullyVisible",value:function(){return this.getLastVisibleColumn()===this.getLastRenderedColumn()}},{key:"allRowsInViewport",value:function(){return this.wot.getSetting("totalRows")===this.getVisibleRowsCount()}},{key:"allColumnsInViewport",value:function(){return this.wot.getSetting("totalColumns")===this.getVisibleColumnsCount()}},{key:"getRowHeight",value:function(e){return this.rowUtils.getHeight(e)}},{key:"getColumnHeaderHeight",value:function(e){return this.columnUtils.getHeaderHeight(e)}},{key:"getColumnWidth",value:function(e){return this.columnUtils.getWidth(e)}},{key:"getStretchedColumnWidth",value:function(e){return this.columnUtils.getStretchedColumnWidth(e)}},{key:"hasDefinedSize",value:function(){return this.hasTableHeight&&this.hasTableWidth}},{key:"isVisible",value:function(){return Xs(this.TABLE)}},{key:"_modifyRowHeaderWidth",value:function(e){var n=qt(e)?e():null;return Array.isArray(n)?(n=cte(n),n[n.length-1]=this._correctRowHeaderWidth(n[n.length-1])):n=this._correctRowHeaderWidth(n),n}},{key:"_correctRowHeaderWidth",value:function(e){var n=e;return typeof e!="number"&&(n=this.wot.getSetting("defaultColumnWidth")),this.correctHeaderWidth&&(n+=1),n}}]),t}(),nu=_te,Ste="calculatedRows",o6={getFirstRenderedRow:function(){var r=this.wot.wtViewport.rowsRenderCalculator.startRow;return r===null?-1:r},getFirstVisibleRow:function(){var r=this.wot.wtViewport.rowsVisibleCalculator.startRow;return r===null?-1:r},getLastRenderedRow:function(){var r=this.wot.wtViewport.rowsRenderCalculator.endRow;return r===null?-1:r},getLastVisibleRow:function(){var r=this.wot.wtViewport.rowsVisibleCalculator.endRow;return r===null?-1:r},getRenderedRowsCount:function(){return this.wot.wtViewport.rowsRenderCalculator.count},getVisibleRowsCount:function(){return this.wot.wtViewport.rowsVisibleCalculator.count}};Gn(o6,"MIXIN_NAME",Ste,{writable:!1,enumerable:!1});var a6=o6,Cte="calculatedColumns",s6={getFirstRenderedColumn:function(){var r=this.wot.wtViewport.columnsRenderCalculator.startColumn;return r===null?-1:r},getFirstVisibleColumn:function(){var r=this.wot.wtViewport.columnsVisibleCalculator.startColumn;return r===null?-1:r},getLastRenderedColumn:function(){var r=this.wot.wtViewport.columnsRenderCalculator.endColumn;return r===null?-1:r},getLastVisibleColumn:function(){var r=this.wot.wtViewport.columnsVisibleCalculator.endColumn;return r===null?-1:r},getRenderedColumnsCount:function(){return this.wot.wtViewport.columnsRenderCalculator.count},getVisibleColumnsCount:function(){return this.wot.wtViewport.columnsVisibleCalculator.count}};Gn(s6,"MIXIN_NAME",Cte,{writable:!1,enumerable:!1});var Y0=s6;function yd(t){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?yd=function(e){return typeof e}:yd=function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},yd(t)}function kte(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}function u6(t,r){for(var e=0;e<r.length;e++){var n=r[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function Ote(t,r,e){return r&&u6(t.prototype,r),e&&u6(t,e),t}function Rte(t,r){if(typeof r!="function"&&r!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(r&&r.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),r&&G0(t,r)}function G0(t,r){return G0=Object.setPrototypeOf||function(n,i){return n.__proto__=i,n},G0(t,r)}function Ete(t){var r=Ate();return function(){var n=md(t),i;if(r){var o=md(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return Tte(this,i)}}function Tte(t,r){if(r&&(yd(r)==="object"||typeof r=="function"))return r;if(r!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return xte(t)}function xte(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Ate(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function md(t){return md=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},md(t)}var K0=function(t){Rte(e,t);var r=Ete(e);function e(){return kte(this,e),r.apply(this,arguments)}return Ote(e,[{key:"alignOverlaysWithTrimmingContainer",value:function(){var i=Zs(this.wtRootElement),o=this.wot.rootWindow;if(i===o){var a=this.wot.getSetting("preventOverflow");a||(this.holder.style.overflow="visible",this.wtRootElement.style.overflow="visible")}else{var s=i.parentElement,l=Uh(i,"height",o),p=Uh(i,"overflow",o),d=this.holder.style,g=i.scrollWidth,y=i.scrollHeight,h=i.getBoundingClientRect(),u=h.width,f=h.height,c=["auto","hidden","scroll"];if(s&&c.includes(p)){var v=i.cloneNode(!1);v.style.overflow="auto",i.nextElementSibling?s.insertBefore(v,i.nextElementSibling):s.appendChild(v);var m=parseInt(Ea(v,o).height,10);s.removeChild(v),m===0&&(f=0)}f=Math.min(f,y),d.height=l==="auto"?"auto":"".concat(f,"px"),u=Math.min(u,g),d.width="".concat(u,"px"),d.overflow="",this.hasTableHeight=d.height==="auto"?!0:f>0,this.hasTableWidth=u>0}this.isTableVisible=Xs(this.TABLE)}},{key:"markOversizedColumnHeaders",value:function(){var i=this.wot,o=i.getOverlayName(),a=i.getSetting("columnHeaders"),s=a.length;if(s&&!i.wtViewport.hasOversizedColumnHeadersMarked[o]){for(var l=i.getSetting("rowHeaders"),p=l.length,d=this.getRenderedColumnsCount(),g=0;g<s;g++)for(var y=-1*p;y<d;y++)this.markIfOversizedColumnHeader(y);i.wtViewport.hasOversizedColumnHeadersMarked[o]=!0}}}]),e}(nu);Ut(K0,a6);Ut(K0,Y0);var Mte=K0,Pte="stickyRowsBottom",l6={getFirstRenderedRow:function(){var r=this.wot.getSetting("totalRows"),e=this.wot.getSetting("fixedRowsBottom"),n=r-e;return r===0||e===0?-1:n<0?0:n},getFirstVisibleRow:function(){return this.getFirstRenderedRow()},getLastRenderedRow:function(){return this.wot.getSetting("totalRows")-1},getLastVisibleRow:function(){return this.getLastRenderedRow()},getRenderedRowsCount:function(){var r=this.wot.getSetting("totalRows");return Math.min(this.wot.getSetting("fixedRowsBottom"),r)},getVisibleRowsCount:function(){return this.getRenderedRowsCount()}};Gn(l6,"MIXIN_NAME",Pte,{writable:!1,enumerable:!1});var f6=l6,Ite="stickyColumnsLeft",c6={getFirstRenderedColumn:function(){var r=this.wot.getSetting("totalColumns");return r===0?-1:0},getFirstVisibleColumn:function(){return this.getFirstRenderedColumn()},getLastRenderedColumn:function(){return this.getRenderedColumnsCount()-1},getLastVisibleColumn:function(){return this.getLastRenderedColumn()},getRenderedColumnsCount:function(){var r=this.wot.getSetting("totalColumns");return Math.min(this.wot.getSetting("fixedColumnsLeft"),r)},getVisibleColumnsCount:function(){return this.getRenderedColumnsCount()}};Gn(c6,"MIXIN_NAME",Ite,{writable:!1,enumerable:!1});var q0=c6;function vd(t){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?vd=function(e){return typeof e}:vd=function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},vd(t)}function Dte(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}function Nte(t,r){if(typeof r!="function"&&r!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(r&&r.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),r&&X0(t,r)}function X0(t,r){return X0=Object.setPrototypeOf||function(n,i){return n.__proto__=i,n},X0(t,r)}function $te(t){var r=Hte();return function(){var n=gd(t),i;if(r){var o=gd(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return jte(this,i)}}function jte(t,r){if(r&&(vd(r)==="object"||typeof r=="function"))return r;if(r!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Lte(t)}function Lte(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Hte(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function gd(t){return gd=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},gd(t)}var Z0=function(t){Nte(e,t);var r=$te(e);function e(){return Dte(this,e),r.apply(this,arguments)}return e}(nu);Ut(Z0,f6);Ut(Z0,q0);var Fte=Z0;function rr(t){t.isImmediatePropagationEnabled=!1,t.cancelBubble=!0}function Fn(t){return t.isImmediatePropagationEnabled===!1}function Do(t){return t.button===2}function bd(t){return t.button===0}var Bte=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",stopImmediatePropagation:rr,isImmediatePropagationStopped:Fn,isRightClick:Do,isLeftClick:bd});function Vte(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}function h6(t,r){for(var e=0;e<r.length;e++){var n=r[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function Wte(t,r,e){return r&&h6(t.prototype,r),e&&h6(t,e),t}var J0=0,Ute=function(){function t(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;Vte(this,t),this.context=r||this,this.context.eventListeners||(this.context.eventListeners=[])}return Wte(t,[{key:"addEventListener",value:function(e,n,i){var o=this,a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;function s(l){i.call(this,zte(l))}return typeof a!="boolean"&&!XE()&&(a=!1),this.context.eventListeners.push({element:e,event:n,callback:i,callbackProxy:s,options:a,eventManager:this}),e.addEventListener(n,s,a),J0+=1,function(){o.removeEventListener(e,n,i)}}},{key:"removeEventListener",value:function(e,n,i){for(var o=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,a=this.context.eventListeners.length,s;a;)if(a-=1,s=this.context.eventListeners[a],s.event===n&&s.element===e){if(i&&i!==s.callback||o&&s.eventManager!==this)continue;this.context.eventListeners.splice(a,1),s.element.removeEventListener(s.event,s.callbackProxy,s.options),J0-=1}}},{key:"clearEvents",value:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(!!this.context)for(var n=this.context.eventListeners.length;n;){n-=1;var i=this.context.eventListeners[n];i&&this.removeEventListener(i.element,i.event,i.callback,e)}}},{key:"clear",value:function(){this.clearEvents()}},{key:"destroy",value:function(){this.clearEvents(),this.context=null}},{key:"destroyWithOwnEventsOnly",value:function(){this.clearEvents(!0),this.context=null}},{key:"fireEvent",value:function(e,n){var i=e.document,o=e;i||(i=e.ownerDocument?e.ownerDocument:e,o=i.defaultView);var a={bubbles:!0,cancelable:n!=="mousemove",view:o,detail:0,screenX:0,screenY:0,clientX:1,clientY:1,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1,button:0,relatedTarget:void 0},s;i.createEvent?(s=i.createEvent("MouseEvents"),s.initMouseEvent(n,a.bubbles,a.cancelable,a.view,a.detail,a.screenX,a.screenY,a.clientX,a.clientY,a.ctrlKey,a.altKey,a.shiftKey,a.metaKey,a.button,i.body.parentNode)):s=i.createEventObject(),e.dispatchEvent?e.dispatchEvent(s):e.fireEvent("on".concat(n),s)}}]),t}();function zte(t){var r=t.stopImmediatePropagation;return t.stopImmediatePropagation=function(){r.apply(this),rr(this)},t}var Wt=Ute;function Yte(){return J0}function Gte(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}function d6(t,r){for(var e=0;e<r.length;e++){var n=r[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function Kte(t,r,e){return r&&d6(t.prototype,r),e&&d6(t,e),t}var bf=function(){function t(r){Gte(this,t),Gn(this,"wot",r,{writable:!1});var e=this.wot.wtTable,n=e.TABLE,i=e.hider,o=e.spreader,a=e.holder,s=e.wtRootElement;this.instance=this.wot,this.type="",this.mainTableScrollableElement=null,this.TABLE=n,this.hider=i,this.spreader=o,this.holder=a,this.wtRootElement=s,this.trimmingContainer=Zs(this.hider.parentNode.parentNode),this.updateStateOfRendering()}return Kte(t,[{key:"updateStateOfRendering",value:function(){var e=this.needFullRender;this.needFullRender=this.shouldBeRendered();var n=e!==this.needFullRender;return n&&!this.needFullRender&&this.reset(),n}},{key:"shouldBeRendered",value:function(){return!0}},{key:"updateTrimmingContainer",value:function(){this.trimmingContainer=Zs(this.hider.parentNode.parentNode)}},{key:"updateMainScrollableElement",value:function(){var e=this.wot,n=e.wtTable,i=e.rootWindow;i.getComputedStyle(n.wtRootElement.parentNode).getPropertyValue("overflow")==="hidden"?this.mainTableScrollableElement=this.wot.wtTable.holder:this.mainTableScrollableElement=lf(n.TABLE)}},{key:"getRelativeCellPosition",value:function(e,n,i){if(this.clone.wtTable.holder.contains(e)===!1){tr("The provided element is not a child of the ".concat(this.type," overlay"));return}var o=this.mainTableScrollableElement===this.wot.rootWindow,a=i<this.wot.getSetting("fixedColumnsLeft"),s=n<this.wot.getSetting("fixedRowsTop"),l=n>=this.wot.getSetting("totalRows")-this.wot.getSetting("fixedRowsBottom"),p={left:this.clone.wtTable.spreader.offsetLeft,top:this.clone.wtTable.spreader.offsetTop},d={left:e.offsetLeft,top:e.offsetTop},g=null;return o?g=this.getRelativeCellPositionWithinWindow(s,a,d,p):g=this.getRelativeCellPositionWithinHolder(s,l,a,d,p),g}},{key:"getRelativeCellPositionWithinWindow",value:function(e,n,i,o){var a=this.wot.wtTable.wtRootElement.getBoundingClientRect(),s=0,l=0;if(n?s=a.left<=0?-1*a.left:0:s=o.left,e){var p=this.clone.wtTable.TABLE.getBoundingClientRect();l=p.top-a.top}else l=o.top;return{left:i.left+s,top:i.top+l}}},{key:"getRelativeCellPositionWithinHolder",value:function(e,n,i,o,a){var s={horizontal:this.clone.cloneSource.wtOverlays.leftOverlay.getScrollPosition(),vertical:this.clone.cloneSource.wtOverlays.topOverlay.getScrollPosition()},l=0,p=0;if(i||(l=s.horizontal-a.left),n){var d=this.wot.wtTable.wtRootElement.getBoundingClientRect(),g=this.clone.wtTable.TABLE.getBoundingClientRect();p=g.top*-1+d.top}else e||(p=s.vertical-a.top);return{left:o.left-l,top:o.top-p}}},{key:"makeClone",value:function(e){if(r6.indexOf(e)===-1)throw new Error('Clone type "'.concat(e,'" is not supported.'));var n=this.wot,i=n.wtTable,o=n.rootDocument,a=n.rootWindow,s=o.createElement("DIV"),l=o.createElement("TABLE"),p=i.wtRootElement.parentNode;s.className="ht_clone_".concat(e," handsontable"),s.style.position="absolute",s.style.top=0,s.style.left=0,s.style.overflow="visible",l.className=i.TABLE.className,s.appendChild(l),this.type=e,p.appendChild(s);var d=this.wot.getSetting("preventOverflow");return d===!0||d==="horizontal"&&this.type===eu||d==="vertical"&&this.type===tu?this.mainTableScrollableElement=a:a.getComputedStyle(p).getPropertyValue("overflow")==="hidden"?this.mainTableScrollableElement=i.holder:this.mainTableScrollableElement=lf(i.TABLE),new this.wot.constructor({cloneSource:this.wot,cloneOverlay:this,table:l})}},{key:"refresh",value:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,n=this.shouldBeRendered();this.clone&&(this.needFullRender||n)&&this.clone.draw(e),this.needFullRender=n}},{key:"reset",value:function(){if(!!this.clone){var e=this.clone.wtTable.holder,n=this.clone.wtTable.hider,i=e.style,o=n.style,a=e.parentNode.style;he([i,o,a],function(s){s.width="",s.height=""})}}},{key:"destroy",value:function(){new Wt(this.clone).destroy()}}]),t}();function wd(t){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?wd=function(e){return typeof e}:wd=function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},wd(t)}function _d(t,r,e){return y6()?_d=Reflect.construct:_d=function(i,o,a){var s=[null];s.push.apply(s,o);var l=Function.bind.apply(i,s),p=new l;return a&&Sd(p,a.prototype),p},_d.apply(null,arguments)}function qte(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}function p6(t,r){for(var e=0;e<r.length;e++){var n=r[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function Xte(t,r,e){return r&&p6(t.prototype,r),e&&p6(t,e),t}function Zte(t,r){if(typeof r!="function"&&r!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(r&&r.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),r&&Sd(t,r)}function Sd(t,r){return Sd=Object.setPrototypeOf||function(n,i){return n.__proto__=i,n},Sd(t,r)}function Jte(t){var r=y6();return function(){var n=Cd(t),i;if(r){var o=Cd(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return Qte(this,i)}}function Qte(t,r){if(r&&(wd(r)==="object"||typeof r=="function"))return r;if(r!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return ere(t)}function ere(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function y6(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Cd(t){return Cd=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},Cd(t)}var tre=function(t){Zte(e,t);var r=Jte(e);function e(n){var i;return qte(this,e),i=r.call(this,n),i.clone=i.makeClone(Io),i}return Xte(e,[{key:"createTable",value:function(){for(var i=arguments.length,o=new Array(i),a=0;a<i;a++)o[a]=arguments[a];return _d(Fte,o)}},{key:"shouldBeRendered",value:function(){var i=this.wot;return i.getSetting("shouldRenderBottomOverlay")&&i.getSetting("shouldRenderLeftOverlay")}},{key:"resetFixedPosition",value:function(){var i=this.wot;if(this.updateTrimmingContainer(),!!i.wtTable.holder.parentNode){var o=this.clone.wtTable.holder.parentNode;if(o.style.top="",this.trimmingContainer===i.rootWindow){var a=this.wot,s=a.rootDocument,l=a.wtTable,p=l.hider.getBoundingClientRect(),d=Math.ceil(p.bottom),g=Math.ceil(p.left),y=s.documentElement.clientHeight,h,u;g<0?h=-g:h=0,d>y?u=d-y:u=0,u+="px",h+="px",o.style.left=h,o.style.bottom=u}else Ta(o),this.repositionOverlay();var f=yr(this.clone.wtTable.TABLE),c=sr(this.clone.wtTable.TABLE);return this.wot.wtTable.hasDefinedSize()||(f=0),o.style.height="".concat(f,"px"),o.style.width="".concat(c,"px"),!1}}},{key:"repositionOverlay",value:function(){var i=this.wot,o=i.wtTable,a=i.rootDocument,s=this.clone.wtTable.holder.parentNode,l=Pr(a);o.holder.clientHeight===o.holder.offsetHeight&&(l=0),s.style.bottom="".concat(l,"px")}}],[{key:"OVERLAY_NAME",get:function(){return Io}}]),e}(bf);function kd(t){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?kd=function(e){return typeof e}:kd=function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},kd(t)}function rre(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}function nre(t,r){if(typeof r!="function"&&r!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(r&&r.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),r&&Q0(t,r)}function Q0(t,r){return Q0=Object.setPrototypeOf||function(n,i){return n.__proto__=i,n},Q0(t,r)}function ire(t){var r=sre();return function(){var n=Od(t),i;if(r){var o=Od(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return ore(this,i)}}function ore(t,r){if(r&&(kd(r)==="object"||typeof r=="function"))return r;if(r!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return are(t)}function are(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function sre(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Od(t){return Od=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},Od(t)}var ew=function(t){nre(e,t);var r=ire(e);function e(){return rre(this,e),r.apply(this,arguments)}return e}(nu);Ut(ew,f6);Ut(ew,Y0);var ure=ew;function Rd(t){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?Rd=function(e){return typeof e}:Rd=function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Rd(t)}function Ed(t,r,e){return g6()?Ed=Reflect.construct:Ed=function(i,o,a){var s=[null];s.push.apply(s,o);var l=Function.bind.apply(i,s),p=new l;return a&&Td(p,a.prototype),p},Ed.apply(null,arguments)}function lre(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}function m6(t,r){for(var e=0;e<r.length;e++){var n=r[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function fre(t,r,e){return r&&m6(t.prototype,r),e&&m6(t,e),t}function cre(t,r){if(typeof r!="function"&&r!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(r&&r.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),r&&Td(t,r)}function Td(t,r){return Td=Object.setPrototypeOf||function(n,i){return n.__proto__=i,n},Td(t,r)}function hre(t){var r=g6();return function(){var n=xd(t),i;if(r){var o=xd(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return dre(this,i)}}function dre(t,r){if(r&&(Rd(r)==="object"||typeof r=="function"))return r;if(r!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return v6(t)}function v6(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function g6(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function xd(t){return xd=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},xd(t)}function pre(t,r,e){return r in t?Object.defineProperty(t,r,{value:e,enumerable:!0,configurable:!0,writable:!0}):t[r]=e,t}var yre=function(t){cre(e,t);var r=hre(e);function e(n){var i;return lre(this,e),i=r.call(this,n),pre(v6(i),"cachedFixedRowsBottom",-1),i.clone=i.makeClone(ti),i.cachedFixedRowsBottom=i.wot.getSetting("fixedRowsBottom"),i}return fre(e,[{key:"createTable",value:function(){for(var i=arguments.length,o=new Array(i),a=0;a<i;a++)o[a]=arguments[a];return Ed(ure,o)}},{key:"shouldBeRendered",value:function(){return this.wot.getSetting("shouldRenderBottomOverlay")}},{key:"resetFixedPosition",value:function(){if(!(!this.needFullRender||!this.wot.wtTable.holder.parentNode)){var i=this.clone.wtTable.holder.parentNode;i.style.top="";var o=0,a=this.wot.getSetting("preventOverflow");if(this.trimmingContainer===this.wot.rootWindow&&(!a||a!=="vertical")){var s=this.wot,l=s.rootDocument,p=s.wtTable,d=p.hider.getBoundingClientRect(),g=Math.ceil(d.bottom),y=l.documentElement.clientHeight,h,u;h=p.hider.style.left,h=h===""?0:h,g>y?u=g-y:u=0,o=u,u+="px",i.style.left=h,i.style.bottom=u}else o=this.getScrollPosition(),this.repositionOverlay();var f=this.adjustHeaderBordersPosition(o);return this.adjustElementsSize(),f}}},{key:"repositionOverlay",value:function(){var i=this.wot,o=i.wtTable,a=i.rootDocument,s=this.clone.wtTable.holder.parentNode,l=Pr(a);o.holder.clientHeight===o.holder.offsetHeight&&(l=0),s.style.bottom="".concat(l,"px")}},{key:"setScrollPosition",value:function(i){var o=this.wot.rootWindow,a=!1;return this.mainTableScrollableElement===o?(o.scrollTo(Po(o),i),a=!0):this.mainTableScrollableElement.scrollTop!==i&&(this.mainTableScrollableElement.scrollTop=i,a=!0),a}},{key:"onScroll",value:function(){this.wot.getSetting("onScrollHorizontally")}},{key:"sumCellSizes",value:function(i,o){for(var a=this.wot,s=a.wtTable,l=a.wtSettings,p=l.settings.defaultRowHeight,d=i,g=0;d<o;){var y=s.getRowHeight(d);g+=y===void 0?p:y,d+=1}return g}},{key:"adjustElementsSize",value:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this.updateTrimmingContainer(),(this.needFullRender||i)&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}},{key:"adjustRootElementSize",value:function(){var i=this.wot,o=i.wtTable,a=i.wtViewport,s=i.rootWindow,l=Pr(this.wot.rootDocument),p=this.clone.wtTable.holder.parentNode,d=p.style,g=this.wot.getSetting("preventOverflow");if(this.trimmingContainer!==s||g==="horizontal"){var y=a.getWorkspaceWidth();this.wot.wtOverlays.hasScrollbarRight&&(y-=l),y=Math.min(y,o.wtRootElement.scrollWidth),d.width="".concat(y,"px")}else d.width="";this.clone.wtTable.holder.style.width=d.width;var h=yr(this.clone.wtTable.TABLE);this.wot.wtTable.hasDefinedSize()||(h=0),d.height="".concat(h,"px")}},{key:"adjustRootChildrenSize",value:function(){var i=this.clone.wtTable.holder;this.clone.wtTable.hider.style.width=this.hider.style.width,i.style.width=i.parentNode.style.width,i.style.height=i.parentNode.style.height}},{key:"applyToDOM",value:function(){var i=this.wot.getSetting("totalRows");if(typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number")this.spreader.style.top="".concat(this.wot.wtViewport.rowsRenderCalculator.startPosition,"px");else if(i===0)this.spreader.style.top="0";else throw new Error("Incorrect value of the rowsRenderCalculator");this.spreader.style.bottom="",this.needFullRender&&this.syncOverlayOffset()}},{key:"syncOverlayOffset",value:function(){typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number"?this.clone.wtTable.spreader.style.left="".concat(this.wot.wtViewport.columnsRenderCalculator.startPosition,"px"):this.clone.wtTable.spreader.style.left=""}},{key:"scrollTo",value:function(i,o){var a=this.getTableParentOffset(),s=this.wot.cloneSource?this.wot.cloneSource:this.wot,l=s.wtTable.holder,p=0;o&&l.offsetHeight!==l.clientHeight&&(p=Pr(this.wot.rootDocument)),o?(a+=this.sumCellSizes(0,i+1),a-=this.wot.wtViewport.getViewportHeight(),a+=1):a+=this.sumCellSizes(this.wot.getSetting("fixedRowsBottom"),i),a+=p,this.setScrollPosition(a)}},{key:"getTableParentOffset",value:function(){return this.mainTableScrollableElement===this.wot.rootWindow?this.wot.wtTable.holderOffset.top:0}},{key:"getScrollPosition",value:function(){return uf(this.mainTableScrollableElement,this.wot.rootWindow)}},{key:"adjustHeaderBordersPosition",value:function(i){var o=this.wot.getSetting("fixedRowsBottom"),a=this.cachedFixedRowsBottom!==o,s=this.wot.getSetting("columnHeaders"),l=!1;if((a||o===0)&&s.length>0){var p=this.wot.wtTable.holder.parentNode,d=lt(p,"innerBorderBottom");this.cachedFixedRowsBottom=this.wot.getSetting("fixedRowsBottom"),i||this.wot.getSetting("totalRows")===0?(Ie(p,"innerBorderBottom"),l=!d):(dt(p,"innerBorderBottom"),l=d)}return l}}],[{key:"OVERLAY_NAME",get:function(){return ti}}]),e}(bf);function Ad(t){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?Ad=function(e){return typeof e}:Ad=function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ad(t)}function mre(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}function vre(t,r){if(typeof r!="function"&&r!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(r&&r.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),r&&tw(t,r)}function tw(t,r){return tw=Object.setPrototypeOf||function(n,i){return n.__proto__=i,n},tw(t,r)}function gre(t){var r=_re();return function(){var n=Md(t),i;if(r){var o=Md(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return bre(this,i)}}function bre(t,r){if(r&&(Ad(r)==="object"||typeof r=="function"))return r;if(r!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return wre(t)}function wre(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function _re(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Md(t){return Md=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},Md(t)}var rw=function(t){vre(e,t);var r=gre(e);function e(){return mre(this,e),r.apply(this,arguments)}return e}(nu);Ut(rw,a6);Ut(rw,q0);var Sre=rw;function Pd(t){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?Pd=function(e){return typeof e}:Pd=function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Pd(t)}function Id(t,r,e){return w6()?Id=Reflect.construct:Id=function(i,o,a){var s=[null];s.push.apply(s,o);var l=Function.bind.apply(i,s),p=new l;return a&&Dd(p,a.prototype),p},Id.apply(null,arguments)}function Cre(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}function b6(t,r){for(var e=0;e<r.length;e++){var n=r[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function kre(t,r,e){return r&&b6(t.prototype,r),e&&b6(t,e),t}function Ore(t,r){if(typeof r!="function"&&r!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(r&&r.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),r&&Dd(t,r)}function Dd(t,r){return Dd=Object.setPrototypeOf||function(n,i){return n.__proto__=i,n},Dd(t,r)}function Rre(t){var r=w6();return function(){var n=Nd(t),i;if(r){var o=Nd(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return Ere(this,i)}}function Ere(t,r){if(r&&(Pd(r)==="object"||typeof r=="function"))return r;if(r!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Tre(t)}function Tre(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function w6(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Nd(t){return Nd=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},Nd(t)}var xre=function(t){Ore(e,t);var r=Rre(e);function e(n){var i;return Cre(this,e),i=r.call(this,n),i.clone=i.makeClone(tu),i}return kre(e,[{key:"createTable",value:function(){for(var i=arguments.length,o=new Array(i),a=0;a<i;a++)o[a]=arguments[a];return Id(Sre,o)}},{key:"shouldBeRendered",value:function(){return this.wot.getSetting("shouldRenderLeftOverlay")}},{key:"resetFixedPosition",value:function(){var i=this.wot.wtTable;if(!(!this.needFullRender||!i.holder.parentNode)){var o=this.clone.wtTable.holder.parentNode,a=0,s=this.wot.getSetting("preventOverflow");if(this.trimmingContainer===this.wot.rootWindow&&(!s||s!=="horizontal")){var l=i.hider.getBoundingClientRect(),p=Math.ceil(l.left),d=Math.ceil(l.right),g,y;y=i.hider.style.top,y=y===""?0:y,p<0&&d-o.offsetWidth>0?g=-p:g=0,a=g,g+="px",zh(o,g,y)}else a=this.getScrollPosition(),Ta(o);var h=this.adjustHeaderBordersPosition(a);return this.adjustElementsSize(),h}}},{key:"setScrollPosition",value:function(i){var o=this.wot.rootWindow,a=!1;return this.mainTableScrollableElement===o&&o.scrollX!==i?(o.scrollTo(i,Ra(o)),a=!0):this.mainTableScrollableElement.scrollLeft!==i&&(this.mainTableScrollableElement.scrollLeft=i,a=!0),a}},{key:"onScroll",value:function(){this.wot.getSetting("onScrollVertically")}},{key:"sumCellSizes",value:function(i,o){for(var a=this.wot.wtSettings.defaultColumnWidth,s=i,l=0;s<o;)l+=this.wot.wtTable.getStretchedColumnWidth(s)||a,s+=1;return l}},{key:"adjustElementsSize",value:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this.updateTrimmingContainer(),(this.needFullRender||i)&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}},{key:"adjustRootElementSize",value:function(){var i=this.wot,o=i.wtTable,a=i.rootDocument,s=i.rootWindow,l=Pr(a),p=this.clone.wtTable.holder.parentNode,d=p.style,g=this.wot.getSetting("preventOverflow");if(this.trimmingContainer!==s||g==="vertical"){var y=this.wot.wtViewport.getWorkspaceHeight();this.wot.wtOverlays.hasScrollbarBottom&&(y-=l),y=Math.min(y,o.wtRootElement.scrollHeight),d.height="".concat(y,"px")}else d.height="";this.clone.wtTable.holder.style.height=d.height;var h=sr(this.clone.wtTable.TABLE);d.width="".concat(h,"px")}},{key:"adjustRootChildrenSize",value:function(){var i,o=this.clone.wtTable.holder,a=this.wot.selections,s=Math.abs((i=a==null?void 0:a.getCell().getBorder(this.wot).cornerCenterPointOffset)!==null&&i!==void 0?i:0);this.clone.wtTable.hider.style.height=this.hider.style.height,o.style.height=o.parentNode.style.height,o.style.width="".concat(parseInt(o.parentNode.style.width,10)+s,"px")}},{key:"applyToDOM",value:function(){var i=this.wot.getSetting("totalColumns");if(typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number")this.spreader.style.left="".concat(this.wot.wtViewport.columnsRenderCalculator.startPosition,"px");else if(i===0)this.spreader.style.left="0";else throw new Error("Incorrect value of the columnsRenderCalculator");this.spreader.style.right="",this.needFullRender&&this.syncOverlayOffset()}},{key:"syncOverlayOffset",value:function(){typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number"?this.clone.wtTable.spreader.style.top="".concat(this.wot.wtViewport.rowsRenderCalculator.startPosition,"px"):this.clone.wtTable.spreader.style.top=""}},{key:"scrollTo",value:function(i,o){var a=this.getTableParentOffset(),s=this.wot.cloneSource?this.wot.cloneSource:this.wot,l=s.wtTable.holder,p=0;return o&&l.offsetWidth!==l.clientWidth&&(p=Pr(this.wot.rootDocument)),o?(a+=this.sumCellSizes(0,i+1),a-=this.wot.wtViewport.getViewportWidth()):a+=this.sumCellSizes(this.wot.getSetting("fixedColumnsLeft"),i),a+=p,this.setScrollPosition(a)}},{key:"getTableParentOffset",value:function(){var i=this.wot.getSetting("preventOverflow"),o=0;return!i&&this.trimmingContainer===this.wot.rootWindow&&(o=this.wot.wtTable.holderOffset.left),o}},{key:"getScrollPosition",value:function(){return Wh(this.mainTableScrollableElement,this.wot.rootWindow)}},{key:"adjustHeaderBordersPosition",value:function(i){var o=this.wot.wtTable.holder.parentNode,a=this.wot.getSetting("rowHeaders"),s=this.wot.getSetting("fixedColumnsLeft"),l=this.wot.getSetting("totalRows");l?dt(o,"emptyRows"):Ie(o,"emptyRows");var p=!1;if(s&&!a.length)Ie(o,"innerBorderLeft");else if(!s&&a.length){var d=lt(o,"innerBorderLeft");i?(Ie(o,"innerBorderLeft"),p=!d):(dt(o,"innerBorderLeft"),p=d)}return p}}],[{key:"OVERLAY_NAME",get:function(){return tu}}]),e}(bf),Are="stickyRowsTop",_6={getFirstRenderedRow:function(){var r=this.wot.getSetting("totalRows");return r===0?-1:0},getFirstVisibleRow:function(){return this.getFirstRenderedRow()},getLastRenderedRow:function(){return this.getRenderedRowsCount()-1},getLastVisibleRow:function(){return this.getLastRenderedRow()},getRenderedRowsCount:function(){var r=this.wot.getSetting("totalRows");return Math.min(this.wot.getSetting("fixedRowsTop"),r)},getVisibleRowsCount:function(){return this.getRenderedRowsCount()}};Gn(_6,"MIXIN_NAME",Are,{writable:!1,enumerable:!1});var S6=_6;function $d(t){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?$d=function(e){return typeof e}:$d=function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},$d(t)}function Mre(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}function Pre(t,r){if(typeof r!="function"&&r!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(r&&r.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),r&&nw(t,r)}function nw(t,r){return nw=Object.setPrototypeOf||function(n,i){return n.__proto__=i,n},nw(t,r)}function Ire(t){var r=$re();return function(){var n=jd(t),i;if(r){var o=jd(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return Dre(this,i)}}function Dre(t,r){if(r&&($d(r)==="object"||typeof r=="function"))return r;if(r!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Nre(t)}function Nre(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function $re(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function jd(t){return jd=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},jd(t)}var iw=function(t){Pre(e,t);var r=Ire(e);function e(){return Mre(this,e),r.apply(this,arguments)}return e}(nu);Ut(iw,S6);Ut(iw,q0);var jre=iw;function Ld(t){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?Ld=function(e){return typeof e}:Ld=function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ld(t)}function Hd(t,r,e){return k6()?Hd=Reflect.construct:Hd=function(i,o,a){var s=[null];s.push.apply(s,o);var l=Function.bind.apply(i,s),p=new l;return a&&Fd(p,a.prototype),p},Hd.apply(null,arguments)}function Lre(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}function C6(t,r){for(var e=0;e<r.length;e++){var n=r[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function Hre(t,r,e){return r&&C6(t.prototype,r),e&&C6(t,e),t}function Fre(t,r){if(typeof r!="function"&&r!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(r&&r.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),r&&Fd(t,r)}function Fd(t,r){return Fd=Object.setPrototypeOf||function(n,i){return n.__proto__=i,n},Fd(t,r)}function Bre(t){var r=k6();return function(){var n=Bd(t),i;if(r){var o=Bd(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return Vre(this,i)}}function Vre(t,r){if(r&&(Ld(r)==="object"||typeof r=="function"))return r;if(r!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Wre(t)}function Wre(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function k6(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Bd(t){return Bd=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},Bd(t)}var Ure=function(t){Fre(e,t);var r=Bre(e);function e(n){var i;return Lre(this,e),i=r.call(this,n),i.clone=i.makeClone(ru),i}return Hre(e,[{key:"createTable",value:function(){for(var i=arguments.length,o=new Array(i),a=0;a<i;a++)o[a]=arguments[a];return Hd(jre,o)}},{key:"shouldBeRendered",value:function(){var i=this.wot;return i.getSetting("shouldRenderTopOverlay")&&i.getSetting("shouldRenderLeftOverlay")}},{key:"resetFixedPosition",value:function(){if(this.updateTrimmingContainer(),!!this.wot.wtTable.holder.parentNode){var i=this.clone.wtTable.holder.parentNode,o=this.wot.getSetting("preventOverflow");if(this.trimmingContainer===this.wot.rootWindow){var a=this.wot.wtTable,s=a.hider.getBoundingClientRect(),l=Math.ceil(s.top),p=Math.ceil(s.left),d=Math.ceil(s.bottom),g=Math.ceil(s.right),y="0",h="0";(!o||o==="vertical")&&p<0&&g-i.offsetWidth>0&&(y="".concat(-p,"px")),(!o||o==="horizontal")&&l<0&&d-i.offsetHeight>0&&(h="".concat(-l,"px")),zh(i,y,h)}else Ta(i);var u=yr(this.clone.wtTable.TABLE),f=sr(this.clone.wtTable.TABLE);return this.wot.wtTable.hasDefinedSize()||(u=0),i.style.height="".concat(u,"px"),i.style.width="".concat(f,"px"),!1}}}],[{key:"OVERLAY_NAME",get:function(){return ru}}]),e}(bf);function Vd(t){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?Vd=function(e){return typeof e}:Vd=function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Vd(t)}function zre(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}function Yre(t,r){if(typeof r!="function"&&r!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(r&&r.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),r&&ow(t,r)}function ow(t,r){return ow=Object.setPrototypeOf||function(n,i){return n.__proto__=i,n},ow(t,r)}function Gre(t){var r=Xre();return function(){var n=Wd(t),i;if(r){var o=Wd(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return Kre(this,i)}}function Kre(t,r){if(r&&(Vd(r)==="object"||typeof r=="function"))return r;if(r!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return qre(t)}function qre(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Xre(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Wd(t){return Wd=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},Wd(t)}var aw=function(t){Yre(e,t);var r=Gre(e);function e(){return zre(this,e),r.apply(this,arguments)}return e}(nu);Ut(aw,S6);Ut(aw,Y0);var Zre=aw;function Ud(t){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?Ud=function(e){return typeof e}:Ud=function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ud(t)}function zd(t,r,e){return E6()?zd=Reflect.construct:zd=function(i,o,a){var s=[null];s.push.apply(s,o);var l=Function.bind.apply(i,s),p=new l;return a&&Yd(p,a.prototype),p},zd.apply(null,arguments)}function Jre(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}function O6(t,r){for(var e=0;e<r.length;e++){var n=r[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function Qre(t,r,e){return r&&O6(t.prototype,r),e&&O6(t,e),t}function ene(t,r){if(typeof r!="function"&&r!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(r&&r.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),r&&Yd(t,r)}function Yd(t,r){return Yd=Object.setPrototypeOf||function(n,i){return n.__proto__=i,n},Yd(t,r)}function tne(t){var r=E6();return function(){var n=Gd(t),i;if(r){var o=Gd(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return rne(this,i)}}function rne(t,r){if(r&&(Ud(r)==="object"||typeof r=="function"))return r;if(r!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return R6(t)}function R6(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function E6(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Gd(t){return Gd=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},Gd(t)}function nne(t,r,e){return r in t?Object.defineProperty(t,r,{value:e,enumerable:!0,configurable:!0,writable:!0}):t[r]=e,t}var ine=function(t){ene(e,t);var r=tne(e);function e(n){var i;return Jre(this,e),i=r.call(this,n),nne(R6(i),"cachedFixedRowsTop",-1),i.clone=i.makeClone(eu),i.cachedFixedRowsTop=i.wot.getSetting("fixedRowsTop"),i}return Qre(e,[{key:"createTable",value:function(){for(var i=arguments.length,o=new Array(i),a=0;a<i;a++)o[a]=arguments[a];return zd(Zre,o)}},{key:"shouldBeRendered",value:function(){return this.wot.getSetting("shouldRenderTopOverlay")}},{key:"resetFixedPosition",value:function(){if(!(!this.needFullRender||!this.wot.wtTable.holder.parentNode)){var i=this.clone.wtTable.holder.parentNode,o=this.wot.getSetting("preventOverflow"),a=0,s=!1;if(this.trimmingContainer===this.wot.rootWindow&&(!o||o!=="vertical")){var l=this.wot.wtTable,p=l.hider.getBoundingClientRect(),d=Math.ceil(p.top),g=Math.ceil(p.bottom),y=i.offsetHeight;s=g===y;var h,u;h=l.hider.style.left,h=h===""?0:h,d<0&&g-y>0?u=-d:u=0,a=u,u+="px",zh(i,h,u)}else a=this.getScrollPosition(),Ta(i);var f=this.adjustHeaderBordersPosition(a,s);return this.adjustElementsSize(),f}}},{key:"setScrollPosition",value:function(i){var o=this.wot.rootWindow,a=!1;return this.mainTableScrollableElement===o&&o.scrollY!==i?(o.scrollTo(Po(o),i),a=!0):this.mainTableScrollableElement.scrollTop!==i&&(this.mainTableScrollableElement.scrollTop=i,a=!0),a}},{key:"onScroll",value:function(){this.wot.getSetting("onScrollHorizontally")}},{key:"sumCellSizes",value:function(i,o){for(var a=this.wot.wtSettings.settings.defaultRowHeight,s=i,l=0;s<o;){var p=this.wot.wtTable.getRowHeight(s);l+=p===void 0?a:p,s+=1}return l}},{key:"adjustElementsSize",value:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this.updateTrimmingContainer(),(this.needFullRender||i)&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}},{key:"adjustRootElementSize",value:function(){var i=this.wot,o=i.wtTable,a=i.rootDocument,s=i.rootWindow,l=Pr(a),p=this.clone.wtTable.holder.parentNode,d=p.style,g=this.wot.getSetting("preventOverflow");if(this.trimmingContainer!==s||g==="horizontal"){var y=this.wot.wtViewport.getWorkspaceWidth();this.wot.wtOverlays.hasScrollbarRight&&(y-=l),y=Math.min(y,o.wtRootElement.scrollWidth),d.width="".concat(y,"px")}else d.width="";this.clone.wtTable.holder.style.width=d.width;var h=yr(this.clone.wtTable.TABLE);this.wot.wtTable.hasDefinedSize()||(h=0),d.height="".concat(h,"px")}},{key:"adjustRootChildrenSize",value:function(){var i,o=this.clone.wtTable.holder,a=this.wot.selections,s=Math.abs((i=a==null?void 0:a.getCell().getBorder(this.wot).cornerCenterPointOffset)!==null&&i!==void 0?i:0);this.clone.wtTable.hider.style.width=this.hider.style.width,o.style.width=o.parentNode.style.width,o.style.height="".concat(parseInt(o.parentNode.style.height,10)+s,"px")}},{key:"applyToDOM",value:function(){var i=this.wot.getSetting("totalRows");if(typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number")this.spreader.style.top="".concat(this.wot.wtViewport.rowsRenderCalculator.startPosition,"px");else if(i===0)this.spreader.style.top="0";else throw new Error("Incorrect value of the rowsRenderCalculator");this.spreader.style.bottom="",this.needFullRender&&this.syncOverlayOffset()}},{key:"syncOverlayOffset",value:function(){typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number"?this.clone.wtTable.spreader.style.left="".concat(this.wot.wtViewport.columnsRenderCalculator.startPosition,"px"):this.clone.wtTable.spreader.style.left=""}},{key:"scrollTo",value:function(i,o){var a=this.wot,s=a.cloneSource?a.cloneSource:a,l=s.wtTable.holder,p=this.getTableParentOffset(),d=0;if(o&&l.offsetHeight!==l.clientHeight&&(d=Pr(a.rootDocument)),o){var g=a.getSetting("fixedRowsBottom"),y=a.getSetting("totalRows");p+=this.sumCellSizes(0,i+1),p-=a.wtViewport.getViewportHeight()-this.sumCellSizes(y-g,y),p+=1}else p+=this.sumCellSizes(a.getSetting("fixedRowsTop"),i);return p+=d,this.setScrollPosition(p)}},{key:"getTableParentOffset",value:function(){return this.mainTableScrollableElement===this.wot.rootWindow?this.wot.wtTable.holderOffset.top:0}},{key:"getScrollPosition",value:function(){return uf(this.mainTableScrollableElement,this.wot.rootWindow)}},{key:"adjustHeaderBordersPosition",value:function(i){var o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,a=this.wot.wtTable.holder.parentNode,s=this.wot.getSetting("totalColumns");s?dt(a,"emptyColumns"):Ie(a,"emptyColumns");var l=!1;if(!o){var p=this.wot.getSetting("fixedRowsTop"),d=this.cachedFixedRowsTop!==p,g=this.wot.getSetting("columnHeaders");if((d||p===0)&&g.length>0){var y=lt(a,"innerBorderTop");this.cachedFixedRowsTop=this.wot.getSetting("fixedRowsTop"),i||this.wot.getSetting("totalRows")===0?(Ie(a,"innerBorderTop"),l=!y):(dt(a,"innerBorderTop"),l=y)}}if(this.wot.getSetting("rowHeaders").length===0){var h=this.clone.wtTable.THEAD.querySelectorAll("th:nth-of-type(2)");if(h)for(var u=0;u<h.length;u++)h[u].style["border-left-width"]=0}return l}}],[{key:"OVERLAY_NAME",get:function(){return eu}}]),e}(bf);function sw(t,r){return une(t)||sne(t,r)||ane(t,r)||one()}function one(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function ane(t,r){if(!!t){if(typeof t=="string")return T6(t,r);var e=Object.prototype.toString.call(t).slice(8,-1);if(e==="Object"&&t.constructor&&(e=t.constructor.name),e==="Map"||e==="Set")return Array.from(t);if(e==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return T6(t,r)}}function T6(t,r){(r==null||r>t.length)&&(r=t.length);for(var e=0,n=new Array(r);e<r;e++)n[e]=t[e];return n}function sne(t,r){var e=t==null?null:typeof Symbol!="undefined"&&t[Symbol.iterator]||t["@@iterator"];if(e!=null){var n=[],i=!0,o=!1,a,s;try{for(e=e.call(t);!(i=(a=e.next()).done)&&(n.push(a.value),!(r&&n.length===r));i=!0);}catch(l){o=!0,s=l}finally{try{!i&&e.return!=null&&e.return()}finally{if(o)throw s}}return n}}function une(t){if(Array.isArray(t))return t}function lne(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}function x6(t,r){for(var e=0;e<r.length;e++){var n=r[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function fne(t,r,e){return r&&x6(t.prototype,r),e&&x6(t,e),t}var cne=function(){function t(r,e){lne(this,t),!!e&&(this.eventManager=new Wt(r),this.instance=r,this.wot=r,this.settings=e,this.mouseDown=!1,this.main=null,this.top=null,this.left=null,this.bottom=null,this.right=null,this.topStyle=null,this.leftStyle=null,this.bottomStyle=null,this.rightStyle=null,this.cornerDefaultStyle={width:"6px",height:"6px",borderWidth:"1px",borderStyle:"solid",borderColor:"#FFF"},this.cornerCenterPointOffset=-(parseInt(this.cornerDefaultStyle.width,10)/2),this.corner=null,this.cornerStyle=null,this.createBorders(e),this.registerListeners())}return fne(t,[{key:"registerListeners",value:function(){var e=this,n=this.wot.rootDocument.body;this.eventManager.addEventListener(n,"mousedown",function(){return e.onMouseDown()}),this.eventManager.addEventListener(n,"mouseup",function(){return e.onMouseUp()});for(var i=function(l,p){var d=e.main.childNodes[l];e.eventManager.addEventListener(d,"mouseenter",function(g){return e.onMouseEnter(g,e.main.childNodes[l])})},o=0,a=this.main.childNodes.length;o<a;o++)i(o)}},{key:"onMouseDown",value:function(){this.mouseDown=!0}},{key:"onMouseUp",value:function(){this.mouseDown=!1}},{key:"onMouseEnter",value:function(e,n){if(!this.mouseDown||!this.wot.getSetting("hideBorderOnMouseDownOver"))return;e.preventDefault(),rr(e);var i=this,o=this.wot.rootDocument.body,a=n.getBoundingClientRect();n.style.display="none";function s(p){if(p.clientY<Math.floor(a.top)||p.clientY>Math.ceil(a.top+a.height)||p.clientX<Math.floor(a.left)||p.clientX>Math.ceil(a.left+a.width))return!0}function l(p){s(p)&&(i.eventManager.removeEventListener(o,"mousemove",l),n.style.display="block")}this.eventManager.addEventListener(o,"mousemove",l)}},{key:"createBorders",value:function(e){var n=this.wot.rootDocument;this.main=n.createElement("div");var i=["top","left","bottom","right","corner"],o=this.main.style;o.position="absolute",o.top=0,o.left=0;for(var a=0;a<5;a++){var s=i[a],l=n.createElement("div");l.className="wtBorder ".concat(this.settings.className||""),this.settings[s]&&this.settings[s].hide&&(l.className+=" hidden"),o=l.style,o.backgroundColor=this.settings[s]&&this.settings[s].color?this.settings[s].color:e.border.color,o.height=this.settings[s]&&this.settings[s].width?"".concat(this.settings[s].width,"px"):"".concat(e.border.width,"px"),o.width=this.settings[s]&&this.settings[s].width?"".concat(this.settings[s].width,"px"):"".concat(e.border.width,"px"),this.main.appendChild(l)}this.top=this.main.childNodes[0],this.left=this.main.childNodes[1],this.bottom=this.main.childNodes[2],this.right=this.main.childNodes[3],this.topStyle=this.top.style,this.leftStyle=this.left.style,this.bottomStyle=this.bottom.style,this.rightStyle=this.right.style,this.corner=this.main.childNodes[4],this.corner.className+=" corner",this.cornerStyle=this.corner.style,this.cornerStyle.width=this.cornerDefaultStyle.width,this.cornerStyle.height=this.cornerDefaultStyle.height,this.cornerStyle.border=[this.cornerDefaultStyle.borderWidth,this.cornerDefaultStyle.borderStyle,this.cornerDefaultStyle.borderColor].join(" "),In()&&this.createMultipleSelectorHandles(),this.disappear();var p=this.wot.wtTable,d=p.bordersHolder;d||(d=n.createElement("div"),d.className="htBorders",p.bordersHolder=d,p.spreader.appendChild(d)),d.appendChild(this.main)}},{key:"createMultipleSelectorHandles",value:function(){var e=this,n=this.wot.rootDocument;this.selectionHandles={topLeft:n.createElement("DIV"),topLeftHitArea:n.createElement("DIV"),bottomRight:n.createElement("DIV"),bottomRightHitArea:n.createElement("DIV")};var i=10,o=40;this.selectionHandles.topLeft.className="topLeftSelectionHandle",this.selectionHandles.topLeftHitArea.className="topLeftSelectionHandle-HitArea",this.selectionHandles.bottomRight.className="bottomRightSelectionHandle",this.selectionHandles.bottomRightHitArea.className="bottomRightSelectionHandle-HitArea",this.selectionHandles.styles={topLeft:this.selectionHandles.topLeft.style,topLeftHitArea:this.selectionHandles.topLeftHitArea.style,bottomRight:this.selectionHandles.bottomRight.style,bottomRightHitArea:this.selectionHandles.bottomRightHitArea.style};var a={position:"absolute",height:"".concat(o,"px"),width:"".concat(o,"px"),"border-radius":"".concat(parseInt(o/1.5,10),"px")};Ot(a,function(l,p){e.selectionHandles.styles.bottomRightHitArea[p]=l,e.selectionHandles.styles.topLeftHitArea[p]=l});var s={position:"absolute",height:"".concat(i,"px"),width:"".concat(i,"px"),"border-radius":"".concat(parseInt(i/1.5,10),"px"),background:"#F5F5FF",border:"1px solid #4285c8"};Ot(s,function(l,p){e.selectionHandles.styles.bottomRight[p]=l,e.selectionHandles.styles.topLeft[p]=l}),this.main.appendChild(this.selectionHandles.topLeft),this.main.appendChild(this.selectionHandles.bottomRight),this.main.appendChild(this.selectionHandles.topLeftHitArea),this.main.appendChild(this.selectionHandles.bottomRightHitArea)}},{key:"isPartRange",value:function(e,n){var i=this.wot.selections.createOrGetArea();return!!(i.cellRange&&(e!==i.cellRange.to.row||n!==i.cellRange.to.col))}},{key:"updateMultipleSelectionHandlesPosition",value:function(e,n,i,o,a,s){var l=parseInt(this.selectionHandles.styles.topLeft.width,10),p=parseInt(this.selectionHandles.styles.topLeftHitArea.width,10);this.selectionHandles.styles.topLeft.top="".concat(parseInt(i-l,10),"px"),this.selectionHandles.styles.topLeft.left="".concat(parseInt(o-l,10),"px"),this.selectionHandles.styles.topLeftHitArea.top="".concat(parseInt(i-p/4*3,10),"px"),this.selectionHandles.styles.topLeftHitArea.left="".concat(parseInt(o-p/4*3,10),"px"),this.selectionHandles.styles.bottomRight.top="".concat(parseInt(i+s,10),"px"),this.selectionHandles.styles.bottomRight.left="".concat(parseInt(o+a,10),"px"),this.selectionHandles.styles.bottomRightHitArea.top="".concat(parseInt(i+s-p/4,10),"px"),this.selectionHandles.styles.bottomRightHitArea.left="".concat(parseInt(o+a-p/4,10),"px"),this.settings.border.cornerVisible&&this.settings.border.cornerVisible()?(this.selectionHandles.styles.topLeft.display="block",this.selectionHandles.styles.topLeftHitArea.display="block",this.isPartRange(e,n)?(this.selectionHandles.styles.bottomRight.display="none",this.selectionHandles.styles.bottomRightHitArea.display="none"):(this.selectionHandles.styles.bottomRight.display="block",this.selectionHandles.styles.bottomRightHitArea.display="block")):(this.selectionHandles.styles.topLeft.display="none",this.selectionHandles.styles.bottomRight.display="none",this.selectionHandles.styles.topLeftHitArea.display="none",this.selectionHandles.styles.bottomRightHitArea.display="none"),e===this.wot.wtSettings.getSetting("fixedRowsTop")||n===this.wot.wtSettings.getSetting("fixedColumnsLeft")?(this.selectionHandles.styles.topLeft.zIndex="9999",this.selectionHandles.styles.topLeftHitArea.zIndex="9999"):(this.selectionHandles.styles.topLeft.zIndex="",this.selectionHandles.styles.topLeftHitArea.zIndex="")}},{key:"appear",value:function(e){if(!this.disabled){for(var n=this.wot,i=n.wtTable,o=n.rootDocument,a=n.rootWindow,s,l,p,d,g,y,h=i.getRenderedRowsCount(),u=0;u<h;u+=1){var f=i.rowFilter.renderedToSource(u);if(f>=e[0]&&f<=e[2]){s=f,g=e[0];break}}for(var c=h-1;c>=0;c-=1){var v=i.rowFilter.renderedToSource(c);if(v>=e[0]&&v<=e[2]){l=v;break}}for(var m=i.getRenderedColumnsCount(),b=0;b<m;b+=1){var w=i.columnFilter.renderedToSource(b);if(w>=e[1]&&w<=e[3]){p=w,y=e[1];break}}for(var _=m-1;_>=0;_-=1){var C=i.columnFilter.renderedToSource(_);if(C>=e[1]&&C<=e[3]){d=C;break}}if(s===void 0||p===void 0){this.disappear();return}var R=i.getCell(new ke(s,p)),I=s!==l||p!==d,P=I?i.getCell(new ke(l,d)):R,N=ar(R),A=I?ar(P):N,$=ar(i.TABLE),T=N.top,M=N.left,S=M-$.left-1,E=A.left+sr(P)-M;if(this.isEntireColumnSelected(s,l)){var k=this.getDimensionsFromHeader("columns",p,d,g,$),O=null;if(k){var x=sw(k,3);O=x[0],S=x[1],E=x[2]}O&&(R=O)}var j=T-$.top-1,H=A.top+yr(P)-T;if(this.isEntireRowSelected(p,d)){var F=this.getDimensionsFromHeader("rows",s,l,y,$),V=null;if(F){var W=sw(F,3);V=W[0],j=W[1],H=W[2]}V&&(R=V)}var U=Ea(R,a);parseInt(U.borderTopWidth,10)>0&&(j+=1,H=H>0?H-1:0),parseInt(U.borderLeftWidth,10)>0&&(S+=1,E=E>0?E-1:0),this.topStyle.top="".concat(j,"px"),this.topStyle.left="".concat(S,"px"),this.topStyle.width="".concat(E,"px"),this.topStyle.display="block",this.leftStyle.top="".concat(j,"px"),this.leftStyle.left="".concat(S,"px"),this.leftStyle.height="".concat(H,"px"),this.leftStyle.display="block";var Y=Math.floor(this.settings.border.width/2);this.bottomStyle.top="".concat(j+H-Y,"px"),this.bottomStyle.left="".concat(S,"px"),this.bottomStyle.width="".concat(E,"px"),this.bottomStyle.display="block",this.rightStyle.top="".concat(j,"px"),this.rightStyle.left="".concat(S+E-Y,"px"),this.rightStyle.height="".concat(H+1,"px"),this.rightStyle.display="block";var K=this.settings.border.cornerVisible;K=typeof K=="function"?K(this.settings.layerLevel):K;var D=this.wot.getSetting("onModifyGetCellCoords",l,d),L=l,B=d;if(D&&Array.isArray(D)){var z=sw(D,4);L=z[2],B=z[3]}if(In()||!K||this.isPartRange(L,B))this.cornerStyle.display="none";else{this.cornerStyle.top="".concat(j+H+this.cornerCenterPointOffset-1,"px"),this.cornerStyle.left="".concat(S+E+this.cornerCenterPointOffset-1,"px"),this.cornerStyle.borderRightWidth=this.cornerDefaultStyle.borderWidth,this.cornerStyle.width=this.cornerDefaultStyle.width,this.cornerStyle.display="none";var q=Zs(i.TABLE),X=q===a;if(X&&(q=o.documentElement),d===this.wot.getSetting("totalColumns")-1){var ee=X?P.getBoundingClientRect().left:P.offsetLeft,ye=ee+sr(P)+parseInt(this.cornerDefaultStyle.width,10)/2,de=ye>=Js(q);de&&(this.cornerStyle.left="".concat(Math.floor(S+E+this.cornerCenterPointOffset-parseInt(this.cornerDefaultStyle.width,10)/2),"px"),this.cornerStyle.borderRightWidth=0)}if(l===this.wot.getSetting("totalRows")-1){var ge=X?P.getBoundingClientRect().top:P.offsetTop,we=ge+yr(P)+parseInt(this.cornerDefaultStyle.height,10)/2,be=we>=xi(q);be&&(this.cornerStyle.top="".concat(Math.floor(j+H+this.cornerCenterPointOffset-parseInt(this.cornerDefaultStyle.height,10)/2),"px"),this.cornerStyle.borderBottomWidth=0)}this.cornerStyle.display="block"}In()&&this.updateMultipleSelectionHandlesPosition(l,d,j,S,E,H)}}},{key:"isEntireColumnSelected",value:function(e,n){return e===this.wot.wtTable.getFirstRenderedRow()&&n===this.wot.wtTable.getLastRenderedRow()}},{key:"isEntireRowSelected",value:function(e,n){return e===this.wot.wtTable.getFirstRenderedColumn()&&n===this.wot.wtTable.getLastRenderedColumn()}},{key:"getDimensionsFromHeader",value:function(e,n,i,o,a){var s=this.wot.wtTable,l=s.wtRootElement.parentNode,p=null,d=null,g=null,y=null,h=null,u=null,f=null,c=null;switch(e){case"rows":p=function(){return s.getRowHeader.apply(s,arguments)},d=function(){return yr.apply(void 0,arguments)},g="ht__selection--rows",u="top";break;case"columns":p=function(){return s.getColumnHeader.apply(s,arguments)},d=function(){return sr.apply(void 0,arguments)},g="ht__selection--columns",u="left";break}if(l.classList.contains(g)){var v=this.wot.getSetting("columnHeaders").length;if(f=p(n,v-o),c=p(i,v-o),!f||!c)return!1;var m=ar(f),b=ar(c);return f&&c&&(y=m[u]-a[u]-1,h=b[u]+d(c)-m[u]),[f,y,h]}return!1}},{key:"changeBorderStyle",value:function(e,n){var i=this[e].style,o=n[e];!o||o.hide?Ie(this[e],"hidden"):(lt(this[e],"hidden")&&dt(this[e],"hidden"),i.backgroundColor=o.color,(e==="top"||e==="bottom")&&(i.height="".concat(o.width,"px")),(e==="right"||e==="left")&&(i.width="".concat(o.width,"px")))}},{key:"changeBorderToDefaultStyle",value:function(e){var n={width:1,color:"#000"},i=this[e].style;i.backgroundColor=n.color,i.width="".concat(n.width,"px"),i.height="".concat(n.width,"px")}},{key:"toggleHiddenClass",value:function(e,n){this.changeBorderToDefaultStyle(e),n?Ie(this[e],"hidden"):dt(this[e],"hidden")}},{key:"disappear",value:function(){this.topStyle.display="none",this.leftStyle.display="none",this.bottomStyle.display="none",this.rightStyle.display="none",this.cornerStyle.display="none",In()&&(this.selectionHandles.styles.topLeft.display="none",this.selectionHandles.styles.bottomRight.display="none")}},{key:"destroy",value:function(){this.eventManager.destroyWithOwnEventsOnly(),this.main.parentNode.removeChild(this.main)}}]),t}(),hne=cne;function dne(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}function A6(t,r){for(var e=0;e<r.length;e++){var n=r[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function pne(t,r,e){return r&&A6(t.prototype,r),e&&A6(t,e),t}var iu=new WeakMap,yne=function(){function t(r){dne(this,t),this.instance=r,this.eventManager=new Wt(r),iu.set(this,{selectedCellBeforeTouchEnd:void 0,dblClickTimeout:[null,null],dblClickOrigin:[null,null]}),this.registerEvents()}return pne(t,[{key:"registerEvents",value:function(){var e=this;this.eventManager.addEventListener(this.instance.wtTable.holder,"contextmenu",function(o){return e.onContextMenu(o)}),this.eventManager.addEventListener(this.instance.wtTable.TABLE,"mouseover",function(o){return e.onMouseOver(o)}),this.eventManager.addEventListener(this.instance.wtTable.TABLE,"mouseout",function(o){return e.onMouseOut(o)});var n=function(){e.eventManager.addEventListener(e.instance.wtTable.holder,"touchstart",function(a){return e.onTouchStart(a)}),e.eventManager.addEventListener(e.instance.wtTable.holder,"touchend",function(a){return e.onTouchEnd(a)}),e.instance.momentumScrolling||(e.instance.momentumScrolling={}),e.eventManager.addEventListener(e.instance.wtTable.holder,"scroll",function(){clearTimeout(e.instance.momentumScrolling._timeout),e.instance.momentumScrolling.ongoing||e.instance.getSetting("onBeforeTouchScroll"),e.instance.momentumScrolling.ongoing=!0,e.instance.momentumScrolling._timeout=setTimeout(function(){e.instance.touchApplied||(e.instance.momentumScrolling.ongoing=!1,e.instance.getSetting("onAfterMomentumScroll"))},200)})},i=function(){e.eventManager.addEventListener(e.instance.wtTable.holder,"mouseup",function(a){return e.onMouseUp(a)}),e.eventManager.addEventListener(e.instance.wtTable.holder,"mousedown",function(a){return e.onMouseDown(a)})};In()?n():(hb()&&n(),i())}},{key:"selectedCellWasTouched",value:function(e){var n=iu.get(this),i=this.parentCell(e),o=i.coords;if(n.selectedCellBeforeTouchEnd&&o){var a=[o.row,n.selectedCellBeforeTouchEnd.from.row],s=a[0],l=a[1],p=[o.col,n.selectedCellBeforeTouchEnd.from.col],d=p[0],g=p[1];return s===l&&d===g}return!1}},{key:"parentCell",value:function(e){var n={},i=this.instance.wtTable.TABLE,o=sf(e,["TD","TH"],i);return o?(n.coords=this.instance.wtTable.getCoords(o),n.TD=o):lt(e,"wtBorder")&&lt(e,"current")?(n.coords=this.instance.selections.getCell().cellRange.highlight,n.TD=this.instance.wtTable.getCell(n.coords)):lt(e,"wtBorder")&&lt(e,"area")&&this.instance.selections.createOrGetArea().cellRange&&(n.coords=this.instance.selections.createOrGetArea().cellRange.to,n.TD=this.instance.wtTable.getCell(n.coords)),n}},{key:"onMouseDown",value:function(e){var n=iu.get(this),i=this.instance.rootDocument.activeElement,o=hf(qx,e.target),a=e.target;if(!(a===i||o(0)===i||o(1)===i)){var s=this.parentCell(a);lt(a,"corner")?this.instance.getSetting("onCellCornerMouseDown",e,a):s.TD&&this.instance.hasSetting("onCellMouseDown")&&this.instance.getSetting("onCellMouseDown",e,s.coords,s.TD,this.instance),(e.button===0||this.instance.touchApplied)&&s.TD&&(n.dblClickOrigin[0]=s.TD,clearTimeout(n.dblClickTimeout[0]),n.dblClickTimeout[0]=setTimeout(function(){n.dblClickOrigin[0]=null},1e3))}}},{key:"onContextMenu",value:function(e){if(this.instance.hasSetting("onCellContextMenu")){var n=this.parentCell(e.target);n.TD&&this.instance.getSetting("onCellContextMenu",e,n.coords,n.TD,this.instance)}}},{key:"onMouseOver",value:function(e){if(!!this.instance.hasSetting("onCellMouseOver")){var n=this.instance.wtTable.TABLE,i=sf(e.target,["TD","TH"],n),o=this.instance.cloneSource||this.instance;i&&i!==o.lastMouseOver&&To(i,n)&&(o.lastMouseOver=i,this.instance.getSetting("onCellMouseOver",e,this.instance.wtTable.getCoords(i),i,this.instance))}}},{key:"onMouseOut",value:function(e){if(!!this.instance.hasSetting("onCellMouseOut")){var n=this.instance.wtTable.TABLE,i=sf(e.target,["TD","TH"],n),o=sf(e.relatedTarget,["TD","TH"],n);i&&i!==o&&To(i,n)&&this.instance.getSetting("onCellMouseOut",e,this.instance.wtTable.getCoords(i),i,this.instance)}}},{key:"onMouseUp",value:function(e){var n=iu.get(this),i=this.parentCell(e.target);i.TD&&this.instance.hasSetting("onCellMouseUp")&&this.instance.getSetting("onCellMouseUp",e,i.coords,i.TD,this.instance),!(e.button!==0&&!this.instance.touchApplied)&&(i.TD===n.dblClickOrigin[0]&&i.TD===n.dblClickOrigin[1]?(lt(e.target,"corner")?this.instance.getSetting("onCellCornerDblClick",e,i.coords,i.TD,this.instance):this.instance.getSetting("onCellDblClick",e,i.coords,i.TD,this.instance),n.dblClickOrigin[0]=null,n.dblClickOrigin[1]=null):i.TD===n.dblClickOrigin[0]&&(n.dblClickOrigin[1]=i.TD,clearTimeout(n.dblClickTimeout[1]),n.dblClickTimeout[1]=setTimeout(function(){n.dblClickOrigin[1]=null},500)))}},{key:"onTouchStart",value:function(e){var n=iu.get(this);n.selectedCellBeforeTouchEnd=this.instance.selections.getCell().cellRange,this.instance.touchApplied=!0,this.onMouseDown(e)}},{key:"onTouchEnd",value:function(e){var n,i=e.target,o=(n=this.parentCell(i))===null||n===void 0?void 0:n.coords,a=at(o)&&o.row>=0&&o.col>=0,s=e.cancelable&&a&&this.instance.getSetting("isDataViewInstance");if(s){var l=["A","BUTTON","INPUT"];xb()&&(bT()||wT())&&this.selectedCellWasTouched(i)&&!l.includes(i.tagName)?e.preventDefault():this.selectedCellWasTouched(i)||e.preventDefault()}this.onMouseUp(e),this.instance.touchApplied=!1}},{key:"destroy",value:function(){var e=iu.get(this);clearTimeout(e.dblClickTimeout[0]),clearTimeout(e.dblClickTimeout[1]),this.eventManager.destroy()}}]),t}(),M6=yne,De={ALT:18,ARROW_DOWN:40,ARROW_LEFT:37,ARROW_RIGHT:39,ARROW_UP:38,AUDIO_DOWN:hh()?182:174,AUDIO_MUTE:hh()?181:173,AUDIO_UP:hh()?183:175,BACKSPACE:8,CAPS_LOCK:20,COMMA:188,COMMAND_LEFT:91,COMMAND_RIGHT:93,COMMAND_FIREFOX:224,CONTROL:17,DELETE:46,END:35,ENTER:13,ESCAPE:27,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,F13:124,F14:125,F15:126,F16:127,F17:128,F18:129,F19:130,HOME:36,INSERT:45,MEDIA_NEXT:176,MEDIA_PLAY_PAUSE:179,MEDIA_PREV:177,MEDIA_STOP:178,NULL:0,NUM_LOCK:144,PAGE_DOWN:34,PAGE_UP:33,PAUSE:19,PERIOD:190,SCROLL_LOCK:145,SHIFT:16,SPACE:32,TAB:9,A:65,C:67,D:68,F:70,L:76,O:79,P:80,S:83,V:86,X:88,Y:89,Z:90},mne=[De.ALT,De.ARROW_DOWN,De.ARROW_LEFT,De.ARROW_RIGHT,De.ARROW_UP,De.AUDIO_DOWN,De.AUDIO_MUTE,De.AUDIO_UP,De.BACKSPACE,De.CAPS_LOCK,De.DELETE,De.END,De.ENTER,De.ESCAPE,De.F1,De.F2,De.F3,De.F4,De.F5,De.F6,De.F7,De.F8,De.F9,De.F10,De.F11,De.F12,De.F13,De.F14,De.F15,De.F16,De.F17,De.F18,De.F19,De.HOME,De.INSERT,De.MEDIA_NEXT,De.MEDIA_PLAY_PAUSE,De.MEDIA_PREV,De.MEDIA_STOP,De.NULL,De.NUM_LOCK,De.PAGE_DOWN,De.PAGE_UP,De.PAUSE,De.SCROLL_LOCK,De.SHIFT,De.TAB];function P6(t){return t===32||t>=48&&t<=57||t>=96&&t<=111||t>=186&&t<=192||t>=219&&t<=222||t>=226||t>=65&&t<=90}function uw(t){return mne.includes(t)}function vne(t){var r=[];return OT()?r.push(De.COMMAND_LEFT,De.COMMAND_RIGHT,De.COMMAND_FIREFOX):r.push(De.CONTROL),r.includes(t)}function lw(t){return[De.CONTROL,De.COMMAND_LEFT,De.COMMAND_RIGHT,De.COMMAND_FIREFOX].includes(t)}function No(t,r){var e=r.split("|"),n=!1;return he(e,function(i){if(t===De[i])return n=!0,!1}),n}var gne=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",KEY_CODES:De,isPrintableChar:P6,isFunctionKey:uw,isCtrlKey:vne,isCtrlMetaKey:lw,isKey:No});function bne(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}function I6(t,r){for(var e=0;e<r.length;e++){var n=r[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function wne(t,r,e){return r&&I6(t.prototype,r),e&&I6(t,e),t}vf(tre);vf(yre);vf(xre);vf(Ure);vf(ine);var _ne=function(){function t(r){bne(this,t),this.wot=r;var e=this.wot,n=e.rootDocument,i=e.rootWindow,o=e.wtTable,a=parseInt(i.getComputedStyle(n.body).lineHeight,10),s=parseInt(i.getComputedStyle(n.body).fontSize,10)*1.2;this.instance=this.wot,this.eventManager=new Wt(this.wot),this.scrollbarSize=Pr(n),this.wot.update("scrollbarWidth",this.scrollbarSize),this.wot.update("scrollbarHeight",this.scrollbarSize);var l=i.getComputedStyle(o.wtRootElement.parentNode).getPropertyValue("overflow")==="hidden";this.scrollableElement=l?o.holder:lf(o.TABLE),this.topOverlay=void 0,this.bottomOverlay=void 0,this.leftOverlay=void 0,this.topLeftCornerOverlay=void 0,this.bottomLeftCornerOverlay=void 0,this.prepareOverlays(),this.hasScrollbarBottom=!1,this.hasScrollbarRight=!1,this.destroyed=!1,this.keyPressed=!1,this.spreaderLastSize={width:null,height:null},this.verticalScrolling=!1,this.horizontalScrolling=!1,this.browserLineHeight=a||s,this.registerListeners(),this.lastScrollX=i.scrollX,this.lastScrollY=i.scrollY}return wne(t,[{key:"prepareOverlays",value:function(){var e=!1;return this.topOverlay?e=this.topOverlay.updateStateOfRendering()||e:this.topOverlay=gf(eu,this.wot),U0(ti)||(this.bottomOverlay={needFullRender:!1,updateStateOfRendering:function(){return!1}}),U0(Io)||(this.bottomLeftCornerOverlay={needFullRender:!1,updateStateOfRendering:function(){return!1}}),this.bottomOverlay?e=this.bottomOverlay.updateStateOfRendering()||e:this.bottomOverlay=gf(ti,this.wot),this.leftOverlay?e=this.leftOverlay.updateStateOfRendering()||e:this.leftOverlay=gf(tu,this.wot),this.topOverlay.needFullRender&&this.leftOverlay.needFullRender&&(this.topLeftCornerOverlay?e=this.topLeftCornerOverlay.updateStateOfRendering()||e:this.topLeftCornerOverlay=gf(ru,this.wot)),this.bottomOverlay.needFullRender&&this.leftOverlay.needFullRender&&(this.bottomLeftCornerOverlay?e=this.bottomLeftCornerOverlay.updateStateOfRendering()||e:this.bottomLeftCornerOverlay=gf(Io,this.wot)),e}},{key:"refreshAll",value:function(){if(!!this.wot.drawn){if(!this.wot.wtTable.holder.parentNode){this.destroy();return}this.wot.draw(!0),this.verticalScrolling&&this.leftOverlay.onScroll(),this.horizontalScrolling&&this.topOverlay.onScroll(),this.verticalScrolling=!1,this.horizontalScrolling=!1}}},{key:"registerListeners",value:function(){var e=this,n=this.wot,i=n.rootDocument,o=n.rootWindow,a=this.topOverlay.mainTableScrollableElement,s=this.leftOverlay.mainTableScrollableElement;this.eventManager.addEventListener(i.documentElement,"keydown",function(u){return e.onKeyDown(u)}),this.eventManager.addEventListener(i.documentElement,"keyup",function(){return e.onKeyUp()}),this.eventManager.addEventListener(i,"visibilitychange",function(){return e.onKeyUp()}),this.eventManager.addEventListener(a,"scroll",function(u){return e.onTableScroll(u)},{passive:!0}),a!==s&&this.eventManager.addEventListener(s,"scroll",function(u){return e.onTableScroll(u)},{passive:!0});var l=o.devicePixelRatio&&o.devicePixelRatio>1,p=this.scrollableElement===o,d=this.wot.wtSettings.getSetting("preventWheel"),g={passive:p};(d||l||!gT())&&this.eventManager.addEventListener(this.wot.wtTable.wtRootElement,"wheel",function(u){return e.onCloneWheel(u,d)},g);var y=[this.topOverlay,this.bottomOverlay,this.leftOverlay,this.topLeftCornerOverlay,this.bottomLeftCornerOverlay];y.forEach(function(u){if(u&&u.needFullRender){var f=u.clone.wtTable.holder;e.eventManager.addEventListener(f,"wheel",function(c){return e.onCloneWheel(c,d)},g)}});var h;this.eventManager.addEventListener(o,"resize",function(){clearTimeout(h),h=setTimeout(function(){e.wot.getSetting("onWindowResize")},200)})}},{key:"deregisterListeners",value:function(){this.eventManager.clearEvents(!0)}},{key:"onTableScroll",value:function(e){var n=this.wot.rootWindow,i=this.leftOverlay.mainTableScrollableElement,o=this.topOverlay.mainTableScrollableElement,a=e.target;this.keyPressed&&(o!==n&&a!==n&&!e.target.contains(o)||i!==n&&a!==n&&!e.target.contains(i))||this.syncScrollPositions(e)}},{key:"onCloneWheel",value:function(e,n){var i=this.wot.rootWindow,o=this.leftOverlay.mainTableScrollableElement,a=this.topOverlay.mainTableScrollableElement,s=e.target,l=a!==i&&s!==i&&!s.contains(a),p=o!==i&&s!==i&&!s.contains(o);if(!(this.keyPressed&&(l||p))){var d=this.translateMouseWheelToScroll(e);(n||this.scrollableElement!==i&&d)&&e.preventDefault()}}},{key:"onKeyDown",value:function(e){this.keyPressed=No(e.keyCode,"ARROW_UP|ARROW_RIGHT|ARROW_DOWN|ARROW_LEFT")}},{key:"onKeyUp",value:function(){this.keyPressed=!1}},{key:"translateMouseWheelToScroll",value:function(e){var n=this.browserLineHeight,i=isNaN(e.deltaY)?-1*e.wheelDeltaY:e.deltaY,o=isNaN(e.deltaX)?-1*e.wheelDeltaX:e.deltaX;e.deltaMode===1&&(o+=o*n,i+=i*n);var a=this.scrollVertically(i),s=this.scrollHorizontally(o);return a||s}},{key:"scrollVertically",value:function(e){var n=this.scrollableElement.scrollTop;return this.scrollableElement.scrollTop+=e,n!==this.scrollableElement.scrollTop}},{key:"scrollHorizontally",value:function(e){var n=this.scrollableElement.scrollLeft;return this.scrollableElement.scrollLeft+=e,n!==this.scrollableElement.scrollLeft}},{key:"syncScrollPositions",value:function(){if(!this.destroyed){var e=this.wot.rootWindow,n=this.topOverlay.clone.wtTable.holder,i=this.leftOverlay.clone.wtTable.holder,o=[this.scrollableElement.scrollLeft,this.scrollableElement.scrollTop],a=o[0],s=o[1];if(this.horizontalScrolling=n.scrollLeft!==a||this.lastScrollX!==e.scrollX,this.verticalScrolling=i.scrollTop!==s||this.lastScrollY!==e.scrollY,this.lastScrollX=e.scrollX,this.lastScrollY=e.scrollY,this.horizontalScrolling){n.scrollLeft=a;var l=this.bottomOverlay.needFullRender?this.bottomOverlay.clone.wtTable.holder:null;l&&(l.scrollLeft=a)}this.verticalScrolling&&(i.scrollTop=s),this.refreshAll()}}},{key:"syncScrollWithMaster",value:function(){var e=this.topOverlay.mainTableScrollableElement,n=e.scrollLeft,i=e.scrollTop;this.topOverlay.needFullRender&&(this.topOverlay.clone.wtTable.holder.scrollLeft=n),this.bottomOverlay.needFullRender&&(this.bottomOverlay.clone.wtTable.holder.scrollLeft=n),this.leftOverlay.needFullRender&&(this.leftOverlay.clone.wtTable.holder.scrollTop=i)}},{key:"updateMainScrollableElements",value:function(){this.deregisterListeners(),this.leftOverlay.updateMainScrollableElement(),this.topOverlay.updateMainScrollableElement(),this.bottomOverlay.needFullRender&&this.bottomOverlay.updateMainScrollableElement();var e=this.wot,n=e.rootWindow,i=e.wtTable;n.getComputedStyle(i.wtRootElement.parentNode).getPropertyValue("overflow")==="hidden"?this.scrollableElement=i.holder:this.scrollableElement=lf(i.TABLE),this.registerListeners()}},{key:"destroy",value:function(){this.eventManager.destroy(),this.topOverlay.destroy(),this.bottomOverlay.clone&&this.bottomOverlay.destroy(),this.leftOverlay.destroy(),this.topLeftCornerOverlay&&this.topLeftCornerOverlay.destroy(),this.bottomLeftCornerOverlay&&this.bottomLeftCornerOverlay.clone&&this.bottomLeftCornerOverlay.destroy(),this.destroyed=!0}},{key:"refresh",value:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,n=this.wot.wtTable.spreader,i=n.clientWidth,o=n.clientHeight;(i!==this.spreaderLastSize.width||o!==this.spreaderLastSize.height)&&(this.spreaderLastSize.width=i,this.spreaderLastSize.height=o,this.adjustElementsSize()),this.bottomOverlay.clone&&this.bottomOverlay.refresh(e),this.leftOverlay.refresh(e),this.topOverlay.refresh(e),this.topLeftCornerOverlay&&this.topLeftCornerOverlay.refresh(e),this.bottomLeftCornerOverlay&&this.bottomLeftCornerOverlay.clone&&this.bottomLeftCornerOverlay.refresh(e)}},{key:"adjustElementsSize",value:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,n=this.wot,i=n.wtViewport,o=n.wtTable,a=this.wot.getSetting("totalColumns"),s=this.wot.getSetting("totalRows"),l=i.getRowHeaderWidth(),p=i.getColumnHeaderHeight(),d=o.hider.style;if(d.width="".concat(l+this.leftOverlay.sumCellSizes(0,a),"px"),d.height="".concat(p+this.topOverlay.sumCellSizes(0,s)+1,"px"),this.scrollbarSize>0){var g=o.wtRootElement,y=g.scrollHeight,h=g.scrollWidth,u=o.holder,f=u.scrollHeight,c=u.scrollWidth;this.hasScrollbarRight=y<f,this.hasScrollbarBottom=h<c,this.hasScrollbarRight&&o.hider.scrollWidth+this.scrollbarSize>h?this.hasScrollbarBottom=!0:this.hasScrollbarBottom&&o.hider.scrollHeight+this.scrollbarSize>y&&(this.hasScrollbarRight=!0)}this.topOverlay.adjustElementsSize(e),this.leftOverlay.adjustElementsSize(e),this.bottomOverlay.adjustElementsSize(e)}},{key:"applyToDOM",value:function(){var e=this.wot.wtTable;!e.isVisible()||(this.topOverlay.applyToDOM(),this.bottomOverlay.clone&&this.bottomOverlay.applyToDOM(),this.leftOverlay.applyToDOM())}},{key:"getParentOverlay",value:function(e){if(!e)return null;var n=[this.topOverlay,this.leftOverlay,this.bottomOverlay,this.topLeftCornerOverlay,this.bottomLeftCornerOverlay],i=null;return he(n,function(o){!o||o.clone&&o.clone.wtTable.TABLE.contains(e)&&(i=o.clone)}),i}},{key:"syncOverlayTableClassNames",value:function(){var e=this.instance.wtTable.TABLE,n=[this.topOverlay,this.leftOverlay,this.bottomOverlay,this.topLeftCornerOverlay,this.bottomLeftCornerOverlay];he(n,function(i){!i||(i.clone.wtTable.TABLE.className=e.className)})}}]),t}(),Sne=_ne;function Cne(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}function D6(t,r){for(var e=0;e<r.length;e++){var n=r[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function kne(t,r,e){return r&&D6(t.prototype,r),e&&D6(t,e),t}var One=function(){function t(r){Cne(this,t),this.wot=r}return kne(t,[{key:"scrollViewport",value:function(e,n,i,o,a){if(e.col<0||e.row<0)return!1;var s=this.scrollViewportHorizontally(e.col,i,a),l=this.scrollViewportVertically(e.row,n,o);return s||l}},{key:"scrollViewportHorizontally",value:function(e,n,i){if(!this.wot.drawn)return!1;var o=this._getVariables(),a=o.fixedColumnsLeft,s=o.leftOverlay,l=o.totalColumns,p=!1;if(e>=0&&e<=Math.max(l-1,0)){var d=this.getFirstVisibleColumn(),g=this.getLastVisibleColumn();e>=a&&d>-1&&(e<d||i)?p=s.scrollTo(e):(g===-1||g>-1&&(e>g||n))&&(p=s.scrollTo(e,!0))}return p}},{key:"scrollViewportVertically",value:function(e,n,i){if(!this.wot.drawn)return!1;var o=this._getVariables(),a=o.fixedRowsBottom,s=o.fixedRowsTop,l=o.topOverlay,p=o.totalRows,d=!1;if(e>=0&&e<=Math.max(p-1,0)){var g=this.getFirstVisibleRow(),y=this.getLastVisibleRow();e>=s&&g>-1&&(e<g||n)?d=l.scrollTo(e):(y===-1||y>-1&&(e>y&&e<p-a||i))&&(d=l.scrollTo(e,!0))}return d}},{key:"getFirstVisibleRow",value:function(){var e=this._getVariables(),n=e.topOverlay,i=e.wtTable,o=e.wtViewport,a=e.totalRows,s=e.fixedRowsTop,l=this.wot.rootWindow,p=i.getFirstVisibleRow();if(n.mainTableScrollableElement===l){var d=ar(i.wtRootElement),g=xi(i.hider),y=xi(l),h=uf(l,l);if(d.top+g-y<=h){var u=o.getColumnHeaderHeight();u+=n.sumCellSizes(0,s);for(var f=a;f>0;f--)if(u+=n.sumCellSizes(f-1,f),d.top+g-u<=h){p=f;break}}}return p}},{key:"getLastVisibleRow",value:function(){var e=this._getVariables(),n=e.topOverlay,i=e.wtTable,o=e.wtViewport,a=e.totalRows,s=this.wot.rootWindow,l=i.getLastVisibleRow();if(n.mainTableScrollableElement===s){var p=ar(i.wtRootElement),d=uf(s,s);if(p.top>d){for(var g=xi(s),y=o.getColumnHeaderHeight(),h=1;h<=a;h++)if(y+=n.sumCellSizes(h-1,h),p.top+y-d>=g){l=h-2;break}}}return l}},{key:"getFirstVisibleColumn",value:function(){var e=this._getVariables(),n=e.leftOverlay,i=e.wtTable,o=e.wtViewport,a=e.totalColumns,s=this.wot.rootWindow,l=i.getFirstVisibleColumn();if(n.mainTableScrollableElement===s){var p=ar(i.wtRootElement),d=Js(i.hider),g=Js(s),y=Wh(s,s);if(p.left+d-g<=y){for(var h=o.getRowHeaderWidth(),u=a;u>0;u--)if(h+=n.sumCellSizes(u-1,u),p.left+d-h<=y){l=u;break}}}return l}},{key:"getLastVisibleColumn",value:function(){var e=this._getVariables(),n=e.leftOverlay,i=e.wtTable,o=e.wtViewport,a=e.totalColumns,s=this.wot.rootWindow,l=i.getLastVisibleColumn();if(n.mainTableScrollableElement===s){var p=ar(i.wtRootElement),d=Wh(s,s);if(p.left>d){for(var g=Js(s),y=o.getRowHeaderWidth(),h=1;h<=a;h++)if(y+=n.sumCellSizes(h-1,h),p.left+y-d>=g){l=h-2;break}}}return l}},{key:"_getVariables",value:function(){var e=this.wot,n=e.wtOverlays.topOverlay,i=e.wtOverlays.leftOverlay,o=e.wtTable,a=e.wtViewport,s=e.getSetting("totalRows"),l=e.getSetting("totalColumns"),p=e.getSetting("fixedRowsTop"),d=e.getSetting("fixedRowsBottom"),g=e.getSetting("fixedColumnsLeft");return{topOverlay:n,leftOverlay:i,wtTable:o,wtViewport:a,totalRows:s,totalColumns:l,fixedRowsTop:p,fixedRowsBottom:d,fixedColumnsLeft:g}}}]),t}(),N6=One;function Rne(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}function $6(t,r){for(var e=0;e<r.length;e++){var n=r[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function Ene(t,r,e){return r&&$6(t.prototype,r),e&&$6(t,e),t}var Tne=function(){function t(r,e){var n=this;Rne(this,t),this.wot=r,this.instance=r,this.defaults={table:void 0,isDataViewInstance:!0,externalRowCalculator:!1,stretchH:"none",currentRowClassName:null,currentColumnClassName:null,preventOverflow:function(){return!1},preventWheel:!1,data:void 0,freezeOverlays:!1,fixedColumnsLeft:0,fixedRowsTop:0,fixedRowsBottom:0,shouldRenderLeftOverlay:function(){return n.getSetting("fixedColumnsLeft")>0||n.getSetting("rowHeaders").length>0},shouldRenderTopOverlay:function(){return n.getSetting("fixedRowsTop")>0||n.getSetting("columnHeaders").length>0},shouldRenderBottomOverlay:function(){return n.getSetting("fixedRowsBottom")>0},minSpareRows:0,rowHeaders:function(){return[]},columnHeaders:function(){return[]},totalRows:void 0,totalColumns:void 0,cellRenderer:function(o,a,s){var l=n.getSetting("data",o,a);Mo(s,l==null?"":l)},columnWidth:function(){},rowHeight:function(){},defaultRowHeight:23,defaultColumnWidth:50,selections:null,hideBorderOnMouseDownOver:!1,viewportRowCalculatorOverride:null,viewportColumnCalculatorOverride:null,onCellMouseDown:null,onCellContextMenu:null,onCellMouseOver:null,onCellMouseOut:null,onCellMouseUp:null,onCellDblClick:null,onCellCornerMouseDown:null,onCellCornerDblClick:null,beforeDraw:null,onDraw:null,onBeforeRemoveCellClassNames:null,onAfterDrawSelection:null,onBeforeDrawBorders:null,onScrollVertically:null,onScrollHorizontally:null,onBeforeTouchScroll:null,onAfterMomentumScroll:null,onBeforeStretchingColumnWidth:function(o){return o},onModifyRowHeaderWidth:null,onModifyGetCellCoords:null,onBeforeHighlightingRowHeader:function(o){return o},onBeforeHighlightingColumnHeader:function(o){return o},onWindowResize:null,scrollbarWidth:10,scrollbarHeight:10,renderAllRows:!1,groups:!1,rowHeaderWidth:null,columnHeaderHeight:null,headerClassName:null},this.settings={},Ot(this.defaults,function(i,o){if(e[o]!==void 0)n.settings[o]=e[o];else{if(i===void 0)throw new Error('A required setting "'.concat(o,'" was not provided'));n.settings[o]=i}})}return Ene(t,[{key:"update",value:function(e,n){var i=this;return n===void 0?Ot(e,function(o,a){i.settings[a]=o}):this.settings[e]=n,this.wot}},{key:"getSetting",value:function(e,n,i,o,a){return typeof this.settings[e]=="function"?this.settings[e](n,i,o,a):n!==void 0&&Array.isArray(this.settings[e])?this.settings[e][n]:this.settings[e]}},{key:"has",value:function(e){return!!this.settings[e]}}]),t}(),xne=Tne;function Ane(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}function j6(t,r){for(var e=0;e<r.length;e++){var n=r[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function Mne(t,r,e){return r&&j6(t.prototype,r),e&&j6(t,e),t}var Pne=function(){function t(r){var e=this;Ane(this,t),this.wot=r,this.instance=this.wot,this.oversizedRows=[],this.oversizedColumnHeaders=[],this.hasOversizedColumnHeadersMarked={},this.clientHeight=0,this.containerWidth=NaN,this.rowHeaderWidth=NaN,this.rowsVisibleCalculator=null,this.columnsVisibleCalculator=null,this.eventManager=new Wt(this.wot),this.eventManager.addEventListener(this.wot.rootWindow,"resize",function(){e.clientHeight=e.getWorkspaceHeight()})}return Mne(t,[{key:"getWorkspaceHeight",value:function(){var e=this.wot.rootDocument,n=this.instance.wtOverlays.topOverlay.trimmingContainer,i=0;if(n===this.wot.rootWindow)i=e.documentElement.clientHeight;else{var o=yr(n);i=o>0&&n.clientHeight>0?n.clientHeight:1/0}return i}},{key:"getWorkspaceWidth",value:function(){var e=this.wot,n=e.rootDocument,i=e.rootWindow,o=this.instance.wtOverlays.leftOverlay.trimmingContainer,a=n.documentElement.offsetWidth,s=e.getSetting("totalColumns"),l=e.getSetting("preventOverflow"),p,d;if(l)return sr(this.instance.wtTable.wtRootElement);if(e.getSetting("freezeOverlays")?p=Math.min(a-this.getWorkspaceOffset().left,a):p=Math.min(this.getContainerFillWidth(),a-this.getWorkspaceOffset().left,a),o===i&&s>0&&this.sumColumnWidths(0,s-1)>p)return n.documentElement.clientWidth;if(o!==i&&(d=Uh(this.instance.wtOverlays.leftOverlay.trimmingContainer,"overflow",i),d==="scroll"||d==="hidden"||d==="auto"))return Math.max(p,o.clientWidth);var g=e.getSetting("stretchH");return g==="none"||!g?Math.max(p,sr(this.instance.wtTable.TABLE)):p}},{key:"hasVerticalScroll",value:function(){return this.getWorkspaceActualHeight()>this.getWorkspaceHeight()}},{key:"hasHorizontalScroll",value:function(){return this.getWorkspaceActualWidth()>this.getWorkspaceWidth()}},{key:"sumColumnWidths",value:function(e,n){for(var i=this.wot.wtTable,o=0,a=e;a<n;)o+=i.getColumnWidth(a),a+=1;return o}},{key:"getContainerFillWidth",value:function(){if(this.containerWidth)return this.containerWidth;var e=this.instance.wtTable.holder,n=this.wot.rootDocument.createElement("div");n.style.width="100%",n.style.height="1px",e.appendChild(n);var i=n.offsetWidth;return this.containerWidth=i,e.removeChild(n),i}},{key:"getWorkspaceOffset",value:function(){return ar(this.wot.wtTable.TABLE)}},{key:"getWorkspaceActualHeight",value:function(){return yr(this.wot.wtTable.TABLE)}},{key:"getWorkspaceActualWidth",value:function(){var e=this.wot.wtTable;return sr(e.TABLE)||sr(e.TBODY)||sr(e.THEAD)}},{key:"getColumnHeaderHeight",value:function(){var e=this.instance.getSetting("columnHeaders");return e.length?isNaN(this.columnHeaderHeight)&&(this.columnHeaderHeight=yr(this.wot.wtTable.THEAD)):this.columnHeaderHeight=0,this.columnHeaderHeight}},{key:"getViewportHeight",value:function(){var e=this.getWorkspaceHeight();if(e===1/0)return e;var n=this.getColumnHeaderHeight();return n>0&&(e-=n),e}},{key:"getRowHeaderWidth",value:function(){var e=this.instance.getSetting("rowHeaderWidth"),n=this.instance.getSetting("rowHeaders");if(e){this.rowHeaderWidth=0;for(var i=0,o=n.length;i<o;i++)this.rowHeaderWidth+=e[i]||e}if(this.wot.cloneSource)return this.wot.cloneSource.wtViewport.getRowHeaderWidth();if(isNaN(this.rowHeaderWidth))if(n.length){var a=this.instance.wtTable.TABLE.querySelector("TH");this.rowHeaderWidth=0;for(var s=0,l=n.length;s<l;s++)a?(this.rowHeaderWidth+=sr(a),a=a.nextSibling):this.rowHeaderWidth+=50}else this.rowHeaderWidth=0;return this.rowHeaderWidth=this.instance.getSetting("onModifyRowHeaderWidth",this.rowHeaderWidth)||this.rowHeaderWidth,this.rowHeaderWidth}},{key:"getViewportWidth",value:function(){var e=this.getWorkspaceWidth();if(e===1/0)return e;var n=this.getRowHeaderWidth();return n>0?e-n:e}},{key:"createRowsCalculator",value:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:xa,n=this.wot,i=n.wtSettings,o=n.wtOverlays,a=n.wtTable,s=n.rootDocument,l,p,d;this.rowHeaderWidth=NaN,i.settings.renderAllRows&&e===xa?l=1/0:l=this.getViewportHeight();var g=o.topOverlay.getScrollPosition()-o.topOverlay.getTableParentOffset();g<0&&(g=0);var y=n.getSetting("fixedRowsTop"),h=n.getSetting("fixedRowsBottom"),u=n.getSetting("totalRows");return y&&(d=o.topOverlay.sumCellSizes(0,y),g+=d,l-=d),h&&o.bottomOverlay.clone&&(d=o.bottomOverlay.sumCellSizes(u-h,u),l-=d),a.holder.clientHeight===a.holder.offsetHeight?p=0:p=Pr(s),new S3({viewportSize:l,scrollOffset:g,totalItems:n.getSetting("totalRows"),itemSizeFn:function(c){return a.getRowHeight(c)},overrideFn:i.settings.viewportRowCalculatorOverride,calculationType:e,scrollbarHeight:p})}},{key:"createColumnsCalculator",value:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:xa,n=this.wot,i=n.wtSettings,o=n.wtOverlays,a=n.wtTable,s=n.rootDocument,l=this.getViewportWidth(),p=o.leftOverlay.getScrollPosition()-o.leftOverlay.getTableParentOffset();this.columnHeaderHeight=NaN,p<0&&(p=0);var d=n.getSetting("fixedColumnsLeft");if(d){var g=o.leftOverlay.sumCellSizes(0,d);p+=g,l-=g}return a.holder.clientWidth!==a.holder.offsetWidth&&(l-=Pr(s)),new I0({viewportSize:l,scrollOffset:p,totalItems:n.getSetting("totalColumns"),itemSizeFn:function(h){return n.wtTable.getColumnWidth(h)},overrideFn:i.settings.viewportColumnCalculatorOverride,calculationType:e,stretchMode:n.getSetting("stretchH"),stretchingItemWidthFn:function(h,u){return n.getSetting("onBeforeStretchingColumnWidth",h,u)}})}},{key:"createRenderCalculators",value:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,n=e;if(n){var i=this.createRowsCalculator(On),o=this.createColumnsCalculator(On);this.areAllProposedVisibleRowsAlreadyRendered(i)&&this.areAllProposedVisibleColumnsAlreadyRendered(o)||(n=!1)}return n||(this.rowsRenderCalculator=this.createRowsCalculator(xa),this.columnsRenderCalculator=this.createColumnsCalculator(xa)),this.rowsVisibleCalculator=null,this.columnsVisibleCalculator=null,n}},{key:"createVisibleCalculators",value:function(){this.rowsVisibleCalculator=this.createRowsCalculator(On),this.columnsVisibleCalculator=this.createColumnsCalculator(On)}},{key:"areAllProposedVisibleRowsAlreadyRendered",value:function(e){if(!this.rowsVisibleCalculator)return!1;var n=e.startRow,i=e.endRow,o=this.rowsRenderCalculator,a=o.startRow,s=o.endRow;return n<a||n===a&&n>0?!1:!(i>s||i===s&&i<this.wot.getSetting("totalRows")-1)}},{key:"areAllProposedVisibleColumnsAlreadyRendered",value:function(e){if(!this.columnsVisibleCalculator)return!1;var n=e.startColumn,i=e.endColumn,o=this.columnsRenderCalculator,a=o.startColumn,s=o.endColumn;return n<a||n===a&&n>0?!1:!(i>s||i===s&&i<this.wot.getSetting("totalColumns")-1)}},{key:"resetHasOversizedColumnHeadersMarked",value:function(){Ot(this.hasOversizedColumnHeadersMarked,function(e,n,i){i[n]=void 0})}}]),t}(),Ine=Pne;function Dne(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}function L6(t,r){for(var e=0;e<r.length;e++){var n=r[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function Nne(t,r,e){return r&&L6(t.prototype,r),e&&L6(t,e),t}var $ne=function(){function t(r){Dne(this,t);var e=[];if(this.guid="wt_".concat(y0()),this.rootDocument=r.table.ownerDocument,this.rootWindow=this.rootDocument.defaultView,r.cloneSource?(this.cloneSource=r.cloneSource,this.cloneOverlay=r.cloneOverlay,this.wtSettings=r.cloneSource.wtSettings,this.wtTable=this.cloneOverlay.createTable(this,r.table),this.wtScroll=new N6(this),this.wtViewport=r.cloneSource.wtViewport,this.wtEvent=new M6(this),this.selections=this.cloneSource.selections):(this.wtSettings=new xne(this,r),this.wtTable=new Mte(this,r.table),this.wtScroll=new N6(this),this.wtViewport=new Ine(this),this.wtEvent=new M6(this),this.selections=this.getSetting("selections"),this.wtOverlays=new Sne(this),this.exportSettingsAsClassNames()),this.wtTable.THEAD.childNodes.length&&this.wtTable.THEAD.childNodes[0].childNodes.length){for(var n=0,i=this.wtTable.THEAD.childNodes[0].childNodes.length;n<i;n++)e.push(this.wtTable.THEAD.childNodes[0].childNodes[n].innerHTML);this.getSetting("columnHeaders").length||this.update("columnHeaders",[function(o,a){Mo(a,e[o])}])}this.drawn=!1,this.drawInterrupted=!1}return Nne(t,[{key:"draw",value:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return this.drawInterrupted=!1,!e&&!this.wtTable.isVisible()?this.drawInterrupted=!0:this.wtTable.draw(e),this}},{key:"getCell",value:function(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(!n)return this.wtTable.getCell(e);var i=this.wtSettings.getSetting("totalRows"),o=this.wtSettings.getSetting("fixedRowsTop"),a=this.wtSettings.getSetting("fixedRowsBottom"),s=this.wtSettings.getSetting("fixedColumnsLeft");if(e.row<o&&e.col<s)return this.wtOverlays.topLeftCornerOverlay.clone.wtTable.getCell(e);if(e.row<o)return this.wtOverlays.topOverlay.clone.wtTable.getCell(e);if(e.col<s&&e.row>=i-a){if(this.wtOverlays.bottomLeftCornerOverlay&&this.wtOverlays.bottomLeftCornerOverlay.clone)return this.wtOverlays.bottomLeftCornerOverlay.clone.wtTable.getCell(e)}else{if(e.col<s)return this.wtOverlays.leftOverlay.clone.wtTable.getCell(e);if(e.row<i&&e.row>=i-a&&this.wtOverlays.bottomOverlay&&this.wtOverlays.bottomOverlay.clone)return this.wtOverlays.bottomOverlay.clone.wtTable.getCell(e)}return this.wtTable.getCell(e)}},{key:"update",value:function(e,n){return this.wtSettings.update(e,n)}},{key:"scrollViewport",value:function(e,n,i,o,a){return e.col<0||e.row<0?!1:this.wtScroll.scrollViewport(e,n,i,o,a)}},{key:"scrollViewportHorizontally",value:function(e,n,i){return e<0?!1:this.wtScroll.scrollViewportHorizontally(e,n,i)}},{key:"scrollViewportVertically",value:function(e,n,i){return e<0?!1:this.wtScroll.scrollViewportVertically(e,n,i)}},{key:"getViewport",value:function(){return[this.wtTable.getFirstVisibleRow(),this.wtTable.getFirstVisibleColumn(),this.wtTable.getLastVisibleRow(),this.wtTable.getLastVisibleColumn()]}},{key:"getOverlayName",value:function(){return this.cloneOverlay?this.cloneOverlay.type:"master"}},{key:"exportSettingsAsClassNames",value:function(){var e=this,n={rowHeaders:"htRowHeaders",columnHeaders:"htColumnHeaders"},i=[],o=[];Ot(n,function(a,s){e.getSetting(s).length&&o.push(a),i.push(a)}),dt(this.wtTable.wtRootElement.parentNode,i),Ie(this.wtTable.wtRootElement.parentNode,o)}},{key:"getSetting",value:function(e,n,i,o,a){return this.wtSettings.getSetting(e,n,i,o,a)}},{key:"hasSetting",value:function(e){return this.wtSettings.has(e)}},{key:"destroy",value:function(){this.wtOverlays.destroy(),this.wtEvent.destroy()}}]),t}(),jne=$ne,Lne=Dr,H6=ht,Hne=wl,Fne=an,Bne=al.f,Vne=H6(Bne),Wne=H6([].push),F6=function(t){return function(r){for(var e=Fne(r),n=Hne(e),i=n.length,o=0,a=[],s;i>o;)s=n[o++],(!Lne||Vne(e,s))&&Wne(a,t?[s,e[s]]:e[s]);return a}},Une={entries:F6(!0),values:F6(!1)},zne=pt,Yne=Une.values;zne({target:"Object",stat:!0},{values:function(r){return Yne(r)}});function Gne(t,r){return Zne(t)||Xne(t,r)||qne(t,r)||Kne()}function Kne(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function qne(t,r){if(!!t){if(typeof t=="string")return B6(t,r);var e=Object.prototype.toString.call(t).slice(8,-1);if(e==="Object"&&t.constructor&&(e=t.constructor.name),e==="Map"||e==="Set")return Array.from(t);if(e==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return B6(t,r)}}function B6(t,r){(r==null||r>t.length)&&(r=t.length);for(var e=0,n=new Array(r);e<r;e++)n[e]=t[e];return n}function Xne(t,r){var e=t==null?null:typeof Symbol!="undefined"&&t[Symbol.iterator]||t["@@iterator"];if(e!=null){var n=[],i=!0,o=!1,a,s;try{for(e=e.call(t);!(i=(a=e.next()).done)&&(n.push(a.value),!(r&&n.length===r));i=!0);}catch(l){o=!0,s=l}finally{try{!i&&e.return!=null&&e.return()}finally{if(o)throw s}}return n}}function Zne(t){if(Array.isArray(t))return t}function Kd(t){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?Kd=function(e){return typeof e}:Kd=function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Kd(t)}function Jne(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}function V6(t,r){for(var e=0;e<r.length;e++){var n=r[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function Qne(t,r,e){return r&&V6(t.prototype,r),e&&V6(t,e),t}var eie=function(){function t(r,e){Jne(this,t),this.settings=r,this.cellRange=e||null,this.instanceBorders={},this.classNames=[this.settings.className],this.classNameGenerator=this.linearClassNameGenerator(this.settings.className,this.settings.layerLevel)}return Qne(t,[{key:"getBorder",value:function(e){return this.instanceBorders[e.guid]||(this.instanceBorders[e.guid]=new hne(e,this.settings)),this.instanceBorders[e.guid]}},{key:"isEmpty",value:function(){return this.cellRange===null}},{key:"add",value:function(e){return this.isEmpty()?this.cellRange=new Rr(e):this.cellRange.expand(e),this}},{key:"replace",value:function(e,n){if(!this.isEmpty()){if(this.cellRange.from.isEqual(e))return this.cellRange.from=n,!0;if(this.cellRange.to.isEqual(e))return this.cellRange.to=n,!0}return!1}},{key:"clear",value:function(){return this.cellRange=null,this}},{key:"getCorners",value:function(){var e=this.cellRange.getOuterTopLeftCorner(),n=this.cellRange.getOuterBottomRightCorner();return[e.row,e.col,n.row,n.col]}},{key:"addClassAtCoords",value:function(e,n,i,o){var a=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!1,s=e.wtTable.getCell(new ke(n,i));if(Kd(s)==="object"){var l=o;a&&(l=this.classNameGenerator(s),this.classNames.includes(l)||this.classNames.push(l)),Ie(s,l)}return this}},{key:"linearClassNameGenerator",value:function(e,n){return function i(o){var a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:-1;if(n===0||a===0)return e;var s=a>=0?a:n,l=e;s-=1;var p=s===0?e:"".concat(e,"-").concat(s);if(lt(o,p)){var d=s+1;l="".concat(e,"-").concat(d)}else l=i(o,s);return l}}},{key:"draw",value:function(e){if(this.isEmpty()){this.settings.border&&this.getBorder(e).disappear();return}var n=e.wtTable.getRenderedRowsCount(),i=e.wtTable.getRenderedColumnsCount(),o=this.getCorners(),a=Gne(o,4),s=a[0],l=a[1],p=a[2],d=a[3],g=this.settings,y=g.highlightHeaderClassName,h=g.highlightColumnClassName,u=g.highlightRowClassName,f=g.highlightOnlyClosestHeader,c=g.selectionType,v=c===void 0||["active-header","header"].includes(c);if(v&&l!==null&&d!==null)for(var m=0,b=0;b<i;b+=1){var w=e.wtTable.columnFilter.renderedToSource(b);if(w>=l&&w<=d){var _=e.wtTable.getColumnHeaders(w),C=_.length-1;f&&_.length>1&&(_=[_[C]]);for(var R=0;R<_.length;R+=1){var I=[],P=_[R];y&&I.push(y),h&&I.push(h),R=f?C:R;var N=e.getSetting("onBeforeHighlightingColumnHeader",w,R,{selectionType:c,columnCursor:m,selectionWidth:d-l+1,classNames:I});N!==w&&(P=e.wtTable.getColumnHeader(N,R)),Ie(P,I)}m+=1}}if(s!==null&&p!==null)for(var A=0,$=0;$<n;$+=1){var T=e.wtTable.rowFilter.renderedToSource($);if(v&&T>=s&&T<=p){var M=e.wtTable.getRowHeaders(T),S=M.length-1;f&&M.length>1&&(M=[M[S]]);for(var E=0;E<M.length;E+=1){var k=[],O=M[E];y&&k.push(y),u&&k.push(u),E=f?S:E;var x=e.getSetting("onBeforeHighlightingRowHeader",T,E,{selectionType:c,rowCursor:A,selectionHeight:p-s+1,classNames:k});x!==T&&(O=e.wtTable.getRowHeader(x,E)),Ie(O,k)}A+=1}if(l!==null&&d!==null)for(var j=0;j<i;j+=1){var H=e.wtTable.columnFilter.renderedToSource(j);T>=s&&T<=p&&H>=l&&H<=d?this.settings.className&&this.addClassAtCoords(e,T,H,this.settings.className,this.settings.markIntersections):T>=s&&T<=p?u&&this.addClassAtCoords(e,T,H,u):H>=l&&H<=d&&h&&this.addClassAtCoords(e,T,H,h);var F=e.getSetting("onAfterDrawSelection",T,H,this.settings.layerLevel);typeof F=="string"&&this.addClassAtCoords(e,T,H,F)}}e.getSetting("onBeforeDrawBorders",o,this.settings.className),this.settings.border&&this.getBorder(e).appear(o)}},{key:"destroy",value:function(){Object.values(this.instanceBorders).forEach(function(e){return e.destroy()})}}]),t}(),tie=eie,W6;function rie(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}function U6(t,r){for(var e=0;e<r.length;e++){var n=r[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function nie(t,r,e){return r&&U6(t.prototype,r),e&&U6(t,e),t}function iie(t,r){return r||(r=t.slice(0)),Object.freeze(Object.defineProperties(t,{raw:{value:Object.freeze(r)}}))}var ou=["afterCellMetaReset","afterChange","afterContextMenuDefaultOptions","beforeContextMenuSetItems","afterDropdownMenuDefaultOptions","beforeDropdownMenuSetItems","afterContextMenuHide","beforeContextMenuShow","afterContextMenuShow","afterCopyLimit","beforeCreateCol","afterCreateCol","beforeCreateRow","afterCreateRow","afterDeselect","afterDestroy","afterDocumentKeyDown","afterDrawSelection","beforeRemoveCellClassNames","afterGetCellMeta","afterGetColHeader","afterGetRowHeader","afterInit","afterLoadData","afterMomentumScroll","afterOnCellCornerMouseDown","afterOnCellCornerDblClick","afterOnCellMouseDown","afterOnCellMouseUp","afterOnCellContextMenu","afterOnCellMouseOver","afterOnCellMouseOut","afterRemoveCol","afterRemoveRow","beforeRenderer","afterRenderer","afterScrollHorizontally","afterScrollVertically","afterSelection","afterSelectionByProp","afterSelectionEnd","afterSelectionEndByProp","afterSetCellMeta","afterRemoveCellMeta","afterSetDataAtCell","afterSetDataAtRowProp","afterSetSourceDataAtCell","afterUpdateSettings","afterValidate","beforeLanguageChange","afterLanguageChange","beforeAutofill","afterAutofill","beforeCellAlignment","beforeChange","beforeChangeRender","beforeDrawBorders","beforeGetCellMeta","beforeRemoveCellMeta","beforeInit","beforeInitWalkontable","beforeLoadData","beforeKeyDown","beforeOnCellMouseDown","beforeOnCellMouseUp","beforeOnCellContextMenu","beforeOnCellMouseOver","beforeOnCellMouseOut","beforeRemoveCol","beforeRemoveRow","beforeViewRender","afterViewRender","beforeRender","afterRender","beforeSetCellMeta","beforeSetRangeStartOnly","beforeSetRangeStart","beforeSetRangeEnd","beforeTouchScroll","beforeValidate","beforeValueRender","construct","init","modifyColHeader","modifyColWidth","modifyRowHeader","modifyRowHeight","modifyData","modifySourceData","modifyRowData","modifyGetCellCoords","beforeHighlightingRowHeader","beforeHighlightingColumnHeader","persistentStateLoad","persistentStateReset","persistentStateSave","beforeColumnSort","afterColumnSort","modifyAutofillRange","modifyCopyableRange","beforeCut","afterCut","beforeCopy","afterCopy","beforePaste","afterPaste","beforeColumnMove","afterColumnMove","beforeRowMove","afterRowMove","beforeColumnResize","afterColumnResize","beforeRowResize","afterRowResize","afterGetColumnHeaderRenderers","afterGetRowHeaderRenderers","beforeStretchingColumnWidth","beforeFilter","afterFilter","afterFormulasValuesUpdate","afterNamedExpressionAdded","afterNamedExpressionRemoved","afterSheetAdded","afterSheetRenamed","afterSheetRemoved","modifyColumnHeaderHeight","beforeUndo","beforeUndoStackChange","afterUndo","afterUndoStackChange","beforeRedo","beforeRedoStackChange","afterRedo","afterRedoStackChange","modifyRowHeaderWidth","beforeAutofillInsidePopulate","modifyTransformStart","modifyTransformEnd","afterModifyTransformStart","afterModifyTransformEnd","afterViewportRowCalculatorOverride","afterViewportColumnCalculatorOverride","afterPluginsInitialized","beforeHideRows","afterHideRows","beforeUnhideRows","afterUnhideRows","beforeHideColumns","afterHideColumns","beforeUnhideColumns","afterUnhideColumns","beforeTrimRow","afterTrimRow","beforeUntrimRow","afterUntrimRow","beforeDropdownMenuShow","afterDropdownMenuShow","afterDropdownMenuHide","beforeAddChild","afterAddChild","beforeDetachChild","afterDetachChild","afterBeginEditing","beforeMergeCells","afterMergeCells","beforeUnmergeCells","afterUnmergeCells","afterListen","afterUnlisten","afterRefreshDimensions","beforeRefreshDimensions","beforeColumnCollapse","afterColumnCollapse","beforeColumnExpand","afterColumnExpand","modifyAutoColumnSizeSeed"],oie=Kt(W6||(W6=iie([`The plugin hook "[hookName]" was removed in Handsontable [removedInVersion]. 
  Please consult release notes https://github.com/handsontable/handsontable/releases/tag/[removedInVersion] to 
  learn about the migration path.`],[`The plugin hook "[hookName]" was removed in Handsontable [removedInVersion].\\x20
  Please consult release notes https://github.com/handsontable/handsontable/releases/tag/[removedInVersion] to\\x20
  learn about the migration path.`]))),fw=new Map([["modifyRow","8.0.0"],["modifyCol","8.0.0"],["unmodifyRow","8.0.0"],["unmodifyCol","8.0.0"],["skipLengthCache","8.0.0"],["hiddenColumn","8.0.0"],["hiddenRow","8.0.0"]]),cw=new Map([["beforeAutofillInsidePopulate",'The plugin hook "beforeAutofillInsidePopulate" is deprecated and will be removed in the next major release.']]),z6=function(){function t(){rie(this,t),this.globalBucket=this.createEmptyBucket()}return nie(t,[{key:"createEmptyBucket",value:function(){var e=Object.create(null);return he(ou,function(n){return e[n]=[]}),e}},{key:"getBucket",value:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return e?(e.pluginHookBucket||(e.pluginHookBucket=this.createEmptyBucket()),e.pluginHookBucket):this.globalBucket}},{key:"add",value:function(e,n){var i=this,o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null;if(Array.isArray(n))he(n,function(l){return i.add(e,l,o)});else{fw.has(e)&&tr(v0(oie,{hookName:e,removedInVersion:fw.get(e)})),cw.has(e)&&tr(cw.get(e));var a=this.getBucket(o);if(typeof a[e]=="undefined"&&(this.register(e),a[e]=[]),n.skip=!1,a[e].indexOf(n)===-1){var s=!1;n.initialHook&&he(a[e],function(l,p){if(l.initialHook)return a[e][p]=n,s=!0,!1}),s||a[e].push(n)}}return this}},{key:"once",value:function(e,n){var i=this,o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null;Array.isArray(n)?he(n,function(a){return i.once(e,a,o)}):(n.runOnce=!0,this.add(e,n,o))}},{key:"remove",value:function(e,n){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null,o=this.getBucket(i);return typeof o[e]!="undefined"&&o[e].indexOf(n)>=0?(n.skip=!0,!0):!1}},{key:"has",value:function(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,i=this.getBucket(n);return!!(i[e]!==void 0&&i[e].length)}},{key:"run",value:function(e,n,i,o,a,s,l,p){{var d=this.globalBucket[n],g=d?d.length:0,y=0;if(g)for(;y<g;){if(!d[y]||d[y].skip){y+=1;continue}var h=Yh(d[y],e,i,o,a,s,l,p);h!==void 0&&(i=h),d[y]&&d[y].runOnce&&this.remove(n,d[y]),y+=1}}{var u=this.getBucket(e)[n],f=u?u.length:0,c=0;if(f)for(;c<f;){if(!u[c]||u[c].skip){c+=1;continue}var v=Yh(u[c],e,i,o,a,s,l,p);v!==void 0&&(i=v),u[c]&&u[c].runOnce&&this.remove(n,u[c],e),c+=1}}return i}},{key:"destroy",value:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;Ot(this.getBucket(e),function(n,i,o){return o[i].length=0})}},{key:"register",value:function(e){this.isRegistered(e)||ou.push(e)}},{key:"deregister",value:function(e){this.isRegistered(e)&&ou.splice(ou.indexOf(e),1)}},{key:"isDeprecated",value:function(e){return cw.has(e)||fw.has(e)}},{key:"isRegistered",value:function(e){return ou.indexOf(e)>=0}},{key:"getRegistered",value:function(){return ou}}],[{key:"getSingleton",value:function(){return sie()}}]),t}(),aie=new z6;function sie(){return aie}var Ze=z6;function Y6(t){return cie(t)||fie(t)||lie(t)||uie()}function uie(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function lie(t,r){if(!!t){if(typeof t=="string")return hw(t,r);var e=Object.prototype.toString.call(t).slice(8,-1);if(e==="Object"&&t.constructor&&(e=t.constructor.name),e==="Map"||e==="Set")return Array.from(t);if(e==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return hw(t,r)}}function fie(t){if(typeof Symbol!="undefined"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function cie(t){if(Array.isArray(t))return hw(t)}function hw(t,r){(r==null||r>t.length)&&(r=t.length);for(var e=0,n=new Array(r);e<r;e++)n[e]=t[e];return n}var dw=new Map;function Rn(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"common";dw.has(t)||dw.set(t,new Map);var r=dw.get(t);function e(s,l){r.set(s,l)}function n(s){return r.get(s)}function i(s){return r.has(s)}function o(){return Y6(r.keys())}function a(){return Y6(r.values())}return{register:e,getItem:n,hasItem:i,getNames:o,getValues:a}}var pw=new WeakMap,wf=Rn("editors"),hie=wf.register,G6=wf.getItem,K6=wf.hasItem,die=wf.getNames;wf.getValues;function pie(t){var r={},e=t;this.getConstructor=function(){return t},this.getInstance=function(n){return n.guid in r||(r[n.guid]=new e(n)),r[n.guid]},Ze.getSingleton().add("afterDestroy",function(){r[this.guid]=null})}function q6(t,r){var e;if(typeof t=="function")pw.get(t)||hn(null,t),e=pw.get(t);else if(typeof t=="string")e=G6(t);else throw Error('Only strings and functions can be passed as "editor" parameter');if(!e)throw Error('No editor registered under name "'.concat(t,'"'));return e.getInstance(r)}function X6(t){if(!K6(t))throw Error('No registered editor found under "'.concat(t,'" name'));return G6(t).getConstructor()}function hn(t,r){t&&typeof t!="string"&&(r=t,t=r.EDITOR_TYPE);var e=new pie(r);typeof t=="string"&&hie(t,e),pw.set(r,e)}var yie="hooksRefRegisterer",Z6={_hooksStorage:Object.create(null),addHook:function(r,e){return this._hooksStorage[r]||(this._hooksStorage[r]=[]),this.hot.addHook(r,e),this._hooksStorage[r].push(e),this},removeHooksByKey:function(r){var e=this;he(this._hooksStorage[r]||[],function(n){e.hot.removeHook(r,n)})},clearHooks:function(){var r=this;Ot(this._hooksStorage,function(e,n){return r.removeHooksByKey(n)}),this._hooksStorage={}}};Gn(Z6,"MIXIN_NAME",yie,{writable:!1,enumerable:!1});var mie=Z6;function qd(t){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?qd=function(e){return typeof e}:qd=function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},qd(t)}function vie(t,r){return _ie(t)||wie(t,r)||bie(t,r)||gie()}function gie(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function bie(t,r){if(!!t){if(typeof t=="string")return J6(t,r);var e=Object.prototype.toString.call(t).slice(8,-1);if(e==="Object"&&t.constructor&&(e=t.constructor.name),e==="Map"||e==="Set")return Array.from(t);if(e==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return J6(t,r)}}function J6(t,r){(r==null||r>t.length)&&(r=t.length);for(var e=0,n=new Array(r);e<r;e++)n[e]=t[e];return n}function wie(t,r){var e=t==null?null:typeof Symbol!="undefined"&&t[Symbol.iterator]||t["@@iterator"];if(e!=null){var n=[],i=!0,o=!1,a,s;try{for(e=e.call(t);!(i=(a=e.next()).done)&&(n.push(a.value),!(r&&n.length===r));i=!0);}catch(l){o=!0,s=l}finally{try{!i&&e.return!=null&&e.return()}finally{if(o)throw s}}return n}}function _ie(t){if(Array.isArray(t))return t}function Sie(t,r){if(typeof r!="function"&&r!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(r&&r.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),r&&yw(t,r)}function yw(t,r){return yw=Object.setPrototypeOf||function(n,i){return n.__proto__=i,n},yw(t,r)}function Cie(t){var r=Rie();return function(){var n=Xd(t),i;if(r){var o=Xd(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return kie(this,i)}}function kie(t,r){if(r&&(qd(r)==="object"||typeof r=="function"))return r;if(r!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Oie(t)}function Oie(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Rie(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Xd(t){return Xd=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},Xd(t)}function Q6(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}function eA(t,r){for(var e=0;e<r.length;e++){var n=r[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function Eie(t,r,e){return r&&eA(t.prototype,r),e&&eA(t,e),t}var Tie="base",Ir=Object.freeze({VIRGIN:"STATE_VIRGIN",EDITING:"STATE_EDITING",WAITING:"STATE_WAITING",FINISHED:"STATE_FINISHED"}),au=function(){function t(r){Q6(this,t),this.hot=r,this.instance=r,this.state=Ir.VIRGIN,this._opened=!1,this._fullEditMode=!1,this._closeCallback=null,this.TD=null,this.row=null,this.col=null,this.prop=null,this.originalValue=null,this.cellProperties=null,this.init()}return Eie(t,[{key:"_fireCallbacks",value:function(e){this._closeCallback&&(this._closeCallback(e),this._closeCallback=null)}},{key:"init",value:function(){}},{key:"getValue",value:function(){throw Error("Editor getValue() method unimplemented")}},{key:"setValue",value:function(){throw Error("Editor setValue() method unimplemented")}},{key:"open",value:function(){throw Error("Editor open() method unimplemented")}},{key:"close",value:function(){throw Error("Editor close() method unimplemented")}},{key:"prepare",value:function(e,n,i,o,a,s){this.TD=o,this.row=e,this.col=n,this.prop=i,this.originalValue=a,this.cellProperties=s,this.state=Ir.VIRGIN}},{key:"extend",value:function(){return function(e){Sie(i,e);var n=Cie(i);function i(){return Q6(this,i),n.apply(this,arguments)}return i}(this.constructor)}},{key:"saveValue",value:function(e,n){var i,o,a,s;if(n){var l=this.hot.getSelectedLast();i=Math.max(Math.min(l[0],l[2]),0),o=Math.max(Math.min(l[1],l[3]),0),a=Math.max(l[0],l[2]),s=Math.max(l[1],l[3])}else{var p=[this.row,this.col,null,null];i=p[0],o=p[1],a=p[2],s=p[3]}var d=this.hot.runHooks("modifyGetCellCoords",i,o);if(Array.isArray(d)){var g=vie(d,2);i=g[0],o=g[1]}this.hot.populateFromArray(i,o,e,a,s,"edit")}},{key:"beginEditing",value:function(e,n){if(this.state===Ir.VIRGIN){var i=this.hot,o=i.rowIndexMapper.getRenderableFromVisualIndex(this.row),a=i.columnIndexMapper.getRenderableFromVisualIndex(this.col);if(i.view.scrollViewport(new ke(o,a)),this.state=Ir.EDITING,this.isInFullEditMode()){var s=typeof e=="string"?e:lr(this.originalValue);this.setValue(s)}this.open(n),this._opened=!0,this.focus(),i.view.render(),i.runHooks("afterBeginEditing",this.row,this.col)}}},{key:"finishEditing",value:function(e,n,i){var o=this,a;if(i){var s=this._closeCallback;this._closeCallback=function(p){s&&s(p),i(p),o.hot.view.render()}}if(!this.isWaiting()){if(this.state===Ir.VIRGIN){this.hot._registerTimeout(function(){o._fireCallbacks(!0)});return}if(this.state===Ir.EDITING){if(e){this.cancelChanges(),this.hot.view.render();return}var l=this.getValue();this.hot.getSettings().trimWhitespace?a=[[typeof l=="string"?String.prototype.trim.call(l||""):l]]:a=[[l]],this.state=Ir.WAITING,this.saveValue(a,n),this.hot.getCellValidator(this.cellProperties)?this.hot.addHookOnce("postAfterValidate",function(p){o.state=Ir.FINISHED,o.discardEditor(p)}):(this.state=Ir.FINISHED,this.discardEditor(!0))}}}},{key:"cancelChanges",value:function(){this.state=Ir.FINISHED,this.discardEditor()}},{key:"discardEditor",value:function(e){this.state===Ir.FINISHED&&(e===!1&&this.cellProperties.allowInvalid!==!0?(this.hot.selectCell(this.row,this.col),this.focus(),this.state=Ir.EDITING,this._fireCallbacks(!1)):(this.close(),this._opened=!1,this._fullEditMode=!1,this.state=Ir.VIRGIN,this._fireCallbacks(!0)))}},{key:"enableFullEditMode",value:function(){this._fullEditMode=!0}},{key:"isInFullEditMode",value:function(){return this._fullEditMode}},{key:"isOpened",value:function(){return this._opened}},{key:"isWaiting",value:function(){return this.state===Ir.WAITING}},{key:"getEditedCellsLayerClass",value:function(){var e=this.checkEditorSection();switch(e){case"right":return"ht_clone_right";case"left":return"ht_clone_left";case"bottom":return"ht_clone_bottom";case"bottom-right-corner":return"ht_clone_bottom_right_corner";case"bottom-left-corner":return"ht_clone_bottom_left_corner";case"top":return"ht_clone_top";case"top-right-corner":return"ht_clone_top_right_corner";case"top-left-corner":return"ht_clone_top_left_corner";default:return"ht_clone_master"}}},{key:"getEditedCell",value:function(){return this.hot.getCell(this.row,this.col,!0)}},{key:"checkEditorSection",value:function(){var e=this.hot.countRows(),n="";return this.row<this.hot.getSettings().fixedRowsTop?this.col<this.hot.getSettings().fixedColumnsLeft?n="top-left-corner":n="top":this.hot.getSettings().fixedRowsBottom&&this.row>=e-this.hot.getSettings().fixedRowsBottom?this.col<this.hot.getSettings().fixedColumnsLeft?n="bottom-left-corner":n="bottom":this.col<this.hot.getSettings().fixedColumnsLeft&&(n="left"),n}}],[{key:"EDITOR_TYPE",get:function(){return Tie}}]),t}();Ut(au,mie);function xie(t,r){return Iie(t)||Pie(t,r)||Mie(t,r)||Aie()}function Aie(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Mie(t,r){if(!!t){if(typeof t=="string")return tA(t,r);var e=Object.prototype.toString.call(t).slice(8,-1);if(e==="Object"&&t.constructor&&(e=t.constructor.name),e==="Map"||e==="Set")return Array.from(t);if(e==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return tA(t,r)}}function tA(t,r){(r==null||r>t.length)&&(r=t.length);for(var e=0,n=new Array(r);e<r;e++)n[e]=t[e];return n}function Pie(t,r){var e=t==null?null:typeof Symbol!="undefined"&&t[Symbol.iterator]||t["@@iterator"];if(e!=null){var n=[],i=!0,o=!1,a,s;try{for(e=e.call(t);!(i=(a=e.next()).done)&&(n.push(a.value),!(r&&n.length===r));i=!0);}catch(l){o=!0,s=l}finally{try{!i&&e.return!=null&&e.return()}finally{if(o)throw s}}return n}}function Iie(t){if(Array.isArray(t))return t}function Die(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}function rA(t,r){for(var e=0;e<r.length;e++){var n=r[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function Nie(t,r,e){return r&&rA(t.prototype,r),e&&rA(t,e),t}var mw=function(){function t(r,e,n){var i=this;Die(this,t),this.instance=r,this.tableMeta=e,this.selection=n,this.eventManager=new Wt(r),this.destroyed=!1,this.lock=!1,this.activeEditor=void 0,this.cellProperties=void 0,this.lastKeyCode=void 0,this.instance.addHook("afterDocumentKeyDown",function(a){return i.onAfterDocumentKeyDown(a)});for(var o=this.instance.rootWindow;o;)this.eventManager.addEventListener(o.document.documentElement,"keydown",function(a){i.destroyed||i.instance.runHooks("afterDocumentKeyDown",a)}),o=Bh(o);this.eventManager.addEventListener(this.instance.rootDocument.documentElement,"compositionstart",function(a){!i.destroyed&&i.activeEditor&&!i.activeEditor.isOpened()&&i.instance.isListening()&&i.openEditor("",a)}),this.instance.view.wt.update("onCellDblClick",function(a,s,l){return i.onCellDblClick(a,s,l)})}return Nie(t,[{key:"lockEditor",value:function(){this.lock=!0}},{key:"unlockEditor",value:function(){this.lock=!1}},{key:"destroyEditor",value:function(e){this.lock||this.closeEditor(e)}},{key:"getActiveEditor",value:function(){return this.activeEditor}},{key:"prepareEditor",value:function(){var e=this;if(!this.lock){if(this.activeEditor&&this.activeEditor.isWaiting()){this.closeEditor(!1,!1,function(f){f&&e.prepareEditor()});return}var n=this.instance.selection.selectedRange.current().highlight,i=n.row,o=n.col,a=this.instance.runHooks("modifyGetCellCoords",i,o),s=i,l=o;if(Array.isArray(a)){var p=xie(a,2);s=p[0],l=p[1]}this.cellProperties=this.instance.getCellMeta(s,l);var d=this.instance.rootDocument.activeElement;if(d&&d.blur(),this.cellProperties.readOnly){this.clearActiveEditor();return}var g=this.instance.getCellEditor(this.cellProperties),y=this.instance.getCell(i,o,!0);if(g&&y){var h=this.instance.colToProp(l),u=this.instance.getSourceDataAtCell(this.instance.toPhysicalRow(s),l);this.activeEditor=q6(g,this.instance),this.activeEditor.prepare(i,o,h,y,u,this.cellProperties)}else this.clearActiveEditor()}}},{key:"isEditorOpened",value:function(){return this.activeEditor&&this.activeEditor.isOpened()}},{key:"openEditor",value:function(e,n){!this.activeEditor||this.activeEditor.beginEditing(e,n)}},{key:"closeEditor",value:function(e,n,i){this.activeEditor?this.activeEditor.finishEditing(e,n,i):i&&i(!1)}},{key:"closeEditorAndSaveChanges",value:function(e){this.closeEditor(!1,e)}},{key:"closeEditorAndRestoreOriginalValue",value:function(e){this.closeEditor(!0,e)}},{key:"clearActiveEditor",value:function(){this.activeEditor=void 0}},{key:"moveSelectionAfterEnter",value:function(e){var n=typeof this.tableMeta.enterMoves=="function"?this.tableMeta.enterMoves(event):this.tableMeta.enterMoves;e?this.selection.transformStart(-n.row,-n.col):this.selection.transformStart(n.row,n.col,!0)}},{key:"moveSelectionUp",value:function(e){e?this.selection.transformEnd(-1,0):this.selection.transformStart(-1,0)}},{key:"moveSelectionDown",value:function(e){e?this.selection.transformEnd(1,0):this.selection.transformStart(1,0)}},{key:"moveSelectionRight",value:function(e){e?this.selection.transformEnd(0,this.instance.getDirectionFactor()):this.selection.transformStart(0,this.instance.getDirectionFactor())}},{key:"moveSelectionLeft",value:function(e){e?this.selection.transformEnd(0,-1*this.instance.getDirectionFactor()):this.selection.transformStart(0,-1*this.instance.getDirectionFactor())}},{key:"onAfterDocumentKeyDown",value:function(e){if(!!this.instance.isListening()){this.instance.runHooks("beforeKeyDown",e);var n=e.keyCode;if(!(this.destroyed||n===229)&&!Fn(e)&&(this.lastKeyCode=n,!!this.selection.isSelected())){var i=(e.ctrlKey||e.metaKey)&&!e.altKey;if(this.activeEditor&&!this.activeEditor.isWaiting()&&!uw(n)&&!lw(n)&&!i&&!this.isEditorOpened()){this.openEditor("",e);return}var o=e.shiftKey,a=o?this.selection.setRangeEnd:this.selection.setRangeStart,s;switch(n){case De.A:!this.isEditorOpened()&&i&&(this.instance.selectAll(),e.preventDefault(),e.stopPropagation());break;case De.ARROW_UP:this.isEditorOpened()&&!this.activeEditor.isWaiting()&&this.closeEditorAndSaveChanges(i),this.moveSelectionUp(o),e.preventDefault(),e.stopPropagation();break;case De.ARROW_DOWN:this.isEditorOpened()&&!this.activeEditor.isWaiting()&&this.closeEditorAndSaveChanges(i),this.moveSelectionDown(o),e.preventDefault(),e.stopPropagation();break;case De.ARROW_RIGHT:this.isEditorOpened()&&!this.activeEditor.isWaiting()&&this.closeEditorAndSaveChanges(i),this.moveSelectionRight(o),e.preventDefault(),e.stopPropagation();break;case De.ARROW_LEFT:this.isEditorOpened()&&!this.activeEditor.isWaiting()&&this.closeEditorAndSaveChanges(i),this.moveSelectionLeft(o),e.preventDefault(),e.stopPropagation();break;case De.TAB:s=typeof this.tableMeta.tabMoves=="function"?this.tableMeta.tabMoves(e):this.tableMeta.tabMoves,o?this.selection.transformStart(-s.row,-s.col):this.selection.transformStart(s.row,s.col,!0),e.preventDefault(),e.stopPropagation();break;case De.BACKSPACE:case De.DELETE:this.instance.emptySelectedCells(),this.prepareEditor(),e.preventDefault();break;case De.F2:this.activeEditor&&this.activeEditor.enableFullEditMode(),this.openEditor(null,e),e.preventDefault();break;case De.ENTER:this.isEditorOpened()?(this.activeEditor&&this.activeEditor.state!==Ir.WAITING&&this.closeEditorAndSaveChanges(i),this.moveSelectionAfterEnter(o)):this.instance.getSettings().enterBeginsEditing?this.cellProperties.readOnly?this.moveSelectionAfterEnter():this.activeEditor&&(this.activeEditor.enableFullEditMode(),this.openEditor(null,e)):this.moveSelectionAfterEnter(o),e.preventDefault(),rr(e);break;case De.ESCAPE:this.isEditorOpened()&&(this.closeEditorAndRestoreOriginalValue(i),this.activeEditor.focus()),e.preventDefault();break;case De.HOME:e.ctrlKey||e.metaKey?a.call(this.selection,new ke(this.instance.rowIndexMapper.getFirstNotHiddenIndex(0,1),this.selection.selectedRange.current().from.col)):a.call(this.selection,new ke(this.selection.selectedRange.current().from.row,this.instance.columnIndexMapper.getFirstNotHiddenIndex(0,1))),e.preventDefault(),e.stopPropagation();break;case De.END:e.ctrlKey||e.metaKey?a.call(this.selection,new ke(this.instance.rowIndexMapper.getFirstNotHiddenIndex(this.instance.countRows()-1,-1),this.selection.selectedRange.current().from.col)):a.call(this.selection,new ke(this.selection.selectedRange.current().from.row,this.instance.columnIndexMapper.getFirstNotHiddenIndex(this.instance.countCols()-1,-1))),e.preventDefault(),e.stopPropagation();break;case De.PAGE_UP:this.selection.transformStart(-this.instance.countVisibleRows(),0),e.preventDefault(),e.stopPropagation();break;case De.PAGE_DOWN:this.selection.transformStart(this.instance.countVisibleRows(),0),e.preventDefault(),e.stopPropagation();break}}}}},{key:"onCellDblClick",value:function(e,n,i){i.nodeName==="TD"&&(this.activeEditor&&this.activeEditor.enableFullEditMode(),this.openEditor(null,e))}},{key:"destroy",value:function(){this.destroyed=!0,this.eventManager.destroy()}}]),t}(),nA=new WeakMap;mw.getInstance=function(t,r,e){var n=nA.get(t);return n||(n=new mw(t,r,e),nA.set(t,n)),n};var $ie=mw,jie=pt,Lie=Qr,iA=wl,Hie=Mt,Fie=Hie(function(){iA(1)});jie({target:"Object",stat:!0,forced:Fie},{keys:function(r){return iA(Lie(r))}});var Bie=$r,Vie=Uc,Wie=br,Uie=la,vw=xr,zie=Jr,Yie=oa,Gie=lg,oA=zc;Vie("match",function(t,r,e){return[function(i){var o=zie(this),a=i==null?void 0:Yie(i,t);return a?Bie(a,i,o):new RegExp(i)[t](vw(o))},function(n){var i=Wie(this),o=vw(n),a=e(r,i,o);if(a.done)return a.value;if(!i.global)return oA(i,o);var s=i.unicode;i.lastIndex=0;for(var l=[],p=0,d;(d=oA(i,o))!==null;){var g=vw(d[0]);l[p]=g,g===""&&(i.lastIndex=Gie(o,Uie(i.lastIndex),s)),p++}return p===0?null:l}]});var Kie=ca,qie=an,Xie=mo,Zie=bn,Jie=Es,Qie=Math.min,gw=[].lastIndexOf,aA=!!gw&&1/[1].lastIndexOf(1,-0)<0,eoe=Jie("lastIndexOf"),toe=aA||!eoe,roe=toe?function(r){if(aA)return Kie(gw,this,arguments)||0;var e=qie(this),n=Zie(e),i=n-1;for(arguments.length>1&&(i=Qie(i,Xie(arguments[1]))),i<0&&(i=n+i);i>=0;i--)if(i in e&&e[i]===r)return i||0;return-1}:gw,noe=pt,sA=roe;noe({target:"Array",proto:!0,forced:sA!==[].lastIndexOf},{lastIndexOf:sA});var ioe=ot,ooe=Cs,aoe=Qr,soe=ul,uoe=bn,loe=ioe.TypeError,uA=function(t){return function(r,e,n,i){ooe(e);var o=aoe(r),a=soe(o),s=uoe(o),l=t?s-1:0,p=t?-1:1;if(n<2)for(;;){if(l in a){i=a[l],l+=p;break}if(l+=p,t?l<0:s<=l)throw loe("Reduce of empty array with no initial value")}for(;t?l>=0:s>l;l+=p)l in a&&(i=e(i,a[l],l,o));return i}},foe={left:uA(!1),right:uA(!0)},coe=pt,hoe=foe.left,doe=Es,lA=ll,poe=AR,yoe=doe("reduce"),moe=!poe&&lA>79&&lA<83;coe({target:"Array",proto:!0,forced:!yoe||moe},{reduce:function(r){var e=arguments.length;return hoe(this,r,e,e>1?arguments[1]:void 0)}});var voe=pt,goe=fa.findIndex,boe=_l,bw="findIndex",fA=!0;bw in[]&&Array(1)[bw](function(){fA=!1});voe({target:"Array",proto:!0,forced:fA},{findIndex:function(r){return goe(this,r,arguments.length>1?arguments[1]:void 0)}});boe(bw);function ww(t){return Coe(t)||Soe(t)||_oe(t)||woe()}function woe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function _oe(t,r){if(!!t){if(typeof t=="string")return _w(t,r);var e=Object.prototype.toString.call(t).slice(8,-1);if(e==="Object"&&t.constructor&&(e=t.constructor.name),e==="Map"||e==="Set")return Array.from(t);if(e==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return _w(t,r)}}function Soe(t){if(typeof Symbol!="undefined"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function Coe(t){if(Array.isArray(t))return _w(t)}function _w(t,r){(r==null||r>t.length)&&(r=t.length);for(var e=0,n=new Array(r);e<r;e++)n[e]=t[e];return n}var cA={"&nbsp;":" ","&amp;":"&","&lt;":"<","&gt;":">"},koe=new RegExp(Object.keys(cA).map(function(t){return"(".concat(t,")")}).join("|"),"gi");function Ooe(t){return(t&&t.nodeName||"")==="TABLE"}function Sw(t){for(var r=t.hasColHeaders(),e=t.hasRowHeaders(),n=[r?-1:0,e?-1:0,t.countRows()-1,t.countCols()-1],i=t.getData.apply(t,n),o=i.length,a=o>0?i[0].length:0,s=["<table>","</table>"],l=r?["<thead>","</thead>"]:[],p=["<tbody>","</tbody>"],d=e?1:0,g=r?1:0,y=0;y<o;y+=1){for(var h=r&&y===0,u=[],f=0;f<a;f+=1){var c=!h&&e&&f===0,v="";if(h)v="<th>".concat(t.getColHeader(f-d),"</th>");else if(c)v="<th>".concat(t.getRowHeader(y-g),"</th>");else{var m=i[y][f],b=t.getCellMeta(y-g,f-d),w=b.hidden,_=b.rowspan,C=b.colspan;if(!w){var R=[];if(_&&R.push('rowspan="'.concat(_,'"')),C&&R.push('colspan="'.concat(C,'"')),Or(m))v="<td ".concat(R.join(" "),"></td>");else{var I=m.toString().replace("<","&lt;").replace(">","&gt;").replace(/(<br(\s*|\/)>(\r\n|\n)?|\r\n|\n)/g,`<br>\r
`).replace(/\x20/gi,"&nbsp;").replace(/\t/gi,"&#9;");v="<td ".concat(R.join(" "),">").concat(I,"</td>")}}}u.push(v)}var P=["<tr>"].concat(u,["</tr>"]).join("");h?l.splice(1,0,P):p.splice(-1,0,P)}return s.splice(1,0,l.join(""),p.join("")),s.join("")}function Cw(t){for(var r=t.length,e=["<table>"],n=0;n<r;n+=1){var i=t[n],o=i.length,a=[];n===0&&e.push("<tbody>");for(var s=0;s<o;s+=1){var l=i[s],p=Or(l)?"":l.toString().replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/(<br(\s*|\/)>(\r\n|\n)?|\r\n|\n)/g,`<br>\r
`).replace(/\x20/gi,"&nbsp;").replace(/\t/gi,"&#9;");a.push("<td>".concat(p,"</td>"))}e.push.apply(e,["<tr>"].concat(a,["</tr>"])),n+1===r&&e.push("</tbody>")}return e.push("</table>"),e.join("")}function hA(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:document,e={},n=r.createDocumentFragment(),i=r.createElement("div");n.appendChild(i);var o=t;if(typeof o=="string"){var a=o.replace(/<td\b[^>]*?>([\s\S]*?)<\/\s*td>/g,function(F){var V=F.match(/<td\b[^>]*?>/g)[0],W=F.substring(V.length,F.lastIndexOf("<")).replace(/(<(?!br)([^>]+)>)/gi,""),U="</td>";return"".concat(V).concat(W).concat(U)});i.insertAdjacentHTML("afterbegin","".concat(a)),o=i.querySelector("table")}if(!(!o||!Ooe(o))){var s=i.querySelector('meta[name$="enerator"]'),l=o.querySelector("tbody th")!==null,p=o.querySelector("tr"),d=p?Array.from(p.cells).reduce(function(F,V){return F+V.colSpan},0)-(l?1:0):0,g=o.tFoot&&Array.from(o.tFoot.rows)||[],y=[],h=!1,u=0,f=0;if(o.tHead){var c=Array.from(o.tHead.rows).filter(function(F){var V=F.querySelector("td")!==null;return V&&y.push(F),!V});u=c.length,h=u>0,u>1?e.nestedHeaders=Array.from(c).reduce(function(F,V){var W=Array.from(V.cells).reduce(function(U,Y,K){if(l&&K===0)return U;var D=Y.colSpan,L=Y.innerHTML,B=D>1?{label:L,colspan:D}:L;return U.push(B),U},[]);return F.push(W),F},[]):h&&(e.colHeaders=Array.from(c[0].children).reduce(function(F,V,W){return l&&W===0||F.push(V.innerHTML),F},[]))}y.length&&(e.fixedRowsTop=y.length),g.length&&(e.fixedRowsBottom=g.length);var v=[].concat(y,ww(Array.from(o.tBodies).reduce(function(F,V){return F.push.apply(F,ww(Array.from(V.rows))),F},[])),ww(g));f=v.length;for(var m=new Array(f),b=0;b<f;b++)m[b]=new Array(d);for(var w=[],_=[],C=0;C<f;C++)for(var R=v[C],I=Array.from(R.cells),P=I.length,N=0;N<P;N++){var A=I[N],$=A.nodeName,T=A.innerHTML,M=A.rowSpan,S=A.colSpan,E=m[C].findIndex(function(F){return F===void 0});if($==="TD"){if(M>1||S>1){for(var k=C;k<C+M;k++)if(k<f)for(var O=E;O<E+S;O++)m[k][O]=null;var x=A.getAttribute("style"),j=x&&x.includes("mso-ignore:colspan");j||w.push({col:E,row:C,rowspan:M,colspan:S})}var H="";s&&/excel/gi.test(s.content)?H=T.replace(/[\r\n][\x20]{0,2}/g," ").replace(/<br(\s*|\/)>[\r\n]?[\x20]{0,3}/gim,`\r
`):H=T.replace(/<br(\s*|\/)>[\r\n]?/gim,`\r
`),m[C][E]=H.replace(koe,function(F){return cA[F]})}else _.push(T)}return w.length&&(e.mergeCells=w),_.length&&(e.rowHeaders=_),m.length&&(e.data=m),e}}var Roe=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",instanceToHTML:Sw,_dataToHTML:Cw,htmlToGridSettings:hA});function Eoe(t){return Moe(t)||Aoe(t)||xoe(t)||Toe()}function Toe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function xoe(t,r){if(!!t){if(typeof t=="string")return kw(t,r);var e=Object.prototype.toString.call(t).slice(8,-1);if(e==="Object"&&t.constructor&&(e=t.constructor.name),e==="Map"||e==="Set")return Array.from(t);if(e==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return kw(t,r)}}function Aoe(t){if(typeof Symbol!="undefined"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function Moe(t){if(Array.isArray(t))return kw(t)}function kw(t,r){(r==null||r>t.length)&&(r=t.length);for(var e=0,n=new Array(r);e<r;e++)n[e]=t[e];return n}function Zd(t){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?Zd=function(e){return typeof e}:Zd=function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Zd(t)}function dn(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],e=Zd(t);if(e==="number")return!isNaN(t)&&isFinite(t);if(e==="string"){if(t.length===0)return!1;if(t.length===1)return/\d/.test(t);var n=Array.from(new Set(["."].concat(Eoe(r)))).map(function(i){return"\\".concat(i)}).join("|");return new RegExp("^[+-]?\\s*(((".concat(n,")?\\d+((").concat(n,")\\d+)?(e[+-]?\\d+)?)|(0x[a-f\\d]+))$"),"i").test(t.trim())}else if(e==="object")return!!t&&typeof t.valueOf()=="number"&&!(t instanceof Date);return!1}function dA(t){return dn(t,[","])}function Qe(t,r,e){var n=-1;for(typeof r=="function"?(e=r,r=t):n=t-1;++n<=r&&e(n)!==!1;);}function Jd(t,r,e){var n=t+1;for(typeof r=="function"&&(e=r,r=0);--n>=r&&e(n)!==!1;);}function Ow(t,r){return r=parseInt(r.tostring().replace("%",""),10),r=parseInt(t*r/100,10),r}var Poe=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",isNumeric:dn,isNumericLike:dA,rangeEach:Qe,rangeEachReverse:Jd,valueAccordingPercent:Ow});function Ioe(t){return $oe(t)||Noe(t)||pA(t)||Doe()}function Doe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Noe(t){if(typeof Symbol!="undefined"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function $oe(t){if(Array.isArray(t))return Rw(t)}function joe(t,r){return Foe(t)||Hoe(t,r)||pA(t,r)||Loe()}function Loe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function pA(t,r){if(!!t){if(typeof t=="string")return Rw(t,r);var e=Object.prototype.toString.call(t).slice(8,-1);if(e==="Object"&&t.constructor&&(e=t.constructor.name),e==="Map"||e==="Set")return Array.from(t);if(e==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return Rw(t,r)}}function Rw(t,r){(r==null||r>t.length)&&(r=t.length);for(var e=0,n=new Array(r);e<r;e++)n[e]=t[e];return n}function Hoe(t,r){var e=t==null?null:typeof Symbol!="undefined"&&t[Symbol.iterator]||t["@@iterator"];if(e!=null){var n=[],i=!0,o=!1,a,s;try{for(e=e.call(t);!(i=(a=e.next()).done)&&(n.push(a.value),!(r&&n.length===r));i=!0);}catch(l){o=!0,s=l}finally{try{!i&&e.return!=null&&e.return()}finally{if(o)throw s}}return n}}function Foe(t){if(Array.isArray(t))return t}var Ew="asc",Boe="desc",yA=new Map([[Ew,[-1,1]],[Boe,[1,-1]]]),Voe=function(r){return"The priority '".concat(r,"' is already declared in a map.")},Woe=function(r){return"The priority '".concat(r,"' is not a number.")};function Uoe(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},r=t.errorPriorityExists,e=t.errorPriorityNaN,n=new Map;r=qt(r)?r:Voe,e=qt(e)?e:Woe;function i(a,s){if(!dn(a))throw new Error(e(a));if(n.has(a))throw new Error(r(a));n.set(a,s)}function o(){var a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Ew,s=yA.get(a)||yA.get(Ew),l=joe(s,2),p=l[0],d=l[1];return Ioe(n).sort(function(g,y){return g[0]<y[0]?p:d}).map(function(g){return g[1]})}return{addItem:i,getItems:o}}var zoe=pt,Yoe=fa.find,Goe=_l,Tw="find",mA=!0;Tw in[]&&Array(1)[Tw](function(){mA=!1});zoe({target:"Array",proto:!0,forced:mA},{find:function(r){return Yoe(this,r,arguments.length>1?arguments[1]:void 0)}});Goe(Tw);function Koe(t){return Zoe(t)||Xoe(t)||gA(t)||qoe()}function qoe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Xoe(t){if(typeof Symbol!="undefined"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function Zoe(t){if(Array.isArray(t))return xw(t)}function vA(t,r){return eae(t)||Qoe(t,r)||gA(t,r)||Joe()}function Joe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function gA(t,r){if(!!t){if(typeof t=="string")return xw(t,r);var e=Object.prototype.toString.call(t).slice(8,-1);if(e==="Object"&&t.constructor&&(e=t.constructor.name),e==="Map"||e==="Set")return Array.from(t);if(e==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return xw(t,r)}}function xw(t,r){(r==null||r>t.length)&&(r=t.length);for(var e=0,n=new Array(r);e<r;e++)n[e]=t[e];return n}function Qoe(t,r){var e=t==null?null:typeof Symbol!="undefined"&&t[Symbol.iterator]||t["@@iterator"];if(e!=null){var n=[],i=!0,o=!1,a,s;try{for(e=e.call(t);!(i=(a=e.next()).done)&&(n.push(a.value),!(r&&n.length===r));i=!0);}catch(l){o=!0,s=l}finally{try{!i&&e.return!=null&&e.return()}finally{if(o)throw s}}return n}}function eae(t){if(Array.isArray(t))return t}var tae=function(r){return"The id '".concat(r,"' is already declared in a map.")};function bA(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},r=t.errorIdExists,e=new Map;r=qt(r)?r:tae;function n(p,d){if(l(p))throw new Error(r(p));e.set(p,d)}function i(){e.clear()}function o(p){var d=s().find(function(h){var u=vA(h,2),f=u[0],c=u[1];return p===c?f:!1})||[null],g=vA(d,1),y=g[0];return y}function a(p){return e.get(p)}function s(){return Koe(e)}function l(p){return e.has(p)}return{addItem:n,clear:i,getId:o,getItem:a,getItems:s,hasItem:l}}function rae(t){return aae(t)||oae(t)||iae(t)||nae()}function nae(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function iae(t,r){if(!!t){if(typeof t=="string")return Aw(t,r);var e=Object.prototype.toString.call(t).slice(8,-1);if(e==="Object"&&t.constructor&&(e=t.constructor.name),e==="Map"||e==="Set")return Array.from(t);if(e==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return Aw(t,r)}}function oae(t){if(typeof Symbol!="undefined"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function aae(t){if(Array.isArray(t))return Aw(t)}function Aw(t,r){(r==null||r>t.length)&&(r=t.length);for(var e=0,n=new Array(r);e<r;e++)n[e]=t[e];return n}var sae=function(r){return"'".concat(r,"' value is already declared in a unique set.")};function uae(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},r=t.errorItemExists,e=new Set;r=qt(r)?r:sae;function n(o){if(e.has(o))throw new Error(r(o));e.add(o)}function i(){return rae(e)}return{addItem:n,getItems:i}}function lae(t,r){return hae(t)||cae(t,r)||_A(t,r)||fae()}function fae(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function cae(t,r){var e=t==null?null:typeof Symbol!="undefined"&&t[Symbol.iterator]||t["@@iterator"];if(e!=null){var n=[],i=!0,o=!1,a,s;try{for(e=e.call(t);!(i=(a=e.next()).done)&&(n.push(a.value),!(r&&n.length===r));i=!0);}catch(l){o=!0,s=l}finally{try{!i&&e.return!=null&&e.return()}finally{if(o)throw s}}return n}}function hae(t){if(Array.isArray(t))return t}function wA(t){return yae(t)||pae(t)||_A(t)||dae()}function dae(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function _A(t,r){if(!!t){if(typeof t=="string")return Mw(t,r);var e=Object.prototype.toString.call(t).slice(8,-1);if(e==="Object"&&t.constructor&&(e=t.constructor.name),e==="Map"||e==="Set")return Array.from(t);if(e==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return Mw(t,r)}}function pae(t){if(typeof Symbol!="undefined"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function yae(t){if(Array.isArray(t))return Mw(t)}function Mw(t,r){(r==null||r>t.length)&&(r=t.length);for(var e=0,n=new Array(r);e<r;e++)n[e]=t[e];return n}var Pw=function(r){return'There is already registered "'.concat(r,'" plugin.')},mae=function(r){return'There is already registered plugin on priority "'.concat(r,'".')},vae=function(r){return'The priority "'.concat(r,'" is not a number.')},SA=Uoe({errorPriorityExists:mae,errorPriorityNaN:vae}),CA=uae({errorItemExists:Pw}),Iw=bA({errorIdExists:Pw});function Dw(){return[].concat(wA(SA.getItems()),wA(CA.getItems()))}function _f(t){var r=Ln(t);return Iw.getItem(r)}function gae(t){return!!_f(t)}function Nt(t,r,e){var n=wae(t,r,e),i=lae(n,3);t=i[0],r=i[1],e=i[2],_f(t)===void 0&&bae(t,r,e)}function bae(t,r,e){var n=Ln(t);if(Iw.hasItem(n))throw new Error(Pw(n));e===void 0?CA.addItem(n):SA.addItem(e,n),Iw.addItem(n,r)}function wae(t,r,e){return typeof t=="function"&&(r=t,t=r.PLUGIN_KEY,e=r.PLUGIN_PRIORITY),[t,r,e]}var Sf=Rn("renderers"),_ae=Sf.register,Sae=Sf.getItem,kA=Sf.hasItem,Cae=Sf.getNames;Sf.getValues;function Nw(t){if(typeof t=="function")return t;if(!kA(t))throw Error('No registered renderer found under "'.concat(t,'" name'));return Sae(t)}function Ai(t,r){typeof t!="string"&&(r=t,t=r.RENDERER_TYPE),_ae(t,r)}var Cf=Rn("validators"),kae=Cf.register,Oae=Cf.getItem,OA=Cf.hasItem,Rae=Cf.getNames;Cf.getValues;function $w(t){if(typeof t=="function")return t;if(!OA(t))throw Error('No registered validator found under "'.concat(t,'" name'));return Oae(t)}function su(t,r){typeof t!="string"&&(r=t,t=r.VALIDATOR_TYPE),kae(t,r)}function RA(t){var r=t.isShiftKey,e=t.isLeftClick,n=t.isRightClick,i=t.coords,o=t.selection,a=t.controller,s=o.isSelected()?o.getSelectedRange().current():null,l=o.isSelectedByCorner(),p=o.isSelectedByRowHeader();if(r&&s)i.row>=0&&i.col>=0&&!a.cell?o.setRangeEnd(i):(l||p)&&i.row>=0&&i.col>=0&&!a.cell?o.setRangeEnd(new ke(i.row,i.col)):l&&i.row<0&&!a.column?o.setRangeEnd(new ke(s.to.row,i.col)):p&&i.col<0&&!a.row?o.setRangeEnd(new ke(i.row,s.to.col)):(!l&&!p&&i.col<0||l&&i.col<0)&&!a.row?o.selectRows(Math.max(s.from.row,0),i.row,i.col):(!l&&!p&&i.row<0||p&&i.row<0)&&!a.column&&o.selectColumns(Math.max(s.from.col,0),i.col,i.row);else{var d=!o.inInSelection(i),g=e||n&&d;i.row<0&&i.col>=0&&!a.column?g&&o.selectColumns(i.col,i.col,i.row):i.col<0&&i.row>=0&&!a.row?g&&o.selectRows(i.row,i.row,i.col):i.col>=0&&i.row>=0&&!a.cell?g&&o.setRangeStart(i):i.col<0&&i.row<0&&o.selectAll(!0,!0)}}function Eae(t){var r=t.isLeftClick,e=t.coords,n=t.selection,i=t.controller;if(!!r){var o=n.isSelectedByRowHeader(),a=n.isSelectedByColumnHeader(),s=n.tableProps.countCols(),l=n.tableProps.countRows();a&&!i.column?n.setRangeEnd(new ke(l-1,e.col)):o&&!i.row?n.setRangeEnd(new ke(e.row,s-1)):i.cell||n.setRangeEnd(e)}}var Tae=new Map([["mousedown",RA],["mouseover",Eae],["touchstart",RA]]);function EA(t,r){var e=r.coords,n=r.selection,i=r.controller;Tae.get(t.type)({coords:e,selection:n,controller:i,isShiftKey:t.shiftKey,isLeftClick:bd(t)||t.type==="touchstart",isRightClick:Do(t)})}var TA=new WeakMap,jw=Symbol("rootInstance");function xae(t){TA.set(t,!0)}function Aae(t){return t===jw}function Lw(t){return TA.has(t)}function kf(t,r){return Iae(t)||Pae(t,r)||AA(t,r)||Mae()}function Mae(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Pae(t,r){var e=t==null?null:typeof Symbol!="undefined"&&t[Symbol.iterator]||t["@@iterator"];if(e!=null){var n=[],i=!0,o=!1,a,s;try{for(e=e.call(t);!(i=(a=e.next()).done)&&(n.push(a.value),!(r&&n.length===r));i=!0);}catch(l){o=!0,s=l}finally{try{!i&&e.return!=null&&e.return()}finally{if(o)throw s}}return n}}function Iae(t){if(Array.isArray(t))return t}function Qd(t,r,e){return Dae()?Qd=Reflect.construct:Qd=function(i,o,a){var s=[null];s.push.apply(s,o);var l=Function.bind.apply(i,s),p=new l;return a&&Hw(p,a.prototype),p},Qd.apply(null,arguments)}function Dae(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Hw(t,r){return Hw=Object.setPrototypeOf||function(n,i){return n.__proto__=i,n},Hw(t,r)}function xA(t){return jae(t)||$ae(t)||AA(t)||Nae()}function Nae(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function AA(t,r){if(!!t){if(typeof t=="string")return Fw(t,r);var e=Object.prototype.toString.call(t).slice(8,-1);if(e==="Object"&&t.constructor&&(e=t.constructor.name),e==="Map"||e==="Set")return Array.from(t);if(e==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return Fw(t,r)}}function $ae(t){if(typeof Symbol!="undefined"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function jae(t){if(Array.isArray(t))return Fw(t)}function Fw(t,r){(r==null||r>t.length)&&(r=t.length);for(var e=0,n=new Array(r);e<r;e++)n[e]=t[e];return n}function Lae(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}function MA(t,r){for(var e=0;e<r.length;e++){var n=r[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function Hae(t,r,e){return r&&MA(t.prototype,r),e&&MA(t,e),t}var Aa=new WeakMap,Fae=function(){function t(r){Lae(this,t),this.instance=r,this.eventManager=new Wt(r),this.settings=r.getSettings(),this.THEAD=void 0,this.TBODY=void 0,this.wt=void 0,this.activeWt=void 0,this.postponedAdjustElementsSize=!1,Aa.set(this,{selectionMouseDown:!1,mouseDown:void 0,table:void 0,lastWidth:0,lastHeight:0}),this.createElements(),this.registerEvents(),this.initializeWalkontable()}return Hae(t,[{key:"render",value:function(){this.instance.isRenderSuspended()||(this.instance.runHooks("beforeRender",this.instance.forceFullRender),this.postponedAdjustElementsSize&&(this.postponedAdjustElementsSize=!1,this.adjustElementsSize(!0)),this.wt.draw(!this.instance.forceFullRender),this.instance.runHooks("afterRender",this.instance.forceFullRender),this.instance.forceFullRender=!1,this.instance.renderCall=!1)}},{key:"adjustElementsSize",value:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this.instance.isRenderSuspended()?this.postponedAdjustElementsSize=!0:this.wt.wtOverlays.adjustElementsSize(e)}},{key:"getCellAtCoords",value:function(e,n){var i=this.wt.getCell(e,n);return i<0?null:i}},{key:"scrollViewport",value:function(e,n,i,o,a){return this.wt.scrollViewport(e,n,i,o,a)}},{key:"scrollViewportHorizontally",value:function(e,n,i){return this.wt.scrollViewportHorizontally(e,n,i)}},{key:"scrollViewportVertically",value:function(e,n,i){return this.wt.scrollViewportVertically(e,n,i)}},{key:"createElements",value:function(){var e=Aa.get(this),n=this.instance,i=n.rootElement,o=n.rootDocument,a=i.getAttribute("style");a&&i.setAttribute("data-originalstyle",a),Ie(i,"handsontable"),e.table=o.createElement("TABLE"),Ie(e.table,"htCore"),this.instance.getSettings().tableClassName&&Ie(e.table,this.instance.getSettings().tableClassName),this.THEAD=o.createElement("THEAD"),e.table.appendChild(this.THEAD),this.TBODY=o.createElement("TBODY"),e.table.appendChild(this.TBODY),this.instance.table=e.table,this.instance.container.insertBefore(e.table,this.instance.container.firstChild)}},{key:"registerEvents",value:function(){var e=this,n=Aa.get(this),i=this.instance,o=i.rootElement,a=i.rootDocument,s=i.selection,l=a.documentElement;this.eventManager.addEventListener(o,"mousedown",function(p){if(n.selectionMouseDown=!0,!e.isTextSelectionAllowed(p.target)){var d=e.instance.rootWindow;R0(d),p.preventDefault(),d.focus()}}),this.eventManager.addEventListener(o,"mouseup",function(){n.selectionMouseDown=!1}),this.eventManager.addEventListener(o,"mousemove",function(p){n.selectionMouseDown&&!e.isTextSelectionAllowed(p.target)&&(e.settings.fragmentSelection&&R0(e.instance.rootWindow),p.preventDefault())}),this.eventManager.addEventListener(l,"keyup",function(p){s.isInProgress()&&!p.shiftKey&&s.finish()}),this.eventManager.addEventListener(l,"mouseup",function(p){s.isInProgress()&&bd(p)&&s.finish(),n.mouseDown=!1,(T0(a.activeElement)||!s.isSelected()&&!s.isSelectedByAnyHeader()&&!o.contains(p.target)&&!Do(p))&&e.instance.unlisten()}),this.eventManager.addEventListener(l,"contextmenu",function(p){s.isInProgress()&&Do(p)&&(s.finish(),n.mouseDown=!1)}),this.eventManager.addEventListener(l,"touchend",function(){s.isInProgress()&&s.finish(),n.mouseDown=!1}),this.eventManager.addEventListener(l,"mousedown",function(p){var d=p.target,g=p.x||p.clientX,y=p.y||p.clientY,h=p.target;if(!(n.mouseDown||!o||!e.instance.view)){var u=e.instance.view.wt.wtTable.holder;if(h===u){var f=Pr(a);if(a.elementFromPoint(g+f,y)!==u||a.elementFromPoint(g,y+f)!==u)return}else for(;h!==l;){if(h===null){if(p.isTargetWebComponent)break;return}if(h===o)return;h=h.parentNode}var c=typeof e.settings.outsideClickDeselects=="function"?e.settings.outsideClickDeselects(d):e.settings.outsideClickDeselects;c?e.instance.deselectCell():e.instance.destroyEditor(!1,!1)}}),this.eventManager.addEventListener(n.table,"selectstart",function(p){e.settings.fragmentSelection||cf(p.target)||p.preventDefault()})}},{key:"translateFromRenderableToVisualCoords",value:function(e){var n=e.row,i=e.col;return Qd(ke,xA(this.translateFromRenderableToVisualIndex(n,i)))}},{key:"translateFromRenderableToVisualIndex",value:function(e,n){var i=e>=0?this.instance.rowIndexMapper.getVisualFromRenderableIndex(e):e,o=n>=0?this.instance.columnIndexMapper.getVisualFromRenderableIndex(n):n;return i===null&&(i=e),o===null&&(o=n),[i,o]}},{key:"countRenderableIndexes",value:function(e,n){var i=Math.min(e.getNotTrimmedIndexesLength(),n),o=e.getFirstNotHiddenIndex(i-1,-1);return o===null?0:e.getRenderableFromVisualIndex(o)+1}},{key:"countRenderableColumns",value:function(){return this.countRenderableIndexes(this.instance.columnIndexMapper,this.settings.maxCols)}},{key:"countRenderableRows",value:function(){return this.countRenderableIndexes(this.instance.rowIndexMapper,this.settings.maxRows)}},{key:"countNotHiddenRowIndexes",value:function(e,n){return this.countNotHiddenIndexes(e,n,this.instance.rowIndexMapper,this.countRenderableRows())}},{key:"countNotHiddenColumnIndexes",value:function(e,n){return this.countNotHiddenIndexes(e,n,this.instance.columnIndexMapper,this.countRenderableColumns())}},{key:"countNotHiddenIndexes",value:function(e,n,i,o){if(isNaN(e)||e<0)return 0;var a=i.getFirstNotHiddenIndex(e,n),s=i.getRenderableFromVisualIndex(a);if(!Number.isInteger(s))return 0;var l=0;return n<0?l=s+1:n>0&&(l=o-s),l}},{key:"initializeWalkontable",value:function(){var e=this,n=Aa.get(this),i={externalRowCalculator:this.instance.getPlugin("autoRowSize")&&this.instance.getPlugin("autoRowSize").isEnabled(),table:n.table,isDataViewInstance:function(){return Lw(e.instance)},preventOverflow:function(){return e.settings.preventOverflow},preventWheel:function(){return e.settings.preventWheel},stretchH:function(){return e.settings.stretchH},data:function(d,g){var y;return(y=e.instance).getDataAtCell.apply(y,xA(e.translateFromRenderableToVisualIndex(d,g)))},totalRows:function(){return e.countRenderableRows()},totalColumns:function(){return e.countRenderableColumns()},fixedColumnsLeft:function(){var d=e.instance.countCols(),g=Math.min(parseInt(e.settings.fixedColumnsLeft,10),d)-1;return e.countNotHiddenColumnIndexes(g,-1)},fixedRowsTop:function(){var d=e.instance.countRows(),g=Math.min(parseInt(e.settings.fixedRowsTop,10),d)-1;return e.countNotHiddenRowIndexes(g,-1)},fixedRowsBottom:function(){var d=e.instance.countRows(),g=Math.max(d-parseInt(e.settings.fixedRowsBottom,10),0);return e.countNotHiddenRowIndexes(g,1)},shouldRenderLeftOverlay:function(){return e.settings.fixedColumnsLeft>0||i.rowHeaders().length>0},shouldRenderTopOverlay:function(){return e.settings.fixedRowsTop>0||i.columnHeaders().length>0},shouldRenderBottomOverlay:function(){return e.settings.fixedRowsBottom>0},minSpareRows:function(){return e.settings.minSpareRows},renderAllRows:this.settings.renderAllRows,rowHeaders:function(){var d=[];return e.instance.hasRowHeaders()&&d.push(function(g,y){var h=g>=0?e.instance.rowIndexMapper.getVisualFromRenderableIndex(g):g;e.appendRowHeader(h,y)}),e.instance.runHooks("afterGetRowHeaderRenderers",d),d},columnHeaders:function(){var d=[];return e.instance.hasColHeaders()&&d.push(function(g,y){var h=g>=0?e.instance.columnIndexMapper.getVisualFromRenderableIndex(g):g;e.appendColHeader(h,y)}),e.instance.runHooks("afterGetColumnHeaderRenderers",d),d},columnWidth:function(d){var g=e.instance.columnIndexMapper.getVisualFromRenderableIndex(d);return e.instance.getColWidth(g===null?d:g)},rowHeight:function(d){var g=e.instance.rowIndexMapper.getVisualFromRenderableIndex(d);return e.instance.getRowHeight(g===null?d:g)},cellRenderer:function(d,g,y){var h=e.translateFromRenderableToVisualIndex(d,g),u=kf(h,2),f=u[0],c=u[1],v=e.instance.runHooks("modifyGetCellCoords",f,c),m=f,b=c;if(Array.isArray(v)){var w=kf(v,2);m=w[0],b=w[1]}var _=e.instance.getCellMeta(m,b),C=e.instance.colToProp(b),R=e.instance.getDataAtRowProp(m,C);e.instance.hasHook("beforeValueRender")&&(R=e.instance.runHooks("beforeValueRender",R,_)),e.instance.runHooks("beforeRenderer",y,f,c,C,R,_),e.instance.getCellRenderer(_)(e.instance,y,f,c,C,R,_),e.instance.runHooks("afterRenderer",y,f,c,C,R,_)},selections:this.instance.selection.highlight,hideBorderOnMouseDownOver:function(){return e.settings.fragmentSelection},onWindowResize:function(){!e.instance||e.instance.isDestroyed||e.instance.refreshDimensions()},onCellMouseDown:function(d,g,y,h){var u=e.translateFromRenderableToVisualCoords(g),f={row:!1,column:!1,cell:!1};e.instance.listen(),e.activeWt=h,n.mouseDown=!0,e.instance.runHooks("beforeOnCellMouseDown",d,u,y,f),!Fn(d)&&(EA(d,{coords:u,selection:e.instance.selection,controller:f}),e.instance.runHooks("afterOnCellMouseDown",d,u,y),e.activeWt=e.wt)},onCellContextMenu:function(d,g,y,h){var u=e.translateFromRenderableToVisualCoords(g);e.activeWt=h,n.mouseDown=!1,e.instance.selection.isInProgress()&&e.instance.selection.finish(),e.instance.runHooks("beforeOnCellContextMenu",d,u,y),!Fn(d)&&(e.instance.runHooks("afterOnCellContextMenu",d,u,y),e.activeWt=e.wt)},onCellMouseOut:function(d,g,y,h){var u=e.translateFromRenderableToVisualCoords(g);e.activeWt=h,e.instance.runHooks("beforeOnCellMouseOut",d,u,y),!Fn(d)&&(e.instance.runHooks("afterOnCellMouseOut",d,u,y),e.activeWt=e.wt)},onCellMouseOver:function(d,g,y,h){var u=e.translateFromRenderableToVisualCoords(g),f={row:!1,column:!1,cell:!1};e.activeWt=h,e.instance.runHooks("beforeOnCellMouseOver",d,u,y,f),!Fn(d)&&(n.mouseDown&&EA(d,{coords:u,selection:e.instance.selection,controller:f}),e.instance.runHooks("afterOnCellMouseOver",d,u,y),e.activeWt=e.wt)},onCellMouseUp:function(d,g,y,h){var u=e.translateFromRenderableToVisualCoords(g);e.activeWt=h,e.instance.runHooks("beforeOnCellMouseUp",d,u,y),!(Fn(d)||e.instance.isDestroyed)&&(e.instance.runHooks("afterOnCellMouseUp",d,u,y),e.activeWt=e.wt)},onCellCornerMouseDown:function(d){d.preventDefault(),e.instance.runHooks("afterOnCellCornerMouseDown",d)},onCellCornerDblClick:function(d){d.preventDefault(),e.instance.runHooks("afterOnCellCornerDblClick",d)},beforeDraw:function(d,g){return e.beforeRender(d,g)},onDraw:function(d){return e.afterRender(d)},onScrollVertically:function(){return e.instance.runHooks("afterScrollVertically")},onScrollHorizontally:function(){return e.instance.runHooks("afterScrollHorizontally")},onBeforeRemoveCellClassNames:function(){return e.instance.runHooks("beforeRemoveCellClassNames")},onBeforeHighlightingRowHeader:function(d,g,y){var h=e.instance.rowIndexMapper,u=h.getVisualFromRenderableIndex(d),f=e.instance.runHooks("beforeHighlightingRowHeader",u,g,y);return h.getRenderableFromVisualIndex(h.getFirstNotHiddenIndex(f,1))},onBeforeHighlightingColumnHeader:function(d,g,y){var h=e.instance.columnIndexMapper,u=h.getVisualFromRenderableIndex(d),f=e.instance.runHooks("beforeHighlightingColumnHeader",u,g,y);return h.getRenderableFromVisualIndex(h.getFirstNotHiddenIndex(f,1))},onAfterDrawSelection:function(d,g,y){var h,u=e.translateFromRenderableToVisualIndex(d,g),f=kf(u,2),c=f[0],v=f[1],m=e.instance.selection.getSelectedRange(),b=m.size();if(b>0){var w=(y!=null?y:0)+1-b,_=m.peekByIndex(w);h=[_.from.row,_.from.col,_.to.row,_.to.col]}return e.instance.runHooks("afterDrawSelection",c,v,h,y)},onBeforeDrawBorders:function(d,g){var y=kf(d,4),h=y[0],u=y[1],f=y[2],c=y[3],v=[e.instance.rowIndexMapper.getVisualFromRenderableIndex(h),e.instance.columnIndexMapper.getVisualFromRenderableIndex(u),e.instance.rowIndexMapper.getVisualFromRenderableIndex(f),e.instance.columnIndexMapper.getVisualFromRenderableIndex(c)];return e.instance.runHooks("beforeDrawBorders",v,g)},onBeforeTouchScroll:function(){return e.instance.runHooks("beforeTouchScroll")},onAfterMomentumScroll:function(){return e.instance.runHooks("afterMomentumScroll")},onBeforeStretchingColumnWidth:function(d,g){var y=e.instance.columnIndexMapper.getVisualFromRenderableIndex(g);return e.instance.runHooks("beforeStretchingColumnWidth",d,y)},onModifyRowHeaderWidth:function(d){return e.instance.runHooks("modifyRowHeaderWidth",d)},onModifyGetCellCoords:function(d,g,y){var h=e.instance.rowIndexMapper,u=e.instance.columnIndexMapper,f=g>=0?u.getVisualFromRenderableIndex(g):g,c=d>=0?h.getVisualFromRenderableIndex(d):d,v=e.instance.runHooks("modifyGetCellCoords",c,f,y);if(Array.isArray(v)){var m=kf(v,4),b=m[0],w=m[1],_=m[2],C=m[3];return[b>=0?h.getRenderableFromVisualIndex(h.getFirstNotHiddenIndex(b,1)):b,w>=0?u.getRenderableFromVisualIndex(u.getFirstNotHiddenIndex(w,1)):w,_>=0?h.getRenderableFromVisualIndex(h.getFirstNotHiddenIndex(_,-1)):_,C>=0?u.getRenderableFromVisualIndex(u.getFirstNotHiddenIndex(C,-1)):C]}},viewportRowCalculatorOverride:function(d){var g=e.settings.viewportRowRenderingOffset;if(g==="auto"&&e.settings.fixedRowsTop&&(g=10),g>0||g==="auto"){var y=e.countRenderableRows(),h=d.startRow,u=d.endRow;if(typeof g=="number")d.startRow=Math.max(h-g,0),d.endRow=Math.min(u+g,y-1);else if(g==="auto"){var f=Math.ceil(u/y*12);d.startRow=Math.max(h-f,0),d.endRow=Math.min(u+f,y-1)}}e.instance.runHooks("afterViewportRowCalculatorOverride",d)},viewportColumnCalculatorOverride:function(d){var g=e.settings.viewportColumnRenderingOffset;if(g==="auto"&&e.settings.fixedColumnsLeft&&(g=10),g>0||g==="auto"){var y=e.countRenderableColumns(),h=d.startColumn,u=d.endColumn;if(typeof g=="number"&&(d.startColumn=Math.max(h-g,0),d.endColumn=Math.min(u+g,y-1)),g==="auto"){var f=Math.ceil(u/y*6);d.startColumn=Math.max(h-f,0),d.endColumn=Math.min(u+f,y-1)}}e.instance.runHooks("afterViewportColumnCalculatorOverride",d)},rowHeaderWidth:function(){return e.settings.rowHeaderWidth},columnHeaderHeight:function(){var d=e.instance.runHooks("modifyColumnHeaderHeight");return e.settings.columnHeaderHeight||d}};this.instance.runHooks("beforeInitWalkontable",i),this.wt=new jne(i),this.activeWt=this.wt;var o=this.wt.wtTable.spreader,a=this.instance.rootElement.getBoundingClientRect(),s=a.width,l=a.height;this.setLastSize(s,l),this.eventManager.addEventListener(o,"mousedown",function(p){p.target===o&&p.which===3&&p.stopPropagation()}),this.eventManager.addEventListener(o,"contextmenu",function(p){p.target===o&&p.which===3&&p.stopPropagation()}),this.eventManager.addEventListener(this.instance.rootDocument.documentElement,"click",function(){e.settings.observeDOMVisibility&&e.wt.drawInterrupted&&(e.instance.forceFullRender=!0,e.render())})}},{key:"isTextSelectionAllowed",value:function(e){if(cf(e))return!0;var n=To(e,this.instance.view.wt.wtTable.spreader);return!!(this.settings.fragmentSelection===!0&&n||this.settings.fragmentSelection==="cell"&&this.isSelectedOnlyCell()&&n||!this.settings.fragmentSelection&&this.isCellEdited()&&this.isSelectedOnlyCell())}},{key:"isMouseDown",value:function(){return Aa.get(this).mouseDown}},{key:"isSelectedOnlyCell",value:function(){var e,n;return(e=(n=this.instance.getSelectedRangeLast())===null||n===void 0?void 0:n.isSingle())!==null&&e!==void 0?e:!1}},{key:"isCellEdited",value:function(){var e=this.instance.getActiveEditor();return e&&e.isOpened()}},{key:"beforeRender",value:function(e,n){e&&this.instance.runHooks("beforeViewRender",this.instance.forceFullRender,n)}},{key:"afterRender",value:function(e){e&&this.instance.runHooks("afterViewRender",this.instance.forceFullRender)}},{key:"appendRowHeader",value:function(e,n){if(n.firstChild){var i=n.firstChild;if(!lt(i,"relative")){kn(n),this.appendRowHeader(e,n);return}this.updateCellHeader(i.querySelector(".rowHeader"),e,this.instance.getRowHeader)}else{var o=this.instance,a=o.rootDocument,s=o.getRowHeader,l=a.createElement("div"),p=a.createElement("span");l.className="relative",p.className="rowHeader",this.updateCellHeader(p,e,s),l.appendChild(p),n.appendChild(l)}this.instance.runHooks("afterGetRowHeader",e,n)}},{key:"appendColHeader",value:function(e,n){if(n.firstChild){var i=n.firstChild;lt(i,"relative")?this.updateCellHeader(i.querySelector(".colHeader"),e,this.instance.getColHeader):(kn(n),this.appendColHeader(e,n))}else{var o=this.instance.rootDocument,a=o.createElement("div"),s=o.createElement("span");a.className="relative",s.className="colHeader",this.updateCellHeader(s,e,this.instance.getColHeader),a.appendChild(s),n.appendChild(a)}this.instance.runHooks("afterGetColHeader",e,n)}},{key:"updateCellHeader",value:function(e,n,i){var o=n,a=this.wt.wtOverlays.getParentOverlay(e)||this.wt;e.parentNode&&(lt(e,"colHeader")?o=a.wtTable.columnFilter.sourceToRendered(n):lt(e,"rowHeader")&&(o=a.wtTable.rowFilter.sourceToRendered(n))),o>-1?Ao(e,i(n)):(Mo(e,String.fromCharCode(160)),Ie(e,"cornerHeader"))}},{key:"maximumVisibleElementWidth",value:function(e){var n=this.wt.wtViewport.getWorkspaceWidth(),i=n-e;return i>0?i:0}},{key:"maximumVisibleElementHeight",value:function(e){var n=this.wt.wtViewport.getWorkspaceHeight(),i=n-e;return i>0?i:0}},{key:"setLastSize",value:function(e,n){var i=Aa.get(this),o=[e,n];i.lastWidth=o[0],i.lastHeight=o[1]}},{key:"getLastSize",value:function(){var e=Aa.get(this);return{width:e.lastWidth,height:e.lastHeight}}},{key:"mainViewIsActive",value:function(){return this.wt===this.activeWt}},{key:"destroy",value:function(){this.wt.destroy(),this.eventManager.destroy()}}]),t}(),Bae=Fae,Of=Rn("cellTypes"),Vae=Of.register,Wae=Of.getItem,PA=Of.hasItem,Uae=Of.getNames;Of.getValues;function ep(t){if(!PA(t))throw Error('You declared cell type "'.concat(t,`" as a string that is not mapped to a known object.
                 Cell type must be an object or a string mapped to an object registered by
                 "Handsontable.cellTypes.registerCellType" method`));return Wae(t)}function Bn(t,r){typeof t!="string"&&(r=t,t=r.CELL_TYPE);var e=r,n=e.editor,i=e.renderer,o=e.validator;n&&hn(t,n),i&&Ai(t,i),o&&su(t,o),Vae(t,r)}function tp(t){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?tp=function(e){return typeof e}:tp=function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},tp(t)}var IA="ABCDEFGHIJKLMNOPQRSTUVWXYZ",Bw=IA.length;function rp(t){for(var r=t+1,e="",n;r>0;)n=(r-1)%Bw,e=String.fromCharCode(65+n)+e,r=parseInt((r-n)/Bw,10);return e}function zae(t){var r=0;if(t)for(var e=0,n=t.length-1;e<t.length;e+=1,n-=1)r+=Math.pow(Bw,n)*(IA.indexOf(t[e])+1);return r-=1,r}function Yae(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:100,r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:4,e=[],n,i;for(n=0;n<t;n++){var o=[];for(i=0;i<r;i++)o.push(rp(i)+(n+1));e.push(o)}return e}function Gae(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:100,r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:4,e=[],n,i;for(n=0;n<t;n++){var o={};for(i=0;i<r;i++)o["prop".concat(i)]=rp(i)+(n+1);e.push(o)}return e}function Kae(t,r){for(var e=[],n,i=0;i<t;i++){n=[];for(var o=0;o<r;o++)n.push("");e.push(n)}return e}function Rf(t,r){var e=typeof r=="undefined"?!0:r;return function(i,o){return function a(s){if(!!s){if(Yt(s,t)&&s[t]!==void 0)return s[t];if(Yt(s,"type")&&s.type){if(typeof s.type!="string")throw new Error('Cell "type" must be a string');var l=ep(s.type);if(Yt(l,t))return l[t];if(e)return}return a(Object.getPrototypeOf(s))}}(typeof i=="number"?this.getCellMeta(i,o):i)}}function Vw(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,e=t,n=[];return(!Array.isArray(t)||!Array.isArray(t[0]))&&(e=[t]),e.forEach(function(i,o){Array.isArray(i)?i.forEach(function(a,s){n.push([o+r,s,a])}):Object.keys(i).forEach(function(a){n.push([o+r,a,i[a]])})}),n}function Ww(t){var r=0;return Array.isArray(t)&&(t[0]&&Array.isArray(t[0])?r=t[0].length:t[0]&&vt(t[0])&&(r=ch(t[0]))),r}function DA(t){return!!(Array.isArray(t)&&t.length&&t.every(function(r){return Array.isArray(r)}))}function NA(t){return!!(Array.isArray(t)&&t.length&&t.every(function(r){return tp(r)==="object"&&!Array.isArray(r)&&r!==null}))}var qae=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",spreadsheetColumnLabel:rp,spreadsheetColumnIndex:zae,createSpreadsheetData:Yae,createSpreadsheetObjectData:Gae,createEmptySpreadsheetData:Kae,cellMethodLookupFactory:Rf,dataRowToChangesArray:Vw,countFirstRowKeys:Ww,isArrayOfArrays:DA,isArrayOfObjects:NA});function Xae(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}function $A(t,r){for(var e=0;e<r.length;e++){var n=r[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function Zae(t,r,e){return r&&$A(t.prototype,r),e&&$A(t,e),t}var Jae=function(){function t(r){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];Xae(this,t),this.hot=r,this.data=e,this.dataType="array",this.colToProp=function(){},this.propToCol=function(){}}return Zae(t,[{key:"modifyRowData",value:function(e){var n;return this.hot.hasHook("modifyRowData")&&(n=this.hot.runHooks("modifyRowData",e)),n!==void 0&&!Number.isInteger(n)?n:this.data[e]}},{key:"getData",value:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return!this.data||this.data.length===0?this.data:this.getByRange(null,null,e)}},{key:"setData",value:function(e){this.data=e}},{key:"getAtColumn",value:function(e){var n=this,i=[];return he(this.data,function(o,a){var s=n.getAtCell(a,e);i.push(s)}),i}},{key:"getAtRow",value:function(e,n,i){var o=this,a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,s=n===void 0&&i===void 0,l=null,p=null;if(l=this.modifyRowData(e),Array.isArray(l))p=[],s?l.forEach(function(y,h){p[h]=o.getAtPhysicalCell(e,h,l)}):Qe(n,i,function(y){p[y-n]=o.getAtPhysicalCell(e,y,l)});else if(vt(l)||qt(l))if(a?p=[]:p={},!s||a){var d=0,g=this.countFirstRowKeys()-1;Qe(d,g,function(y){var h=o.colToProp(y);if(y>=(n||d)&&y<=(i||g)&&!Number.isInteger(h)){var u=o.getAtPhysicalCell(e,h,l);a?p.push(u):fh(p,h,u)}})}else Ot(l,function(y,h){fh(p,h,o.getAtPhysicalCell(e,h,l))});return p}},{key:"setAtCell",value:function(e,n,i){if(!(e>=this.countRows()||n>=this.countFirstRowKeys())){if(this.hot.hasHook("modifySourceData")){var o=ga(i);this.hot.runHooks("modifySourceData",e,this.propToCol(n),o,"set"),o.isTouched()&&(i=o.value)}Number.isInteger(n)?this.data[e][n]=i:fh(this.data[e],n,i)}}},{key:"getAtPhysicalCell",value:function(e,n,i){var o=null;if(i&&(typeof n=="string"?o=yT(i,n):typeof n=="function"?o=n(i):o=i[n]),this.hot.hasHook("modifySourceData")){var a=ga(o);this.hot.runHooks("modifySourceData",e,this.colToProp(n),a,"get"),a.isTouched()&&(o=a.value)}return o}},{key:"getAtCell",value:function(e,n){var i=this.modifyRowData(e);return this.getAtPhysicalCell(e,this.colToProp(n),i)}},{key:"getByRange",value:function(){var e=this,n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,a=!1,s=null,l=null,p=null,d=null;n===null||i===null?(a=!0,s=0,p=this.countRows()-1):(s=Math.min(n.row,i.row),l=Math.min(n.col,i.col),p=Math.max(n.row,i.row),d=Math.max(n.col,i.col));var g=[];return Qe(s,p,function(y){g.push(a?e.getAtRow(y,void 0,void 0,o):e.getAtRow(y,l,d,o))}),g}},{key:"countRows",value:function(){if(this.hot.hasHook("modifySourceLength")){var e=this.hot.runHooks("modifySourceLength");if(Number.isInteger(e))return e}return this.data.length}},{key:"countFirstRowKeys",value:function(){return Ww(this.data)}},{key:"destroy",value:function(){this.data=null,this.hot=null}}]),t}(),Qae=Jae,jA=Tr,ese=function(t){return t!==void 0&&(jA(t,"value")||jA(t,"writable"))},tse=pt,rse=$r,nse=gr,ise=br,ose=ese,ase=Yn,sse=Gc;function LA(t,r){var e=arguments.length<3?t:arguments[2],n,i;if(ise(t)===e)return t[r];if(n=ase.f(t,r),n)return ose(n)?n.value:n.get===void 0?void 0:rse(n.get,e);if(nse(i=sse(t)))return LA(i,r,e)}tse({target:"Reflect",stat:!0},{get:LA});var use=pt,lse=Mt,fse=an,HA=Yn.f,FA=Dr,cse=lse(function(){HA(1)}),hse=!FA||cse;use({target:"Object",stat:!0,forced:hse,sham:!FA},{getOwnPropertyDescriptor:function(r,e){return HA(fse(r),e)}});var dse="localHooks",BA={_localHooks:Object.create(null),addLocalHook:function(r,e){return this._localHooks[r]||(this._localHooks[r]=[]),this._localHooks[r].push(e),this},runLocalHooks:function(r,e,n,i,o,a,s){if(this._localHooks[r])for(var l=this._localHooks[r].length,p=0;p<l;p++)Yh(this._localHooks[r][p],this,e,n,i,o,a,s)},clearLocalHooks:function(){return this._localHooks={},this}};Gn(BA,"MIXIN_NAME",dse,{writable:!1,enumerable:!1});var nn=BA;function pse(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}function VA(t,r){for(var e=0;e<r.length;e++){var n=r[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function yse(t,r,e){return r&&VA(t.prototype,r),e&&VA(t,e),t}var Ma=function(){function t(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;pse(this,t),this.indexedValues=[],this.initValueOrFn=r}return yse(t,[{key:"getValues",value:function(){return this.indexedValues}},{key:"getValueAtIndex",value:function(e){var n=this.indexedValues;if(e<n.length)return n[e]}},{key:"setValues",value:function(e){this.indexedValues=e.slice(),this.runLocalHooks("change")}},{key:"setValueAtIndex",value:function(e,n){return e<this.indexedValues.length?(this.indexedValues[e]=n,this.runLocalHooks("change"),!0):!1}},{key:"clear",value:function(){this.setDefaultValues()}},{key:"getLength",value:function(){return this.getValues().length}},{key:"setDefaultValues",value:function(){var e=this,n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.indexedValues.length;this.indexedValues.length=0,qt(this.initValueOrFn)?Qe(n-1,function(i){return e.indexedValues.push(e.initValueOrFn(i))}):Qe(n-1,function(){return e.indexedValues.push(e.initValueOrFn)}),this.runLocalHooks("change")}},{key:"init",value:function(e){return this.setDefaultValues(e),this.runLocalHooks("init"),this}},{key:"insert",value:function(){this.runLocalHooks("change")}},{key:"remove",value:function(){this.runLocalHooks("change")}},{key:"destroy",value:function(){this.clearLocalHooks(),this.indexedValues=null,this.initValueOrFn=null}}]),t}();Ut(Ma,nn);function Uw(t){return bse(t)||gse(t)||vse(t)||mse()}function mse(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function vse(t,r){if(!!t){if(typeof t=="string")return zw(t,r);var e=Object.prototype.toString.call(t).slice(8,-1);if(e==="Object"&&t.constructor&&(e=t.constructor.name),e==="Map"||e==="Set")return Array.from(t);if(e==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return zw(t,r)}}function gse(t){if(typeof Symbol!="undefined"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function bse(t){if(Array.isArray(t))return zw(t)}function zw(t,r){(r==null||r>t.length)&&(r=t.length);for(var e=0,n=new Array(r);e<r;e++)n[e]=t[e];return n}function Yw(t,r,e,n){var i=e.length?e[0]:void 0;return[].concat(Uw(t.slice(0,i)),Uw(e.map(function(o,a){return qt(n)?n(o,a):n})),Uw(i===void 0?[]:t.slice(i)))}function Gw(t,r){return un(t,function(e,n){return r.includes(n)===!1})}function np(t){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?np=function(e){return typeof e}:np=function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},np(t)}function wse(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}function WA(t,r){for(var e=0;e<r.length;e++){var n=r[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function _se(t,r,e){return r&&WA(t.prototype,r),e&&WA(t,e),t}function Ef(){return typeof Reflect!="undefined"&&Reflect.get?Ef=Reflect.get:Ef=function(r,e,n){var i=Sse(r,e);if(!!i){var o=Object.getOwnPropertyDescriptor(i,e);return o.get?o.get.call(arguments.length<3?r:n):o.value}},Ef.apply(this,arguments)}function Sse(t,r){for(;!Object.prototype.hasOwnProperty.call(t,r)&&(t=Pa(t),t!==null););return t}function Cse(t,r){if(typeof r!="function"&&r!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(r&&r.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),r&&Kw(t,r)}function Kw(t,r){return Kw=Object.setPrototypeOf||function(n,i){return n.__proto__=i,n},Kw(t,r)}function kse(t){var r=Ese();return function(){var n=Pa(t),i;if(r){var o=Pa(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return Ose(this,i)}}function Ose(t,r){if(r&&(np(r)==="object"||typeof r=="function"))return r;if(r!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Rse(t)}function Rse(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Ese(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Pa(t){return Pa=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},Pa(t)}var $o=function(t){Cse(e,t);var r=kse(e);function e(){return wse(this,e),r.apply(this,arguments)}return _se(e,[{key:"insert",value:function(i,o){this.indexedValues=Yw(this.indexedValues,i,o,this.initValueOrFn),Ef(Pa(e.prototype),"insert",this).call(this,i,o)}},{key:"remove",value:function(i){this.indexedValues=Gw(this.indexedValues,i),Ef(Pa(e.prototype),"remove",this).call(this,i)}}]),e}(Ma);function ip(t){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?ip=function(e){return typeof e}:ip=function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ip(t)}function Tse(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}function UA(t,r){for(var e=0;e<r.length;e++){var n=r[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function xse(t,r,e){return r&&UA(t.prototype,r),e&&UA(t,e),t}function Ase(t,r){if(typeof r!="function"&&r!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(r&&r.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),r&&qw(t,r)}function qw(t,r){return qw=Object.setPrototypeOf||function(n,i){return n.__proto__=i,n},qw(t,r)}function Mse(t){var r=Dse();return function(){var n=op(t),i;if(r){var o=op(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return Pse(this,i)}}function Pse(t,r){if(r&&(ip(r)==="object"||typeof r=="function"))return r;if(r!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Ise(t)}function Ise(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Dse(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function op(t){return op=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},op(t)}var ap=function(t){Ase(e,t);var r=Mse(e);function e(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return Tse(this,e),r.call(this,n)}return xse(e,[{key:"getHiddenIndexes",value:function(){return pr(this.getValues(),function(i,o,a){return o&&i.push(a),i},[])}}]),e}($o);function Xw(t){return Lse(t)||jse(t)||$se(t)||Nse()}function Nse(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function $se(t,r){if(!!t){if(typeof t=="string")return Zw(t,r);var e=Object.prototype.toString.call(t).slice(8,-1);if(e==="Object"&&t.constructor&&(e=t.constructor.name),e==="Map"||e==="Set")return Array.from(t);if(e==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return Zw(t,r)}}function jse(t){if(typeof Symbol!="undefined"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function Lse(t){if(Array.isArray(t))return Zw(t)}function Zw(t,r){(r==null||r>t.length)&&(r=t.length);for(var e=0,n=new Array(r);e<r;e++)n[e]=t[e];return n}function Jw(t,r,e){return[].concat(Xw(t.slice(0,r)),Xw(e),Xw(t.slice(r)))}function Tf(t,r){return un(t,function(e){return r.includes(e)===!1})}function Qw(t,r){return bt(t,function(e){return e-r.filter(function(n){return n<e}).length})}function e1(t,r){var e=r[0],n=r.length;return bt(t,function(i){return i>=e?i+n:i})}function sp(t){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?sp=function(e){return typeof e}:sp=function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},sp(t)}function Hse(t){return Wse(t)||Vse(t)||Bse(t)||Fse()}function Fse(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Bse(t,r){if(!!t){if(typeof t=="string")return t1(t,r);var e=Object.prototype.toString.call(t).slice(8,-1);if(e==="Object"&&t.constructor&&(e=t.constructor.name),e==="Map"||e==="Set")return Array.from(t);if(e==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return t1(t,r)}}function Vse(t){if(typeof Symbol!="undefined"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function Wse(t){if(Array.isArray(t))return t1(t)}function t1(t,r){(r==null||r>t.length)&&(r=t.length);for(var e=0,n=new Array(r);e<r;e++)n[e]=t[e];return n}function Use(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}function zA(t,r){for(var e=0;e<r.length;e++){var n=r[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function zse(t,r,e){return r&&zA(t.prototype,r),e&&zA(t,e),t}function Mi(){return typeof Reflect!="undefined"&&Reflect.get?Mi=Reflect.get:Mi=function(r,e,n){var i=Yse(r,e);if(!!i){var o=Object.getOwnPropertyDescriptor(i,e);return o.get?o.get.call(arguments.length<3?r:n):o.value}},Mi.apply(this,arguments)}function Yse(t,r){for(;!Object.prototype.hasOwnProperty.call(t,r)&&(t=Vn(t),t!==null););return t}function Gse(t,r){if(typeof r!="function"&&r!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(r&&r.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),r&&r1(t,r)}function r1(t,r){return r1=Object.setPrototypeOf||function(n,i){return n.__proto__=i,n},r1(t,r)}function Kse(t){var r=Xse();return function(){var n=Vn(t),i;if(r){var o=Vn(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return qse(this,i)}}function qse(t,r){if(r&&(sp(r)==="object"||typeof r=="function"))return r;if(r!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return YA(t)}function YA(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Xse(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Vn(t){return Vn=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},Vn(t)}function Zse(t,r,e){return r in t?Object.defineProperty(t,r,{value:e,enumerable:!0,configurable:!0,writable:!0}):t[r]=e,t}var up=function(t){Gse(e,t);var r=Kse(e);function e(){var n;Use(this,e);for(var i=arguments.length,o=new Array(i),a=0;a<i;a++)o[a]=arguments[a];return n=r.call.apply(r,[this].concat(o)),Zse(YA(n),"orderOfIndexes",[]),n}return zse(e,[{key:"getValues",value:function(){var i=this;return this.orderOfIndexes.map(function(o){return i.indexedValues[o]})}},{key:"setValues",value:function(i){this.orderOfIndexes=Hse(Array(i.length).keys()),Mi(Vn(e.prototype),"setValues",this).call(this,i)}},{key:"setValueAtIndex",value:function(i,o){var a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.orderOfIndexes.length;return i<this.indexedValues.length?(this.indexedValues[i]=o,this.orderOfIndexes.includes(i)===!1&&this.orderOfIndexes.splice(a,0,i),this.runLocalHooks("change"),!0):!1}},{key:"clearValue",value:function(i){this.orderOfIndexes=Tf(this.orderOfIndexes,[i]),qt(this.initValueOrFn)?Mi(Vn(e.prototype),"setValueAtIndex",this).call(this,i,this.initValueOrFn(i)):Mi(Vn(e.prototype),"setValueAtIndex",this).call(this,i,this.initValueOrFn)}},{key:"getLength",value:function(){return this.orderOfIndexes.length}},{key:"setDefaultValues",value:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.indexedValues.length;this.orderOfIndexes.length=0,Mi(Vn(e.prototype),"setDefaultValues",this).call(this,i)}},{key:"insert",value:function(i,o){this.indexedValues=Yw(this.indexedValues,i,o,this.initValueOrFn),this.orderOfIndexes=e1(this.orderOfIndexes,o),Mi(Vn(e.prototype),"insert",this).call(this,i,o)}},{key:"remove",value:function(i){this.indexedValues=Gw(this.indexedValues,i),this.orderOfIndexes=Tf(this.orderOfIndexes,i),this.orderOfIndexes=Qw(this.orderOfIndexes,i),Mi(Vn(e.prototype),"remove",this).call(this,i)}},{key:"getEntries",value:function(){var i=this;return this.orderOfIndexes.map(function(o){return[o,i.getValueAtIndex(o)]})}}]),e}(Ma);function lp(t){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?lp=function(e){return typeof e}:lp=function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},lp(t)}function Jse(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}function GA(t,r){for(var e=0;e<r.length;e++){var n=r[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function Qse(t,r,e){return r&&GA(t.prototype,r),e&&GA(t,e),t}function eue(t,r){if(typeof r!="function"&&r!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(r&&r.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),r&&n1(t,r)}function n1(t,r){return n1=Object.setPrototypeOf||function(n,i){return n.__proto__=i,n},n1(t,r)}function tue(t){var r=iue();return function(){var n=fp(t),i;if(r){var o=fp(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return rue(this,i)}}function rue(t,r){if(r&&(lp(r)==="object"||typeof r=="function"))return r;if(r!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return nue(t)}function nue(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function iue(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function fp(t){return fp=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},fp(t)}var xf=function(t){eue(e,t);var r=tue(e);function e(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return Jse(this,e),r.call(this,n)}return Qse(e,[{key:"getTrimmedIndexes",value:function(){return pr(this.getValues(),function(i,o,a){return o&&i.push(a),i},[])}}]),e}($o),KA=new Map([["indexesSequence",{getListWithInsertedItems:Jw,getListWithRemovedItems:Tf}],["physicallyIndexed",{getListWithInsertedItems:Yw,getListWithRemovedItems:Gw}]]),qA=function(r){if(KA.has(r)===!1)throw new Error("Alter strategy with ID '".concat(r,"' does not exist."));return KA.get(r)};function cp(t){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?cp=function(e){return typeof e}:cp=function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},cp(t)}function oue(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}function XA(t,r){for(var e=0;e<r.length;e++){var n=r[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function aue(t,r,e){return r&&XA(t.prototype,r),e&&XA(t,e),t}function Af(){return typeof Reflect!="undefined"&&Reflect.get?Af=Reflect.get:Af=function(r,e,n){var i=sue(r,e);if(!!i){var o=Object.getOwnPropertyDescriptor(i,e);return o.get?o.get.call(arguments.length<3?r:n):o.value}},Af.apply(this,arguments)}function sue(t,r){for(;!Object.prototype.hasOwnProperty.call(t,r)&&(t=Ia(t),t!==null););return t}function uue(t,r){if(typeof r!="function"&&r!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(r&&r.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),r&&i1(t,r)}function i1(t,r){return i1=Object.setPrototypeOf||function(n,i){return n.__proto__=i,n},i1(t,r)}function lue(t){var r=hue();return function(){var n=Ia(t),i;if(r){var o=Ia(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return fue(this,i)}}function fue(t,r){if(r&&(cp(r)==="object"||typeof r=="function"))return r;if(r!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return cue(t)}function cue(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function hue(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Ia(t){return Ia=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},Ia(t)}var ZA=function(t){uue(e,t);var r=lue(e);function e(){return oue(this,e),r.call(this,function(n){return n})}return aue(e,[{key:"insert",value:function(i,o){var a=e1(this.indexedValues,o);this.indexedValues=Jw(a,i,o),Af(Ia(e.prototype),"insert",this).call(this,i,o)}},{key:"remove",value:function(i){var o=Tf(this.indexedValues,i);this.indexedValues=Qw(o,i),Af(Ia(e.prototype),"remove",this).call(this,i)}}]),e}(Ma),JA=new Map([["hiding",ap],["index",Ma],["linkedPhysicalIndexToValue",up],["physicalIndexToValue",$o],["trimming",xf]]);function due(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;if(!JA.has(t))throw new Error('The provided map type ("'.concat(t,'") does not exist.'));return new(JA.get(t))(r)}function pue(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}function QA(t,r){for(var e=0;e<r.length;e++){var n=r[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function yue(t,r,e){return r&&QA(t.prototype,r),e&&QA(t,e),t}var o1=0,a1=function(){function t(){pue(this,t),this.collection=new Map}return yue(t,[{key:"register",value:function(e,n){var i=this;this.collection.has(e)===!1&&(this.collection.set(e,n),n.addLocalHook("change",function(){return i.runLocalHooks("change",n)}),o1+=1)}},{key:"unregister",value:function(e){var n=this.collection.get(e);at(n)&&(n.destroy(),this.collection.delete(e),this.runLocalHooks("change",n),o1-=1)}},{key:"unregisterAll",value:function(){var e=this;this.collection.forEach(function(n,i){return e.unregister(i)}),this.collection.clear()}},{key:"get",value:function(e){return er(e)?Array.from(this.collection.values()):this.collection.get(e)}},{key:"getLength",value:function(){return this.collection.size}},{key:"removeFromEvery",value:function(e){this.collection.forEach(function(n){n.remove(e)})}},{key:"insertToEvery",value:function(e,n){this.collection.forEach(function(i){i.insert(e,n)})}},{key:"initEvery",value:function(e){this.collection.forEach(function(n){n.init(e)})}}]),t}();Ut(a1,nn);function mue(){return o1}function hp(t){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?hp=function(e){return typeof e}:hp=function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},hp(t)}function vue(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}function e4(t,r){for(var e=0;e<r.length;e++){var n=r[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function gue(t,r,e){return r&&e4(t.prototype,r),e&&e4(t,e),t}function bue(t,r){if(typeof r!="function"&&r!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(r&&r.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),r&&s1(t,r)}function s1(t,r){return s1=Object.setPrototypeOf||function(n,i){return n.__proto__=i,n},s1(t,r)}function wue(t){var r=Cue();return function(){var n=dp(t),i;if(r){var o=dp(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return _ue(this,i)}}function _ue(t,r){if(r&&(hp(r)==="object"||typeof r=="function"))return r;if(r!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Sue(t)}function Sue(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Cue(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function dp(t){return dp=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},dp(t)}var t4=function(t){bue(e,t);var r=wue(e);function e(n,i){var o;return vue(this,e),o=r.call(this),o.mergedValuesCache=[],o.aggregationFunction=n,o.fallbackValue=i,o}return gue(e,[{key:"getMergedValues",value:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;if(i===!0)return this.mergedValuesCache;if(this.getLength()===0)return[];for(var o=bt(this.get(),function(g){return g.getValues()}),a=[],s=at(o[0])&&o[0].length||0,l=0;l<s;l+=1){for(var p=[],d=0;d<this.getLength();d+=1)p.push(o[d][l]);a.push(p)}return bt(a,this.aggregationFunction)}},{key:"getMergedValueAtIndex",value:function(i,o){var a=this.getMergedValues(o)[i];return at(a)?a:this.fallbackValue}},{key:"updateCache",value:function(){this.mergedValuesCache=this.getMergedValues(!1)}}]),e}(a1);function kue(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}function r4(t,r){for(var e=0;e<r.length;e++){var n=r[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function Oue(t,r,e){return r&&r4(t.prototype,r),e&&r4(t,e),t}function Rue(t,r,e){Eue(t,r),r.set(t,e)}function Eue(t,r){if(r.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Tue(t,r,e){var n=n4(t,r,"set");return xue(t,n,e),e}function xue(t,r,e){if(r.set)r.set.call(t,e);else{if(!r.writable)throw new TypeError("attempted to set read only private field");r.value=e}}function Aue(t,r){var e=n4(t,r,"get");return Mue(t,e)}function n4(t,r,e){if(!r.has(t))throw new TypeError("attempted to "+e+" private field on non-instance");return r.get(t)}function Mue(t,r){return r.get?r.get.call(t):r.value}var u1=new WeakMap,i4=function(){function t(){kue(this,t),Rue(this,u1,{writable:!0,value:[]})}return Oue(t,[{key:"subscribe",value:function(e){return this.addLocalHook("change",e),this._write(Aue(this,u1)),this}},{key:"unsubscribe",value:function(){return this.runLocalHooks("unsubscribe"),this.clearLocalHooks(),this}},{key:"_write",value:function(e){return e.length>0&&this.runLocalHooks("change",e),this}},{key:"_writeInitialChanges",value:function(e){Tue(this,u1,e)}}]),t}();Ut(i4,nn);function o4(t,r){for(var e=[],n=0,i=0;n<t.length&&i<r.length;n++,i++)t[n]!==r[i]&&e.push({op:"replace",index:i,oldValue:t[n],newValue:r[i]});for(;n<r.length;n++)e.push({op:"insert",index:n,oldValue:void 0,newValue:r[n]});for(;i<t.length;i++)e.push({op:"remove",index:i,oldValue:t[i],newValue:void 0});return e}function Pue(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}function a4(t,r){for(var e=0;e<r.length;e++){var n=r[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function Iue(t,r,e){return r&&a4(t.prototype,r),e&&a4(t,e),t}function Mf(t,r,e){Due(t,r),r.set(t,e)}function Due(t,r){if(r.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function En(t,r){var e=s4(t,r,"get");return Nue(t,e)}function Nue(t,r){return r.get?r.get.call(t):r.value}function pp(t,r,e){var n=s4(t,r,"set");return $ue(t,n,e),e}function s4(t,r,e){if(!r.has(t))throw new TypeError("attempted to "+e+" private field on non-instance");return r.get(t)}function $ue(t,r,e){if(r.set)r.set.call(t,e);else{if(!r.writable)throw new TypeError("attempted to set read only private field");r.value=e}}var yp=new WeakMap,Pf=new WeakMap,mp=new WeakMap,vp=new WeakMap,gp=new WeakMap,jue=function(){function t(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},e=r.initialIndexValue;Pue(this,t),Mf(this,yp,{writable:!0,value:new Set}),Mf(this,Pf,{writable:!0,value:[]}),Mf(this,mp,{writable:!0,value:[]}),Mf(this,vp,{writable:!0,value:!1}),Mf(this,gp,{writable:!0,value:!1}),pp(this,gp,e!=null?e:!1)}return Iue(t,[{key:"createObserver",value:function(){var e=this,n=new i4;return En(this,yp).add(n),n.addLocalHook("unsubscribe",function(){En(e,yp).delete(n)}),n._writeInitialChanges(o4(En(this,Pf),En(this,mp))),n}},{key:"emit",value:function(e){var n=En(this,mp);(!En(this,vp)||En(this,Pf).length!==e.length)&&(e.length===0?e=new Array(n.length).fill(En(this,gp)):pp(this,Pf,new Array(e.length).fill(En(this,gp))),En(this,vp)||(pp(this,vp,!0),n=En(this,Pf)));var i=o4(n,e);En(this,yp).forEach(function(o){return o._write(i)}),pp(this,mp,e)}}]),t}();function u4(t){return Bue(t)||Fue(t)||Hue(t)||Lue()}function Lue(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Hue(t,r){if(!!t){if(typeof t=="string")return l1(t,r);var e=Object.prototype.toString.call(t).slice(8,-1);if(e==="Object"&&t.constructor&&(e=t.constructor.name),e==="Map"||e==="Set")return Array.from(t);if(e==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return l1(t,r)}}function Fue(t){if(typeof Symbol!="undefined"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function Bue(t){if(Array.isArray(t))return l1(t)}function l1(t,r){(r==null||r>t.length)&&(r=t.length);for(var e=0,n=new Array(r);e<r;e++)n[e]=t[e];return n}function Vue(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}function l4(t,r){for(var e=0;e<r.length;e++){var n=r[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function Wue(t,r,e){return r&&l4(t.prototype,r),e&&l4(t,e),t}var f1=function(){function t(){var r=this;Vue(this,t),this.indexesSequence=new ZA,this.trimmingMapsCollection=new t4(function(e){return e.some(function(n){return n===!0})},!1),this.hidingMapsCollection=new t4(function(e){return e.some(function(n){return n===!0})},!1),this.variousMapsCollection=new a1,this.hidingChangesObservable=new jue({initialIndexValue:!1}),this.notTrimmedIndexesCache=[],this.notHiddenIndexesCache=[],this.isBatched=!1,this.indexesSequenceChanged=!1,this.trimmedIndexesChanged=!1,this.hiddenIndexesChanged=!1,this.renderablePhysicalIndexesCache=[],this.fromPhysicalToVisualIndexesCache=new Map,this.fromVisualToRenderableIndexesCache=new Map,this.indexesSequence.addLocalHook("change",function(){r.indexesSequenceChanged=!0,r.updateCache(),r.runLocalHooks("change",r.indexesSequence,null)}),this.trimmingMapsCollection.addLocalHook("change",function(e){r.trimmedIndexesChanged=!0,r.updateCache(),r.runLocalHooks("change",e,r.trimmingMapsCollection)}),this.hidingMapsCollection.addLocalHook("change",function(e){r.hiddenIndexesChanged=!0,r.updateCache(),r.runLocalHooks("change",e,r.hidingMapsCollection)}),this.variousMapsCollection.addLocalHook("change",function(e){r.runLocalHooks("change",e,r.variousMapsCollection)})}return Wue(t,[{key:"suspendOperations",value:function(){this.isBatched=!0}},{key:"resumeOperations",value:function(){this.isBatched=!1,this.updateCache()}},{key:"createChangesObserver",value:function(e){if(e!=="hiding")throw new Error('Unsupported index map type "'.concat(e,'".'));return this.hidingChangesObservable.createObserver()}},{key:"createAndRegisterIndexMap",value:function(e,n,i){return this.registerMap(e,due(n,i))}},{key:"registerMap",value:function(e,n){if(this.trimmingMapsCollection.get(e)||this.hidingMapsCollection.get(e)||this.variousMapsCollection.get(e))throw Error('Map with name "'.concat(e,'" has been already registered.'));n instanceof xf?this.trimmingMapsCollection.register(e,n):n instanceof ap?this.hidingMapsCollection.register(e,n):this.variousMapsCollection.register(e,n);var i=this.getNumberOfIndexes();return i>0&&n.init(i),n}},{key:"unregisterMap",value:function(e){this.trimmingMapsCollection.unregister(e),this.hidingMapsCollection.unregister(e),this.variousMapsCollection.unregister(e)}},{key:"unregisterAll",value:function(){this.trimmingMapsCollection.unregisterAll(),this.hidingMapsCollection.unregisterAll(),this.variousMapsCollection.unregisterAll()}},{key:"getPhysicalFromVisualIndex",value:function(e){var n=this.notTrimmedIndexesCache[e];return at(n)?n:null}},{key:"getPhysicalFromRenderableIndex",value:function(e){var n=this.renderablePhysicalIndexesCache[e];return at(n)?n:null}},{key:"getVisualFromPhysicalIndex",value:function(e){var n=this.fromPhysicalToVisualIndexesCache.get(e);return at(n)?n:null}},{key:"getVisualFromRenderableIndex",value:function(e){return this.getVisualFromPhysicalIndex(this.getPhysicalFromRenderableIndex(e))}},{key:"getRenderableFromVisualIndex",value:function(e){var n=this.fromVisualToRenderableIndexesCache.get(e);return at(n)?n:null}},{key:"getFirstNotHiddenIndex",value:function(e,n){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,o=arguments.length>3&&arguments[3]!==void 0?arguments[3]:e-n,a=this.getPhysicalFromVisualIndex(e);return a===null?i===!0&&o!==e-n?this.getFirstNotHiddenIndex(o,-n,!1,o):null:this.isHidden(a)===!1?e:this.getFirstNotHiddenIndex(e+n,n,i,o)}},{key:"initToLength",value:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getNumberOfIndexes();this.notTrimmedIndexesCache=u4(new Array(e).keys()),this.notHiddenIndexesCache=u4(new Array(e).keys()),this.suspendOperations(),this.indexesSequence.init(e),this.trimmingMapsCollection.initEvery(e),this.resumeOperations(),this.suspendOperations(),this.hidingMapsCollection.initEvery(e),this.variousMapsCollection.initEvery(e),this.resumeOperations(),this.runLocalHooks("init")}},{key:"getIndexesSequence",value:function(){return this.indexesSequence.getValues()}},{key:"setIndexesSequence",value:function(e){this.indexesSequence.setValues(e)}},{key:"getNotTrimmedIndexes",value:function(){var e=this,n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;if(n===!0)return this.notTrimmedIndexesCache;var i=this.getIndexesSequence();return i.filter(function(o){return e.isTrimmed(o)===!1})}},{key:"getNotTrimmedIndexesLength",value:function(){return this.getNotTrimmedIndexes().length}},{key:"getNotHiddenIndexes",value:function(){var e=this,n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;if(n===!0)return this.notHiddenIndexesCache;var i=this.getIndexesSequence();return i.filter(function(o){return e.isHidden(o)===!1})}},{key:"getNotHiddenIndexesLength",value:function(){return this.getNotHiddenIndexes().length}},{key:"getRenderableIndexes",value:function(){var e=this,n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;if(n===!0)return this.renderablePhysicalIndexesCache;var i=this.getNotTrimmedIndexes();return i.filter(function(o){return e.isHidden(o)===!1})}},{key:"getRenderableIndexesLength",value:function(){return this.getRenderableIndexes().length}},{key:"getNumberOfIndexes",value:function(){return this.getIndexesSequence().length}},{key:"moveIndexes",value:function(e,n){var i=this;typeof e=="number"&&(e=[e]);var o=bt(e,function(g){return i.getPhysicalFromVisualIndex(g)}),a=this.getNotTrimmedIndexesLength(),s=e.length,l=Tf(this.getIndexesSequence(),o),p=a-s;if(n+s<a){var d=l.filter(function(g){return i.isTrimmed(g)===!1})[n];p=l.indexOf(d)}this.setIndexesSequence(Jw(l,p,o))}},{key:"isTrimmed",value:function(e){return this.trimmingMapsCollection.getMergedValueAtIndex(e)}},{key:"isHidden",value:function(e){return this.hidingMapsCollection.getMergedValueAtIndex(e)}},{key:"insertIndexes",value:function(e,n){var i=this.getNotTrimmedIndexes()[e],o=at(i)?i:this.getNumberOfIndexes(),a=this.getIndexesSequence().includes(i)?this.getIndexesSequence().indexOf(i):this.getNumberOfIndexes(),s=bt(new Array(n).fill(o),function(l,p){return l+p});this.suspendOperations(),this.indexesSequence.insert(a,s),this.trimmingMapsCollection.insertToEvery(a,s),this.hidingMapsCollection.insertToEvery(a,s),this.variousMapsCollection.insertToEvery(a,s),this.resumeOperations()}},{key:"removeIndexes",value:function(e){this.suspendOperations(),this.indexesSequence.remove(e),this.trimmingMapsCollection.removeFromEvery(e),this.hidingMapsCollection.removeFromEvery(e),this.variousMapsCollection.removeFromEvery(e),this.resumeOperations()}},{key:"updateCache",value:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,n=this.indexesSequenceChanged||this.trimmedIndexesChanged||this.hiddenIndexesChanged;(e===!0||this.isBatched===!1&&n===!0)&&(this.trimmingMapsCollection.updateCache(),this.hidingMapsCollection.updateCache(),this.notTrimmedIndexesCache=this.getNotTrimmedIndexes(!1),this.notHiddenIndexesCache=this.getNotHiddenIndexes(!1),this.renderablePhysicalIndexesCache=this.getRenderableIndexes(!1),this.cacheFromPhysicalToVisualIndexes(),this.cacheFromVisualToRenderabIendexes(),this.hiddenIndexesChanged&&this.hidingChangesObservable.emit(this.hidingMapsCollection.getMergedValues()),this.runLocalHooks("cacheUpdated",{indexesSequenceChanged:this.indexesSequenceChanged,trimmedIndexesChanged:this.trimmedIndexesChanged,hiddenIndexesChanged:this.hiddenIndexesChanged}),this.indexesSequenceChanged=!1,this.trimmedIndexesChanged=!1,this.hiddenIndexesChanged=!1)}},{key:"cacheFromPhysicalToVisualIndexes",value:function(){var e=this.getNotTrimmedIndexesLength();this.fromPhysicalToVisualIndexesCache.clear();for(var n=0;n<e;n+=1){var i=this.getPhysicalFromVisualIndex(n);this.fromPhysicalToVisualIndexesCache.set(i,n)}}},{key:"cacheFromVisualToRenderabIendexes",value:function(){var e=this.getRenderableIndexesLength();this.fromVisualToRenderableIndexesCache.clear();for(var n=0;n<e;n+=1){var i=this.getPhysicalFromRenderableIndex(n),o=this.getVisualFromPhysicalIndex(i);this.fromVisualToRenderableIndexesCache.set(o,n)}}}]),t}();Ut(f1,nn);var f4;function Uue(t,r){return r||(r=t.slice(0)),Object.freeze(Object.defineProperties(t,{raw:{value:Object.freeze(r)}}))}function zue(t,r){return Ot(r,function(e,n){er(t[n])&&(t[n]=e)}),t}function c4(t){var r=/^([a-zA-Z]{2})-([a-zA-Z]{2})$/,e=r.exec(t);return e?"".concat(e[1].toLowerCase(),"-").concat(e[2].toUpperCase()):t}function h4(t){at(t)&&B0(Kt(f4||(f4=Uue(['Language with code "',`" was not found. You should register particular language 
    before using it. Read more about this issue at: https://docs.handsontable.com/i18n/missing-language-code.`],['Language with code "',`" was not found. You should register particular language\\x20
    before using it. Read more about this issue at: https://docs.handsontable.com/i18n/missing-language-code.`])),t))}function Yue(t,r){var e=Array.isArray(t)&&Number.isInteger(r);return e?t[r]:t}var d4=Rn("phraseFormatters"),Gue=d4.register,Kue=d4.getValues;function que(t,r){Gue(t,r)}function Xue(){return Kue()}que("pluralize",Yue);var wt="ContextMenu:items",c1="".concat(wt,".noItems"),h1="".concat(wt,".insertRowAbove"),d1="".concat(wt,".insertRowBelow"),p1="".concat(wt,".insertColumnOnTheLeft"),y1="".concat(wt,".insertColumnOnTheRight"),m1="".concat(wt,".removeRow"),v1="".concat(wt,".removeColumn"),g1="".concat(wt,".undo"),b1="".concat(wt,".redo"),w1="".concat(wt,".readOnly"),_1="".concat(wt,".clearColumn"),S1="".concat(wt,".copy"),C1="".concat(wt,".cut"),k1="".concat(wt,".freezeColumn"),O1="".concat(wt,".unfreezeColumn"),R1="".concat(wt,".mergeCells"),E1="".concat(wt,".unmergeCells"),T1="".concat(wt,".addComment"),x1="".concat(wt,".editComment"),A1="".concat(wt,".removeComment"),M1="".concat(wt,".readOnlyComment"),P1="".concat(wt,".align"),I1="".concat(wt,".align.left"),D1="".concat(wt,".align.center"),N1="".concat(wt,".align.right"),$1="".concat(wt,".align.justify"),j1="".concat(wt,".align.top"),L1="".concat(wt,".align.middle"),H1="".concat(wt,".align.bottom"),F1="".concat(wt,".borders"),B1="".concat(wt,".borders.top"),V1="".concat(wt,".borders.right"),W1="".concat(wt,".borders.bottom"),U1="".concat(wt,".borders.left"),z1="".concat(wt,".borders.remove"),Y1="".concat(wt,".nestedHeaders.insertChildRow"),G1="".concat(wt,".nestedHeaders.detachFromParent"),K1="".concat(wt,".hideColumn"),q1="".concat(wt,".showColumn"),X1="".concat(wt,".hideRow"),Z1="".concat(wt,".showRow"),Gr="Filters:",fr="".concat(Gr,"conditions"),bp="".concat(fr,".none"),J1="".concat(fr,".isEmpty"),Q1="".concat(fr,".isNotEmpty"),e_="".concat(fr,".isEqualTo"),t_="".concat(fr,".isNotEqualTo"),r_="".concat(fr,".beginsWith"),n_="".concat(fr,".endsWith"),i_="".concat(fr,".contains"),o_="".concat(fr,".doesNotContain"),Zue="".concat(fr,".byValue"),a_="".concat(fr,".greaterThan"),s_="".concat(fr,".greaterThanOrEqualTo"),u_="".concat(fr,".lessThan"),l_="".concat(fr,".lessThanOrEqualTo"),f_="".concat(fr,".isBetween"),c_="".concat(fr,".isNotBetween"),h_="".concat(fr,".after"),d_="".concat(fr,".before"),p_="".concat(fr,".today"),y_="".concat(fr,".tomorrow"),m_="".concat(fr,".yesterday"),v_="".concat(Gr,"labels.filterByCondition"),g_="".concat(Gr,"labels.filterByValue"),b_="".concat(Gr,"labels.conjunction"),wp="".concat(Gr,"labels.disjunction"),_p="".concat(Gr,"values.blankCells"),w_="".concat(Gr,"buttons.selectAll"),__="".concat(Gr,"buttons.clear"),S_="".concat(Gr,"buttons.ok"),C_="".concat(Gr,"buttons.cancel"),k_="".concat(Gr,"buttons.placeholder.search"),O_="".concat(Gr,"buttons.placeholder.value"),R_="".concat(Gr,"buttons.placeholder.secondValue"),Jue=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",CONTEXT_MENU_ITEMS_NAMESPACE:wt,CONTEXTMENU_ITEMS_NO_ITEMS:c1,CONTEXTMENU_ITEMS_ROW_ABOVE:h1,CONTEXTMENU_ITEMS_ROW_BELOW:d1,CONTEXTMENU_ITEMS_INSERT_LEFT:p1,CONTEXTMENU_ITEMS_INSERT_RIGHT:y1,CONTEXTMENU_ITEMS_REMOVE_ROW:m1,CONTEXTMENU_ITEMS_REMOVE_COLUMN:v1,CONTEXTMENU_ITEMS_UNDO:g1,CONTEXTMENU_ITEMS_REDO:b1,CONTEXTMENU_ITEMS_READ_ONLY:w1,CONTEXTMENU_ITEMS_CLEAR_COLUMN:_1,CONTEXTMENU_ITEMS_COPY:S1,CONTEXTMENU_ITEMS_CUT:C1,CONTEXTMENU_ITEMS_FREEZE_COLUMN:k1,CONTEXTMENU_ITEMS_UNFREEZE_COLUMN:O1,CONTEXTMENU_ITEMS_MERGE_CELLS:R1,CONTEXTMENU_ITEMS_UNMERGE_CELLS:E1,CONTEXTMENU_ITEMS_ADD_COMMENT:T1,CONTEXTMENU_ITEMS_EDIT_COMMENT:x1,CONTEXTMENU_ITEMS_REMOVE_COMMENT:A1,CONTEXTMENU_ITEMS_READ_ONLY_COMMENT:M1,CONTEXTMENU_ITEMS_ALIGNMENT:P1,CONTEXTMENU_ITEMS_ALIGNMENT_LEFT:I1,CONTEXTMENU_ITEMS_ALIGNMENT_CENTER:D1,CONTEXTMENU_ITEMS_ALIGNMENT_RIGHT:N1,CONTEXTMENU_ITEMS_ALIGNMENT_JUSTIFY:$1,CONTEXTMENU_ITEMS_ALIGNMENT_TOP:j1,CONTEXTMENU_ITEMS_ALIGNMENT_MIDDLE:L1,CONTEXTMENU_ITEMS_ALIGNMENT_BOTTOM:H1,CONTEXTMENU_ITEMS_BORDERS:F1,CONTEXTMENU_ITEMS_BORDERS_TOP:B1,CONTEXTMENU_ITEMS_BORDERS_RIGHT:V1,CONTEXTMENU_ITEMS_BORDERS_BOTTOM:W1,CONTEXTMENU_ITEMS_BORDERS_LEFT:U1,CONTEXTMENU_ITEMS_REMOVE_BORDERS:z1,CONTEXTMENU_ITEMS_NESTED_ROWS_INSERT_CHILD:Y1,CONTEXTMENU_ITEMS_NESTED_ROWS_DETACH_CHILD:G1,CONTEXTMENU_ITEMS_HIDE_COLUMN:K1,CONTEXTMENU_ITEMS_SHOW_COLUMN:q1,CONTEXTMENU_ITEMS_HIDE_ROW:X1,CONTEXTMENU_ITEMS_SHOW_ROW:Z1,FILTERS_NAMESPACE:Gr,FILTERS_CONDITIONS_NAMESPACE:fr,FILTERS_CONDITIONS_NONE:bp,FILTERS_CONDITIONS_EMPTY:J1,FILTERS_CONDITIONS_NOT_EMPTY:Q1,FILTERS_CONDITIONS_EQUAL:e_,FILTERS_CONDITIONS_NOT_EQUAL:t_,FILTERS_CONDITIONS_BEGINS_WITH:r_,FILTERS_CONDITIONS_ENDS_WITH:n_,FILTERS_CONDITIONS_CONTAINS:i_,FILTERS_CONDITIONS_NOT_CONTAIN:o_,FILTERS_CONDITIONS_BY_VALUE:Zue,FILTERS_CONDITIONS_GREATER_THAN:a_,FILTERS_CONDITIONS_GREATER_THAN_OR_EQUAL:s_,FILTERS_CONDITIONS_LESS_THAN:u_,FILTERS_CONDITIONS_LESS_THAN_OR_EQUAL:l_,FILTERS_CONDITIONS_BETWEEN:f_,FILTERS_CONDITIONS_NOT_BETWEEN:c_,FILTERS_CONDITIONS_AFTER:h_,FILTERS_CONDITIONS_BEFORE:d_,FILTERS_CONDITIONS_TODAY:p_,FILTERS_CONDITIONS_TOMORROW:y_,FILTERS_CONDITIONS_YESTERDAY:m_,FILTERS_DIVS_FILTER_BY_CONDITION:v_,FILTERS_DIVS_FILTER_BY_VALUE:g_,FILTERS_LABELS_CONJUNCTION:b_,FILTERS_LABELS_DISJUNCTION:wp,FILTERS_VALUES_BLANK_CELLS:_p,FILTERS_BUTTONS_SELECT_ALL:w_,FILTERS_BUTTONS_CLEAR:__,FILTERS_BUTTONS_OK:S_,FILTERS_BUTTONS_CANCEL:C_,FILTERS_BUTTONS_PLACEHOLDER_SEARCH:k_,FILTERS_BUTTONS_PLACEHOLDER_VALUE:O_,FILTERS_BUTTONS_PLACEHOLDER_SECOND_VALUE:R_}),Ue;function ze(t,r,e){return r in t?Object.defineProperty(t,r,{value:e,enumerable:!0,configurable:!0,writable:!0}):t[r]=e,t}var Que=(Ue={languageCode:"en-US"},ze(Ue,c1,"No available options"),ze(Ue,h1,"Insert row above"),ze(Ue,d1,"Insert row below"),ze(Ue,p1,"Insert column left"),ze(Ue,y1,"Insert column right"),ze(Ue,m1,["Remove row","Remove rows"]),ze(Ue,v1,["Remove column","Remove columns"]),ze(Ue,g1,"Undo"),ze(Ue,b1,"Redo"),ze(Ue,w1,"Read only"),ze(Ue,_1,"Clear column"),ze(Ue,P1,"Alignment"),ze(Ue,I1,"Left"),ze(Ue,D1,"Center"),ze(Ue,N1,"Right"),ze(Ue,$1,"Justify"),ze(Ue,j1,"Top"),ze(Ue,L1,"Middle"),ze(Ue,H1,"Bottom"),ze(Ue,k1,"Freeze column"),ze(Ue,O1,"Unfreeze column"),ze(Ue,F1,"Borders"),ze(Ue,B1,"Top"),ze(Ue,V1,"Right"),ze(Ue,W1,"Bottom"),ze(Ue,U1,"Left"),ze(Ue,z1,"Remove border(s)"),ze(Ue,T1,"Add comment"),ze(Ue,x1,"Edit comment"),ze(Ue,A1,"Delete comment"),ze(Ue,M1,"Read-only comment"),ze(Ue,R1,"Merge cells"),ze(Ue,E1,"Unmerge cells"),ze(Ue,S1,"Copy"),ze(Ue,C1,"Cut"),ze(Ue,Y1,"Insert child row"),ze(Ue,G1,"Detach from parent"),ze(Ue,K1,["Hide column","Hide columns"]),ze(Ue,q1,["Show column","Show columns"]),ze(Ue,X1,["Hide row","Hide rows"]),ze(Ue,Z1,["Show row","Show rows"]),ze(Ue,bp,"None"),ze(Ue,J1,"Is empty"),ze(Ue,Q1,"Is not empty"),ze(Ue,e_,"Is equal to"),ze(Ue,t_,"Is not equal to"),ze(Ue,r_,"Begins with"),ze(Ue,n_,"Ends with"),ze(Ue,i_,"Contains"),ze(Ue,o_,"Does not contain"),ze(Ue,a_,"Greater than"),ze(Ue,s_,"Greater than or equal to"),ze(Ue,u_,"Less than"),ze(Ue,l_,"Less than or equal to"),ze(Ue,f_,"Is between"),ze(Ue,c_,"Is not between"),ze(Ue,h_,"After"),ze(Ue,d_,"Before"),ze(Ue,p_,"Today"),ze(Ue,y_,"Tomorrow"),ze(Ue,m_,"Yesterday"),ze(Ue,_p,"Blank cells"),ze(Ue,v_,"Filter by condition"),ze(Ue,g_,"Filter by value"),ze(Ue,b_,"And"),ze(Ue,wp,"Or"),ze(Ue,w_,"Select all"),ze(Ue,__,"Clear"),ze(Ue,S_,"OK"),ze(Ue,C_,"Cancel"),ze(Ue,k_,"Search"),ze(Ue,O_,"Value"),ze(Ue,R_,"Second value"),Ue),p4=Que,E_=p4.languageCode,Sp=Rn("languagesDictionaries"),ele=Sp.register,y4=Sp.getItem,tle=Sp.hasItem,rle=Sp.getValues;m4(p4);function m4(t,r){var e=t,n=r;return vt(t)&&(n=t,e=n.languageCode),nle(e,n),ele(e,zr(n)),zr(n)}function nle(t,r){t!==E_&&zue(r,y4(E_))}function v4(t){return T_(t)?zr(y4(t)):null}function T_(t){return tle(t)}function ile(){return rle()}function g4(t,r,e){var n=v4(t);if(n===null)return null;var i=n[r];if(er(i))return null;var o=ole(i,e);return Array.isArray(o)?o[0]:o}function ole(t,r){var e=t;return he(Xue(),function(n){e=n(t,r)}),e}function ale(t){var r=c4(t);return T_(r)||(r=E_,h4(t)),r}var If=new Wt,jo=new Set,uu=0;function sle(t){uu===0&&(If.addEventListener(t,"keydown",function(r){jo.has(r.keyCode)||jo.add(r.keyCode)}),If.addEventListener(t,"keyup",function(r){jo.has(r.keyCode)&&jo.delete(r.keyCode)}),If.addEventListener(t,"visibilitychange",function(){t.hidden&&jo.clear()}),If.addEventListener(t.defaultView,"blur",function(){jo.clear()})),uu+=1}function ule(){uu>0&&(uu-=1),uu===0&&lle()}function lle(){If.clearEvents(),jo.clear(),uu=0}function Cp(){var t=Array.from(jo.values());return t.some(function(r){return lw(r)})}var fle=pt,cle=Dr,hle=NO,dle=an,ple=Yn,yle=Rs;fle({target:"Object",stat:!0,sham:!cle},{getOwnPropertyDescriptors:function(r){for(var e=dle(r),n=ple.f,i=hle(e),o={},a=0,s,l;i.length>a;)l=n(e,s=i[a++]),l!==void 0&&yle(o,s,l);return o}});var kp="active-header",Op="area",Df="cell",x_="fill",Nf="header",A_="custom-selection";function Rp(t){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?Rp=function(e){return typeof e}:Rp=function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Rp(t)}function mle(t,r){return wle(t)||ble(t,r)||gle(t,r)||vle()}function vle(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function gle(t,r){if(!!t){if(typeof t=="string")return b4(t,r);var e=Object.prototype.toString.call(t).slice(8,-1);if(e==="Object"&&t.constructor&&(e=t.constructor.name),e==="Map"||e==="Set")return Array.from(t);if(e==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return b4(t,r)}}function b4(t,r){(r==null||r>t.length)&&(r=t.length);for(var e=0,n=new Array(r);e<r;e++)n[e]=t[e];return n}function ble(t,r){var e=t==null?null:typeof Symbol!="undefined"&&t[Symbol.iterator]||t["@@iterator"];if(e!=null){var n=[],i=!0,o=!1,a,s;try{for(e=e.call(t);!(i=(a=e.next()).done)&&(n.push(a.value),!(r&&n.length===r));i=!0);}catch(l){o=!0,s=l}finally{try{!i&&e.return!=null&&e.return()}finally{if(o)throw s}}return n}}function wle(t){if(Array.isArray(t))return t}function _le(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}function w4(t,r){for(var e=0;e<r.length;e++){var n=r[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function Sle(t,r,e){return r&&w4(t.prototype,r),e&&w4(t,e),t}function Ep(){return typeof Reflect!="undefined"&&Reflect.get?Ep=Reflect.get:Ep=function(r,e,n){var i=Cle(r,e);if(!!i){var o=Object.getOwnPropertyDescriptor(i,e);return o.get?o.get.call(arguments.length<3?r:n):o.value}},Ep.apply(this,arguments)}function Cle(t,r){for(;!Object.prototype.hasOwnProperty.call(t,r)&&(t=lu(t),t!==null););return t}function kle(t,r){if(typeof r!="function"&&r!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(r&&r.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),r&&M_(t,r)}function M_(t,r){return M_=Object.setPrototypeOf||function(n,i){return n.__proto__=i,n},M_(t,r)}function Ole(t){var r=Tle();return function(){var n=lu(t),i;if(r){var o=lu(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return Rle(this,i)}}function Rle(t,r){if(r&&(Rp(r)==="object"||typeof r=="function"))return r;if(r!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Ele(t)}function Ele(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Tle(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function lu(t){return lu=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},lu(t)}var xle=function(t){kle(e,t);var r=Ole(e);function e(n,i){var o;return _le(this,e),o=r.call(this,n,null),o.visualCellRange=i||null,o.commit(),o}return Sle(e,[{key:"add",value:function(i){return this.visualCellRange===null?this.visualCellRange=new Rr(i):this.visualCellRange.expand(i),this}},{key:"clear",value:function(){return this.visualCellRange=null,Ep(lu(e.prototype),"clear",this).call(this)}},{key:"findVisibleCoordsInRange",value:function(i,o,a){var s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:a,l=this.findVisibleCoordsInRowsRange(i.row,o.row,a);if(l===null)return null;var p=this.findVisibleCoordsInColumnsRange(i.col,o.col,s);return p===null?null:new ke(l,p)}},{key:"findVisibleCoordsInRowsRange",value:function(i,o,a){var s=this.settings.visualToRenderableCoords({row:i,col:-1}),l=s.row;return o===i&&l===null?null:l===null?this.findVisibleCoordsInRowsRange(i+a,o,a):i}},{key:"findVisibleCoordsInColumnsRange",value:function(i,o,a){var s=this.settings.visualToRenderableCoords({row:-1,col:i}),l=s.col;return o===i&&l===null?null:l===null?this.findVisibleCoordsInColumnsRange(i+a,o,a):i}},{key:"findVisibleHeaderRange",value:function(i,o,a,s){var l=this.findVisibleCoordsInRowsRange(i.row,o.row,a),p=this.findVisibleCoordsInRowsRange(o.row,i.row,-a),d=this.findVisibleCoordsInColumnsRange(i.col,o.col,s),g=this.findVisibleCoordsInColumnsRange(o.col,i.col,-s);return l===null&&p===null&&d===null&&g===null?null:[new ke(l,d),new ke(p,g)]}},{key:"commit",value:function(){if(this.visualCellRange===null)return this;var i=this.visualCellRange,o=i.from,a=i.to,s=this.getRowSearchDirection(this.visualCellRange),l=this.getColumnSearchDirection(this.visualCellRange),p=this.findVisibleCoordsInRange(o,a,s,l),d=this.findVisibleCoordsInRange(a,o,-s,-l);if(p===null||d===null){var g=this.settings.type==="header",y=null;if(g){var h=this.findVisibleHeaderRange(o,a,s,l),u=mle(h,2),f=u[0],c=u[1];y=this.createRenderableCellRange(f,c)}this.cellRange=y}else this.cellRange=this.createRenderableCellRange(p,d);return this}},{key:"adjustCoordinates",value:function(i){var o=this.getRowSearchDirection(i),a=this.getColumnSearchDirection(i),s=i.from.clone().normalize(),l=i.to.clone().normalize(),p=this.findVisibleCoordsInRange(s,l,o,a);if(p!==null){if(this.cellRange===null){var d=this.settings.visualToRenderableCoords(p);this.cellRange=new Rr(d)}return i.setHighlight(p),this}return i.setHighlight(i.from),this}},{key:"getCorners",value:function(){var i=this.cellRange,o=i.from,a=i.to,s=o.row===null||a.row===null,l=o.col===null||a.col===null,p=new ke(s?null:Math.min(o.row,a.row),l?null:Math.min(o.col,a.col)),d=new ke(s?null:Math.max(o.row,a.row),l?null:Math.max(o.col,a.col));return[p.row,p.col,d.row,d.col]}},{key:"getVisualCorners",value:function(){var i=this.settings.renderableToVisualCoords(this.cellRange.getTopLeftCorner()),o=this.settings.renderableToVisualCoords(this.cellRange.getBottomRightCorner());return[i.row,i.col,o.row,o.col]}},{key:"createRenderableCellRange",value:function(i,o){var a=this.settings.visualToRenderableCoords(i),s=this.settings.visualToRenderableCoords(o);return new Rr(a,a,s)}},{key:"getRowSearchDirection",value:function(i){return i.from.row<i.to.row?1:-1}},{key:"getColumnSearchDirection",value:function(i){return i.from.col<i.to.col?1:-1}}]),e}(tie),fu=xle,Ale=["activeHeaderClassName"];function _4(t,r){var e=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);r&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),e.push.apply(e,n)}return e}function S4(t){for(var r=1;r<arguments.length;r++){var e=arguments[r]!=null?arguments[r]:{};r%2?_4(Object(e),!0).forEach(function(n){Mle(t,n,e[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(e)):_4(Object(e)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(e,n))})}return t}function Mle(t,r,e){return r in t?Object.defineProperty(t,r,{value:e,enumerable:!0,configurable:!0,writable:!0}):t[r]=e,t}function Ple(t,r){if(t==null)return{};var e=Ile(t,r),n,i;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);for(i=0;i<o.length;i++)n=o[i],!(r.indexOf(n)>=0)&&(!Object.prototype.propertyIsEnumerable.call(t,n)||(e[n]=t[n]))}return e}function Ile(t,r){if(t==null)return{};var e={},n=Object.keys(t),i,o;for(o=0;o<n.length;o++)i=n[o],!(r.indexOf(i)>=0)&&(e[i]=t[i]);return e}function Dle(t){var r=t.activeHeaderClassName,e=Ple(t,Ale),n=new fu(S4(S4({highlightHeaderClassName:r},e),{},{selectionType:kp}));return n}var Nle=["layerLevel","areaCornerVisible"];function C4(t,r){var e=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);r&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),e.push.apply(e,n)}return e}function k4(t){for(var r=1;r<arguments.length;r++){var e=arguments[r]!=null?arguments[r]:{};r%2?C4(Object(e),!0).forEach(function(n){$le(t,n,e[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(e)):C4(Object(e)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(e,n))})}return t}function $le(t,r,e){return r in t?Object.defineProperty(t,r,{value:e,enumerable:!0,configurable:!0,writable:!0}):t[r]=e,t}function jle(t,r){if(t==null)return{};var e=Lle(t,r),n,i;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);for(i=0;i<o.length;i++)n=o[i],!(r.indexOf(n)>=0)&&(!Object.prototype.propertyIsEnumerable.call(t,n)||(e[n]=t[n]))}return e}function Lle(t,r){if(t==null)return{};var e={},n=Object.keys(t),i,o;for(o=0;o<n.length;o++)i=n[o],!(r.indexOf(i)>=0)&&(e[i]=t[i]);return e}function Hle(t){var r=t.layerLevel,e=t.areaCornerVisible,n=jle(t,Nle),i=new fu(k4(k4({className:"area",markIntersections:!0,layerLevel:Math.min(r,7),border:{width:1,color:"#4b89ff",cornerVisible:e}},n),{},{selectionType:Op}));return i}var Fle=["cellCornerVisible"];function O4(t,r){var e=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);r&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),e.push.apply(e,n)}return e}function R4(t){for(var r=1;r<arguments.length;r++){var e=arguments[r]!=null?arguments[r]:{};r%2?O4(Object(e),!0).forEach(function(n){Ble(t,n,e[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(e)):O4(Object(e)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(e,n))})}return t}function Ble(t,r,e){return r in t?Object.defineProperty(t,r,{value:e,enumerable:!0,configurable:!0,writable:!0}):t[r]=e,t}function Vle(t,r){if(t==null)return{};var e=Wle(t,r),n,i;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);for(i=0;i<o.length;i++)n=o[i],!(r.indexOf(n)>=0)&&(!Object.prototype.propertyIsEnumerable.call(t,n)||(e[n]=t[n]))}return e}function Wle(t,r){if(t==null)return{};var e={},n=Object.keys(t),i,o;for(o=0;o<n.length;o++)i=n[o],!(r.indexOf(i)>=0)&&(e[i]=t[i]);return e}function Ule(t){var r=t.cellCornerVisible,e=Vle(t,Fle),n=new fu(R4(R4({className:"current",border:{width:2,color:"#4b89ff",cornerVisible:r}},e),{},{selectionType:Df}));return n}var zle=["border","visualCellRange"];function E4(t,r){var e=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);r&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),e.push.apply(e,n)}return e}function P_(t){for(var r=1;r<arguments.length;r++){var e=arguments[r]!=null?arguments[r]:{};r%2?E4(Object(e),!0).forEach(function(n){Yle(t,n,e[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(e)):E4(Object(e)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(e,n))})}return t}function Yle(t,r,e){return r in t?Object.defineProperty(t,r,{value:e,enumerable:!0,configurable:!0,writable:!0}):t[r]=e,t}function Gle(t,r){if(t==null)return{};var e=Kle(t,r),n,i;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);for(i=0;i<o.length;i++)n=o[i],!(r.indexOf(n)>=0)&&(!Object.prototype.propertyIsEnumerable.call(t,n)||(e[n]=t[n]))}return e}function Kle(t,r){if(t==null)return{};var e={},n=Object.keys(t),i,o;for(o=0;o<n.length;o++)i=n[o],!(r.indexOf(i)>=0)&&(e[i]=t[i]);return e}function qle(t){var r=t.border,e=t.visualCellRange,n=Gle(t,zle),i=new fu(P_(P_(P_({},r),n),{},{selectionType:A_}),e);return i}var T4=Dr,Xle=ht,Zle=$r,Jle=Mt,I_=wl,Qle=Ac,efe=al,tfe=Qr,rfe=ul,cu=Object.assign,x4=Object.defineProperty,nfe=Xle([].concat),ife=!cu||Jle(function(){if(T4&&cu({b:1},cu(x4({},"a",{enumerable:!0,get:function(){x4(this,"b",{value:3,enumerable:!1})}}),{b:2})).b!==1)return!0;var t={},r={},e=Symbol(),n="abcdefghijklmnopqrst";return t[e]=7,n.split("").forEach(function(i){r[i]=i}),cu({},t)[e]!=7||I_(cu({},r)).join("")!=n})?function(r,e){for(var n=tfe(r),i=arguments.length,o=1,a=Qle.f,s=efe.f;i>o;)for(var l=rfe(arguments[o++]),p=a?nfe(I_(l),a(l)):I_(l),d=p.length,g=0,y;d>g;)y=p[g++],(!T4||Zle(s,l,y))&&(n[y]=l[y]);return n}:cu,ofe=pt,A4=ife;ofe({target:"Object",stat:!0,forced:Object.assign!==A4},{assign:A4});function M4(t,r){var e=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);r&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),e.push.apply(e,n)}return e}function P4(t){for(var r=1;r<arguments.length;r++){var e=arguments[r]!=null?arguments[r]:{};r%2?M4(Object(e),!0).forEach(function(n){afe(t,n,e[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(e)):M4(Object(e)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(e,n))})}return t}function afe(t,r,e){return r in t?Object.defineProperty(t,r,{value:e,enumerable:!0,configurable:!0,writable:!0}):t[r]=e,t}function sfe(t){var r=Object.assign({},t),e=new fu(P4(P4({className:"fill",border:{width:1,color:"#ff0000"}},r),{},{selectionType:x_}));return e}var ufe=["headerClassName","rowClassName","columnClassName"];function I4(t,r){var e=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);r&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),e.push.apply(e,n)}return e}function D4(t){for(var r=1;r<arguments.length;r++){var e=arguments[r]!=null?arguments[r]:{};r%2?I4(Object(e),!0).forEach(function(n){lfe(t,n,e[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(e)):I4(Object(e)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(e,n))})}return t}function lfe(t,r,e){return r in t?Object.defineProperty(t,r,{value:e,enumerable:!0,configurable:!0,writable:!0}):t[r]=e,t}function ffe(t,r){if(t==null)return{};var e=cfe(t,r),n,i;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);for(i=0;i<o.length;i++)n=o[i],!(r.indexOf(n)>=0)&&(!Object.prototype.propertyIsEnumerable.call(t,n)||(e[n]=t[n]))}return e}function cfe(t,r){if(t==null)return{};var e={},n=Object.keys(t),i,o;for(o=0;o<n.length;o++)i=n[o],!(r.indexOf(i)>=0)&&(e[i]=t[i]);return e}function hfe(t){var r=t.headerClassName,e=t.rowClassName,n=t.columnClassName,i=ffe(t,ufe),o=new fu(D4(D4({className:"highlight",highlightHeaderClassName:r,highlightRowClassName:e,highlightColumnClassName:n},i),{},{highlightOnlyClosestHeader:!0,selectionType:Nf}));return o}function N4(t,r){var e=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);r&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),e.push.apply(e,n)}return e}function dfe(t){for(var r=1;r<arguments.length;r++){var e=arguments[r]!=null?arguments[r]:{};r%2?N4(Object(e),!0).forEach(function(n){pfe(t,n,e[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(e)):N4(Object(e)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(e,n))})}return t}function pfe(t,r,e){return r in t?Object.defineProperty(t,r,{value:e,enumerable:!0,configurable:!0,writable:!0}):t[r]=e,t}var $4=Rn("highlight/types"),hu=$4.register,yfe=$4.getItem;hu(kp,Dle);hu(Op,Hle);hu(Df,Ule);hu(A_,qle);hu(x_,sfe);hu(Nf,hfe);function du(t,r){return yfe(t)(dfe({type:t},r))}function Lo(t){return bfe(t)||gfe(t)||vfe(t)||mfe()}function mfe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function vfe(t,r){if(!!t){if(typeof t=="string")return D_(t,r);var e=Object.prototype.toString.call(t).slice(8,-1);if(e==="Object"&&t.constructor&&(e=t.constructor.name),e==="Map"||e==="Set")return Array.from(t);if(e==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return D_(t,r)}}function gfe(t){if(typeof Symbol!="undefined"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function bfe(t){if(Array.isArray(t))return D_(t)}function D_(t,r){(r==null||r>t.length)&&(r=t.length);for(var e=0,n=new Array(r);e<r;e++)n[e]=t[e];return n}function j4(t,r){var e=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);r&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),e.push.apply(e,n)}return e}function $f(t){for(var r=1;r<arguments.length;r++){var e=arguments[r]!=null?arguments[r]:{};r%2?j4(Object(e),!0).forEach(function(n){wfe(t,n,e[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(e)):j4(Object(e)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(e,n))})}return t}function wfe(t,r,e){return r in t?Object.defineProperty(t,r,{value:e,enumerable:!0,configurable:!0,writable:!0}):t[r]=e,t}function _fe(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}function L4(t,r){for(var e=0;e<r.length;e++){var n=r[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function Sfe(t,r,e){return r&&L4(t.prototype,r),e&&L4(t,e),t}var Cfe=function(t){function r(e){_fe(this,r),this.options=e,this.layerLevel=0,this.cell=du(Df,e),this.fill=du(x_,e),this.areas=new Map,this.headers=new Map,this.activeHeaders=new Map,this.customSelections=[]}return Sfe(r,[{key:"isEnabledFor",value:function(n,i){var o=n;n===Df&&(o="current");var a=this.options.disabledCellSelection(i.row,i.col);return typeof a=="string"&&(a=[a]),a===!1||Array.isArray(a)&&!a.includes(o)}},{key:"useLayerLevel",value:function(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return this.layerLevel=n,this}},{key:"getCell",value:function(){return this.cell}},{key:"getFill",value:function(){return this.fill}},{key:"createOrGetArea",value:function(){var n=this.layerLevel,i;return this.areas.has(n)?i=this.areas.get(n):(i=du(Op,$f({layerLevel:n},this.options)),this.areas.set(n,i)),i}},{key:"getAreas",value:function(){return Lo(this.areas.values())}},{key:"createOrGetHeader",value:function(){var n=this.layerLevel,i;return this.headers.has(n)?i=this.headers.get(n):(i=du(Nf,$f({},this.options)),this.headers.set(n,i)),i}},{key:"getHeaders",value:function(){return Lo(this.headers.values())}},{key:"createOrGetActiveHeader",value:function(){var n=this.layerLevel,i;return this.activeHeaders.has(n)?i=this.activeHeaders.get(n):(i=du(kp,$f({},this.options)),this.activeHeaders.set(n,i)),i}},{key:"getActiveHeaders",value:function(){return Lo(this.activeHeaders.values())}},{key:"getCustomSelections",value:function(){return Lo(this.customSelections.values())}},{key:"addCustomSelection",value:function(n){this.customSelections.push(du(A_,$f($f({},this.options),n)))}},{key:"clear",value:function(){this.cell.clear(),this.fill.clear(),he(this.areas.values(),function(n){return void n.clear()}),he(this.headers.values(),function(n){return void n.clear()}),he(this.activeHeaders.values(),function(n){return void n.clear()})}},{key:t,value:function(){return[this.cell,this.fill].concat(Lo(this.areas.values()),Lo(this.headers.values()),Lo(this.activeHeaders.values()),Lo(this.customSelections))[Symbol.iterator]()}}]),r}(Symbol.iterator),kfe=Cfe;function Ofe(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}function H4(t,r){for(var e=0;e<r.length;e++){var n=r[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function Rfe(t,r,e){return r&&H4(t.prototype,r),e&&H4(t,e),t}var Efe=function(t){function r(){Ofe(this,r),this.ranges=[]}return Rfe(r,[{key:"isEmpty",value:function(){return this.size()===0}},{key:"set",value:function(n){return this.clear(),this.ranges.push(new Rr(n)),this}},{key:"add",value:function(n){return this.ranges.push(new Rr(n)),this}},{key:"pop",value:function(){return this.ranges.pop(),this}},{key:"current",value:function(){return this.peekByIndex(0)}},{key:"previous",value:function(){return this.peekByIndex(-1)}},{key:"includes",value:function(n){return this.ranges.some(function(i){return i.includes(n)})}},{key:"clear",value:function(){return this.ranges.length=0,this}},{key:"size",value:function(){return this.ranges.length}},{key:"peekByIndex",value:function(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,i=this.size()+n-1,o;return i>=0&&(o=this.ranges[i]),o}},{key:t,value:function(){return this.ranges[Symbol.iterator]()}}]),r}(Symbol.iterator),Tfe=Efe;function xfe(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}function F4(t,r){for(var e=0;e<r.length;e++){var n=r[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function Afe(t,r,e){return r&&F4(t.prototype,r),e&&F4(t,e),t}var B4=function(){function t(r,e){xfe(this,t),this.range=r,this.options=e}return Afe(t,[{key:"transformStart",value:function(e,n){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,o=new ke(e,n),a=this.range.current().highlight,s=this.options.visualToRenderableCoords(a),l=s.row,p=s.col,d=a,g=0,y=0;if(this.runLocalHooks("beforeTransformStart",o),l!==null&&p!==null){var h=this.options.countRows(),u=this.options.countCols(),f=this.options.fixedRowsBottom(),c=this.options.minSpareRows(),v=this.options.minSpareCols(),m=this.options.autoWrapRow(),b=this.options.autoWrapCol();l+e>h-1?i&&c>0&&!(f&&l>=h-f-1)?(this.runLocalHooks("insertRowRequire",h),h=this.options.countRows()):b&&(o.row=1-h,o.col=p+o.col===u-1?1-u:1):b&&l+o.row<0&&p+o.col>=0&&(o.row=h-1,o.col=p+o.col===0?u-1:-1),p+o.col>u-1?i&&v>0?(this.runLocalHooks("insertColRequire",u),u=this.options.countCols()):m&&(o.row=l+o.row===h-1?1-h:1,o.col=1-u):m&&p+o.col<0&&l+o.row>=0&&(o.row=l+o.row===0?h-1:-1,o.col=u-1);var w=new ke(l+o.row,p+o.col);g=0,y=0,w.row<0?(g=-1,w.row=0):w.row>0&&w.row>=h&&(g=1,w.row=h-1),w.col<0?(y=-1,w.col=0):w.col>0&&w.col>=u&&(y=1,w.col=u-1),d=this.options.renderableToVisualCoords(w)}return this.runLocalHooks("afterTransformStart",d,g,y),d}},{key:"transformEnd",value:function(e,n){var i=new ke(e,n),o=this.range.current(),a=o.to,s=0,l=0;this.runLocalHooks("beforeTransformEnd",i);var p=this.options.visualToRenderableCoords(o.highlight),d=p.row,g=p.col;if(d!==null&&g!==null){var y=this.options.countRows(),h=this.options.countCols(),u=this.options.visualToRenderableCoords(o.to),f=u.row,c=u.col,v=new ke(f+i.row,c+i.col);s=0,l=0,v.row<0?(s=-1,v.row=0):v.row>0&&v.row>=y&&(s=1,v.row=y-1),v.col<0?(l=-1,v.col=0):v.col>0&&v.col>=h&&(l=1,v.col=h-1),a=this.options.renderableToVisualCoords(v)}return this.runLocalHooks("afterTransformEnd",a,s,l),a}}]),t}();Ut(B4,nn);var Mfe=B4;function V4(t,r){return Nfe(t)||Dfe(t,r)||Ife(t,r)||Pfe()}function Pfe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Ife(t,r){if(!!t){if(typeof t=="string")return W4(t,r);var e=Object.prototype.toString.call(t).slice(8,-1);if(e==="Object"&&t.constructor&&(e=t.constructor.name),e==="Map"||e==="Set")return Array.from(t);if(e==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return W4(t,r)}}function W4(t,r){(r==null||r>t.length)&&(r=t.length);for(var e=0,n=new Array(r);e<r;e++)n[e]=t[e];return n}function Dfe(t,r){var e=t==null?null:typeof Symbol!="undefined"&&t[Symbol.iterator]||t["@@iterator"];if(e!=null){var n=[],i=!0,o=!1,a,s;try{for(e=e.call(t);!(i=(a=e.next()).done)&&(n.push(a.value),!(r&&n.length===r));i=!0);}catch(l){o=!0,s=l}finally{try{!i&&e.return!=null&&e.return()}finally{if(o)throw s}}return n}}function Nfe(t){if(Array.isArray(t))return t}function Tp(t){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?Tp=function(e){return typeof e}:Tp=function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Tp(t)}var xp=0,Ap=1,U4=2,N_=3,$fe=[N_,U4],jfe=[["number"],["number","string"],["number","undefined"],["number","string","undefined"]],$_=Symbol("root"),z4=Symbol("child");function pu(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:$_;if(r!==$_&&r!==z4)throw new Error("The second argument is used internally only and cannot be overwritten.");var e=Array.isArray(t),n=r===$_,i=xp;if(e){var o=t[0];if(t.length===0)i=Ap;else if(n&&o instanceof Rr)i=N_;else if(n&&Array.isArray(o))i=pu(o,z4);else if(t.length>=2&&t.length<=4){var a=!t.some(function(s,l){return!jfe[l].includes(Tp(s))});a&&(i=U4)}}return i}function jf(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},e=r.keepDirection,n=e===void 0?!1:e,i=r.propToCol;if(!$fe.includes(t))throw new Error("Unsupported selection ranges schema type was provided.");return function(o){var a=t===N_,s=a?o.from.row:o[0],l=a?o.from.col:o[1],p=a?o.to.row:o[2],d=a?o.to.col:o[3];if(typeof i=="function"&&(typeof l=="string"&&(l=i(l)),typeof d=="string"&&(d=i(d))),er(p)&&(p=s),er(d)&&(d=l),!n){var g=s,y=l,h=p,u=d;s=Math.min(g,h),l=Math.min(y,u),p=Math.max(g,h),d=Math.max(y,u)}return[s,l,p,d]}}function Lfe(t){var r=pu(t);if(r===xp||r===Ap)return[];var e=jf(r),n=new Set;he(t,function(a){var s=e(a),l=V4(s,4),p=l[1],d=l[3],g=Math.max(p,0),y=d-g+1;he(Array.from(new Array(y),function(h,u){return g+u}),function(h){n.has(h)||n.add(h)})});var i=Array.from(n).sort(function(a,s){return a-s}),o=pr(i,function(a,s,l,p){return l!==0&&s===p[l-1]+1?a[a.length-1][1]+=1:a.push([s,1]),a},[]);return o}function Hfe(t){var r=pu(t);if(r===xp||r===Ap)return[];var e=jf(r),n=new Set;he(t,function(a){var s=e(a),l=V4(s,3),p=l[0],d=l[2],g=Math.max(p,0),y=d-g+1;he(Array.from(new Array(y),function(h,u){return g+u}),function(h){n.has(h)||n.add(h)})});var i=Array.from(n).sort(function(a,s){return a-s}),o=pr(i,function(a,s,l,p){return l!==0&&s===p[l-1]+1?a[a.length-1][1]+=1:a.push([s,1]),a},[]);return o}function Ho(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1/0;return typeof t=="number"&&t>=0&&t<r}var Y4;function G4(t,r){return Wfe(t)||Vfe(t,r)||Bfe(t,r)||Ffe()}function Ffe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Bfe(t,r){if(!!t){if(typeof t=="string")return K4(t,r);var e=Object.prototype.toString.call(t).slice(8,-1);if(e==="Object"&&t.constructor&&(e=t.constructor.name),e==="Map"||e==="Set")return Array.from(t);if(e==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return K4(t,r)}}function K4(t,r){(r==null||r>t.length)&&(r=t.length);for(var e=0,n=new Array(r);e<r;e++)n[e]=t[e];return n}function Vfe(t,r){var e=t==null?null:typeof Symbol!="undefined"&&t[Symbol.iterator]||t["@@iterator"];if(e!=null){var n=[],i=!0,o=!1,a,s;try{for(e=e.call(t);!(i=(a=e.next()).done)&&(n.push(a.value),!(r&&n.length===r));i=!0);}catch(l){o=!0,s=l}finally{try{!i&&e.return!=null&&e.return()}finally{if(o)throw s}}return n}}function Wfe(t){if(Array.isArray(t))return t}function Ufe(t,r){return r||(r=t.slice(0)),Object.freeze(Object.defineProperties(t,{raw:{value:Object.freeze(r)}}))}function zfe(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}function q4(t,r){for(var e=0;e<r.length;e++){var n=r[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function Yfe(t,r,e){return r&&q4(t.prototype,r),e&&q4(t,e),t}var X4=function(){function t(r,e){var n=this;zfe(this,t),this.settings=r,this.tableProps=e,this.inProgress=!1,this.selectedByCorner=!1,this.selectedByRowHeader=new Set,this.selectedByColumnHeader=new Set,this.selectedRange=new Tfe,this.highlight=new kfe({headerClassName:r.currentHeaderClassName,activeHeaderClassName:r.activeHeaderClassName,rowClassName:r.currentRowClassName,columnClassName:r.currentColClassName,disabledCellSelection:function(o,a){return n.tableProps.isDisabledCellSelection(o,a)},cellCornerVisible:function(){return n.isCellCornerVisible.apply(n,arguments)},areaCornerVisible:function(){return n.isAreaCornerVisible.apply(n,arguments)},visualToRenderableCoords:function(o){return n.tableProps.visualToRenderableCoords(o)},renderableToVisualCoords:function(o){return n.tableProps.renderableToVisualCoords(o)}}),this.transformation=new Mfe(this.selectedRange,{countRows:function(){return n.tableProps.countRowsTranslated()},countCols:function(){return n.tableProps.countColsTranslated()},visualToRenderableCoords:function(o){return n.tableProps.visualToRenderableCoords(o)},renderableToVisualCoords:function(o){return n.tableProps.renderableToVisualCoords(o)},fixedRowsBottom:function(){return r.fixedRowsBottom},minSpareRows:function(){return r.minSpareRows},minSpareCols:function(){return r.minSpareCols},autoWrapRow:function(){return r.autoWrapRow},autoWrapCol:function(){return r.autoWrapCol}}),this.transformation.addLocalHook("beforeTransformStart",function(){for(var i=arguments.length,o=new Array(i),a=0;a<i;a++)o[a]=arguments[a];return n.runLocalHooks.apply(n,["beforeModifyTransformStart"].concat(o))}),this.transformation.addLocalHook("afterTransformStart",function(){for(var i=arguments.length,o=new Array(i),a=0;a<i;a++)o[a]=arguments[a];return n.runLocalHooks.apply(n,["afterModifyTransformStart"].concat(o))}),this.transformation.addLocalHook("beforeTransformEnd",function(){for(var i=arguments.length,o=new Array(i),a=0;a<i;a++)o[a]=arguments[a];return n.runLocalHooks.apply(n,["beforeModifyTransformEnd"].concat(o))}),this.transformation.addLocalHook("afterTransformEnd",function(){for(var i=arguments.length,o=new Array(i),a=0;a<i;a++)o[a]=arguments[a];return n.runLocalHooks.apply(n,["afterModifyTransformEnd"].concat(o))}),this.transformation.addLocalHook("insertRowRequire",function(){for(var i=arguments.length,o=new Array(i),a=0;a<i;a++)o[a]=arguments[a];return n.runLocalHooks.apply(n,["insertRowRequire"].concat(o))}),this.transformation.addLocalHook("insertColRequire",function(){for(var i=arguments.length,o=new Array(i),a=0;a<i;a++)o[a]=arguments[a];return n.runLocalHooks.apply(n,["insertColRequire"].concat(o))})}return Yfe(t,[{key:"getSelectedRange",value:function(){return this.selectedRange}},{key:"begin",value:function(){this.inProgress=!0}},{key:"finish",value:function(){this.runLocalHooks("afterSelectionFinished",Array.from(this.selectedRange)),this.inProgress=!1}},{key:"isInProgress",value:function(){return this.inProgress}},{key:"setRangeStart",value:function(e,n){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,o=this.settings.selectionMode==="multiple",a=er(n)?Cp():n,s=e.row<0,l=e.col<0,p=s&&l,d=e.clone();this.selectedByCorner=p,this.runLocalHooks("beforeSetRangeStart".concat(i?"Only":""),d),(!o||o&&!a&&er(n))&&this.selectedRange.clear(),this.selectedRange.add(d),this.getLayerLevel()===0&&(this.selectedByRowHeader.clear(),this.selectedByColumnHeader.clear()),!p&&l&&this.selectedByRowHeader.add(this.getLayerLevel()),!p&&s&&this.selectedByColumnHeader.add(this.getLayerLevel()),i||this.setRangeEnd(e)}},{key:"setRangeStartOnly",value:function(e,n){this.setRangeStart(e,n,!0)}},{key:"setRangeEnd",value:function(e){if(!this.selectedRange.isEmpty()){var n=e.clone();this.runLocalHooks("beforeSetRangeEnd",n),this.begin();var i=this.selectedRange.current();this.settings.selectionMode!=="single"&&i.setTo(new ke(n.row,n.col)),this.highlight.getCell().clear(),this.highlight.isEnabledFor(Df,i.highlight)&&this.highlight.getCell().add(this.selectedRange.current().highlight).commit().adjustCoordinates(i);var o=this.getLayerLevel();o<this.highlight.layerLevel&&(he(this.highlight.getAreas(),function(f){return void f.clear()}),he(this.highlight.getHeaders(),function(f){return void f.clear()}),he(this.highlight.getActiveHeaders(),function(f){return void f.clear()})),this.highlight.useLayerLevel(o);var a=this.highlight.createOrGetArea(),s=this.highlight.createOrGetHeader(),l=this.highlight.createOrGetActiveHeader();if(a.clear(),s.clear(),l.clear(),this.highlight.isEnabledFor(Op,i.highlight)&&(this.isMultiple()||o>=1)&&(a.add(i.from).add(i.to).commit(),o===1)){var p=this.selectedRange.previous();this.highlight.useLayerLevel(o-1).createOrGetArea().add(p.from).commit().adjustCoordinates(p),this.highlight.useLayerLevel(o)}if(this.highlight.isEnabledFor(Nf,i.highlight)){var d=this.tableProps.countRowsTranslated()===0,g=this.tableProps.countColsTranslated()===0,y=i;if((d||g)&&(y=i.clone()),d&&(y.from.row=-1),g&&(y.from.col=-1),this.settings.selectionMode==="single"?(this.isSelectedByAnyHeader()&&y.from.normalize(),s.add(y.from).commit()):s.add(y.from).add(y.to).commit(),this.isEntireRowSelected()){var h=this.tableProps.countCols()===i.getWidth();h&&l.add(new ke(i.from.row,-1)).add(new ke(i.to.row,-1)).commit()}if(this.isEntireColumnSelected()){var u=this.tableProps.countRows()===i.getHeight();u&&l.add(new ke(-1,i.from.col)).add(new ke(-1,i.to.col)).commit()}}this.runLocalHooks("afterSetRangeEnd",e)}}},{key:"isMultiple",value:function(){var e=ga(!this.selectedRange.current().isSingle());return this.runLocalHooks("afterIsMultipleSelection",e),e.value}},{key:"transformStart",value:function(e,n){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;this.setRangeStart(this.transformation.transformStart(e,n,i))}},{key:"transformEnd",value:function(e,n){this.setRangeEnd(this.transformation.transformEnd(e,n))}},{key:"getLayerLevel",value:function(){return this.selectedRange.size()-1}},{key:"isSelected",value:function(){return!this.selectedRange.isEmpty()}},{key:"isSelectedByRowHeader",value:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();return!this.isSelectedByCorner(e)&&this.isEntireRowSelected(e)}},{key:"isEntireRowSelected",value:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();return e===-1?this.selectedByRowHeader.size>0:this.selectedByRowHeader.has(e)}},{key:"isSelectedByColumnHeader",value:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();return!this.isSelectedByCorner()&&this.isEntireColumnSelected(e)}},{key:"isEntireColumnSelected",value:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();return e===-1?this.selectedByColumnHeader.size>0:this.selectedByColumnHeader.has(e)}},{key:"isSelectedByAnyHeader",value:function(){return this.isSelectedByRowHeader(-1)||this.isSelectedByColumnHeader(-1)||this.isSelectedByCorner()}},{key:"isSelectedByCorner",value:function(){return this.selectedByCorner}},{key:"inInSelection",value:function(e){return this.selectedRange.includes(e)}},{key:"isCellCornerVisible",value:function(){return this.settings.fillHandle&&!this.tableProps.isEditorOpened()&&!this.isMultiple()}},{key:"isAreaCornerVisible",value:function(e){return Number.isInteger(e)&&e!==this.getLayerLevel()?!1:this.settings.fillHandle&&!this.tableProps.isEditorOpened()&&this.isMultiple()}},{key:"clear",value:function(){this.selectedRange.clear(),this.highlight.clear()}},{key:"deselect",value:function(){!this.isSelected()||(this.inProgress=!1,this.clear(),this.runLocalHooks("afterDeselect"))}},{key:"selectAll",value:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,i=this.tableProps.countRows(),o=this.tableProps.countCols();if(!(!e&&!n&&(i===0||o===0))){var a=new ke(n?-1:0,e?-1:0);this.clear(),this.setRangeStartOnly(a),this.selectedByRowHeader.add(this.getLayerLevel()),this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(new ke(i-1,o-1)),this.finish()}}},{key:"selectCells",value:function(e){var n=this,i=pu(e);if(i===Ap)return!1;if(i===xp)throw new Error(Kt(Y4||(Y4=Ufe([`Unsupported format of the selection ranges was passed. To select cells pass 
        the coordinates as an array of arrays ([[rowStart, columnStart/columnPropStart, rowEnd, 
        columnEnd/columnPropEnd]]) or as an array of CellRange objects.`],[`Unsupported format of the selection ranges was passed. To select cells pass\\x20
        the coordinates as an array of arrays ([[rowStart, columnStart/columnPropStart, rowEnd,\\x20
        columnEnd/columnPropEnd]]) or as an array of CellRange objects.`]))));var o=jf(i,{propToCol:function(d){return n.tableProps.propToCol(d)},keepDirection:!0}),a=this.tableProps.countRows(),s=this.tableProps.countCols(),l=!e.some(function(p){var d=o(p),g=G4(d,4),y=g[0],h=g[1],u=g[2],f=g[3],c=Ho(y,a)&&Ho(h,s)&&Ho(u,a)&&Ho(f,s);return!c});return l&&(this.clear(),he(e,function(p){var d=o(p),g=G4(d,4),y=g[0],h=g[1],u=g[2],f=g[3];n.setRangeStartOnly(new ke(y,h),!1),n.setRangeEnd(new ke(u,f)),n.finish()})),l}},{key:"selectColumns",value:function(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:-1,o=typeof e=="string"?this.tableProps.propToCol(e):e,a=typeof n=="string"?this.tableProps.propToCol(n):n,s=this.tableProps.countCols(),l=this.tableProps.countRows(),p=Ho(o,s)&&Ho(a,s);return p&&(this.setRangeStartOnly(new ke(i,o)),this.setRangeEnd(new ke(l-1,a)),this.finish()),p}},{key:"selectRows",value:function(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:-1,o=this.tableProps.countRows(),a=this.tableProps.countCols(),s=Ho(e,o)&&Ho(n,o);return s&&(this.setRangeStartOnly(new ke(e,i)),this.setRangeEnd(new ke(n,a-1)),this.finish()),s}},{key:"refresh",value:function(){var e=this.highlight.getCustomSelections();if(e.forEach(function(p){p.commit()}),!!this.isSelected()){var n=this.highlight.getCell(),i=this.getLayerLevel();n.commit().adjustCoordinates(this.selectedRange.current());for(var o=0;o<this.selectedRange.size();o+=1){this.highlight.useLayerLevel(o);var a=this.highlight.createOrGetArea(),s=this.highlight.createOrGetHeader(),l=this.highlight.createOrGetActiveHeader();a.commit(),s.commit(),l.commit()}this.highlight.useLayerLevel(i)}}}]),t}();Ut(X4,nn);var Gfe=X4,Kfe=pt,Z4=ht,qfe=Yn.f,Xfe=la,J4=xr,Zfe=nb,Jfe=Jr,Qfe=ib,Q4=Z4("".startsWith),ece=Z4("".slice),tce=Math.min,eM=Qfe("startsWith"),rce=!eM&&!!function(){var t=qfe(String.prototype,"startsWith");return t&&!t.writable}();Kfe({target:"String",proto:!0,forced:!rce&&!eM},{startsWith:function(r){var e=J4(Jfe(this));Zfe(r);var n=Xfe(tce(arguments.length>1?arguments[1]:void 0,e.length)),i=J4(r);return Q4?Q4(e,i,n):ece(e,n,n+i.length)===i}});var tM=/^(\r\n|\n\r|\r|\n)/,nce=/^[^\t\r\n]+/,rM=/^\t/;function ice(t){var r=[[""]];if(t.length===0)return r;for(var e=0,n=0,i;t.length>0&&i!==t.length;)if(i=t.length,t.match(rM))t=t.replace(rM,""),e+=1,r[n][e]="";else if(t.match(tM))t=t.replace(tM,""),e=0,n+=1,r[n]=[""];else{var o="";if(t.startsWith('"')){for(var a=0,s=!0;s;){var l=t.slice(0,1);l==='"'&&(a+=1),o+=l,t=t.slice(1),(t.length===0||t.match(/^[\t\r\n]/)&&a%2==0)&&(s=!1)}o=o.replace(/^"/,"").replace(/"$/,"").replace(/["]*/g,function(d){return new Array(Math.floor(d.length/2)).fill('"').join("")})}else{var p=t.match(nce);o=p?p[0]:"",t=t.slice(o.length)}r[n][e]=o}return r}function Lf(t){var r,e,n,i,o="",a;for(r=0,e=t.length;r<e;r+=1){for(i=t[r].length,n=0;n<i;n+=1)n>0&&(o+="	"),a=t[r][n],typeof a=="string"?a.indexOf(`
`)>-1?o+='"'.concat(a.replace(/"/g,'""'),'"'):o+=a:a==null?o+="":o+=a;r!==e-1&&(o+=`
`)}return o}function Mp(t){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?Mp=function(e){return typeof e}:Mp=function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Mp(t)}function oce(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}function nM(t,r){for(var e=0;e<r.length;e++){var n=r[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function ace(t,r,e){return r&&nM(t.prototype,r),e&&nM(t,e),t}var sce=Rf("copyable",!1),uce=function(){function t(r,e,n){oce(this,t),this.instance=r,this.tableMeta=n,this.dataSource=e,this.duckSchema=this.dataSource&&this.dataSource[0]?Fs(this.dataSource[0]):{},this.colToPropCache=void 0,this.propToColCache=void 0,this.createMap()}return ace(t,[{key:"createMap",value:function(){var e=this.getSchema();if(typeof e=="undefined")throw new Error("trying to create `columns` definition but you didn't provide `schema` nor `data`");var n=this.tableMeta.columns,i;if(this.colToPropCache=[],this.propToColCache=new Map,n){var o=0,a=0,s=!1;if(typeof n=="function"){var l=ch(e);o=l>0?l:this.countFirstRowKeys(),s=!0}else{var p=this.tableMeta.maxCols;o=Math.min(p,n.length)}for(i=0;i<o;i++){var d=s?n(i):n[i];if(vt(d)){if(typeof d.data!="undefined"){var g=s?a:i;this.colToPropCache[g]=d.data,this.propToColCache.set(d.data,g)}a+=1}}}else this.recursiveDuckColumns(e)}},{key:"countFirstRowKeys",value:function(){return Ww(this.dataSource)}},{key:"recursiveDuckColumns",value:function(e,n,i){var o=this,a=n,s=i,l;return typeof a=="undefined"&&(a=0,s=""),Mp(e)==="object"&&!Array.isArray(e)&&Ot(e,function(p,d){p===null?(l=s+d,o.colToPropCache.push(l),o.propToColCache.set(l,a),a+=1):a=o.recursiveDuckColumns(p,a,"".concat(d,"."))}),a}},{key:"colToProp",value:function(e){if(Number.isInteger(e)===!1)return e;var n=this.instance.toPhysicalColumn(e);return n===null?e:this.colToPropCache&&at(this.colToPropCache[n])?this.colToPropCache[n]:n}},{key:"propToCol",value:function(e){var n=this.propToColCache.get(e);if(at(n))return this.instance.toVisualColumn(n);var i=this.instance.toVisualColumn(e);return i===null?e:i}},{key:"getSchema",value:function(){var e=this.tableMeta.dataSchema;return e?typeof e=="function"?e():e:this.duckSchema}},{key:"createRow",value:function(e){var n=this,i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,o=arguments.length>2?arguments[2]:void 0,a=this.instance.countSourceRows(),s=a,l=0,p=e;(typeof p!="number"||p>=a)&&(p=a),p<this.instance.countRows()&&(s=this.instance.toPhysicalRow(p));var d=this.instance.runHooks("beforeCreateRow",p,i,o);if(d===!1||s===null)return 0;for(var g=this.tableMeta.maxRows,y=this.instance.countCols(),h=[],u=function(){var c=null;n.instance.dataType==="array"?n.tableMeta.dataSchema?c=zr(n.getSchema()):(c=[],Qe(y-1,function(){return c.push(null)})):n.instance.dataType==="function"?c=n.tableMeta.dataSchema(p+l):(c={},Wl(c,n.getSchema())),h.push(c),l+=1};l<i&&a+l<g;)u();return this.instance.rowIndexMapper.insertIndexes(p,l),this.spliceData.apply(this,[s,0].concat(h)),this.instance.runHooks("afterCreateRow",p,l,o),this.instance.forceFullRender=!0,l}},{key:"createCol",value:function(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,i=arguments.length>2?arguments[2]:void 0;if(!this.instance.isColumnModificationAllowed())throw new Error("Cannot create new column. When data source in an object, you can only have as much columns as defined in first data row, data schema or in the 'columns' setting.If you want to be able to add new columns, you have to use array datasource.");var o=this.dataSource,a=this.tableMeta.maxCols,s=e;(typeof s!="number"||s>=this.instance.countSourceCols())&&(s=this.instance.countSourceCols());var l=this.instance.runHooks("beforeCreateCol",s,n,i);if(l===!1)return 0;var p=this.instance.countSourceCols();s<this.instance.countCols()&&(p=this.instance.toPhysicalColumn(s));for(var d=this.instance.countSourceRows(),g=this.instance.countCols(),y=0,h=p;y<n&&g<a;){if(typeof s!="number"||s>=g)if(d>0)for(var u=0;u<d;u+=1)typeof o[u]=="undefined"&&(o[u]=[]),o[u].push(null);else o.push([null]);else for(var f=0;f<d;f++)o[f].splice(h,0,null);y+=1,h+=1,g+=1}return this.instance.columnIndexMapper.insertIndexes(s,y),this.instance.runHooks("afterCreateCol",s,y,i),this.instance.forceFullRender=!0,y}},{key:"removeRow",value:function(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,i=arguments.length>2?arguments[2]:void 0,o=Number.isInteger(e)?e:-n,a=this.visualRowsToPhysical(o,n),s=this.instance.countSourceRows();o=(s+o)%s;var l=this.instance.runHooks("beforeRemoveRow",o,a.length,a,i);if(l===!1)return!1;var p=a.length;if(this.filterData(o,p,a),o<this.instance.countRows()){this.instance.rowIndexMapper.removeIndexes(a);var d=at(this.tableMeta.columns)||at(this.tableMeta.dataSchema);this.instance.rowIndexMapper.getNotTrimmedIndexesLength()===0&&d===!1&&this.instance.columnIndexMapper.setIndexesSequence([])}return this.instance.runHooks("afterRemoveRow",o,p,a,i),this.instance.forceFullRender=!0,!0}},{key:"removeCol",value:function(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,i=arguments.length>2?arguments[2]:void 0;if(this.instance.dataType==="object"||this.tableMeta.columns)throw new Error("cannot remove column with object data source or columns option specified");var o=typeof e!="number"?-n:e;o=(this.instance.countCols()+o)%this.instance.countCols();var a=this.visualColumnsToPhysical(o,n),s=a.slice(0).sort(function(m,b){return b-m}),l=this.instance.runHooks("beforeRemoveCol",o,n,a,i);if(l===!1)return!1;for(var p=!0,d=s.length,g=this.dataSource,y=0;y<d;y++)p&&a[0]!==a[y]-y&&(p=!1);if(p)for(var h=0,u=this.instance.countSourceRows();h<u;h++)g[h].splice(a[0],n);else for(var f=0,c=this.instance.countSourceRows();f<c;f++)for(var v=0;v<d;v++)g[f].splice(s[v],1);return o<this.instance.countCols()&&(this.instance.columnIndexMapper.removeIndexes(a),this.instance.columnIndexMapper.getNotTrimmedIndexesLength()===0&&this.instance.rowIndexMapper.setIndexesSequence([])),this.instance.runHooks("afterRemoveCol",o,n,a,i),this.instance.forceFullRender=!0,!0}},{key:"spliceCol",value:function(e,n,i){for(var o=this.instance.getDataAtCol(e),a=o.slice(n,n+i),s=o.slice(n+i),l=arguments.length,p=new Array(l>3?l-3:0),d=3;d<l;d++)p[d-3]=arguments[d];kb(p,s);for(var g=0;g<i;)p.push(null),g+=1;return cT(p),this.instance.populateFromArray(n,e,p,null,null,"spliceCol"),a}},{key:"spliceRow",value:function(e,n,i){for(var o=this.instance.getSourceDataAtRow(e),a=o.slice(n,n+i),s=o.slice(n+i),l=arguments.length,p=new Array(l>3?l-3:0),d=3;d<l;d++)p[d-3]=arguments[d];kb(p,s);for(var g=0;g<i;)p.push(null),g+=1;return this.instance.populateFromArray(e,n,[p],null,null,"spliceRow"),a}},{key:"spliceData",value:function(e,n){for(var i=arguments.length,o=new Array(i>2?i-2:0),a=2;a<i;a++)o[a-2]=arguments[a];var s=this.instance.runHooks("beforeDataSplice",e,n,o);if(s!==!1){var l;(l=this.dataSource).splice.apply(l,[e,n].concat(o))}}},{key:"filterData",value:function(e,n,i){var o=this.instance.runHooks("filterData",e,n,i);Array.isArray(o)===!1&&(o=this.dataSource.filter(function(a,s){return i.indexOf(s)===-1})),this.dataSource.length=0,Array.prototype.push.apply(this.dataSource,o)}},{key:"get",value:function(e,n){var i=this.instance.toPhysicalRow(e),o=this.dataSource[i],a=this.instance.runHooks("modifyRowData",i);o=isNaN(a)?a:o;var s=null;if(o&&o.hasOwnProperty&&Yt(o,n))s=o[n];else if(typeof n=="string"&&n.indexOf(".")>-1){var l=n.split("."),p=o;if(!p)return null;for(var d=0,g=l.length;d<g;d++)if(p=p[l[d]],typeof p=="undefined")return null;s=p}else typeof n=="function"&&(s=n(this.dataSource.slice(i,i+1)[0]));if(this.instance.hasHook("modifyData")){var y=ga(s);this.instance.runHooks("modifyData",i,this.propToCol(n),y,"get"),y.isTouched()&&(s=y.value)}return s}},{key:"getCopyable",value:function(e,n){return sce.call(this.instance,e,this.propToCol(n))?this.get(e,n):""}},{key:"set",value:function(e,n,i){var o=this.instance.toPhysicalRow(e),a=i,s=this.dataSource[o],l=this.instance.runHooks("modifyRowData",o);if(s=isNaN(l)?l:s,this.instance.hasHook("modifyData")){var p=ga(a);this.instance.runHooks("modifyData",o,this.propToCol(n),p,"set"),p.isTouched()&&(a=p.value)}if(s&&s.hasOwnProperty&&Yt(s,n))s[n]=a;else if(typeof n=="string"&&n.indexOf(".")>-1){var d=n.split("."),g=s,y=0,h;for(y=0,h=d.length-1;y<h;y++)typeof g[d[y]]=="undefined"&&(g[d[y]]={}),g=g[d[y]];g[d[y]]=a}else typeof n=="function"?n(this.dataSource.slice(o,o+1)[0],a):s[n]=a}},{key:"visualRowsToPhysical",value:function(e,n){for(var i=this.instance.countSourceRows(),o=[],a=(i+e)%i,s=n,l;a<i&&s;)l=this.instance.toPhysicalRow(a),o.push(l),s-=1,a+=1;return o}},{key:"visualColumnsToPhysical",value:function(e,n){for(var i=this.instance.countCols(),o=[],a=(i+e)%i,s=n;a<i&&s;){var l=this.instance.toPhysicalColumn(a);o.push(l),s-=1,a+=1}return o}},{key:"clear",value:function(){for(var e=0;e<this.instance.countSourceRows();e++)for(var n=0;n<this.instance.countCols();n++)this.set(e,this.colToProp(n),"")}},{key:"getLength",value:function(){var e=this.tableMeta.maxRows,n;e<0||e===0?n=0:n=e||1/0;var i=this.instance.rowIndexMapper.getNotTrimmedIndexesLength();return Math.min(i,n)}},{key:"getAll",value:function(){var e={row:0,col:0},n={row:Math.max(this.instance.countRows()-1,0),col:Math.max(this.instance.countCols()-1,0)};return e.row-n.row==0&&!this.instance.countSourceRows()?[]:this.getRange(e,n,t.DESTINATION_RENDERER)}},{key:"countCachedColumns",value:function(){return this.colToPropCache.length}},{key:"getRange",value:function(e,n,i){var o=[],a,s,l,p=this.tableMeta.maxRows,d=this.tableMeta.maxCols;if(p===0||d===0)return[];var g=i===t.DESTINATION_CLIPBOARD_GENERATOR?this.getCopyable:this.get,y=Math.min(Math.max(p-1,0),Math.max(e.row,n.row)),h=Math.min(Math.max(d-1,0),Math.max(e.col,n.col));for(a=Math.min(e.row,n.row);a<=y;a++){l=[];var u=a>=0?this.instance.toPhysicalRow(a):a;for(s=Math.min(e.col,n.col);s<=h&&u!==null;s++)l.push(g.call(this,a,this.colToProp(s)));u!==null&&o.push(l)}return o}},{key:"getText",value:function(e,n){return Lf(this.getRange(e,n,t.DESTINATION_RENDERER))}},{key:"getCopyableText",value:function(e,n){return Lf(this.getRange(e,n,t.DESTINATION_CLIPBOARD_GENERATOR))}},{key:"destroy",value:function(){this.instance=null,this.tableMeta=null,this.dataSource=null,this.duckSchema=null,this.colToPropCache.length=0,this.propToColCache.clear(),this.propToColCache=void 0}}],[{key:"DESTINATION_RENDERER",get:function(){return 1}},{key:"DESTINATION_CLIPBOARD_GENERATOR",get:function(){return 2}}]),t}(),lce=uce;function Pp(t,r){var e=typeof t=="string"?ep(t):t;if(!!vt(e)){var n=vt(r),i={};return Ot(e,function(o,a){a!=="CELL_TYPE"&&(!n||n&&!Yt(r,a))&&(i[a]=o)}),i}}function fce(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];function e(){}_i(e,t);for(var n=0;n<r.length;n++)e.prototype[r[n]]=void 0;return e}function Ip(t){return Number.isInteger(t)&&t>=0}function Dp(t,r){if(!t())throw new Error("Assertion failed: ".concat(r))}function Np(t){return t==null}function $p(t){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?$p=function(e){return typeof e}:$p=function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},$p(t)}var iM=function(){return{licenseKey:void 0,data:void 0,dataSchema:void 0,width:void 0,height:void 0,startRows:5,startCols:5,rowHeaders:void 0,colHeaders:null,colWidths:void 0,rowHeights:void 0,columns:void 0,cells:void 0,cell:[],comments:!1,customBorders:!1,minRows:0,minCols:0,maxRows:1/0,maxCols:1/0,minSpareRows:0,minSpareCols:0,allowInsertRow:!0,allowInsertColumn:!0,allowRemoveRow:!0,allowRemoveColumn:!0,selectionMode:"multiple",fillHandle:{autoInsertRow:!1},fixedRowsTop:0,fixedRowsBottom:0,fixedColumnsLeft:0,outsideClickDeselects:!0,enterBeginsEditing:!0,enterMoves:{col:0,row:1},tabMoves:{row:0,col:1},autoWrapRow:!1,autoWrapCol:!1,persistentState:void 0,currentRowClassName:void 0,currentColClassName:void 0,currentHeaderClassName:"ht__highlight",activeHeaderClassName:"ht__active_highlight",className:void 0,tableClassName:void 0,stretchH:"none",isEmptyRow:function(r){var e,n,i,o;for(e=0,n=this.countCols();e<n;e++)if(i=this.getDataAtCell(r,e),Or(i)===!1)return $p(i)==="object"?(o=this.getCellMeta(r,e),Tb(this.getSchema()[o.prop],i)):!1;return!0},isEmptyCol:function(r){var e,n,i;for(e=0,n=this.countRows();e<n;e++)if(i=this.getDataAtCell(e,r),Or(i)===!1)return!1;return!0},observeDOMVisibility:!0,allowInvalid:!0,allowEmpty:!0,invalidCellClassName:"htInvalid",placeholder:void 0,placeholderCellClassName:"htPlaceholder",readOnlyCellClassName:"htDimmed",renderer:void 0,commentedCellClassName:"htCommentCell",fragmentSelection:!1,readOnly:!1,skipColumnOnPaste:!1,skipRowOnPaste:!1,search:!1,type:"text",copyable:!0,editor:void 0,visibleRows:10,trimDropdown:!0,wordWrap:!0,noWordWrapClassName:"htNoWrap",contextMenu:void 0,copyPaste:!0,undo:void 0,columnSorting:void 0,manualColumnMove:void 0,manualColumnResize:void 0,manualRowMove:void 0,manualRowResize:void 0,mergeCells:!1,multiColumnSorting:void 0,viewportRowRenderingOffset:"auto",viewportColumnRenderingOffset:"auto",validator:void 0,disableVisualSelection:!1,manualColumnFreeze:void 0,trimWhitespace:!0,source:void 0,title:void 0,checkedTemplate:void 0,uncheckedTemplate:void 0,label:void 0,numericFormat:void 0,language:"en-US",locale:"en-US",selectOptions:void 0,autoColumnSize:void 0,autoRowSize:void 0,dateFormat:"DD/MM/YYYY",correctFormat:!1,defaultDate:void 0,strict:void 0,allowHtml:!1,renderAllRows:void 0,preventOverflow:!1,preventWheel:!1,bindRowsWithHeaders:void 0,collapsibleColumns:void 0,columnSummary:void 0,dropdownMenu:void 0,filters:void 0,formulas:void 0,hiddenColumns:void 0,hiddenRows:void 0,nestedHeaders:void 0,trimRows:void 0,rowHeaderWidth:void 0,columnHeaderHeight:void 0,sortByRelevance:!0,filter:!0,filteringCaseSensitive:!1,dragToScroll:!0,nestedRows:void 0}};function oM(t,r){for(var e=0;e<r.length;e++){var n=r[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function cce(t,r,e){return r&&oM(t.prototype,r),e&&oM(t,e),t}function aM(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}function hce(){return function t(){aM(this,t)}}var dce=function(){function t(r){aM(this,t),this.metaCtor=hce(),this.meta=this.metaCtor.prototype,or(this.meta,iM()),this.meta.instance=r}return cce(t,[{key:"getMetaConstructor",value:function(){return this.metaCtor}},{key:"getMeta",value:function(){return this.meta}},{key:"updateMeta",value:function(e){or(this.meta,e),or(this.meta,Pp(e.type,e))}}]),t}();function pce(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}function sM(t,r){for(var e=0;e<r.length;e++){var n=r[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function yce(t,r,e){return r&&sM(t.prototype,r),e&&sM(t,e),t}var mce=function(){function t(r){pce(this,t);var e=r.getMetaConstructor();this.meta=new e}return yce(t,[{key:"getMeta",value:function(){return this.meta}},{key:"updateMeta",value:function(e){or(this.meta,e),or(this.meta,Pp(e.type,e))}}]),t}();function vce(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}function uM(t,r){for(var e=0;e<r.length;e++){var n=r[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function gce(t,r,e){return r&&uM(t.prototype,r),e&&uM(t,e),t}var j_=function(t){function r(e){vce(this,r),this.valueFactory=e,this.data=[],this.index=[],this.holes=new Set}return gce(r,[{key:"obtain",value:function(n){Dp(function(){return Ip(n)},"Expecting an unsigned number.");var i=this._getStorageIndexByKey(n),o;if(i>=0)o=this.data[i],o===void 0&&(o=this.valueFactory(n),this.data[i]=o);else if(o=this.valueFactory(n),this.holes.size>0){var a=this.holes.values().next().value;this.holes.delete(a),this.data[a]=o,this.index[n]=a}else this.data.push(o),this.index[n]=this.data.length-1;return o}},{key:"insert",value:function(n){var i,o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;Dp(function(){return Ip(n)||Np(n)},"Expecting an unsigned number or null/undefined argument.");for(var a=[],s=this.data.length,l=0;l<o;l++)a.push(s+l),this.data.push(void 0);(i=this.index).splice.apply(i,[Np(n)?this.index.length:n,0].concat(a))}},{key:"remove",value:function(n){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;Dp(function(){return Ip(n)||Np(n)},"Expecting an unsigned number or null/undefined argument.");for(var o=this.index.splice(Np(n)?this.index.length-i:n,i),a=0;a<o.length;a++){var s=o[a];typeof s=="number"&&this.holes.add(s)}}},{key:"size",value:function(){return this.data.length-this.holes.size}},{key:"values",value:function(){var n=this;return un(this.data,function(i,o){return!n.holes.has(o)})[Symbol.iterator]()}},{key:"entries",value:function(){for(var n=[],i=0;i<this.data.length;i++){var o=this._getKeyByStorageIndex(i);o!==-1&&n.push([o,this.data[i]])}var a=0;return{next:function(){if(a<n.length){var l=n[a];return a+=1,{value:l,done:!1}}return{done:!0}}}}},{key:"clear",value:function(){this.data=[],this.index=[],this.holes.clear()}},{key:"_getStorageIndexByKey",value:function(n){return this.index.length>n?this.index[n]:-1}},{key:"_getKeyByStorageIndex",value:function(n){return this.index.indexOf(n)}},{key:t,value:function(){return this.entries()}}]),r}(Symbol.iterator);function bce(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}function lM(t,r){for(var e=0;e<r.length;e++){var n=r[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function wce(t,r,e){return r&&lM(t.prototype,r),e&&lM(t,e),t}var _ce=["data","width"],Sce=function(){function t(r){var e=this;bce(this,t),this.globalMeta=r,this.metas=new j_(function(){return e._createMeta()})}return wce(t,[{key:"updateMeta",value:function(e,n){var i=this.getMeta(e);or(i,n),or(i,Pp(n.type,i))}},{key:"createColumn",value:function(e,n){this.metas.insert(e,n)}},{key:"removeColumn",value:function(e,n){this.metas.remove(e,n)}},{key:"getMeta",value:function(e){return this.metas.obtain(e)}},{key:"getMetaConstructor",value:function(e){return this.metas.obtain(e).constructor}},{key:"clearCache",value:function(){this.metas.clear()}},{key:"_createMeta",value:function(){return fce(this.globalMeta.getMetaConstructor(),_ce).prototype}}]),t}();function Cce(t){return Ece(t)||Rce(t)||Oce(t)||kce()}function kce(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Oce(t,r){if(!!t){if(typeof t=="string")return L_(t,r);var e=Object.prototype.toString.call(t).slice(8,-1);if(e==="Object"&&t.constructor&&(e=t.constructor.name),e==="Map"||e==="Set")return Array.from(t);if(e==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return L_(t,r)}}function Rce(t){if(typeof Symbol!="undefined"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function Ece(t){if(Array.isArray(t))return L_(t)}function L_(t,r){(r==null||r>t.length)&&(r=t.length);for(var e=0,n=new Array(r);e<r;e++)n[e]=t[e];return n}function Tce(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}function fM(t,r){for(var e=0;e<r.length;e++){var n=r[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function xce(t,r,e){return r&&fM(t.prototype,r),e&&fM(t,e),t}var Ace=function(){function t(r){var e=this;Tce(this,t),this.columnMeta=r,this.metas=new j_(function(){return e._createRow()})}return xce(t,[{key:"updateMeta",value:function(e,n,i){var o=this.getMeta(e,n);or(o,i),or(o,Pp(i.type,o))}},{key:"createRow",value:function(e,n){this.metas.insert(e,n)}},{key:"createColumn",value:function(e,n){for(var i=0;i<this.metas.size();i++)this.metas.obtain(i).insert(e,n)}},{key:"removeRow",value:function(e,n){this.metas.remove(e,n)}},{key:"removeColumn",value:function(e,n){for(var i=0;i<this.metas.size();i++)this.metas.obtain(i).remove(e,n)}},{key:"getMeta",value:function(e,n,i){var o=this.metas.obtain(e).obtain(n);return i===void 0?o:o[i]}},{key:"setMeta",value:function(e,n,i,o){var a=this.metas.obtain(e).obtain(n);a[i]=o}},{key:"removeMeta",value:function(e,n,i){var o=this.metas.obtain(e).obtain(n);delete o[i]}},{key:"getMetas",value:function(){for(var e=[],n=Array.from(this.metas.values()),i=0;i<n.length;i++)e.push.apply(e,Cce(n[i].values()));return e}},{key:"getMetasAtRow",value:function(e){Dp(function(){return Ip(e)},"Expecting an unsigned number.");var n=new Map(this.metas);return n.has(e)?Array.from(n.get(e).values()):[]}},{key:"clearCache",value:function(){this.metas.clear()}},{key:"_createRow",value:function(){var e=this;return new j_(function(n){return e._createMeta(n)})}},{key:"_createMeta",value:function(e){var n=this.columnMeta.getMetaConstructor(e);return new n}}]),t}();function Mce(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}function cM(t,r){for(var e=0;e<r.length;e++){var n=r[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function Pce(t,r,e){return r&&cM(t.prototype,r),e&&cM(t,e),t}var hM=function(){function t(r){var e=this,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[];Mce(this,t),this.hot=r,this.globalMeta=new dce(r),this.globalMeta.updateMeta(n),this.tableMeta=new mce(this.globalMeta),this.columnMeta=new Sce(this.globalMeta),this.cellMeta=new Ace(this.columnMeta),i.forEach(function(o){return new o(e)})}return Pce(t,[{key:"getGlobalMeta",value:function(){return this.globalMeta.getMeta()}},{key:"updateGlobalMeta",value:function(e){this.globalMeta.updateMeta(e)}},{key:"getTableMeta",value:function(){return this.tableMeta.getMeta()}},{key:"updateTableMeta",value:function(e){this.tableMeta.updateMeta(e)}},{key:"getColumnMeta",value:function(e){return this.columnMeta.getMeta(e)}},{key:"updateColumnMeta",value:function(e,n){this.columnMeta.updateMeta(e,n)}},{key:"getCellMeta",value:function(e,n,i){var o=i.visualRow,a=i.visualColumn,s=this.cellMeta.getMeta(e,n);return s.visualRow=o,s.visualCol=a,s.row=e,s.col=n,this.runLocalHooks("afterGetCellMeta",s),s}},{key:"getCellMetaKeyValue",value:function(e,n,i){if(typeof i!="string")throw new Error("The passed cell meta object key is not a string");return this.cellMeta.getMeta(e,n,i)}},{key:"setCellMeta",value:function(e,n,i,o){this.cellMeta.setMeta(e,n,i,o)}},{key:"updateCellMeta",value:function(e,n,i){this.cellMeta.updateMeta(e,n,i)}},{key:"removeCellMeta",value:function(e,n,i){this.cellMeta.removeMeta(e,n,i)}},{key:"getCellsMeta",value:function(){return this.cellMeta.getMetas()}},{key:"getCellsMetaAtRow",value:function(e){return this.cellMeta.getMetasAtRow(e)}},{key:"createRow",value:function(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.createRow(e,n)}},{key:"removeRow",value:function(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.removeRow(e,n)}},{key:"createColumn",value:function(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.createColumn(e,n),this.columnMeta.createColumn(e,n)}},{key:"removeColumn",value:function(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.removeColumn(e,n),this.columnMeta.removeColumn(e,n)}},{key:"clearCellsCache",value:function(){this.cellMeta.clearCache()}},{key:"clearCache",value:function(){this.cellMeta.clearCache(),this.columnMeta.clearCache()}}]),t}();Ut(hM,nn);function Ice(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}function dM(t,r){for(var e=0;e<r.length;e++){var n=r[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function Dce(t,r,e){return r&&dM(t.prototype,r),e&&dM(t,e),t}var Nce=function(){function t(r){var e=this;Ice(this,t),this.metaManager=r,this.metaSyncMemo=new Map,r.addLocalHook("afterGetCellMeta",function(n){return e.extendCellMeta(n)}),Ze.getSingleton().add("beforeRender",function(n){n&&e.metaSyncMemo.clear()},this.metaManager.hot)}return Dce(t,[{key:"extendCellMeta",value:function(e){var n,i=e.row,o=e.col;if(!((n=this.metaSyncMemo.get(i))!==null&&n!==void 0&&n.has(o))){var a=e.visualRow,s=e.visualCol,l=this.metaManager.hot,p=l.colToProp(s);e.prop=p,l.runHooks("beforeGetCellMeta",a,s,e);var d=Yt(e,"type")?e.type:null,g=qt(e.cells)?e.cells(i,o,p):null;if(d)if(g){var y;g.type=(y=g.type)!==null&&y!==void 0?y:d}else g={type:d};g&&this.metaManager.updateCellMeta(i,o,g),l.runHooks("afterGetCellMeta",a,s,e),this.metaSyncMemo.has(i)||this.metaSyncMemo.set(i,new Set),this.metaSyncMemo.get(i).add(o)}}}]),t}();function Lr(t){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?Lr=function(e){return typeof e}:Lr=function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Lr(t)}function ri(t,r){return Lce(t)||jce(t,r)||pM(t,r)||$ce()}function $ce(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function jce(t,r){var e=t==null?null:typeof Symbol!="undefined"&&t[Symbol.iterator]||t["@@iterator"];if(e!=null){var n=[],i=!0,o=!1,a,s;try{for(e=e.call(t);!(i=(a=e.next()).done)&&(n.push(a.value),!(r&&n.length===r));i=!0);}catch(l){o=!0,s=l}finally{try{!i&&e.return!=null&&e.return()}finally{if(o)throw s}}return n}}function Lce(t){if(Array.isArray(t))return t}function jp(t){return Bce(t)||Fce(t)||pM(t)||Hce()}function Hce(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function pM(t,r){if(!!t){if(typeof t=="string")return H_(t,r);var e=Object.prototype.toString.call(t).slice(8,-1);if(e==="Object"&&t.constructor&&(e=t.constructor.name),e==="Map"||e==="Set")return Array.from(t);if(e==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return H_(t,r)}}function Fce(t){if(typeof Symbol!="undefined"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function Bce(t){if(Array.isArray(t))return H_(t)}function H_(t,r){(r==null||r>t.length)&&(r=t.length);for(var e=0,n=new Array(r);e<r;e++)n[e]=t[e];return n}var F_=null;function B_(t,r){var e=this,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,i=!1,o=this,a=new Wt(o),s,l,p,d,g=!0;r.language=ale(r.language);var y=new hM(o,r,[Nce]),h=y.getTableMeta(),u=y.getGlobalMeta(),f=bA();Aae(n)&&xae(this),this.rootElement=t,this.rootDocument=t.ownerDocument,this.rootWindow=this.rootDocument.defaultView,this.isDestroyed=!1,this.renderSuspendedCounter=0,this.executionSuspendedCounter=0,sle(this.rootDocument),this.container=this.rootDocument.createElement("div"),this.renderCall=!1,t.insertBefore(this.container,t.firstChild),Lw(this)&&Gx(r.licenseKey,t),this.guid="ht_".concat(y0()),this.columnIndexMapper=new f1,this.rowIndexMapper=new f1,l=new Qae(o),(!this.rootElement.id||this.rootElement.id.substring(0,3)==="ht_")&&(this.rootElement.id=this.guid);var c=function(E){var k=E.row,O=E.col;return new ke(k>=0?o.rowIndexMapper.getRenderableFromVisualIndex(k):k,O>=0?o.columnIndexMapper.getRenderableFromVisualIndex(O):O)},v=function(E){var k=E.row,O=E.col;return new ke(k>=0?o.rowIndexMapper.getVisualFromRenderableIndex(k):k,O>=0?o.columnIndexMapper.getVisualFromRenderableIndex(O):O)},m=new Gfe(h,{countCols:function(){return o.countCols()},countRows:function(){return o.countRows()},propToCol:function(E){return s.propToCol(E)},isEditorOpened:function(){return o.getActiveEditor()?o.getActiveEditor().isOpened():!1},countColsTranslated:function(){return e.view.countRenderableColumns()},countRowsTranslated:function(){return e.view.countRenderableRows()},visualToRenderableCoords:c,renderableToVisualCoords:v,isDisabledCellSelection:function(E,k){return o.getCellMeta(E,k).disableVisualSelection}});this.selection=m;var b=function(E){var k=E.hiddenIndexesChanged;k&&e.selection.refresh()};this.columnIndexMapper.addLocalHook("cacheUpdated",b),this.rowIndexMapper.addLocalHook("cacheUpdated",b),this.selection.addLocalHook("beforeSetRangeStart",function(S){e.runHooks("beforeSetRangeStart",S)}),this.selection.addLocalHook("beforeSetRangeStartOnly",function(S){e.runHooks("beforeSetRangeStartOnly",S)}),this.selection.addLocalHook("beforeSetRangeEnd",function(S){e.runHooks("beforeSetRangeEnd",S),S.row<0&&(S.row=e.view.wt.wtTable.getFirstVisibleRow()),S.col<0&&(S.col=e.view.wt.wtTable.getFirstVisibleColumn())}),this.selection.addLocalHook("afterSetRangeEnd",function(S){var E=ga(!1),k=e.selection.getSelectedRange(),O=k.current(),x=O.from,j=O.to,H=k.size()-1;e.runHooks("afterSelection",x.row,x.col,j.row,j.col,E,H),e.runHooks("afterSelectionByProp",x.row,o.colToProp(x.col),j.row,o.colToProp(j.col),E,H);var F=e.selection.isSelectedByAnyHeader(),V=e.selection.selectedRange.current(),W=!0;i&&(W=!1),E.isTouched()&&(W=!E.value);var U=e.selection.isSelectedByRowHeader(),Y=e.selection.isSelectedByColumnHeader();W!==!1&&(F?U?e.view.scrollViewportVertically(o.rowIndexMapper.getRenderableFromVisualIndex(S.row)):Y&&e.view.scrollViewportHorizontally(o.columnIndexMapper.getRenderableFromVisualIndex(S.col)):V&&!e.selection.isMultiple()?e.view.scrollViewport(c(V.from)):e.view.scrollViewport(c(S))),U&&Y?Ie(e.rootElement,["ht__selection--rows","ht__selection--columns"]):U?(dt(e.rootElement,"ht__selection--columns"),Ie(e.rootElement,"ht__selection--rows")):Y?(dt(e.rootElement,"ht__selection--rows"),Ie(e.rootElement,"ht__selection--columns")):dt(e.rootElement,["ht__selection--rows","ht__selection--columns"]),e._refreshBorders(null)}),this.selection.addLocalHook("afterSelectionFinished",function(S){var E=S.length-1,k=S[E],O=k.from,x=k.to;e.runHooks("afterSelectionEnd",O.row,O.col,x.row,x.col,E),e.runHooks("afterSelectionEndByProp",O.row,o.colToProp(O.col),x.row,o.colToProp(x.col),E)}),this.selection.addLocalHook("afterIsMultipleSelection",function(S){var E=e.runHooks("afterIsMultipleSelection",S.value);S.value&&(S.value=E)}),this.selection.addLocalHook("beforeModifyTransformStart",function(S){e.runHooks("modifyTransformStart",S)}),this.selection.addLocalHook("afterModifyTransformStart",function(S,E,k){e.runHooks("afterModifyTransformStart",S,E,k)}),this.selection.addLocalHook("beforeModifyTransformEnd",function(S){e.runHooks("modifyTransformEnd",S)}),this.selection.addLocalHook("afterModifyTransformEnd",function(S,E,k){e.runHooks("afterModifyTransformEnd",S,E,k)}),this.selection.addLocalHook("afterDeselect",function(){d.destroyEditor(),e._refreshBorders(),dt(e.rootElement,["ht__selection--rows","ht__selection--columns"]),e.runHooks("afterDeselect")}),this.selection.addLocalHook("insertRowRequire",function(S){e.alter("insert_row",S,1,"auto")}),this.selection.addLocalHook("insertColRequire",function(S){e.alter("insert_col",S,1,"auto")}),p={alter:function(E,k){var O=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,x=arguments.length>3?arguments[3]:void 0,j=arguments.length>4?arguments[4]:void 0,H,F=function(ie){if(ie.length===0)return[];var fe=jp(ie);fe.sort(function(oe,G){var Z=ri(oe,1),Q=Z[0],re=ri(G,1),ne=re[0];return Q===ne?0:Q>ne?1:-1});var se=pr(fe,function(oe,G){var Z=ri(G,2),Q=Z[0],re=Z[1],ne=oe[oe.length-1],ue=ri(ne,2),le=ue[0],ve=ue[1],Se=le+ve;if(Q<=Se){var Oe=Math.max(re-(Se-Q),0);ne[1]+=Oe}else oe.push([Q,re]);return oe},[fe[0]]);return se};switch(E){case"insert_row":var V=o.countSourceRows();if(h.maxRows===V)return;if(k=at(k)?k:V,H=s.createRow(k,O,x),H){y.createRow(o.toPhysicalRow(k),O);var W=m.selectedRange.current(),U=W==null?void 0:W.from,Y=U==null?void 0:U.row;if(at(Y)&&Y>=k){var K=W.to,D=K.row,L=K.col,B=U.col;m.isSelectedByRowHeader()&&(B=-1),m.getSelectedRange().pop(),m.setRangeStartOnly(new ke(Y+H,B),!0),m.setRangeEnd(new ke(D+H,L))}else o._refreshBorders()}break;case"insert_col":if(H=s.createCol(k,O,x),H){if(y.createColumn(o.toPhysicalColumn(k),O),Array.isArray(h.colHeaders)){var z=[k,0];z.length+=H,Array.prototype.splice.apply(h.colHeaders,z)}var q=m.selectedRange.current(),X=q==null?void 0:q.from,ee=X==null?void 0:X.col;if(at(ee)&&ee>=k){var ye=q.to,de=ye.row,ge=ye.col,we=X.row;m.isSelectedByColumnHeader()&&(we=-1),m.getSelectedRange().pop(),m.setRangeStartOnly(new ke(we,ee+H),!0),m.setRangeEnd(new ke(de,ge+H))}else o._refreshBorders()}break;case"remove_row":var be=function(ie){var fe=0;he(ie,function(se){var oe=ri(se,2),G=oe[0],Z=oe[1],Q=Or(G)?o.countRows()-1:Math.max(G-fe,0);Number.isInteger(G)&&(G=Math.max(G-fe,0));var re=s.removeRow(G,Z,x);if(!!re){y.removeRow(o.toPhysicalRow(Q),Z);var ne=o.countRows(),ue=h.fixedRowsTop;ue>=Q+1&&(h.fixedRowsTop-=Math.min(Z,ue-Q));var le=h.fixedRowsBottom;le&&Q>=ne-le&&(h.fixedRowsBottom-=Math.min(Z,le)),fe+=Z}})};Array.isArray(k)?be(F(k)):be([[k,O]]),p.adjustRowsAndCols(),o._refreshBorders();break;case"remove_col":var J=function(ie){var fe=0;he(ie,function(se){var oe=ri(se,2),G=oe[0],Z=oe[1],Q=Or(G)?o.countCols()-1:Math.max(G-fe,0),re=o.toPhysicalColumn(Q);Number.isInteger(G)&&(G=Math.max(G-fe,0));var ne=s.removeCol(G,Z,x);if(!!ne){y.removeColumn(re,Z);var ue=h.fixedColumnsLeft;ue>=Q+1&&(h.fixedColumnsLeft-=Math.min(Z,ue-Q)),Array.isArray(h.colHeaders)&&(typeof re=="undefined"&&(re=-1),h.colHeaders.splice(re,Z)),fe+=Z}})};Array.isArray(k)?J(F(k)):J([[k,O]]),p.adjustRowsAndCols(),o._refreshBorders();break;default:throw new Error('There is no such action "'.concat(E,'"'))}j||p.adjustRowsAndCols()},adjustRowsAndCols:function(){var E=h.minRows,k=h.minSpareRows,O=h.minCols,x=h.minSpareCols;if(E){var j=o.countRows();j<E&&s.createRow(j,E-j,"auto")}if(k){var H=o.countEmptyRows(!0);if(H<k){var F=k-H,V=Math.min(F,h.maxRows-o.countSourceRows());s.createRow(o.countRows(),V,"auto")}}{var W;(O||x)&&(W=o.countEmptyCols(!0));var U=o.countCols();if(O&&!h.columns&&U<O){var Y=O-U;W+=Y,s.createCol(U,Y,"auto")}if(x&&!h.columns&&o.dataType==="array"&&W<x){U=o.countCols();var K=x-W,D=Math.min(K,h.maxCols-U);s.createCol(U,D,"auto")}}var L=o.countRows(),B=o.countCols();(L===0||B===0)&&m.deselect(),m.isSelected()&&he(m.selectedRange,function(z){var q=!1,X=z.from.row,ee=z.from.col,ye=z.to.row,de=z.to.col;X>L-1?(X=L-1,q=!0,ye>X&&(ye=X)):ye>L-1&&(ye=L-1,q=!0,X>ye&&(X=ye)),ee>B-1?(ee=B-1,q=!0,de>ee&&(de=ee)):de>B-1&&(de=B-1,q=!0,ee>de&&(ee=de)),q&&o.selectCell(X,ee,ye,de)}),o.view&&o.view.adjustElementsSize()},populateFromArray:function(E,k,O,x,j,H,F){var V,W,U,Y,K=[],D={},L=[],B=E.row,z=E.col;if(W=k.length,W===0)return!1;var q=0,X=0;switch(vt(O)&&(q=O.col-z+1,X=O.row-B+1),j){case"shift_down":var ee=Vl(k),ye=ee.length,de=Math.max(ye,q),ge=o.getData().slice(B),we=Vl(ge).slice(z,z+de);for(U=0;U<de;U+=1)if(U<ye){for(V=0,W=ee[U].length;V<X-W;V+=1)ee[U].push(ee[U][V%W]);U<we.length?L.push(ee[U].concat(we[U])):L.push(ee[U].concat(new Array(ge.length).fill(null)))}else L.push(ee[U%ye].concat(we[U]));o.populateFromArray(B,z,Vl(L));break;case"shift_right":var be=k.length,J=Math.max(be,X),te=o.getData().slice(B).map(function(Ct){return Ct.slice(z)});for(V=0;V<J;V+=1)if(V<be){for(U=0,Y=k[V].length;U<q-Y;U+=1)k[V].push(k[V][U%Y]);if(V<te.length)for(var ie=0;ie<te[V].length;ie+=1)k[V].push(te[V][ie]);else{var fe;(fe=k[V]).push.apply(fe,jp(new Array(te[0].length).fill(null)))}}else k.push(k[V%W].slice(0,J).concat(te[V]));o.populateFromArray(B,z,k);break;case"overwrite":default:D.row=E.row,D.col=E.col;var se={row:O&&E?O.row-E.row+1:1,col:O&&E?O.col-E.col+1:1},oe=0,G=0,Z=!0,Q,re=function(Ye){var et=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,Te=k[Ye%k.length];return et!==null?Te[et%Te.length]:Te},ne=k.length,ue=O?O.row-E.row+1:0;for(O?W=ue:W=Math.max(ne,ue),V=0;V<W&&!(O&&D.row>O.row&&ue>ne||!h.allowInsertRow&&D.row>o.countRows()-1||D.row>=h.maxRows);V++){var le=V-oe,ve=re(le).length,Se=O?O.col-E.col+1:0;if(O?Y=Se:Y=Math.max(ve,Se),D.col=E.col,Q=o.getCellMeta(D.row,D.col),(x==="CopyPaste.paste"||x==="Autofill.fill")&&Q.skipRowOnPaste){oe+=1,D.row+=1,W+=1;continue}for(G=0,U=0;U<Y&&!(O&&D.col>O.col&&Se>ve||!h.allowInsertColumn&&D.col>o.countCols()-1||D.col>=h.maxCols);U++){if(Q=o.getCellMeta(D.row,D.col),(x==="CopyPaste.paste"||x==="Autofill.fill")&&Q.skipColumnOnPaste){G+=1,D.col+=1,Y+=1;continue}if(Q.readOnly&&x!=="UndoRedo.undo"){D.col+=1;continue}var Oe=U-G,xe=re(le,Oe),Ce=o.getDataAtCell(D.row,D.col),Le={row:le,col:Oe};if(x==="Autofill.fill"){var Ve=o.runHooks("beforeAutofillInsidePopulate",Le,H,k,F,{},se);Ve&&(xe=er(Ve.value)?xe:Ve.value)}if(xe!==null&&Lr(xe)==="object")if(Array.isArray(xe)&&Ce===null&&(Ce=[]),Ce===null||Lr(Ce)!=="object")Z=!1;else{var Je=Fs(Array.isArray(Ce)?Ce:Ce[0]||Ce),ft=Fs(Array.isArray(xe)?xe:xe[0]||xe);Tb(Je,ft)?xe=zr(xe):Z=!1}else Ce!==null&&Lr(Ce)==="object"&&(Z=!1);Z&&K.push([D.row,D.col,xe]),Z=!0,D.col+=1}D.row+=1}o.setDataAtCell(K,null,null,x||"populateFromArray");break}}};function w(S){var E=c4(S);T_(E)?(o.runHooks("beforeLanguageChange",E),u.language=E,o.runHooks("afterLanguageChange",E)):h4(S)}function _(S,E){var k=S==="className"?o.rootElement:o.table;if(g)Ie(k,E);else{var O=[],x=[];u[S]&&(O=Array.isArray(u[S])?u[S]:Eb(u[S])),E&&(x=Array.isArray(E)?E:Eb(E));var j=Rb(O,x),H=Rb(x,O);j.length&&dt(k,j),H.length&&Ie(k,H)}u[S]=E}this.init=function(){l.setData(h.data),o.runHooks("beforeInit"),(In()||Ab())&&Ie(o.rootElement,"mobile"),this.updateSettings(h,!0),this.view=new Bae(this),d=$ie.getInstance(o,h,m),o.runHooks("init"),this.forceFullRender=!0,this.view.render(),Lr(g)==="object"&&(o.runHooks("afterChange",g[0],g[1]),g=!1),o.runHooks("afterInit")};function C(){var S=!1;return{validatorsInQueue:0,valid:!0,addValidatorToQueue:function(){this.validatorsInQueue+=1,S=!1},removeValidatorFormQueue:function(){this.validatorsInQueue=this.validatorsInQueue-1<0?0:this.validatorsInQueue-1,this.checkIfQueueIsEmpty()},onQueueEmpty:function(){},checkIfQueueIsEmpty:function(){this.validatorsInQueue===0&&S===!1&&(S=!0,this.onQueueEmpty(this.valid))}}}function R(S){var E=S.replace(",",".");return isNaN(parseFloat(E))===!1?parseFloat(E):S}function I(S,E,k){if(!!S.length){var O=o.getActiveEditor(),x=o.runHooks("beforeChange",S,E||"edit"),j=!0;if(x===!1){O&&O.cancelChanges();return}var H=new C;H.onQueueEmpty=function(L){O&&j&&O.cancelChanges(),k(L)};for(var F=S.length-1;F>=0;F--)if(S[F]===null)S.splice(F,1);else{var V=ri(S[F],4),W=V[0],U=V[1],Y=V[3],K=s.propToCol(U),D=o.getCellMeta(W,K);D.type==="numeric"&&typeof Y=="string"&&dA(Y)&&(S[F][3]=R(Y)),o.getCellValidator(D)&&(H.addValidatorToQueue(),o.validateCell(S[F][3],D,function(L,B){return function(z){if(typeof z!="boolean")throw new Error("Validation error: result is not boolean");if(z===!1&&B.allowInvalid===!1){j=!1,S.splice(L,1),B.valid=!0;var q=o.getCell(B.visualRow,B.visualCol);q!==null&&dt(q,h.invalidCellClassName)}H.removeValidatorFormQueue()}}(F,D),E))}H.checkIfQueueIsEmpty()}}function P(S,E){var k=S.length-1;if(!(k<0)){for(;k>=0;k--){var O=!1;if(S[k]===null){S.splice(k,1);continue}if(!((S[k][2]===null||S[k][2]===void 0)&&(S[k][3]===null||S[k][3]===void 0))){if(h.allowInsertRow)for(;S[k][0]>o.countRows()-1;){var x=s.createRow(void 0,void 0,E);if(x>=1)y.createRow(null,x);else{O=!0;break}}if(o.dataType==="array"&&(!h.columns||h.columns.length===0)&&h.allowInsertColumn)for(;s.propToCol(S[k][1])>o.countCols()-1;){var j=s.createCol(void 0,void 0,E);if(j>=1)y.createColumn(null,j);else{O=!0;break}}O||s.set(S[k][0],S[k][1],S[k][3])}}o.forceFullRender=!0,p.adjustRowsAndCols(),o.runHooks("beforeChangeRender",S,E),d.lockEditor(),o._refreshBorders(null),d.unlockEditor(),o.view.adjustElementsSize(),o.runHooks("afterChange",S,E||"edit");var H=o.getActiveEditor();H&&at(H.refreshValue)&&H.refreshValue()}}this.validateCell=function(S,E,k,O){var x=o.getCellValidator(E);function j(H){var F=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;if(!F||E.hidden===!0){k(H);return}var V=E.visualCol,W=E.visualRow,U=o.getCell(W,V,!0);if(U&&U.nodeName!=="TH"){var Y=o.rowIndexMapper.getRenderableFromVisualIndex(W),K=o.columnIndexMapper.getRenderableFromVisualIndex(V);o.view.wt.wtSettings.settings.cellRenderer(Y,K,U)}k(H)}Vx(x)&&(x=function(H){return function(F,V){V(H.test(F))}}(x)),qt(x)?(S=o.runHooks("beforeValidate",S,E.visualRow,E.prop,O),o._registerImmediate(function(){x.call(E,S,function(H){!o||(H=o.runHooks("afterValidate",H,S,E.visualRow,E.prop,O),E.valid=H,j(H),o.runHooks("postAfterValidate",H,S,E.visualRow,E.prop,O))})})):o._registerImmediate(function(){E.valid=!0,j(E.valid,!1)})};function N(S,E,k){return Array.isArray(S)?S:[[S,E,k]]}this.setDataAtCell=function(S,E,k,O){var x=N(S,E,k),j=[],H=O,F,V,W;for(F=0,V=x.length;F<V;F++){if(Lr(x[F])!=="object")throw new Error("Method `setDataAtCell` accepts row number or changes array of arrays as its first parameter");if(typeof x[F][1]!="number")throw new Error("Method `setDataAtCell` accepts row and column number as its parameters. If you want to use object property name, use method `setDataAtRowProp`");x[F][1]>=this.countCols()?W=x[F][1]:W=s.colToProp(x[F][1]),j.push([x[F][0],W,l.getAtCell(this.toPhysicalRow(x[F][0]),x[F][1]),x[F][2]])}!H&&Lr(S)==="object"&&(H=E),o.runHooks("afterSetDataAtCell",j,H),I(j,H,function(){P(j,H)})},this.setDataAtRowProp=function(S,E,k,O){var x=N(S,E,k),j=[],H=O,F,V;for(F=0,V=x.length;F<V;F++)j.push([x[F][0],x[F][1],l.getAtCell(this.toPhysicalRow(x[F][0]),x[F][1]),x[F][2]]);!H&&Lr(S)==="object"&&(H=E),o.runHooks("afterSetDataAtRowProp",j,H),I(j,H,function(){P(j,H)})},this.listen=function(){o&&!o.isListening()&&(F_=o.guid,o.runHooks("afterListen"))},this.unlisten=function(){this.isListening()&&(F_=null,o.runHooks("afterUnlisten"))},this.isListening=function(){return F_===o.guid},this.destroyEditor=function(){var S=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,E=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;o._refreshBorders(S,E)},this.populateFromArray=function(S,E,k,O,x,j,H,F,V){if(!(Lr(k)==="object"&&Lr(k[0])==="object"))throw new Error("populateFromArray parameter `input` must be an array of arrays");var W=typeof O=="number"?new ke(O,x):null;return p.populateFromArray(new ke(S,E),k,W,j,H,F,V)},this.spliceCol=function(S,E,k){for(var O,x=arguments.length,j=new Array(x>3?x-3:0),H=3;H<x;H++)j[H-3]=arguments[H];return(O=s).spliceCol.apply(O,[S,E,k].concat(j))},this.spliceRow=function(S,E,k){for(var O,x=arguments.length,j=new Array(x>3?x-3:0),H=3;H<x;H++)j[H-3]=arguments[H];return(O=s).spliceRow.apply(O,[S,E,k].concat(j))},this.getSelected=function(){if(m.isSelected())return bt(m.getSelectedRange(),function(S){var E=S.from,k=S.to;return[E.row,E.col,k.row,k.col]})},this.getSelectedLast=function(){var S=this.getSelected(),E;return S&&S.length>0&&(E=S[S.length-1]),E},this.getSelectedRange=function(){if(m.isSelected())return Array.from(m.getSelectedRange())},this.getSelectedRangeLast=function(){var S=this.getSelectedRange(),E;return S&&S.length>0&&(E=S[S.length-1]),E},this.emptySelectedCells=function(S){var E=this;if(!(!m.isSelected()||this.countRows()===0||this.countCols()===0)){var k=[];he(m.getSelectedRange(),function(O){var x=O.getTopLeftCorner(),j=O.getBottomRightCorner();Qe(x.row,j.row,function(H){Qe(x.col,j.col,function(F){E.getCellMeta(H,F).readOnly||k.push([H,F,null])})})}),k.length>0&&this.setDataAtCell(k,S)}},this.isRenderSuspended=function(){return this.renderSuspendedCounter>0},this.suspendRender=function(){this.renderSuspendedCounter+=1},this.resumeRender=function(){var S=this.renderSuspendedCounter-1;this.renderSuspendedCounter=Math.max(S,0),!this.isRenderSuspended()&&S===this.renderSuspendedCounter&&(this.renderCall?this.render():this._refreshBorders(null))},this.render=function(){this.view&&(this.renderCall=!0,this.forceFullRender=!0,this.isRenderSuspended()||(d.lockEditor(),this._refreshBorders(null),d.unlockEditor()))},this.batchRender=function(S){this.suspendRender();var E=S();return this.resumeRender(),E},this.isExecutionSuspended=function(){return this.executionSuspendedCounter>0},this.suspendExecution=function(){this.executionSuspendedCounter+=1,this.columnIndexMapper.suspendOperations(),this.rowIndexMapper.suspendOperations()},this.resumeExecution=function(){var S=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,E=this.executionSuspendedCounter-1;this.executionSuspendedCounter=Math.max(E,0),(!this.isExecutionSuspended()&&E===this.executionSuspendedCounter||S)&&(this.columnIndexMapper.resumeOperations(),this.rowIndexMapper.resumeOperations())},this.batchExecution=function(S){var E=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;this.suspendExecution();var k=S();return this.resumeExecution(E),k},this.batch=function(S){this.suspendRender(),this.suspendExecution();var E=S();return this.resumeExecution(),this.resumeRender(),E},this.refreshDimensions=function(){if(!!o.view){var S=o.view.getLastSize(),E=S.width,k=S.height,O=o.rootElement.getBoundingClientRect(),x=O.width,j=O.height,H=x!==E||j!==k,F=o.runHooks("beforeRefreshDimensions",{width:E,height:k},{width:x,height:j},H)===!1;F||((H||o.view.wt.wtOverlays.scrollableElement===o.rootWindow)&&(o.view.setLastSize(x,j),o.render()),o.runHooks("afterRefreshDimensions",{width:E,height:k},{width:x,height:j},H))}},this.loadData=function(S,E){if(Array.isArray(h.dataSchema)?o.dataType="array":qt(h.dataSchema)?o.dataType="function":o.dataType="object",s&&s.destroy(),S=o.runHooks("beforeLoadData",S,g,E),s=new lce(o,S,h),Lr(S)==="object"&&S!==null)S.push&&S.splice||(S=[S]);else if(S===null){var k=s.getSchema();S=[];var O,x=0,j=0;for(x=0,j=h.startRows;x<j;x++)if((o.dataType==="object"||o.dataType==="function")&&h.dataSchema)O=zr(k),S.push(O);else if(o.dataType==="array")O=zr(k[0]),S.push(O);else{O=[];for(var H=0,F=h.startCols;H<F;H++)O.push(null);S.push(O)}}else throw new Error("loadData only accepts array of objects or array of arrays (".concat(Lr(S)," given)"));Array.isArray(S[0])&&(o.dataType="array"),h.data=S,s.dataSource=S,l.data=S,l.dataType=o.dataType,l.colToProp=s.colToProp.bind(s),l.propToCol=s.propToCol.bind(s),l.countCachedColumns=s.countCachedColumns.bind(s),y.clearCellsCache(),o.initIndexMappers(),p.adjustRowsAndCols(),o.runHooks("afterLoadData",S,g,E),g?g=[null,"loadData"]:(o.runHooks("afterChange",null,"loadData"),o.render())},this.initIndexMappers=function(){var S=h.columns,E=0;if(Array.isArray(S))E=S.length;else if(qt(S))if(o.dataType==="array")for(var k=this.countSourceCols(),O=0;O<k;O+=1)S(O)&&(E+=1);else(o.dataType==="object"||o.dataType==="function")&&(E=s.colToPropCache.length);else if(at(h.dataSchema)){var x=s.getSchema();E=Array.isArray(x)?x.length:ch(x)}else E=this.countSourceCols();this.columnIndexMapper.initToLength(E),this.rowIndexMapper.initToLength(this.countSourceRows())},this.getData=function(S,E,k,O){return er(S)?s.getAll():s.getRange(new ke(S,E),new ke(k,O),s.DESTINATION_RENDERER)},this.getCopyableText=function(S,E,k,O){return s.getCopyableText(new ke(S,E),new ke(k,O))},this.getCopyableData=function(S,E){return s.getCopyable(S,s.colToProp(E))},this.getSchema=function(){return s.getSchema()},this.updateSettings=function(S){var E=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,k=!1,O,x;if(at(S.rows))throw new Error('The "rows" setting is no longer supported. Do you mean startRows, minRows or maxRows?');if(at(S.cols))throw new Error('The "cols" setting is no longer supported. Do you mean startCols, minCols or maxCols?');if(at(S.ganttChart))throw new Error('Since 8.0.0 the "ganttChart" setting is no longer supported.');for(O in S)if(O!=="data")if(O==="language"){w(S.language);continue}else O==="className"?_("className",S.className):O==="tableClassName"&&o.table?(_("tableClassName",S.tableClassName),o.view.wt.wtOverlays.syncOverlayTableClassNames()):Ze.getSingleton().isRegistered(O)||Ze.getSingleton().isDeprecated(O)?(qt(S[O])||Array.isArray(S[O]))&&(S[O].initialHook=!0,o.addHook(O,S[O])):!E&&Yt(S,O)&&(u[O]=S[O]);S.data===void 0&&h.data===void 0?o.loadData(null,"updateSettings"):S.data!==void 0?o.loadData(S.data,"updateSettings"):S.columns!==void 0&&(s.createMap(),o.initIndexMappers());var j=o.countCols(),H=h.columns;if(H&&qt(H)&&(k=!0),(S.cell!==void 0||S.cells!==void 0||S.columns!==void 0)&&y.clearCache(),j>0)for(O=0,x=0;O<j;O++){if(H){var F=k?H(O):H[x];F&&y.updateColumnMeta(x,F)}x+=1}at(S.cell)&&Ot(S.cell,function(D){o.setCellMetaObject(D.row,D.col,D)}),o.runHooks("afterCellMetaReset");var V=o.rootElement.style.height;V!==""&&(V=parseInt(o.rootElement.style.height,10));var W=S.height;if(qt(W)&&(W=W()),E){var U=o.rootElement.getAttribute("style");U&&o.rootElement.setAttribute("data-initialstyle",o.rootElement.getAttribute("style"))}if(W===null){var Y=o.rootElement.getAttribute("data-initialstyle");Y&&(Y.indexOf("height")>-1||Y.indexOf("overflow")>-1)?o.rootElement.setAttribute("style",Y):(o.rootElement.style.height="",o.rootElement.style.overflow="")}else W!==void 0&&(o.rootElement.style.height=isNaN(W)?"".concat(W):"".concat(W,"px"),o.rootElement.style.overflow="hidden");if(typeof S.width!="undefined"){var K=S.width;qt(K)&&(K=K()),o.rootElement.style.width=isNaN(K)?"".concat(K):"".concat(K,"px")}E||(o.view&&(o.view.wt.wtViewport.resetHasOversizedColumnHeadersMarked(),o.view.wt.exportSettingsAsClassNames()),o.runHooks("afterUpdateSettings",S)),p.adjustRowsAndCols(),o.view&&!g&&(o.forceFullRender=!0,d.lockEditor(),o._refreshBorders(null),o.view.wt.wtOverlays.adjustElementsSize(),d.unlockEditor()),!E&&o.view&&(V===""||W===""||W===void 0)&&V!==W&&o.view.wt.wtOverlays.updateMainScrollableElements()},this.getValue=function(){var S=o.getSelectedLast();if(h.getValue){if(qt(h.getValue))return h.getValue.call(o);if(S)return o.getData()[S[0][0]][h.getValue]}else if(S)return o.getDataAtCell(S[0],S[1])},this.getSettings=function(){return h},this.clear=function(){this.selectAll(),this.emptySelectedCells()},this.alter=function(S,E,k,O,x){p.alter(S,E,k,O,x)},this.getCell=function(S,E){var k=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,O=E,x=S;if(E>=0){if(this.columnIndexMapper.isHidden(this.toPhysicalColumn(E)))return null;O=this.columnIndexMapper.getRenderableFromVisualIndex(E)}if(S>=0){if(this.rowIndexMapper.isHidden(this.toPhysicalRow(S)))return null;x=this.rowIndexMapper.getRenderableFromVisualIndex(S)}return x===null||O===null?null:o.view.getCellAtCoords(new ke(x,O),k)},this.getCoords=function(S){var E=this.view.wt.wtTable.getCoords(S);if(E===null)return null;var k=E.row,O=E.col,x=k,j=O;return k>=0&&(x=this.rowIndexMapper.getVisualFromRenderableIndex(k)),O>=0&&(j=this.columnIndexMapper.getVisualFromRenderableIndex(O)),new ke(x,j)},this.colToProp=function(S){return s.colToProp(S)},this.propToCol=function(S){return s.propToCol(S)},this.toVisualRow=function(S){return e.rowIndexMapper.getVisualFromPhysicalIndex(S)},this.toVisualColumn=function(S){return e.columnIndexMapper.getVisualFromPhysicalIndex(S)},this.toPhysicalRow=function(S){return e.rowIndexMapper.getPhysicalFromVisualIndex(S)},this.toPhysicalColumn=function(S){return e.columnIndexMapper.getPhysicalFromVisualIndex(S)},this.getDataAtCell=function(S,E){return s.get(S,s.colToProp(E))},this.getDataAtRowProp=function(S,E){return s.get(S,E)},this.getDataAtCol=function(S){var E;return(E=[]).concat.apply(E,jp(s.getRange(new ke(0,S),new ke(h.data.length-1,S),s.DESTINATION_RENDERER)))},this.getDataAtProp=function(S){var E,k=s.getRange(new ke(0,s.propToCol(S)),new ke(h.data.length-1,s.propToCol(S)),s.DESTINATION_RENDERER);return(E=[]).concat.apply(E,jp(k))},this.getSourceData=function(S,E,k,O){var x;return S===void 0?x=l.getData():x=l.getByRange(new ke(S,E),new ke(k,O)),x},this.getSourceDataArray=function(S,E,k,O){var x;return S===void 0?x=l.getData(!0):x=l.getByRange(new ke(S,E),new ke(k,O),!0),x},this.getSourceDataAtCol=function(S){return l.getAtColumn(S)},this.setSourceDataAtCell=function(S,E,k,O){var x=N(S,E,k),j=this.hasHook("afterSetSourceDataAtCell"),H=[];j&&he(x,function(V){var W=ri(V,3),U=W[0],Y=W[1],K=W[2];H.push([U,Y,l.getAtCell(U,Y),K])}),he(x,function(V){var W=ri(V,3),U=W[0],Y=W[1],K=W[2];l.setAtCell(U,Y,K)}),j&&this.runHooks("afterSetSourceDataAtCell",H,O),this.render();var F=o.getActiveEditor();F&&at(F.refreshValue)&&F.refreshValue()},this.getSourceDataAtRow=function(S){return l.getAtRow(S)},this.getSourceDataAtCell=function(S,E){return l.getAtCell(S,E)},this.getDataAtRow=function(S){var E=s.getRange(new ke(S,0),new ke(S,this.countCols()-1),s.DESTINATION_RENDERER);return E[0]||[]},this.getDataType=function(S,E,k,O){var x=this,j=S===void 0?[0,0,this.countRows(),this.countCols()]:[S,E,k,O],H=j[0],F=j[1],V=j[2],W=j[3],U=null,Y=null;V===void 0&&(V=H),W===void 0&&(W=F);var K="mixed";return Qe(Math.max(Math.min(H,V),0),Math.max(H,V),function(D){var L=!0;return Qe(Math.max(Math.min(F,W),0),Math.max(F,W),function(B){var z=x.getCellMeta(D,B);return Y=z.type,U?L=U===Y:U=Y,L}),K=L?Y:"mixed",L}),K},this.removeCellMeta=function(S,E,k){var O=[this.toPhysicalRow(S),this.toPhysicalColumn(E)],x=O[0],j=O[1],H=y.getCellMetaKeyValue(x,j,k),F=o.runHooks("beforeRemoveCellMeta",S,E,k,H);F!==!1&&(y.removeCellMeta(x,j,k),o.runHooks("afterRemoveCellMeta",S,E,k,H)),H=null},this.spliceCellsMeta=function(S){for(var E=this,k=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,O=arguments.length,x=new Array(O>2?O-2:0),j=2;j<O;j++)x[j-2]=arguments[j];if(x.length>0&&!Array.isArray(x[0]))throw new Error("The 3rd argument (cellMetaRows) has to be passed as an array of cell meta objects array.");k>0&&y.removeRow(this.toPhysicalRow(S),k),x.length>0&&he(x.reverse(),function(H){y.createRow(E.toPhysicalRow(S)),he(H,function(F,V){return E.setCellMetaObject(S,V,F)})}),o.render()},this.setCellMetaObject=function(S,E,k){var O=this;Lr(k)==="object"&&Ot(k,function(x,j){O.setCellMeta(S,E,j,x)})},this.setCellMeta=function(S,E,k,O){var x=o.runHooks("beforeSetCellMeta",S,E,k,O);if(x!==!1){var j=S,H=E;S<this.countRows()&&(j=this.toPhysicalRow(S)),E<this.countCols()&&(H=this.toPhysicalColumn(E)),y.setCellMeta(j,H,k,O),o.runHooks("afterSetCellMeta",S,E,k,O)}},this.getCellsMeta=function(){return y.getCellsMeta()},this.getCellMeta=function(S,E){var k=this.toPhysicalRow(S),O=this.toPhysicalColumn(E);return k===null&&(k=S),O===null&&(O=E),y.getCellMeta(k,O,{visualRow:S,visualColumn:E})},this.getCellMetaAtRow=function(S){return y.getCellsMetaAtRow(S)},this.isColumnModificationAllowed=function(){return!(o.dataType==="object"||h.columns)};var A=Rf("renderer");this.getCellRenderer=function(S,E){return Nw(A.call(this,S,E))},this.getCellEditor=Rf("editor");var $=Rf("validator");this.getCellValidator=function(S,E){var k=$.call(this,S,E);return typeof k=="string"&&(k=$w(k)),k},this.validateCells=function(S){this._validateCells(S)},this.validateRows=function(S,E){if(!Array.isArray(S))throw new Error("validateRows parameter `rows` must be an array");this._validateCells(E,S)},this.validateColumns=function(S,E){if(!Array.isArray(S))throw new Error("validateColumns parameter `columns` must be an array");this._validateCells(E,void 0,S)},this._validateCells=function(S,E,k){var O=new C;S&&(O.onQueueEmpty=S);for(var x=o.countRows()-1;x>=0;){if(E!==void 0&&E.indexOf(x)===-1){x-=1;continue}for(var j=o.countCols()-1;j>=0;){if(k!==void 0&&k.indexOf(j)===-1){j-=1;continue}O.addValidatorToQueue(),o.validateCell(o.getDataAtCell(x,j),o.getCellMeta(x,j),function(H){if(typeof H!="boolean")throw new Error("Validation error: result is not boolean");H===!1&&(O.valid=!1),O.removeValidatorFormQueue()},"validateCells"),j-=1}x-=1}O.checkIfQueueIsEmpty()},this.getRowHeader=function(S){var E=h.rowHeaders,k=S;return k!==void 0&&(k=o.runHooks("modifyRowHeader",k)),k===void 0?(E=[],Qe(o.countRows()-1,function(O){E.push(o.getRowHeader(O))})):Array.isArray(E)&&E[k]!==void 0?E=E[k]:qt(E)?E=E(k):E&&typeof E!="string"&&typeof E!="number"&&(E=k+1),E},this.hasRowHeaders=function(){return!!h.rowHeaders},this.hasColHeaders=function(){if(h.colHeaders!==void 0&&h.colHeaders!==null)return!!h.colHeaders;for(var S=0,E=o.countCols();S<E;S++)if(o.getColHeader(S))return!0;return!1},this.getColHeader=function(S){var E=o.runHooks("modifyColHeader",S),k=h.colHeaders;if(E===void 0){for(var O=[],x=o.countCols(),j=0;j<x;j++)O.push(o.getColHeader(j));k=O}else{var H=function(U){for(var Y=[],K=o.countCols(),D=0;D<K;D++)qt(h.columns)&&h.columns(D)&&Y.push(D);return Y[U]},F=o.toPhysicalColumn(E),V=H(F);h.colHeaders===!1?k=null:h.columns&&qt(h.columns)&&h.columns(V)&&h.columns(V).title?k=h.columns(V).title:h.columns&&h.columns[F]&&h.columns[F].title?k=h.columns[F].title:Array.isArray(h.colHeaders)&&h.colHeaders[F]!==void 0?k=h.colHeaders[F]:qt(h.colHeaders)?k=h.colHeaders(F):h.colHeaders&&typeof h.colHeaders!="string"&&typeof h.colHeaders!="number"&&(k=rp(E))}return k},this._getColWidthFromSettings=function(S){var E;if(S>=0){var k=o.getCellMeta(0,S);E=k.width}if((E===void 0||E===h.width)&&(E=h.colWidths),E!=null){switch(Lr(E)){case"object":E=E[S];break;case"function":E=E(S);break}typeof E=="string"&&(E=parseInt(E,10))}return E},this.getColWidth=function(S){var E=o._getColWidthFromSettings(S);return E=o.runHooks("modifyColWidth",E,S),E===void 0&&(E=I0.DEFAULT_WIDTH),E},this._getRowHeightFromSettings=function(S){var E=h.rowHeights;if(E!=null){switch(Lr(E)){case"object":E=E[S];break;case"function":E=E(S);break}typeof E=="string"&&(E=parseInt(E,10))}return E},this.getRowHeight=function(S){var E=o._getRowHeightFromSettings(S);return E=o.runHooks("modifyRowHeight",E,S),E},this.countSourceRows=function(){return l.countRows()},this.countSourceCols=function(){return l.countFirstRowKeys()},this.countRows=function(){return s.getLength()},this.countCols=function(){var S=h.maxCols,E=this.columnIndexMapper.getNotTrimmedIndexesLength();return Math.min(S,E)},this.countRenderedRows=function(){return o.view.wt.drawn?o.view.wt.wtTable.getRenderedRowsCount():-1},this.countVisibleRows=function(){return o.view.wt.drawn?o.view.wt.wtTable.getVisibleRowsCount():-1},this.countRenderedCols=function(){return o.view.wt.drawn?o.view.wt.wtTable.getRenderedColumnsCount():-1},this.countVisibleCols=function(){return o.view.wt.drawn?o.view.wt.wtTable.getVisibleColumnsCount():-1},this.countEmptyRows=function(){var S=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,E=0;return Jd(o.countRows()-1,function(k){if(o.isEmptyRow(k))E+=1;else if(S===!0)return!1}),E},this.countEmptyCols=function(){var S=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(o.countRows()<1)return 0;var E=0;return Jd(o.countCols()-1,function(k){if(o.isEmptyCol(k))E+=1;else if(S===!0)return!1}),E},this.isEmptyRow=function(S){return h.isEmptyRow.call(o,S)},this.isEmptyCol=function(S){return h.isEmptyCol.call(o,S)},this.selectCell=function(S,E,k,O){var x=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!0,j=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!0;return er(S)||er(E)?!1:this.selectCells([[S,E,k,O]],x,j)},this.selectCells=function(){var S=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[[]],E=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,k=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;E===!1&&(i=!0);var O=m.selectCells(S);return O&&k&&o.listen(),i=!1,O},this.selectColumns=function(S){var E=arguments.length>1&&arguments[1]!==void 0?arguments[1]:S;return m.selectColumns(S,E)},this.selectRows=function(S){var E=arguments.length>1&&arguments[1]!==void 0?arguments[1]:S;return m.selectRows(S,E)},this.deselectCell=function(){m.deselect()},this.selectAll=function(){var S=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0,E=S&&this.hasRowHeaders(),k=S&&this.hasColHeaders();i=!0,m.selectAll(E,k),i=!1};var T=function(E,k){return E.getFirstNotHiddenIndex(k,1,!0)};this.scrollViewportTo=function(S,E){var k=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,O=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,x=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!0,j=!k,H=!O,F=S,V=E;if(x){var W=Number.isInteger(S),U=Number.isInteger(E),Y=W?T(this.rowIndexMapper,S):void 0,K=U?T(this.columnIndexMapper,E):void 0;if(Y===null||K===null)return!1;F=W?o.rowIndexMapper.getRenderableFromVisualIndex(Y):void 0,V=U?o.columnIndexMapper.getRenderableFromVisualIndex(K):void 0}var D=Number.isInteger(F),L=Number.isInteger(V);return D&&L?o.view.scrollViewport(new ke(F,V),j,O,k,H):D&&L===!1?o.view.scrollViewportVertically(F,j,k):L&&D===!1?o.view.scrollViewportHorizontally(V,O,H):!1},this.destroy=function(){if(o._clearTimeouts(),o._clearImmediates(),o.view&&o.view.destroy(),l&&l.destroy(),l=null,y.clearCache(),ule(),Lw(o)){var S=this.rootDocument.querySelector("#hot-display-license-info");S&&S.parentNode.removeChild(S)}kn(o.rootElement),a.destroy(),d&&d.destroy(),o.batchExecution(function(){o.rowIndexMapper.unregisterAll(),o.columnIndexMapper.unregisterAll(),f.getItems().forEach(function(E){var k=ri(E,2),O=k[1];O.destroy()}),f.clear(),o.runHooks("afterDestroy")},!0),Ze.getSingleton().destroy(o),Ot(o,function(E,k,O){qt(E)?O[k]=M(k):k!=="guid"&&(O[k]=null)}),o.isDestroyed=!0,s&&s.destroy(),o.rowIndexMapper=null,o.columnIndexMapper=null,s=null,p=null,m=null,d=null,o=null};function M(S){return function(){throw new Error('The "'.concat(S,'" method cannot be called because this Handsontable instance has been destroyed'))}}this.getActiveEditor=function(){return d.getActiveEditor()},this.getPlugin=function(S){var E=Ln(S);return E==="UndoRedo"?this.undoRedo:f.getItem(E)},this.getPluginName=function(S){return S===this.undoRedo?this.undoRedo.constructor.PLUGIN_KEY:f.getId(S)},this.getInstance=function(){return o},this.addHook=function(S,E){Ze.getSingleton().add(S,E,o)},this.hasHook=function(S){return Ze.getSingleton().has(S,o)},this.addHookOnce=function(S,E){Ze.getSingleton().once(S,E,o)},this.removeHook=function(S,E){Ze.getSingleton().remove(S,E,o)},this.runHooks=function(S,E,k,O,x,j,H){return Ze.getSingleton().run(o,S,E,k,O,x,j,H)},this.getTranslatedPhrase=function(S,E){return g4(h.language,S,E)},this.toHTML=function(){return Sw(e)},this.toTableElement=function(){var S=e.rootDocument.createElement("div");return S.insertAdjacentHTML("afterbegin",Sw(e)),S.firstElementChild},this.timeouts=[],this._registerTimeout=function(S){var E=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,k=S;typeof k=="function"&&(k=setTimeout(k,E)),this.timeouts.push(k)},this._clearTimeouts=function(){he(this.timeouts,function(S){clearTimeout(S)})},this.immediates=[],this._registerImmediate=function(S){this.immediates.push(setImmediate(S))},this._clearImmediates=function(){he(this.immediates,function(S){clearImmediate(S)})},this._refreshBorders=function(){var S=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,E=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;d.destroyEditor(S),o.view.render(),E&&m.isSelected()&&d.prepareEditor()},this.isRtl=function(){return o.rootWindow.getComputedStyle(o.rootElement).direction==="rtl"},this.isLtr=function(){return!o.isRtl()},this.getDirectionFactor=function(){return o.isLtr()?1:-1},Dw().forEach(function(S){var E=_f(S);f.addItem(S,new E(e))}),Ze.getSingleton().run(o,"construct")}function Vce(){var t={minHeight:200,maxHeight:300,minWidth:100,maxWidth:300},r,e=document.body,n=document.createTextNode(""),i=document.createElement("SPAN"),o=function(h,u,f){h.addEventListener(u,f,!1)},a=function(h,u,f){h.removeEventListener(u,f,!1)},s=function(h){var u,f;h?/^[a-zA-Z \.,\\\/\|0-9]$/.test(h)||(h="."):h="",n.textContent!==void 0?n.textContent=r.value+h:n.data=r.value+h,i.style.fontSize=g(r).fontSize,i.style.fontFamily=g(r).fontFamily,i.style.whiteSpace="pre",e.appendChild(i),u=i.clientWidth+2,e.removeChild(i),r.style.height=t.minHeight+"px",t.minWidth>u?r.style.width=t.minWidth+"px":u>t.maxWidth?r.style.width=t.maxWidth+"px":r.style.width=u+"px",f=r.scrollHeight?r.scrollHeight-1:0,t.minHeight>f?r.style.height=t.minHeight+"px":t.maxHeight<f?(r.style.height=t.maxHeight+"px",r.style.overflowY="visible"):r.style.height=f+"px"},l=function(){window.setTimeout(s,0)},p=function(h){if(h&&h.minHeight)if(h.minHeight=="inherit")t.minHeight=r.clientHeight;else{var u=parseInt(h.minHeight);isNaN(u)||(t.minHeight=u)}if(h&&h.maxHeight)if(h.maxHeight=="inherit")t.maxHeight=r.clientHeight;else{var f=parseInt(h.maxHeight);isNaN(f)||(t.maxHeight=f)}if(h&&h.minWidth)if(h.minWidth=="inherit")t.minWidth=r.clientWidth;else{var c=parseInt(h.minWidth);isNaN(c)||(t.minWidth=c)}if(h&&h.maxWidth)if(h.maxWidth=="inherit")t.maxWidth=r.clientWidth;else{var v=parseInt(h.maxWidth);isNaN(v)||(t.maxWidth=v)}i.firstChild||(i.className="autoResize",i.style.display="inline-block",i.appendChild(n))},d=function(h,u,f){r=h,p(u),r.nodeName=="TEXTAREA"&&(r.style.resize="none",r.style.overflowY="",r.style.height=t.minHeight+"px",r.style.minWidth=t.minWidth+"px",r.style.maxWidth=t.maxWidth+"px",r.style.overflowY="hidden"),f&&(o(r,"change",s),o(r,"cut",l),o(r,"paste",l),o(r,"drop",l),o(r,"keydown",l),o(r,"focus",s),o(r,"compositionstart",l),o(r,"compositionupdate",l),o(r,"compositionend",l)),s()};function g(y){return y.currentStyle||document.defaultView.getComputedStyle(y)}return{init:function(h,u,f){d(h,u,f)},unObserve:function(){a(r,"change",s),a(r,"cut",l),a(r,"paste",l),a(r,"drop",l),a(r,"keydown",l),a(r,"focus",s),a(r,"compositionstart",l),a(r,"compositionupdate",l),a(r,"compositionend",l)},resize:s}}function Lp(t){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?Lp=function(e){return typeof e}:Lp=function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Lp(t)}function Wce(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}function yM(t,r){for(var e=0;e<r.length;e++){var n=r[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function Uce(t,r,e){return r&&yM(t.prototype,r),e&&yM(t,e),t}function Hf(){return typeof Reflect!="undefined"&&Reflect.get?Hf=Reflect.get:Hf=function(r,e,n){var i=zce(r,e);if(!!i){var o=Object.getOwnPropertyDescriptor(i,e);return o.get?o.get.call(arguments.length<3?r:n):o.value}},Hf.apply(this,arguments)}function zce(t,r){for(;!Object.prototype.hasOwnProperty.call(t,r)&&(t=Da(t),t!==null););return t}function Yce(t,r){if(typeof r!="function"&&r!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(r&&r.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),r&&V_(t,r)}function V_(t,r){return V_=Object.setPrototypeOf||function(n,i){return n.__proto__=i,n},V_(t,r)}function Gce(t){var r=qce();return function(){var n=Da(t),i;if(r){var o=Da(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return Kce(this,i)}}function Kce(t,r){if(r&&(Lp(r)==="object"||typeof r=="function"))return r;if(r!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return mM(t)}function mM(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function qce(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Da(t){return Da=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},Da(t)}var Xce="ht_editor_visible",Hp="ht_editor_hidden",Zce="text",Na=function(t){Yce(e,t);var r=Gce(e);function e(n){var i;return Wce(this,e),i=r.call(this,n),i.eventManager=new Wt(mM(i)),i.autoResize=Vce(),i.TEXTAREA=void 0,i.textareaStyle=void 0,i.TEXTAREA_PARENT=void 0,i.textareaParentStyle=void 0,i.layerClass=void 0,i.createElements(),i.bindEvents(),i.hot.addHookOnce("afterDestroy",function(){return i.destroy()}),i}return Uce(e,[{key:"getValue",value:function(){return this.TEXTAREA.value}},{key:"setValue",value:function(i){this.TEXTAREA.value=i}},{key:"open",value:function(){var i=this;this.refreshDimensions(),this.showEditableElement(),this.addHook("beforeKeyDown",function(o){return i.onBeforeKeyDown(o)})}},{key:"close",value:function(){this.autoResize.unObserve(),this.hot.rootDocument.activeElement===this.TEXTAREA&&this.hot.listen(),this.hideEditableElement(),this.removeHooksByKey("beforeKeyDown")}},{key:"prepare",value:function(i,o,a,s,l,p){var d=this.state;if(Hf(Da(e.prototype),"prepare",this).call(this,i,o,a,s,l,p),!p.readOnly){this.refreshDimensions(!0);var g=p.allowInvalid,y=p.fragmentSelection;g&&(this.TEXTAREA.value=""),d!==Ir.FINISHED&&this.hideEditableElement();var h=!y;h&&!In()&&this.focus()}}},{key:"beginEditing",value:function(i,o){this.state===Ir.VIRGIN&&(this.TEXTAREA.value="",Hf(Da(e.prototype),"beginEditing",this).call(this,i,o))}},{key:"focus",value:function(){this.TEXTAREA.select(),ff(this.TEXTAREA,this.TEXTAREA.value.length)}},{key:"createElements",value:function(){var i=this.hot.rootDocument;this.TEXTAREA=i.createElement("TEXTAREA"),this.TEXTAREA.setAttribute("data-hot-input",""),this.TEXTAREA.tabIndex=-1,Ie(this.TEXTAREA,"handsontableInput"),this.textareaStyle=this.TEXTAREA.style,this.textareaStyle.width=0,this.textareaStyle.height=0,this.textareaStyle.overflowY="visible",this.TEXTAREA_PARENT=i.createElement("DIV"),Ie(this.TEXTAREA_PARENT,"handsontableInputHolder"),lt(this.TEXTAREA_PARENT,this.layerClass)&&dt(this.TEXTAREA_PARENT,this.layerClass),Ie(this.TEXTAREA_PARENT,Hp),this.textareaParentStyle=this.TEXTAREA_PARENT.style,this.TEXTAREA_PARENT.appendChild(this.TEXTAREA),this.hot.rootElement.appendChild(this.TEXTAREA_PARENT)}},{key:"hideEditableElement",value:function(){(CT()||ST())&&(this.textareaStyle.textIndent="-99999px"),this.textareaStyle.overflowY="visible",this.textareaParentStyle.opacity="0",this.textareaParentStyle.height="1px",lt(this.TEXTAREA_PARENT,this.layerClass)&&dt(this.TEXTAREA_PARENT,this.layerClass),Ie(this.TEXTAREA_PARENT,Hp)}},{key:"showEditableElement",value:function(){this.textareaParentStyle.height="",this.textareaParentStyle.overflow="",this.textareaParentStyle.position="",this.textareaParentStyle.right="auto",this.textareaParentStyle.opacity="1",this.textareaStyle.textIndent="",this.textareaStyle.overflowY="hidden";var i=this.TEXTAREA_PARENT.childNodes,o=!1;Qe(i.length-1,function(a){var s=i[a];if(lt(s,"handsontableEditor"))return o=!0,!1}),lt(this.TEXTAREA_PARENT,Hp)&&dt(this.TEXTAREA_PARENT,Hp),o?(this.layerClass=Xce,Ie(this.TEXTAREA_PARENT,this.layerClass)):(this.layerClass=this.getEditedCellsLayerClass(),Ie(this.TEXTAREA_PARENT,this.layerClass))}},{key:"refreshValue",value:function(){var i=this.hot.toPhysicalRow(this.row),o=this.hot.getSourceDataAtCell(i,this.col);this.originalValue=o,this.setValue(o),this.refreshDimensions()}},{key:"refreshDimensions",value:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(!(this.state!==Ir.EDITING&&!i)){if(this.TD=this.getEditedCell(),!this.TD){i||this.close();return}var o=this.hot.view.wt,a=o.wtOverlays,s=o.wtViewport,l=ar(this.TD),p=ar(this.hot.rootElement),d=a.topOverlay.holder,g=a.leftOverlay.holder,y=d!==this.hot.rootWindow?d.scrollTop:0,h=g!==this.hot.rootWindow?g.scrollLeft:0,u=this.checkEditorSection(),f=["","left"].includes(u)?y:0,c=["","top","bottom"].includes(u)?h:0,v=l.top===p.top?0:1,m=this.TD.style.backgroundColor,b=l.top-p.top-v-f,w=l.left-p.left-1-c,_;switch(u){case"top":_=Hn(a.topOverlay.clone.wtTable.holder.parentNode);break;case"left":_=Hn(a.leftOverlay.clone.wtTable.holder.parentNode);break;case"top-left-corner":_=Hn(a.topLeftCornerOverlay.clone.wtTable.holder.parentNode);break;case"bottom-left-corner":_=Hn(a.bottomLeftCornerOverlay.clone.wtTable.holder.parentNode);break;case"bottom":_=Hn(a.bottomOverlay.clone.wtTable.holder.parentNode);break}var C=this.hot.hasColHeaders(),R=this.hot.rowIndexMapper.getRenderableFromVisualIndex(this.row),I=this.hot.columnIndexMapper.getRenderableFromVisualIndex(this.col),P=this.hot.rowIndexMapper.getRenderableIndexesLength(),N=P-this.hot.view.wt.getSetting("fixedRowsBottom");(C&&R<=0||R===N)&&(b+=1),I<=0&&(w+=1),_&&_!==-1?this.textareaParentStyle[_[0]]=_[1]:Ta(this.TEXTAREA_PARENT),this.textareaParentStyle.top="".concat(b,"px"),this.textareaParentStyle.left="".concat(w,"px"),this.showEditableElement();var A=s.rowsRenderCalculator.startPosition,$=s.columnsRenderCalculator.startPosition,T=a.leftOverlay.getScrollPosition(),M=a.topOverlay.getScrollPosition(),S=Pr(this.hot.rootDocument),E=this.TD.offsetTop+A-M,k=this.TD.offsetLeft+$-T,O=Js(this.TD)-8,x=r3(d)?S:0,j=n3(g)?S:0,H=this.hot.view.maximumVisibleElementWidth(k)-9-x,F=this.TD.scrollHeight+1,V=Math.max(this.hot.view.maximumVisibleElementHeight(E)-j,23),W=Ea(this.TD,this.hot.rootWindow);this.TEXTAREA.style.fontSize=W.fontSize,this.TEXTAREA.style.fontFamily=W.fontFamily,this.TEXTAREA.style.backgroundColor=m,this.autoResize.init(this.TEXTAREA,{minHeight:Math.min(F,V),maxHeight:V,minWidth:Math.min(O,H),maxWidth:H},!0)}}},{key:"bindEvents",value:function(){var i=this;this.eventManager.addEventListener(this.TEXTAREA,"cut",function(o){return o.stopPropagation()}),this.eventManager.addEventListener(this.TEXTAREA,"paste",function(o){return o.stopPropagation()}),xb()&&this.eventManager.addEventListener(this.TEXTAREA,"focusout",function(){return i.finishEditing(!1)}),this.addHook("afterScrollHorizontally",function(){return i.refreshDimensions()}),this.addHook("afterScrollVertically",function(){return i.refreshDimensions()}),this.addHook("afterColumnResize",function(){i.refreshDimensions(),i.focus()}),this.addHook("afterRowResize",function(){i.refreshDimensions(),i.focus()})}},{key:"allowKeyEventPropagation",value:function(){}},{key:"destroy",value:function(){this.eventManager.destroy(),this.clearHooks()}},{key:"onBeforeKeyDown",value:function(i){var o=(i.ctrlKey||i.metaKey)&&!i.altKey;if(!(i.target!==this.TEXTAREA||Fn(i))){switch(i.keyCode){case De.ARROW_RIGHT:this.isInFullEditMode()&&!this.isWaiting()&&!this.allowKeyEventPropagation(i.keyCode)&&rr(i);break;case De.ARROW_LEFT:this.isInFullEditMode()&&!this.isWaiting()&&!this.allowKeyEventPropagation(i.keyCode)&&rr(i);break;case De.ARROW_UP:case De.ARROW_DOWN:this.isInFullEditMode()&&!this.isWaiting()&&!this.allowKeyEventPropagation(i.keyCode)&&rr(i);break;case De.ENTER:{var a=this.hot.selection.isMultiple();if(o&&!a||i.altKey){if(this.isOpened()){var s=O0(this.TEXTAREA),l=this.getValue(),p="".concat(l.slice(0,s),`
`).concat(l.slice(s));this.setValue(p),ff(this.TEXTAREA,s+1)}else this.beginEditing("".concat(this.originalValue,`
`));rr(i)}i.preventDefault();break}case De.BACKSPACE:case De.DELETE:case De.HOME:case De.END:rr(i);break}var d=[De.ARROW_UP,De.ARROW_RIGHT,De.ARROW_DOWN,De.ARROW_LEFT];d.indexOf(i.keyCode)===-1&&this.autoResize.resize(String.fromCharCode(i.keyCode))}}}],[{key:"EDITOR_TYPE",get:function(){return Zce}}]),e}(au),Jce="base";function Ff(t,r,e,n,i,o,a){var s=[],l=[];a.className&&Ie(r,a.className),a.readOnly&&s.push(a.readOnlyCellClassName),a.valid===!1&&a.invalidCellClassName?s.push(a.invalidCellClassName):l.push(a.invalidCellClassName),a.wordWrap===!1&&a.noWordWrapClassName&&s.push(a.noWordWrapClassName),!o&&a.placeholder&&s.push(a.placeholderCellClassName),dt(r,l),Ie(r,s)}Ff.RENDERER_TYPE=Jce;var Qce="text";function Fo(t,r,e,n,i,o,a){Ff.apply(this,[t,r,e,n,i,o,a]);var s=o;if(!s&&a.placeholder&&(s=a.placeholder),s=lr(s),t.getSettings().trimWhitespace&&(s=s.trim()),a.rendererTemplate){kn(r);var l=t.rootDocument.createElement("TEMPLATE");l.setAttribute("bind","{{}}"),l.innerHTML=a.rendererTemplate,HTMLTemplateElement.decorate(l),l.model=t.getSourceDataAtRow(e),r.appendChild(l)}else Mo(r,s)}Fo.RENDERER_TYPE=Qce;var ehe="text",vM={CELL_TYPE:ehe,editor:Na,renderer:Fo};Bn(vM);yt.editors={BaseEditor:au};function yt(t,r){var e=new B_(t,r||{},jw);return e.init(),e}yt.Core=function(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return new B_(t,r,jw)};yt.DefaultSettings=iM();yt.hooks=Ze.getSingleton();yt.packageName="handsontable";yt.buildDate="17/11/2021 15:10:38";yt.version="11.0.1";yt.languages={dictionaryKeys:Jue,getLanguageDictionary:v4,getLanguagesDictionaries:ile,registerLanguageDictionary:m4,getTranslatedPhrase:g4};function Fp(t){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?Fp=function(e){return typeof e}:Fp=function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Fp(t)}function the(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}function gM(t,r){for(var e=0;e<r.length;e++){var n=r[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function rhe(t,r,e){return r&&gM(t.prototype,r),e&&gM(t,e),t}function ni(){return typeof Reflect!="undefined"&&Reflect.get?ni=Reflect.get:ni=function(r,e,n){var i=nhe(r,e);if(!!i){var o=Object.getOwnPropertyDescriptor(i,e);return o.get?o.get.call(arguments.length<3?r:n):o.value}},ni.apply(this,arguments)}function nhe(t,r){for(;!Object.prototype.hasOwnProperty.call(t,r)&&(t=Tn(t),t!==null););return t}function ihe(t,r){if(typeof r!="function"&&r!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(r&&r.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),r&&W_(t,r)}function W_(t,r){return W_=Object.setPrototypeOf||function(n,i){return n.__proto__=i,n},W_(t,r)}function ohe(t){var r=uhe();return function(){var n=Tn(t),i;if(r){var o=Tn(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return ahe(this,i)}}function ahe(t,r){if(r&&(Fp(r)==="object"||typeof r=="function"))return r;if(r!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return she(t)}function she(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function uhe(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Tn(t){return Tn=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},Tn(t)}var lhe="handsontable",U_=function(t){ihe(e,t);var r=ohe(e);function e(){return the(this,e),r.apply(this,arguments)}return rhe(e,[{key:"open",value:function(){ni(Tn(e.prototype),"open",this).call(this),this.htEditor&&this.htEditor.destroy(),this.htContainer.style.display==="none"&&(this.htContainer.style.display=""),this.htEditor=new this.hot.constructor(this.htContainer,this.htOptions),this.htEditor.init(),this.htEditor.rootElement.style.display="",this.cellProperties.strict?this.htEditor.selectCell(0,0):this.htEditor.deselectCell(),ff(this.TEXTAREA,0,this.TEXTAREA.value.length)}},{key:"close",value:function(){this.htEditor&&(this.htEditor.rootElement.style.display="none"),this.removeHooksByKey("beforeKeyDown"),ni(Tn(e.prototype),"close",this).call(this)}},{key:"prepare",value:function(i,o,a,s,l,p){ni(Tn(e.prototype),"prepare",this).call(this,i,o,a,s,l,p);var d=this,g={startRows:0,startCols:0,minRows:0,minCols:0,className:"listbox",copyPaste:!1,autoColumnSize:!1,autoRowSize:!1,readOnly:!0,fillHandle:!1,autoWrapCol:!1,autoWrapRow:!1,afterOnCellMouseDown:function(h,u){var f=this.getSourceData(u.row,u.col);f!==void 0&&d.setValue(f),d.instance.destroyEditor()},preventWheel:!0};this.cellProperties.handsontable&&or(g,p.handsontable),this.htOptions=g}},{key:"beginEditing",value:function(i,o){var a=this.hot.getSettings().onBeginEditing;a&&a()===!1||ni(Tn(e.prototype),"beginEditing",this).call(this,i,o)}},{key:"createElements",value:function(){ni(Tn(e.prototype),"createElements",this).call(this);var i=this.hot.rootDocument.createElement("DIV");i.className="handsontableEditor",this.TEXTAREA_PARENT.appendChild(i),this.htContainer=i,this.assignHooks()}},{key:"finishEditing",value:function(i,o,a){if(this.htEditor&&this.htEditor.isListening()&&this.hot.listen(),this.htEditor&&this.htEditor.getSelectedLast()){var s=this.htEditor.getInstance().getValue();s!==void 0&&this.setValue(s)}ni(Tn(e.prototype),"finishEditing",this).call(this,i,o,a)}},{key:"assignHooks",value:function(){var i=this;this.hot.addHook("afterDestroy",function(){i.htEditor&&i.htEditor.destroy()})}},{key:"onBeforeKeyDown",value:function(i){if(!Fn(i)){var o=this.htEditor.getInstance(),a,s;if(i.keyCode===De.ARROW_DOWN){if(!o.getSelectedLast()&&!o.flipped)a=0;else if(o.getSelectedLast()){if(o.flipped)a=o.getSelectedLast()[0]+1;else if(!o.flipped){var l=o.countRows()-1;s=o.getSelectedLast()[0],a=Math.min(l,s+1)}}}else i.keyCode===De.ARROW_UP&&(!o.getSelectedLast()&&o.flipped?a=o.countRows()-1:o.getSelectedLast()&&(o.flipped?(s=o.getSelectedLast()[0],a=Math.max(0,s-1)):(s=o.getSelectedLast()[0],a=s-1)));a!==void 0&&(a<0||o.flipped&&a>o.countRows()-1?o.deselectCell():o.selectCell(a,0),o.getData().length&&(i.preventDefault(),rr(i),this.hot.listen(),this.TEXTAREA.focus())),ni(Tn(e.prototype),"onBeforeKeyDown",this).call(this,i)}}}],[{key:"EDITOR_TYPE",get:function(){return lhe}}]),e}(Na);function Bp(t){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?Bp=function(e){return typeof e}:Bp=function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Bp(t)}function fhe(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}function bM(t,r){for(var e=0;e<r.length;e++){var n=r[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function che(t,r,e){return r&&bM(t.prototype,r),e&&bM(t,e),t}function Bo(){return typeof Reflect!="undefined"&&Reflect.get?Bo=Reflect.get:Bo=function(r,e,n){var i=hhe(r,e);if(!!i){var o=Object.getOwnPropertyDescriptor(i,e);return o.get?o.get.call(arguments.length<3?r:n):o.value}},Bo.apply(this,arguments)}function hhe(t,r){for(;!Object.prototype.hasOwnProperty.call(t,r)&&(t=ii(t),t!==null););return t}function dhe(t,r){if(typeof r!="function"&&r!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(r&&r.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),r&&z_(t,r)}function z_(t,r){return z_=Object.setPrototypeOf||function(n,i){return n.__proto__=i,n},z_(t,r)}function phe(t){var r=mhe();return function(){var n=ii(t),i;if(r){var o=ii(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return yhe(this,i)}}function yhe(t,r){if(r&&(Bp(r)==="object"||typeof r=="function"))return r;if(r!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Y_(t)}function Y_(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function mhe(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function ii(t){return ii=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},ii(t)}function vhe(t,r,e){return r in t?Object.defineProperty(t,r,{value:e,enumerable:!0,configurable:!0,writable:!0}):t[r]=e,t}var G_=new WeakMap,ghe="autocomplete",K_=function(t){dhe(e,t);var r=phe(e);function e(n){var i;return fhe(this,e),i=r.call(this,n),vhe(Y_(i),"sortByRelevance",function(o,a,s){var l=[],p=[],d=o.length,g=a.length,y,h,u,f;if(d===0){for(u=0;u<g;u++)p.push(u);return p}for(u=0;u<g;u++){if(h=g0(lr(a[u])),s)f=h.indexOf(o);else{var c=this.cellProperties.locale;f=h.toLocaleLowerCase(c).indexOf(o.toLocaleLowerCase(c))}f!==-1&&(y=h.length-f-d,l.push({baseIndex:u,index:f,charsLeft:y,value:h}))}for(l.sort(function(v,m){if(m.index===-1)return-1;if(v.index===-1)return 1;if(v.index<m.index)return-1;if(m.index<v.index)return 1;if(v.index===m.index){if(v.charsLeft<m.charsLeft)return-1;if(v.charsLeft>m.charsLeft)return 1}return 0}),u=0,g=l.length;u<g;u++)p.push(l[u].baseIndex);return p}),i.query=null,i.strippedChoices=[],i.rawChoices=[],G_.set(Y_(i),{skipOne:!1,isMacOS:i.hot.rootWindow.navigator.platform.indexOf("Mac")>-1}),i}return che(e,[{key:"getValue",value:function(){var i=this,o=this.rawChoices.find(function(a){var s=i.stripValueIfNeeded(a);return s===i.TEXTAREA.value});return at(o)?o:this.TEXTAREA.value}},{key:"createElements",value:function(){Bo(ii(e.prototype),"createElements",this).call(this),Ie(this.htContainer,"autocompleteEditor"),Ie(this.htContainer,this.hot.rootWindow.navigator.platform.indexOf("Mac")===-1?"":"htMacScroll")}},{key:"open",value:function(){var i=this,o=G_.get(this);Bo(ii(e.prototype),"open",this).call(this);var a=this.htEditor.getInstance(),s=this.cellProperties.trimDropdown===void 0?!0:this.cellProperties.trimDropdown;this.showEditableElement(),this.focus();var l=Pr();l===0&&o.isMacOS&&(l+=15),a.updateSettings({colWidths:s?[sr(this.TEXTAREA)-2]:void 0,width:s?sr(this.TEXTAREA)+l:void 0,renderer:function(d,g,y,h,u,f,c){Fo(d,g,y,h,u,f,c);var v=i.cellProperties,m=v.filteringCaseSensitive,b=v.allowHtml,w=v.locale,_=i.query,C=lr(f),R,I;C&&!b&&(R=m===!0?C.indexOf(_):C.toLocaleLowerCase(w).indexOf(_.toLocaleLowerCase(w)),R!==-1&&(I=C.substr(R,_.length),C=C.replace(I,"<strong>".concat(I,"</strong>")))),g.innerHTML=C},autoColumnSize:!0}),o.skipOne&&(o.skipOne=!1),this.hot._registerTimeout(function(){i.queryChoices(i.TEXTAREA.value)})}},{key:"close",value:function(){this.removeHooksByKey("beforeKeyDown"),Bo(ii(e.prototype),"close",this).call(this)}},{key:"discardEditor",value:function(i){Bo(ii(e.prototype),"discardEditor",this).call(this,i),this.hot.view.render()}},{key:"queryChoices",value:function(i){var o=this,a=this.cellProperties.source;this.query=i,typeof a=="function"?a.call(this.cellProperties,i,function(s){o.rawChoices=s,o.updateChoicesList(o.stripValuesIfNeeded(s))}):Array.isArray(a)?(this.rawChoices=a,this.updateChoicesList(this.stripValuesIfNeeded(a))):this.updateChoicesList([])}},{key:"updateChoicesList",value:function(i){var o=O0(this.TEXTAREA),a=e3(this.TEXTAREA),s=this.cellProperties.sortByRelevance,l=this.cellProperties.filter,p=null,d=null,g=i;s&&(p=this.sortByRelevance(this.stripValueIfNeeded(this.getValue()),g,this.cellProperties.filteringCaseSensitive));var y=Array.isArray(p)?p.length:0;if(l===!1)y&&(d=p[0]);else{for(var h=[],u=0,f=g.length;u<f&&!(s&&y<=u);u++)y?h.push(g[p[u]]):h.push(g[u]);d=0,g=h}this.strippedChoices=g,this.htEditor.loadData(Vl([g])),this.updateDropdownHeight(),this.flipDropdownIfNeeded(),this.cellProperties.strict===!0&&this.highlightBestMatchingChoice(d),this.hot.listen(),ff(this.TEXTAREA,o,o===a?void 0:a)}},{key:"flipDropdownIfNeeded",value:function(){var i=ar(this.TEXTAREA),o=yr(this.TEXTAREA),a=this.getDropdownHeight(),s=Zs(this.hot.view.wt.wtTable.TABLE),l=s.scrollTop,p=yr(this.hot.view.wt.wtTable.THEAD),d={row:0,col:0};s!==this.hot.rootWindow&&(d=ar(s));var g=i.top-d.top-p+l,y=s.scrollHeight-g-p-o,h=a>y&&g>y;return h?this.flipDropdown(a):this.unflipDropdown(),this.limitDropdownIfNeeded(h?g:y,a),h}},{key:"limitDropdownIfNeeded",value:function(i,o){if(o>i){var a=0,s=0,l=0,p=null;do l=this.htEditor.getRowHeight(s)||this.htEditor.view.wt.wtSettings.settings.defaultRowHeight,a+=l,s+=1;while(a<i);p=a-l,this.htEditor.flipped&&(this.htEditor.rootElement.style.top="".concat(parseInt(this.htEditor.rootElement.style.top,10)+o-p,"px")),this.setDropdownHeight(a-l)}}},{key:"flipDropdown",value:function(i){var o=this.htEditor.rootElement.style;o.position="absolute",o.top="".concat(-i,"px"),this.htEditor.flipped=!0}},{key:"unflipDropdown",value:function(){var i=this.htEditor.rootElement.style;i.position==="absolute"&&(i.position="",i.top=""),this.htEditor.flipped=void 0}},{key:"updateDropdownHeight",value:function(){var i=this.htEditor.getColWidth(0)+Pr(this.hot.rootDocument)+2,o=this.cellProperties.trimDropdown;this.htEditor.updateSettings({height:this.getDropdownHeight(),width:o?void 0:i}),this.htEditor.view.wt.wtTable.alignOverlaysWithTrimmingContainer()}},{key:"setDropdownHeight",value:function(i){this.htEditor.updateSettings({height:i})}},{key:"highlightBestMatchingChoice",value:function(i){typeof i=="number"?this.htEditor.selectCell(i,0,void 0,void 0,void 0,!1):this.htEditor.deselectCell()}},{key:"getDropdownHeight",value:function(){var i=this.htEditor.getInstance().getRowHeight(0)||23,o=this.cellProperties.visibleRows;return this.strippedChoices.length>=o?o*i:this.strippedChoices.length*i+8}},{key:"stripValueIfNeeded",value:function(i){return this.stripValuesIfNeeded([i])[0]}},{key:"stripValuesIfNeeded",value:function(i){var o=this.cellProperties.allowHtml,a=bt(i,function(l){return lr(l)}),s=bt(a,function(l){return o?l:g0(l)});return s}},{key:"allowKeyEventPropagation",value:function(i){var o=this.htEditor.getSelectedRangeLast(),a={row:o?o.from.row:-1},s=!1;return i===De.ARROW_DOWN&&a.row>0&&a.row<this.htEditor.countRows()-1&&(s=!0),i===De.ARROW_UP&&a.row>-1&&(s=!0),s}},{key:"onBeforeKeyDown",value:function(i){var o=this,a=G_.get(this);if(a.skipOne=!1,P6(i.keyCode)||i.keyCode===De.BACKSPACE||i.keyCode===De.DELETE||i.keyCode===De.INSERT){var s=0;if(i.keyCode===De.C&&(i.ctrlKey||i.metaKey))return;this.isOpened()||(s+=10),this.htEditor&&this.hot._registerTimeout(function(){o.queryChoices(o.TEXTAREA.value),a.skipOne=!0},s)}Bo(ii(e.prototype),"onBeforeKeyDown",this).call(this,i)}}],[{key:"EDITOR_TYPE",get:function(){return ghe}}]),e}(U_);function Vp(t){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?Vp=function(e){return typeof e}:Vp=function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Vp(t)}function bhe(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}function wM(t,r){for(var e=0;e<r.length;e++){var n=r[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function whe(t,r,e){return r&&wM(t.prototype,r),e&&wM(t,e),t}function _he(t,r){if(typeof r!="function"&&r!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(r&&r.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),r&&q_(t,r)}function q_(t,r){return q_=Object.setPrototypeOf||function(n,i){return n.__proto__=i,n},q_(t,r)}function She(t){var r=Ohe();return function(){var n=Wp(t),i;if(r){var o=Wp(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return Che(this,i)}}function Che(t,r){if(r&&(Vp(r)==="object"||typeof r=="function"))return r;if(r!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return khe(t)}function khe(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Ohe(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Wp(t){return Wp=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},Wp(t)}var Rhe="checkbox",_M=function(t){_he(e,t);var r=She(e);function e(){return bhe(this,e),r.apply(this,arguments)}return whe(e,[{key:"beginEditing",value:function(i,o){if(o&&o.type==="mouseup"){var a=this.TD.querySelector('input[type="checkbox"]');lt(a,"htBadValue")||a.click()}}},{key:"finishEditing",value:function(){}},{key:"init",value:function(){}},{key:"open",value:function(){}},{key:"close",value:function(){}},{key:"getValue",value:function(){}},{key:"setValue",value:function(){}},{key:"focus",value:function(){}}],[{key:"EDITOR_TYPE",get:function(){return Rhe}}]),e}(au),SM={exports:{}};/*!
 * Pikaday
 *
 * Copyright © 2014 David Bushell | BSD & MIT license | https://github.com/Pikaday/Pikaday
 */(function(t,r){(function(e,n){var i;{try{i=require("moment")}catch{}t.exports=n(i)}})(At,function(e){var n=typeof e=="function",i=!!window.addEventListener,o=window.document,a=window.setTimeout,s=function(k,O,x,j){i?k.addEventListener(O,x,!!j):k.attachEvent("on"+O,x)},l=function(k,O,x,j){i?k.removeEventListener(O,x,!!j):k.detachEvent("on"+O,x)},p=function(k){return k.trim?k.trim():k.replace(/^\s+|\s+$/g,"")},d=function(k,O){return(" "+k.className+" ").indexOf(" "+O+" ")!==-1},g=function(k,O){d(k,O)||(k.className=k.className===""?O:k.className+" "+O)},y=function(k,O){k.className=p((" "+k.className+" ").replace(" "+O+" "," "))},h=function(k){return/Array/.test(Object.prototype.toString.call(k))},u=function(k){return/Date/.test(Object.prototype.toString.call(k))&&!isNaN(k.getTime())},f=function(k){var O=k.getDay();return O===0||O===6},c=function(k){return k%4==0&&k%100!=0||k%400==0},v=function(k,O){return[31,c(k)?29:28,31,30,31,30,31,31,30,31,30,31][O]},m=function(k){u(k)&&k.setHours(0,0,0,0)},b=function(k,O){return k.getTime()===O.getTime()},w=function(k,O,x){var j,H;for(j in O)H=k[j]!==void 0,H&&typeof O[j]=="object"&&O[j]!==null&&O[j].nodeName===void 0?u(O[j])?x&&(k[j]=new Date(O[j].getTime())):h(O[j])?x&&(k[j]=O[j].slice(0)):k[j]=w({},O[j],x):(x||!H)&&(k[j]=O[j]);return k},_=function(k,O,x){var j;o.createEvent?(j=o.createEvent("HTMLEvents"),j.initEvent(O,!0,!1),j=w(j,x),k.dispatchEvent(j)):o.createEventObject&&(j=o.createEventObject(),j=w(j,x),k.fireEvent("on"+O,j))},C=function(k){return k.month<0&&(k.year-=Math.ceil(Math.abs(k.month)/12),k.month+=12),k.month>11&&(k.year+=Math.floor(Math.abs(k.month)/12),k.month-=12),k},R={field:null,bound:void 0,ariaLabel:"Use the arrow keys to pick a date",position:"bottom left",reposition:!0,format:"YYYY-MM-DD",toString:null,parse:null,defaultDate:null,setDefaultDate:!1,firstDay:0,formatStrict:!1,minDate:null,maxDate:null,yearRange:10,showWeekNumber:!1,pickWholeWeek:!1,minYear:0,maxYear:9999,minMonth:void 0,maxMonth:void 0,startRange:null,endRange:null,isRTL:!1,yearSuffix:"",showMonthAfterYear:!1,showDaysInNextAndPreviousMonths:!1,enableSelectionDaysInNextAndPreviousMonths:!1,numberOfMonths:1,mainCalendar:"left",container:void 0,blurFieldOnSelect:!0,i18n:{previousMonth:"Previous Month",nextMonth:"Next Month",months:["January","February","March","April","May","June","July","August","September","October","November","December"],weekdays:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],weekdaysShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"]},theme:null,events:[],onSelect:null,onOpen:null,onClose:null,onDraw:null,keyboardInput:!0},I=function(k,O,x){for(O+=k.firstDay;O>=7;)O-=7;return x?k.i18n.weekdaysShort[O]:k.i18n.weekdays[O]},P=function(k){var O=[],x="false";if(k.isEmpty)if(k.showDaysInNextAndPreviousMonths)O.push("is-outside-current-month"),k.enableSelectionDaysInNextAndPreviousMonths||O.push("is-selection-disabled");else return'<td class="is-empty"></td>';return k.isDisabled&&O.push("is-disabled"),k.isToday&&O.push("is-today"),k.isSelected&&(O.push("is-selected"),x="true"),k.hasEvent&&O.push("has-event"),k.isInRange&&O.push("is-inrange"),k.isStartRange&&O.push("is-startrange"),k.isEndRange&&O.push("is-endrange"),'<td data-day="'+k.day+'" class="'+O.join(" ")+'" aria-selected="'+x+'"><button class="pika-button pika-day" type="button" data-pika-year="'+k.year+'" data-pika-month="'+k.month+'" data-pika-day="'+k.day+'">'+k.day+"</button></td>"},N=function(k,O,x){var j=new Date(x,0,1),H=Math.ceil(((new Date(x,O,k)-j)/864e5+j.getDay()+1)/7);return'<td class="pika-week">'+H+"</td>"},A=function(k,O,x,j){return'<tr class="pika-row'+(x?" pick-whole-week":"")+(j?" is-selected":"")+'">'+(O?k.reverse():k).join("")+"</tr>"},$=function(k){return"<tbody>"+k.join("")+"</tbody>"},T=function(k){var O,x=[];for(k.showWeekNumber&&x.push("<th></th>"),O=0;O<7;O++)x.push('<th scope="col"><abbr title="'+I(k,O)+'">'+I(k,O,!0)+"</abbr></th>");return"<thead><tr>"+(k.isRTL?x.reverse():x).join("")+"</tr></thead>"},M=function(k,O,x,j,H,F){var V,W,U,Y=k._o,K=x===Y.minYear,D=x===Y.maxYear,L='<div id="'+F+'" class="pika-title" role="heading" aria-live="assertive">',B,z,q=!0,X=!0;for(U=[],V=0;V<12;V++)U.push('<option value="'+(x===H?V-O:12+V-O)+'"'+(V===j?' selected="selected"':"")+(K&&V<Y.minMonth||D&&V>Y.maxMonth?'disabled="disabled"':"")+">"+Y.i18n.months[V]+"</option>");for(B='<div class="pika-label">'+Y.i18n.months[j]+'<select class="pika-select pika-select-month" tabindex="-1">'+U.join("")+"</select></div>",h(Y.yearRange)?(V=Y.yearRange[0],W=Y.yearRange[1]+1):(V=x-Y.yearRange,W=1+x+Y.yearRange),U=[];V<W&&V<=Y.maxYear;V++)V>=Y.minYear&&U.push('<option value="'+V+'"'+(V===x?' selected="selected"':"")+">"+V+"</option>");return z='<div class="pika-label">'+x+Y.yearSuffix+'<select class="pika-select pika-select-year" tabindex="-1">'+U.join("")+"</select></div>",Y.showMonthAfterYear?L+=z+B:L+=B+z,K&&(j===0||Y.minMonth>=j)&&(q=!1),D&&(j===11||Y.maxMonth<=j)&&(X=!1),O===0&&(L+='<button class="pika-prev'+(q?"":" is-disabled")+'" type="button">'+Y.i18n.previousMonth+"</button>"),O===k._o.numberOfMonths-1&&(L+='<button class="pika-next'+(X?"":" is-disabled")+'" type="button">'+Y.i18n.nextMonth+"</button>"),L+="</div>"},S=function(k,O,x){return'<table cellpadding="0" cellspacing="0" class="pika-table" role="grid" aria-labelledby="'+x+'">'+T(k)+$(O)+"</table>"},E=function(k){var O=this,x=O.config(k);O._onMouseDown=function(H){if(!!O._v){H=H||window.event;var F=H.target||H.srcElement;if(!!F)if(d(F,"is-disabled")||(d(F,"pika-button")&&!d(F,"is-empty")&&!d(F.parentNode,"is-disabled")?(O.setDate(new Date(F.getAttribute("data-pika-year"),F.getAttribute("data-pika-month"),F.getAttribute("data-pika-day"))),x.bound&&a(function(){O.hide(),x.blurFieldOnSelect&&x.field&&x.field.blur()},100)):d(F,"pika-prev")?O.prevMonth():d(F,"pika-next")&&O.nextMonth()),d(F,"pika-select"))O._c=!0;else if(H.preventDefault)H.preventDefault();else return H.returnValue=!1,!1}},O._onChange=function(H){H=H||window.event;var F=H.target||H.srcElement;!F||(d(F,"pika-select-month")?O.gotoMonth(F.value):d(F,"pika-select-year")&&O.gotoYear(F.value))},O._onKeyChange=function(H){if(H=H||window.event,O.isVisible())switch(H.keyCode){case 13:case 27:x.field&&x.field.blur();break;case 37:H.preventDefault(),O.adjustDate("subtract",1);break;case 38:O.adjustDate("subtract",7);break;case 39:O.adjustDate("add",1);break;case 40:O.adjustDate("add",7);break}},O._onInputChange=function(H){var F;H.firedBy!==O&&(x.parse?F=x.parse(x.field.value,x.format):n?(F=e(x.field.value,x.format,x.formatStrict),F=F&&F.isValid()?F.toDate():null):F=new Date(Date.parse(x.field.value)),u(F)&&O.setDate(F),O._v||O.show())},O._onInputFocus=function(){O.show()},O._onInputClick=function(){O.show()},O._onInputBlur=function(){var H=o.activeElement;do if(d(H,"pika-single"))return;while(H=H.parentNode);O._c||(O._b=a(function(){O.hide()},50)),O._c=!1},O._onClick=function(H){H=H||window.event;var F=H.target||H.srcElement,V=F;if(!!F){!i&&d(F,"pika-select")&&(F.onchange||(F.setAttribute("onchange","return;"),s(F,"change",O._onChange)));do if(d(V,"pika-single")||V===x.trigger)return;while(V=V.parentNode);O._v&&F!==x.trigger&&V!==x.trigger&&O.hide()}},O.el=o.createElement("div"),O.el.className="pika-single"+(x.isRTL?" is-rtl":"")+(x.theme?" "+x.theme:""),s(O.el,"mousedown",O._onMouseDown,!0),s(O.el,"touchend",O._onMouseDown,!0),s(O.el,"change",O._onChange),x.keyboardInput&&s(o,"keydown",O._onKeyChange),x.field&&(x.container?x.container.appendChild(O.el):x.bound?o.body.appendChild(O.el):x.field.parentNode.insertBefore(O.el,x.field.nextSibling),s(x.field,"change",O._onInputChange),x.defaultDate||(n&&x.field.value?x.defaultDate=e(x.field.value,x.format).toDate():x.defaultDate=new Date(Date.parse(x.field.value)),x.setDefaultDate=!0));var j=x.defaultDate;u(j)?x.setDefaultDate?O.setDate(j,!0):O.gotoDate(j):O.gotoDate(new Date),x.bound?(this.hide(),O.el.className+=" is-bound",s(x.trigger,"click",O._onInputClick),s(x.trigger,"focus",O._onInputFocus),s(x.trigger,"blur",O._onInputBlur)):this.show()};return E.prototype={config:function(k){this._o||(this._o=w({},R,!0));var O=w(this._o,k,!0);O.isRTL=!!O.isRTL,O.field=O.field&&O.field.nodeName?O.field:null,O.theme=typeof O.theme=="string"&&O.theme?O.theme:null,O.bound=!!(O.bound!==void 0?O.field&&O.bound:O.field),O.trigger=O.trigger&&O.trigger.nodeName?O.trigger:O.field,O.disableWeekends=!!O.disableWeekends,O.disableDayFn=typeof O.disableDayFn=="function"?O.disableDayFn:null;var x=parseInt(O.numberOfMonths,10)||1;if(O.numberOfMonths=x>4?4:x,u(O.minDate)||(O.minDate=!1),u(O.maxDate)||(O.maxDate=!1),O.minDate&&O.maxDate&&O.maxDate<O.minDate&&(O.maxDate=O.minDate=!1),O.minDate&&this.setMinDate(O.minDate),O.maxDate&&this.setMaxDate(O.maxDate),h(O.yearRange)){var j=new Date().getFullYear()-10;O.yearRange[0]=parseInt(O.yearRange[0],10)||j,O.yearRange[1]=parseInt(O.yearRange[1],10)||j}else O.yearRange=Math.abs(parseInt(O.yearRange,10))||R.yearRange,O.yearRange>100&&(O.yearRange=100);return O},toString:function(k){return k=k||this._o.format,u(this._d)?this._o.toString?this._o.toString(this._d,k):n?e(this._d).format(k):this._d.toDateString():""},getMoment:function(){return n?e(this._d):null},setMoment:function(k,O){n&&e.isMoment(k)&&this.setDate(k.toDate(),O)},getDate:function(){return u(this._d)?new Date(this._d.getTime()):null},setDate:function(k,O){if(!k)return this._d=null,this._o.field&&(this._o.field.value="",_(this._o.field,"change",{firedBy:this})),this.draw();if(typeof k=="string"&&(k=new Date(Date.parse(k))),!!u(k)){var x=this._o.minDate,j=this._o.maxDate;u(x)&&k<x?k=x:u(j)&&k>j&&(k=j),this._d=new Date(k.getTime()),m(this._d),this.gotoDate(this._d),this._o.field&&(this._o.field.value=this.toString(),_(this._o.field,"change",{firedBy:this})),!O&&typeof this._o.onSelect=="function"&&this._o.onSelect.call(this,this.getDate())}},gotoDate:function(k){var O=!0;if(!!u(k)){if(this.calendars){var x=new Date(this.calendars[0].year,this.calendars[0].month,1),j=new Date(this.calendars[this.calendars.length-1].year,this.calendars[this.calendars.length-1].month,1),H=k.getTime();j.setMonth(j.getMonth()+1),j.setDate(j.getDate()-1),O=H<x.getTime()||j.getTime()<H}O&&(this.calendars=[{month:k.getMonth(),year:k.getFullYear()}],this._o.mainCalendar==="right"&&(this.calendars[0].month+=1-this._o.numberOfMonths)),this.adjustCalendars()}},adjustDate:function(k,O){var x=this.getDate()||new Date,j=parseInt(O)*24*60*60*1e3,H;k==="add"?H=new Date(x.valueOf()+j):k==="subtract"&&(H=new Date(x.valueOf()-j)),this.setDate(H)},adjustCalendars:function(){this.calendars[0]=C(this.calendars[0]);for(var k=1;k<this._o.numberOfMonths;k++)this.calendars[k]=C({month:this.calendars[0].month+k,year:this.calendars[0].year});this.draw()},gotoToday:function(){this.gotoDate(new Date)},gotoMonth:function(k){isNaN(k)||(this.calendars[0].month=parseInt(k,10),this.adjustCalendars())},nextMonth:function(){this.calendars[0].month++,this.adjustCalendars()},prevMonth:function(){this.calendars[0].month--,this.adjustCalendars()},gotoYear:function(k){isNaN(k)||(this.calendars[0].year=parseInt(k,10),this.adjustCalendars())},setMinDate:function(k){k instanceof Date?(m(k),this._o.minDate=k,this._o.minYear=k.getFullYear(),this._o.minMonth=k.getMonth()):(this._o.minDate=R.minDate,this._o.minYear=R.minYear,this._o.minMonth=R.minMonth,this._o.startRange=R.startRange),this.draw()},setMaxDate:function(k){k instanceof Date?(m(k),this._o.maxDate=k,this._o.maxYear=k.getFullYear(),this._o.maxMonth=k.getMonth()):(this._o.maxDate=R.maxDate,this._o.maxYear=R.maxYear,this._o.maxMonth=R.maxMonth,this._o.endRange=R.endRange),this.draw()},setStartRange:function(k){this._o.startRange=k},setEndRange:function(k){this._o.endRange=k},draw:function(k){if(!(!this._v&&!k)){var O=this._o,x=O.minYear,j=O.maxYear,H=O.minMonth,F=O.maxMonth,V="",W;this._y<=x&&(this._y=x,!isNaN(H)&&this._m<H&&(this._m=H)),this._y>=j&&(this._y=j,!isNaN(F)&&this._m>F&&(this._m=F)),W="pika-title-"+Math.random().toString(36).replace(/[^a-z]+/g,"").substr(0,2);for(var U=0;U<O.numberOfMonths;U++)V+='<div class="pika-lendar">'+M(this,U,this.calendars[U].year,this.calendars[U].month,this.calendars[0].year,W)+this.render(this.calendars[U].year,this.calendars[U].month,W)+"</div>";this.el.innerHTML=V,O.bound&&O.field.type!=="hidden"&&a(function(){O.trigger.focus()},1),typeof this._o.onDraw=="function"&&this._o.onDraw(this),O.bound&&O.field.setAttribute("aria-label",O.ariaLabel)}},adjustPosition:function(){var k,O,x,j,H,F,V,W,U,Y,K,D;if(!this._o.container){if(this.el.style.position="absolute",k=this._o.trigger,O=k,x=this.el.offsetWidth,j=this.el.offsetHeight,H=window.innerWidth||o.documentElement.clientWidth,F=window.innerHeight||o.documentElement.clientHeight,V=window.pageYOffset||o.body.scrollTop||o.documentElement.scrollTop,K=!0,D=!0,typeof k.getBoundingClientRect=="function")Y=k.getBoundingClientRect(),W=Y.left+window.pageXOffset,U=Y.bottom+window.pageYOffset;else for(W=O.offsetLeft,U=O.offsetTop+O.offsetHeight;O=O.offsetParent;)W+=O.offsetLeft,U+=O.offsetTop;(this._o.reposition&&W+x>H||this._o.position.indexOf("right")>-1&&W-x+k.offsetWidth>0)&&(W=W-x+k.offsetWidth,K=!1),(this._o.reposition&&U+j>F+V||this._o.position.indexOf("top")>-1&&U-j-k.offsetHeight>0)&&(U=U-j-k.offsetHeight,D=!1),this.el.style.left=W+"px",this.el.style.top=U+"px",g(this.el,K?"left-aligned":"right-aligned"),g(this.el,D?"bottom-aligned":"top-aligned"),y(this.el,K?"right-aligned":"left-aligned"),y(this.el,D?"top-aligned":"bottom-aligned")}},render:function(k,O,x){var j=this._o,H=new Date,F=v(k,O),V=new Date(k,O,1).getDay(),W=[],U=[];m(H),j.firstDay>0&&(V-=j.firstDay,V<0&&(V+=7));for(var Y=O===0?11:O-1,K=O===11?0:O+1,D=O===0?k-1:k,L=O===11?k+1:k,B=v(D,Y),z=F+V,q=z;q>7;)q-=7;z+=7-q;for(var X=!1,ee=0,ye=0;ee<z;ee++){var de=new Date(k,O,1+(ee-V)),ge=u(this._d)?b(de,this._d):!1,we=b(de,H),be=j.events.indexOf(de.toDateString())!==-1,J=ee<V||ee>=F+V,te=1+(ee-V),ie=O,fe=k,se=j.startRange&&b(j.startRange,de),oe=j.endRange&&b(j.endRange,de),G=j.startRange&&j.endRange&&j.startRange<de&&de<j.endRange,Z=j.minDate&&de<j.minDate||j.maxDate&&de>j.maxDate||j.disableWeekends&&f(de)||j.disableDayFn&&j.disableDayFn(de);J&&(ee<V?(te=B+te,ie=Y,fe=D):(te=te-F,ie=K,fe=L));var Q={day:te,month:ie,year:fe,hasEvent:be,isSelected:ge,isToday:we,isDisabled:Z,isEmpty:J,isStartRange:se,isEndRange:oe,isInRange:G,showDaysInNextAndPreviousMonths:j.showDaysInNextAndPreviousMonths,enableSelectionDaysInNextAndPreviousMonths:j.enableSelectionDaysInNextAndPreviousMonths};j.pickWholeWeek&&ge&&(X=!0),U.push(P(Q)),++ye==7&&(j.showWeekNumber&&U.unshift(N(ee-V,O,k)),W.push(A(U,j.isRTL,j.pickWholeWeek,X)),U=[],ye=0,X=!1)}return S(j,W,x)},isVisible:function(){return this._v},show:function(){this.isVisible()||(this._v=!0,this.draw(),y(this.el,"is-hidden"),this._o.bound&&(s(o,"click",this._onClick),this.adjustPosition()),typeof this._o.onOpen=="function"&&this._o.onOpen.call(this))},hide:function(){var k=this._v;k!==!1&&(this._o.bound&&l(o,"click",this._onClick),this.el.style.position="static",this.el.style.left="auto",this.el.style.top="auto",g(this.el,"is-hidden"),this._v=!1,k!==void 0&&typeof this._o.onClose=="function"&&this._o.onClose.call(this))},destroy:function(){var k=this._o;this.hide(),l(this.el,"mousedown",this._onMouseDown,!0),l(this.el,"touchend",this._onMouseDown,!0),l(this.el,"change",this._onChange),k.keyboardInput&&l(o,"keydown",this._onKeyChange),k.field&&(l(k.field,"change",this._onInputChange),k.bound&&(l(k.trigger,"click",this._onInputClick),l(k.trigger,"focus",this._onInputFocus),l(k.trigger,"blur",this._onInputBlur))),this.el.parentNode&&this.el.parentNode.removeChild(this.el)}},E})})(SM);var CM=SM.exports;function Up(t){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?Up=function(e){return typeof e}:Up=function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Up(t)}function Ehe(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}function kM(t,r){for(var e=0;e<r.length;e++){var n=r[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function The(t,r,e){return r&&kM(t.prototype,r),e&&kM(t,e),t}function Pi(){return typeof Reflect!="undefined"&&Reflect.get?Pi=Reflect.get:Pi=function(r,e,n){var i=xhe(r,e);if(!!i){var o=Object.getOwnPropertyDescriptor(i,e);return o.get?o.get.call(arguments.length<3?r:n):o.value}},Pi.apply(this,arguments)}function xhe(t,r){for(;!Object.prototype.hasOwnProperty.call(t,r)&&(t=Wn(t),t!==null););return t}function Ahe(t,r){if(typeof r!="function"&&r!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(r&&r.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),r&&X_(t,r)}function X_(t,r){return X_=Object.setPrototypeOf||function(n,i){return n.__proto__=i,n},X_(t,r)}function Mhe(t){var r=Dhe();return function(){var n=Wn(t),i;if(r){var o=Wn(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return Phe(this,i)}}function Phe(t,r){if(r&&(Up(r)==="object"||typeof r=="function"))return r;if(r!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Ihe(t)}function Ihe(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Dhe(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Wn(t){return Wn=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},Wn(t)}var OM="date",RM=function(t){Ahe(e,t);var r=Mhe(e);function e(n){var i;return Ehe(this,e),i=r.call(this,n),i.defaultDateFormat="DD/MM/YYYY",i.isCellEdited=!1,i.parentDestroyed=!1,i.$datePicker=null,i}return The(e,[{key:"init",value:function(){var i=this;if(typeof $e!="function")throw new Error("You need to include moment.js to your project.");if(typeof CM!="function")throw new Error("You need to include Pikaday to your project.");Pi(Wn(e.prototype),"init",this).call(this),this.instance.addHook("afterDestroy",function(){i.parentDestroyed=!0,i.destroyElements()})}},{key:"createElements",value:function(){Pi(Wn(e.prototype),"createElements",this).call(this),this.datePicker=this.hot.rootDocument.createElement("DIV"),this.datePickerStyle=this.datePicker.style,this.datePickerStyle.position="absolute",this.datePickerStyle.top=0,this.datePickerStyle.left=0,this.datePickerStyle.zIndex=9999,Ie(this.datePicker,"htDatepickerHolder"),this.hot.rootDocument.body.appendChild(this.datePicker);var i=new Wt(this);i.addEventListener(this.datePicker,"mousedown",function(o){return o.stopPropagation()})}},{key:"destroyElements",value:function(){var i=this.datePicker.parentNode;this.$datePicker&&this.$datePicker.destroy(),i&&i.removeChild(this.datePicker)}},{key:"prepare",value:function(i,o,a,s,l,p){Pi(Wn(e.prototype),"prepare",this).call(this,i,o,a,s,l,p)}},{key:"open",value:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;Pi(Wn(e.prototype),"open",this).call(this),this.showDatepicker(i)}},{key:"close",value:function(){var i,o=this;this._opened=!1,(i=this.$datePicker)!==null&&i!==void 0&&i.destroy&&this.$datePicker.destroy(),this.instance._registerTimeout(function(){o.instance._refreshBorders()}),Pi(Wn(e.prototype),"close",this).call(this)}},{key:"finishEditing",value:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(i){var a=this.originalValue;a!==void 0&&this.setValue(a)}Pi(Wn(e.prototype),"finishEditing",this).call(this,i,o)}},{key:"showDatepicker",value:function(i){var o=this.TD.getBoundingClientRect(),a=this.cellProperties.dateFormat||this.defaultDateFormat,s=this.instance.view.isMouseDown(),l=i?uw(i.keyCode):!1,p;this.datePickerStyle.top="".concat(this.hot.rootWindow.pageYOffset+o.top+yr(this.TD),"px"),this.datePickerStyle.left="".concat(this.hot.rootWindow.pageXOffset+o.left,"px"),this.$datePicker=new CM(this.getDatePickerConfig()),this.$datePicker._onInputFocus=function(){},this.originalValue?(p=this.originalValue,$e(p,a,!0).isValid()&&this.$datePicker.setMoment($e(p,a),!0),this.getValue()!==this.originalValue&&this.setValue(this.originalValue),!l&&!s&&this.setValue("")):this.cellProperties.defaultDate?(p=this.cellProperties.defaultDate,$e(p,a,!0).isValid()&&this.$datePicker.setMoment($e(p,a),!0),!l&&!s&&this.setValue("")):this.$datePicker.gotoToday(),this.datePickerStyle.display="block"}},{key:"hideDatepicker",value:function(){this.datePickerStyle.display="none",this.$datePicker.hide()}},{key:"getDatePickerConfig",value:function(){var i=this,o=this.TEXTAREA,a={};this.cellProperties&&this.cellProperties.datePickerConfig&&Wl(a,this.cellProperties.datePickerConfig);var s=a.onSelect,l=a.onClose;return a.field=o,a.trigger=o,a.container=this.datePicker,a.bound=!1,a.format=a.format||this.defaultDateFormat,a.reposition=a.reposition||!1,a.onSelect=function(p){var d=p;isNaN(d.getTime())||(d=$e(d).format(i.cellProperties.dateFormat||i.defaultDateFormat)),i.setValue(d),i.hideDatepicker(),s&&s()},a.onClose=function(){i.parentDestroyed||i.finishEditing(!1),l&&l()},a}}],[{key:"EDITOR_TYPE",get:function(){return OM}}]),e}(Na);function zp(t){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?zp=function(e){return typeof e}:zp=function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},zp(t)}function Nhe(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}function EM(t,r){for(var e=0;e<r.length;e++){var n=r[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function $he(t,r,e){return r&&EM(t.prototype,r),e&&EM(t,e),t}function Yp(){return typeof Reflect!="undefined"&&Reflect.get?Yp=Reflect.get:Yp=function(r,e,n){var i=jhe(r,e);if(!!i){var o=Object.getOwnPropertyDescriptor(i,e);return o.get?o.get.call(arguments.length<3?r:n):o.value}},Yp.apply(this,arguments)}function jhe(t,r){for(;!Object.prototype.hasOwnProperty.call(t,r)&&(t=yu(t),t!==null););return t}function Lhe(t,r){if(typeof r!="function"&&r!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(r&&r.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),r&&Z_(t,r)}function Z_(t,r){return Z_=Object.setPrototypeOf||function(n,i){return n.__proto__=i,n},Z_(t,r)}function Hhe(t){var r=Vhe();return function(){var n=yu(t),i;if(r){var o=yu(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return Fhe(this,i)}}function Fhe(t,r){if(r&&(zp(r)==="object"||typeof r=="function"))return r;if(r!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Bhe(t)}function Bhe(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Vhe(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function yu(t){return yu=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},yu(t)}var Whe="dropdown",J_=function(t){Lhe(e,t);var r=Hhe(e);function e(){return Nhe(this,e),r.apply(this,arguments)}return $he(e,[{key:"prepare",value:function(i,o,a,s,l,p){Yp(yu(e.prototype),"prepare",this).call(this,i,o,a,s,l,p),this.cellProperties.filter=!1,this.cellProperties.strict=!0}}],[{key:"EDITOR_TYPE",get:function(){return Whe}}]),e}(K_);Ze.getSingleton().add("beforeValidate",function(t,r,e){var n=this.getCellMeta(r,this.propToCol(e));n.editor===J_&&n.strict===void 0&&(n.filter=!1,n.strict=!0)});function Gp(t){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?Gp=function(e){return typeof e}:Gp=function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Gp(t)}function Uhe(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}function TM(t,r){for(var e=0;e<r.length;e++){var n=r[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function zhe(t,r,e){return r&&TM(t.prototype,r),e&&TM(t,e),t}function Yhe(t,r){if(typeof r!="function"&&r!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(r&&r.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),r&&Q_(t,r)}function Q_(t,r){return Q_=Object.setPrototypeOf||function(n,i){return n.__proto__=i,n},Q_(t,r)}function Ghe(t){var r=Xhe();return function(){var n=Kp(t),i;if(r){var o=Kp(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return Khe(this,i)}}function Khe(t,r){if(r&&(Gp(r)==="object"||typeof r=="function"))return r;if(r!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return qhe(t)}function qhe(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Xhe(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Kp(t){return Kp=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},Kp(t)}var Zhe="numeric",xM=function(t){Yhe(e,t);var r=Ghe(e);function e(){return Uhe(this,e),r.apply(this,arguments)}return zhe(e,null,[{key:"EDITOR_TYPE",get:function(){return Zhe}}]),e}(Na);function qp(t){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?qp=function(e){return typeof e}:qp=function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},qp(t)}function Jhe(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}function AM(t,r){for(var e=0;e<r.length;e++){var n=r[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function Qhe(t,r,e){return r&&AM(t.prototype,r),e&&AM(t,e),t}function Xp(){return typeof Reflect!="undefined"&&Reflect.get?Xp=Reflect.get:Xp=function(r,e,n){var i=ede(r,e);if(!!i){var o=Object.getOwnPropertyDescriptor(i,e);return o.get?o.get.call(arguments.length<3?r:n):o.value}},Xp.apply(this,arguments)}function ede(t,r){for(;!Object.prototype.hasOwnProperty.call(t,r)&&(t=mu(t),t!==null););return t}function tde(t,r){if(typeof r!="function"&&r!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(r&&r.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),r&&eS(t,r)}function eS(t,r){return eS=Object.setPrototypeOf||function(n,i){return n.__proto__=i,n},eS(t,r)}function rde(t){var r=ode();return function(){var n=mu(t),i;if(r){var o=mu(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return nde(this,i)}}function nde(t,r){if(r&&(qp(r)==="object"||typeof r=="function"))return r;if(r!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return ide(t)}function ide(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function ode(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function mu(t){return mu=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},mu(t)}var ade="password",MM=function(t){tde(e,t);var r=rde(e);function e(){return Jhe(this,e),r.apply(this,arguments)}return Qhe(e,[{key:"createElements",value:function(){Xp(mu(e.prototype),"createElements",this).call(this),this.TEXTAREA=this.hot.rootDocument.createElement("input"),this.TEXTAREA.setAttribute("type","password"),this.TEXTAREA.setAttribute("data-hot-input",""),this.TEXTAREA.className="handsontableInput",this.textareaStyle=this.TEXTAREA.style,this.textareaStyle.width=0,this.textareaStyle.height=0,kn(this.TEXTAREA_PARENT),this.TEXTAREA_PARENT.appendChild(this.TEXTAREA)}}],[{key:"EDITOR_TYPE",get:function(){return ade}}]),e}(Na);function Bf(t){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?Bf=function(e){return typeof e}:Bf=function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Bf(t)}function sde(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}function PM(t,r){for(var e=0;e<r.length;e++){var n=r[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function ude(t,r,e){return r&&PM(t.prototype,r),e&&PM(t,e),t}function Zp(){return typeof Reflect!="undefined"&&Reflect.get?Zp=Reflect.get:Zp=function(r,e,n){var i=lde(r,e);if(!!i){var o=Object.getOwnPropertyDescriptor(i,e);return o.get?o.get.call(arguments.length<3?r:n):o.value}},Zp.apply(this,arguments)}function lde(t,r){for(;!Object.prototype.hasOwnProperty.call(t,r)&&(t=vu(t),t!==null););return t}function fde(t,r){if(typeof r!="function"&&r!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(r&&r.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),r&&tS(t,r)}function tS(t,r){return tS=Object.setPrototypeOf||function(n,i){return n.__proto__=i,n},tS(t,r)}function cde(t){var r=pde();return function(){var n=vu(t),i;if(r){var o=vu(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return hde(this,i)}}function hde(t,r){if(r&&(Bf(r)==="object"||typeof r=="function"))return r;if(r!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return dde(t)}function dde(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function pde(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function vu(t){return vu=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},vu(t)}var rS="ht_editor_visible",yde="select",mde=function(t){fde(e,t);var r=cde(e);function e(){return sde(this,e),r.apply(this,arguments)}return ude(e,[{key:"init",value:function(){this.select=this.hot.rootDocument.createElement("SELECT"),Ie(this.select,"htSelectEditor"),this.select.style.display="none",this.hot.rootElement.appendChild(this.select),this.registerHooks()}},{key:"getValue",value:function(){return this.select.value}},{key:"setValue",value:function(i){this.select.value=i}},{key:"open",value:function(){var i=this;this._opened=!0,this.refreshDimensions(),this.select.style.display="",this.addHook("beforeKeyDown",function(){return i.onBeforeKeyDown()})}},{key:"close",value:function(){this._opened=!1,this.select.style.display="none",lt(this.select,rS)&&dt(this.select,rS),this.clearHooks()}},{key:"focus",value:function(){this.select.focus()}},{key:"registerHooks",value:function(){var i=this;this.addHook("afterScrollHorizontally",function(){return i.refreshDimensions()}),this.addHook("afterScrollVertically",function(){return i.refreshDimensions()}),this.addHook("afterColumnResize",function(){return i.refreshDimensions()}),this.addHook("afterRowResize",function(){return i.refreshDimensions()})}},{key:"prepare",value:function(i,o,a,s,l,p){var d=this;Zp(vu(e.prototype),"prepare",this).call(this,i,o,a,s,l,p);var g=this.cellProperties.selectOptions,y;typeof g=="function"?y=this.prepareOptions(g(this.row,this.col,this.prop)):y=this.prepareOptions(g),kn(this.select),Ot(y,function(h,u){var f=d.hot.rootDocument.createElement("OPTION");f.value=u,Ao(f,h),d.select.appendChild(f)})}},{key:"prepareOptions",value:function(i){var o={};if(Array.isArray(i))for(var a=0,s=i.length;a<s;a++)o[i[a]]=i[a];else Bf(i)==="object"&&(o=i);return o}},{key:"refreshValue",value:function(){var i=this.hot.getSourceDataAtCell(this.row,this.prop);this.originalValue=i,this.setValue(i),this.refreshDimensions()}},{key:"refreshDimensions",value:function(){if(this.state===Ir.EDITING){if(this.TD=this.getEditedCell(),!this.TD){this.close();return}var i=this.hot.view.wt.wtOverlays,o=ar(this.TD),a=ar(this.hot.rootElement),s=i.scrollableElement,l=this.checkEditorSection(),p=sr(this.TD)+1,d=yr(this.TD)+1,g=o.top-a.top-1-(s.scrollTop||0),y=o.left-a.left-1-(s.scrollLeft||0),h;switch(l){case"top":h=Hn(i.topOverlay.clone.wtTable.holder.parentNode);break;case"left":h=Hn(i.leftOverlay.clone.wtTable.holder.parentNode);break;case"top-left-corner":h=Hn(i.topLeftCornerOverlay.clone.wtTable.holder.parentNode);break;case"bottom-left-corner":h=Hn(i.bottomLeftCornerOverlay.clone.wtTable.holder.parentNode);break;case"bottom":h=Hn(i.bottomOverlay.clone.wtTable.holder.parentNode);break}var u=this.hot.rowIndexMapper.getRenderableFromVisualIndex(this.row),f=this.hot.columnIndexMapper.getRenderableFromVisualIndex(this.col),c=this.hot.rowIndexMapper.getRenderableIndexesLength(),v=c-this.hot.view.wt.getSetting("fixedRowsBottom");(u<=0||u===v)&&(g+=1),f<=0&&(y+=1);var m=this.select.style;h&&h!==-1?m[h[0]]=h[1]:Ta(this.select);var b=Ea(this.TD,this.hot.rootWindow);parseInt(b.borderTopWidth,10)>0&&(d-=1),parseInt(b.borderLeftWidth,10)>0&&(p-=1),m.height="".concat(d,"px"),m.minWidth="".concat(p,"px"),m.top="".concat(g,"px"),m.left="".concat(y,"px"),m.margin="0px",Ie(this.select,rS)}}},{key:"onBeforeKeyDown",value:function(){var i=this.select.selectedIndex-1,o=this.select.selectedIndex+1;switch(event.keyCode){case De.ARROW_UP:i>=0&&(this.select[i].selected=!0),rr(event),event.preventDefault();break;case De.ARROW_DOWN:o<=this.select.length-1&&(this.select[o].selected=!0),rr(event),event.preventDefault();break}}}],[{key:"EDITOR_TYPE",get:function(){return yde}}]),e}(au);function vde(){hn(au),hn(K_),hn(_M),hn(RM),hn(J_),hn(U_),hn(xM),hn(MM),hn(mde),hn(Na)}var gde="html";function nS(t,r,e,n,i,o,a){Ff.apply(this,[t,r,e,n,i,o,a]),Ao(r,o==null?"":o,!1)}nS.RENDERER_TYPE=gde;var bde="autocomplete";function gu(t,r,e,n,i,o,a){var s=t.rootDocument,l=a.allowHtml?nS:Fo,p=s.createElement("DIV");if(p.className="htAutocompleteArrow",p.appendChild(s.createTextNode(String.fromCharCode(9660))),l.apply(this,[t,r,e,n,i,o,a]),r.firstChild||r.appendChild(s.createTextNode(String.fromCharCode(160))),r.insertBefore(p,r.firstChild),Ie(r,"htAutocomplete"),!t.acArrowListener){var d=new Wt(t);t.acArrowListener=function(g){lt(g.target,"htAutocompleteArrow")&&t.view.wt.getSetting("onCellDblClick",null,new ke(e,n),r)},d.addEventListener(t.rootElement,"mousedown",t.acArrowListener),t.addHookOnce("afterDestroy",function(){d.destroy()})}}gu.RENDERER_TYPE=bde;var IM=new WeakMap,DM=new WeakMap,wde="htBadValue",bu="data-row",wu="data-col",NM="checkbox";Ze.getSingleton().add("modifyAutoColumnSizeSeed",function(t,r,e){var n=r.label,i=r.type,o=r.row,a=r.column,s=r.prop;if(i===NM){if(n){var l=n.value,p=n.property,d=e;if(l)d=typeof l=="function"?l(o,a,s,e):l;else if(p){var g=this.getDataAtRowProp(o,p);d=g!==null?g:e}t=d}return t}});function iS(t,r,e,n,i,o,a){var s=t.rootDocument;Ff.apply(this,[t,r,e,n,i,o,a]),_de(t);var l=Sde(s),p=a.label,d=!1;if(typeof a.checkedTemplate=="undefined"&&(a.checkedTemplate=!0),typeof a.uncheckedTemplate=="undefined"&&(a.uncheckedTemplate=!1),kn(r),o===a.checkedTemplate||lr(o).toLocaleLowerCase(a.locale)===lr(a.checkedTemplate).toLocaleLowerCase(a.locale)?l.checked=!0:o===a.uncheckedTemplate||lr(o).toLocaleLowerCase(a.locale)===lr(a.uncheckedTemplate).toLocaleLowerCase(a.locale)?l.checked=!1:Or(o)?Ie(l,"noValue"):(l.style.display="none",Ie(l,wde),d=!0),l.setAttribute(bu,e),l.setAttribute(wu,n),!d&&p){var g="";if(p.value)g=typeof p.value=="function"?p.value.call(this,e,n,i,o):p.value;else if(p.property){var y=t.getDataAtRowProp(e,p.property);g=y!==null?y:""}var h=Cde(s,g,p.separated!==!0);p.position==="before"?p.separated?(r.appendChild(h),r.appendChild(l)):(h.appendChild(l),l=h):(!p.position||p.position==="after")&&(p.separated?(r.appendChild(l),r.appendChild(h)):(h.insertBefore(l,h.firstChild),l=h))}(!p||p&&!p.separated)&&r.appendChild(l),d&&r.appendChild(s.createTextNode("#bad-value#")),IM.has(t)||(IM.set(t,!0),t.addHook("beforeKeyDown",u));function u(v){var m="SPACE|ENTER",b="DELETE|BACKSPACE",w=hf(No,v.keyCode);!t.getSettings().enterBeginsEditing&&w("ENTER")||(w("".concat(m,"|").concat(b))&&!Fn(v)&&c(function(){rr(v),v.preventDefault()}),w(m)&&f(),w(b)&&f(!0))}function f(){var v=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,m=t.getSelectedRange();if(!!m)for(var b=0;b<m.length;b++){for(var w=m[b].getTopLeftCorner(),_=w.row,C=w.col,R=m[b].getBottomRightCorner(),I=R.row,P=R.col,N=[],A=_;A<=I;A+=1)for(var $=C;$<=P;$+=1){var T=t.getCellMeta(A,$);if(T.type!=="checkbox")return;if(T.readOnly!==!0){typeof T.checkedTemplate=="undefined"&&(T.checkedTemplate=!0),typeof T.uncheckedTemplate=="undefined"&&(T.uncheckedTemplate=!1);var M=t.getDataAtCell(A,$);v===!1?[T.checkedTemplate,T.checkedTemplate.toString()].includes(M)?N.push([A,$,T.uncheckedTemplate]):[T.uncheckedTemplate,T.uncheckedTemplate.toString(),null,void 0].includes(M)&&N.push([A,$,T.checkedTemplate]):N.push([A,$,T.uncheckedTemplate])}}N.length>0&&t.setDataAtCell(N)}}function c(v){var m=t.getSelectedRange();if(!!m)for(var b=0;b<m.length;b++)for(var w=m[b].getTopLeftCorner(),_=m[b].getBottomRightCorner(),C=w.row;C<=_.row;C++)for(var R=w.col;R<=_.col;R++){var I=t.getCellMeta(C,R);if(I.type!=="checkbox")return;var P=t.getCell(C,R);if(P==null)v(C,R,I);else{var N=P.querySelectorAll("input[type=checkbox]");N.length>0&&!I.readOnly&&v(N)}}}}iS.RENDERER_TYPE=NM;function _de(t){var r=DM.get(t);if(!r){var e=t.rootElement;r=new Wt(t),r.addEventListener(e,"click",function(n){return Ode(n,t)}),r.addEventListener(e,"mouseup",function(n){return kde(n,t)}),r.addEventListener(e,"change",function(n){return Rde(n,t)}),DM.set(t,r)}return r}function Sde(t){var r=t.createElement("input");return r.className="htCheckboxRendererInput",r.type="checkbox",r.setAttribute("autocomplete","off"),r.setAttribute("tabindex","-1"),r.cloneNode(!1)}function Cde(t,r,e){var n=t.createElement("label");return n.className="htCheckboxRendererLabel ".concat(e?"fullWidth":""),n.appendChild(t.createTextNode(r)),n.cloneNode(!0)}function kde(t,r){var e=t.target;!oS(e)||!e.hasAttribute(bu)||!e.hasAttribute(wu)||setTimeout(r.listen,10)}function Ode(t,r){var e=t.target;if(!!oS(e)&&!(!e.hasAttribute(bu)||!e.hasAttribute(wu))){var n=parseInt(e.getAttribute(bu),10),i=parseInt(e.getAttribute(wu),10),o=r.getCellMeta(n,i);o.readOnly&&t.preventDefault()}}function Rde(t,r){var e=t.target;if(!!oS(e)&&!(!e.hasAttribute(bu)||!e.hasAttribute(wu))){var n=parseInt(e.getAttribute(bu),10),i=parseInt(e.getAttribute(wu),10),o=r.getCellMeta(n,i);if(!o.readOnly){var a=null;t.target.checked?a=o.uncheckedTemplate===void 0?!0:o.checkedTemplate:a=o.uncheckedTemplate===void 0?!1:o.uncheckedTemplate,r.setDataAtCell(n,i,a)}}}function oS(t){return t.tagName==="INPUT"&&t.getAttribute("type")==="checkbox"}var $M={exports:{}};(function(t,r){(function(e){t.exports=e()})(function(){return function e(n,i,o){function a(p,d){if(!i[p]){if(!n[p]){var g=typeof fo=="function"&&fo;if(!d&&g)return g(p,!0);if(s)return s(p,!0);var y=new Error("Cannot find module '"+p+"'");throw y.code="MODULE_NOT_FOUND",y}var h=i[p]={exports:{}};n[p][0].call(h.exports,function(u){return a(n[p][1][u]||u)},h,h.exports,e,n,i,o)}return i[p].exports}for(var s=typeof fo=="function"&&fo,l=0;l<o.length;l++)a(o[l]);return a}({1:[function(e,n,i){(function(o){var a,s=/^-?(?:\d+(?:\.\d*)?|\.\d+)(?:e[+-]?\d+)?$/i,l=Math.ceil,p=Math.floor,d="[BigNumber Error] ",g=d+"Number primitive has more than 15 significant digits: ",y=1e14,h=14,u=9007199254740991,f=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8,1e9,1e10,1e11,1e12,1e13],c=1e7,v=1e9;function m(P){var N=0|P;return 0<P||P===N?N:N-1}function b(P){for(var N,A,$=1,T=P.length,M=P[0]+"";$<T;){for(N=P[$++]+"",A=h-N.length;A--;N="0"+N);M+=N}for(T=M.length;M.charCodeAt(--T)===48;);return M.slice(0,T+1||1)}function w(P,N){var A,$,T=P.c,M=N.c,S=P.s,E=N.s,k=P.e,O=N.e;if(!S||!E)return null;if(A=T&&!T[0],$=M&&!M[0],A||$)return A?$?0:-E:S;if(S!=E)return S;if(A=S<0,$=k==O,!T||!M)return $?0:!T^A?1:-1;if(!$)return O<k^A?1:-1;for(E=(k=T.length)<(O=M.length)?k:O,S=0;S<E;S++)if(T[S]!=M[S])return T[S]>M[S]^A?1:-1;return k==O?0:O<k^A?1:-1}function _(P,N,A,$){if(P<N||A<P||P!==(P<0?l(P):p(P)))throw Error(d+($||"Argument")+(typeof P=="number"?P<N||A<P?" out of range: ":" not an integer: ":" not a primitive number: ")+String(P))}function C(P){var N=P.c.length-1;return m(P.e/h)==N&&P.c[N]%2!=0}function R(P,N){return(1<P.length?P.charAt(0)+"."+P.slice(1):P)+(N<0?"e":"e+")+N}function I(P,N,A){var $,T;if(N<0){for(T=A+".";++N;T+=A);P=T+P}else if(++N>($=P.length)){for(T=A,N-=$;--N;T+=A);P+=T}else N<$&&(P=P.slice(0,N)+"."+P.slice(N));return P}(a=function P(N){var A,$,T,M,S,E,k,O,x,j,H=ee.prototype={constructor:ee,toString:null,valueOf:null},F=new ee(1),V=20,W=4,U=-7,Y=21,K=-1e7,D=1e7,L=!1,B=1,z=0,q={prefix:"",groupSize:3,secondaryGroupSize:0,groupSeparator:",",decimalSeparator:".",fractionGroupSize:0,fractionGroupSeparator:"\xA0",suffix:""},X="0123456789abcdefghijklmnopqrstuvwxyz";function ee(J,te){var ie,fe,se,oe,G,Z,Q,re,ne=this;if(!(ne instanceof ee))return new ee(J,te);if(te==null){if(J instanceof ee)return ne.s=J.s,ne.e=J.e,void(ne.c=(J=J.c)?J.slice():J);if((Z=typeof J=="number")&&0*J==0){if(ne.s=1/J<0?(J=-J,-1):1,J===~~J){for(oe=0,G=J;10<=G;G/=10,oe++);return ne.e=oe,void(ne.c=[J])}re=String(J)}else{if(re=String(J),!s.test(re))return T(ne,re,Z);ne.s=re.charCodeAt(0)==45?(re=re.slice(1),-1):1}-1<(oe=re.indexOf("."))&&(re=re.replace(".","")),0<(G=re.search(/e/i))?(oe<0&&(oe=G),oe+=+re.slice(G+1),re=re.substring(0,G)):oe<0&&(oe=re.length)}else{if(_(te,2,X.length,"Base"),re=String(J),te==10)return we(ne=new ee(J instanceof ee?J:re),V+ne.e+1,W);if(Z=typeof J=="number"){if(0*J!=0)return T(ne,re,Z,te);if(ne.s=1/J<0?(re=re.slice(1),-1):1,ee.DEBUG&&15<re.replace(/^0\.0*|\./,"").length)throw Error(g+J);Z=!1}else ne.s=re.charCodeAt(0)===45?(re=re.slice(1),-1):1;for(ie=X.slice(0,te),oe=G=0,Q=re.length;G<Q;G++)if(ie.indexOf(fe=re.charAt(G))<0){if(fe=="."){if(oe<G){oe=Q;continue}}else if(!se&&(re==re.toUpperCase()&&(re=re.toLowerCase())||re==re.toLowerCase()&&(re=re.toUpperCase()))){se=!0,G=-1,oe=0;continue}return T(ne,String(J),Z,te)}-1<(oe=(re=$(re,te,10,ne.s)).indexOf("."))?re=re.replace(".",""):oe=re.length}for(G=0;re.charCodeAt(G)===48;G++);for(Q=re.length;re.charCodeAt(--Q)===48;);if(re=re.slice(G,++Q)){if(Q-=G,Z&&ee.DEBUG&&15<Q&&(u<J||J!==p(J)))throw Error(g+ne.s*J);if(D<(oe=oe-G-1))ne.c=ne.e=null;else if(oe<K)ne.c=[ne.e=0];else{if(ne.e=oe,ne.c=[],G=(oe+1)%h,oe<0&&(G+=h),G<Q){for(G&&ne.c.push(+re.slice(0,G)),Q-=h;G<Q;)ne.c.push(+re.slice(G,G+=h));re=re.slice(G),G=h-re.length}else G-=Q;for(;G--;re+="0");ne.c.push(+re)}}else ne.c=[ne.e=0]}function ye(J,te,ie,fe){var se,oe,G,Z,Q;if(ie==null?ie=W:_(ie,0,8),!J.c)return J.toString();if(se=J.c[0],G=J.e,te==null)Q=b(J.c),Q=fe==1||fe==2&&(G<=U||Y<=G)?R(Q,G):I(Q,G,"0");else if(oe=(J=we(new ee(J),te,ie)).e,Z=(Q=b(J.c)).length,fe==1||fe==2&&(te<=oe||oe<=U)){for(;Z<te;Q+="0",Z++);Q=R(Q,oe)}else if(te-=G,Q=I(Q,oe,"0"),Z<oe+1){if(0<--te)for(Q+=".";te--;Q+="0");}else if(0<(te+=oe-Z))for(oe+1==Z&&(Q+=".");te--;Q+="0");return J.s<0&&se?"-"+Q:Q}function de(J,te){for(var ie,fe=1,se=new ee(J[0]);fe<J.length;fe++){if(!(ie=new ee(J[fe])).s){se=ie;break}te.call(se,ie)&&(se=ie)}return se}function ge(J,te,ie){for(var fe=1,se=te.length;!te[--se];te.pop());for(se=te[0];10<=se;se/=10,fe++);return(ie=fe+ie*h-1)>D?J.c=J.e=null:J.c=ie<K?[J.e=0]:(J.e=ie,te),J}function we(J,te,ie,fe){var se,oe,G,Z,Q,re,ne,ue=J.c,le=f;if(ue){e:{for(se=1,Z=ue[0];10<=Z;Z/=10,se++);if((oe=te-se)<0)oe+=h,G=te,ne=(Q=ue[re=0])/le[se-G-1]%10|0;else if((re=l((oe+1)/h))>=ue.length){if(!fe)break e;for(;ue.length<=re;ue.push(0));Q=ne=0,G=(oe%=h)-h+(se=1)}else{for(Q=Z=ue[re],se=1;10<=Z;Z/=10,se++);ne=(G=(oe%=h)-h+se)<0?0:Q/le[se-G-1]%10|0}if(fe=fe||te<0||ue[re+1]!=null||(G<0?Q:Q%le[se-G-1]),fe=ie<4?(ne||fe)&&(ie==0||ie==(J.s<0?3:2)):5<ne||ne==5&&(ie==4||fe||ie==6&&(0<oe?0<G?Q/le[se-G]:0:ue[re-1])%10&1||ie==(J.s<0?8:7)),te<1||!ue[0])return ue.length=0,fe?(te-=J.e+1,ue[0]=le[(h-te%h)%h],J.e=-te||0):ue[0]=J.e=0,J;if(oe==0?(ue.length=re,Z=1,re--):(ue.length=re+1,Z=le[h-oe],ue[re]=0<G?p(Q/le[se-G]%le[G])*Z:0),fe)for(;;){if(re==0){for(oe=1,G=ue[0];10<=G;G/=10,oe++);for(G=ue[0]+=Z,Z=1;10<=G;G/=10,Z++);oe!=Z&&(J.e++,ue[0]==y&&(ue[0]=1));break}if(ue[re]+=Z,ue[re]!=y)break;ue[re--]=0,Z=1}for(oe=ue.length;ue[--oe]===0;ue.pop());}J.e>D?J.c=J.e=null:J.e<K&&(J.c=[J.e=0])}return J}function be(J){var te,ie=J.e;return ie===null?J.toString():(te=b(J.c),te=ie<=U||Y<=ie?R(te,ie):I(te,ie,"0"),J.s<0?"-"+te:te)}return ee.clone=P,ee.ROUND_UP=0,ee.ROUND_DOWN=1,ee.ROUND_CEIL=2,ee.ROUND_FLOOR=3,ee.ROUND_HALF_UP=4,ee.ROUND_HALF_DOWN=5,ee.ROUND_HALF_EVEN=6,ee.ROUND_HALF_CEIL=7,ee.ROUND_HALF_FLOOR=8,ee.EUCLID=9,ee.config=ee.set=function(J){var te,ie;if(J!=null){if(typeof J!="object")throw Error(d+"Object expected: "+J);if(J.hasOwnProperty(te="DECIMAL_PLACES")&&(_(ie=J[te],0,v,te),V=ie),J.hasOwnProperty(te="ROUNDING_MODE")&&(_(ie=J[te],0,8,te),W=ie),J.hasOwnProperty(te="EXPONENTIAL_AT")&&((ie=J[te])&&ie.pop?(_(ie[0],-v,0,te),_(ie[1],0,v,te),U=ie[0],Y=ie[1]):(_(ie,-v,v,te),U=-(Y=ie<0?-ie:ie))),J.hasOwnProperty(te="RANGE"))if((ie=J[te])&&ie.pop)_(ie[0],-v,-1,te),_(ie[1],1,v,te),K=ie[0],D=ie[1];else{if(_(ie,-v,v,te),!ie)throw Error(d+te+" cannot be zero: "+ie);K=-(D=ie<0?-ie:ie)}if(J.hasOwnProperty(te="CRYPTO")){if((ie=J[te])!==!!ie)throw Error(d+te+" not true or false: "+ie);if(ie){if(typeof crypto=="undefined"||!crypto||!crypto.getRandomValues&&!crypto.randomBytes)throw L=!ie,Error(d+"crypto unavailable");L=ie}else L=ie}if(J.hasOwnProperty(te="MODULO_MODE")&&(_(ie=J[te],0,9,te),B=ie),J.hasOwnProperty(te="POW_PRECISION")&&(_(ie=J[te],0,v,te),z=ie),J.hasOwnProperty(te="FORMAT")){if(typeof(ie=J[te])!="object")throw Error(d+te+" not an object: "+ie);q=ie}if(J.hasOwnProperty(te="ALPHABET")){if(typeof(ie=J[te])!="string"||/^.$|[+-.\s]|(.).*\1/.test(ie))throw Error(d+te+" invalid: "+ie);X=ie}}return{DECIMAL_PLACES:V,ROUNDING_MODE:W,EXPONENTIAL_AT:[U,Y],RANGE:[K,D],CRYPTO:L,MODULO_MODE:B,POW_PRECISION:z,FORMAT:q,ALPHABET:X}},ee.isBigNumber=function(J){return J instanceof ee||J&&J._isBigNumber===!0||!1},ee.maximum=ee.max=function(){return de(arguments,H.lt)},ee.minimum=ee.min=function(){return de(arguments,H.gt)},ee.random=(M=9007199254740992,S=Math.random()*M&2097151?function(){return p(Math.random()*M)}:function(){return 8388608*(1073741824*Math.random()|0)+(8388608*Math.random()|0)},function(J){var te,ie,fe,se,oe,G=0,Z=[],Q=new ee(F);if(J==null?J=V:_(J,0,v),se=l(J/h),L)if(crypto.getRandomValues){for(te=crypto.getRandomValues(new Uint32Array(se*=2));G<se;)9e15<=(oe=131072*te[G]+(te[G+1]>>>11))?(ie=crypto.getRandomValues(new Uint32Array(2)),te[G]=ie[0],te[G+1]=ie[1]):(Z.push(oe%1e14),G+=2);G=se/2}else{if(!crypto.randomBytes)throw L=!1,Error(d+"crypto unavailable");for(te=crypto.randomBytes(se*=7);G<se;)9e15<=(oe=281474976710656*(31&te[G])+1099511627776*te[G+1]+4294967296*te[G+2]+16777216*te[G+3]+(te[G+4]<<16)+(te[G+5]<<8)+te[G+6])?crypto.randomBytes(7).copy(te,G):(Z.push(oe%1e14),G+=7);G=se/7}if(!L)for(;G<se;)(oe=S())<9e15&&(Z[G++]=oe%1e14);for(se=Z[--G],J%=h,se&&J&&(oe=f[h-J],Z[G]=p(se/oe)*oe);Z[G]===0;Z.pop(),G--);if(G<0)Z=[fe=0];else{for(fe=-1;Z[0]===0;Z.splice(0,1),fe-=h);for(G=1,oe=Z[0];10<=oe;oe/=10,G++);G<h&&(fe-=h-G)}return Q.e=fe,Q.c=Z,Q}),ee.sum=function(){for(var J=1,te=arguments,ie=new ee(te[0]);J<te.length;)ie=ie.plus(te[J++]);return ie},$=function(){var J="0123456789";function te(ie,fe,se,oe){for(var G,Z,Q=[0],re=0,ne=ie.length;re<ne;){for(Z=Q.length;Z--;Q[Z]*=fe);for(Q[0]+=oe.indexOf(ie.charAt(re++)),G=0;G<Q.length;G++)Q[G]>se-1&&(Q[G+1]==null&&(Q[G+1]=0),Q[G+1]+=Q[G]/se|0,Q[G]%=se)}return Q.reverse()}return function(ie,fe,se,oe,G){var Z,Q,re,ne,ue,le,ve,Se,Oe=ie.indexOf("."),xe=V,Ce=W;for(0<=Oe&&(ne=z,z=0,ie=ie.replace(".",""),le=(Se=new ee(fe)).pow(ie.length-Oe),z=ne,Se.c=te(I(b(le.c),le.e,"0"),10,se,J),Se.e=Se.c.length),re=ne=(ve=te(ie,fe,se,G?(Z=X,J):(Z=J,X))).length;ve[--ne]==0;ve.pop());if(!ve[0])return Z.charAt(0);if(Oe<0?--re:(le.c=ve,le.e=re,le.s=oe,ve=(le=A(le,Se,xe,Ce,se)).c,ue=le.r,re=le.e),Oe=ve[Q=re+xe+1],ne=se/2,ue=ue||Q<0||ve[Q+1]!=null,ue=Ce<4?(Oe!=null||ue)&&(Ce==0||Ce==(le.s<0?3:2)):ne<Oe||Oe==ne&&(Ce==4||ue||Ce==6&&1&ve[Q-1]||Ce==(le.s<0?8:7)),Q<1||!ve[0])ie=ue?I(Z.charAt(1),-xe,Z.charAt(0)):Z.charAt(0);else{if(ve.length=Q,ue)for(--se;++ve[--Q]>se;)ve[Q]=0,Q||(++re,ve=[1].concat(ve));for(ne=ve.length;!ve[--ne];);for(Oe=0,ie="";Oe<=ne;ie+=Z.charAt(ve[Oe++]));ie=I(ie,re,Z.charAt(0))}return ie}}(),A=function(){function J(fe,se,oe){var G,Z,Q,re,ne=0,ue=fe.length,le=se%c,ve=se/c|0;for(fe=fe.slice();ue--;)ne=((Z=le*(Q=fe[ue]%c)+(G=ve*Q+(re=fe[ue]/c|0)*le)%c*c+ne)/oe|0)+(G/c|0)+ve*re,fe[ue]=Z%oe;return ne&&(fe=[ne].concat(fe)),fe}function te(fe,se,oe,G){var Z,Q;if(oe!=G)Q=G<oe?1:-1;else for(Z=Q=0;Z<oe;Z++)if(fe[Z]!=se[Z]){Q=fe[Z]>se[Z]?1:-1;break}return Q}function ie(fe,se,oe,G){for(var Z=0;oe--;)fe[oe]-=Z,Z=fe[oe]<se[oe]?1:0,fe[oe]=Z*G+fe[oe]-se[oe];for(;!fe[0]&&1<fe.length;fe.splice(0,1));}return function(fe,se,oe,G,Z){var Q,re,ne,ue,le,ve,Se,Oe,xe,Ce,Le,Ve,Je,ft,Ct,Ye,et,Te=fe.s==se.s?1:-1,We=fe.c,rt=se.c;if(!(We&&We[0]&&rt&&rt[0]))return new ee(fe.s&&se.s&&(We?!rt||We[0]!=rt[0]:rt)?We&&We[0]==0||!rt?0*Te:Te/0:NaN);for(xe=(Oe=new ee(Te)).c=[],Te=oe+(re=fe.e-se.e)+1,Z||(Z=y,re=m(fe.e/h)-m(se.e/h),Te=Te/h|0),ne=0;rt[ne]==(We[ne]||0);ne++);if(rt[ne]>(We[ne]||0)&&re--,Te<0)xe.push(1),ue=!0;else{for(ft=We.length,Ye=rt.length,Te+=2,1<(le=p(Z/(rt[ne=0]+1)))&&(rt=J(rt,le,Z),We=J(We,le,Z),Ye=rt.length,ft=We.length),Je=Ye,Le=(Ce=We.slice(0,Ye)).length;Le<Ye;Ce[Le++]=0);et=rt.slice(),et=[0].concat(et),Ct=rt[0],rt[1]>=Z/2&&Ct++;do{if(le=0,(Q=te(rt,Ce,Ye,Le))<0){if(Ve=Ce[0],Ye!=Le&&(Ve=Ve*Z+(Ce[1]||0)),1<(le=p(Ve/Ct)))for(Z<=le&&(le=Z-1),Se=(ve=J(rt,le,Z)).length,Le=Ce.length;te(ve,Ce,Se,Le)==1;)le--,ie(ve,Ye<Se?et:rt,Se,Z),Se=ve.length,Q=1;else le==0&&(Q=le=1),Se=(ve=rt.slice()).length;if(Se<Le&&(ve=[0].concat(ve)),ie(Ce,ve,Le,Z),Le=Ce.length,Q==-1)for(;te(rt,Ce,Ye,Le)<1;)le++,ie(Ce,Ye<Le?et:rt,Le,Z),Le=Ce.length}else Q===0&&(le++,Ce=[0]);xe[ne++]=le,Ce[0]?Ce[Le++]=We[Je]||0:(Ce=[We[Je]],Le=1)}while((Je++<ft||Ce[0]!=null)&&Te--);ue=Ce[0]!=null,xe[0]||xe.splice(0,1)}if(Z==y){for(ne=1,Te=xe[0];10<=Te;Te/=10,ne++);we(Oe,oe+(Oe.e=ne+re*h-1)+1,G,ue)}else Oe.e=re,Oe.r=+ue;return Oe}}(),E=/^(-?)0([xbo])(?=\w[\w.]*$)/i,k=/^([^.]+)\.$/,O=/^\.([^.]+)$/,x=/^-?(Infinity|NaN)$/,j=/^\s*\+(?=[\w.])|^\s+|\s+$/g,T=function(J,te,ie,fe){var se,oe=ie?te:te.replace(j,"");if(x.test(oe))J.s=isNaN(oe)?null:oe<0?-1:1,J.c=J.e=null;else{if(!ie&&(oe=oe.replace(E,function(G,Z,Q){return se=(Q=Q.toLowerCase())=="x"?16:Q=="b"?2:8,fe&&fe!=se?G:Z}),fe&&(se=fe,oe=oe.replace(k,"$1").replace(O,"0.$1")),te!=oe))return new ee(oe,se);if(ee.DEBUG)throw Error(d+"Not a"+(fe?" base "+fe:"")+" number: "+te);J.c=J.e=J.s=null}},H.absoluteValue=H.abs=function(){var J=new ee(this);return J.s<0&&(J.s=1),J},H.comparedTo=function(J,te){return w(this,new ee(J,te))},H.decimalPlaces=H.dp=function(J,te){var ie,fe,se;if(J!=null)return _(J,0,v),te==null?te=W:_(te,0,8),we(new ee(this),J+this.e+1,te);if(!(ie=this.c))return null;if(fe=((se=ie.length-1)-m(this.e/h))*h,se=ie[se])for(;se%10==0;se/=10,fe--);return fe<0&&(fe=0),fe},H.dividedBy=H.div=function(J,te){return A(this,new ee(J,te),V,W)},H.dividedToIntegerBy=H.idiv=function(J,te){return A(this,new ee(J,te),0,1)},H.exponentiatedBy=H.pow=function(J,te){var ie,fe,se,oe,G,Z,Q,re,ne=this;if((J=new ee(J)).c&&!J.isInteger())throw Error(d+"Exponent not an integer: "+be(J));if(te!=null&&(te=new ee(te)),G=14<J.e,!ne.c||!ne.c[0]||ne.c[0]==1&&!ne.e&&ne.c.length==1||!J.c||!J.c[0])return re=new ee(Math.pow(+be(ne),G?2-C(J):+be(J))),te?re.mod(te):re;if(Z=J.s<0,te){if(te.c?!te.c[0]:!te.s)return new ee(NaN);(fe=!Z&&ne.isInteger()&&te.isInteger())&&(ne=ne.mod(te))}else{if(9<J.e&&(0<ne.e||ne.e<-1||(ne.e==0?1<ne.c[0]||G&&24e7<=ne.c[1]:ne.c[0]<8e13||G&&ne.c[0]<=9999975e7)))return oe=ne.s<0&&C(J)?-0:0,-1<ne.e&&(oe=1/oe),new ee(Z?1/oe:oe);z&&(oe=l(z/h+2))}for(Q=G?(ie=new ee(.5),Z&&(J.s=1),C(J)):(se=Math.abs(+be(J)))%2,re=new ee(F);;){if(Q){if(!(re=re.times(ne)).c)break;oe?re.c.length>oe&&(re.c.length=oe):fe&&(re=re.mod(te))}if(se){if((se=p(se/2))===0)break;Q=se%2}else if(we(J=J.times(ie),J.e+1,1),14<J.e)Q=C(J);else{if((se=+be(J))==0)break;Q=se%2}ne=ne.times(ne),oe?ne.c&&ne.c.length>oe&&(ne.c.length=oe):fe&&(ne=ne.mod(te))}return fe?re:(Z&&(re=F.div(re)),te?re.mod(te):oe?we(re,z,W,void 0):re)},H.integerValue=function(J){var te=new ee(this);return J==null?J=W:_(J,0,8),we(te,te.e+1,J)},H.isEqualTo=H.eq=function(J,te){return w(this,new ee(J,te))===0},H.isFinite=function(){return!!this.c},H.isGreaterThan=H.gt=function(J,te){return 0<w(this,new ee(J,te))},H.isGreaterThanOrEqualTo=H.gte=function(J,te){return(te=w(this,new ee(J,te)))===1||te===0},H.isInteger=function(){return!!this.c&&m(this.e/h)>this.c.length-2},H.isLessThan=H.lt=function(J,te){return w(this,new ee(J,te))<0},H.isLessThanOrEqualTo=H.lte=function(J,te){return(te=w(this,new ee(J,te)))===-1||te===0},H.isNaN=function(){return!this.s},H.isNegative=function(){return this.s<0},H.isPositive=function(){return 0<this.s},H.isZero=function(){return!!this.c&&this.c[0]==0},H.minus=function(J,te){var ie,fe,se,oe,G=this,Z=G.s;if(te=(J=new ee(J,te)).s,!Z||!te)return new ee(NaN);if(Z!=te)return J.s=-te,G.plus(J);var Q=G.e/h,re=J.e/h,ne=G.c,ue=J.c;if(!Q||!re){if(!ne||!ue)return ne?(J.s=-te,J):new ee(ue?G:NaN);if(!ne[0]||!ue[0])return ue[0]?(J.s=-te,J):new ee(ne[0]?G:W==3?-0:0)}if(Q=m(Q),re=m(re),ne=ne.slice(),Z=Q-re){for((se=(oe=Z<0)?(Z=-Z,ne):(re=Q,ue)).reverse(),te=Z;te--;se.push(0));se.reverse()}else for(fe=(oe=(Z=ne.length)<(te=ue.length))?Z:te,Z=te=0;te<fe;te++)if(ne[te]!=ue[te]){oe=ne[te]<ue[te];break}if(oe&&(se=ne,ne=ue,ue=se,J.s=-J.s),0<(te=(fe=ue.length)-(ie=ne.length)))for(;te--;ne[ie++]=0);for(te=y-1;Z<fe;){if(ne[--fe]<ue[fe]){for(ie=fe;ie&&!ne[--ie];ne[ie]=te);--ne[ie],ne[fe]+=y}ne[fe]-=ue[fe]}for(;ne[0]==0;ne.splice(0,1),--re);return ne[0]?ge(J,ne,re):(J.s=W==3?-1:1,J.c=[J.e=0],J)},H.modulo=H.mod=function(J,te){var ie,fe,se=this;return J=new ee(J,te),!se.c||!J.s||J.c&&!J.c[0]?new ee(NaN):!J.c||se.c&&!se.c[0]?new ee(se):(B==9?(fe=J.s,J.s=1,ie=A(se,J,0,3),J.s=fe,ie.s*=fe):ie=A(se,J,0,B),(J=se.minus(ie.times(J))).c[0]||B!=1||(J.s=se.s),J)},H.multipliedBy=H.times=function(J,te){var ie,fe,se,oe,G,Z,Q,re,ne,ue,le,ve,Se,Oe,xe,Ce=this,Le=Ce.c,Ve=(J=new ee(J,te)).c;if(!(Le&&Ve&&Le[0]&&Ve[0]))return!Ce.s||!J.s||Le&&!Le[0]&&!Ve||Ve&&!Ve[0]&&!Le?J.c=J.e=J.s=null:(J.s*=Ce.s,Le&&Ve?(J.c=[0],J.e=0):J.c=J.e=null),J;for(fe=m(Ce.e/h)+m(J.e/h),J.s*=Ce.s,(Q=Le.length)<(ue=Ve.length)&&(Se=Le,Le=Ve,Ve=Se,se=Q,Q=ue,ue=se),se=Q+ue,Se=[];se--;Se.push(0));for(Oe=y,xe=c,se=ue;0<=--se;){for(ie=0,le=Ve[se]%xe,ve=Ve[se]/xe|0,oe=se+(G=Q);se<oe;)ie=((re=le*(re=Le[--G]%xe)+(Z=ve*re+(ne=Le[G]/xe|0)*le)%xe*xe+Se[oe]+ie)/Oe|0)+(Z/xe|0)+ve*ne,Se[oe--]=re%Oe;Se[oe]=ie}return ie?++fe:Se.splice(0,1),ge(J,Se,fe)},H.negated=function(){var J=new ee(this);return J.s=-J.s||null,J},H.plus=function(J,te){var ie,fe=this,se=fe.s;if(te=(J=new ee(J,te)).s,!se||!te)return new ee(NaN);if(se!=te)return J.s=-te,fe.minus(J);var oe=fe.e/h,G=J.e/h,Z=fe.c,Q=J.c;if(!oe||!G){if(!Z||!Q)return new ee(se/0);if(!Z[0]||!Q[0])return Q[0]?J:new ee(Z[0]?fe:0*se)}if(oe=m(oe),G=m(G),Z=Z.slice(),se=oe-G){for((ie=0<se?(G=oe,Q):(se=-se,Z)).reverse();se--;ie.push(0));ie.reverse()}for((se=Z.length)-(te=Q.length)<0&&(ie=Q,Q=Z,Z=ie,te=se),se=0;te;)se=(Z[--te]=Z[te]+Q[te]+se)/y|0,Z[te]=y===Z[te]?0:Z[te]%y;return se&&(Z=[se].concat(Z),++G),ge(J,Z,G)},H.precision=H.sd=function(J,te){var ie,fe,se;if(J!=null&&J!==!!J)return _(J,1,v),te==null?te=W:_(te,0,8),we(new ee(this),J,te);if(!(ie=this.c))return null;if(fe=(se=ie.length-1)*h+1,se=ie[se]){for(;se%10==0;se/=10,fe--);for(se=ie[0];10<=se;se/=10,fe++);}return J&&this.e+1>fe&&(fe=this.e+1),fe},H.shiftedBy=function(J){return _(J,-u,u),this.times("1e"+J)},H.squareRoot=H.sqrt=function(){var J,te,ie,fe,se,oe=this,G=oe.c,Z=oe.s,Q=oe.e,re=V+4,ne=new ee("0.5");if(Z!==1||!G||!G[0])return new ee(!Z||Z<0&&(!G||G[0])?NaN:G?oe:1/0);if((ie=(Z=Math.sqrt(+be(oe)))==0||Z==1/0?(((te=b(G)).length+Q)%2==0&&(te+="0"),Z=Math.sqrt(+te),Q=m((Q+1)/2)-(Q<0||Q%2),new ee(te=Z==1/0?"1e"+Q:(te=Z.toExponential()).slice(0,te.indexOf("e")+1)+Q)):new ee(Z+"")).c[0]){for((Z=(Q=ie.e)+re)<3&&(Z=0);;)if(se=ie,ie=ne.times(se.plus(A(oe,se,re,1))),b(se.c).slice(0,Z)===(te=b(ie.c)).slice(0,Z)){if(ie.e<Q&&--Z,(te=te.slice(Z-3,Z+1))!="9999"&&(fe||te!="4999")){+te&&(+te.slice(1)||te.charAt(0)!="5")||(we(ie,ie.e+V+2,1),J=!ie.times(ie).eq(oe));break}if(!fe&&(we(se,se.e+V+2,0),se.times(se).eq(oe))){ie=se;break}re+=4,Z+=4,fe=1}}return we(ie,ie.e+V+1,W,J)},H.toExponential=function(J,te){return J!=null&&(_(J,0,v),J++),ye(this,J,te,1)},H.toFixed=function(J,te){return J!=null&&(_(J,0,v),J=J+this.e+1),ye(this,J,te)},H.toFormat=function(J,te,ie){var fe;if(ie==null)J!=null&&te&&typeof te=="object"?(ie=te,te=null):J&&typeof J=="object"?(ie=J,J=te=null):ie=q;else if(typeof ie!="object")throw Error(d+"Argument not an object: "+ie);if(fe=this.toFixed(J,te),this.c){var se,oe=fe.split("."),G=+ie.groupSize,Z=+ie.secondaryGroupSize,Q=ie.groupSeparator||"",re=oe[0],ne=oe[1],ue=this.s<0,le=ue?re.slice(1):re,ve=le.length;if(Z&&(se=G,G=Z,ve-=Z=se),0<G&&0<ve){for(se=ve%G||G,re=le.substr(0,se);se<ve;se+=G)re+=Q+le.substr(se,G);0<Z&&(re+=Q+le.slice(se)),ue&&(re="-"+re)}fe=ne?re+(ie.decimalSeparator||"")+((Z=+ie.fractionGroupSize)?ne.replace(new RegExp("\\d{"+Z+"}\\B","g"),"$&"+(ie.fractionGroupSeparator||"")):ne):re}return(ie.prefix||"")+fe+(ie.suffix||"")},H.toFraction=function(J){var te,ie,fe,se,oe,G,Z,Q,re,ne,ue,le,ve=this,Se=ve.c;if(J!=null&&(!(Z=new ee(J)).isInteger()&&(Z.c||Z.s!==1)||Z.lt(F)))throw Error(d+"Argument "+(Z.isInteger()?"out of range: ":"not an integer: ")+be(Z));if(!Se)return new ee(ve);for(te=new ee(F),re=ie=new ee(F),fe=Q=new ee(F),le=b(Se),oe=te.e=le.length-ve.e-1,te.c[0]=f[(G=oe%h)<0?h+G:G],J=!J||0<Z.comparedTo(te)?0<oe?te:re:Z,G=D,D=1/0,Z=new ee(le),Q.c[0]=0;ne=A(Z,te,0,1),(se=ie.plus(ne.times(fe))).comparedTo(J)!=1;)ie=fe,fe=se,re=Q.plus(ne.times(se=re)),Q=se,te=Z.minus(ne.times(se=te)),Z=se;return se=A(J.minus(ie),fe,0,1),Q=Q.plus(se.times(re)),ie=ie.plus(se.times(fe)),Q.s=re.s=ve.s,ue=A(re,fe,oe*=2,W).minus(ve).abs().comparedTo(A(Q,ie,oe,W).minus(ve).abs())<1?[re,fe]:[Q,ie],D=G,ue},H.toNumber=function(){return+be(this)},H.toPrecision=function(J,te){return J!=null&&_(J,1,v),ye(this,J,te,2)},H.toString=function(J){var te,ie=this,fe=ie.s,se=ie.e;return se===null?fe?(te="Infinity",fe<0&&(te="-"+te)):te="NaN":(te=J==null?se<=U||Y<=se?R(b(ie.c),se):I(b(ie.c),se,"0"):J===10?I(b((ie=we(new ee(ie),V+se+1,W)).c),ie.e,"0"):(_(J,2,X.length,"Base"),$(I(b(ie.c),se,"0"),10,J,fe,!0)),fe<0&&ie.c[0]&&(te="-"+te)),te},H.valueOf=H.toJSON=function(){return be(this)},H._isBigNumber=!0,typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"&&(H[Symbol.toStringTag]="BigNumber",H[Symbol.for("nodejs.util.inspect.custom")]=H.valueOf),N!=null&&ee.set(N),ee}()).default=a.BigNumber=a,n!==void 0&&n.exports?n.exports=a:(o||(o=typeof self!="undefined"&&self?self:window),o.BigNumber=a)})(this)},{}],2:[function(e,n,i){n.exports={languageTag:"en-US",delimiters:{thousands:",",decimal:"."},abbreviations:{thousand:"k",million:"m",billion:"b",trillion:"t"},spaceSeparated:!1,ordinal:function(o){var a=o%10;return~~(o%100/10)==1?"th":a===1?"st":a===2?"nd":a===3?"rd":"th"},currency:{symbol:"$",position:"prefix",code:"USD"},currencyFormat:{thousandSeparated:!0,totalLength:4,spaceSeparated:!0},formats:{fourDigits:{totalLength:4,spaceSeparated:!0},fullWithTwoDecimals:{output:"currency",thousandSeparated:!0,mantissa:2},fullWithTwoDecimalsNoCurrency:{thousandSeparated:!0,mantissa:2},fullWithNoDecimals:{output:"currency",thousandSeparated:!0,mantissa:0}}}},{}],3:[function(e,n,i){function o(m,b){return function(w){if(Array.isArray(w))return w}(m)||function(w,_){var C=[],R=!0,I=!1,P=void 0;try{for(var N,A=w[Symbol.iterator]();!(R=(N=A.next()).done)&&(C.push(N.value),!_||C.length!==_);R=!0);}catch($){I=!0,P=$}finally{try{R||A.return==null||A.return()}finally{if(I)throw P}}return C}(m,b)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var a=e("./globalState"),s=e("./validating"),l=e("./parsing"),p=["B","KB","MB","GB","TB","PB","EB","ZB","YB"],d={general:{scale:1024,suffixes:p,marker:"bd"},binary:{scale:1024,suffixes:["B","KiB","MiB","GiB","TiB","PiB","EiB","ZiB","YiB"],marker:"b"},decimal:{scale:1e3,suffixes:p,marker:"d"}},g={totalLength:0,characteristic:0,forceAverage:!1,average:!1,mantissa:-1,optionalMantissa:!0,thousandSeparated:!1,spaceSeparated:!1,negative:"sign",forceSign:!1};function y(m){var b=1<arguments.length&&arguments[1]!==void 0?arguments[1]:{},w=2<arguments.length?arguments[2]:void 0;if(typeof b=="string"&&(b=l.parseFormat(b)),!s.validateFormat(b))return"ERROR: invalid format";var _=b.prefix||"",C=b.postfix||"",R=function(I,P,N){switch(P.output){case"currency":return P=v(P,a.currentCurrencyDefaultFormat()),function(X,ee,ye){var de=ye.currentCurrency(),ge=Object.assign({},g,ee),we=void 0,be="",J=!!ge.totalLength||!!ge.forceAverage||ge.average,te=ee.currencyPosition||de.position,ie=ee.currencySymbol||de.symbol;ge.spaceSeparated&&(be=" "),te==="infix"&&(we=be+ie+be);var fe=c({instance:X,providedFormat:ee,state:ye,decimalSeparator:we});return te==="prefix"&&(fe=X._value<0&&ge.negative==="sign"?"-".concat(be).concat(ie).concat(fe.slice(1)):ie+be+fe),te&&te!=="postfix"||(fe=fe+(be=J?"":be)+ie),fe}(I,P,a);case"percent":return P=v(P,a.currentPercentageDefaultFormat()),function(X,ee,ye,de){var ge=ee.prefixSymbol,we=c({instance:de(100*X._value),providedFormat:ee,state:ye}),be=Object.assign({},g,ee);return ge?"%".concat(be.spaceSeparated?" ":"").concat(we):"".concat(we).concat(be.spaceSeparated?" ":"","%")}(I,P,a,N);case"byte":return P=v(P,a.currentByteDefaultFormat()),F=I,W=a,U=N,Y=(V=P).base||"binary",K=d[Y],D=h(F._value,K.suffixes,K.scale),L=D.value,B=D.suffix,z=c({instance:U(L),providedFormat:V,state:W,defaults:W.currentByteDefaultFormat()}),q=W.currentAbbreviations(),"".concat(z).concat(q.spaced?" ":"").concat(B);case"time":return P=v(P,a.currentTimeDefaultFormat()),O=I,x=Math.floor(O._value/60/60),j=Math.floor((O._value-60*x*60)/60),H=Math.round(O._value-60*x*60-60*j),"".concat(x,":").concat(j<10?"0":"").concat(j,":").concat(H<10?"0":"").concat(H);case"ordinal":return P=v(P,a.currentOrdinalDefaultFormat()),A=I,$=P,M=(T=a).currentOrdinal(),S=Object.assign({},g,$),E=c({instance:A,providedFormat:$,state:T}),k=M(A._value),"".concat(E).concat(S.spaceSeparated?" ":"").concat(k);case"number":default:return c({instance:I,providedFormat:P,numbro:N})}var A,$,T,M,S,E,k,O,x,j,H,F,V,W,U,Y,K,D,L,B,z,q}(m,b,w);return R=(R=_+R)+C}function h(m,b,w){var _=b[0],C=Math.abs(m);if(w<=C){for(var R=1;R<b.length;++R){var I=Math.pow(w,R),P=Math.pow(w,R+1);if(I<=C&&C<P){_=b[R],m/=I;break}}_===b[0]&&(m/=Math.pow(w,b.length-1),_=b[b.length-1])}return{value:m,suffix:_}}function u(m){for(var b="",w=0;w<m;w++)b+="0";return b}function f(m,b){return m.toString().indexOf("e")!==-1?function(w,_){var C=w.toString(),R=o(C.split("e"),2),I=R[0],P=R[1],N=o(I.split("."),2),A=N[0],$=N[1],T=$===void 0?"":$;if(0<+P)C=A+T+u(P-T.length);else{var M=".";M=+A<0?"-0".concat(M):"0".concat(M);var S=(u(-P-1)+Math.abs(A)+T).substr(0,_);S.length<_&&(S+=u(_-S.length)),C=M+S}return 0<+P&&0<_&&(C+=".".concat(u(_))),C}(m,b):(Math.round(+"".concat(m,"e+").concat(b))/Math.pow(10,b)).toFixed(b)}function c(m){var b=m.instance,w=m.providedFormat,_=m.state,C=_===void 0?a:_,R=m.decimalSeparator,I=m.defaults,P=I===void 0?C.currentDefaults():I,N=b._value;if(N===0&&C.hasZeroFormat())return C.getZeroFormat();if(!isFinite(N))return N.toString();var A,$,T,M,S,E,k,O,x=Object.assign({},g,P,w),j=x.totalLength,H=j?0:x.characteristic,F=x.optionalCharacteristic,V=x.forceAverage,W=!!j||!!V||x.average,U=j?-1:W&&w.mantissa===void 0?0:x.mantissa,Y=!j&&(w.optionalMantissa===void 0?U===-1:x.optionalMantissa),K=x.trimMantissa,D=x.thousandSeparated,L=x.spaceSeparated,B=x.negative,z=x.forceSign,q=x.exponential,X="";if(W){var ee=function(J){var te=J.value,ie=J.forceAverage,fe=J.abbreviations,se=J.spaceSeparated,oe=se!==void 0&&se,G=J.totalLength,Z=G===void 0?0:G,Q="",re=Math.abs(te),ne=-1;if(re>=Math.pow(10,12)&&!ie||ie==="trillion"?(Q=fe.trillion,te/=Math.pow(10,12)):re<Math.pow(10,12)&&re>=Math.pow(10,9)&&!ie||ie==="billion"?(Q=fe.billion,te/=Math.pow(10,9)):re<Math.pow(10,9)&&re>=Math.pow(10,6)&&!ie||ie==="million"?(Q=fe.million,te/=Math.pow(10,6)):(re<Math.pow(10,6)&&re>=Math.pow(10,3)&&!ie||ie==="thousand")&&(Q=fe.thousand,te/=Math.pow(10,3)),Q&&(Q=(oe?" ":"")+Q),Z){var ue=te.toString().split(".")[0];ne=Math.max(Z-ue.length,0)}return{value:te,abbreviation:Q,mantissaPrecision:ne}}({value:N,forceAverage:V,abbreviations:C.currentAbbreviations(),spaceSeparated:L,totalLength:j});N=ee.value,X+=ee.abbreviation,j&&(U=ee.mantissaPrecision)}if(q){var ye=($=(A={value:N,characteristicPrecision:H}).value,T=A.characteristicPrecision,M=T===void 0?0:T,S=o($.toExponential().split("e"),2),E=S[0],k=S[1],O=+E,M&&1<M&&(O*=Math.pow(10,M-1),k=0<=(k=+k-(M-1))?"+".concat(k):k),{value:O,abbreviation:"e".concat(k)});N=ye.value,X=ye.abbreviation+X}var de,ge,we,be=function(J,te,ie,fe,se){if(fe===-1)return J;var oe=f(te,fe),G=o(oe.toString().split("."),2),Z=G[0],Q=G[1],re=Q===void 0?"":Q;if(re.match(/^0+$/)&&(ie||se))return Z;var ne=re.match(/0+$/);return se&&ne?"".concat(Z,".").concat(re.toString().slice(0,ne.index)):oe.toString()}(N.toString(),N,Y,U,K);return be=function(J,te,ie,fe,se){var oe=fe.currentDelimiters(),G=oe.thousands;se=se||oe.decimal;var Z=oe.thousandsSize||3,Q=J.toString(),re=Q.split(".")[0],ne=Q.split(".")[1];return ie&&(te<0&&(re=re.slice(1)),function(ue,le){for(var ve=[],Se=0,Oe=ue;0<Oe;Oe--)Se===le&&(ve.unshift(Oe),Se=0),Se++;return ve}(re.length,Z).forEach(function(ue,le){re=re.slice(0,ue+le)+G+re.slice(ue+le)}),te<0&&(re="-".concat(re))),Q=ne?re+se+ne:re}(be=function(J,te,ie,fe){var se=J,oe=o(se.toString().split("."),2),G=oe[0],Z=oe[1];if(G.match(/^-?0$/)&&ie)return Z?"".concat(G.replace("0",""),".").concat(Z):G.replace("0","");if(G.length<fe)for(var Q=fe-G.length,re=0;re<Q;re++)se="0".concat(se);return se.toString()}(be,0,F,H),N,D,C,R),(W||q)&&(be=be+X),(z||N<0)&&(de=be,we=B,be=(ge=N)===0?de:+de==0?de.replace("-",""):0<ge?"+".concat(de):we==="sign"?de:"(".concat(de.replace("-",""),")")),be}function v(m,b){if(!m)return b;var w=Object.keys(m);return w.length===1&&w[0]==="output"?b:m}n.exports=function(m){return{format:function(){for(var b=arguments.length,w=new Array(b),_=0;_<b;_++)w[_]=arguments[_];return y.apply(void 0,w.concat([m]))},getByteUnit:function(){for(var b=arguments.length,w=new Array(b),_=0;_<b;_++)w[_]=arguments[_];return function(C){var R=d.general;return h(C._value,R.suffixes,R.scale).suffix}.apply(void 0,w.concat([m]))},getBinaryByteUnit:function(){for(var b=arguments.length,w=new Array(b),_=0;_<b;_++)w[_]=arguments[_];return function(C){var R=d.binary;return h(C._value,R.suffixes,R.scale).suffix}.apply(void 0,w.concat([m]))},getDecimalByteUnit:function(){for(var b=arguments.length,w=new Array(b),_=0;_<b;_++)w[_]=arguments[_];return function(C){var R=d.decimal;return h(C._value,R.suffixes,R.scale).suffix}.apply(void 0,w.concat([m]))},formatOrDefault:v}}},{"./globalState":4,"./parsing":8,"./validating":10}],4:[function(e,n,i){var o=e("./en-US"),a=e("./validating"),s=e("./parsing"),l={},p=void 0,d={},g=null,y={};function h(f){p=f}function u(){return d[p]}l.languages=function(){return Object.assign({},d)},l.currentLanguage=function(){return p},l.currentCurrency=function(){return u().currency},l.currentAbbreviations=function(){return u().abbreviations},l.currentDelimiters=function(){return u().delimiters},l.currentOrdinal=function(){return u().ordinal},l.currentDefaults=function(){return Object.assign({},u().defaults,y)},l.currentOrdinalDefaultFormat=function(){return Object.assign({},l.currentDefaults(),u().ordinalFormat)},l.currentByteDefaultFormat=function(){return Object.assign({},l.currentDefaults(),u().byteFormat)},l.currentPercentageDefaultFormat=function(){return Object.assign({},l.currentDefaults(),u().percentageFormat)},l.currentCurrencyDefaultFormat=function(){return Object.assign({},l.currentDefaults(),u().currencyFormat)},l.currentTimeDefaultFormat=function(){return Object.assign({},l.currentDefaults(),u().timeFormat)},l.setDefaults=function(f){f=s.parseFormat(f),a.validateFormat(f)&&(y=f)},l.getZeroFormat=function(){return g},l.setZeroFormat=function(f){return g=typeof f=="string"?f:null},l.hasZeroFormat=function(){return g!==null},l.languageData=function(f){if(f){if(d[f])return d[f];throw new Error('Unknown tag "'.concat(f,'"'))}return u()},l.registerLanguage=function(f){var c=1<arguments.length&&arguments[1]!==void 0&&arguments[1];if(!a.validateLanguage(f))throw new Error("Invalid language data");d[f.languageTag]=f,c&&h(f.languageTag)},l.setLanguage=function(f){var c=1<arguments.length&&arguments[1]!==void 0?arguments[1]:o.languageTag;if(!d[f]){var v=f.split("-")[0],m=Object.keys(d).find(function(b){return b.split("-")[0]===v});return d[m]?void h(m):void h(c)}h(f)},l.registerLanguage(o),p=o.languageTag,n.exports=l},{"./en-US":2,"./parsing":8,"./validating":10}],5:[function(e,n,i){n.exports=function(o){return{loadLanguagesInNode:function(a){return s=o,void a.forEach(function(l){var p=void 0;try{p=e("../languages/".concat(l))}catch{console.error('Unable to load "'.concat(l,'". No matching language file found.'))}p&&s.registerLanguage(p)});var s}}}},{}],6:[function(e,n,i){var o=e("bignumber.js");function a(s,l,p){var d=new o(s._value),g=l;return p.isNumbro(l)&&(g=l._value),g=new o(g),s._value=d.minus(g).toNumber(),s}n.exports=function(s){return{add:function(l,p){return g=p,y=s,h=new o((d=l)._value),u=g,y.isNumbro(g)&&(u=g._value),u=new o(u),d._value=h.plus(u).toNumber(),d;var d,g,y,h,u},subtract:function(l,p){return a(l,p,s)},multiply:function(l,p){return g=p,y=s,h=new o((d=l)._value),u=g,y.isNumbro(g)&&(u=g._value),u=new o(u),d._value=h.times(u).toNumber(),d;var d,g,y,h,u},divide:function(l,p){return g=p,y=s,h=new o((d=l)._value),u=g,y.isNumbro(g)&&(u=g._value),u=new o(u),d._value=h.dividedBy(u).toNumber(),d;var d,g,y,h,u},set:function(l,p){return d=l,y=g=p,s.isNumbro(g)&&(y=g._value),d._value=y,d;var d,g,y},difference:function(l,p){return d=p,a(y=(g=s)(l._value),d,g),Math.abs(y._value);var d,g,y}}}},{"bignumber.js":1}],7:[function(e,n,i){function o(c,v){for(var m=0;m<v.length;m++){var b=v[m];b.enumerable=b.enumerable||!1,b.configurable=!0,"value"in b&&(b.writable=!0),Object.defineProperty(c,b.key,b)}}var a=e("./globalState"),s=e("./validating"),l=e("./loading")(f),p=e("./unformatting"),d=e("./formatting")(f),g=e("./manipulating")(f),y=e("./parsing"),h=function(){function c(b){(function(w,_){if(!(w instanceof _))throw new TypeError("Cannot call a class as a function")})(this,c),this._value=b}var v,m;return v=c,(m=[{key:"clone",value:function(){return f(this._value)}},{key:"format",value:function(){var b=0<arguments.length&&arguments[0]!==void 0?arguments[0]:{};return d.format(this,b)}},{key:"formatCurrency",value:function(b){return typeof b=="string"&&(b=y.parseFormat(b)),(b=d.formatOrDefault(b,a.currentCurrencyDefaultFormat())).output="currency",d.format(this,b)}},{key:"formatTime",value:function(){var b=0<arguments.length&&arguments[0]!==void 0?arguments[0]:{};return b.output="time",d.format(this,b)}},{key:"binaryByteUnits",value:function(){return d.getBinaryByteUnit(this)}},{key:"decimalByteUnits",value:function(){return d.getDecimalByteUnit(this)}},{key:"byteUnits",value:function(){return d.getByteUnit(this)}},{key:"difference",value:function(b){return g.difference(this,b)}},{key:"add",value:function(b){return g.add(this,b)}},{key:"subtract",value:function(b){return g.subtract(this,b)}},{key:"multiply",value:function(b){return g.multiply(this,b)}},{key:"divide",value:function(b){return g.divide(this,b)}},{key:"set",value:function(b){return g.set(this,u(b))}},{key:"value",value:function(){return this._value}},{key:"valueOf",value:function(){return this._value}}])&&o(v.prototype,m),c}();function u(c){var v=c;return f.isNumbro(c)?v=c._value:typeof c=="string"?v=f.unformat(c):isNaN(c)&&(v=NaN),v}function f(c){return new h(u(c))}f.version="2.1.2",f.isNumbro=function(c){return c instanceof h},f.language=a.currentLanguage,f.registerLanguage=a.registerLanguage,f.setLanguage=a.setLanguage,f.languages=a.languages,f.languageData=a.languageData,f.zeroFormat=a.setZeroFormat,f.defaultFormat=a.currentDefaults,f.setDefaults=a.setDefaults,f.defaultCurrencyFormat=a.currentCurrencyDefaultFormat,f.validate=s.validate,f.loadLanguagesInNode=l.loadLanguagesInNode,f.unformat=p.unformat,n.exports=f},{"./formatting":3,"./globalState":4,"./loading":5,"./manipulating":6,"./parsing":8,"./unformatting":9,"./validating":10}],8:[function(e,n,i){n.exports={parseFormat:function(o){var a,s,l,p,d,g,y,h,u,f,c,v,m,b,w,_,C,R,I,P,N=1<arguments.length&&arguments[1]!==void 0?arguments[1]:{};return typeof o!="string"?o:(s=N,o=(l=(a=o).match(/^{([^}]*)}/))?(s.prefix=l[1],a.slice(l[0].length)):a,d=N,function(A,$){if(A.indexOf("$")===-1){if(A.indexOf("%")===-1)return A.indexOf("bd")!==-1?($.output="byte",$.base="general"):A.indexOf("b")!==-1?($.output="byte",$.base="binary"):A.indexOf("d")!==-1?($.output="byte",$.base="decimal"):A.indexOf(":")===-1?A.indexOf("o")!==-1&&($.output="ordinal"):$.output="time";$.output="percent"}else $.output="currency"}(o=(g=(p=o).match(/{([^}]*)}$/))?(d.postfix=g[1],p.slice(0,-g[0].length)):p,N),y=N,(h=o.match(/[1-9]+[0-9]*/))&&(y.totalLength=+h[0]),u=N,(f=o.split(".")[0].match(/0+/))&&(u.characteristic=f[0].length),function(A,$){if(A.indexOf(".")!==-1){var T=A.split(".")[0];$.optionalCharacteristic=T.indexOf("0")===-1}}(o,N),c=N,o.indexOf("a")!==-1&&(c.average=!0),m=N,(v=o).indexOf("K")!==-1?m.forceAverage="thousand":v.indexOf("M")!==-1?m.forceAverage="million":v.indexOf("B")!==-1?m.forceAverage="billion":v.indexOf("T")!==-1&&(m.forceAverage="trillion"),function(A,$){var T=A.split(".")[1];if(T){var M=T.match(/0+/);M&&($.mantissa=M[0].length)}}(o,N),w=N,(b=o).match(/\[\.]/)?w.optionalMantissa=!0:b.match(/\./)&&(w.optionalMantissa=!1),_=N,o.indexOf(",")!==-1&&(_.thousandSeparated=!0),C=N,o.indexOf(" ")!==-1&&(C.spaceSeparated=!0),I=N,(R=o).match(/^\+?\([^)]*\)$/)&&(I.negative="parenthesis"),R.match(/^\+?-/)&&(I.negative="sign"),P=N,o.match(/^\+/)&&(P.forceSign=!0),N)}}},{}],9:[function(e,n,i){var o=[{key:"ZiB",factor:Math.pow(1024,7)},{key:"ZB",factor:Math.pow(1e3,7)},{key:"YiB",factor:Math.pow(1024,8)},{key:"YB",factor:Math.pow(1e3,8)},{key:"TiB",factor:Math.pow(1024,4)},{key:"TB",factor:Math.pow(1e3,4)},{key:"PiB",factor:Math.pow(1024,5)},{key:"PB",factor:Math.pow(1e3,5)},{key:"MiB",factor:Math.pow(1024,2)},{key:"MB",factor:Math.pow(1e3,2)},{key:"KiB",factor:Math.pow(1024,1)},{key:"KB",factor:Math.pow(1e3,1)},{key:"GiB",factor:Math.pow(1024,3)},{key:"GB",factor:Math.pow(1e3,3)},{key:"EiB",factor:Math.pow(1024,6)},{key:"EB",factor:Math.pow(1e3,6)},{key:"B",factor:1}];function a(l){return l.replace(/[-/\\^$*+?.()|[\]{}]/g,"\\$&")}function s(l,p){var d=2<arguments.length&&arguments[2]!==void 0?arguments[2]:"",g=3<arguments.length?arguments[3]:void 0,y=4<arguments.length?arguments[4]:void 0,h=5<arguments.length?arguments[5]:void 0,u=6<arguments.length?arguments[6]:void 0;if(l!=="")return l===y?0:function f(c,v){var m=2<arguments.length&&arguments[2]!==void 0?arguments[2]:"",b=3<arguments.length?arguments[3]:void 0,w=4<arguments.length?arguments[4]:void 0,_=5<arguments.length?arguments[5]:void 0,C=6<arguments.length?arguments[6]:void 0;if(!isNaN(+c))return+c;var R="",I=c.replace(/(^[^(]*)\((.*)\)([^)]*$)/,"$1$2$3");if(I!==c)return-1*f(I,v,m,b,w,_,C);for(var P=0;P<o.length;P++){var N=o[P];if((R=c.replace(N.key,""))!==c)return f(R,v,m,b,w,_,C)*N.factor}if((R=c.replace("%",""))!==c)return f(R,v,m,b,w,_,C)/100;var A=parseFloat(c);if(!isNaN(A)){var $=b(A);if($&&$!=="."&&(R=c.replace(new RegExp("".concat(a($),"$")),""))!==c)return f(R,v,m,b,w,_,C);var T={};Object.keys(_).forEach(function(j){T[_[j]]=j});for(var M=Object.keys(T).sort().reverse(),S=M.length,E=0;E<S;E++){var k=M[E],O=T[k];if((R=c.replace(k,""))!==c){var x=void 0;switch(O){case"thousand":x=Math.pow(10,3);break;case"million":x=Math.pow(10,6);break;case"billion":x=Math.pow(10,9);break;case"trillion":x=Math.pow(10,12)}return f(R,v,m,b,w,_,C)*x}}}}(function(f,c){var v=2<arguments.length&&arguments[2]!==void 0?arguments[2]:"",m=f.replace(v,"");return m=(m=m.replace(new RegExp("([0-9])".concat(a(c.thousands),"([0-9])"),"g"),"$1$2")).replace(c.decimal,".")}(l,p,d),p,d,g,y,h,u)}n.exports={unformat:function(l,p){var d,g,y,h=e("./globalState"),u=h.currentDelimiters(),f=h.currentCurrency().symbol,c=h.currentOrdinal(),v=h.getZeroFormat(),m=h.currentAbbreviations(),b=void 0;if(typeof l=="string")b=function(w,_){if(!w.indexOf(":")||_.thousands===":")return!1;var C=w.split(":");if(C.length!==3)return!1;var R=+C[0],I=+C[1],P=+C[2];return!isNaN(R)&&!isNaN(I)&&!isNaN(P)}(l,u)?(d=l.split(":"),g=+d[0],y=+d[1],+d[2]+60*y+3600*g):s(l,u,f,c,v,m,p);else{if(typeof l!="number")return;b=l}if(b!==void 0)return b}}},{"./globalState":4}],10:[function(e,n,i){function o(u){return function(f){if(Array.isArray(f)){for(var c=0,v=new Array(f.length);c<f.length;c++)v[c]=f[c];return v}}(u)||function(f){if(Symbol.iterator in Object(f)||Object.prototype.toString.call(f)==="[object Arguments]")return Array.from(f)}(u)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function a(u){return(a=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(f){return typeof f}:function(f){return f&&typeof Symbol=="function"&&f.constructor===Symbol&&f!==Symbol.prototype?"symbol":typeof f})(u)}var s=e("./unformatting"),l=/^[a-z]{2,3}(-[a-zA-Z]{4})?(-([A-Z]{2}|[0-9]{3}))?$/,p={output:{type:"string",validValues:["currency","percent","byte","time","ordinal","number"]},base:{type:"string",validValues:["decimal","binary","general"],restriction:function(u,f){return f.output==="byte"},message:"`base` must be provided only when the output is `byte`",mandatory:function(u){return u.output==="byte"}},characteristic:{type:"number",restriction:function(u){return 0<=u},message:"value must be positive"},prefix:"string",postfix:"string",forceAverage:{type:"string",validValues:["trillion","billion","million","thousand"]},average:"boolean",currencyPosition:{type:"string",validValues:["prefix","infix","postfix"]},currencySymbol:"string",totalLength:{type:"number",restrictions:[{restriction:function(u){return 0<=u},message:"value must be positive"},{restriction:function(u,f){return!f.exponential},message:"`totalLength` is incompatible with `exponential`"}]},mantissa:{type:"number",restriction:function(u){return 0<=u},message:"value must be positive"},optionalMantissa:"boolean",trimMantissa:"boolean",optionalCharacteristic:"boolean",thousandSeparated:"boolean",spaceSeparated:"boolean",abbreviations:{type:"object",children:{thousand:"string",million:"string",billion:"string",trillion:"string"}},negative:{type:"string",validValues:["sign","parenthesis"]},forceSign:"boolean",exponential:{type:"boolean"},prefixSymbol:{type:"boolean",restriction:function(u,f){return f.output==="percent"},message:"`prefixSymbol` can be provided only when the output is `percent`"}},d={languageTag:{type:"string",mandatory:!0,restriction:function(u){return u.match(l)},message:"the language tag must follow the BCP 47 specification (see https://tools.ieft.org/html/bcp47)"},delimiters:{type:"object",children:{thousands:"string",decimal:"string",thousandsSize:"number"},mandatory:!0},abbreviations:{type:"object",children:{thousand:{type:"string",mandatory:!0},million:{type:"string",mandatory:!0},billion:{type:"string",mandatory:!0},trillion:{type:"string",mandatory:!0}},mandatory:!0},spaceSeparated:"boolean",ordinal:{type:"function",mandatory:!0},currency:{type:"object",children:{symbol:"string",position:"string",code:"string"},mandatory:!0},defaults:"format",ordinalFormat:"format",byteFormat:"format",percentageFormat:"format",currencyFormat:"format",timeDefaults:"format",formats:{type:"object",children:{fourDigits:{type:"format",mandatory:!0},fullWithTwoDecimals:{type:"format",mandatory:!0},fullWithTwoDecimalsNoCurrency:{type:"format",mandatory:!0},fullWithNoDecimals:{type:"format",mandatory:!0}}}};function g(u){return!!s.unformat(u)}function y(u,f,c){var v=3<arguments.length&&arguments[3]!==void 0&&arguments[3],m=Object.keys(u).map(function(b){if(!f[b])return console.error("".concat(c," Invalid key: ").concat(b)),!1;var w=u[b],_=f[b];if(typeof _=="string"&&(_={type:_}),_.type==="format"){if(!y(w,p,"[Validate ".concat(b,"]"),!0))return!1}else if(a(w)!==_.type)return console.error("".concat(c," ").concat(b,' type mismatched: "').concat(_.type,'" expected, "').concat(a(w),'" provided')),!1;if(_.restrictions&&_.restrictions.length)for(var C=_.restrictions.length,R=0;R<C;R++){var I=_.restrictions[R],P=I.restriction,N=I.message;if(!P(w,u))return console.error("".concat(c," ").concat(b," invalid value: ").concat(N)),!1}return _.restriction&&!_.restriction(w,u)?(console.error("".concat(c," ").concat(b," invalid value: ").concat(_.message)),!1):_.validValues&&_.validValues.indexOf(w)===-1?(console.error("".concat(c," ").concat(b," invalid value: must be among ").concat(JSON.stringify(_.validValues),', "').concat(w,'" provided')),!1):!(_.children&&!y(w,_.children,"[Validate ".concat(b,"]")))});return v||m.push.apply(m,o(Object.keys(f).map(function(b){var w=f[b];if(typeof w=="string"&&(w={type:w}),w.mandatory){var _=w.mandatory;if(typeof _=="function"&&(_=_(u)),_&&u[b]===void 0)return console.error("".concat(c,' Missing mandatory key "').concat(b,'"')),!1}return!0}))),m.reduce(function(b,w){return b&&w},!0)}function h(u){return y(u,p,"[Validate format]")}n.exports={validate:function(u,f){var c=g(u),v=h(f);return c&&v},validateFormat:h,validateInput:g,validateLanguage:function(u){return y(u,d,"[Validate language]")}}},{"./unformatting":9}]},{},[7])(7)})})($M);var $a=$M.exports,Ede="numeric";function aS(t,r,e,n,i,o,a){var s=o;if(dn(s)){var l=a.numericFormat,p=l&&l.culture||"-",d=l&&l.pattern,g=a.className||"",y=g.length?g.split(" "):[];if(typeof p!="undefined"&&!$a.languages()[p]){var h=p.replace("-",""),u=$a.allLanguages?$a.allLanguages[p]:$a[h];u&&$a.registerLanguage(u)}$a.setLanguage(p),s=$a(s).format(d||"0"),y.indexOf("htLeft")<0&&y.indexOf("htCenter")<0&&y.indexOf("htRight")<0&&y.indexOf("htJustify")<0&&y.push("htRight"),y.indexOf("htNumeric")<0&&y.push("htNumeric"),a.className=y.join(" ")}Fo(t,r,e,n,i,s,a)}aS.RENDERER_TYPE=Ede;var Tde="password";function sS(t,r,e,n,i,o,a){Fo.apply(this,[t,r,e,n,i,o,a]);var s=a.hashLength||r.innerHTML.length,l=a.hashSymbol||"*",p="";Qe(s-1,function(){p+=l}),Ao(r,p)}sS.RENDERER_TYPE=Tde;function xde(){Ai(gu),Ai(Ff),Ai(iS),Ai(nS),Ai(aS),Ai(sS),Ai(Fo)}var Ade="autocomplete";function Jp(t,r){var e=t;if(e==null&&(e=""),this.allowEmpty&&e===""){r(!0);return}this.strict&&this.source?typeof this.source=="function"?this.source(e,jM(e,r)):jM(e,r)(this.source):r(!0)}Jp.VALIDATOR_TYPE=Ade;function jM(t,r){var e=t;return function(n){for(var i=!1,o=0,a=n.length;o<a;o++)if(e===n[o]){i=!0;break}r(i)}}var Mde=Object.is||function(r,e){return r===e?r!==0||1/r==1/e:r!=r&&e!=e},Pde=$r,Ide=Uc,Dde=br,Nde=Jr,LM=Mde,HM=xr,$de=oa,jde=zc;Ide("search",function(t,r,e){return[function(i){var o=Nde(this),a=i==null?void 0:$de(i,t);return a?Pde(a,i,o):new RegExp(i)[t](HM(o))},function(n){var i=Dde(this),o=HM(n),a=e(r,i,o);if(a.done)return a.value;var s=i.lastIndex;LM(s,0)||(i.lastIndex=0);var l=jde(i,o);return LM(i.lastIndex,s)||(i.lastIndex=s),l===null?-1:l.index}]});function FM(t){var r=new Date(t);return isNaN(new Date("".concat(t,"T00:00")).getDate())?r:new Date(r.getTime()+r.getTimezoneOffset()*6e4)}var Lde=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",getNormalizedDate:FM}),Hde="date";function uS(t,r){var e=q6(OM,this.instance),n=t,i=!0;n==null&&(n="");var o=$e(n,this.dateFormat||e.defaultDateFormat,!0).isValid(),a=$e(new Date(n)).isValid()||o;if(this.allowEmpty&&n===""&&(a=!0,o=!0),a||(i=!1),!a&&o&&(i=!0),a&&!o)if(this.correctFormat===!0){var s=Fde(n,this.dateFormat),l=this.instance.toVisualRow(this.row),p=this.instance.toVisualColumn(this.col);this.instance.setDataAtCell(l,p,s,"dateValidator"),i=!0}else i=!1;r(i)}uS.VALIDATOR_TYPE=Hde;function Fde(t,r){var e=$e(FM(t)),n=$e(t,r),i=t.search(/[A-z]/g)>-1,o;return e.isValid()&&e.format("x")===n.format("x")||!n.isValid()||i?o=e:o=n,o.format(r)}var Bde="numeric";function lS(t,r){var e=t;e==null&&(e=""),this.allowEmpty&&e===""?r(!0):r(e===""?!1:dn(t))}lS.VALIDATOR_TYPE=Bde;var Vde=["YYYY-MM-DDTHH:mm:ss.SSSZ","X","x"],Wde="time";function fS(t,r){var e=this.timeFormat||"h:mm:ss a",n=!0,i=t;i===null&&(i=""),i=/^\d{3,}$/.test(i)?parseInt(i,10):i;var o=/^\d{1,2}$/.test(i);o&&(i+=":00");var a=$e(i,Vde,!0).isValid()?$e(i):$e(i,e),s=a.isValid(),l=$e(i,e,!0).isValid()&&!o;if(this.allowEmpty&&i===""&&(s=!0,l=!0),s||(n=!1),!s&&l&&(n=!0),s&&!l)if(this.correctFormat===!0){var p=a.format(e),d=this.instance.toVisualRow(this.row),g=this.instance.toVisualColumn(this.col);this.instance.setDataAtCell(d,g,p,"timeValidator"),n=!0}else n=!1;r(n)}fS.VALIDATOR_TYPE=Wde;function Ude(){su(Jp),su(uS),su(lS),su(fS)}var zde="autocomplete",Yde={CELL_TYPE:zde,editor:K_,renderer:gu,validator:Jp},Gde="checkbox",Kde={CELL_TYPE:Gde,editor:_M,renderer:iS},qde="date",Xde={CELL_TYPE:qde,editor:RM,renderer:gu,validator:uS},Zde="dropdown",Jde={CELL_TYPE:Zde,editor:J_,renderer:gu,validator:Jp},Qde="handsontable",epe={CELL_TYPE:Qde,editor:U_,renderer:gu},tpe="numeric",rpe={CELL_TYPE:tpe,editor:xM,renderer:aS,validator:lS,dataType:"number"},npe="password",ipe={CELL_TYPE:npe,editor:MM,renderer:sS,copyable:!1},ope="time",ape={CELL_TYPE:ope,editor:Na,renderer:Fo,validator:fS};function spe(){Bn(Yde),Bn(Kde),Bn(Xde),Bn(Jde),Bn(epe),Bn(rpe),Bn(ipe),Bn(vM),Bn(ape)}function upe(t,r){return hpe(t)||cpe(t,r)||fpe(t,r)||lpe()}function lpe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function fpe(t,r){if(!!t){if(typeof t=="string")return BM(t,r);var e=Object.prototype.toString.call(t).slice(8,-1);if(e==="Object"&&t.constructor&&(e=t.constructor.name),e==="Map"||e==="Set")return Array.from(t);if(e==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return BM(t,r)}}function BM(t,r){(r==null||r>t.length)&&(r=t.length);for(var e=0,n=new Array(r);e<r;e++)n[e]=t[e];return n}function cpe(t,r){var e=t==null?null:typeof Symbol!="undefined"&&t[Symbol.iterator]||t["@@iterator"];if(e!=null){var n=[],i=!0,o=!1,a,s;try{for(e=e.call(t);!(i=(a=e.next()).done)&&(n.push(a.value),!(r&&n.length===r));i=!0);}catch(l){o=!0,s=l}finally{try{!i&&e.return!=null&&e.return()}finally{if(o)throw s}}return n}}function hpe(t){if(Array.isArray(t))return t}function dpe(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}function VM(t,r){for(var e=0;e<r.length;e++){var n=r[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function ppe(t,r,e){return r&&VM(t.prototype,r),e&&VM(t,e),t}var WM=new Map([["plugin",gae],["cell-type",PA],["editor",K6],["renderer",kA],["validator",OA]]),ype="base",ja=new WeakMap,cS=[],oi=null,Lt=function(){function t(r){var e=this;dpe(this,t),Gn(this,"hot",r,{writable:!1}),ja.set(this,{hooks:{}}),oi=null,this.pluginName=null,this.pluginsInitializedCallbacks=[],this.isPluginsReady=!1,this.enabled=!1,this.initialized=!1,this.hot.addHook("afterPluginsInitialized",function(){return e.onAfterPluginsInitialized()}),this.hot.addHook("afterUpdateSettings",function(n){return e.onUpdateSettings(n)}),this.hot.addHook("beforeInit",function(){return e.init()})}return ppe(t,[{key:"init",value:function(){var e=this;this.pluginName=this.hot.getPluginName(this);var n=this.constructor.PLUGIN_DEPS,i=Array.isArray(n)?n:[];if(i.length>0){var o=[];if(i.forEach(function(p){var d=p.split(":"),g=upe(d,2),y=g[0],h=g[1];if(!WM.has(y))throw new Error('Unknown plugin dependency type "'.concat(y,'" was found.'));WM.get(y)(h)||o.push(" - ".concat(h," (").concat(y,")"))}),o.length>0){var a=["The ".concat(this.pluginName,` plugin requires the following modules:
`),"".concat(o.join(`
`),`
`)].join("");cS.push(a)}}oi||(oi=Dw()),oi.indexOf("UndoRedo")>=0&&oi.splice(oi.indexOf("UndoRedo"),1),oi.indexOf(this.pluginName)>=0&&oi.splice(oi.indexOf(this.pluginName),1),this.hot.addHookOnce("afterPluginsInitialized",function(){e.isEnabled&&e.isEnabled()&&e.enablePlugin()});var s=oi.length===0;if(s){if(cS.length>0){var l=["".concat(cS.join(`
`),`
`),"You have to import and register them manually."].join("");throw new Error(l)}this.hot.runHooks("afterPluginsInitialized")}this.initialized=!0}},{key:"enablePlugin",value:function(){this.enabled=!0}},{key:"disablePlugin",value:function(){this.eventManager&&this.eventManager.clear(),this.clearHooks(),this.enabled=!1}},{key:"addHook",value:function(e,n){ja.get(this).hooks[e]=ja.get(this).hooks[e]||[];var i=ja.get(this).hooks[e];this.hot.addHook(e,n),i.push(n),ja.get(this).hooks[e]=i}},{key:"removeHooks",value:function(e){var n=this;he(ja.get(this).hooks[e]||[],function(i){n.hot.removeHook(e,i)})}},{key:"clearHooks",value:function(){var e=this,n=ja.get(this).hooks;Ot(n,function(i,o){return e.removeHooks(o)}),n.length=0}},{key:"callOnPluginsReady",value:function(e){this.isPluginsReady?e():this.pluginsInitializedCallbacks.push(e)}},{key:"onAfterPluginsInitialized",value:function(){he(this.pluginsInitializedCallbacks,function(e){return e()}),this.pluginsInitializedCallbacks.length=0,this.isPluginsReady=!0}},{key:"onUpdateSettings",value:function(e){this.isEnabled&&(this.enabled&&!this.isEnabled()&&this.disablePlugin(),!this.enabled&&this.isEnabled()&&this.enablePlugin(),this.enabled&&this.isEnabled()&&this.updatePlugin(e))}},{key:"updatePlugin",value:function(){}},{key:"destroy",value:function(){var e=this;this.eventManager&&this.eventManager.destroy(),this.clearHooks(),Ot(this,function(n,i){i!=="hot"&&(e[i]=null)}),delete this.t,delete this.hot}}],[{key:"PLUGIN_KEY",get:function(){return ype}}]),t}();function mpe(t,r){return wpe(t)||bpe(t,r)||gpe(t,r)||vpe()}function vpe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function gpe(t,r){if(!!t){if(typeof t=="string")return UM(t,r);var e=Object.prototype.toString.call(t).slice(8,-1);if(e==="Object"&&t.constructor&&(e=t.constructor.name),e==="Map"||e==="Set")return Array.from(t);if(e==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return UM(t,r)}}function UM(t,r){(r==null||r>t.length)&&(r=t.length);for(var e=0,n=new Array(r);e<r;e++)n[e]=t[e];return n}function bpe(t,r){var e=t==null?null:typeof Symbol!="undefined"&&t[Symbol.iterator]||t["@@iterator"];if(e!=null){var n=[],i=!0,o=!1,a,s;try{for(e=e.call(t);!(i=(a=e.next()).done)&&(n.push(a.value),!(r&&n.length===r));i=!0);}catch(l){o=!0,s=l}finally{try{!i&&e.return!=null&&e.return()}finally{if(o)throw s}}return n}}function wpe(t){if(Array.isArray(t))return t}function _pe(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}function zM(t,r){for(var e=0;e<r.length;e++){var n=r[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function Spe(t,r,e){return r&&zM(t.prototype,r),e&&zM(t,e),t}var Cpe=function(){function t(r){_pe(this,t),this.hot=r,this.container=null,this.injected=!1,this.rows=[],this.columns=[],this.samples=null,this.settings={useHeaders:!0}}return Spe(t,[{key:"addRow",value:function(e,n){if(this.columns.length)throw new Error("Doesn't support multi-dimensional table");this.rows.length||(this.container=this.createContainer(this.hot.rootElement.className));var i={row:e};this.rows.push(i),this.samples=n,this.table=this.createTable(this.hot.table.className),this.table.colGroup.appendChild(this.createColGroupsCol()),this.table.tr.appendChild(this.createRow(e)),this.container.container.appendChild(this.table.fragment),i.table=this.table.table}},{key:"addColumnHeadersRow",value:function(e){var n=this.hot.getColHeader(0);if(n!=null){var i={row:-1};this.rows.push(i),this.container=this.createContainer(this.hot.rootElement.className),this.samples=e,this.table=this.createTable(this.hot.table.className),this.table.colGroup.appendChild(this.createColGroupsCol()),this.appendColumnHeadersRow(),this.container.container.appendChild(this.table.fragment),i.table=this.table.table}}},{key:"addColumn",value:function(e,n){if(this.rows.length)throw new Error("Doesn't support multi-dimensional table");this.columns.length||(this.container=this.createContainer(this.hot.rootElement.className));var i={col:e};this.columns.push(i),this.samples=n,this.table=this.createTable(this.hot.table.className),this.getSetting("useHeaders")&&this.hot.getColHeader(e)!==null&&this.hot.view.appendColHeader(e,this.table.th),this.table.tBody.appendChild(this.createCol(e)),this.container.container.appendChild(this.table.fragment),i.table=this.table.table}},{key:"getHeights",value:function(e){this.injected||this.injectTable(),he(this.rows,function(n){e(n.row,yr(n.table)-1)})}},{key:"getWidths",value:function(e){this.injected||this.injectTable(),he(this.columns,function(n){e(n.col,sr(n.table))})}},{key:"setSettings",value:function(e){this.settings=e}},{key:"setSetting",value:function(e,n){this.settings||(this.settings={}),this.settings[e]=n}},{key:"getSettings",value:function(){return this.settings}},{key:"getSetting",value:function(e){return this.settings?this.settings[e]:null}},{key:"createColGroupsCol",value:function(){var e=this,n=this.hot.rootDocument.createDocumentFragment();return this.hot.hasRowHeaders()&&n.appendChild(this.createColElement(-1)),this.samples.forEach(function(i){he(i.strings,function(o){n.appendChild(e.createColElement(o.col))})}),n}},{key:"createRow",value:function(e){var n=this,i=this.hot.rootDocument,o=i.createDocumentFragment(),a=i.createElement("th");return this.hot.hasRowHeaders()&&(this.hot.view.appendRowHeader(e,a),o.appendChild(a)),this.samples.forEach(function(s){he(s.strings,function(l){var p=l.col,d=n.hot.getCellMeta(e,p);d.col=p,d.row=e;var g=n.hot.getCellRenderer(d),y=i.createElement("td");y.setAttribute("ghost-table",1),g(n.hot,y,e,p,n.hot.colToProp(p),l.value,d),o.appendChild(y)})}),o}},{key:"appendColumnHeadersRow",value:function(){var e=this,n=this.hot.rootDocument,i=n.createDocumentFragment(),o=[];if(this.hot.hasRowHeaders()){var a=n.createElement("th");o.push([-1,a]),i.appendChild(a)}this.samples.forEach(function(s){he(s.strings,function(l){var p=l.col,d=n.createElement("th");o.push([p,d]),i.appendChild(d)})}),this.table.tHead.appendChild(i),he(o,function(s){var l=mpe(s,2),p=l[0],d=l[1];e.hot.view.appendColHeader(p,d)})}},{key:"createCol",value:function(e){var n=this,i=this.hot.rootDocument,o=i.createDocumentFragment();return this.samples.forEach(function(a){he(a.strings,function(s){var l=s.row,p=n.hot.getCellMeta(l,e);p.col=e,p.row=l;var d=n.hot.getCellRenderer(p),g=i.createElement("td"),y=i.createElement("tr");g.setAttribute("ghost-table",1),d(n.hot,g,l,e,n.hot.colToProp(e),s.value,p),y.appendChild(g),o.appendChild(y)})}),o}},{key:"clean",value:function(){this.rows.length=0,this.rows[-1]=void 0,this.columns.length=0,this.samples&&this.samples.clear(),this.samples=null,this.removeTable()}},{key:"injectTable",value:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;this.injected||((e||this.hot.rootElement).appendChild(this.container.fragment),this.injected=!0)}},{key:"removeTable",value:function(){this.injected&&this.container.container.parentNode&&(this.container.container.parentNode.removeChild(this.container.container),this.container=null,this.injected=!1)}},{key:"createColElement",value:function(e){var n=this.hot.rootDocument.createElement("col");return n.style.width="".concat(this.hot.view.wt.wtTable.getStretchedColumnWidth(e),"px"),n}},{key:"createTable",value:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",n=this.hot.rootDocument,i=n.createDocumentFragment(),o=n.createElement("table"),a=n.createElement("thead"),s=n.createElement("tbody"),l=n.createElement("colgroup"),p=n.createElement("tr"),d=n.createElement("th");return this.isVertical()&&o.appendChild(l),this.isHorizontal()&&(p.appendChild(d),a.appendChild(p),o.style.tableLayout="auto",o.style.width="auto"),o.appendChild(a),this.isVertical()&&s.appendChild(p),o.appendChild(s),Ie(o,e),i.appendChild(o),{fragment:i,table:o,tHead:a,tBody:s,colGroup:l,tr:p,th:d}}},{key:"createContainer",value:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",n=this.hot.rootDocument,i=n.createDocumentFragment(),o=n.createElement("div"),a="htGhostTable htAutoSize ".concat(e.trim());return Ie(o,a),i.appendChild(o),{fragment:i,container:o}}},{key:"isVertical",value:function(){return!!(this.rows.length&&!this.columns.length)}},{key:"isHorizontal",value:function(){return!!(this.columns.length&&!this.rows.length)}}]),t}(),hS=Cpe;function kpe(t,r,e){return r in t?Object.defineProperty(t,r,{value:e,enumerable:!0,configurable:!0,writable:!0}):t[r]=e,t}function Ope(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}function YM(t,r){for(var e=0;e<r.length;e++){var n=r[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function Rpe(t,r,e){return r&&YM(t.prototype,r),e&&YM(t,e),t}var Epe=function(){function t(r){Ope(this,t),this.samples=null,this.dataFactory=r,this.customSampleCount=null,this.allowDuplicates=!1}return Rpe(t,[{key:"getSampleCount",value:function(){return this.customSampleCount?this.customSampleCount:t.SAMPLE_COUNT}},{key:"setSampleCount",value:function(e){this.customSampleCount=e}},{key:"setAllowDuplicates",value:function(e){this.allowDuplicates=e}},{key:"generateRowSamples",value:function(e,n){return this.generateSamples("row",n,e)}},{key:"generateColumnSamples",value:function(e,n){return this.generateSamples("col",n,e)}},{key:"generateSamples",value:function(e,n,i){var o=this,a=new Map,s=typeof i=="number"?{from:i,to:i}:i,l=s.from,p=s.to;return Qe(l,p,function(d){var g=o.generateSample(e,n,d);a.set(d,g)}),a}},{key:"generateSample",value:function(e,n,i){var o=this;if(e!=="row"&&e!=="col")throw new Error("Unsupported sample type");var a=new Map,s=e==="row"?"col":"row",l=[];return Qe(n.from,n.to,function(p){var d=e==="row"?o.dataFactory(i,p):o.dataFactory(p,i),g=d.value,y=d.bundleSeed,h=typeof y=="string"&&y.length>0,u;h?u=y:vt(g)?u="".concat(Object.keys(g).length):Array.isArray(g)?u="".concat(g.length):u="".concat(lr(g).length),a.has(u)||a.set(u,{needed:o.getSampleCount(),strings:[]});var f=a.get(u);if(f.needed){var c=l.indexOf(g)>-1;(!c||o.allowDuplicates||h)&&(f.strings.push(kpe({value:g},s,p)),l.push(g),f.needed-=1)}}),a}}],[{key:"SAMPLE_COUNT",get:function(){return 3}}]),t}(),GM=Epe;function Qp(t){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?Qp=function(e){return typeof e}:Qp=function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Qp(t)}function KM(t,r){return Mpe(t)||Ape(t,r)||xpe(t,r)||Tpe()}function Tpe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function xpe(t,r){if(!!t){if(typeof t=="string")return qM(t,r);var e=Object.prototype.toString.call(t).slice(8,-1);if(e==="Object"&&t.constructor&&(e=t.constructor.name),e==="Map"||e==="Set")return Array.from(t);if(e==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return qM(t,r)}}function qM(t,r){(r==null||r>t.length)&&(r=t.length);for(var e=0,n=new Array(r);e<r;e++)n[e]=t[e];return n}function Ape(t,r){var e=t==null?null:typeof Symbol!="undefined"&&t[Symbol.iterator]||t["@@iterator"];if(e!=null){var n=[],i=!0,o=!1,a,s;try{for(e=e.call(t);!(i=(a=e.next()).done)&&(n.push(a.value),!(r&&n.length===r));i=!0);}catch(l){o=!0,s=l}finally{try{!i&&e.return!=null&&e.return()}finally{if(o)throw s}}return n}}function Mpe(t){if(Array.isArray(t))return t}function Ppe(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}function XM(t,r){for(var e=0;e<r.length;e++){var n=r[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function Ipe(t,r,e){return r&&XM(t.prototype,r),e&&XM(t,e),t}function La(){return typeof Reflect!="undefined"&&Reflect.get?La=Reflect.get:La=function(r,e,n){var i=Dpe(r,e);if(!!i){var o=Object.getOwnPropertyDescriptor(i,e);return o.get?o.get.call(arguments.length<3?r:n):o.value}},La.apply(this,arguments)}function Dpe(t,r){for(;!Object.prototype.hasOwnProperty.call(t,r)&&(t=Ii(t),t!==null););return t}function Npe(t,r){if(typeof r!="function"&&r!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(r&&r.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),r&&dS(t,r)}function dS(t,r){return dS=Object.setPrototypeOf||function(n,i){return n.__proto__=i,n},dS(t,r)}function $pe(t){var r=Lpe();return function(){var n=Ii(t),i;if(r){var o=Ii(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return jpe(this,i)}}function jpe(t,r){if(r&&(Qp(r)==="object"||typeof r=="function"))return r;if(r!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return ZM(t)}function ZM(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Lpe(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Ii(t){return Ii=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},Ii(t)}Ze.getSingleton().register("modifyAutoColumnSizeSeed");var Vf="autoColumnSize",Hpe=10,pS=new WeakMap,Fpe="autoColumnSize",Bpe=function(t){Npe(e,t);var r=$pe(e);function e(n){var i;return Ppe(this,e),i=r.call(this,n),pS.set(ZM(i),{cachedColumnHeaders:[]}),i.ghostTable=new hS(i.hot),i.samplesGenerator=new GM(function(o,a){var s=i.hot.getCellMeta(o,a),l="";s.spanned||(l=i.hot.getDataAtCell(o,a));var p="";return i.hot.hasHook("modifyAutoColumnSizeSeed")&&(p=i.hot.runHooks("modifyAutoColumnSizeSeed",p,s,l)),{value:l,bundleSeed:p}}),i.firstCalculation=!0,i.inProgress=!1,i.measuredColumns=0,i.columnWidthsMap=new $o,i.hot.columnIndexMapper.registerMap(Fpe,i.columnWidthsMap),i.addHook("beforeColumnResize",function(o,a,s){return i.onBeforeColumnResize(o,a,s)}),i}return Ipe(e,[{key:"isEnabled",value:function(){return this.hot.getSettings()[Vf]!==!1&&!this.hot.getSettings().colWidths}},{key:"enablePlugin",value:function(){var i=this;if(!this.enabled){var o=this.hot.getSettings()[Vf];o&&o.useHeaders!==null&&o.useHeaders!==void 0&&this.ghostTable.setSetting("useHeaders",o.useHeaders),this.setSamplingOptions(),this.addHook("afterLoadData",function(){return i.onAfterLoadData()}),this.addHook("beforeChange",function(a){return i.onBeforeChange(a)}),this.addHook("afterFormulasValuesUpdate",function(a){return i.onAfterFormulasValuesUpdate(a)}),this.addHook("beforeViewRender",function(a){return i.onBeforeViewRender(a)}),this.addHook("modifyColWidth",function(a,s){return i.getColumnWidth(s,a)}),this.addHook("afterInit",function(){return i.onAfterInit()}),La(Ii(e.prototype),"enablePlugin",this).call(this)}}},{key:"updatePlugin",value:function(){var i=this.findColumnsWhereHeaderWasChanged();i.length&&(this.clearCache(i),this.calculateVisibleColumnsWidth()),La(Ii(e.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){var i=this;La(Ii(e.prototype),"disablePlugin",this).call(this),this.addHook("beforeColumnResize",function(o,a,s){return i.onBeforeColumnResize(o,a,s)})}},{key:"calculateVisibleColumnsWidth",value:function(){var i=this.hot.countRows();if(!!i){var o=this.hot.renderCall,a=this.getFirstVisibleColumn(),s=this.getLastVisibleColumn();a===-1||s===-1||this.calculateColumnsWidth({from:a,to:s},void 0,o)}}},{key:"calculateColumnsWidth",value:function(){var i=this,o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countCols()-1},a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{from:0,to:this.hot.countRows()-1},s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,l=typeof o=="number"?{from:o,to:o}:o,p=typeof a=="number"?{from:a,to:a}:a;Qe(l.from,l.to,function(d){var g=i.hot.toPhysicalColumn(d);if(g===null&&(g=d),s||i.columnWidthsMap.getValueAtIndex(g)===null&&!i.hot._getColWidthFromSettings(g)){var y=i.samplesGenerator.generateColumnSamples(d,p);he(y,function(h){var u=KM(h,2),f=u[0],c=u[1];return i.ghostTable.addColumn(f,c)})}}),this.ghostTable.columns.length&&(this.hot.batchExecution(function(){i.ghostTable.getWidths(function(d,g){var y=i.hot.toPhysicalColumn(d);i.columnWidthsMap.setValueAtIndex(y,g)})},!0),this.measuredColumns=l.to+1,this.ghostTable.clean())}},{key:"calculateAllColumnsWidth",value:function(){var i=this,o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countRows()-1},a=0,s=this.hot.countCols()-1,l=null;this.inProgress=!0;var p=function g(){if(!i.hot){Hl(l),i.inProgress=!1;return}i.calculateColumnsWidth({from:a,to:Math.min(a+e.CALCULATION_STEP,s)},o),a=a+e.CALCULATION_STEP+1,a<s?l=cb(g):(Hl(l),i.inProgress=!1,i.hot.view.adjustElementsSize())},d=this.getSyncCalculationLimit();this.firstCalculation&&d>=0&&(this.calculateColumnsWidth({from:0,to:d},o),this.firstCalculation=!1,a=d+1),a<s?p():this.inProgress=!1}},{key:"setSamplingOptions",value:function(){var i=this.hot.getSettings()[Vf],o=i&&Yt(i,"samplingRatio")?i.samplingRatio:void 0,a=i&&Yt(i,"allowSampleDuplicates")?i.allowSampleDuplicates:void 0;o&&!isNaN(o)&&this.samplesGenerator.setSampleCount(parseInt(o,10)),a&&this.samplesGenerator.setAllowDuplicates(a)}},{key:"recalculateAllColumnsWidth",value:function(){this.hot.view&&this.hot.view.wt.wtTable.isVisible()&&(this.clearCache(),this.calculateAllColumnsWidth())}},{key:"getSyncCalculationLimit",value:function(){var i=this.hot.getSettings()[Vf],o=e.SYNC_CALCULATION_LIMIT,a=this.hot.countCols()-1;return vt(i)&&(o=i.syncLimit,m0(o)?o=Ow(a,o):o>>=0),Math.min(o,a)}},{key:"getColumnWidth",value:function(i){var o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:void 0,a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,s=o;return s===void 0&&(s=this.columnWidthsMap.getValueAtIndex(this.hot.toPhysicalColumn(i)),a&&typeof s=="number"&&(s=Math.max(s,I0.DEFAULT_WIDTH))),s}},{key:"getFirstVisibleColumn",value:function(){var i=this.hot.view.wt;if(i.wtViewport.columnsVisibleCalculator){var o=i.wtTable.getFirstVisibleColumn();if(o!==-1)return this.hot.columnIndexMapper.getVisualFromRenderableIndex(o)}if(i.wtViewport.columnsRenderCalculator){var a=i.wtTable.getFirstRenderedColumn();if(a!==-1)return this.hot.columnIndexMapper.getVisualFromRenderableIndex(a)}return-1}},{key:"getLastVisibleColumn",value:function(){var i=this.hot.view.wt;if(i.wtViewport.columnsVisibleCalculator){var o=i.wtTable.getLastVisibleColumn();if(o!==-1)return this.hot.columnIndexMapper.getVisualFromRenderableIndex(o)}if(i.wtViewport.columnsRenderCalculator){var a=i.wtTable.getLastRenderedColumn();if(a!==-1)return this.hot.columnIndexMapper.getVisualFromRenderableIndex(a)}return-1}},{key:"findColumnsWhereHeaderWasChanged",value:function(){var i=this.hot.getColHeader(),o=pS.get(this),a=o.cachedColumnHeaders,s=pr(i,function(l,p,d){var g=a.length;return(g-1<d||a[d]!==p)&&l.push(d),g-1<d?a.push(p):a[d]=p,l},[]);return s}},{key:"clearCache",value:function(){var i=this,o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];o.length?this.hot.batchExecution(function(){he(o,function(a){i.columnWidthsMap.setValueAtIndex(a,null)})},!0):this.columnWidthsMap.clear()}},{key:"isNeedRecalculate",value:function(){return!!un(this.columnWidthsMap.getValues().slice(0,this.measuredColumns),function(i){return i===null}).length}},{key:"onBeforeViewRender",value:function(){this.calculateVisibleColumnsWidth(),this.isNeedRecalculate()&&!this.inProgress&&this.calculateAllColumnsWidth()}},{key:"onAfterLoadData",value:function(){var i=this;this.hot.view?this.recalculateAllColumnsWidth():setTimeout(function(){i.hot&&i.recalculateAllColumnsWidth()},0)}},{key:"onBeforeChange",value:function(i){var o=this,a=bt(i,function(s){var l=KM(s,2),p=l[1];return o.hot.toPhysicalColumn(o.hot.propToCol(p))});this.clearCache(Array.from(new Set(a)))}},{key:"onBeforeColumnResize",value:function(i,o,a){var s=i;return a&&(this.calculateColumnsWidth(o,void 0,!0),s=this.getColumnWidth(o,void 0,!1)),s}},{key:"onAfterInit",value:function(){pS.get(this).cachedColumnHeaders=this.hot.getColHeader()}},{key:"onAfterFormulasValuesUpdate",value:function(i){var o=un(i,function(s){var l;return at((l=s.address)===null||l===void 0?void 0:l.col)}),a=bt(o,function(s){return s.address.col});this.clearCache(Array.from(new Set(a)))}},{key:"destroy",value:function(){this.ghostTable.clean(),La(Ii(e.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return Vf}},{key:"PLUGIN_PRIORITY",get:function(){return Hpe}},{key:"CALCULATION_STEP",get:function(){return 50}},{key:"SYNC_CALCULATION_LIMIT",get:function(){return 50}}]),e}(Lt),Ha={horizontal:"horizontal",vertical:"vertical"};function Vpe(t,r,e,n){var i=e.length,o=e?e[0].length:0,a=[],s=r.row-t.row,l=r.col-t.col;if(["down","up"].indexOf(n)!==-1){for(var p=[],d=0;d<l;d++){var g=parseInt(e[0][d],10),y=parseInt(e[i-1][d],10),h=(n==="down"?y-g:g-y)/(i-1)||0;p.push(h)}a.push(p)}if(["right","left"].indexOf(n)!==-1)for(var u=0;u<s;u++){var f=parseInt(e[u][0],10),c=parseInt(e[u][o-1],10),v=(n==="right"?c-f:f-c)/(o-1)||0;a.push([v])}return a}function Wpe(t,r){var e,n,i;return r[0]===t[0]&&r[1]<t[1]?(i="left",e=new ke(r[0],r[1]),n=new ke(r[2],t[1]-1)):r[2]===t[2]&&r[0]===t[0]&&r[3]>t[3]?(i="right",e=new ke(r[0],t[3]+1),n=new ke(r[2],r[3])):r[0]<t[0]&&r[1]===t[1]?(i="up",e=new ke(r[0],r[1]),n=new ke(t[0]-1,r[3])):r[2]>t[2]&&r[1]===t[1]&&(i="down",e=new ke(t[2]+1,r[1]),n=new ke(r[2],r[3])),e&&e.normalize(),n&&n.normalize(),{directionOfDrag:i,startOfDragCoords:e,endOfDragCoords:n}}function Upe(t){var r={};return t===!0?(r.directions=Object.keys(Ha),r.autoInsertRow=!0):vt(t)?(at(t.autoInsertRow)?t.direction===Ha.horizontal?r.autoInsertRow=!1:r.autoInsertRow=t.autoInsertRow:r.autoInsertRow=!1,at(t.direction)?r.directions=[t.direction]:r.directions=Object.keys(Ha)):typeof t=="string"?(r.directions=[t],r.autoInsertRow=!0):(r.directions=[],r.autoInsertRow=!1),r}function ey(t){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?ey=function(e){return typeof e}:ey=function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ey(t)}function zpe(t){return Kpe(t)||Gpe(t)||JM(t)||Ype()}function Ype(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Gpe(t){if(typeof Symbol!="undefined"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function Kpe(t){if(Array.isArray(t))return yS(t)}function qpe(t,r){return Jpe(t)||Zpe(t,r)||JM(t,r)||Xpe()}function Xpe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function JM(t,r){if(!!t){if(typeof t=="string")return yS(t,r);var e=Object.prototype.toString.call(t).slice(8,-1);if(e==="Object"&&t.constructor&&(e=t.constructor.name),e==="Map"||e==="Set")return Array.from(t);if(e==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return yS(t,r)}}function yS(t,r){(r==null||r>t.length)&&(r=t.length);for(var e=0,n=new Array(r);e<r;e++)n[e]=t[e];return n}function Zpe(t,r){var e=t==null?null:typeof Symbol!="undefined"&&t[Symbol.iterator]||t["@@iterator"];if(e!=null){var n=[],i=!0,o=!1,a,s;try{for(e=e.call(t);!(i=(a=e.next()).done)&&(n.push(a.value),!(r&&n.length===r));i=!0);}catch(l){o=!0,s=l}finally{try{!i&&e.return!=null&&e.return()}finally{if(o)throw s}}return n}}function Jpe(t){if(Array.isArray(t))return t}function Qpe(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}function QM(t,r){for(var e=0;e<r.length;e++){var n=r[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function eye(t,r,e){return r&&QM(t.prototype,r),e&&QM(t,e),t}function Fa(){return typeof Reflect!="undefined"&&Reflect.get?Fa=Reflect.get:Fa=function(r,e,n){var i=tye(r,e);if(!!i){var o=Object.getOwnPropertyDescriptor(i,e);return o.get?o.get.call(arguments.length<3?r:n):o.value}},Fa.apply(this,arguments)}function tye(t,r){for(;!Object.prototype.hasOwnProperty.call(t,r)&&(t=Di(t),t!==null););return t}function rye(t,r){if(typeof r!="function"&&r!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(r&&r.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),r&&mS(t,r)}function mS(t,r){return mS=Object.setPrototypeOf||function(n,i){return n.__proto__=i,n},mS(t,r)}function nye(t){var r=oye();return function(){var n=Di(t),i;if(r){var o=Di(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return iye(this,i)}}function iye(t,r){if(r&&(ey(r)==="object"||typeof r=="function"))return r;if(r!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return eP(t)}function eP(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function oye(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Di(t){return Di=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},Di(t)}Ze.getSingleton().register("modifyAutofillRange");Ze.getSingleton().register("beforeAutofill");Ze.getSingleton().register("afterAutofill");var aye="autofill",sye=20,uye="insert_row",lye=200,fye=function(t){rye(e,t);var r=nye(e);function e(n){var i;return Qpe(this,e),i=r.call(this,n),i.eventManager=new Wt(eP(i)),i.addingStarted=!1,i.mouseDownOnCellCorner=!1,i.mouseDragOutside=!1,i.handleDraggedCells=0,i.directions=[],i.autoInsertRow=!1,i}return eye(e,[{key:"isEnabled",value:function(){return this.hot.getSettings().fillHandle}},{key:"enablePlugin",value:function(){var i=this;this.enabled||(this.mapSettings(),this.registerEvents(),this.addHook("afterOnCellCornerMouseDown",function(o){return i.onAfterCellCornerMouseDown(o)}),this.addHook("afterOnCellCornerDblClick",function(o){return i.onCellCornerDblClick(o)}),this.addHook("beforeOnCellMouseOver",function(o,a){return i.onBeforeCellMouseOver(a)}),Fa(Di(e.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),Fa(Di(e.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){this.clearMappedSettings(),Fa(Di(e.prototype),"disablePlugin",this).call(this)}},{key:"getSelectionData",value:function(){var i=this,o=this.hot.getSelectedRangeLast(),a=o.getTopLeftCorner(),s=a.row,l=a.col,p=o.getBottomRightCorner(),d=p.row,g=p.col,y=this.hot.runHooks("modifyCopyableRange",[{startRow:s,startCol:l,endRow:d,endCol:g}]),h=[],u=[],f=[];return he(y,function(c){for(var v=c.startRow;v<=c.endRow;v+=1)h.indexOf(v)===-1&&h.push(v);for(var m=c.startCol;m<=c.endCol;m+=1)u.indexOf(m)===-1&&u.push(m)}),he(h,function(c){var v=[];he(u,function(m){v.push(i.hot.getCopyableData(c,m))}),f.push(v)}),f}},{key:"fillIn",value:function(){if(this.hot.selection.highlight.getFill().isEmpty())return!1;var i=this.hot.selection.highlight.getFill().getVisualCorners(),o=qpe(i,4),a=o[0],s=o[1],l=o[2],p=o[3],d=this.hot.getSelectedRangeLast(),g=d.getTopLeftCorner(),y=d.getBottomRightCorner();this.resetSelectionOfDraggedArea();var h=[g.row,g.col,y.row,y.col],u=this.hot.runHooks("modifyAutofillRange",[Math.min(g.row,a),Math.min(g.col,s),Math.max(y.row,l),Math.max(y.col,p)],h),f=Wpe(h,u),c=f.directionOfDrag,v=f.startOfDragCoords,m=f.endOfDragCoords;if(v&&v.row>-1&&v.col>-1){var b=this.getSelectionData(),w=d.clone(),_=new Rr(v,v,m),C=this.hot.runHooks("beforeAutofill",b,w,_,c);if(C===!1)return this.hot.selection.highlight.getFill().clear(),this.hot.render(),!1;var R=Vpe(v,m,b,c),I=C,P=C;if(["up","left"].indexOf(c)>-1&&!(P.length===1&&P[0].length===0))if(I=[],c==="up")for(var N=m.row-v.row+1,A=N%P.length,$=0;$<N;$++)I.push(P[($+(P.length-A))%P.length]);else for(var T=m.col-v.col+1,M=T%P[0].length,S=0;S<P.length;S++){I.push([]);for(var E=0;E<T;E++)I[S].push(P[S][(E+(P[S].length-M))%P[S].length])}this.hot.populateFromArray(v.row,v.col,I,m.row,m.col,"".concat(this.pluginName,".fill"),null,c,R),this.setSelection(u),this.hot.runHooks("afterAutofill",I,w,_,c),this.hot.render()}else this.hot._refreshBorders();return!0}},{key:"reduceSelectionAreaIfNeeded",value:function(i){return i.row<0&&(i.row=0),i.col<0&&(i.col=0),i}},{key:"getCoordsOfDragAndDropBorders",value:function(i){var o=this.hot.getSelectedRangeLast(),a=o.getBottomRightCorner(),s=i;if(this.directions.includes(Ha.vertical)&&this.directions.includes(Ha.horizontal)){var l=o.getTopLeftCorner();(a.col<=i.col||l.col>=i.col)&&(s=new ke(a.row,i.col)),(a.row<i.row||l.row>i.row)&&(s=new ke(i.row,a.col))}else if(this.directions.includes(Ha.vertical))s=new ke(i.row,a.col);else if(this.directions.includes(Ha.horizontal))s=new ke(a.row,i.col);else return;return this.reduceSelectionAreaIfNeeded(s)}},{key:"showBorder",value:function(i){var o=this.getCoordsOfDragAndDropBorders(i);o&&this.redrawBorders(o)}},{key:"addRow",value:function(){var i=this;this.hot._registerTimeout(function(){i.hot.alter(uye,void 0,1,"".concat(i.pluginName,".fill")),i.addingStarted=!1},lye)}},{key:"addNewRowIfNeeded",value:function(){if(!this.hot.selection.highlight.getFill().isEmpty()&&this.addingStarted===!1&&this.autoInsertRow){var i=this.hot.getSelectedLast(),o=this.hot.selection.highlight.getFill().getVisualCorners(),a=this.hot.countRows();i[2]<a-1&&o[2]===a-1&&(this.addingStarted=!0,this.addRow())}}},{key:"getIndexOfLastAdjacentFilledInRow",value:function(i){for(var o=this.hot.getData(),a=this.hot.countRows(),s,l=i[2]+1;l<a;l++){for(var p=i[1];p<=i[3];p++){var d=o[l][p];if(d)return-1}var g=o[l][i[1]-1],y=o[l][i[3]+1];(!!g||!!y)&&(s=l)}return s}},{key:"addSelectionFromStartAreaToSpecificRowIndex",value:function(i,o){this.hot.selection.highlight.getFill().clear().add(new ke(i[0],i[1])).add(new ke(o,i[3])).commit()}},{key:"setSelection",value:function(i){var o;(o=this.hot).selectCell.apply(o,zpe(bt(i,function(a){return Math.max(a,0)})).concat([!1,!1]))}},{key:"selectAdjacent",value:function(){var i=this.hot.getSelectedLast(),o=this.getIndexOfLastAdjacentFilledInRow(i);return o===-1||o===void 0?!1:(this.addSelectionFromStartAreaToSpecificRowIndex(i,o),!0)}},{key:"resetSelectionOfDraggedArea",value:function(){this.handleDraggedCells=0,this.hot.selection.highlight.getFill().clear()}},{key:"redrawBorders",value:function(i){this.hot.selection.highlight.getFill().clear().add(this.hot.getSelectedRangeLast().from).add(this.hot.getSelectedRangeLast().to).add(i).commit(),this.hot.view.render()}},{key:"getIfMouseWasDraggedOutside",value:function(i){var o=this.hot.rootDocument.documentElement,a=ar(this.hot.table).top-(this.hot.rootWindow.pageYOffset||o.scrollTop)+yr(this.hot.table),s=ar(this.hot.table).left-(this.hot.rootWindow.pageXOffset||o.scrollLeft)+sr(this.hot.table);return i.clientY>a&&i.clientX<=s}},{key:"registerEvents",value:function(){var i=this,o=this.hot.rootDocument.documentElement;this.eventManager.addEventListener(o,"mouseup",function(){return i.onMouseUp()}),this.eventManager.addEventListener(o,"mousemove",function(a){return i.onMouseMove(a)})}},{key:"onCellCornerDblClick",value:function(){var i=this.selectAdjacent();i&&this.fillIn()}},{key:"onAfterCellCornerMouseDown",value:function(){this.handleDraggedCells=1,this.mouseDownOnCellCorner=!0}},{key:"onBeforeCellMouseOver",value:function(i){this.mouseDownOnCellCorner&&!this.hot.view.isMouseDown()&&this.handleDraggedCells&&(this.handleDraggedCells+=1,this.showBorder(i),this.addNewRowIfNeeded())}},{key:"onMouseUp",value:function(){this.handleDraggedCells&&(this.handleDraggedCells>1&&this.fillIn(),this.handleDraggedCells=0,this.mouseDownOnCellCorner=!1)}},{key:"onMouseMove",value:function(i){var o=this.getIfMouseWasDraggedOutside(i);this.addingStarted===!1&&this.handleDraggedCells>0&&o?(this.mouseDragOutside=!0,this.addingStarted=!0):this.mouseDragOutside=!1,this.mouseDragOutside&&this.autoInsertRow&&this.addRow()}},{key:"clearMappedSettings",value:function(){this.directions.length=0,this.autoInsertRow=!1}},{key:"mapSettings",value:function(){var i=Upe(this.hot.getSettings().fillHandle);this.directions=i.directions,this.autoInsertRow=i.autoInsertRow}},{key:"destroy",value:function(){Fa(Di(e.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return aye}},{key:"PLUGIN_PRIORITY",get:function(){return sye}}]),e}(Lt);function ty(t){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?ty=function(e){return typeof e}:ty=function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ty(t)}function cye(t,r){return yye(t)||pye(t,r)||dye(t,r)||hye()}function hye(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function dye(t,r){if(!!t){if(typeof t=="string")return tP(t,r);var e=Object.prototype.toString.call(t).slice(8,-1);if(e==="Object"&&t.constructor&&(e=t.constructor.name),e==="Map"||e==="Set")return Array.from(t);if(e==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return tP(t,r)}}function tP(t,r){(r==null||r>t.length)&&(r=t.length);for(var e=0,n=new Array(r);e<r;e++)n[e]=t[e];return n}function pye(t,r){var e=t==null?null:typeof Symbol!="undefined"&&t[Symbol.iterator]||t["@@iterator"];if(e!=null){var n=[],i=!0,o=!1,a,s;try{for(e=e.call(t);!(i=(a=e.next()).done)&&(n.push(a.value),!(r&&n.length===r));i=!0);}catch(l){o=!0,s=l}finally{try{!i&&e.return!=null&&e.return()}finally{if(o)throw s}}return n}}function yye(t){if(Array.isArray(t))return t}function mye(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}function rP(t,r){for(var e=0;e<r.length;e++){var n=r[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function vye(t,r,e){return r&&rP(t.prototype,r),e&&rP(t,e),t}function _u(){return typeof Reflect!="undefined"&&Reflect.get?_u=Reflect.get:_u=function(r,e,n){var i=gye(r,e);if(!!i){var o=Object.getOwnPropertyDescriptor(i,e);return o.get?o.get.call(arguments.length<3?r:n):o.value}},_u.apply(this,arguments)}function gye(t,r){for(;!Object.prototype.hasOwnProperty.call(t,r)&&(t=Vo(t),t!==null););return t}function bye(t,r){if(typeof r!="function"&&r!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(r&&r.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),r&&vS(t,r)}function vS(t,r){return vS=Object.setPrototypeOf||function(n,i){return n.__proto__=i,n},vS(t,r)}function wye(t){var r=Cye();return function(){var n=Vo(t),i;if(r){var o=Vo(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return _ye(this,i)}}function _ye(t,r){if(r&&(ty(r)==="object"||typeof r=="function"))return r;if(r!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Sye(t)}function Sye(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Cye(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Vo(t){return Vo=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},Vo(t)}var ry="autoRowSize",kye=40,Oye="autoRowSize",Rye=function(t){bye(e,t);var r=wye(e);function e(n){var i;return mye(this,e),i=r.call(this,n),i.rowHeightsMap=void 0,i.headerHeight=null,i.ghostTable=new hS(i.hot),i.samplesGenerator=new GM(function(o,a){var s;return o>=0?s=i.hot.getDataAtCell(o,a):o===-1&&(s=i.hot.getColHeader(a)),{value:s}}),i.firstCalculation=!0,i.inProgress=!1,i.measuredRows=0,i.rowHeightsMap=new $o,i.hot.rowIndexMapper.registerMap(Oye,i.rowHeightsMap),i.addHook("beforeRowResize",function(o,a,s){return i.onBeforeRowResize(o,a,s)}),i}return vye(e,[{key:"isEnabled",value:function(){var i=this.hot.getSettings()[ry];return i===!0||vt(i)}},{key:"enablePlugin",value:function(){var i=this;this.enabled||(this.setSamplingOptions(),this.addHook("afterLoadData",function(){return i.onAfterLoadData()}),this.addHook("beforeChange",function(o){return i.onBeforeChange(o)}),this.addHook("beforeColumnResize",function(){return i.recalculateAllRowsHeight()}),this.addHook("beforeViewRender",function(o){return i.onBeforeViewRender(o)}),this.addHook("modifyRowHeight",function(o,a){return i.getRowHeight(a,o)}),this.addHook("modifyColumnHeaderHeight",function(){return i.getColumnHeaderHeight()}),_u(Vo(e.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){var i=this;this.headerHeight=null,_u(Vo(e.prototype),"disablePlugin",this).call(this),this.addHook("beforeRowResize",function(o,a,s){return i.onBeforeRowResize(o,a,s)})}},{key:"calculateRowsHeight",value:function(){var i=this,o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countRows()-1},a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{from:0,to:this.hot.countCols()-1},s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,l=typeof o=="number"?{from:o,to:o}:o,p=typeof a=="number"?{from:a,to:a}:a;if(this.hot.getColHeader(0)!==null){var d=this.samplesGenerator.generateRowSamples(-1,p);this.ghostTable.addColumnHeadersRow(d.get(-1))}Qe(l.from,l.to,function(g){if(s||i.rowHeightsMap.getValueAtIndex(g)===null){var y=i.samplesGenerator.generateRowSamples(g,p);he(y,function(h){var u=cye(h,2),f=u[0],c=u[1];return i.ghostTable.addRow(f,c)})}}),this.ghostTable.rows.length&&(this.hot.batchExecution(function(){i.ghostTable.getHeights(function(g,y){g<0?i.headerHeight=y:i.rowHeightsMap.setValueAtIndex(i.hot.toPhysicalRow(g),y)})},!0),this.measuredRows=l.to+1,this.ghostTable.clean())}},{key:"calculateAllRowsHeight",value:function(){var i=this,o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countCols()-1},a=0,s=this.hot.countRows()-1,l=null;this.inProgress=!0;var p=function g(){if(!i.hot){Hl(l),i.inProgress=!1;return}i.calculateRowsHeight({from:a,to:Math.min(a+e.CALCULATION_STEP,s)},o),a=a+e.CALCULATION_STEP+1,a<s?l=cb(g):(Hl(l),i.inProgress=!1,i.hot.view.adjustElementsSize(!0),i.hot.view.wt.wtOverlays.leftOverlay.needFullRender&&i.hot.view.wt.wtOverlays.leftOverlay.clone.draw())},d=this.getSyncCalculationLimit();this.firstCalculation&&d>=0&&(this.calculateRowsHeight({from:0,to:d},o),this.firstCalculation=!1,a=d+1),a<s?p():(this.inProgress=!1,this.hot.view.adjustElementsSize(!1))}},{key:"setSamplingOptions",value:function(){var i=this.hot.getSettings()[ry],o=i&&Yt(i,"samplingRatio")?i.samplingRatio:void 0,a=i&&Yt(i,"allowSampleDuplicates")?i.allowSampleDuplicates:void 0;o&&!isNaN(o)&&this.samplesGenerator.setSampleCount(parseInt(o,10)),a&&this.samplesGenerator.setAllowDuplicates(a)}},{key:"recalculateAllRowsHeight",value:function(){Xs(this.hot.view.wt.wtTable.TABLE)&&(this.clearCache(),this.calculateAllRowsHeight())}},{key:"getSyncCalculationLimit",value:function(){var i=this.hot.getSettings()[ry],o=e.SYNC_CALCULATION_LIMIT,a=this.hot.countRows()-1;return vt(i)&&(o=i.syncLimit,m0(o)?o=Ow(a,o):o>>=0),Math.min(o,a)}},{key:"getRowHeight",value:function(i){var o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:void 0,a=i<0?this.headerHeight:this.rowHeightsMap.getValueAtIndex(this.hot.toPhysicalRow(i)),s=o;return a!==null&&a>(o||0)&&(s=a),s}},{key:"getColumnHeaderHeight",value:function(){return this.headerHeight}},{key:"getFirstVisibleRow",value:function(){var i=this.hot.view.wt;return i.wtViewport.rowsVisibleCalculator?i.wtTable.getFirstVisibleRow():i.wtViewport.rowsRenderCalculator?i.wtTable.getFirstRenderedRow():-1}},{key:"getLastVisibleRow",value:function(){var i=this.hot.view.wt;return i.wtViewport.rowsVisibleCalculator?i.wtTable.getLastVisibleRow():i.wtViewport.rowsRenderCalculator?i.wtTable.getLastRenderedRow():-1}},{key:"clearCache",value:function(){this.headerHeight=null,this.rowHeightsMap.init()}},{key:"clearCacheByRange",value:function(i){var o=this,a=typeof i=="number"?{from:i,to:i}:i,s=a.from,l=a.to;this.hot.batchExecution(function(){Qe(Math.min(s,l),Math.max(s,l),function(p){o.rowHeightsMap.setValueAtIndex(p,null)})},!0)}},{key:"isNeedRecalculate",value:function(){return!!un(this.rowHeightsMap.getValues().slice(0,this.measuredRows),function(i){return i===null}).length}},{key:"onBeforeViewRender",value:function(){var i=this.hot.renderCall,o=this.hot.getSettings().fixedRowsBottom,a=this.getFirstVisibleRow(),s=this.getLastVisibleRow();if(!(a===-1||s===-1)){if(this.calculateRowsHeight({from:a,to:s},void 0,i),o){var l=this.hot.countRows()-1;this.calculateRowsHeight({from:l-o,to:l})}this.isNeedRecalculate()&&!this.inProgress&&this.calculateAllRowsHeight()}}},{key:"onBeforeRowMove",value:function(i,o){this.clearCacheByRange({from:i,to:o}),this.calculateAllRowsHeight()}},{key:"onBeforeRowResize",value:function(i,o,a){var s=i;return a&&(this.calculateRowsHeight(o,void 0,!0),s=this.getRowHeight(o)),s}},{key:"onAfterLoadData",value:function(){var i=this;this.hot.view?this.recalculateAllRowsHeight():setTimeout(function(){i.hot&&i.recalculateAllRowsHeight()},0)}},{key:"onBeforeChange",value:function(i){var o=null;i.length===1?o=i[0][0]:i.length>1&&(o={from:i[0][0],to:i[i.length-1][0]}),o!==null&&this.clearCacheByRange(o)}},{key:"destroy",value:function(){this.ghostTable.clean(),_u(Vo(e.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return ry}},{key:"PLUGIN_PRIORITY",get:function(){return kye}},{key:"CALCULATION_STEP",get:function(){return 50}},{key:"SYNC_CALCULATION_LIMIT",get:function(){return 500}}]),e}(Lt);function ny(t){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?ny=function(e){return typeof e}:ny=function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ny(t)}function Eye(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}function nP(t,r){for(var e=0;e<r.length;e++){var n=r[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function Tye(t,r,e){return r&&nP(t.prototype,r),e&&nP(t,e),t}function Wf(){return typeof Reflect!="undefined"&&Reflect.get?Wf=Reflect.get:Wf=function(r,e,n){var i=xye(r,e);if(!!i){var o=Object.getOwnPropertyDescriptor(i,e);return o.get?o.get.call(arguments.length<3?r:n):o.value}},Wf.apply(this,arguments)}function xye(t,r){for(;!Object.prototype.hasOwnProperty.call(t,r)&&(t=Ba(t),t!==null););return t}function Aye(t,r){if(typeof r!="function"&&r!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(r&&r.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),r&&gS(t,r)}function gS(t,r){return gS=Object.setPrototypeOf||function(n,i){return n.__proto__=i,n},gS(t,r)}function Mye(t){var r=Dye();return function(){var n=Ba(t),i;if(r){var o=Ba(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return Pye(this,i)}}function Pye(t,r){if(r&&(ny(r)==="object"||typeof r=="function"))return r;if(r!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Iye(t)}function Iye(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Dye(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Ba(t){return Ba=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},Ba(t)}var iP=qA("physicallyIndexed"),Nye=iP.getListWithInsertedItems,$ye=iP.getListWithRemovedItems,jye=function(t){Aye(e,t);var r=Mye(e);function e(){return Eye(this,e),r.call(this,function(n){return n})}return Tye(e,[{key:"insert",value:function(i,o){var a=e1(this.indexedValues,o);this.indexedValues=Nye(a,i,o,this.initValueOrFn),Wf(Ba(e.prototype),"insert",this).call(this,i,o)}},{key:"remove",value:function(i){var o=$ye(this.indexedValues,i);this.indexedValues=Qw(o,i),Wf(Ba(e.prototype),"remove",this).call(this,i)}}]),e}(Ma),Lye=jye;function iy(t){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?iy=function(e){return typeof e}:iy=function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},iy(t)}function Hye(t){return Wye(t)||Vye(t)||Bye(t)||Fye()}function Fye(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Bye(t,r){if(!!t){if(typeof t=="string")return bS(t,r);var e=Object.prototype.toString.call(t).slice(8,-1);if(e==="Object"&&t.constructor&&(e=t.constructor.name),e==="Map"||e==="Set")return Array.from(t);if(e==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return bS(t,r)}}function Vye(t){if(typeof Symbol!="undefined"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function Wye(t){if(Array.isArray(t))return bS(t)}function bS(t,r){(r==null||r>t.length)&&(r=t.length);for(var e=0,n=new Array(r);e<r;e++)n[e]=t[e];return n}function Uye(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}function oP(t,r){for(var e=0;e<r.length;e++){var n=r[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function zye(t,r,e){return r&&oP(t.prototype,r),e&&oP(t,e),t}function Uf(){return typeof Reflect!="undefined"&&Reflect.get?Uf=Reflect.get:Uf=function(r,e,n){var i=Yye(r,e);if(!!i){var o=Object.getOwnPropertyDescriptor(i,e);return o.get?o.get.call(arguments.length<3?r:n):o.value}},Uf.apply(this,arguments)}function Yye(t,r){for(;!Object.prototype.hasOwnProperty.call(t,r)&&(t=Va(t),t!==null););return t}function Gye(t,r){if(typeof r!="function"&&r!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(r&&r.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),r&&wS(t,r)}function wS(t,r){return wS=Object.setPrototypeOf||function(n,i){return n.__proto__=i,n},wS(t,r)}function Kye(t){var r=Zye();return function(){var n=Va(t),i;if(r){var o=Va(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return qye(this,i)}}function qye(t,r){if(r&&(iy(r)==="object"||typeof r=="function"))return r;if(r!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Xye(t)}function Xye(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Zye(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Va(t){return Va=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},Va(t)}var aP=qA("physicallyIndexed"),Jye=aP.getListWithInsertedItems,Qye=aP.getListWithRemovedItems,eme=function(t){Gye(e,t);var r=Kye(e);function e(){return Uye(this,e),r.call(this,function(n){return n})}return zye(e,[{key:"insert",value:function(i,o){var a=this;this.indexedValues=Jye(this.indexedValues,i,o,function(s,l){return a.getNextValue(l)}),Uf(Va(e.prototype),"insert",this).call(this,i,o)}},{key:"remove",value:function(i){this.indexedValues=Qye(this.indexedValues,i),Uf(Va(e.prototype),"remove",this).call(this,i)}},{key:"getNextValue",value:function(i){return Math.max.apply(Math,Hye(this.getValues()))+1+i}}]),e}(Ma),tme=eme;function oy(t){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?oy=function(e){return typeof e}:oy=function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},oy(t)}function rme(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}function sP(t,r){for(var e=0;e<r.length;e++){var n=r[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function nme(t,r,e){return r&&sP(t.prototype,r),e&&sP(t,e),t}function Su(){return typeof Reflect!="undefined"&&Reflect.get?Su=Reflect.get:Su=function(r,e,n){var i=ime(r,e);if(!!i){var o=Object.getOwnPropertyDescriptor(i,e);return o.get?o.get.call(arguments.length<3?r:n):o.value}},Su.apply(this,arguments)}function ime(t,r){for(;!Object.prototype.hasOwnProperty.call(t,r)&&(t=Wo(t),t!==null););return t}function ome(t,r){if(typeof r!="function"&&r!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(r&&r.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),r&&_S(t,r)}function _S(t,r){return _S=Object.setPrototypeOf||function(n,i){return n.__proto__=i,n},_S(t,r)}function ame(t){var r=lme();return function(){var n=Wo(t),i;if(r){var o=Wo(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return sme(this,i)}}function sme(t,r){if(r&&(oy(r)==="object"||typeof r=="function"))return r;if(r!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return ume(t)}function ume(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function lme(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Wo(t){return Wo=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},Wo(t)}var SS="bindRowsWithHeaders",fme=210,cme="loose",hme=new Map([["loose",Lye],["strict",tme]]),dme=function(t){ome(e,t);var r=ame(e);function e(n){var i;return rme(this,e),i=r.call(this,n),i.headerIndexes=null,i}return nme(e,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[SS]}},{key:"enablePlugin",value:function(){var i=this;if(!this.enabled){var o=this.hot.getSettings()[SS];typeof o!="string"&&(o=cme);var a=hme.get(o);this.headerIndexes=this.hot.rowIndexMapper.registerMap("bindRowsWithHeaders",new a),this.addHook("modifyRowHeader",function(s){return i.onModifyRowHeader(s)}),Su(Wo(e.prototype),"enablePlugin",this).call(this)}}},{key:"disablePlugin",value:function(){this.hot.rowIndexMapper.unregisterMap("bindRowsWithHeaders"),Su(Wo(e.prototype),"disablePlugin",this).call(this)}},{key:"onModifyRowHeader",value:function(i){return this.headerIndexes.getValueAtIndex(this.hot.toPhysicalRow(i))}},{key:"destroy",value:function(){Su(Wo(e.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return SS}},{key:"PLUGIN_PRIORITY",get:function(){return fme}}]),e}(Lt);function ay(t){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?ay=function(e){return typeof e}:ay=function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ay(t)}function uP(t){return vme(t)||mme(t)||yme(t)||pme()}function pme(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function yme(t,r){if(!!t){if(typeof t=="string")return CS(t,r);var e=Object.prototype.toString.call(t).slice(8,-1);if(e==="Object"&&t.constructor&&(e=t.constructor.name),e==="Map"||e==="Set")return Array.from(t);if(e==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return CS(t,r)}}function mme(t){if(typeof Symbol!="undefined"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function vme(t){if(Array.isArray(t))return CS(t)}function CS(t,r){(r==null||r>t.length)&&(r=t.length);for(var e=0,n=new Array(r);e<r;e++)n[e]=t[e];return n}function gme(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}function lP(t,r){for(var e=0;e<r.length;e++){var n=r[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function bme(t,r,e){return r&&lP(t.prototype,r),e&&lP(t,e),t}function Wa(){return typeof Reflect!="undefined"&&Reflect.get?Wa=Reflect.get:Wa=function(r,e,n){var i=wme(r,e);if(!!i){var o=Object.getOwnPropertyDescriptor(i,e);return o.get?o.get.call(arguments.length<3?r:n):o.value}},Wa.apply(this,arguments)}function wme(t,r){for(;!Object.prototype.hasOwnProperty.call(t,r)&&(t=Ni(t),t!==null););return t}function _me(t,r){if(typeof r!="function"&&r!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(r&&r.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),r&&kS(t,r)}function kS(t,r){return kS=Object.setPrototypeOf||function(n,i){return n.__proto__=i,n},kS(t,r)}function Sme(t){var r=kme();return function(){var n=Ni(t),i;if(r){var o=Ni(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return Cme(this,i)}}function Cme(t,r){if(r&&(ay(r)==="object"||typeof r=="function"))return r;if(r!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Cu(t)}function Cu(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function kme(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Ni(t){return Ni=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},Ni(t)}function Ome(t,r,e){Rme(t,r),r.set(t,e)}function Rme(t,r){if(r.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function OS(t,r,e){return r in t?Object.defineProperty(t,r,{value:e,enumerable:!0,configurable:!0,writable:!0}):t[r]=e,t}function fP(t,r){var e=cP(t,r,"get");return Eme(t,e)}function Eme(t,r){return r.get?r.get.call(t):r.value}function RS(t,r,e){var n=cP(t,r,"set");return Tme(t,n,e),e}function cP(t,r,e){if(!r.has(t))throw new TypeError("attempted to "+e+" private field on non-instance");return r.get(t)}function Tme(t,r,e){if(r.set)r.set.call(t,e);else{if(!r.writable)throw new TypeError("attempted to set read only private field");r.value=e}}var hP="collapsibleColumns",xme=290,dP=new Map([["collapse",{hideColumn:!0,beforeHook:"beforeColumnCollapse",afterHook:"afterColumnCollapse"}],["expand",{hideColumn:!1,beforeHook:"beforeColumnExpand",afterHook:"afterColumnExpand"}]]),ku=new WeakMap,Ame=function(t){_me(e,t);var r=Sme(e);function e(){var n;gme(this,e);for(var i=arguments.length,o=new Array(i),a=0;a<i;a++)o[a]=arguments[a];return n=r.call.apply(r,[this].concat(o)),OS(Cu(n),"nestedHeadersPlugin",null),OS(Cu(n),"eventManager",new Wt(Cu(n))),OS(Cu(n),"headerStateManager",null),Ome(Cu(n),ku,{writable:!0,value:null}),n}return bme(e,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[hP]}},{key:"enablePlugin",value:function(){var i=this;if(!this.enabled){var o=this.hot.getSettings(),a=o.nestedHeaders;a||tr("You need to configure the Nested Headers plugin in order to use collapsible headers."),RS(this,ku,this.hot.columnIndexMapper.createAndRegisterIndexMap(this.pluginName,"hiding")),this.nestedHeadersPlugin=this.hot.getPlugin("nestedHeaders"),this.headerStateManager=this.nestedHeadersPlugin.getStateManager(),this.addHook("init",function(){return i.onInit()}),this.addHook("afterLoadData",function(){return i.onAfterLoadData.apply(i,arguments)}),this.addHook("afterGetColHeader",function(s,l){return i.onAfterGetColHeader(s,l)}),this.addHook("beforeOnCellMouseDown",function(s,l,p){return i.onBeforeOnCellMouseDown(s,l,p)}),Wa(Ni(e.prototype),"enablePlugin",this).call(this),this.updatePlugin()}}},{key:"updatePlugin",value:function(){if(!!this.hot.view){if(!this.nestedHeadersPlugin.detectedOverlappedHeaders){var i=this.hot.getSettings(),o=i.collapsibleColumns;typeof o=="boolean"?this.headerStateManager.mapState(function(a){return{collapsible:a.origColspan>1}}):Array.isArray(o)&&this.headerStateManager.mergeStateWith(o)}Wa(Ni(e.prototype),"updatePlugin",this).call(this)}}},{key:"disablePlugin",value:function(){this.hot.columnIndexMapper.unregisterMap(this.pluginName),RS(this,ku,null),this.nestedHeadersPlugin=null,this.clearButtons(),Wa(Ni(e.prototype),"disablePlugin",this).call(this)}},{key:"clearButtons",value:function(){if(!!this.hot.view){var i=this.hot.view.wt.getSetting("columnHeaders").length,o=this.hot.view.wt.wtTable.THEAD,a=this.hot.view.wt.wtOverlays.topOverlay.clone.wtTable.THEAD,s=this.hot.view.wt.wtOverlays.topLeftCornerOverlay?this.hot.view.wt.wtOverlays.topLeftCornerOverlay.clone.wtTable.THEAD:null,l=function(d){d&&d.parentNode.removeChild(d)};Qe(0,i-1,function(p){var d=o.childNodes[p],g=a.childNodes[p],y=s?s.childNodes[p]:null;Qe(0,d.childNodes.length-1,function(h){var u=d.childNodes[h].querySelector(".collapsibleIndicator");l(u),g&&g.childNodes[h]&&(u=g.childNodes[h].querySelector(".collapsibleIndicator"),l(u)),s&&y&&y.childNodes[h]&&(u=y.childNodes[h].querySelector(".collapsibleIndicator"),l(u))})})}}},{key:"expandSection",value:function(i){this.toggleCollapsibleSection([i],"expand")}},{key:"collapseSection",value:function(i){this.toggleCollapsibleSection([i],"collapse")}},{key:"toggleAllCollapsibleSections",value:function(i){var o=this,a=this.headerStateManager.mapNodes(function(s){var l=s.collapsible,p=s.origColspan,d=s.headerLevel,g=s.columnIndex;if(l===!0&&p>1)return{row:o.headerStateManager.levelToRowCoords(d),col:g}});this.toggleCollapsibleSection(a,i)}},{key:"collapseAll",value:function(){this.toggleAllCollapsibleSections("collapse")}},{key:"expandAll",value:function(){this.toggleAllCollapsibleSections("expand")}},{key:"toggleCollapsibleSection",value:function(i,o){var a=this;if(!dP.has(o))throw new Error("Unsupported action is passed (".concat(o,")."));if(!!Array.isArray(i)){var s=un(i,function(c){var v=c.row;return v<0}),l=s.length>0;he(s,function(c){var v,m=c.row,b=c.col,w=(v=a.headerStateManager.getHeaderSettings(m,b))!==null&&v!==void 0?v:{},_=w.collapsible,C=w.isCollapsed;if(!_||C&&o==="collapse"||!C&&o==="expand")return l=!1,!1});var p=[],d=[];l&&he(s,function(c){var v=c.row,m=c.col,b=a.headerStateManager.triggerNodeModification(o,v,m),w=b.colspanCompensation,_=b.affectedColumns,C=b.rollbackModification;w>0&&(d.push.apply(d,uP(_)),p.push(C))});var g=this.getCollapsedColumns(),y=[];o==="collapse"?y=Ob([].concat(uP(g),d)):o==="expand"&&(y=un(g,function(c){return!d.includes(c)}));var h=dP.get(o),u=this.hot.runHooks(h.beforeHook,g,y,l);if(u===!1){he(p,function(c){c()});return}this.hot.batchExecution(function(){he(d,function(c){fP(a,ku).setValueAtIndex(a.hot.toPhysicalColumn(c),h.hideColumn)})},!0);var f=this.getCollapsedColumns().length!==g.length;this.hot.runHooks(h.afterHook,g,y,l,f),this.hot.render(),this.hot.view.adjustElementsSize(!0)}}},{key:"getCollapsedColumns",value:function(){return fP(this,ku).getHiddenIndexes()}},{key:"generateIndicator",value:function(i,o){var a=this.hot.rootDocument.createElement("div"),s=this.headerStateManager.getHeaderSettings(i,o);return Ie(a,"collapsibleIndicator"),s.isCollapsed?(Ie(a,"collapsed"),Mo(a,"+")):(Ie(a,"expanded"),Mo(a,"-")),a}},{key:"onAfterGetColHeader",value:function(i,o){var a,s=o.parentNode,l=s.parentNode,p=-1*l.childNodes.length+Array.prototype.indexOf.call(l.childNodes,s),d=(a=this.headerStateManager.getHeaderSettings(p,i))!==null&&a!==void 0?a:{},g=d.collapsible,y=d.origColspan;if(g&&y>1&&i>=this.hot.getSettings().fixedColumnsLeft){var h=this.generateIndicator(p,i);o.querySelector("div:first-child").appendChild(h)}}},{key:"onBeforeOnCellMouseDown",value:function(i,o){lt(i.target,"collapsibleIndicator")&&(lt(i.target,"expanded")?(this.eventManager.fireEvent(i.target,"mouseup"),this.toggleCollapsibleSection([o],"collapse")):lt(i.target,"collapsed")&&(this.eventManager.fireEvent(i.target,"mouseup"),this.toggleCollapsibleSection([o],"expand")),rr(i))}},{key:"onInit",value:function(){this.updatePlugin()}},{key:"onAfterLoadData",value:function(i,o){o||this.updatePlugin()}},{key:"destroy",value:function(){RS(this,ku,null),Wa(Ni(e.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return hP}},{key:"PLUGIN_PRIORITY",get:function(){return xme}},{key:"PLUGIN_DEPS",get:function(){return["plugin:NestedHeaders"]}}]),e}(Lt);function pP(t,r){var e=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);r&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),e.push.apply(e,n)}return e}function Mme(t){for(var r=1;r<arguments.length;r++){var e=arguments[r]!=null?arguments[r]:{};r%2?pP(Object(e),!0).forEach(function(n){Pme(t,n,e[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(e)):pP(Object(e)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(e,n))})}return t}function Pme(t,r,e){return r in t?Object.defineProperty(t,r,{value:e,enumerable:!0,configurable:!0,writable:!0}):t[r]=e,t}function yP(t,r){return $me(t)||Nme(t,r)||Dme(t,r)||Ime()}function Ime(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Dme(t,r){if(!!t){if(typeof t=="string")return mP(t,r);var e=Object.prototype.toString.call(t).slice(8,-1);if(e==="Object"&&t.constructor&&(e=t.constructor.name),e==="Map"||e==="Set")return Array.from(t);if(e==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return mP(t,r)}}function mP(t,r){(r==null||r>t.length)&&(r=t.length);for(var e=0,n=new Array(r);e<r;e++)n[e]=t[e];return n}function Nme(t,r){var e=t==null?null:typeof Symbol!="undefined"&&t[Symbol.iterator]||t["@@iterator"];if(e!=null){var n=[],i=!0,o=!1,a,s;try{for(e=e.call(t);!(i=(a=e.next()).done)&&(n.push(a.value),!(r&&n.length===r));i=!0);}catch(l){o=!0,s=l}finally{try{!i&&e.return!=null&&e.return()}finally{if(o)throw s}}return n}}function $me(t){if(Array.isArray(t))return t}function jme(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}function vP(t,r){for(var e=0;e<r.length;e++){var n=r[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function Lme(t,r,e){return r&&vP(t.prototype,r),e&&vP(t,e),t}var Hme=["sortEmptyCells","indicator","headerAction","compareFunctionFactory"],Fme=!1,Bme=!0,Vme=!0,Wme=function(){function t(r,e){jme(this,t),this.hot=r,this.sortingStates=new up,this.sortEmptyCells=Fme,this.indicator=Bme,this.headerAction=Vme,this.compareFunctionFactory=void 0,this.mapName=e,this.hot.columnIndexMapper.registerMap(e,this.sortingStates)}return Lme(t,[{key:"updateAllColumnsProperties",value:function(e){var n=this;!vt(e)||Ot(e,function(i,o){Hme.includes(o)&&(n[o]=i)})}},{key:"getAllColumnsProperties",value:function(){var e={sortEmptyCells:this.sortEmptyCells,indicator:this.indicator,headerAction:this.headerAction};return typeof this.compareFunctionFactory=="function"&&(e.compareFunctionFactory=this.compareFunctionFactory),e}},{key:"getSortOrderOfColumn",value:function(e){var n;return(n=this.sortingStates.getValueAtIndex(this.hot.toPhysicalColumn(e)))===null||n===void 0?void 0:n.sortOrder}},{key:"getIndexOfColumnInSortQueue",value:function(e){return e=this.hot.toPhysicalColumn(e),this.sortingStates.getEntries().findIndex(function(n){var i=yP(n,1),o=i[0];return o===e})}},{key:"getNumberOfSortedColumns",value:function(){return this.sortingStates.getLength()}},{key:"isListOfSortedColumnsEmpty",value:function(){return this.getNumberOfSortedColumns()===0}},{key:"isColumnSorted",value:function(e){return vt(this.sortingStates.getValueAtIndex(this.hot.toPhysicalColumn(e)))}},{key:"getSortStates",value:function(){var e=this;if(this.sortingStates===null)return[];var n=this.sortingStates.getEntries();return n.map(function(i){var o=yP(i,2),a=o[0],s=o[1];return Mme({column:e.hot.toVisualColumn(a)},s)})}},{key:"getColumnSortState",value:function(e){var n=this.getSortOrderOfColumn(e);if(at(n))return{column:e,sortOrder:n}}},{key:"setSortStates",value:function(e){this.sortingStates.clear();for(var n=0;n<e.length;n+=1)this.sortingStates.setValueAtIndex(this.hot.toPhysicalColumn(e[n].column),{sortOrder:e[n].sortOrder})}},{key:"destroy",value:function(){this.hot.columnIndexMapper.unregisterMap(this.mapName),this.sortingStates=null}}]),t}(),sy="asc",uy="desc",Ume="colHeader";function zme(t){if(vt(t)===!1)return!1;var r=t.column,e=t.sortOrder;return Number.isInteger(r)&&[sy,uy].includes(e)}function Yme(t){if(t.some(function(e){return zme(e)===!1}))return!1;var r=t.map(function(e){var n=e.column;return n});return new Set(r).size===r.length}function gP(t){if(t!==uy)return t===sy?uy:sy}function bP(t){var r=t.querySelector(".".concat(Ume));return r}function wP(t,r){if(t<0||!r.parentNode)return!1;var e=r.parentNode.parentNode.childNodes,n=Array.from(e).indexOf(r.parentNode)-e.length;return n===-1}function ES(t,r,e){return t===-1&&r>=0&&Do(e)===!1}var Gme="ascending",Kme="descending",_P="indicatorDisabled",SP="columnSorting",CP="sortAction",kP=new Map([[sy,Gme],[uy,Kme]]);function qme(t,r,e,n){var i=[SP];if(n&&i.push(CP),e===!1)return i.push(_P),i;var o=t.getSortOrderOfColumn(r);return at(o)&&i.push(kP.get(o)),i}function Xme(){return Array.from(kP.values()).concat(CP,_P,SP)}function OP(t,r,e){var n=r.locale;return function(i,o){var a=e.sortEmptyCells;return typeof i=="string"&&(i=i.toLocaleLowerCase(n)),typeof o=="string"&&(o=o.toLocaleLowerCase(n)),i===o?ai:Or(i)?Or(o)?ai:a&&t==="asc"?cr:hr:Or(o)?a&&t==="asc"?hr:cr:isNaN(i)&&!isNaN(o)?t==="asc"?hr:cr:!isNaN(i)&&isNaN(o)||(isNaN(i)||isNaN(o)||(i=parseFloat(i),o=parseFloat(o)),i<o)?t==="asc"?cr:hr:i>o?t==="asc"?hr:cr:ai}}var RP="default";function Zme(t,r,e){return function(n,i){var o=parseFloat(n),a=parseFloat(i),s=e.sortEmptyCells;if(o===a||isNaN(o)&&isNaN(a))return ai;if(s){if(Or(n))return t==="asc"?cr:hr;if(Or(i))return t==="asc"?hr:cr}return isNaN(o)?hr:isNaN(a)?cr:o<a?t==="asc"?cr:hr:o>a?t==="asc"?hr:cr:ai}}var Jme="numeric";function Qme(t,r,e){var n=r.checkedTemplate,i=r.uncheckedTemplate,o=e.sortEmptyCells;return function(a,s){var l=Or(a),p=Or(s),d=l?i:a,g=p?i:s,y=d===i||d===n,h=g===i||g===n;if(o===!1){if(l&&p===!1)return hr;if(l===!1&&p)return cr}return y===!1&&h?t==="asc"?cr:hr:y&&h===!1?t==="asc"?hr:cr:y===!1&&h===!1?OP(t,r,e)(a,s):d===i&&g===n?t==="asc"?cr:hr:d===n&&g===i?t==="asc"?hr:cr:ai}}var eve="checkbox";function tve(t,r,e){return function(n,i){var o=e.sortEmptyCells;if(n===i)return ai;if(Or(n))return Or(i)?ai:o&&t==="asc"?cr:hr;if(Or(i))return o&&t==="asc"?hr:cr;var a=r.dateFormat,s=$e(n,a),l=$e(i,a);return s.isValid()?l.isValid()?l.isAfter(s)?t==="asc"?cr:hr:l.isBefore(s)?t==="asc"?hr:cr:ai:cr:hr}}var rve="date",TS=Rn("sorting.compareFunctionFactory"),ly=TS.register,EP=TS.getItem,nve=TS.hasItem,TP=Rn("sorting.mainSortComparator"),xP=TP.register,ive=TP.getItem;function AP(t){return nve(t)?EP(t):EP(RP)}ly(Jme,Zme);ly(eve,Qme);ly(rve,tve);ly(RP,OP);function MP(t,r){for(var e=0;e<r.length;e++){var n=r[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function ove(t,r,e){return r&&MP(t.prototype,r),e&&MP(t,e),t}function PP(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}var IP=function t(r){PP(this,t),this.data=r,this.next=null,this.prev=null},ave=function(){function t(){PP(this,t),this.first=null,this.last=null}return ove(t,[{key:"push",value:function(e){var n=new IP(e);if(this.first===null)this.first=n,this.last=n;else{var i=this.last;this.last=n,n.prev=i,i.next=n}}},{key:"unshift",value:function(e){var n=new IP(e);if(this.first===null)this.first=n,this.last=n;else{var i=this.first;this.first=n,n.next=i,i.prev=n}}},{key:"inorder",value:function(e){for(var n=this.first;n;)e(n),n=n.next}},{key:"remove",value:function(e){if(this.first===null)return!1;for(var n=this.first,i,o;n;){if(n.data===e)return i=n.next,o=n.prev,i&&(i.prev=o),o&&(o.next=i),n===this.first&&(this.first=i),n===this.last&&(this.last=o),!0;n=n.next}return!1}},{key:"hasCycle",value:function(){for(var e=this.first,n=this.first;;){if(e===null||(e=e.next,e===null))return!1;if(e=e.next,n=n.next,e===n)return!0}}},{key:"pop",value:function(){if(this.last===null)return null;var e=this.last;return this.last=this.last.prev,e}},{key:"shift",value:function(){if(this.first===null)return null;var e=this.first;return this.first=this.first.next,e}},{key:"recursiveReverse",value:function(){function e(i,o){!o||(e(o,o.next),o.next=i)}if(!!this.first){e(this.first,this.first.next),this.first.next=null;var n=this.first;this.first=this.last,this.last=n}}},{key:"reverse",value:function(){if(!(!this.first||!this.first.next)){for(var e=this.first.next,n=this.first,i;e;)i=e.next,e.next=n,n.prev=e,n=e,e=i;this.first.next=null,this.last.prev=null,i=this.first,this.first=n,this.last=i}}}]),t}(),DP=ave,sve=function(r,e){var n=r.toString(),i=e.toString();return n===i?0:n<i?-1:1};function xS(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:sve,e=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,n=arguments.length>3&&arguments[3]!==void 0?arguments[3]:t.length;if(Math.abs(n-e)<=1)return[];var i=Math.ceil((e+n)/2);return xS(t,r,e,i),xS(t,r,i,n),uve(t,r,e,i,n)}function uve(t,r,e,n,i){for(var o=new DP,a=new DP,s=n-e,l=i-n,p=Math.max(s,l),d=i-e,g=0;g<p;g+=1)g<s&&o.push(t[e+g]),g<l&&a.push(t[n+g]);for(var y=0;y<d;)o.first&&a.first?r(o.first.data,a.first.data)>0?t[e+y]=a.shift().data:t[e+y]=o.shift().data:o.first?t[e+y]=o.shift().data:t[e+y]=a.shift().data,y+=1;return t}var ai=0,cr=-1,hr=1;function lve(t,r){for(var e=ive(r),n=arguments.length,i=new Array(n>2?n-2:0),o=2;o<n;o++)i[o-2]=arguments[o];xS(t,e.apply(void 0,i))}function NP(t){return dve(t)||hve(t)||cve(t)||fve()}function fve(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function cve(t,r){if(!!t){if(typeof t=="string")return $P(t,r);var e=Object.prototype.toString.call(t).slice(8,-1);if(e==="Object"&&t.constructor&&(e=t.constructor.name),e==="Map"||e==="Set")return Array.from(t);if(e==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return $P(t,r)}}function $P(t,r){(r==null||r>t.length)&&(r=t.length);for(var e=0,n=new Array(r);e<r;e++)n[e]=t[e];return n}function hve(t){if(typeof Symbol!="undefined"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function dve(t){if(Array.isArray(t))return t}function pve(t,r){return function(e,n){var i=NP(e),o=i.slice(1),a=NP(n),s=a.slice(1);return function(p){var d=t[p],g=r[p],y=o[p],h=s[p],u=g.columnSorting,f=u.compareFunctionFactory?u.compareFunctionFactory:AP(g.type),c=f(d,g,u)(y,h);return c}(0)}}function fy(t){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?fy=function(e){return typeof e}:fy=function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},fy(t)}var yve=["column"],mve=["column"];function Ou(t){return wve(t)||bve(t)||gve(t)||vve()}function vve(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function gve(t,r){if(!!t){if(typeof t=="string")return AS(t,r);var e=Object.prototype.toString.call(t).slice(8,-1);if(e==="Object"&&t.constructor&&(e=t.constructor.name),e==="Map"||e==="Set")return Array.from(t);if(e==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return AS(t,r)}}function bve(t){if(typeof Symbol!="undefined"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function wve(t){if(Array.isArray(t))return AS(t)}function AS(t,r){(r==null||r>t.length)&&(r=t.length);for(var e=0,n=new Array(r);e<r;e++)n[e]=t[e];return n}function jP(t,r){var e=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);r&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),e.push.apply(e,n)}return e}function LP(t){for(var r=1;r<arguments.length;r++){var e=arguments[r]!=null?arguments[r]:{};r%2?jP(Object(e),!0).forEach(function(n){_ve(t,n,e[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(e)):jP(Object(e)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(e,n))})}return t}function _ve(t,r,e){return r in t?Object.defineProperty(t,r,{value:e,enumerable:!0,configurable:!0,writable:!0}):t[r]=e,t}function HP(t,r){if(t==null)return{};var e=Sve(t,r),n,i;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);for(i=0;i<o.length;i++)n=o[i],!(r.indexOf(n)>=0)&&(!Object.prototype.propertyIsEnumerable.call(t,n)||(e[n]=t[n]))}return e}function Sve(t,r){if(t==null)return{};var e={},n=Object.keys(t),i,o;for(o=0;o<n.length;o++)i=n[o],!(r.indexOf(i)>=0)&&(e[i]=t[i]);return e}function Cve(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}function FP(t,r){for(var e=0;e<r.length;e++){var n=r[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function kve(t,r,e){return r&&FP(t.prototype,r),e&&FP(t,e),t}function Ua(){return typeof Reflect!="undefined"&&Reflect.get?Ua=Reflect.get:Ua=function(r,e,n){var i=Ove(r,e);if(!!i){var o=Object.getOwnPropertyDescriptor(i,e);return o.get?o.get.call(arguments.length<3?r:n):o.value}},Ua.apply(this,arguments)}function Ove(t,r){for(;!Object.prototype.hasOwnProperty.call(t,r)&&(t=$i(t),t!==null););return t}function Rve(t,r){if(typeof r!="function"&&r!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(r&&r.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),r&&MS(t,r)}function MS(t,r){return MS=Object.setPrototypeOf||function(n,i){return n.__proto__=i,n},MS(t,r)}function Eve(t){var r=Ave();return function(){var n=$i(t),i;if(r){var o=$i(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return Tve(this,i)}}function Tve(t,r){if(r&&(fy(r)==="object"||typeof r=="function"))return r;if(r!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return xve(t)}function xve(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Ave(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function $i(t){return $i=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},$i(t)}var PS="columnSorting",Mve=50,BP="append",Pve="replace";xP(PS,pve);Ze.getSingleton().register("beforeColumnSort");Ze.getSingleton().register("afterColumnSort");var VP=function(t){Rve(e,t);var r=Eve(e);function e(n){var i;return Cve(this,e),i=r.call(this,n),i.columnStatesManager=null,i.columnMetaCache=null,i.pluginKey=PS,i.indexesSequenceCache=null,i}return kve(e,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[this.pluginKey]}},{key:"enablePlugin",value:function(){var i=this;this.enabled||(this.columnStatesManager=new Wme(this.hot,"".concat(this.pluginKey,".sortingStates")),this.columnMetaCache=new $o(function(o){var a=i.hot.toVisualColumn(o);return a===null&&(a=o),i.getMergedPluginSettings(a)}),this.hot.columnIndexMapper.registerMap("".concat(this.pluginKey,".columnMeta"),this.columnMetaCache),this.addHook("afterGetColHeader",function(o,a){return i.onAfterGetColHeader(o,a)}),this.addHook("beforeOnCellMouseDown",function(){return i.onBeforeOnCellMouseDown.apply(i,arguments)}),this.addHook("afterOnCellMouseDown",function(o,a){return i.onAfterOnCellMouseDown(o,a)}),this.addHook("afterInit",function(){return i.loadOrSortBySettings()}),this.addHook("afterLoadData",function(o,a){return i.onAfterLoadData(a)}),this.hot.view&&this.loadOrSortBySettings(),Ua($i(e.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){var i=this,o=function(s,l){var p=bP(l);wP(s,l)===!1||p===null||i.updateHeaderClasses(p)};this.hot.addHook("afterGetColHeader",o),this.hot.addHookOnce("afterViewRender",function(){i.hot.removeHook("afterGetColHeader",o)}),this.hot.batchExecution(function(){i.indexesSequenceCache!==null&&(i.hot.rowIndexMapper.setIndexesSequence(i.indexesSequenceCache.getValues()),i.hot.rowIndexMapper.unregisterMap(i.pluginKey))},!0),this.hot.columnIndexMapper.unregisterMap("".concat(this.pluginKey,".columnMeta")),this.columnStatesManager.destroy(),this.columnMetaCache=null,this.columnStatesManager=null,Ua($i(e.prototype),"disablePlugin",this).call(this)}},{key:"sort",value:function(i){var o=this.getSortConfig(),a=this.getNormalizedSortConfigs(i),s=this.areValidSortConfigs(a),l=this.hot.runHooks("beforeColumnSort",o,a,s);l!==!1&&(o.length===0&&this.indexesSequenceCache===null&&(this.indexesSequenceCache=this.hot.rowIndexMapper.registerMap(this.pluginKey,new ZA),this.indexesSequenceCache.setValues(this.hot.rowIndexMapper.getIndexesSequence())),s&&(this.columnStatesManager.setSortStates(a),this.sortByPresetSortStates(a),this.saveAllSortSettings(a)),this.hot.runHooks("afterColumnSort",o,s?a:o,s),s&&(this.hot.render(),this.hot.forceFullRender=!1,this.hot.view.render()))}},{key:"clearSort",value:function(){this.sort([])}},{key:"isSorted",value:function(){return this.enabled&&!this.columnStatesManager.isListOfSortedColumnsEmpty()}},{key:"getSortConfig",value:function(i){return at(i)?this.columnStatesManager.getColumnSortState(i):this.columnStatesManager.getSortStates()}},{key:"setSortConfig",value:function(i){var o=this.getNormalizedSortConfigs(i);this.areValidSortConfigs(o)&&this.columnStatesManager.setSortStates(o)}},{key:"getNormalizedSortConfigs",value:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return Array.isArray(i)?i.slice(0,1):[i]}},{key:"areValidSortConfigs",value:function(i){var o=this.hot.countCols();return Yme(i)&&i.every(function(a){var s=a.column;return s<=o&&s>=0})}},{key:"saveAllSortSettings",value:function(i){var o=this,a=this.columnStatesManager.getAllColumnsProperties(),s=function(p){var d=p.column,g=HP(p,yve);return LP({column:o.hot.toPhysicalColumn(d)},g)};a.initialConfig=bt(i,s),this.hot.runHooks("persistentStateSave","columnSorting",a)}},{key:"getAllSavedSortSettings",value:function(){var i=this,o={};this.hot.runHooks("persistentStateLoad","columnSorting",o);var a=o.value,s=function(p){var d=p.column,g=HP(p,mve);return LP({column:i.hot.toVisualColumn(d)},g)};return at(a)&&Array.isArray(a.initialConfig)&&(a.initialConfig=bt(a.initialConfig,s)),a}},{key:"getColumnNextConfig",value:function(i){var o=this.columnStatesManager.getSortOrderOfColumn(i);if(at(o)){var a=gP(o);return at(a)?{column:i,sortOrder:a}:void 0}var s=this.hot.countCols();if(Number.isInteger(i)&&i>=0&&i<s)return{column:i,sortOrder:gP()}}},{key:"getNextSortConfig",value:function(i){var o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:BP,a=this.columnStatesManager.getIndexOfColumnInSortQueue(i),s=a!==-1,l=this.getSortConfig(),p=this.getColumnNextConfig(i);if(s){if(er(p))return[].concat(Ou(l.slice(0,a)),Ou(l.slice(a+1)));if(o===BP)return[].concat(Ou(l.slice(0,a)),Ou(l.slice(a+1)),[p]);if(o===Pve)return[].concat(Ou(l.slice(0,a)),[p],Ou(l.slice(a+1)))}return at(p)?l.concat(p):l}},{key:"getPluginColumnConfig",value:function(i){if(vt(i)){var o=i[this.pluginKey];if(vt(o))return o}return{}}},{key:"getMergedPluginSettings",value:function(i){var o=this.hot.getSettings()[this.pluginKey],a=this.columnStatesManager.getAllColumnsProperties(),s=this.hot.getCellMeta(0,i),l=Object.getPrototypeOf(s);return Array.isArray(l.columns)?Object.assign(a,o,this.getPluginColumnConfig(l.columns[i])):qt(l.columns)?Object.assign(a,o,this.getPluginColumnConfig(l.columns(i))):Object.assign(a,o)}},{key:"getFirstCellSettings",value:function(i){var o=this.hot.getCellMeta(0,i),a=Object.create(o);return a[this.pluginKey]=this.columnMetaCache.getValueAtIndex(this.hot.toPhysicalColumn(i)),a}},{key:"getNumberOfRowsToSort",value:function(i){var o=this.hot.getSettings();return o.maxRows<=i?o.maxRows:i-o.minSpareRows}},{key:"sortByPresetSortStates",value:function(i){var o=this;if(i.length===0){this.hot.rowIndexMapper.setIndexesSequence(this.indexesSequenceCache.getValues());return}for(var a=[],s=this.hot.countRows(),l=function(c){return bt(i,function(v){return o.hot.getDataAtCell(c,v.column)})},p=0;p<this.getNumberOfRowsToSort(s);p+=1)a.push([this.hot.toPhysicalRow(p)].concat(l(p)));var d=bt(a,function(f){return f[0]});lve(a,this.pluginKey,bt(i,function(f){return f.sortOrder}),bt(i,function(f){return o.getFirstCellSettings(f.column)}));for(var g=a.length;g<s;g+=1)a.push([g].concat(l(g)));var y=bt(a,function(f){return f[0]}),h=new Map(bt(d,function(f,c){return[f,y[c]]})),u=bt(this.hot.rowIndexMapper.getIndexesSequence(),function(f){return h.has(f)?h.get(f):f});this.hot.rowIndexMapper.setIndexesSequence(u)}},{key:"loadOrSortBySettings",value:function(){var i=this.getAllSavedSortSettings();if(vt(i))this.sortBySettings(i);else{var o=this.hot.getSettings()[this.pluginKey];this.sortBySettings(o)}}},{key:"sortBySettings",value:function(i){if(vt(i)){this.columnStatesManager.updateAllColumnsProperties(i);var o=i.initialConfig;(Array.isArray(o)||vt(o))&&this.sort(o)}else this.hot.render()}},{key:"onAfterGetColHeader",value:function(i,o){var a=bP(o);if(!(wP(i,o)===!1||a===null)){var s=this.getFirstCellSettings(i)[this.pluginKey],l=s.indicator,p=s.headerAction;this.updateHeaderClasses(a,this.columnStatesManager,i,l,p)}}},{key:"updateHeaderClasses",value:function(i){if(dt(i,Xme()),this.enabled!==!1){for(var o=arguments.length,a=new Array(o>1?o-1:0),s=1;s<o;s++)a[s-1]=arguments[s];Ie(i,qme.apply(void 0,a))}}},{key:"onUpdateSettings",value:function(i){Ua($i(e.prototype),"onUpdateSettings",this).call(this),this.columnMetaCache!==null&&this.columnMetaCache.init(this.hot.columnIndexMapper.getNumberOfIndexes()),at(i[this.pluginKey])&&this.sortBySettings(i[this.pluginKey])}},{key:"onAfterLoadData",value:function(i){i===!0&&this.hot.view&&this.loadOrSortBySettings()}},{key:"wasClickableHeaderClicked",value:function(i,o){var a=this.getFirstCellSettings(o)[this.pluginKey],s=a.headerAction;return s&&i.target.nodeName==="SPAN"}},{key:"onBeforeOnCellMouseDown",value:function(i,o,a,s){ES(o.row,o.col,i)!==!1&&this.wasClickableHeaderClicked(i,o.col)&&Cp()&&(s.column=!0)}},{key:"onAfterOnCellMouseDown",value:function(i,o){ES(o.row,o.col,i)!==!1&&this.wasClickableHeaderClicked(i,o.col)&&(Cp()&&(this.hot.deselectCell(),this.hot.selectColumns(o.col)),this.sort(this.getColumnNextConfig(o.col)))}},{key:"destroy",value:function(){var i;(i=this.columnStatesManager)===null||i===void 0||i.destroy(),Ua($i(e.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return PS}},{key:"PLUGIN_PRIORITY",get:function(){return Mve}}]),e}(Lt),Ive=pt,WP=ot,IS=ht,Dve=mo,Nve=a2,$ve=$T,UP=Mt,jve=WP.RangeError,zP=WP.String,YP=Math.floor,DS=IS($ve),GP=IS("".slice),zf=IS(1 .toFixed),Ru=function(t,r,e){return r===0?e:r%2==1?Ru(t,r-1,e*t):Ru(t*t,r/2,e)},Lve=function(t){for(var r=0,e=t;e>=4096;)r+=12,e/=4096;for(;e>=2;)r+=1,e/=2;return r},Eu=function(t,r,e){for(var n=-1,i=e;++n<6;)i+=r*t[n],t[n]=i%1e7,i=YP(i/1e7)},NS=function(t,r){for(var e=6,n=0;--e>=0;)n+=t[e],t[e]=YP(n/r),n=n%r*1e7},KP=function(t){for(var r=6,e="";--r>=0;)if(e!==""||r===0||t[r]!==0){var n=zP(t[r]);e=e===""?n:e+DS("0",7-n.length)+n}return e},Hve=UP(function(){return zf(8e-5,3)!=="0.000"||zf(.9,0)!=="1"||zf(1.255,2)!=="1.25"||zf(1000000000000000100,0)!=="1000000000000000128"})||!UP(function(){zf({})});Ive({target:"Number",proto:!0,forced:Hve},{toFixed:function(r){var e=Nve(this),n=Dve(r),i=[0,0,0,0,0,0],o="",a="0",s,l,p,d;if(n<0||n>20)throw jve("Incorrect fraction digits");if(e!=e)return"NaN";if(e<=-1e21||e>=1e21)return zP(e);if(e<0&&(o="-",e=-e),e>1e-21)if(s=Lve(e*Ru(2,69,1))-69,l=s<0?e*Ru(2,-s,1):e/Ru(2,s,1),l*=4503599627370496,s=52-s,s>0){for(Eu(i,0,l),p=n;p>=7;)Eu(i,1e7,0),p-=7;for(Eu(i,Ru(10,p,1),0),p=s-1;p>=23;)NS(i,1<<23),p-=23;NS(i,1<<p),Eu(i,1,1),NS(i,2),a=KP(i)}else Eu(i,0,l),Eu(i,1<<-s,0),a=KP(i)+DS("0",n);return n>0?(d=a.length,a=o+(d<=n?"0."+DS("0",n-d)+a:GP(a,0,d-n)+"."+GP(a,d-n))):a=o+a,a}});function Fve(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}function qP(t,r){for(var e=0;e<r.length;e++){var n=r[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function Bve(t,r,e){return r&&qP(t.prototype,r),e&&qP(t,e),t}var Vve=function(){function t(r,e){Fve(this,t),this.plugin=r,this.hot=this.plugin.hot,this.endpoints=[],this.settings=e,this.settingsType="array",this.currentEndpoint=null,this.cellsToSetCache=[]}return Bve(t,[{key:"getEndpoint",value:function(e){return this.settingsType==="function"?this.fillMissingEndpointData(this.settings)[e]:this.endpoints[e]}},{key:"getAllEndpoints",value:function(){return this.settingsType==="function"?this.fillMissingEndpointData(this.settings):this.endpoints}},{key:"fillMissingEndpointData",value:function(e){return this.parseSettings(e.call(this))}},{key:"parseSettings",value:function(e){var n=this,i=[],o=e;if(!o&&typeof this.settings=="function"){this.settingsType="function";return}return o||(o=this.settings),he(o,function(a){var s={};n.assignSetting(a,s,"ranges",[[0,n.hot.countRows()-1]]),n.assignSetting(a,s,"reversedRowCoords",!1),n.assignSetting(a,s,"destinationRow",new Error(`
        You must provide a destination row for the Column Summary plugin in order to work properly!
      `)),n.assignSetting(a,s,"destinationColumn",new Error(`
        You must provide a destination column for the Column Summary plugin in order to work properly!
      `)),n.assignSetting(a,s,"sourceColumn",a.destinationColumn),n.assignSetting(a,s,"type","sum"),n.assignSetting(a,s,"forceNumeric",!1),n.assignSetting(a,s,"suppressDataTypeErrors",!0),n.assignSetting(a,s,"suppressDataTypeErrors",!0),n.assignSetting(a,s,"customFunction",null),n.assignSetting(a,s,"readOnly",!0),n.assignSetting(a,s,"roundFloat",!1),i.push(s)}),i}},{key:"assignSetting",value:function(e,n,i,o){if(i==="ranges"&&e[i]===void 0){n[i]=o;return}else if(i==="ranges"&&e[i].length===0)return;if(e[i]===void 0){if(o instanceof Error)throw o;n[i]=o}else i==="destinationRow"&&n.reversedRowCoords?n[i]=this.hot.countRows()-e[i]-1:n[i]=e[i]}},{key:"resetSetupBeforeStructureAlteration",value:function(e,n,i){if(this.settingsType==="function"){var o=e.indexOf("row")>-1?"row":"col",a=this.getAllEndpoints();he(a,function(s){o==="row"&&s.destinationRow>=n&&(e==="insert_row"?s.alterRowOffset=i:e==="remove_row"&&(s.alterRowOffset=-1*i)),o==="col"&&s.destinationColumn>=n&&(e==="insert_col"?s.alterColumnOffset=i:e==="remove_col"&&(s.alterColumnOffset=-1*i))}),this.resetAllEndpoints(a,!1)}}},{key:"resetSetupAfterStructureAlteration",value:function(e,n,i,o,a){var s=this,l=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!0;if(this.settingsType==="function"){var p=function f(){return s.hot.removeHook("beforeViewRender",f),s.refreshAllEndpoints()};this.hot.addHookOnce("beforeViewRender",p);return}var d=e.indexOf("row")>-1?"row":"col",g=e.indexOf("remove")>-1?-1:1,y=this.getAllEndpoints(),h=e.indexOf("move_row")===0,u=n;he(y,function(f){d==="row"&&f.destinationRow>=u&&(f.alterRowOffset=g*i),d==="col"&&f.destinationColumn>=u&&(f.alterColumnOffset=g*i)}),this.resetAllEndpoints(y,!h),h?he(y,function(f){s.extendEndpointRanges(f,u,o[0],o.length),s.recreatePhysicalRanges(f),s.clearOffsetInformation(f)}):he(y,function(f){s.shiftEndpointCoordinates(f,u)}),l&&this.refreshAllEndpoints()}},{key:"clearOffsetInformation",value:function(e){e.alterRowOffset=void 0,e.alterColumnOffset=void 0}},{key:"extendEndpointRanges",value:function(e,n,i,o){he(e.ranges,function(a){a[1]&&(n>=a[0]&&n<=a[1]?i>a[1]?a[1]+=o:i<a[0]&&(a[0]-=o):i>=a[0]&&i<=a[1]&&(a[1]-=o,n<=a[0]&&(a[0]+=1,a[1]+=1)))})}},{key:"recreatePhysicalRanges",value:function(e){var n=this,i=e.ranges,o=[],a=[];he(i,function(s){var l=[];if(s[1])for(var p=s[0];p<=s[1];p++)l.push(n.hot.toPhysicalRow(p));else l.push(n.hot.toPhysicalRow(s[0]));a.push(l)}),he(a,function(s){var l=[];he(s,function(p,d){d===0?l.push(p):s[d]!==s[d-1]+1&&(l.push(s[d-1]),o.push(l),l=[],l.push(p)),d===s.length-1&&(l.push(p),o.push(l))})}),e.ranges=o}},{key:"shiftEndpointCoordinates",value:function(e,n){e.alterRowOffset&&e.alterRowOffset!==0?(e.destinationRow+=e.alterRowOffset||0,he(e.ranges,function(i){he(i,function(o,a){o>=n&&(i[a]+=e.alterRowOffset||0)})})):e.alterColumnOffset&&e.alterColumnOffset!==0&&(e.destinationColumn+=e.alterColumnOffset||0,e.sourceColumn+=e.alterColumnOffset||0)}},{key:"resetAllEndpoints",value:function(){var e=this,n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getAllEndpoints(),i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,o=n.some(function(a){var s=a.alterRowOffset||0,l=a.alterColumnOffset||0;return a.destinationRow+s>=e.hot.countRows()||a.destinationColumn+l>=e.hot.countCols()});o||(this.cellsToSetCache=[],he(n,function(a){e.resetEndpointValue(a,i)}),this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[])}},{key:"refreshAllEndpoints",value:function(){var e=this;this.cellsToSetCache=[],he(this.getAllEndpoints(),function(n){e.currentEndpoint=n,e.plugin.calculate(n),e.setEndpointValue(n,"init")}),this.currentEndpoint=null,this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[]}},{key:"refreshChangedEndpoints",value:function(e){var n=this,i=[];this.cellsToSetCache=[],he(e,function(o,a,s){"".concat(o[2]||"")!=="".concat(o[3])&&he(n.getAllEndpoints(),function(l,p){n.hot.propToCol(s[a][1])===l.sourceColumn&&i.indexOf(p)===-1&&i.push(p)})}),he(i,function(o){n.refreshEndpoint(n.getEndpoint(o))}),this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[]}},{key:"refreshEndpoint",value:function(e){this.currentEndpoint=e,this.plugin.calculate(e),this.setEndpointValue(e),this.currentEndpoint=null}},{key:"resetEndpointValue",value:function(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,i=e.alterRowOffset||0,o=e.alterColumnOffset||0,a=[this.hot.toVisualRow(e.destinationRow),this.hot.toVisualColumn(e.destinationColumn)],s=a[0],l=a[1];if(l!==null&&s!==null){var p=this.hot.getCellMeta(s,l);p.readOnly=!1,p.className=""}this.cellsToSetCache.push([this.hot.toVisualRow(e.destinationRow+(n?i:0)),this.hot.toVisualColumn(e.destinationColumn+(n?o:0)),""])}},{key:"setEndpointValue",value:function(e,n){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,o=-1*e.alterRowOffset||0,a=-1*e.alterColumnOffset||0,s=this.hot.toVisualRow(e.destinationRow);if(e.destinationRow>=this.hot.countRows()||e.destinationColumn>=this.hot.countCols()){this.throwOutOfBoundsWarning();return}var l=this.hot.toVisualRow(e.destinationRow+o);if(l!==null){var p=this.hot.getCellMeta(l,e.destinationColumn+a);(n==="init"||p.readOnly!==e.readOnly)&&(p.readOnly=e.readOnly,p.className="columnSummaryResult")}e.roundFloat&&!isNaN(e.result)&&(e.result=e.result.toFixed(e.roundFloat)),i?this.hot.setDataAtCell(s,e.destinationColumn,e.result,"ColumnSummary.set"):this.cellsToSetCache.push([s,e.destinationColumn,e.result]),e.alterRowOffset=void 0,e.alterColumnOffset=void 0}},{key:"throwOutOfBoundsWarning",value:function(){tr("One of the Column Summary plugins' destination points you provided is beyond the table boundaries!")}}]),t}(),Wve=Vve;function cy(t){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?cy=function(e){return typeof e}:cy=function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},cy(t)}var XP;function Uve(t,r){return r||(r=t.slice(0)),Object.freeze(Object.defineProperties(t,{raw:{value:Object.freeze(r)}}))}function zve(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}function ZP(t,r){for(var e=0;e<r.length;e++){var n=r[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function Yve(t,r,e){return r&&ZP(t.prototype,r),e&&ZP(t,e),t}function hy(){return typeof Reflect!="undefined"&&Reflect.get?hy=Reflect.get:hy=function(r,e,n){var i=Gve(r,e);if(!!i){var o=Object.getOwnPropertyDescriptor(i,e);return o.get?o.get.call(arguments.length<3?r:n):o.value}},hy.apply(this,arguments)}function Gve(t,r){for(;!Object.prototype.hasOwnProperty.call(t,r)&&(t=Tu(t),t!==null););return t}function Kve(t,r){if(typeof r!="function"&&r!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(r&&r.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),r&&$S(t,r)}function $S(t,r){return $S=Object.setPrototypeOf||function(n,i){return n.__proto__=i,n},$S(t,r)}function qve(t){var r=Jve();return function(){var n=Tu(t),i;if(r){var o=Tu(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return Xve(this,i)}}function Xve(t,r){if(r&&(cy(r)==="object"||typeof r=="function"))return r;if(r!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Zve(t)}function Zve(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Jve(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Tu(t){return Tu=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},Tu(t)}var jS="columnSummary",Qve=220,ege=function(t){Kve(e,t);var r=qve(e);function e(n){var i;return zve(this,e),i=r.call(this,n),i.endpoints=null,i}return Yve(e,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[jS]}},{key:"enablePlugin",value:function(){var i=this;this.enabled||(this.settings=this.hot.getSettings()[jS],this.endpoints=new Wve(this,this.settings),this.addHook("afterInit",function(){return i.onAfterInit.apply(i,arguments)}),this.addHook("afterChange",function(){return i.onAfterChange.apply(i,arguments)}),this.addHook("beforeCreateRow",function(o,a,s){return i.endpoints.resetSetupBeforeStructureAlteration("insert_row",o,a,null,s)}),this.addHook("beforeCreateCol",function(o,a,s){return i.endpoints.resetSetupBeforeStructureAlteration("insert_col",o,a,null,s)}),this.addHook("beforeRemoveRow",function(){for(var o,a=arguments.length,s=new Array(a),l=0;l<a;l++)s[l]=arguments[l];return(o=i.endpoints).resetSetupBeforeStructureAlteration.apply(o,["remove_row"].concat(s))}),this.addHook("beforeRemoveCol",function(){for(var o,a=arguments.length,s=new Array(a),l=0;l<a;l++)s[l]=arguments[l];return(o=i.endpoints).resetSetupBeforeStructureAlteration.apply(o,["remove_col"].concat(s))}),this.addHook("afterCreateRow",function(o,a,s){return i.endpoints.resetSetupAfterStructureAlteration("insert_row",o,a,null,s)}),this.addHook("afterCreateCol",function(o,a,s){return i.endpoints.resetSetupAfterStructureAlteration("insert_col",o,a,null,s)}),this.addHook("afterRemoveRow",function(){for(var o,a=arguments.length,s=new Array(a),l=0;l<a;l++)s[l]=arguments[l];return(o=i.endpoints).resetSetupAfterStructureAlteration.apply(o,["remove_row"].concat(s))}),this.addHook("afterRemoveCol",function(){for(var o,a=arguments.length,s=new Array(a),l=0;l<a;l++)s[l]=arguments[l];return(o=i.endpoints).resetSetupAfterStructureAlteration.apply(o,["remove_col"].concat(s))}),this.addHook("afterRowMove",function(){return i.onAfterRowMove.apply(i,arguments)}),hy(Tu(e.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){this.endpoints=null,this.settings=null,this.currentEndpoint=null}},{key:"calculate",value:function(i){switch(i.type.toLowerCase()){case"sum":i.result=this.calculateSum(i);break;case"min":i.result=this.calculateMinMax(i,i.type);break;case"max":i.result=this.calculateMinMax(i,i.type);break;case"count":i.result=this.countEntries(i);break;case"average":i.result=this.calculateAverage(i);break;case"custom":i.result=i.customFunction.call(this,i);break}}},{key:"calculateSum",value:function(i){var o=this,a=0;return Ot(i.ranges,function(s){a+=o.getPartialSum(s,i.sourceColumn)}),a}},{key:"getPartialSum",value:function(i,o){var a=0,s=i[1]||i[0],l=null,p=0;do{l=this.getCellValue(s,o)||0;var d=("".concat(l).split(".")[1]||[]).length||1;d>p&&(p=d),a+=l||0,s-=1}while(s>=i[0]);return Math.round(a*Math.pow(10,p))/Math.pow(10,p)}},{key:"calculateMinMax",value:function(i,o){var a=this,s=null;return Ot(i.ranges,function(l){var p=a.getPartialMinMax(l,i.sourceColumn,o);if(s===null&&p!==null&&(s=p),p!==null)switch(o){case"min":s=Math.min(s,p);break;case"max":s=Math.max(s,p);break}}),s===null?"Not enough data":s}},{key:"getPartialMinMax",value:function(i,o,a){var s=null,l=i[1]||i[0],p;do{if(p=this.getCellValue(l,o)||null,s===null)s=p;else if(p!==null)switch(a){case"min":s=Math.min(s,p);break;case"max":s=Math.max(s,p);break}l-=1}while(l>=i[0]);return s}},{key:"countEmpty",value:function(i,o){var a,s=0,l=i[1]||i[0];do a=this.getCellValue(l,o),a||(s+=1),l-=1;while(l>=i[0]);return s}},{key:"countEntries",value:function(i){var o=this,a=0,s=i.ranges;return Ot(s,function(l){var p=l[1]===void 0?1:l[1]-l[0]+1,d=o.countEmpty(l,i.sourceColumn);a+=p,a-=d}),a}},{key:"calculateAverage",value:function(i){var o=this.calculateSum(i),a=this.countEntries(i);return o/a}},{key:"getCellValue",value:function(i,o){var a=this.hot.toVisualRow(i),s=this.hot.toVisualColumn(o),l=this.hot.getSourceDataAtCell(i,o),p="";if(a!==null&&s!==null&&(p=this.hot.getCellMeta(a,s).className||""),p.indexOf("columnSummaryResult")>-1)return null;if(this.endpoints.currentEndpoint.forceNumeric&&(typeof l=="string"&&(l=l.replace(/,/,".")),l=parseFloat(l)),isNaN(l)&&!this.endpoints.currentEndpoint.suppressDataTypeErrors)throw new Error(Kt(XP||(XP=Uve(["ColumnSummary plugin: cell at (",", ",`) is not in a 
          numeric format. Cannot do the calculation.`],["ColumnSummary plugin: cell at (",", ",`) is not in a\\x20
          numeric format. Cannot do the calculation.`])),i,o));return l}},{key:"onAfterInit",value:function(){this.endpoints.endpoints=this.endpoints.parseSettings(),this.endpoints.refreshAllEndpoints(!0)}},{key:"onAfterChange",value:function(i,o){i&&o!=="ColumnSummary.reset"&&o!=="ColumnSummary.set"&&o!=="loadData"&&this.endpoints.refreshChangedEndpoints(i)}},{key:"onAfterRowMove",value:function(i,o){this.endpoints.resetSetupBeforeStructureAlteration("move_row",i[0],i.length,i,this.pluginName),this.endpoints.resetSetupAfterStructureAlteration("move_row",o,i.length,i,this.pluginName)}}],[{key:"PLUGIN_KEY",get:function(){return jS}},{key:"PLUGIN_PRIORITY",get:function(){return Qve}}]),e}(Lt);function tge(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}function JP(t,r){for(var e=0;e<r.length;e++){var n=r[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function rge(t,r,e){return r&&JP(t.prototype,r),e&&JP(t,e),t}var nge=function(){function t(r){tge(this,t),this.container=null,this.rootDocument=r,this.editor=this.createEditor(),this.editorStyle=this.editor.style,this.hidden=!0,this.hide()}return rge(t,[{key:"setPosition",value:function(e,n){this.editorStyle.left="".concat(e,"px"),this.editorStyle.top="".concat(n,"px")}},{key:"setSize",value:function(e,n){if(e&&n){var i=this.getInputElement();i.style.width="".concat(e,"px"),i.style.height="".concat(n,"px")}}},{key:"resetSize",value:function(){var e=this.getInputElement();e.style.width="",e.style.height=""}},{key:"setReadOnlyState",value:function(e){var n=this.getInputElement();n.readOnly=e}},{key:"show",value:function(){this.editorStyle.display="block",this.hidden=!1}},{key:"hide",value:function(){this.editorStyle.display="none",this.hidden=!0}},{key:"isVisible",value:function(){return this.editorStyle.display==="block"}},{key:"setValue",value:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",n=e||"";this.getInputElement().value=n}},{key:"getValue",value:function(){return this.getInputElement().value}},{key:"isFocused",value:function(){return this.rootDocument.activeElement===this.getInputElement()}},{key:"focus",value:function(){this.getInputElement().focus()}},{key:"createEditor",value:function(){var e=this.rootDocument.createElement("div"),n=this.rootDocument.createElement("textarea");return this.container=this.rootDocument.createElement("div"),Ie(this.container,t.CLASS_EDITOR_CONTAINER),this.rootDocument.body.appendChild(this.container),Ie(e,t.CLASS_EDITOR),Ie(n,t.CLASS_INPUT),e.appendChild(n),this.container.appendChild(e),e}},{key:"getInputElement",value:function(){return this.editor.querySelector(".".concat(t.CLASS_INPUT))}},{key:"destroy",value:function(){var e=this.container?this.container.parentNode:null;this.editor.parentNode.removeChild(this.editor),this.editor=null,this.editorStyle=null,e&&e.removeChild(this.container)}}],[{key:"CLASS_EDITOR_CONTAINER",get:function(){return"htCommentsContainer"}},{key:"CLASS_EDITOR",get:function(){return"htComments"}},{key:"CLASS_INPUT",get:function(){return"htCommentTextArea"}},{key:"CLASS_CELL",get:function(){return"htCommentCell"}}]),t}(),ige=nge,St="---------";function oge(){return{name:St}}function age(t){return bt(t,function(r){return{start:r.getTopLeftCorner(),end:r.getBottomRightCorner()}})}function dy(t){return lt(t,"htSeparator")}function sge(t){return lt(t,"htSubmenu")}function py(t){return lt(t,"htDisabled")}function yy(t){return lt(t,"htSelectionDisabled")}function za(t){var r=t.getSelected();return!r||r[0]<0?null:r}function uge(t,r){if(t.indexOf(r)!==-1)return t;var e=t.replace("htTop","").replace("htMiddle","").replace("htBottom","").replace("  ","");return"".concat(e," ").concat(r)}function lge(t,r){if(t.indexOf(r)!==-1)return t;var e=t.replace("htLeft","").replace("htCenter","").replace("htRight","").replace("htJustify","").replace("  ","");return"".concat(e," ").concat(r)}function Ya(t,r){var e={};return he(t,function(n){n.forAll(function(i,o){i>=0&&o>=0&&(e[i]||(e[i]=[]),e[i][o]=r(i,o))})}),e}function Uo(t,r,e,n,i){he(t,function(o){o.forAll(function(a,s){a>=0&&s>=0&&fge(a,s,r,e,n,i)})})}function fge(t,r,e,n,i,o){var a=i(t,r),s=n;a.className&&(e==="vertical"?s=uge(a.className,n):s=lge(a.className,n)),o(t,r,"className",s)}function si(t,r){var e=!1;return Array.isArray(t)&&he(t,function(n){return n.forAll(function(i,o){if(i>=0&&o>=0&&r(i,o))return e=!0,!1}),e}),e}function ji(t){return'<span class="selected">'.concat(String.fromCharCode(10003),"</span>").concat(t)}function cge(t,r){return!t.hidden||!(typeof t.hidden=="function"&&t.hidden.call(r))}function QP(t,r){for(var e=t.slice(0),n=0;n<e.length&&e[n].name===r;)e.shift();return e}function hge(t,r){var e=t.slice(0);return e.reverse(),e=QP(e,r),e.reverse(),e}function dge(t){var r=[];return he(t,function(e,n){n>0?r[r.length-1].name!==e.name&&r.push(e):r.push(e)}),r}function pge(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:St,e=t.slice(0);return e=QP(e,r),e=hge(e,r),e=dge(e),e}function yge(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}function e5(t,r){for(var e=0;e<r.length;e++){var n=r[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function mge(t,r,e){return r&&e5(t.prototype,r),e&&e5(t,e),t}var vge=250,gge=250,t5=function(){function t(r){yge(this,t),this.wasLastActionShow=!0,this.showDebounced=null,this.hidingTimer=null,this.updateDelay(r)}return mge(t,[{key:"hide",value:function(){var e=this;this.wasLastActionShow=!1,this.hidingTimer=setTimeout(function(){e.wasLastActionShow===!1&&e.runLocalHooks("hide")},gge)}},{key:"show",value:function(e){this.wasLastActionShow=!0,this.showDebounced(e)}},{key:"cancelHiding",value:function(){this.wasLastActionShow=!0,clearTimeout(this.hidingTimer),this.hidingTimer=null}},{key:"updateDelay",value:function(){var e=this,n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:vge;this.showDebounced=A0(function(i){e.wasLastActionShow&&e.runLocalHooks("show",i.from.row,i.from.col)},n)}},{key:"destroy",value:function(){this.clearLocalHooks()}}]),t}();Ut(t5,nn);var bge=t5;function my(t){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?my=function(e){return typeof e}:my=function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},my(t)}function LS(t,r,e){return r in t?Object.defineProperty(t,r,{value:e,enumerable:!0,configurable:!0,writable:!0}):t[r]=e,t}function wge(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}function r5(t,r){for(var e=0;e<r.length;e++){var n=r[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function _ge(t,r,e){return r&&r5(t.prototype,r),e&&r5(t,e),t}function Ga(){return typeof Reflect!="undefined"&&Reflect.get?Ga=Reflect.get:Ga=function(r,e,n){var i=Sge(r,e);if(!!i){var o=Object.getOwnPropertyDescriptor(i,e);return o.get?o.get.call(arguments.length<3?r:n):o.value}},Ga.apply(this,arguments)}function Sge(t,r){for(;!Object.prototype.hasOwnProperty.call(t,r)&&(t=Li(t),t!==null););return t}function Cge(t,r){if(typeof r!="function"&&r!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(r&&r.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),r&&HS(t,r)}function HS(t,r){return HS=Object.setPrototypeOf||function(n,i){return n.__proto__=i,n},HS(t,r)}function kge(t){var r=Rge();return function(){var n=Li(t),i;if(r){var o=Li(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return Oge(this,i)}}function Oge(t,r){if(r&&(my(r)==="object"||typeof r=="function"))return r;if(r!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return n5(t)}function n5(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Rge(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Li(t){return Li=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},Li(t)}var FS="comments",Ege=60,vy=new WeakMap,ui="comment",xu="value",i5="style",gy="readOnly",Tge=function(t){Cge(e,t);var r=kge(e);function e(n){var i;return wge(this,e),i=r.call(this,n),i.editor=null,i.displaySwitch=null,i.eventManager=null,i.range={},i.mouseDown=!1,i.contextMenuEvent=!1,i.timer=null,vy.set(n5(i),{tempEditorDimensions:{},cellBelowCursor:null}),i}return _ge(e,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[FS]}},{key:"enablePlugin",value:function(){var i=this;this.enabled||(this.editor||(this.editor=new ige(this.hot.rootDocument)),this.eventManager||(this.eventManager=new Wt(this)),this.displaySwitch||(this.displaySwitch=new bge(this.getDisplayDelaySetting())),this.addHook("afterContextMenuDefaultOptions",function(o){return i.addToContextMenu(o)}),this.addHook("afterRenderer",function(o,a,s,l,p,d){return i.onAfterRenderer(o,d)}),this.addHook("afterScrollHorizontally",function(){return i.hide()}),this.addHook("afterScrollVertically",function(){return i.hide()}),this.addHook("afterBeginEditing",function(){return i.onAfterBeginEditing()}),this.displaySwitch.addLocalHook("hide",function(){return i.hide()}),this.displaySwitch.addLocalHook("show",function(o,a){return i.showAtCell(o,a)}),this.registerListeners(),Ga(Li(e.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),Ga(Li(e.prototype),"updatePlugin",this).call(this),this.displaySwitch.updateDelay(this.getDisplayDelaySetting())}},{key:"disablePlugin",value:function(){Ga(Li(e.prototype),"disablePlugin",this).call(this)}},{key:"registerListeners",value:function(){var i=this,o=this.hot.rootDocument;this.eventManager.addEventListener(o,"mouseover",function(a){return i.onMouseOver(a)}),this.eventManager.addEventListener(o,"mousedown",function(a){return i.onMouseDown(a)}),this.eventManager.addEventListener(o,"mouseup",function(){return i.onMouseUp()}),this.eventManager.addEventListener(this.editor.getInputElement(),"blur",function(){return i.onEditorBlur()}),this.eventManager.addEventListener(this.editor.getInputElement(),"mousedown",function(a){return i.onEditorMouseDown(a)}),this.eventManager.addEventListener(this.editor.getInputElement(),"mouseup",function(a){return i.onEditorMouseUp(a)})}},{key:"setRange",value:function(i){this.range=i}},{key:"clearRange",value:function(){this.range={}}},{key:"targetIsCellWithComment",value:function(i){var o=Ti(i.target,"TD","TBODY");return!!(o&&lt(o,"htCommentCell")&&Ti(o,[this.hot.rootElement]))}},{key:"targetIsCommentTextArea",value:function(i){return this.editor.getInputElement()===i.target}},{key:"setComment",value:function(i){if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');var o=this.editor.getValue(),a="";i!=null?a=i:o!=null&&(a=o);var s=this.range.from.row,l=this.range.from.col;this.updateCommentMeta(s,l,LS({},xu,a)),this.hot.render()}},{key:"setCommentAtCell",value:function(i,o,a){this.setRange({from:new ke(i,o)}),this.setComment(a)}},{key:"removeComment",value:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');this.hot.setCellMeta(this.range.from.row,this.range.from.col,ui),i&&this.hot.render(),this.hide()}},{key:"removeCommentAtCell",value:function(i,o){var a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;this.setRange({from:new ke(i,o)}),this.removeComment(a)}},{key:"getComment",value:function(){var i=this.range.from.row,o=this.range.from.col;return this.getCommentMeta(i,o,xu)}},{key:"getCommentAtCell",value:function(i,o){return this.getCommentMeta(i,o,xu)}},{key:"show",value:function(){if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');var i=this.range.from,o=i.row,a=i.col;if(o<0||o>this.hot.countSourceRows()-1||a<0||a>this.hot.countSourceCols()-1)return!1;var s=this.hot.getCellMeta(this.range.from.row,this.range.from.col);return this.refreshEditor(!0),this.editor.setValue(s[ui]?s[ui][xu]:""),this.editor.hidden&&this.editor.show(),!0}},{key:"showAtCell",value:function(i,o){return this.setRange({from:new ke(i,o)}),this.show()}},{key:"hide",value:function(){this.editor.hidden||this.editor.hide()}},{key:"refreshEditor",value:function(){var i,o,a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(!(!a&&(!this.range.from||!this.editor.isVisible()))){var s=this.hot,l=s.rowIndexMapper,p=s.columnIndexMapper,d=this.range.from,g=d.row,y=d.col,h=l.getRenderableFromVisualIndex(g),u=p.getRenderableFromVisualIndex(y),f=h===null;h===null&&(h=l.getRenderableFromVisualIndex(l.getFirstNotHiddenIndex(g,-1))),u===null&&(u=p.getRenderableFromVisualIndex(p.getFirstNotHiddenIndex(y,-1)));var c=h===null,v=u===null;h=(i=h)!==null&&i!==void 0?i:0,u=(o=u)!==null&&o!==void 0?o:0;var m=this.hot,b=m.rootWindow,w=m.view.wt,_=w.wtTable,C=w.wtOverlays,R=w.wtViewport,I=C.scrollableElement,P=_.getCell({row:h,col:u}),N=ar(P),A=v?0:_.getStretchedColumnWidth(u),$=f&&!c?yr(P):0,T=N.top,M=N.left;R.hasVerticalScroll()&&I!==b&&(T-=C.topOverlay.getScrollPosition()),R.hasHorizontalScroll()&&I!==b&&(M-=C.leftOverlay.getScrollPosition());var S=M+A,E=T+$,k=this.getCommentMeta(g,y,i5),O=this.getCommentMeta(g,y,gy);k?this.editor.setSize(k.width,k.height):this.editor.resetSize(),this.editor.setReadOnlyState(O),this.editor.setPosition(S,E)}}},{key:"checkSelectionCommentsConsistency",value:function(){var i=this.hot.getSelectedRangeLast();if(!i)return!1;var o=!1,a=i.getTopLeftCorner();return this.getCommentMeta(a.row,a.col,xu)&&(o=!0),o}},{key:"updateCommentMeta",value:function(i,o,a){var s=this.hot.getCellMeta(i,o)[ui],l;s?(l=zr(s),Wl(l,a)):l=a,this.hot.setCellMeta(i,o,ui,l)}},{key:"getCommentMeta",value:function(i,o,a){var s=this.hot.getCellMeta(i,o);if(!!s[ui])return s[ui][a]}},{key:"onMouseDown",value:function(i){if(this.mouseDown=!0,!(!this.hot.view||!this.hot.view.wt)){if(!this.contextMenuEvent&&!this.targetIsCommentTextArea(i)){var o=Ti(i.target,"TD","TBODY"),a=null;o&&(a=this.hot.view.wt.wtTable.getCoords(o),a={row:this.hot.rowIndexMapper.getVisualFromRenderableIndex(a.row),col:this.hot.columnIndexMapper.getVisualFromRenderableIndex(a.col)}),(!o||this.range.from&&a&&(this.range.from.row!==a.row||this.range.from.col!==a.col))&&this.hide()}this.contextMenuEvent=!1}}},{key:"onMouseOver",value:function(i){var o=vy.get(this),a=this.hot.rootDocument;if(o.cellBelowCursor=a.elementFromPoint(i.clientX,i.clientY),!(this.mouseDown||this.editor.isFocused()||lt(i.target,"wtBorder")||o.cellBelowCursor!==i.target||!this.editor))if(this.targetIsCellWithComment(i)){var s=this.hot.view.wt.wtTable.getCoords(i.target),l={from:new ke(this.hot.rowIndexMapper.getVisualFromRenderableIndex(s.row),this.hot.columnIndexMapper.getVisualFromRenderableIndex(s.col))};this.displaySwitch.show(l)}else To(i.target,a)&&!this.targetIsCommentTextArea(i)&&this.displaySwitch.hide()}},{key:"onMouseUp",value:function(){this.mouseDown=!1}},{key:"onAfterRenderer",value:function(i,o){o[ui]&&o[ui][xu]&&Ie(i,o.commentedCellClassName)}},{key:"onEditorBlur",value:function(){this.setComment()}},{key:"onEditorMouseDown",value:function(i){var o=vy.get(this);o.tempEditorDimensions={width:sr(i.target),height:yr(i.target)}}},{key:"onEditorMouseUp",value:function(i){var o=vy.get(this),a=sr(i.target),s=yr(i.target);(a!==o.tempEditorDimensions.width+1||s!==o.tempEditorDimensions.height+2)&&this.updateCommentMeta(this.range.from.row,this.range.from.col,LS({},i5,{width:a,height:s}))}},{key:"onContextMenuAddComment",value:function(){var i=this;this.displaySwitch.cancelHiding();var o=this.hot.getSelectedRangeLast();this.contextMenuEvent=!0,this.setRange({from:o.highlight}),this.show(),setTimeout(function(){i.hot&&(i.hot.deselectCell(),i.editor.focus())},10)}},{key:"onContextMenuRemoveComment",value:function(){var i=this,o=this.hot.getSelectedRangeLast();this.contextMenuEvent=!0,o.forAll(function(a,s){a>=0&&s>=0&&i.removeCommentAtCell(a,s,!1)}),this.hot.render()}},{key:"onContextMenuMakeReadOnly",value:function(){var i=this,o=this.hot.getSelectedRangeLast();this.contextMenuEvent=!0,o.forAll(function(a,s){if(a>=0&&s>=0){var l=!!i.getCommentMeta(a,s,gy);i.updateCommentMeta(a,s,LS({},gy,!l))}})}},{key:"addToContextMenu",value:function(i){var o=this,a=function(){return o.hot.rowIndexMapper.getRenderableIndexesLength()>0&&o.hot.columnIndexMapper.getRenderableIndexesLength()>0};i.items.push({name:"---------"},{key:"commentsAddEdit",name:function(){return o.checkSelectionCommentsConsistency()?o.hot.getTranslatedPhrase(x1):o.hot.getTranslatedPhrase(T1)},callback:function(){return o.onContextMenuAddComment()},disabled:function(){return a()?!(o.hot.getSelectedLast()&&!o.hot.selection.isSelectedByCorner()):!0}},{key:"commentsRemove",name:function(){return this.getTranslatedPhrase(A1)},callback:function(){return o.onContextMenuRemoveComment()},disabled:function(){return a()?!(o.hot.getSelectedLast()&&!o.hot.selection.isSelectedByCorner()):!0}},{key:"commentsReadOnly",name:function(){var l=this,p=this.getTranslatedPhrase(M1),d=si(this.getSelectedRangeLast(),function(g,y){var h=l.getCellMeta(g,y)[ui];if(h&&(h=h[gy]),h)return!0});return d&&(p=ji(p)),p},callback:function(){return o.onContextMenuMakeReadOnly()},disabled:function(){return a()?!(o.hot.getSelectedLast()&&!o.hot.selection.isSelectedByCorner())||!o.checkSelectionCommentsConsistency():!0}})}},{key:"getDisplayDelaySetting",value:function(){var i=this.hot.getSettings()[FS];if(vt(i))return i.displayDelay}},{key:"onAfterBeginEditing",value:function(){this.hide()}},{key:"destroy",value:function(){this.editor&&this.editor.destroy(),this.displaySwitch&&this.displaySwitch.destroy(),Ga(Li(e.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return FS}},{key:"PLUGIN_PRIORITY",get:function(){return Ege}}]),e}(Lt);function xge(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}function o5(t,r){for(var e=0;e<r.length;e++){var n=r[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function Age(t,r,e){return r&&o5(t.prototype,r),e&&o5(t,e),t}var Mge=function(){function t(r){xge(this,t),this.hot=r,this.commands={},this.commonCallback=null}return Age(t,[{key:"registerCommand",value:function(e,n){this.commands[e]=n}},{key:"setCommonCallback",value:function(e){this.commonCallback=e}},{key:"execute",value:function(e){for(var n=this,i=arguments.length,o=new Array(i>1?i-1:0),a=1;a<i;a++)o[a-1]=arguments[a];var s=e.split(":"),l=s[0],p=s.length===2?s[1]:null,d=this.commands[l];if(!d)throw new Error("Menu command '".concat(l,"' not exists."));if(p&&d.submenu&&(d=Pge(p,d.submenu.items)),d.disabled!==!0&&!(typeof d.disabled=="function"&&d.disabled.call(this.hot)===!0)&&!Yt(d,"submenu")){var g=[];typeof d.callback=="function"&&g.push(d.callback),typeof this.commonCallback=="function"&&g.push(this.commonCallback),o.unshift(s.join(":")),he(g,function(y){return y.apply(n.hot,o)})}}}]),t}();function Pge(t,r){var e;return he(r,function(n){var i=n.key?n.key.split(":"):null;if(Array.isArray(i)&&i[1]===t)return e=n,!1}),e}var a5=Mge,xn="alignment";function Ige(){return{key:xn,name:function(){return this.getTranslatedPhrase(P1)},disabled:function(){return this.countRows()===0||this.countCols()===0?!0:!(this.getSelectedRange()&&!this.selection.isSelectedByCorner())},submenu:{items:[{key:"".concat(xn,":left"),name:function(){var r=this,e=this.getTranslatedPhrase(I1),n=si(this.getSelectedRange(),function(i,o){var a=r.getCellMeta(i,o).className;if(a&&a.indexOf("htLeft")!==-1)return!0});return n&&(e=ji(e)),e},callback:function(){var r=this,e=this.getSelectedRange(),n=Ya(e,function(a,s){return r.getCellMeta(a,s).className}),i="horizontal",o="htLeft";this.runHooks("beforeCellAlignment",n,e,i,o),Uo(e,i,o,function(a,s){return r.getCellMeta(a,s)},function(a,s,l,p){return r.setCellMeta(a,s,l,p)}),this.render()},disabled:!1},{key:"".concat(xn,":center"),name:function(){var r=this,e=this.getTranslatedPhrase(D1),n=si(this.getSelectedRange(),function(i,o){var a=r.getCellMeta(i,o).className;if(a&&a.indexOf("htCenter")!==-1)return!0});return n&&(e=ji(e)),e},callback:function(){var r=this,e=this.getSelectedRange(),n=Ya(e,function(a,s){return r.getCellMeta(a,s).className}),i="horizontal",o="htCenter";this.runHooks("beforeCellAlignment",n,e,i,o),Uo(e,i,o,function(a,s){return r.getCellMeta(a,s)},function(a,s,l,p){return r.setCellMeta(a,s,l,p)}),this.render()},disabled:!1},{key:"".concat(xn,":right"),name:function(){var r=this,e=this.getTranslatedPhrase(N1),n=si(this.getSelectedRange(),function(i,o){var a=r.getCellMeta(i,o).className;if(a&&a.indexOf("htRight")!==-1)return!0});return n&&(e=ji(e)),e},callback:function(){var r=this,e=this.getSelectedRange(),n=Ya(e,function(a,s){return r.getCellMeta(a,s).className}),i="horizontal",o="htRight";this.runHooks("beforeCellAlignment",n,e,i,o),Uo(e,i,o,function(a,s){return r.getCellMeta(a,s)},function(a,s,l,p){return r.setCellMeta(a,s,l,p)}),this.render()},disabled:!1},{key:"".concat(xn,":justify"),name:function(){var r=this,e=this.getTranslatedPhrase($1),n=si(this.getSelectedRange(),function(i,o){var a=r.getCellMeta(i,o).className;if(a&&a.indexOf("htJustify")!==-1)return!0});return n&&(e=ji(e)),e},callback:function(){var r=this,e=this.getSelectedRange(),n=Ya(e,function(a,s){return r.getCellMeta(a,s).className}),i="horizontal",o="htJustify";this.runHooks("beforeCellAlignment",n,e,i,o),Uo(e,i,o,function(a,s){return r.getCellMeta(a,s)},function(a,s,l,p){return r.setCellMeta(a,s,l,p)}),this.render()},disabled:!1},{name:St},{key:"".concat(xn,":top"),name:function(){var r=this,e=this.getTranslatedPhrase(j1),n=si(this.getSelectedRange(),function(i,o){var a=r.getCellMeta(i,o).className;if(a&&a.indexOf("htTop")!==-1)return!0});return n&&(e=ji(e)),e},callback:function(){var r=this,e=this.getSelectedRange(),n=Ya(e,function(a,s){return r.getCellMeta(a,s).className}),i="vertical",o="htTop";this.runHooks("beforeCellAlignment",n,e,i,o),Uo(e,i,o,function(a,s){return r.getCellMeta(a,s)},function(a,s,l,p){return r.setCellMeta(a,s,l,p)}),this.render()},disabled:!1},{key:"".concat(xn,":middle"),name:function(){var r=this,e=this.getTranslatedPhrase(L1),n=si(this.getSelectedRange(),function(i,o){var a=r.getCellMeta(i,o).className;if(a&&a.indexOf("htMiddle")!==-1)return!0});return n&&(e=ji(e)),e},callback:function(){var r=this,e=this.getSelectedRange(),n=Ya(e,function(a,s){return r.getCellMeta(a,s).className}),i="vertical",o="htMiddle";this.runHooks("beforeCellAlignment",n,e,i,o),Uo(e,i,o,function(a,s){return r.getCellMeta(a,s)},function(a,s,l,p){return r.setCellMeta(a,s,l,p)}),this.render()},disabled:!1},{key:"".concat(xn,":bottom"),name:function(){var r=this,e=this.getTranslatedPhrase(H1),n=si(this.getSelectedRange(),function(i,o){var a=r.getCellMeta(i,o).className;if(a&&a.indexOf("htBottom")!==-1)return!0});return n&&(e=ji(e)),e},callback:function(){var r=this,e=this.getSelectedRange(),n=Ya(e,function(a,s){return r.getCellMeta(a,s).className}),i="vertical",o="htBottom";this.runHooks("beforeCellAlignment",n,e,i,o),Uo(e,i,o,function(a,s){return r.getCellMeta(a,s)},function(a,s,l,p){return r.setCellMeta(a,s,l,p)}),this.render()},disabled:!1}]}}}var by="clear_column";function Dge(){return{key:by,name:function(){return this.getTranslatedPhrase(_1)},callback:function(r,e){var n=e[0].start.col,i=e[0].end.col;this.countRows()&&this.populateFromArray(0,n,[[null]],Math.max(e[0].start.row,e[0].end.row),i,"ContextMenu.clearColumn")},disabled:function(){var r=za(this);return r?!this.selection.isSelectedByColumnHeader():!0}}}var Yf="col_left";function Nge(){return{key:Yf,name:function(){return this.getTranslatedPhrase(p1)},callback:function(r,e){var n=this.selection.isSelectedByCorner(),i=0;if(!n){var o=e[Math.max(e.length-1,0)];i=o.start.col}this.alter("insert_col",i,1,"ContextMenu.columnLeft"),n&&this.selectAll()},disabled:function(){if(!this.isColumnModificationAllowed())return!0;var r=za(this);if(!r)return!0;if(this.selection.isSelectedByCorner()){var e=this.countCols();return e===0}return this.selection.isSelectedByRowHeader()||this.countCols()>=this.getSettings().maxCols},hidden:function(){return!this.getSettings().allowInsertColumn}}}var Gf="col_right";function $ge(){return{key:Gf,name:function(){return this.getTranslatedPhrase(y1)},callback:function(r,e){var n=this.selection.isSelectedByCorner(),i=0;if(n)i=this.countCols();else{var o,a=e[Math.max(e.length-1,0)],s=a==null||(o=a.end)===null||o===void 0?void 0:o.col;i=at(s)?s+1:0}this.alter("insert_col",i,1,"ContextMenu.columnRight"),n&&this.selectAll()},disabled:function(){if(!this.isColumnModificationAllowed())return!0;var r=za(this);return r?this.selection.isSelectedByCorner()?!1:this.selection.isSelectedByRowHeader()||this.countCols()>=this.getSettings().maxCols:!0},hidden:function(){return!this.getSettings().allowInsertColumn}}}var Kf="make_read_only";function jge(){return{key:Kf,name:function(){var r=this,e=this.getTranslatedPhrase(w1),n=si(this.getSelectedRange(),function(i,o){return r.getCellMeta(i,o).readOnly});return n&&(e=ji(e)),e},callback:function(){var r=this,e=this.getSelectedRange(),n=si(e,function(i,o){return r.getCellMeta(i,o).readOnly});he(e,function(i){i.forAll(function(o,a){o>=0&&a>=0&&r.setCellMeta(o,a,"readOnly",!n)})}),this.render()},disabled:function(){return!!(this.selection.isSelectedByCorner()||this.countRows()===0||this.countCols()===0||!this.getSelectedRange()||this.getSelectedRange().length===0)}}}var wy="redo";function Lge(){return{key:wy,name:function(){return this.getTranslatedPhrase(b1)},callback:function(){this.redo()},hidden:function(){var r=this.getPlugin("undoRedo");return!r||!r.isEnabled()},disabled:function(){return!this.getPlugin("undoRedo").isRedoAvailable()}}}function Hge(t,r){return Wge(t)||Vge(t,r)||Bge(t,r)||Fge()}function Fge(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Bge(t,r){if(!!t){if(typeof t=="string")return s5(t,r);var e=Object.prototype.toString.call(t).slice(8,-1);if(e==="Object"&&t.constructor&&(e=t.constructor.name),e==="Map"||e==="Set")return Array.from(t);if(e==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return s5(t,r)}}function s5(t,r){(r==null||r>t.length)&&(r=t.length);for(var e=0,n=new Array(r);e<r;e++)n[e]=t[e];return n}function Vge(t,r){var e=t==null?null:typeof Symbol!="undefined"&&t[Symbol.iterator]||t["@@iterator"];if(e!=null){var n=[],i=!0,o=!1,a,s;try{for(e=e.call(t);!(i=(a=e.next()).done)&&(n.push(a.value),!(r&&n.length===r));i=!0);}catch(l){o=!0,s=l}finally{try{!i&&e.return!=null&&e.return()}finally{if(o)throw s}}return n}}function Wge(t){if(Array.isArray(t))return t}var qf="remove_col";function Uge(){return{key:qf,name:function(){var r=this.getSelected(),e=0;if(r)if(r.length>1)e=1;else{var n=Hge(r[0],4),i=n[1],o=n[3];i-o!=0&&(e=1)}return this.getTranslatedPhrase(v1,e)},callback:function(){this.alter("remove_col",Lfe(this.getSelected()),null,"ContextMenu.removeColumn")},disabled:function(){if(!this.isColumnModificationAllowed())return!0;var r=za(this);if(!r)return!0;var e=this.countCols();return this.selection.isSelectedByCorner()?e===0:this.selection.isSelectedByRowHeader()||e===0},hidden:function(){return!this.getSettings().allowRemoveColumn}}}function zge(t,r){return qge(t)||Kge(t,r)||Gge(t,r)||Yge()}function Yge(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Gge(t,r){if(!!t){if(typeof t=="string")return u5(t,r);var e=Object.prototype.toString.call(t).slice(8,-1);if(e==="Object"&&t.constructor&&(e=t.constructor.name),e==="Map"||e==="Set")return Array.from(t);if(e==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return u5(t,r)}}function u5(t,r){(r==null||r>t.length)&&(r=t.length);for(var e=0,n=new Array(r);e<r;e++)n[e]=t[e];return n}function Kge(t,r){var e=t==null?null:typeof Symbol!="undefined"&&t[Symbol.iterator]||t["@@iterator"];if(e!=null){var n=[],i=!0,o=!1,a,s;try{for(e=e.call(t);!(i=(a=e.next()).done)&&(n.push(a.value),!(r&&n.length===r));i=!0);}catch(l){o=!0,s=l}finally{try{!i&&e.return!=null&&e.return()}finally{if(o)throw s}}return n}}function qge(t){if(Array.isArray(t))return t}var _y="remove_row";function Xge(){return{key:_y,name:function(){var r=this.getSelected(),e=0;if(r)if(r.length>1)e=1;else{var n=zge(r[0],3),i=n[0],o=n[2];i-o!=0&&(e=1)}return this.getTranslatedPhrase(m1,e)},callback:function(){this.alter("remove_row",Hfe(this.getSelected()),1,"ContextMenu.removeRow")},disabled:function(){var r=za(this);if(!r)return!0;var e=this.countRows();return this.selection.isSelectedByCorner()?e===0:this.selection.isSelectedByColumnHeader()||e===0},hidden:function(){return!this.getSettings().allowRemoveRow}}}var Sy="row_above";function Zge(){return{key:Sy,name:function(){return this.getTranslatedPhrase(h1)},callback:function(r,e){var n=this.selection.isSelectedByCorner(),i=0;if(!n){var o=e[Math.max(e.length-1,0)];i=o.start.row}this.alter("insert_row",i,1,"ContextMenu.rowAbove"),n&&this.selectAll()},disabled:function(){var r=za(this);if(!r)return!0;if(this.selection.isSelectedByCorner()){var e=this.countRows();return e===0}return this.selection.isSelectedByColumnHeader()||this.countRows()>=this.getSettings().maxRows},hidden:function(){return!this.getSettings().allowInsertRow}}}var Cy="row_below";function Jge(){return{key:Cy,name:function(){return this.getTranslatedPhrase(d1)},callback:function(r,e){var n=this.selection.isSelectedByCorner(),i=0;if(n)i=this.countRows();else{var o,a=e[Math.max(e.length-1,0)],s=a==null||(o=a.end)===null||o===void 0?void 0:o.row;i=at(s)?s+1:0}this.alter("insert_row",i,1,"ContextMenu.rowBelow"),n&&this.selectAll()},disabled:function(){var r=za(this);return r?this.selection.isSelectedByCorner()?!1:this.selection.isSelectedByColumnHeader()||this.countRows()>=this.getSettings().maxRows:!0},hidden:function(){return!this.getSettings().allowInsertRow}}}var Xf="no_items";function Qge(){return{key:Xf,name:function(){return this.getTranslatedPhrase(c1)},disabled:!0,isCommand:!1}}var ky="undo";function ebe(){return{key:ky,name:function(){return this.getTranslatedPhrase(g1)},callback:function(){this.undo()},hidden:function(){var r=this.getPlugin("undoRedo");return!r||!r.isEnabled()},disabled:function(){return!this.getPlugin("undoRedo").isUndoAvailable()}}}var Kr;function pn(t,r,e){return r in t?Object.defineProperty(t,r,{value:e,enumerable:!0,configurable:!0,writable:!0}):t[r]=e,t}var tbe=[Sy,Cy,Yf,Gf,by,_y,qf,ky,wy,Kf,xn,St,Xf],rbe=(Kr={},pn(Kr,St,oge),pn(Kr,Xf,Qge),pn(Kr,Sy,Zge),pn(Kr,Cy,Jge),pn(Kr,Yf,Nge),pn(Kr,Gf,$ge),pn(Kr,by,Dge),pn(Kr,_y,Xge),pn(Kr,qf,Uge),pn(Kr,ky,ebe),pn(Kr,wy,Lge),pn(Kr,Kf,jge),pn(Kr,xn,Ige),Kr);function l5(){var t={};return Ot(rbe,function(r,e){t[e]=r()}),t}function nbe(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}function f5(t,r){for(var e=0;e<r.length;e++){var n=r[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function ibe(t,r,e){return r&&f5(t.prototype,r),e&&f5(t,e),t}var obe=function(){function t(r){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;nbe(this,t),this.hot=r,this.predefinedItems=l5(),this.defaultOrderPattern=e}return ibe(t,[{key:"setPredefinedItems",value:function(e){var n=this,i={};this.defaultOrderPattern.length=0,Ot(e,function(o,a){var s="";o.name===St?(i[St]=o,s=St):isNaN(parseInt(a,10))?(o.key=o.key===void 0?a:o.key,i[a]=o,s=o.key):(i[o.key]=o,s=o.key),n.defaultOrderPattern.push(s)}),this.predefinedItems=i}},{key:"getItems",value:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return abe(e,this.defaultOrderPattern,this.predefinedItems)}}]),t}();function abe(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],e=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},n=[],i=t;return i&&i.items?i=i.items:Array.isArray(i)||(i=r),vt(i)?Ot(i,function(o,a){var s=e[typeof o=="string"?o:a];s||(s=o),vt(o)?or(s,o):typeof s=="string"&&(s={name:s}),s.key===void 0&&(s.key=a),n.push(s)}):he(i,function(o,a){var s=e[o];!s&&tbe.indexOf(o)>=0||(s||(s={name:o,key:"".concat(a)}),vt(o)&&or(s,o),s.key===void 0&&(s.key=a),n.push(s))}),n}var c5=obe;function sbe(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}function h5(t,r){for(var e=0;e<r.length;e++){var n=r[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function ube(t,r,e){return r&&h5(t.prototype,r),e&&h5(t,e),t}var lbe=function(){function t(r,e){sbe(this,t);var n=Ra(e),i=Po(e),o,a,s,l,p,d;this.rootWindow=e,this.type=this.getSourceType(r),this.type==="literal"?(o=parseInt(r.top,10),s=parseInt(r.left,10),p=r.height||0,d=r.width||0,a=o,l=s,o+=n,s+=i):this.type==="event"&&(o=parseInt(r.pageY,10),s=parseInt(r.pageX,10),p=r.target.clientHeight,d=r.target.clientWidth,a=o-n,l=s-i),this.top=o,this.topRelative=a,this.left=s,this.leftRelative=l,this.scrollTop=n,this.scrollLeft=i,this.cellHeight=p,this.cellWidth=d}return ube(t,[{key:"getSourceType",value:function(e){var n="literal";return e instanceof Event&&(n="event"),n}},{key:"fitsAbove",value:function(e){return this.topRelative>=e.offsetHeight}},{key:"fitsBelow",value:function(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.rootWindow.innerHeight;return this.topRelative+e.offsetHeight<=n}},{key:"fitsOnRight",value:function(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.rootWindow.innerWidth;return this.leftRelative+this.cellWidth+e.offsetWidth<=n}},{key:"fitsOnLeft",value:function(e){return this.leftRelative>=e.offsetWidth}}]),t}(),fbe=lbe;function cbe(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}function d5(t,r){for(var e=0;e<r.length;e++){var n=r[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function hbe(t,r,e){return r&&d5(t.prototype,r),e&&d5(t,e),t}var p5=215,y5=function(){function t(r,e){cbe(this,t),this.hot=r,this.options=e||{parent:null,name:null,className:"",keepInViewport:!0,standalone:!1,minWidth:p5,container:this.hot.rootDocument.documentElement},this.eventManager=new Wt(this),this.container=this.createContainer(this.options.name),this.hotMenu=null,this.hotSubMenus={},this.parentMenu=this.options.parent||null,this.menuItems=null,this.origOutsideClickDeselects=null,this.keyEvent=!1,this.offset={above:0,below:0,left:0,right:0},this._afterScrollCallback=null,this.registerEvents()}return hbe(t,[{key:"registerEvents",value:function(){for(var e=this,n=this.hot.rootWindow;n;)this.eventManager.addEventListener(n.document,"mousedown",function(i){return e.onDocumentMouseDown(i)}),this.eventManager.addEventListener(n.document,"contextmenu",function(i){return e.onDocumentContextMenu(i)}),n=Bh(n)}},{key:"setMenuItems",value:function(e){this.menuItems=e}},{key:"getSelectedItem",value:function(){return this.hasSelectedItem()?this.hotMenu.getSourceDataAtRow(this.hotMenu.getSelectedLast()[0]):null}},{key:"hasSelectedItem",value:function(){return Array.isArray(this.hotMenu.getSelectedLast())}},{key:"setOffset",value:function(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;this.offset[e]=n}},{key:"isSubMenu",value:function(){return this.parentMenu!==null}},{key:"open",value:function(){var e=this;this.runLocalHooks("beforeOpen"),this.container.removeAttribute("style"),this.container.style.display="block";var n=A0(function(p){return e.openSubMenu(p)},300),i=this.options.minWidth||p5,o=!1,a=un(this.menuItems,function(p){return p.key===Xf&&(o=!0),cge(p,e.hot)});if(a.length<1&&!o)a.push(l5()[Xf]);else if(a.length===0)return;a=pge(a,St);var s=!1,l={data:a,colHeaders:!1,autoColumnSize:!0,autoWrapRow:!1,modifyColWidth:function(d){return at(d)&&d<i?i:d},autoRowSize:!1,readOnly:!0,editor:!1,copyPaste:!1,maxCols:1,columns:[{data:"name",renderer:function(d,g,y,h,u,f){return e.menuItemRenderer(d,g,y,h,u,f)}}],renderAllRows:!0,fragmentSelection:!1,outsideClickDeselects:!1,disableVisualSelection:"area",beforeKeyDown:function(d){return e.onBeforeKeyDown(d)},afterOnCellMouseOver:function(d,g){e.isAllSubMenusClosed()?n(g.row):e.openSubMenu(g.row)},rowHeights:function(d){return a[d].name===St?1:23},afterOnCellContextMenu:function(d){d.preventDefault(),Mb()&&s&&e.hasSelectedItem()&&e.close(!0)},beforeOnCellMouseUp:function(d){e.hasSelectedItem()&&(s=!e.isCommandPassive(e.getSelectedItem()),e.executeCommand(d))},afterOnCellMouseUp:function(d){(!Mb()||!Do(d))&&s&&e.hasSelectedItem()&&(In()||Ab()?setTimeout(function(){return e.close(!0)},325):e.close(!0))},afterUnlisten:function(){!e.hasSelectedItem()&&e.isOpened()&&e.hotMenu.listen()}};this.origOutsideClickDeselects=this.hot.getSettings().outsideClickDeselects,this.hot.getSettings().outsideClickDeselects=!1,this.hotMenu=new B_(this.container,l),this.hotMenu.addHook("afterInit",function(){return e.onAfterInit()}),this.hotMenu.addHook("afterSelection",function(){return e.onAfterSelection.apply(e,arguments)}),this.hotMenu.init(),this.hotMenu.listen(),this.blockMainTableCallbacks(),this.runLocalHooks("afterOpen")}},{key:"close",value:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;!this.isOpened()||(e&&this.parentMenu?this.parentMenu.close():(this.closeAllSubMenus(),this.container.style.display="none",this.releaseMainTableCallbacks(),this.hotMenu.destroy(),this.hotMenu=null,this.hot.getSettings().outsideClickDeselects=this.origOutsideClickDeselects,this.runLocalHooks("afterClose"),this.parentMenu&&this.parentMenu.hotMenu.listen()))}},{key:"openSubMenu",value:function(e){if(!this.hotMenu)return!1;var n=this.hotMenu.getCell(e,0);if(this.closeAllSubMenus(),!n||!sge(n))return!1;var i=this.hotMenu.getSourceDataAtRow(e),o=new t(this.hot,{parent:this,name:i.name,className:this.options.className,keepInViewport:!0,container:this.options.container});return o.setMenuItems(i.submenu.items),o.open(),o.setPosition(n.getBoundingClientRect()),this.hotSubMenus[i.key]=o,o}},{key:"closeSubMenu",value:function(e){var n=this.hotMenu.getSourceDataAtRow(e),i=this.hotSubMenus[n.key];i&&(i.destroy(),delete this.hotSubMenus[n.key])}},{key:"closeAllSubMenus",value:function(){var e=this;he(this.hotMenu.getData(),function(n,i){return e.closeSubMenu(i)})}},{key:"isAllSubMenusClosed",value:function(){return Object.keys(this.hotSubMenus).length===0}},{key:"destroy",value:function(){var e=this.container.parentNode;this.clearLocalHooks(),this.close(),this.parentMenu=null,this.eventManager.destroy(),e&&e.removeChild(this.container)}},{key:"isOpened",value:function(){return this.hotMenu!==null}},{key:"executeCommand",value:function(e){if(!(!this.isOpened()||!this.hasSelectedItem())){var n=this.getSelectedItem();if(this.runLocalHooks("select",n,e),!this.isCommandPassive(n)){var i=this.hot.getSelectedRange(),o=i?age(i):[];this.runLocalHooks("executeCommand",n.key,o,e),this.isSubMenu()&&this.parentMenu.runLocalHooks("executeCommand",n.key,o,e)}}}},{key:"isCommandPassive",value:function(e){var n=e.isCommand,i=e.name,o=e.disabled,a=e.submenu,s=o===!0||typeof o=="function"&&o.call(this.hot)===!0;return n===!1||i===St||s===!0||a}},{key:"setPosition",value:function(e){var n=new fbe(e,this.container.ownerDocument.defaultView);this.options.keepInViewport?(n.fitsBelow(this.container)?this.setPositionBelowCursor(n):n.fitsAbove(this.container)?this.setPositionAboveCursor(n):this.setPositionBelowCursor(n),n.fitsOnRight(this.container)?this.setPositionOnRightOfCursor(n):this.setPositionOnLeftOfCursor(n)):(this.setPositionBelowCursor(n),this.setPositionOnRightOfCursor(n))}},{key:"setPositionAboveCursor",value:function(e){var n=this.offset.above+e.top-this.container.offsetHeight;this.isSubMenu()&&(n=e.top+e.cellHeight-this.container.offsetHeight+3),this.container.style.top="".concat(n,"px")}},{key:"setPositionBelowCursor",value:function(e){var n=this.offset.below+e.top+1;this.isSubMenu()&&(n=e.top-1),this.container.style.top="".concat(n,"px")}},{key:"setPositionOnRightOfCursor",value:function(e){var n;this.isSubMenu()?n=1+e.left+e.cellWidth:n=this.offset.right+1+e.left,this.container.style.left="".concat(n,"px")}},{key:"setPositionOnLeftOfCursor",value:function(e){var n=Pr(this.hot.rootDocument),i=this.offset.left+e.left-this.container.offsetWidth+n+4;this.container.style.left="".concat(i,"px")}},{key:"selectFirstCell",value:function(){var e=this.hotMenu.getCell(0,0);dy(e)||py(e)||yy(e)?this.selectNextCell(0,0):this.hotMenu.selectCell(0,0)}},{key:"selectLastCell",value:function(){var e=this.hotMenu.countRows()-1,n=this.hotMenu.getCell(e,0);dy(n)||py(n)||yy(n)?this.selectPrevCell(e,0):this.hotMenu.selectCell(e,0)}},{key:"selectNextCell",value:function(e,n){var i=e+1,o=i<this.hotMenu.countRows()?this.hotMenu.getCell(i,n):null;!o||(dy(o)||py(o)||yy(o)?this.selectNextCell(i,n):this.hotMenu.selectCell(i,n))}},{key:"selectPrevCell",value:function(e,n){var i=e-1,o=i>=0?this.hotMenu.getCell(i,n):null;!o||(dy(o)||py(o)||yy(o)?this.selectPrevCell(i,n):this.hotMenu.selectCell(i,n))}},{key:"menuItemRenderer",value:function(e,n,i,o,a,s){var l=this,p=e.getSourceDataAtRow(i),d=this.hot.rootDocument.createElement("div"),g=function(v){return Yt(v,"submenu")},y=function(v){return new RegExp(St,"i").test(v.name)},h=function(v){return v.disabled===!0||typeof v.disabled=="function"&&v.disabled.call(l.hot)===!0},u=function(v){return v.disableSelection},f=s;typeof f=="function"&&(f=f.call(this.hot)),kn(n),Ie(d,"htItemWrapper"),n.appendChild(d),y(p)?Ie(n,"htSeparator"):typeof p.renderer=="function"?(Ie(n,"htCustomMenuRenderer"),n.appendChild(p.renderer(e,d,i,o,a,f))):Ao(d,f),h(p)?(Ie(n,"htDisabled"),this.eventManager.addEventListener(n,"mouseenter",function(){return e.deselectCell()})):u(p)?(Ie(n,"htSelectionDisabled"),this.eventManager.addEventListener(n,"mouseenter",function(){return e.deselectCell()})):g(p)?(Ie(n,"htSubmenu"),u(p)?this.eventManager.addEventListener(n,"mouseenter",function(){return e.deselectCell()}):this.eventManager.addEventListener(n,"mouseenter",function(){return e.selectCell(i,o,void 0,void 0,!1,!1)})):(dt(n,["htSubmenu","htDisabled"]),u(p)?this.eventManager.addEventListener(n,"mouseenter",function(){return e.deselectCell()}):this.eventManager.addEventListener(n,"mouseenter",function(){return e.selectCell(i,o,void 0,void 0,!1,!1)}))}},{key:"createContainer",value:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,n=this.options.container.ownerDocument,i=e,o;return i&&(qt(i)&&(i=i.call(this.hot),i===null||er(i)?i="":i=i.toString()),i=i.replace(/[^A-z0-9]/g,"_"),i="".concat(this.options.className,"Sub_").concat(i),o=n.querySelector(".".concat(this.options.className,".").concat(i))),o||(o=n.createElement("div"),Ie(o,"htMenu ".concat(this.options.className)),i&&Ie(o,i),this.options.container.appendChild(o)),o}},{key:"blockMainTableCallbacks",value:function(){this._afterScrollCallback=function(){},this.hot.addHook("afterScrollVertically",this._afterScrollCallback),this.hot.addHook("afterScrollHorizontally",this._afterScrollCallback)}},{key:"releaseMainTableCallbacks",value:function(){this._afterScrollCallback&&(this.hot.removeHook("afterScrollVertically",this._afterScrollCallback),this.hot.removeHook("afterScrollHorizontally",this._afterScrollCallback),this._afterScrollCallback=null)}},{key:"onBeforeKeyDown",value:function(e){if(cf(e.target)&&this.container.contains(e.target)){rr(e);return}var n=this.hotMenu.getSelectedLast(),i=!1;switch(this.keyEvent=!0,e.keyCode){case De.ESCAPE:this.close(),i=!0;break;case De.ENTER:n&&(this.hotMenu.getSourceDataAtRow(n[0]).submenu?i=!0:(this.executeCommand(e),this.close(!0)));break;case De.ARROW_DOWN:n?this.selectNextCell(n[0],n[1]):this.selectFirstCell(),i=!0;break;case De.ARROW_UP:n?this.selectPrevCell(n[0],n[1]):this.selectLastCell(),i=!0;break;case De.ARROW_RIGHT:if(n){var o=this.openSubMenu(n[0]);o&&o.selectFirstCell()}i=!0;break;case De.ARROW_LEFT:n&&this.isSubMenu()&&(this.close(),this.parentMenu&&this.parentMenu.hotMenu.listen(),i=!0);break}i&&(e.preventDefault(),rr(e)),this.keyEvent=!1}},{key:"onAfterInit",value:function(){var e=this.hotMenu.view.wt.wtTable,n=this.hotMenu.getSettings().data,i=e.hider.style,o=e.holder.style,a=parseInt(i.width,10),s=pr(n,function(l,p){return l+(p.name===St?1:26)},0);o.width="".concat(a+3,"px"),o.height="".concat(s+3,"px"),i.height=o.height}},{key:"onAfterSelection",value:function(e,n,i,o,a){this.keyEvent===!1&&(a.value=!0)}},{key:"onDocumentMouseDown",value:function(e){!this.isOpened()||(this.options.standalone&&this.hotMenu&&!To(e.target,this.hotMenu.rootElement)?this.close(!0):(this.isAllSubMenusClosed()||this.isSubMenu())&&!To(e.target,".htMenu")&&this.close(!0))}},{key:"onDocumentContextMenu",value:function(e){!this.isOpened()||lt(e.target,"htCore")&&To(e.target,this.hotMenu.rootElement)&&e.preventDefault()}}]),t}();Ut(y5,nn);var BS=y5;function Oy(t){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?Oy=function(e){return typeof e}:Oy=function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Oy(t)}function dbe(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}function m5(t,r){for(var e=0;e<r.length;e++){var n=r[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function pbe(t,r,e){return r&&m5(t.prototype,r),e&&m5(t,e),t}function Ka(){return typeof Reflect!="undefined"&&Reflect.get?Ka=Reflect.get:Ka=function(r,e,n){var i=ybe(r,e);if(!!i){var o=Object.getOwnPropertyDescriptor(i,e);return o.get?o.get.call(arguments.length<3?r:n):o.value}},Ka.apply(this,arguments)}function ybe(t,r){for(;!Object.prototype.hasOwnProperty.call(t,r)&&(t=Hi(t),t!==null););return t}function mbe(t,r){if(typeof r!="function"&&r!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(r&&r.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),r&&VS(t,r)}function VS(t,r){return VS=Object.setPrototypeOf||function(n,i){return n.__proto__=i,n},VS(t,r)}function vbe(t){var r=bbe();return function(){var n=Hi(t),i;if(r){var o=Hi(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return gbe(this,i)}}function gbe(t,r){if(r&&(Oy(r)==="object"||typeof r=="function"))return r;if(r!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return v5(t)}function v5(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function bbe(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Hi(t){return Hi=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},Hi(t)}var Ry="contextMenu",wbe=70;Ze.getSingleton().register("afterContextMenuDefaultOptions");Ze.getSingleton().register("beforeContextMenuShow");Ze.getSingleton().register("afterContextMenuShow");Ze.getSingleton().register("afterContextMenuHide");Ze.getSingleton().register("afterContextMenuExecute");var g5=function(t){mbe(e,t);var r=vbe(e);function e(n){var i;return dbe(this,e),i=r.call(this,n),i.eventManager=new Wt(v5(i)),i.commandExecutor=new a5(i.hot),i.itemsFactory=null,i.menu=null,i}return pbe(e,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[Ry]}},{key:"enablePlugin",value:function(){var i=this;if(!this.enabled){var o=this.hot.getSettings()[Ry];typeof o.callback=="function"&&this.commandExecutor.setCommonCallback(o.callback),this.menu=new BS(this.hot,{className:"htContextMenu",keepInViewport:!0,container:o.uiContainer||this.hot.rootDocument.body}),this.menu.addLocalHook("beforeOpen",function(){return i.onMenuBeforeOpen()}),this.menu.addLocalHook("afterOpen",function(){return i.onMenuAfterOpen()}),this.menu.addLocalHook("afterClose",function(){return i.onMenuAfterClose()}),this.menu.addLocalHook("executeCommand",function(){for(var a,s=arguments.length,l=new Array(s),p=0;p<s;p++)l[p]=arguments[p];return(a=i.executeCommand).call.apply(a,[i].concat(l))}),this.addHook("afterOnCellContextMenu",function(a){return i.onAfterOnCellContextMenu(a)}),Ka(Hi(e.prototype),"enablePlugin",this).call(this)}}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),Ka(Hi(e.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){this.close(),this.menu&&(this.menu.destroy(),this.menu=null),Ka(Hi(e.prototype),"disablePlugin",this).call(this)}},{key:"open",value:function(i){if(!!this.menu&&(this.prepareMenuItems(),this.menu.open(),!!this.menu.isOpened())){var o=0,a=0;if(this.hot.rootDocument!==this.menu.container.ownerDocument){var s=this.hot.rootWindow.frameElement,l=s.getBoundingClientRect(),p=l.top,d=l.left;o=p-Ra(i.view),a=d-Po(i.view)}else o=-1*Ra(this.menu.hotMenu.rootWindow),a=-1*Po(this.menu.hotMenu.rootWindow);this.menu.setPosition({top:parseInt(i.pageY,10)+o,left:parseInt(i.pageX,10)+a})}}},{key:"close",value:function(){!this.menu||(this.menu.close(),this.itemsFactory=null)}},{key:"executeCommand",value:function(i){var o;this.itemsFactory===null&&this.prepareMenuItems();for(var a=arguments.length,s=new Array(a>1?a-1:0),l=1;l<a;l++)s[l-1]=arguments[l];(o=this.commandExecutor).execute.apply(o,[i].concat(s))}},{key:"prepareMenuItems",value:function(){var i=this;this.itemsFactory=new c5(this.hot,e.DEFAULT_ITEMS);var o=this.hot.getSettings()[Ry],a={items:this.itemsFactory.getItems(o)};this.hot.runHooks("afterContextMenuDefaultOptions",a),this.itemsFactory.setPredefinedItems(a.items);var s=this.itemsFactory.getItems(o);this.hot.runHooks("beforeContextMenuSetItems",s),this.menu.setMenuItems(s),he(s,function(l){return i.commandExecutor.registerCommand(l.key,l)})}},{key:"onAfterOnCellContextMenu",value:function(i){var o=this.hot.getSettings(),a=o.rowHeaders,s=o.colHeaders;function l(d){return d.nodeName==="TD"||d.parentNode.nodeName==="TD"}var p=i.target;this.close(),!lt(p,"handsontableInput")&&(i.preventDefault(),i.stopPropagation(),!(!(a||s)&&!l(p)&&!(lt(p,"current")&&lt(p,"wtBorder")))&&this.open(i))}},{key:"onMenuBeforeOpen",value:function(){this.hot.runHooks("beforeContextMenuShow",this)}},{key:"onMenuAfterOpen",value:function(){this.hot.runHooks("afterContextMenuShow",this)}},{key:"onMenuAfterClose",value:function(){this.hot.listen(),this.hot.runHooks("afterContextMenuHide",this)}},{key:"destroy",value:function(){this.close(),this.menu&&this.menu.destroy(),Ka(Hi(e.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return Ry}},{key:"PLUGIN_PRIORITY",get:function(){return wbe}},{key:"PLUGIN_DEPS",get:function(){return["plugin:AutoColumnSize"]}},{key:"DEFAULT_ITEMS",get:function(){return[Sy,Cy,St,Yf,Gf,St,_y,qf,St,ky,wy,St,Kf,St,xn]}}]),e}(Lt);g5.SEPARATOR={name:St};function _be(t){return{key:"copy",name:function(){return this.getTranslatedPhrase(S1)},callback:function(){t.copy()},disabled:function(){if(this.countRows()===0||this.countCols()===0)return!0;var e=this.getSelected();return!e||e.length>1},hidden:!1}}function Sbe(t){return{key:"cut",name:function(){return this.getTranslatedPhrase(C1)},callback:function(){t.cut()},disabled:function(){if(this.countRows()===0||this.countCols()===0)return!0;var e=this.getSelected();return!e||e.length>1},hidden:!1}}function Cbe(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}function b5(t,r){for(var e=0;e<r.length;e++){var n=r[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function kbe(t,r,e){return r&&b5(t.prototype,r),e&&b5(t,e),t}var Obe=function(){function t(){Cbe(this,t),this.data={}}return kbe(t,[{key:"setData",value:function(e,n){this.data[e]=n}},{key:"getData",value:function(e){return this.data[e]||void 0}}]),t}();function Rbe(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}var Ebe=function t(){Rbe(this,t),this.clipboardData=new Obe},Tbe=lh,xbe=h3;Tbe("WeakSet",function(t){return function(){return t(this,arguments.length?arguments[0]:void 0)}},xbe);function Abe(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}function w5(t,r){for(var e=0;e<r.length;e++){var n=r[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function Mbe(t,r,e){return r&&w5(t.prototype,r),e&&w5(t,e),t}var WS=function(){function t(r){Abe(this,t),this.rootDocument=r.defaultView?r:r.ownerDocument,this.mainElement=null,this.eventManager=new Wt(this),this.listenersCount=new WeakSet,this.container=r}return Mbe(t,[{key:"useSecondaryElement",value:function(){var e=Dbe(this.container);this.listenersCount.has(e)||(this.listenersCount.add(e),_5(this.eventManager,e,this)),this.mainElement=e}},{key:"setFocusableElement",value:function(e){this.listenersCount.has(e)||(this.listenersCount.add(e),_5(this.eventManager,e,this)),this.mainElement=e}},{key:"getFocusableElement",value:function(){return this.mainElement}},{key:"focus",value:function(){this.mainElement.value=" ",In()||i3(this.mainElement)}}]),t}();Ut(WS,nn);var Ey=new WeakMap;function Pbe(t){var r=new WS(t),e=Ey.get(t);return e=isNaN(e)?0:e,Ey.set(t,e+1),r}function Ibe(t){t.eventManager.clear()}var US=function(r,e){return function(n){return e.runLocalHooks(r,n)}};function _5(t,r,e){t.addEventListener(r,"copy",US("copy",e)),t.addEventListener(r,"cut",US("cut",e)),t.addEventListener(r,"paste",US("paste",e))}var Ty=new WeakMap;function Dbe(t){var r=Ty.get(t);if(r)return r.parentElement||t.appendChild(r),r;var e=t.defaultView?t:t.ownerDocument,n=e.createElement("textarea");return Ty.set(t,n),n.setAttribute("data-hot-input",""),n.className="HandsontableCopyPaste",n.tabIndex=-1,n.autocomplete="off",n.wrap="hard",n.value=" ",t.appendChild(n),n}function S5(t){if(t instanceof WS){var r=Ey.get(t.container);if(r=isNaN(r)?0:r,r>0&&(r-=1),Ibe(t),r<=0){r=0;var e=Ty.get(t.container);e&&e.parentNode&&(e.parentNode.removeChild(e),Ty.delete(t.container)),t.mainElement=null}Ey.set(t.container,r)}}function Nbe(t,r){return Hbe(t)||Lbe(t,r)||jbe(t,r)||$be()}function $be(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function jbe(t,r){if(!!t){if(typeof t=="string")return C5(t,r);var e=Object.prototype.toString.call(t).slice(8,-1);if(e==="Object"&&t.constructor&&(e=t.constructor.name),e==="Map"||e==="Set")return Array.from(t);if(e==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return C5(t,r)}}function C5(t,r){(r==null||r>t.length)&&(r=t.length);for(var e=0,n=new Array(r);e<r;e++)n[e]=t[e];return n}function Lbe(t,r){var e=t==null?null:typeof Symbol!="undefined"&&t[Symbol.iterator]||t["@@iterator"];if(e!=null){var n=[],i=!0,o=!1,a,s;try{for(e=e.call(t);!(i=(a=e.next()).done)&&(n.push(a.value),!(r&&n.length===r));i=!0);}catch(l){o=!0,s=l}finally{try{!i&&e.return!=null&&e.return()}finally{if(o)throw s}}return n}}function Hbe(t){if(Array.isArray(t))return t}function Zf(t){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?Zf=function(e){return typeof e}:Zf=function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Zf(t)}function Fbe(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}function k5(t,r){for(var e=0;e<r.length;e++){var n=r[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function Bbe(t,r,e){return r&&k5(t.prototype,r),e&&k5(t,e),t}function qa(){return typeof Reflect!="undefined"&&Reflect.get?qa=Reflect.get:qa=function(r,e,n){var i=Vbe(r,e);if(!!i){var o=Object.getOwnPropertyDescriptor(i,e);return o.get?o.get.call(arguments.length<3?r:n):o.value}},qa.apply(this,arguments)}function Vbe(t,r){for(;!Object.prototype.hasOwnProperty.call(t,r)&&(t=Fi(t),t!==null););return t}function Wbe(t,r){if(typeof r!="function"&&r!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(r&&r.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),r&&zS(t,r)}function zS(t,r){return zS=Object.setPrototypeOf||function(n,i){return n.__proto__=i,n},zS(t,r)}function Ube(t){var r=Ybe();return function(){var n=Fi(t),i;if(r){var o=Fi(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return zbe(this,i)}}function zbe(t,r){if(r&&(Zf(r)==="object"||typeof r=="function"))return r;if(r!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return O5(t)}function O5(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Ybe(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Fi(t){return Fi=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},Fi(t)}Ze.getSingleton().register("afterCopyLimit");Ze.getSingleton().register("modifyCopyableRange");Ze.getSingleton().register("beforeCut");Ze.getSingleton().register("afterCut");Ze.getSingleton().register("beforePaste");Ze.getSingleton().register("afterPaste");Ze.getSingleton().register("beforeCopy");Ze.getSingleton().register("afterCopy");var YS="copyPaste",Gbe=80,Kbe=1/0,qbe=1/0,Xa=new WeakMap,R5=['<meta name="generator" content="Handsontable"/>','<style type="text/css">td{white-space:normal}br{mso-data-placement:same-cell}</style>'].join(""),Xbe=function(t){Wbe(e,t);var r=Ube(e);function e(n){var i;return Fbe(this,e),i=r.call(this,n),i.columnsLimit=qbe,i.copyableRanges=[],i.focusableElement=void 0,i.pasteMode="overwrite",i.rowsLimit=Kbe,i.uiContainer=i.hot.rootDocument.body,Xa.set(O5(i),{isTriggeredByCopy:!1,isTriggeredByCut:!1,isBeginEditing:!1,isFragmentSelectionEnabled:!1}),i}return Bbe(e,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[YS]}},{key:"enablePlugin",value:function(){var i=this;if(!this.enabled){var o=this.hot.getSettings(),a=o[YS],s=o.fragmentSelection,l=Xa.get(this);l.isFragmentSelectionEnabled=!!s,Zf(a)==="object"&&(this.pasteMode=a.pasteMode||this.pasteMode,this.rowsLimit=isNaN(a.rowsLimit)?this.rowsLimit:a.rowsLimit,this.columnsLimit=isNaN(a.columnsLimit)?this.columnsLimit:a.columnsLimit,this.uiContainer=a.uiContainer||this.uiContainer),this.addHook("afterContextMenuDefaultOptions",function(p){return i.onAfterContextMenuDefaultOptions(p)}),this.addHook("afterOnCellMouseUp",function(){return i.onAfterOnCellMouseUp()}),this.addHook("afterSelectionEnd",function(){return i.onAfterSelectionEnd()}),this.addHook("beforeKeyDown",function(){return i.onBeforeKeyDown()}),this.focusableElement=Pbe(this.uiContainer),this.focusableElement.addLocalHook("copy",function(p){return i.onCopy(p)}).addLocalHook("cut",function(p){return i.onCut(p)}).addLocalHook("paste",function(p){return i.onPaste(p)}),qa(Fi(e.prototype),"enablePlugin",this).call(this)}}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),this.getOrCreateFocusableElement(),qa(Fi(e.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){this.focusableElement&&S5(this.focusableElement),qa(Fi(e.prototype),"disablePlugin",this).call(this)}},{key:"copy",value:function(){var i=Xa.get(this);i.isTriggeredByCopy=!0,this.getOrCreateFocusableElement(),this.focusableElement.focus(),this.hot.rootDocument.execCommand("copy")}},{key:"cut",value:function(){var i=Xa.get(this);i.isTriggeredByCut=!0,this.getOrCreateFocusableElement(),this.focusableElement.focus(),this.hot.rootDocument.execCommand("cut")}},{key:"getRangedCopyableData",value:function(i){var o=this,a=[],s=[],l=[];return he(i,function(p){Qe(p.startRow,p.endRow,function(d){s.indexOf(d)===-1&&s.push(d)}),Qe(p.startCol,p.endCol,function(d){l.indexOf(d)===-1&&l.push(d)})}),he(s,function(p){var d=[];he(l,function(g){d.push(o.hot.getCopyableData(p,g))}),a.push(d)}),Lf(a)}},{key:"getRangedData",value:function(i){var o=this,a=[],s=[],l=[];return he(i,function(p){Qe(p.startRow,p.endRow,function(d){s.indexOf(d)===-1&&s.push(d)}),Qe(p.startCol,p.endCol,function(d){l.indexOf(d)===-1&&l.push(d)})}),he(s,function(p){var d=[];he(l,function(g){d.push(o.hot.getCopyableData(p,g))}),a.push(d)}),a}},{key:"paste",value:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:i;if(!(!i&&!o)){var a=new Ebe;i&&a.clipboardData.setData("text/plain",i),o&&a.clipboardData.setData("text/html",o),this.getOrCreateFocusableElement(),this.onPaste(a)}}},{key:"setCopyableText",value:function(){var i=this.hot.getSelectedRangeLast();if(!!i){var o=i.getTopLeftCorner(),a=i.getBottomRightCorner(),s=o.row,l=o.col,p=a.row,d=a.col,g=Math.min(p,s+this.rowsLimit-1),y=Math.min(d,l+this.columnsLimit-1);this.copyableRanges.length=0,this.copyableRanges.push({startRow:s,startCol:l,endRow:g,endCol:y}),this.copyableRanges=this.hot.runHooks("modifyCopyableRange",this.copyableRanges),(p!==g||d!==y)&&this.hot.runHooks("afterCopyLimit",p-s+1,d-l+1,this.rowsLimit,this.columnsLimit)}}},{key:"getOrCreateFocusableElement",value:function(){var i=this.hot.getActiveEditor(),o=i?i.TEXTAREA:void 0;o?this.focusableElement.setFocusableElement(o):this.focusableElement.useSecondaryElement()}},{key:"isEditorOpened",value:function(){var i=this.hot.getActiveEditor();return i&&i.isOpened()}},{key:"populateValues",value:function(i){var o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.hot.getSelectedRangeLast();if(!!i.length){for(var a=i.length,s=i[0].length,l=[],p=o.getTopLeftCorner(),d=p.row,g=p.col,y=o.getBottomRightCorner(),h=y.row,u=y.col,f=d,c=g,v=d,m=g;l.length<a||f<=h;){var b=this.hot.getCellMeta(f,g),w=b.skipRowOnPaste,_=b.visualRow;if(f=_+1,w!==!0){v=_,c=g;for(var C=[],R=l.length%a;C.length<s||c<=u;){var I=this.hot.getCellMeta(d,c),P=I.skipColumnOnPaste,N=I.visualCol;if(c=N+1,P!==!0){m=N;var A=C.length%s;C.push(i[R][A])}}l.push(C)}}return this.hot.populateFromArray(d,g,l,void 0,void 0,"CopyPaste.paste",this.pasteMode),[d,g,v,m]}}},{key:"onCopy",value:function(i){var o=Xa.get(this);if(!(!this.hot.isListening()&&!o.isTriggeredByCopy||this.isEditorOpened())){this.setCopyableText(),o.isTriggeredByCopy=!1;var a=this.getRangedData(this.copyableRanges),s=!!this.hot.runHooks("beforeCopy",a,this.copyableRanges);if(s){var l=Lf(a);if(i&&i.clipboardData){var p=Cw(a,this.hot.rootDocument);i.clipboardData.setData("text/plain",l),i.clipboardData.setData("text/html",[R5,p].join(""))}else typeof ClipboardEvent=="undefined"&&this.hot.rootWindow.clipboardData.setData("Text",l);this.hot.runHooks("afterCopy",a,this.copyableRanges)}i.preventDefault()}}},{key:"onCut",value:function(i){var o=Xa.get(this);if(!(!this.hot.isListening()&&!o.isTriggeredByCut||this.isEditorOpened())){this.setCopyableText(),o.isTriggeredByCut=!1;var a=this.getRangedData(this.copyableRanges),s=!!this.hot.runHooks("beforeCut",a,this.copyableRanges);if(s){var l=Lf(a);if(i&&i.clipboardData){var p=Cw(a,this.hot.rootDocument);i.clipboardData.setData("text/plain",l),i.clipboardData.setData("text/html",[R5,p].join(""))}else typeof ClipboardEvent=="undefined"&&this.hot.rootWindow.clipboardData.setData("Text",l);this.hot.emptySelectedCells("CopyPaste.cut"),this.hot.runHooks("afterCut",a,this.copyableRanges)}i.preventDefault()}}},{key:"onPaste",value:function(i){if(!(!this.hot.isListening()||this.isEditorOpened())){i&&i.preventDefault&&i.preventDefault();var o;if(i&&typeof i.clipboardData!="undefined"){var a=Fh(i.clipboardData.getData("text/html"),{ADD_TAGS:["meta"],ADD_ATTR:["content"],FORCE_BODY:!0});if(a&&/(<table)|(<TABLE)/g.test(a)){var s=hA(a,this.hot.rootDocument);o=s.data}else o=i.clipboardData.getData("text/plain")}else typeof ClipboardEvent=="undefined"&&typeof this.hot.rootWindow.clipboardData!="undefined"&&(o=this.hot.rootWindow.clipboardData.getData("Text"));if(typeof o=="string"&&(o=ice(o)),!(o&&o.length===0)&&this.hot.runHooks("beforePaste",o,this.copyableRanges)!==!1){var l=this.populateValues(o),p=Nbe(l,4),d=p[0],g=p[1],y=p[2],h=p[3];this.hot.selectCell(d,g,Math.min(this.hot.countRows()-1,y),Math.min(this.hot.countCols()-1,h)),this.hot.runHooks("afterPaste",o,this.copyableRanges)}}}},{key:"onAfterContextMenuDefaultOptions",value:function(i){i.items.push({name:"---------"},_be(this),Sbe(this))}},{key:"onAfterOnCellMouseUp",value:function(){!this.hot.isListening()||this.isEditorOpened()||this.hot.getSettings().fragmentSelection||(this.getOrCreateFocusableElement(),this.focusableElement.focus())}},{key:"onAfterSelectionEnd",value:function(){var i=Xa.get(this),o=i.isFragmentSelectionEnabled;this.isEditorOpened()||(this.getOrCreateFocusableElement(),!(o&&this.focusableElement.getFocusableElement()!==this.hot.rootDocument.activeElement&&t3())&&(this.setCopyableText(),this.focusableElement.focus()))}},{key:"onBeforeKeyDown",value:function(){if(!(!this.hot.isListening()||this.isEditorOpened())){var i=this.hot.rootDocument.activeElement,o=this.hot.getActiveEditor();!o||i!==this.focusableElement.getFocusableElement()&&i!==o.select||(this.getOrCreateFocusableElement(),this.focusableElement.focus())}}},{key:"destroy",value:function(){this.focusableElement&&(S5(this.focusableElement),this.focusableElement=null),qa(Fi(e.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return YS}},{key:"PLUGIN_PRIORITY",get:function(){return Gbe}}]),e}(Lt);function E5(t,r){return"border_row".concat(t,"col").concat(r)}function Jf(){return{width:1,color:"#000"}}function Bi(){return{hide:!0}}function Zbe(){return{width:1,color:"#000",cornerVisible:!1}}function GS(t,r){return{id:E5(t,r),border:Zbe(),row:t,col:r,top:Bi(),right:Bi(),bottom:Bi(),left:Bi()}}function Jbe(t,r){return Yt(r,"border")&&(t.border=r.border),Yt(r,"top")&&(r.top?(vt(r.top)||(r.top=Jf()),t.top=r.top):(r.top=Bi(),t.top=r.top)),Yt(r,"right")&&(r.right?(vt(r.right)||(r.right=Jf()),t.right=r.right):(r.right=Bi(),t.right=r.right)),Yt(r,"bottom")&&(r.bottom?(vt(r.bottom)||(r.bottom=Jf()),t.bottom=r.bottom):(r.bottom=Bi(),t.bottom=r.bottom)),Yt(r,"left")&&(r.left?(vt(r.left)||(r.left=Jf()),t.left=r.left):(r.left=Bi(),t.left=r.left)),t}function Vi(t,r){var e=!1;return he(t.getSelectedRange(),function(n){n.forAll(function(i,o){if(!(i<0||o<0)){var a=t.getCellMeta(i,o).borders;if(a)if(r){if(!Yt(a[r],"hide")||a[r].hide===!1)return e=!0,!1}else return e=!0,!1}})}),e}function xy(t){return'<span class="selected">'.concat(String.fromCharCode(10003),"</span>").concat(t)}function Qbe(t){return{key:"borders:bottom",name:function(){var e=this.getTranslatedPhrase(W1),n=Vi(this,"bottom");return n&&(e=xy(e)),e},callback:function(e,n){var i=Vi(this,"bottom");t.prepareBorder(n,"bottom",i)}}}function e0e(t){return{key:"borders:left",name:function(){var e=this.getTranslatedPhrase(U1),n=Vi(this,"left");return n&&(e=xy(e)),e},callback:function(e,n){var i=Vi(this,"left");t.prepareBorder(n,"left",i)}}}function t0e(t){return{key:"borders:no_borders",name:function(){return this.getTranslatedPhrase(z1)},callback:function(e,n){t.prepareBorder(n,"noBorders")},disabled:function(){return!Vi(this)}}}function r0e(t){return{key:"borders:right",name:function(){var e=this.getTranslatedPhrase(V1),n=Vi(this,"right");return n&&(e=xy(e)),e},callback:function(e,n){var i=Vi(this,"right");t.prepareBorder(n,"right",i)}}}function n0e(t){return{key:"borders:top",name:function(){var e=this.getTranslatedPhrase(B1),n=Vi(this,"top");return n&&(e=xy(e)),e},callback:function(e,n){var i=Vi(this,"top");t.prepareBorder(n,"top",i)}}}function Ay(t){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?Ay=function(e){return typeof e}:Ay=function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ay(t)}function T5(t,r){return s0e(t)||a0e(t,r)||o0e(t,r)||i0e()}function i0e(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function o0e(t,r){if(!!t){if(typeof t=="string")return x5(t,r);var e=Object.prototype.toString.call(t).slice(8,-1);if(e==="Object"&&t.constructor&&(e=t.constructor.name),e==="Map"||e==="Set")return Array.from(t);if(e==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return x5(t,r)}}function x5(t,r){(r==null||r>t.length)&&(r=t.length);for(var e=0,n=new Array(r);e<r;e++)n[e]=t[e];return n}function a0e(t,r){var e=t==null?null:typeof Symbol!="undefined"&&t[Symbol.iterator]||t["@@iterator"];if(e!=null){var n=[],i=!0,o=!1,a,s;try{for(e=e.call(t);!(i=(a=e.next()).done)&&(n.push(a.value),!(r&&n.length===r));i=!0);}catch(l){o=!0,s=l}finally{try{!i&&e.return!=null&&e.return()}finally{if(o)throw s}}return n}}function s0e(t){if(Array.isArray(t))return t}function u0e(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}function A5(t,r){for(var e=0;e<r.length;e++){var n=r[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function l0e(t,r,e){return r&&A5(t.prototype,r),e&&A5(t,e),t}function Za(){return typeof Reflect!="undefined"&&Reflect.get?Za=Reflect.get:Za=function(r,e,n){var i=f0e(r,e);if(!!i){var o=Object.getOwnPropertyDescriptor(i,e);return o.get?o.get.call(arguments.length<3?r:n):o.value}},Za.apply(this,arguments)}function f0e(t,r){for(;!Object.prototype.hasOwnProperty.call(t,r)&&(t=Wi(t),t!==null););return t}function c0e(t,r){if(typeof r!="function"&&r!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(r&&r.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),r&&KS(t,r)}function KS(t,r){return KS=Object.setPrototypeOf||function(n,i){return n.__proto__=i,n},KS(t,r)}function h0e(t){var r=y0e();return function(){var n=Wi(t),i;if(r){var o=Wi(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return d0e(this,i)}}function d0e(t,r){if(r&&(Ay(r)==="object"||typeof r=="function"))return r;if(r!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return p0e(t)}function p0e(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function y0e(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Wi(t){return Wi=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},Wi(t)}var My="customBorders",m0e=90,v0e=function(t){c0e(e,t);var r=h0e(e);function e(n){var i;return u0e(this,e),i=r.call(this,n),i.savedBorders=[],i}return l0e(e,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[My]}},{key:"enablePlugin",value:function(){var i=this;this.enabled||(this.addHook("afterContextMenuDefaultOptions",function(o){return i.onAfterContextMenuDefaultOptions(o)}),this.addHook("init",function(){return i.onAfterInit()}),Za(Wi(e.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){this.hideBorders(),Za(Wi(e.prototype),"disablePlugin",this).call(this)}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),this.changeBorderSettings(),Za(Wi(e.prototype),"updatePlugin",this).call(this)}},{key:"setBorders",value:function(i,o){var a=this,s=["top","right","bottom","left"],l=o?Object.keys(o):s,p=pu(i),d=jf(p);he(i,function(g){for(var y=d(g),h=T5(y,4),u=h[0],f=h[1],c=h[2],v=h[3],m=function(_){for(var C=function(P){he(l,function(N){a.prepareBorderFromCustomAdded(_,P,o,N)})},R=f;R<=v;R+=1)C(R)},b=u;b<=c;b+=1)m(b)}),this.hot.view.render()}},{key:"getBorders",value:function(i){var o=this;if(!Array.isArray(i))return this.savedBorders;var a=pu(i),s=jf(a),l=[];return he(i,function(p){for(var d=s(p),g=T5(d,4),y=g[0],h=g[1],u=g[2],f=g[3],c=function(b){for(var w=function(R){he(o.savedBorders,function(I){I.row===b&&I.col===R&&l.push(I)})},_=h;_<=f;_+=1)w(_)},v=y;v<=u;v+=1)c(v)}),l}},{key:"clearBorders",value:function(i){var o=this;i?this.setBorders(i):(he(this.savedBorders,function(a){o.clearBordersFromSelectionSettings(a.id),o.clearNullCellRange(),o.hot.removeCellMeta(a.row,a.col,"borders")}),this.savedBorders.length=0)}},{key:"insertBorderIntoSettings",value:function(i,o){var a=this.checkSavedBorders(i);a||this.savedBorders.push(i);var s=new Rr(new ke(i.row,i.col)),l=this.checkCustomSelections(i,s,o);l||this.hot.selection.highlight.addCustomSelection({border:i,visualCellRange:s})}},{key:"prepareBorderFromCustomAdded",value:function(i,o,a,s){var l=this.hot.countRows(),p=this.hot.countCols();if(!(i>=l||o>=p)){var d=GS(i,o);a&&(d=Jbe(d,a),he(this.hot.selection.highlight.customSelections,function(g){if(d.id===g.settings.id)return Object.assign(g.settings,a),d.id=g.settings.id,d.left=g.settings.left,d.right=g.settings.right,d.top=g.settings.top,d.bottom=g.settings.bottom,!1})),this.hot.setCellMeta(i,o,"borders",d),this.insertBorderIntoSettings(d,s)}}},{key:"prepareBorderFromCustomAddedRange",value:function(i){var o=this,a=i.range,s=Math.min(a.to.row,this.hot.countRows()-1),l=Math.min(a.to.col,this.hot.countCols()-1);Qe(a.from.row,s,function(p){Qe(a.from.col,l,function(d){var g=GS(p,d),y=0;p===a.from.row&&Yt(i,"top")&&(y+=1,g.top=i.top),p===a.to.row&&Yt(i,"bottom")&&(y+=1,g.bottom=i.bottom),d===a.from.col&&Yt(i,"left")&&(y+=1,g.left=i.left),d===a.to.col&&Yt(i,"right")&&(y+=1,g.right=i.right),y>0&&(o.hot.setCellMeta(p,d,"borders",g),o.insertBorderIntoSettings(g))})})}},{key:"removeAllBorders",value:function(i,o){var a=E5(i,o);this.spliceBorder(a),this.clearBordersFromSelectionSettings(a),this.clearNullCellRange(),this.hot.removeCellMeta(i,o,"borders")}},{key:"setBorder",value:function(i,o,a,s){var l=this.hot.getCellMeta(i,o).borders;if((!l||l.border===void 0)&&(l=GS(i,o)),s){l[a]=Bi();var p=this.countHide(l);if(p===4)this.removeAllBorders(i,o);else{var d=this.checkCustomSelectionsFromContextMenu(l,a,s);d||this.insertBorderIntoSettings(l),this.hot.setCellMeta(i,o,"borders",l)}}else{l[a]=Jf();var g=this.checkCustomSelectionsFromContextMenu(l,a,s);g||this.insertBorderIntoSettings(l),this.hot.setCellMeta(i,o,"borders",l)}}},{key:"prepareBorder",value:function(i,o,a){var s=this;he(i,function(l){var p=l.start,d=l.end;if(p.row===d.row&&p.col===d.col)o==="noBorders"?s.removeAllBorders(p.row,p.col):s.setBorder(p.row,p.col,o,a);else switch(o){case"noBorders":Qe(p.col,d.col,function(g){Qe(p.row,d.row,function(y){s.removeAllBorders(y,g)})});break;case"top":Qe(p.col,d.col,function(g){s.setBorder(p.row,g,o,a)});break;case"right":Qe(p.row,d.row,function(g){s.setBorder(g,d.col,o,a)});break;case"bottom":Qe(p.col,d.col,function(g){s.setBorder(d.row,g,o,a)});break;case"left":Qe(p.row,d.row,function(g){s.setBorder(g,p.col,o,a)});break}})}},{key:"createCustomBorders",value:function(i){var o=this;he(i,function(a){a.range?o.prepareBorderFromCustomAddedRange(a):o.prepareBorderFromCustomAdded(a.row,a.col,a)})}},{key:"countHide",value:function(i){var o=Object.values(i);return pr(o,function(a,s){var l=a;return s.hide&&(l+=1),l},0)}},{key:"clearBordersFromSelectionSettings",value:function(i){var o=bt(this.hot.selection.highlight.customSelections,function(a){return a.settings.id}).indexOf(i);o>-1&&this.hot.selection.highlight.customSelections[o].clear()}},{key:"clearNullCellRange",value:function(){var i=this;he(this.hot.selection.highlight.customSelections,function(o,a){if(o.cellRange===null)return i.hot.selection.highlight.customSelections[a].destroy(),i.hot.selection.highlight.customSelections.splice(a,1),!1})}},{key:"hideBorders",value:function(){var i=this;he(this.savedBorders,function(o){i.clearBordersFromSelectionSettings(o.id),i.clearNullCellRange()})}},{key:"spliceBorder",value:function(i){var o=bt(this.savedBorders,function(a){return a.id}).indexOf(i);o>-1&&this.savedBorders.splice(o,1)}},{key:"checkSavedBorders",value:function(i){var o=this,a=!1,s=this.countHide(i);return s===4?(this.spliceBorder(i.id),a=!0):he(this.savedBorders,function(l,p){if(i.id===l.id)return o.savedBorders[p]=i,a=!0,!1}),a}},{key:"checkCustomSelectionsFromContextMenu",value:function(i,o,a){var s=!1;return he(this.hot.selection.highlight.customSelections,function(l){if(i.id===l.settings.id)return Ot(l.instanceBorders,function(p){p.toggleHiddenClass(o,a)}),s=!0,!1}),s}},{key:"checkCustomSelections",value:function(i,o,a){var s=this.countHide(i),l=!1;return s===4?(this.removeAllBorders(i.row,i.col),l=!0):he(this.hot.selection.highlight.customSelections,function(p){if(i.id===p.settings.id)return p.visualCellRange=o,p.commit(),a&&Ot(p.instanceBorders,function(d){d.changeBorderStyle(a,i)}),l=!0,!1}),l}},{key:"changeBorderSettings",value:function(){var i=this.hot.getSettings()[My];Array.isArray(i)?(i.length||(this.savedBorders=i),this.createCustomBorders(i)):i!==void 0&&this.createCustomBorders(this.savedBorders)}},{key:"onAfterContextMenuDefaultOptions",value:function(i){!this.hot.getSettings()[My]||i.items.push({name:"---------"},{key:"borders",name:function(){return this.getTranslatedPhrase(F1)},disabled:function(){return this.selection.isSelectedByCorner()},submenu:{items:[n0e(this),r0e(this),Qbe(this),e0e(this),t0e(this)]}})}},{key:"onAfterInit",value:function(){this.changeBorderSettings()}},{key:"destroy",value:function(){Za(Wi(e.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return My}},{key:"PLUGIN_PRIORITY",get:function(){return m0e}}]),e}(Lt);function Py(t){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?Py=function(e){return typeof e}:Py=function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Py(t)}function g0e(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}function M5(t,r){for(var e=0;e<r.length;e++){var n=r[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function b0e(t,r,e){return r&&M5(t.prototype,r),e&&M5(t,e),t}function Ja(){return typeof Reflect!="undefined"&&Reflect.get?Ja=Reflect.get:Ja=function(r,e,n){var i=w0e(r,e);if(!!i){var o=Object.getOwnPropertyDescriptor(i,e);return o.get?o.get.call(arguments.length<3?r:n):o.value}},Ja.apply(this,arguments)}function w0e(t,r){for(;!Object.prototype.hasOwnProperty.call(t,r)&&(t=Ui(t),t!==null););return t}function _0e(t,r){if(typeof r!="function"&&r!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(r&&r.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),r&&qS(t,r)}function qS(t,r){return qS=Object.setPrototypeOf||function(n,i){return n.__proto__=i,n},qS(t,r)}function S0e(t){var r=k0e();return function(){var n=Ui(t),i;if(r){var o=Ui(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return C0e(this,i)}}function C0e(t,r){if(r&&(Py(r)==="object"||typeof r=="function"))return r;if(r!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return P5(t)}function P5(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function k0e(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Ui(t){return Ui=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},Ui(t)}var I5="dragToScroll",O0e=100,R0e=function(t){_0e(e,t);var r=S0e(e);function e(n){var i;return g0e(this,e),i=r.call(this,n),i.eventManager=new Wt(P5(i)),i.boundaries=null,i.callback=null,i.listening=!1,i}return b0e(e,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[I5]}},{key:"enablePlugin",value:function(){var i=this;this.enabled||(this.addHook("afterOnCellMouseDown",function(o){return i.setupListening(o)}),this.addHook("afterOnCellCornerMouseDown",function(o){return i.setupListening(o)}),this.registerEvents(),Ja(Ui(e.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),Ja(Ui(e.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){this.unregisterEvents(),Ja(Ui(e.prototype),"disablePlugin",this).call(this)}},{key:"setBoundaries",value:function(i){this.boundaries=i}},{key:"setCallback",value:function(i){this.callback=i}},{key:"check",value:function(i,o){var a=0,s=0;o<this.boundaries.top?s=o-this.boundaries.top:o>this.boundaries.bottom&&(s=o-this.boundaries.bottom),i<this.boundaries.left?a=i-this.boundaries.left:i>this.boundaries.right&&(a=i-this.boundaries.right),this.callback(a,s)}},{key:"listen",value:function(){this.listening=!0}},{key:"unlisten",value:function(){this.listening=!1}},{key:"isListening",value:function(){return this.listening}},{key:"registerEvents",value:function(){for(var i=this,o=this.hot.rootWindow,a=o;a;)this.eventManager.addEventListener(a.document,"contextmenu",function(){return i.unlisten()}),this.eventManager.addEventListener(a.document,"mouseup",function(){return i.unlisten()}),this.eventManager.addEventListener(a.document,"mousemove",function(s){return i.onMouseMove(s)}),a=Bh(a)}},{key:"unregisterEvents",value:function(){this.eventManager.clear()}},{key:"setupListening",value:function(i){if(!Do(i)){var o=this.hot.view.wt.wtTable.holder;o!==this.hot.rootWindow&&(this.setBoundaries(o.getBoundingClientRect()),this.setCallback(function(a,s){a<0?o.scrollLeft-=50:a>0&&(o.scrollLeft+=50),s<0?o.scrollTop-=20:s>0&&(o.scrollTop+=20)}),this.listen())}}},{key:"onMouseMove",value:function(i){!this.isListening()||this.check(i.clientX,i.clientY)}},{key:"destroy",value:function(){Ja(Ui(e.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return I5}},{key:"PLUGIN_PRIORITY",get:function(){return O0e}}]),e}(Lt);function Iy(t){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?Iy=function(e){return typeof e}:Iy=function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Iy(t)}function E0e(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}function D5(t,r){for(var e=0;e<r.length;e++){var n=r[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function T0e(t,r,e){return r&&D5(t.prototype,r),e&&D5(t,e),t}function Qa(){return typeof Reflect!="undefined"&&Reflect.get?Qa=Reflect.get:Qa=function(r,e,n){var i=x0e(r,e);if(!!i){var o=Object.getOwnPropertyDescriptor(i,e);return o.get?o.get.call(arguments.length<3?r:n):o.value}},Qa.apply(this,arguments)}function x0e(t,r){for(;!Object.prototype.hasOwnProperty.call(t,r)&&(t=zi(t),t!==null););return t}function A0e(t,r){if(typeof r!="function"&&r!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(r&&r.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),r&&XS(t,r)}function XS(t,r){return XS=Object.setPrototypeOf||function(n,i){return n.__proto__=i,n},XS(t,r)}function M0e(t){var r=I0e();return function(){var n=zi(t),i;if(r){var o=zi(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return P0e(this,i)}}function P0e(t,r){if(r&&(Iy(r)==="object"||typeof r=="function"))return r;if(r!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return N5(t)}function N5(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function I0e(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function zi(t){return zi=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},zi(t)}Ze.getSingleton().register("afterDropdownMenuDefaultOptions");Ze.getSingleton().register("beforeDropdownMenuShow");Ze.getSingleton().register("afterDropdownMenuShow");Ze.getSingleton().register("afterDropdownMenuHide");Ze.getSingleton().register("afterDropdownMenuExecute");var ZS="dropdownMenu",D0e=230,JS="changeType",$5=function(t){A0e(e,t);var r=M0e(e);function e(n){var i;return E0e(this,e),i=r.call(this,n),i.eventManager=new Wt(N5(i)),i.commandExecutor=new a5(i.hot),i.itemsFactory=null,i.menu=null,i.hot.addHook("afterGetColHeader",function(o,a){return i.onAfterGetColHeader(o,a)}),i}return T0e(e,[{key:"isEnabled",value:function(){return this.hot.getSettings()[ZS]}},{key:"enablePlugin",value:function(){var i=this;if(!this.enabled){this.itemsFactory=new c5(this.hot,e.DEFAULT_ITEMS);var o=this.hot.getSettings()[ZS],a={items:this.itemsFactory.getItems(o)};this.registerEvents(),typeof o.callback=="function"&&this.commandExecutor.setCommonCallback(o.callback),Qa(zi(e.prototype),"enablePlugin",this).call(this),this.callOnPluginsReady(function(){i.hot.runHooks("afterDropdownMenuDefaultOptions",a),i.itemsFactory.setPredefinedItems(a.items);var s=i.itemsFactory.getItems(o);i.menu&&i.menu.destroy(),i.menu=new BS(i.hot,{className:"htDropdownMenu",keepInViewport:!0,container:o.uiContainer||i.hot.rootDocument.body}),i.hot.runHooks("beforeDropdownMenuSetItems",s),i.menu.setMenuItems(s),i.menu.addLocalHook("beforeOpen",function(){return i.onMenuBeforeOpen()}),i.menu.addLocalHook("afterOpen",function(){return i.onMenuAfterOpen()}),i.menu.addLocalHook("afterClose",function(){return i.onMenuAfterClose()}),i.menu.addLocalHook("executeCommand",function(){for(var l,p=arguments.length,d=new Array(p),g=0;g<p;g++)d[g]=arguments[g];return(l=i.executeCommand).call.apply(l,[i].concat(d))}),he(s,function(l){return i.commandExecutor.registerCommand(l.key,l)})})}}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),Qa(zi(e.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){this.close(),this.menu&&this.menu.destroy(),Qa(zi(e.prototype),"disablePlugin",this).call(this)}},{key:"registerEvents",value:function(){var i=this;this.eventManager.addEventListener(this.hot.rootElement,"click",function(o){return i.onTableClick(o)})}},{key:"open",value:function(i){!this.menu||(this.menu.open(),i.width&&this.menu.setOffset("left",i.width),this.menu.setPosition(i))}},{key:"close",value:function(){!this.menu||this.menu.close()}},{key:"executeCommand",value:function(i){for(var o,a=arguments.length,s=new Array(a>1?a-1:0),l=1;l<a;l++)s[l-1]=arguments[l];(o=this.commandExecutor).execute.apply(o,[i].concat(s))}},{key:"setListening",value:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.menu.isOpened()&&(i?this.menu.hotMenu.listen():this.menu.hotMenu.unlisten())}},{key:"onTableClick",value:function(i){if(i.stopPropagation(),lt(i.target,JS)&&!this.menu.isOpened()){var o=0,a=0;if(this.hot.rootDocument!==this.menu.container.ownerDocument){var s=this.hot.rootWindow.frameElement,l=s.getBoundingClientRect(),p=l.top,d=l.left;o=p,a=d}var g=i.target.getBoundingClientRect();this.open({left:g.left+a,top:g.top+i.target.offsetHeight+3+o,width:g.width,height:g.height})}}},{key:"onAfterGetColHeader",value:function(i,o){var a=o.parentNode;if(!!a){var s=a.parentNode.childNodes,l=Array.prototype.indexOf.call(s,a);if(!(i<0||l!==s.length-1)){var p=o.querySelector(".".concat(JS));if(!(this.enabled&&p)){if(!this.enabled){p&&p.parentNode.removeChild(p);return}var d=this.hot.rootDocument.createElement("button");d.className=JS,d.onclick=function(){return!1},o.firstChild.insertBefore(d,o.firstChild.firstChild)}}}}},{key:"onMenuBeforeOpen",value:function(){this.hot.runHooks("beforeDropdownMenuShow",this)}},{key:"onMenuAfterOpen",value:function(){this.hot.runHooks("afterDropdownMenuShow",this)}},{key:"onMenuAfterClose",value:function(){this.hot.listen(),this.hot.runHooks("afterDropdownMenuHide",this)}},{key:"destroy",value:function(){this.close(),this.menu&&this.menu.destroy(),Qa(zi(e.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return ZS}},{key:"PLUGIN_PRIORITY",get:function(){return D0e}},{key:"PLUGIN_DEPS",get:function(){return["plugin:AutoColumnSize"]}},{key:"DEFAULT_ITEMS",get:function(){return[Yf,Gf,St,qf,St,by,St,Kf,St,xn]}}]),e}(Lt);$5.SEPARATOR={name:St};function N0e(t,r){return H0e(t)||L0e(t,r)||j0e(t,r)||$0e()}function $0e(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function j0e(t,r){if(!!t){if(typeof t=="string")return j5(t,r);var e=Object.prototype.toString.call(t).slice(8,-1);if(e==="Object"&&t.constructor&&(e=t.constructor.name),e==="Map"||e==="Set")return Array.from(t);if(e==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return j5(t,r)}}function j5(t,r){(r==null||r>t.length)&&(r=t.length);for(var e=0,n=new Array(r);e<r;e++)n[e]=t[e];return n}function L0e(t,r){var e=t==null?null:typeof Symbol!="undefined"&&t[Symbol.iterator]||t["@@iterator"];if(e!=null){var n=[],i=!0,o=!1,a,s;try{for(e=e.call(t);!(i=(a=e.next()).done)&&(n.push(a.value),!(r&&n.length===r));i=!0);}catch(l){o=!0,s=l}finally{try{!i&&e.return!=null&&e.return()}finally{if(o)throw s}}return n}}function H0e(t){if(Array.isArray(t))return t}function F0e(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}function L5(t,r){for(var e=0;e<r.length;e++){var n=r[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function B0e(t,r,e){return r&&L5(t.prototype,r),e&&L5(t,e),t}var V0e=function(){function t(r){F0e(this,t),this.hot=r,this.options={}}return B0e(t,[{key:"setOptions",value:function(e){this.options=e}},{key:"getData",value:function(){var e=this,n=this._getDataRange(),i=n.startRow,o=n.startCol,a=n.endRow,s=n.endCol,l=this.options,p=[];return Qe(i,a,function(d){var g=[];!l.exportHiddenRows&&e._isHiddenRow(d)||(Qe(o,s,function(y){!l.exportHiddenColumns&&e._isHiddenColumn(y)||g.push(e.hot.getDataAtCell(d,y))}),p.push(g))}),p}},{key:"getRowHeaders",value:function(){var e=this,n=[];if(this.options.rowHeaders){var i=this._getDataRange(),o=i.startRow,a=i.endRow,s=this.hot.getRowHeader();Qe(o,a,function(l){!e.options.exportHiddenRows&&e._isHiddenRow(l)||n.push(s[l])})}return n}},{key:"getColumnHeaders",value:function(){var e=this,n=[];if(this.options.columnHeaders){var i=this._getDataRange(),o=i.startCol,a=i.endCol,s=this.hot.getColHeader();Qe(o,a,function(l){!e.options.exportHiddenColumns&&e._isHiddenColumn(l)||n.push(s[l])})}return n}},{key:"_getDataRange",value:function(){var e=this.hot.countCols()-1,n=this.hot.countRows()-1,i=N0e(this.options.range,4),o=i[0],a=o===void 0?0:o,s=i[1],l=s===void 0?0:s,p=i[2],d=p===void 0?n:p,g=i[3],y=g===void 0?e:g;return a=Math.max(a,0),l=Math.max(l,0),d=Math.min(d,n),y=Math.min(y,e),{startRow:a,startCol:l,endRow:d,endCol:y}}},{key:"_isHiddenRow",value:function(e){return this.hot.rowIndexMapper.isHidden(this.hot.toPhysicalRow(e))}},{key:"_isHiddenColumn",value:function(e){return this.hot.columnIndexMapper.isHidden(this.hot.toPhysicalColumn(e))}}]),t}(),W0e=V0e;function U0e(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}function H5(t,r){for(var e=0;e<r.length;e++){var n=r[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function z0e(t,r,e){return r&&H5(t.prototype,r),e&&H5(t,e),t}var Y0e=function(){function t(r,e){U0e(this,t),this.dataProvider=r,this.options=this._mergeOptions(e),this.dataProvider.setOptions(this.options)}return z0e(t,[{key:"_mergeOptions",value:function(e){var n=Br(this.constructor.DEFAULT_OPTIONS),i=new Date;return n=or(Br(t.DEFAULT_OPTIONS),n),n=or(n,e),n.filename=v0(n.filename,{YYYY:i.getFullYear(),MM:"".concat(i.getMonth()+1).padStart(2,"0"),DD:"".concat(i.getDate()).padStart(2,"0")}),n}}],[{key:"DEFAULT_OPTIONS",get:function(){return{mimeType:"text/plain",fileExtension:"txt",filename:"Handsontable [YYYY]-[MM]-[DD]",encoding:"utf-8",bom:!1,columnHeaders:!1,rowHeaders:!1,exportHiddenColumns:!1,exportHiddenRows:!1,range:[]}}}]),t}(),G0e=Y0e;function Dy(t){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?Dy=function(e){return typeof e}:Dy=function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Dy(t)}function K0e(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}function F5(t,r){for(var e=0;e<r.length;e++){var n=r[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function q0e(t,r,e){return r&&F5(t.prototype,r),e&&F5(t,e),t}function X0e(t,r){if(typeof r!="function"&&r!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(r&&r.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),r&&QS(t,r)}function QS(t,r){return QS=Object.setPrototypeOf||function(n,i){return n.__proto__=i,n},QS(t,r)}function Z0e(t){var r=ewe();return function(){var n=Ny(t),i;if(r){var o=Ny(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return J0e(this,i)}}function J0e(t,r){if(r&&(Dy(r)==="object"||typeof r=="function"))return r;if(r!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Q0e(t)}function Q0e(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function ewe(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Ny(t){return Ny=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},Ny(t)}var twe=String.fromCharCode(13),rwe=String.fromCharCode(34),nwe=String.fromCharCode(10),iwe=function(t){X0e(e,t);var r=Z0e(e);function e(){return K0e(this,e),r.apply(this,arguments)}return q0e(e,[{key:"export",value:function(){var i=this,o=this.options,a=this.dataProvider.getData(),s=this.dataProvider.getColumnHeaders(),l=s.length>0,p=this.dataProvider.getRowHeaders(),d=p.length>0,g=o.bom?String.fromCharCode(65279):"";return l&&(s=bt(s,function(y){return i._escapeCell(y,!0)}),d&&(g+=o.columnDelimiter),g+=s.join(o.columnDelimiter),g+=o.rowDelimiter),he(a,function(y,h){h>0&&(g+=o.rowDelimiter),d&&(g+=i._escapeCell(p[h])+o.columnDelimiter),g+=y.map(function(u){return i._escapeCell(u)}).join(o.columnDelimiter)}),g}},{key:"_escapeCell",value:function(i){var o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,a=lr(i);return a!==""&&(o||a.indexOf(twe)>=0||a.indexOf(rwe)>=0||a.indexOf(nwe)>=0||a.indexOf(this.options.columnDelimiter)>=0)&&(a=a.replace(new RegExp('"',"g"),'""'),a='"'.concat(a,'"')),a}}],[{key:"DEFAULT_OPTIONS",get:function(){return{mimeType:"text/csv",fileExtension:"csv",bom:!0,columnDelimiter:",",rowDelimiter:`\r
`}}}]),e}(G0e),owe=iwe;function awe(t,r,e){return r in t?Object.defineProperty(t,r,{value:e,enumerable:!0,configurable:!0,writable:!0}):t[r]=e,t}var swe="csv",eC=awe({},swe,owe);function uwe(t,r,e){return typeof eC[t]=="function"?new eC[t](r,e):null}function $y(t){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?$y=function(e){return typeof e}:$y=function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},$y(t)}function lwe(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}function B5(t,r){for(var e=0;e<r.length;e++){var n=r[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function fwe(t,r,e){return r&&B5(t.prototype,r),e&&B5(t,e),t}function cwe(t,r){if(typeof r!="function"&&r!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(r&&r.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),r&&tC(t,r)}function tC(t,r){return tC=Object.setPrototypeOf||function(n,i){return n.__proto__=i,n},tC(t,r)}function hwe(t){var r=ywe();return function(){var n=jy(t),i;if(r){var o=jy(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return dwe(this,i)}}function dwe(t,r){if(r&&($y(r)==="object"||typeof r=="function"))return r;if(r!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return pwe(t)}function pwe(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function ywe(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function jy(t){return jy=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},jy(t)}var mwe="exportFile",vwe=240,gwe=function(t){cwe(e,t);var r=hwe(e);function e(){return lwe(this,e),r.apply(this,arguments)}return fwe(e,[{key:"isEnabled",value:function(){return!0}},{key:"exportAsString",value:function(i){var o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return this._createTypeFormatter(i,o).export()}},{key:"exportAsBlob",value:function(i){var o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return this._createBlob(this._createTypeFormatter(i,o))}},{key:"downloadFile",value:function(i){var o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},a=this.hot,s=a.rootDocument,l=a.rootWindow,p=this._createTypeFormatter(i,o),d=this._createBlob(p),g=l.URL||l.webkitURL,y=s.createElement("a"),h="".concat(p.options.filename,".").concat(p.options.fileExtension);if(y.download!==void 0){var u=g.createObjectURL(d);y.style.display="none",y.setAttribute("href",u),y.setAttribute("download",h),s.body.appendChild(y),y.dispatchEvent(new MouseEvent("click")),s.body.removeChild(y),setTimeout(function(){g.revokeObjectURL(u)},100)}else navigator.msSaveOrOpenBlob&&navigator.msSaveOrOpenBlob(d,h)}},{key:"_createTypeFormatter",value:function(i){var o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!eC[i])throw new Error('Export format type "'.concat(i,'" is not supported.'));return uwe(i,new W0e(this.hot),o)}},{key:"_createBlob",value:function(i){var o=null;return typeof Blob!="undefined"&&(o=new Blob([i.export()],{type:"".concat(i.options.mimeType,";charset=").concat(i.options.encoding)})),o}}],[{key:"PLUGIN_KEY",get:function(){return mwe}},{key:"PLUGIN_PRIORITY",get:function(){return vwe}}]),e}(Lt);function bwe(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}function V5(t,r){for(var e=0;e<r.length;e++){var n=r[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function wwe(t,r,e){return r&&V5(t.prototype,r),e&&V5(t,e),t}var W5=function(){function t(r,e){var n=e.id,i=e.stateless,o=i===void 0?!0:i;bwe(this,t),this.hot=r,this.id=n,this.elements=[],this.hidden=!1,this.stateId="Filters.component.".concat(this.id),this.state=o?null:this.hot.columnIndexMapper.registerMap(this.stateId,new up)}return wwe(t,[{key:"reset",value:function(){he(this.elements,function(e){return e.reset()})}},{key:"hide",value:function(){this.hidden=!0}},{key:"show",value:function(){this.hidden=!1}},{key:"isHidden",value:function(){return this.hot===null||this.hidden}},{key:"restoreState",value:function(e){this.state&&this.setState(this.state.getValueAtIndex(e))}},{key:"setState",value:function(){throw new Error("The state setting logic is not implemented")}},{key:"saveState",value:function(e){this.state&&this.state.setValueAtIndex(e,this.getState())}},{key:"getState",value:function(){throw new Error("The state gathering logic is not implemented")}},{key:"destroy",value:function(){this.hot.columnIndexMapper.unregisterMap(this.stateId),this.clearLocalHooks(),he(this.elements,function(e){return e.destroy()}),this.state=null,this.elements=null,this.hot=null}}]),t}();Ut(W5,nn);var Ly=W5,Qf={};function zo(t,r){if(!Qf[t])throw Error('Filter condition "'.concat(t,'" does not exist.'));var e=Qf[t],n=e.condition,i=e.descriptor,o=r;return i.inputValuesDecorator&&(o=i.inputValuesDecorator(o)),function(a){return n.apply(a.meta.instance,[].concat([a],[o]))}}function Au(t){if(!Qf[t])throw Error('Filter condition "'.concat(t,'" does not exist.'));return Qf[t].descriptor}function Sr(t,r,e){e.key=t,Qf[t]={condition:r,descriptor:e}}var Hr="none";function _we(){return!0}Sr(Hr,_we,{name:bp,inputsCount:0,showOperators:!1});var ec="empty";function Swe(t){return Or(t.value)}Sr(ec,Swe,{name:J1,inputsCount:0,showOperators:!0});var Hy="not_empty";function Cwe(t,r){return!zo(ec,r)(t)}Sr(Hy,Cwe,{name:Q1,inputsCount:0,showOperators:!0});function kwe(t,r){return Twe(t)||Ewe(t,r)||Rwe(t,r)||Owe()}function Owe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Rwe(t,r){if(!!t){if(typeof t=="string")return U5(t,r);var e=Object.prototype.toString.call(t).slice(8,-1);if(e==="Object"&&t.constructor&&(e=t.constructor.name),e==="Map"||e==="Set")return Array.from(t);if(e==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return U5(t,r)}}function U5(t,r){(r==null||r>t.length)&&(r=t.length);for(var e=0,n=new Array(r);e<r;e++)n[e]=t[e];return n}function Ewe(t,r){var e=t==null?null:typeof Symbol!="undefined"&&t[Symbol.iterator]||t["@@iterator"];if(e!=null){var n=[],i=!0,o=!1,a,s;try{for(e=e.call(t);!(i=(a=e.next()).done)&&(n.push(a.value),!(r&&n.length===r));i=!0);}catch(l){o=!0,s=l}finally{try{!i&&e.return!=null&&e.return()}finally{if(o)throw s}}return n}}function Twe(t){if(Array.isArray(t))return t}var tc="eq";function xwe(t,r){var e=kwe(r,1),n=e[0];return lr(t.value).toLocaleLowerCase(t.meta.locale)===lr(n)}Sr(tc,xwe,{name:e_,inputsCount:1,showOperators:!0});var Fy="neq";function Awe(t,r){return!zo(tc,r)(t)}Sr(Fy,Awe,{name:t_,inputsCount:1,showOperators:!0});function Mwe(t,r){return Nwe(t)||Dwe(t,r)||Iwe(t,r)||Pwe()}function Pwe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Iwe(t,r){if(!!t){if(typeof t=="string")return z5(t,r);var e=Object.prototype.toString.call(t).slice(8,-1);if(e==="Object"&&t.constructor&&(e=t.constructor.name),e==="Map"||e==="Set")return Array.from(t);if(e==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return z5(t,r)}}function z5(t,r){(r==null||r>t.length)&&(r=t.length);for(var e=0,n=new Array(r);e<r;e++)n[e]=t[e];return n}function Dwe(t,r){var e=t==null?null:typeof Symbol!="undefined"&&t[Symbol.iterator]||t["@@iterator"];if(e!=null){var n=[],i=!0,o=!1,a,s;try{for(e=e.call(t);!(i=(a=e.next()).done)&&(n.push(a.value),!(r&&n.length===r));i=!0);}catch(l){o=!0,s=l}finally{try{!i&&e.return!=null&&e.return()}finally{if(o)throw s}}return n}}function Nwe(t){if(Array.isArray(t))return t}var Y5="gt";function $we(t,r){var e=Mwe(r,1),n=e[0],i=n;return t.meta.type==="numeric"&&(i=parseFloat(i,10)),t.value>i}Sr(Y5,$we,{name:a_,inputsCount:1,showOperators:!0});function jwe(t,r){return Bwe(t)||Fwe(t,r)||Hwe(t,r)||Lwe()}function Lwe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Hwe(t,r){if(!!t){if(typeof t=="string")return G5(t,r);var e=Object.prototype.toString.call(t).slice(8,-1);if(e==="Object"&&t.constructor&&(e=t.constructor.name),e==="Map"||e==="Set")return Array.from(t);if(e==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return G5(t,r)}}function G5(t,r){(r==null||r>t.length)&&(r=t.length);for(var e=0,n=new Array(r);e<r;e++)n[e]=t[e];return n}function Fwe(t,r){var e=t==null?null:typeof Symbol!="undefined"&&t[Symbol.iterator]||t["@@iterator"];if(e!=null){var n=[],i=!0,o=!1,a,s;try{for(e=e.call(t);!(i=(a=e.next()).done)&&(n.push(a.value),!(r&&n.length===r));i=!0);}catch(l){o=!0,s=l}finally{try{!i&&e.return!=null&&e.return()}finally{if(o)throw s}}return n}}function Bwe(t){if(Array.isArray(t))return t}var K5="gte";function Vwe(t,r){var e=jwe(r,1),n=e[0],i=n;return t.meta.type==="numeric"&&(i=parseFloat(i,10)),t.value>=i}Sr(K5,Vwe,{name:s_,inputsCount:1,showOperators:!0});function Wwe(t,r){return Gwe(t)||Ywe(t,r)||zwe(t,r)||Uwe()}function Uwe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function zwe(t,r){if(!!t){if(typeof t=="string")return q5(t,r);var e=Object.prototype.toString.call(t).slice(8,-1);if(e==="Object"&&t.constructor&&(e=t.constructor.name),e==="Map"||e==="Set")return Array.from(t);if(e==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return q5(t,r)}}function q5(t,r){(r==null||r>t.length)&&(r=t.length);for(var e=0,n=new Array(r);e<r;e++)n[e]=t[e];return n}function Ywe(t,r){var e=t==null?null:typeof Symbol!="undefined"&&t[Symbol.iterator]||t["@@iterator"];if(e!=null){var n=[],i=!0,o=!1,a,s;try{for(e=e.call(t);!(i=(a=e.next()).done)&&(n.push(a.value),!(r&&n.length===r));i=!0);}catch(l){o=!0,s=l}finally{try{!i&&e.return!=null&&e.return()}finally{if(o)throw s}}return n}}function Gwe(t){if(Array.isArray(t))return t}var X5="lt";function Kwe(t,r){var e=Wwe(r,1),n=e[0],i=n;return t.meta.type==="numeric"&&(i=parseFloat(i,10)),t.value<i}Sr(X5,Kwe,{name:u_,inputsCount:1,showOperators:!0});function qwe(t,r){return Qwe(t)||Jwe(t,r)||Zwe(t,r)||Xwe()}function Xwe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Zwe(t,r){if(!!t){if(typeof t=="string")return Z5(t,r);var e=Object.prototype.toString.call(t).slice(8,-1);if(e==="Object"&&t.constructor&&(e=t.constructor.name),e==="Map"||e==="Set")return Array.from(t);if(e==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return Z5(t,r)}}function Z5(t,r){(r==null||r>t.length)&&(r=t.length);for(var e=0,n=new Array(r);e<r;e++)n[e]=t[e];return n}function Jwe(t,r){var e=t==null?null:typeof Symbol!="undefined"&&t[Symbol.iterator]||t["@@iterator"];if(e!=null){var n=[],i=!0,o=!1,a,s;try{for(e=e.call(t);!(i=(a=e.next()).done)&&(n.push(a.value),!(r&&n.length===r));i=!0);}catch(l){o=!0,s=l}finally{try{!i&&e.return!=null&&e.return()}finally{if(o)throw s}}return n}}function Qwe(t){if(Array.isArray(t))return t}var J5="lte";function e1e(t,r){var e=qwe(r,1),n=e[0],i=n;return t.meta.type==="numeric"&&(i=parseFloat(i,10)),t.value<=i}Sr(J5,e1e,{name:l_,inputsCount:1,showOperators:!0});function t1e(t,r){return o1e(t)||i1e(t,r)||n1e(t,r)||r1e()}function r1e(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function n1e(t,r){if(!!t){if(typeof t=="string")return Q5(t,r);var e=Object.prototype.toString.call(t).slice(8,-1);if(e==="Object"&&t.constructor&&(e=t.constructor.name),e==="Map"||e==="Set")return Array.from(t);if(e==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return Q5(t,r)}}function Q5(t,r){(r==null||r>t.length)&&(r=t.length);for(var e=0,n=new Array(r);e<r;e++)n[e]=t[e];return n}function i1e(t,r){var e=t==null?null:typeof Symbol!="undefined"&&t[Symbol.iterator]||t["@@iterator"];if(e!=null){var n=[],i=!0,o=!1,a,s;try{for(e=e.call(t);!(i=(a=e.next()).done)&&(n.push(a.value),!(r&&n.length===r));i=!0);}catch(l){o=!0,s=l}finally{try{!i&&e.return!=null&&e.return()}finally{if(o)throw s}}return n}}function o1e(t){if(Array.isArray(t))return t}var rC="date_after";function a1e(t,r){var e=t1e(r,1),n=e[0],i=$e(t.value,t.meta.dateFormat),o=$e(n,t.meta.dateFormat);return!i.isValid()||!o.isValid()?!1:i.diff(o)>=0}Sr(rC,a1e,{name:h_,inputsCount:1,showOperators:!0});function s1e(t,r){return c1e(t)||f1e(t,r)||l1e(t,r)||u1e()}function u1e(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function l1e(t,r){if(!!t){if(typeof t=="string")return e8(t,r);var e=Object.prototype.toString.call(t).slice(8,-1);if(e==="Object"&&t.constructor&&(e=t.constructor.name),e==="Map"||e==="Set")return Array.from(t);if(e==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return e8(t,r)}}function e8(t,r){(r==null||r>t.length)&&(r=t.length);for(var e=0,n=new Array(r);e<r;e++)n[e]=t[e];return n}function f1e(t,r){var e=t==null?null:typeof Symbol!="undefined"&&t[Symbol.iterator]||t["@@iterator"];if(e!=null){var n=[],i=!0,o=!1,a,s;try{for(e=e.call(t);!(i=(a=e.next()).done)&&(n.push(a.value),!(r&&n.length===r));i=!0);}catch(l){o=!0,s=l}finally{try{!i&&e.return!=null&&e.return()}finally{if(o)throw s}}return n}}function c1e(t){if(Array.isArray(t))return t}var nC="date_before";function h1e(t,r){var e=s1e(r,1),n=e[0],i=$e(t.value,t.meta.dateFormat),o=$e(n,t.meta.dateFormat);return!i.isValid()||!o.isValid()?!1:i.diff(o)<=0}Sr(nC,h1e,{name:d_,inputsCount:1,showOperators:!0});function d1e(t,r){return v1e(t)||m1e(t,r)||y1e(t,r)||p1e()}function p1e(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function y1e(t,r){if(!!t){if(typeof t=="string")return t8(t,r);var e=Object.prototype.toString.call(t).slice(8,-1);if(e==="Object"&&t.constructor&&(e=t.constructor.name),e==="Map"||e==="Set")return Array.from(t);if(e==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return t8(t,r)}}function t8(t,r){(r==null||r>t.length)&&(r=t.length);for(var e=0,n=new Array(r);e<r;e++)n[e]=t[e];return n}function m1e(t,r){var e=t==null?null:typeof Symbol!="undefined"&&t[Symbol.iterator]||t["@@iterator"];if(e!=null){var n=[],i=!0,o=!1,a,s;try{for(e=e.call(t);!(i=(a=e.next()).done)&&(n.push(a.value),!(r&&n.length===r));i=!0);}catch(l){o=!0,s=l}finally{try{!i&&e.return!=null&&e.return()}finally{if(o)throw s}}return n}}function v1e(t){if(Array.isArray(t))return t}var By="between";function g1e(t,r){var e=d1e(r,2),n=e[0],i=e[1],o=n,a=i;if(t.meta.type==="numeric"){var s=parseFloat(o,10),l=parseFloat(a,10);o=Math.min(s,l),a=Math.max(s,l)}else if(t.meta.type==="date"){var p=zo(nC,[a]),d=zo(rC,[o]);return p(t)&&d(t)}return t.value>=o&&t.value<=a}Sr(By,g1e,{name:f_,inputsCount:2,showOperators:!0});var r8="not_between";function b1e(t,r){return!zo(By,r)(t)}Sr(r8,b1e,{name:c_,inputsCount:2,showOperators:!0});function w1e(t,r){return k1e(t)||C1e(t,r)||S1e(t,r)||_1e()}function _1e(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function S1e(t,r){if(!!t){if(typeof t=="string")return n8(t,r);var e=Object.prototype.toString.call(t).slice(8,-1);if(e==="Object"&&t.constructor&&(e=t.constructor.name),e==="Map"||e==="Set")return Array.from(t);if(e==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return n8(t,r)}}function n8(t,r){(r==null||r>t.length)&&(r=t.length);for(var e=0,n=new Array(r);e<r;e++)n[e]=t[e];return n}function C1e(t,r){var e=t==null?null:typeof Symbol!="undefined"&&t[Symbol.iterator]||t["@@iterator"];if(e!=null){var n=[],i=!0,o=!1,a,s;try{for(e=e.call(t);!(i=(a=e.next()).done)&&(n.push(a.value),!(r&&n.length===r));i=!0);}catch(l){o=!0,s=l}finally{try{!i&&e.return!=null&&e.return()}finally{if(o)throw s}}return n}}function k1e(t){if(Array.isArray(t))return t}var i8="begins_with";function O1e(t,r){var e=w1e(r,1),n=e[0];return lr(t.value).toLocaleLowerCase(t.meta.locale).startsWith(lr(n))}Sr(i8,O1e,{name:r_,inputsCount:1,showOperators:!0});var R1e=pt,o8=ht,E1e=Yn.f,T1e=la,a8=xr,x1e=nb,A1e=Jr,M1e=ib,s8=o8("".endsWith),P1e=o8("".slice),I1e=Math.min,u8=M1e("endsWith"),D1e=!u8&&!!function(){var t=E1e(String.prototype,"endsWith");return t&&!t.writable}();R1e({target:"String",proto:!0,forced:!D1e&&!u8},{endsWith:function(r){var e=a8(A1e(this));x1e(r);var n=arguments.length>1?arguments[1]:void 0,i=e.length,o=n===void 0?i:I1e(T1e(n),i),a=a8(r);return s8?s8(e,a,o):P1e(e,o-a.length,o)===a}});function N1e(t,r){return H1e(t)||L1e(t,r)||j1e(t,r)||$1e()}function $1e(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function j1e(t,r){if(!!t){if(typeof t=="string")return l8(t,r);var e=Object.prototype.toString.call(t).slice(8,-1);if(e==="Object"&&t.constructor&&(e=t.constructor.name),e==="Map"||e==="Set")return Array.from(t);if(e==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return l8(t,r)}}function l8(t,r){(r==null||r>t.length)&&(r=t.length);for(var e=0,n=new Array(r);e<r;e++)n[e]=t[e];return n}function L1e(t,r){var e=t==null?null:typeof Symbol!="undefined"&&t[Symbol.iterator]||t["@@iterator"];if(e!=null){var n=[],i=!0,o=!1,a,s;try{for(e=e.call(t);!(i=(a=e.next()).done)&&(n.push(a.value),!(r&&n.length===r));i=!0);}catch(l){o=!0,s=l}finally{try{!i&&e.return!=null&&e.return()}finally{if(o)throw s}}return n}}function H1e(t){if(Array.isArray(t))return t}var f8="ends_with";function F1e(t,r){var e=N1e(r,1),n=e[0];return lr(t.value).toLocaleLowerCase(t.meta.locale).endsWith(lr(n))}Sr(f8,F1e,{name:n_,inputsCount:1,showOperators:!0});function B1e(t,r){return z1e(t)||U1e(t,r)||W1e(t,r)||V1e()}function V1e(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function W1e(t,r){if(!!t){if(typeof t=="string")return c8(t,r);var e=Object.prototype.toString.call(t).slice(8,-1);if(e==="Object"&&t.constructor&&(e=t.constructor.name),e==="Map"||e==="Set")return Array.from(t);if(e==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return c8(t,r)}}function c8(t,r){(r==null||r>t.length)&&(r=t.length);for(var e=0,n=new Array(r);e<r;e++)n[e]=t[e];return n}function U1e(t,r){var e=t==null?null:typeof Symbol!="undefined"&&t[Symbol.iterator]||t["@@iterator"];if(e!=null){var n=[],i=!0,o=!1,a,s;try{for(e=e.call(t);!(i=(a=e.next()).done)&&(n.push(a.value),!(r&&n.length===r));i=!0);}catch(l){o=!0,s=l}finally{try{!i&&e.return!=null&&e.return()}finally{if(o)throw s}}return n}}function z1e(t){if(Array.isArray(t))return t}var iC="contains";function Y1e(t,r){var e=B1e(r,1),n=e[0];return lr(t.value).toLocaleLowerCase(t.meta.locale).indexOf(lr(n))>=0}Sr(iC,Y1e,{name:i_,inputsCount:1,showOperators:!0});var h8="not_contains";function G1e(t,r){return!zo(iC,r)(t)}Sr(h8,G1e,{name:o_,inputsCount:1,showOperators:!0});var d8="date_tomorrow";function K1e(t){var r=$e(t.value,t.meta.dateFormat);return r.isValid()?r.isSame($e().subtract(-1,"days").startOf("day"),"d"):!1}Sr(d8,K1e,{name:y_,inputsCount:0});var p8="date_today";function q1e(t){var r=$e(t.value,t.meta.dateFormat);return r.isValid()?r.isSame($e().startOf("day"),"d"):!1}Sr(p8,q1e,{name:p_,inputsCount:0});var y8="date_yesterday";function X1e(t){var r=$e(t.value,t.meta.dateFormat);return r.isValid()?r.isSame($e().subtract(1,"days").startOf("day"),"d"):!1}Sr(y8,X1e,{name:m_,inputsCount:0});qE();function Z1e(t,r){var e=t;return e===""&&(e="(".concat(r,")")),e}var oC=new Set([1]).has(1),J1e=oC&&typeof Array.from=="function";function rc(t){var r=t;return oC&&(r=new Set(r)),function(e){var n;return oC?n=r.has(e):n=!!~r.indexOf(e),n}}function m8(t){return t==null?"":t}function aC(t){var r=t;return J1e?r=Array.from(new Set(r)):r=Ob(r),r=r.sort(function(e,n){return typeof e=="number"&&typeof n=="number"?e-n:e===n?0:e>n?1:-1}),r}function v8(t,r,e,n){var i=[],o=t===r,a;return o||(a=rc(r)),he(t,function(s){var l=!1;(o||a(s))&&(l=!0);var p={checked:l,value:s,visualValue:Z1e(s,e)};n&&n(p),i.push(p)}),i}function g8(t,r){return r_e(t)||t_e(t,r)||e_e(t,r)||Q1e()}function Q1e(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function e_e(t,r){if(!!t){if(typeof t=="string")return b8(t,r);var e=Object.prototype.toString.call(t).slice(8,-1);if(e==="Object"&&t.constructor&&(e=t.constructor.name),e==="Map"||e==="Set")return Array.from(t);if(e==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return b8(t,r)}}function b8(t,r){(r==null||r>t.length)&&(r=t.length);for(var e=0,n=new Array(r);e<r;e++)n[e]=t[e];return n}function t_e(t,r){var e=t==null?null:typeof Symbol!="undefined"&&t[Symbol.iterator]||t["@@iterator"];if(e!=null){var n=[],i=!0,o=!1,a,s;try{for(e=e.call(t);!(i=(a=e.next()).done)&&(n.push(a.value),!(r&&n.length===r));i=!0);}catch(l){o=!0,s=l}finally{try{!i&&e.return!=null&&e.return()}finally{if(o)throw s}}return n}}function r_e(t){if(Array.isArray(t))return t}var es="by_value";function n_e(t,r){var e=g8(r,1),n=e[0];return n(t.value)}Sr(es,n_e,{name:"By value",inputsCount:0,inputValuesDecorator:function(r){var e=g8(r,1),n=e[0];return[rc(n)]},showOperators:!1});var nc={};function i_e(t){if(!nc[t])throw Error('Operation with id "'.concat(t,'" does not exist.'));var r=nc[t].func;return function(e,n){return r(e,n)}}function o_e(t){return nc[t].name}function sC(t,r,e){nc[t]={name:r,func:e}}var Yo="conjunction",a_e=b_;function s_e(t,r){return t.every(function(e){return e.func(r)})}sC(Yo,a_e,s_e);var Vy="disjunction",u_e=wp;function l_e(t,r){return t.some(function(e){return e.func(r)})}sC(Vy,u_e,l_e);var uC="disjunctionWithExtraCondition",f_e=wp;function c_e(t,r){if(t.length<3)throw Error("Operation doesn't work on less then three conditions.");return t.slice(0,t.length-1).some(function(e){return e.func(r)})&&t[t.length-1].func(r)}sC(uC,f_e,c_e);var ic;function lC(t,r,e){return r in t?Object.defineProperty(t,r,{value:e,enumerable:!0,configurable:!0,writable:!0}):t[r]=e,t}var h_e="numeric",w8="text",d_e="date",_8=(ic={},lC(ic,h_e,[Hr,St,ec,Hy,St,tc,Fy,St,Y5,K5,X5,J5,By,r8]),lC(ic,w8,[Hr,St,ec,Hy,St,tc,Fy,St,i8,f8,St,iC,h8]),lC(ic,d_e,[Hr,St,ec,Hy,St,tc,Fy,St,nC,rC,By,St,d8,p8,y8]),ic);function p_e(t){var r=[],e=t;return _8[e]||(e=w8),he(_8[e],function(n){var i;n===St?i={name:St}:i=Br(Au(n)),r.push(i)}),r}function y_e(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}function S8(t,r){for(var e=0;e<r.length;e++){var n=r[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function m_e(t,r,e){return r&&S8(t.prototype,r),e&&S8(t,e),t}var fC="built",cC="building",C8=["click","input","keydown","keypress","keyup","focus","blur","change"],k8=function(){function t(r,e){y_e(this,t),this.hot=r,this.eventManager=new Wt(this),this.options=or(t.DEFAULTS,e),this._element=this.hot.rootDocument.createElement(this.options.wrapIt?"div":this.options.tagName),this.buildState=null}return m_e(t,[{key:"setValue",value:function(e){this.options.value=e,this.update()}},{key:"getValue",value:function(){return this.options.value}},{key:"element",get:function(){return this.buildState===cC?this._element:this.buildState===fC?(this.update(),this._element):(this.buildState=cC,this.build(),this.buildState=fC,this._element)}},{key:"isBuilt",value:function(){return this.buildState===fC}},{key:"translateIfPossible",value:function(e){return typeof e=="string"&&e.startsWith(Gr)?this.hot.getTranslatedPhrase(e):e}},{key:"build",value:function(){var e=this,n=function(a,s){e.eventManager.addEventListener(a,s,function(l){return e.runLocalHooks(s,l,e)})};if(this.buildState||(this.buildState=cC),this.options.className&&Ie(this._element,this.options.className),this.options.children.length)he(this.options.children,function(o){return e._element.appendChild(o.element)});else if(this.options.wrapIt){var i=this.hot.rootDocument.createElement(this.options.tagName);Ot(this.options,function(o,a){i[a]!==void 0&&a!=="className"&&a!=="tagName"&&a!=="children"&&(i[a]=e.translateIfPossible(o))}),this._element.appendChild(i),he(C8,function(o){return n(i,o)})}else he(C8,function(o){return n(e._element,o)})}},{key:"update",value:function(){}},{key:"reset",value:function(){this.options.value="",this.update()}},{key:"show",value:function(){this.element.style.display=""}},{key:"hide",value:function(){this.element.style.display="none"}},{key:"focus",value:function(){}},{key:"destroy",value:function(){this.eventManager.destroy(),this.eventManager=null,this.hot=null,this._element.parentNode&&this._element.parentNode.removeChild(this._element),this._element=null}}],[{key:"DEFAULTS",get:function(){return Br({className:"",value:"",tagName:"div",children:[],wrapIt:!0})}}]),t}();Ut(k8,nn);var Go=k8;function Wy(t){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?Wy=function(e){return typeof e}:Wy=function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Wy(t)}function v_e(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}function O8(t,r){for(var e=0;e<r.length;e++){var n=r[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function g_e(t,r,e){return r&&O8(t.prototype,r),e&&O8(t,e),t}function Uy(){return typeof Reflect!="undefined"&&Reflect.get?Uy=Reflect.get:Uy=function(r,e,n){var i=b_e(r,e);if(!!i){var o=Object.getOwnPropertyDescriptor(i,e);return o.get?o.get.call(arguments.length<3?r:n):o.value}},Uy.apply(this,arguments)}function b_e(t,r){for(;!Object.prototype.hasOwnProperty.call(t,r)&&(t=Mu(t),t!==null););return t}function w_e(t,r){if(typeof r!="function"&&r!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(r&&r.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),r&&hC(t,r)}function hC(t,r){return hC=Object.setPrototypeOf||function(n,i){return n.__proto__=i,n},hC(t,r)}function __e(t){var r=C_e();return function(){var n=Mu(t),i;if(r){var o=Mu(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return S_e(this,i)}}function S_e(t,r){if(r&&(Wy(r)==="object"||typeof r=="function"))return r;if(r!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return R8(t)}function R8(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function C_e(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Mu(t){return Mu=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},Mu(t)}var zy=new WeakMap,k_e=function(t){w_e(e,t);var r=__e(e);function e(n,i){var o;return v_e(this,e),o=r.call(this,n,or(e.DEFAULTS,i)),zy.set(R8(o),{}),o.registerHooks(),o}return g_e(e,[{key:"registerHooks",value:function(){var i=this;this.addLocalHook("click",function(){return i.onClick()}),this.addLocalHook("keyup",function(o){return i.onKeyup(o)})}},{key:"build",value:function(){Uy(Mu(e.prototype),"build",this).call(this);var i=zy.get(this),o=this.hot.rootDocument.createElement("div");i.input=this._element.firstChild,Ie(this._element,"htUIInput"),Ie(o,"htUIInputIcon"),this._element.appendChild(o),this.update()}},{key:"update",value:function(){if(!!this.isBuilt()){var i=zy.get(this).input;i.type=this.options.type,i.placeholder=this.translateIfPossible(this.options.placeholder),i.value=this.translateIfPossible(this.options.value)}}},{key:"focus",value:function(){this.isBuilt()&&zy.get(this).input.focus()}},{key:"onClick",value:function(){}},{key:"onKeyup",value:function(i){this.options.value=i.target.value}}],[{key:"DEFAULTS",get:function(){return Br({placeholder:"",type:"text",tagName:"input"})}}]),e}(Go),Pu=k_e;function Yy(t){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?Yy=function(e){return typeof e}:Yy=function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Yy(t)}function O_e(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}function E8(t,r){for(var e=0;e<r.length;e++){var n=r[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function R_e(t,r,e){return r&&E8(t.prototype,r),e&&E8(t,e),t}function Iu(){return typeof Reflect!="undefined"&&Reflect.get?Iu=Reflect.get:Iu=function(r,e,n){var i=E_e(r,e);if(!!i){var o=Object.getOwnPropertyDescriptor(i,e);return o.get?o.get.call(arguments.length<3?r:n):o.value}},Iu.apply(this,arguments)}function E_e(t,r){for(;!Object.prototype.hasOwnProperty.call(t,r)&&(t=Ko(t),t!==null););return t}function T_e(t,r){if(typeof r!="function"&&r!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(r&&r.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),r&&dC(t,r)}function dC(t,r){return dC=Object.setPrototypeOf||function(n,i){return n.__proto__=i,n},dC(t,r)}function x_e(t){var r=M_e();return function(){var n=Ko(t),i;if(r){var o=Ko(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return A_e(this,i)}}function A_e(t,r){if(r&&(Yy(r)==="object"||typeof r=="function"))return r;if(r!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return T8(t)}function T8(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function M_e(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Ko(t){return Ko=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},Ko(t)}var Gy=new WeakMap,P_e=function(t){T_e(e,t);var r=x_e(e);function e(n,i){var o;return O_e(this,e),o=r.call(this,n,or(e.DEFAULTS,i)),Gy.set(T8(o),{}),o.menu=null,o.items=[],o.registerHooks(),o}return R_e(e,[{key:"registerHooks",value:function(){var i=this;this.addLocalHook("click",function(){return i.onClick()})}},{key:"setItems",value:function(i){this.items=this.translateNames(i),this.menu&&this.menu.setMenuItems(this.items)}},{key:"translateNames",value:function(i){var o=this;return he(i,function(a){a.name=o.translateIfPossible(a.name)}),i}},{key:"build",value:function(){var i=this;Iu(Ko(e.prototype),"build",this).call(this),this.menu=new BS(this.hot,{className:"htSelectUI htFiltersConditionsMenu",keepInViewport:!1,standalone:!0,container:this.options.menuContainer}),this.menu.setMenuItems(this.items);var o=new Go(this.hot,{className:"htUISelectCaption"}),a=new Go(this.hot,{className:"htUISelectDropdown"}),s=Gy.get(this);s.caption=o,s.captionElement=o.element,s.dropdown=a,he([o,a],function(l){return i._element.appendChild(l.element)}),this.menu.addLocalHook("select",function(l){return i.onMenuSelect(l)}),this.menu.addLocalHook("afterClose",function(){return i.onMenuClosed()}),this.update()}},{key:"update",value:function(){if(!!this.isBuilt()){var i;this.options.value?i=this.options.value.name:i=this.menu.hot.getTranslatedPhrase(bp),Gy.get(this).captionElement.textContent=i,Iu(Ko(e.prototype),"update",this).call(this)}}},{key:"openOptions",value:function(){var i=this.element.getBoundingClientRect();this.menu&&(this.menu.open(),this.menu.setPosition({left:i.left-5,top:i.top-1,width:i.width,height:i.height}))}},{key:"closeOptions",value:function(){this.menu&&this.menu.close()}},{key:"onMenuSelect",value:function(i){i.name!==St&&(this.options.value=i,this.update(),this.runLocalHooks("select",this.options.value))}},{key:"onMenuClosed",value:function(){this.runLocalHooks("afterClose")}},{key:"onClick",value:function(){this.openOptions()}},{key:"destroy",value:function(){this.menu&&(this.menu.destroy(),this.menu=null);var i=Gy.get(this),o=i.caption,a=i.dropdown;o&&o.destroy(),a&&a.destroy(),Iu(Ko(e.prototype),"destroy",this).call(this)}}],[{key:"DEFAULTS",get:function(){return Br({className:"htUISelect",wrapIt:!1})}}]),e}(Go),x8=P_e;function Ky(t){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?Ky=function(e){return typeof e}:Ky=function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ky(t)}function I_e(t){return j_e(t)||$_e(t)||N_e(t)||D_e()}function D_e(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function N_e(t,r){if(!!t){if(typeof t=="string")return pC(t,r);var e=Object.prototype.toString.call(t).slice(8,-1);if(e==="Object"&&t.constructor&&(e=t.constructor.name),e==="Map"||e==="Set")return Array.from(t);if(e==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return pC(t,r)}}function $_e(t){if(typeof Symbol!="undefined"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function j_e(t){if(Array.isArray(t))return pC(t)}function pC(t,r){(r==null||r>t.length)&&(r=t.length);for(var e=0,n=new Array(r);e<r;e++)n[e]=t[e];return n}function L_e(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}function A8(t,r){for(var e=0;e<r.length;e++){var n=r[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function H_e(t,r,e){return r&&A8(t.prototype,r),e&&A8(t,e),t}function qy(){return typeof Reflect!="undefined"&&Reflect.get?qy=Reflect.get:qy=function(r,e,n){var i=F_e(r,e);if(!!i){var o=Object.getOwnPropertyDescriptor(i,e);return o.get?o.get.call(arguments.length<3?r:n):o.value}},qy.apply(this,arguments)}function F_e(t,r){for(;!Object.prototype.hasOwnProperty.call(t,r)&&(t=Du(t),t!==null););return t}function B_e(t,r){if(typeof r!="function"&&r!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(r&&r.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),r&&yC(t,r)}function yC(t,r){return yC=Object.setPrototypeOf||function(n,i){return n.__proto__=i,n},yC(t,r)}function V_e(t){var r=z_e();return function(){var n=Du(t),i;if(r){var o=Du(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return W_e(this,i)}}function W_e(t,r){if(r&&(Ky(r)==="object"||typeof r=="function"))return r;if(r!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return U_e(t)}function U_e(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function z_e(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Du(t){return Du=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},Du(t)}var Y_e=function(t){B_e(e,t);var r=V_e(e);function e(n,i){var o;return L_e(this,e),o=r.call(this,n,{id:i.id,stateless:!1}),o.name=i.name,o.addSeparator=i.addSeparator,o.elements.push(new x8(o.hot,{menuContainer:i.menuContainer})),o.elements.push(new Pu(o.hot,{placeholder:O_})),o.elements.push(new Pu(o.hot,{placeholder:R_})),o.registerHooks(),o}return H_e(e,[{key:"registerHooks",value:function(){var i=this;this.getSelectElement().addLocalHook("select",function(o){return i.onConditionSelect(o)}),this.getSelectElement().addLocalHook("afterClose",function(){return i.onSelectUIClosed()}),he(this.getInputElements(),function(o){o.addLocalHook("keydown",function(a){return i.onInputKeyDown(a)})})}},{key:"setState",value:function(i){var o=this;if(this.reset(),!!i){var a=Br(i.command);a.name.startsWith(fr)&&(a.name=this.hot.getTranslatedPhrase(a.name)),this.getSelectElement().setValue(a),he(i.args,function(s,l){if(l>a.inputsCount-1)return!1;var p=o.getInputElement(l);p.setValue(s),p[a.inputsCount>l?"show":"hide"](),l||setTimeout(function(){return p.focus()},10)})}}},{key:"getState",value:function(){var i=this.getSelectElement().getValue()||Au(Hr),o=[];return he(this.getInputElements(),function(a,s){i.inputsCount>s&&o.push(a.getValue())}),{command:i,args:o}}},{key:"updateState",value:function(i,o){var a=Au(i?i.name:Hr);this.state.setValueAtIndex(o,{command:a,args:i?i.args:[]}),i||he(this.getInputElements(),function(s){return s.setValue(null)})}},{key:"getSelectElement",value:function(){return this.elements.filter(function(i){return i instanceof x8})[0]}},{key:"getInputElement",value:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return this.getInputElements()[i]}},{key:"getInputElements",value:function(){return this.elements.filter(function(i){return i instanceof Pu})}},{key:"getMenuItemDescriptor",value:function(){var i=this;return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:function(){return i.isHidden()},renderer:function(a,s,l,p,d,g){Ie(s.parentNode,"htFiltersMenuCondition"),i.addSeparator&&Ie(s.parentNode,"border");var y=i.hot.rootDocument.createElement("div");return Ie(y,"htFiltersMenuLabel"),y.textContent=g,s.appendChild(y),s.parentNode.hasAttribute("ghost-table")||he(i.elements,function(h){return s.appendChild(h.element)}),s}}}},{key:"reset",value:function(){var i,o=this.hot.getPlugin("filters").getSelectedColumn(),a=o&&o.visualIndex,s=(i=this.hot).getDataType.apply(i,I_e(this.hot.getSelectedLast()||[0,a])),l=p_e(s);he(this.getInputElements(),function(p){return p.hide()}),this.getSelectElement().setItems(l),qy(Du(e.prototype),"reset",this).call(this),this.getSelectElement().setValue(l[0])}},{key:"onConditionSelect",value:function(i){he(this.getInputElements(),function(o,a){o[i.inputsCount>a?"show":"hide"](),a===0&&setTimeout(function(){return o.focus()},10)}),this.runLocalHooks("change",i)}},{key:"onSelectUIClosed",value:function(){this.runLocalHooks("afterClose")}},{key:"onInputKeyDown",value:function(i){No(i.keyCode,"ENTER")?(this.runLocalHooks("accept"),rr(i)):No(i.keyCode,"ESCAPE")&&(this.runLocalHooks("cancel"),rr(i))}}]),e}(Ly),mC=Y_e;function Xy(t){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?Xy=function(e){return typeof e}:Xy=function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Xy(t)}function G_e(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}function M8(t,r){for(var e=0;e<r.length;e++){var n=r[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function K_e(t,r,e){return r&&M8(t.prototype,r),e&&M8(t,e),t}function Zy(){return typeof Reflect!="undefined"&&Reflect.get?Zy=Reflect.get:Zy=function(r,e,n){var i=q_e(r,e);if(!!i){var o=Object.getOwnPropertyDescriptor(i,e);return o.get?o.get.call(arguments.length<3?r:n):o.value}},Zy.apply(this,arguments)}function q_e(t,r){for(;!Object.prototype.hasOwnProperty.call(t,r)&&(t=Nu(t),t!==null););return t}function X_e(t,r){if(typeof r!="function"&&r!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(r&&r.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),r&&vC(t,r)}function vC(t,r){return vC=Object.setPrototypeOf||function(n,i){return n.__proto__=i,n},vC(t,r)}function Z_e(t){var r=Q_e();return function(){var n=Nu(t),i;if(r){var o=Nu(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return J_e(this,i)}}function J_e(t,r){if(r&&(Xy(r)==="object"||typeof r=="function"))return r;if(r!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return P8(t)}function P8(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Q_e(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Nu(t){return Nu=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},Nu(t)}var Jy=new WeakMap,eSe=function(t){X_e(e,t);var r=Z_e(e);function e(n,i){var o;return G_e(this,e),o=r.call(this,n,or(e.DEFAULTS,i)),Jy.set(P8(o),{}),o}return K_e(e,[{key:"build",value:function(){Zy(Nu(e.prototype),"build",this).call(this);var i=Jy.get(this);i.input=this._element.firstChild;var o=this.hot.rootDocument.createElement("label");o.textContent=this.translateIfPossible(this.options.label.textContent),o.htmlFor=this.translateIfPossible(this.options.label.htmlFor),i.label=o,this._element.appendChild(o),this.update()}},{key:"update",value:function(){if(!!this.isBuilt()){var i=Jy.get(this);i.input.checked=this.options.checked,i.label.textContent=this.translateIfPossible(this.options.label.textContent)}}},{key:"isChecked",value:function(){return this.options.checked}},{key:"setChecked",value:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.options.checked=i,this.update()}},{key:"focus",value:function(){this.isBuilt()&&Jy.get(this).input.focus()}}],[{key:"DEFAULTS",get:function(){return Br({type:"radio",tagName:"input",className:"htUIRadio",label:{}})}}]),e}(Go),I8=eSe;function Qy(t){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?Qy=function(e){return typeof e}:Qy=function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Qy(t)}var D8;function tSe(t,r){return r||(r=t.slice(0)),Object.freeze(Object.defineProperties(t,{raw:{value:Object.freeze(r)}}))}function rSe(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}function N8(t,r){for(var e=0;e<r.length;e++){var n=r[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function nSe(t,r,e){return r&&N8(t.prototype,r),e&&N8(t,e),t}function iSe(t,r){if(typeof r!="function"&&r!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(r&&r.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),r&&gC(t,r)}function gC(t,r){return gC=Object.setPrototypeOf||function(n,i){return n.__proto__=i,n},gC(t,r)}function oSe(t){var r=uSe();return function(){var n=em(t),i;if(r){var o=em(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return aSe(this,i)}}function aSe(t,r){if(r&&(Qy(r)==="object"||typeof r=="function"))return r;if(r!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return sSe(t)}function sSe(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function uSe(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function em(t){return em=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},em(t)}var $8=0,lSe=function(t){iSe(e,t);var r=oSe(e);function e(n,i){var o;return rSe(this,e),o=r.call(this,n,{id:i.id,stateless:!1}),o.name=i.name,o.buildOperatorsElement(),o}return nSe(e,[{key:"getMenuItemDescriptor",value:function(){var i=this;return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:function(){return i.isHidden()},renderer:function(a,s){return Ie(s.parentNode,"htFiltersMenuOperators"),s.parentNode.hasAttribute("ghost-table")||he(i.elements,function(l){return s.appendChild(l.element)}),s}}}},{key:"buildOperatorsElement",value:function(){var i=this,o=[Yo,Vy];he(o,function(a){var s=new I8(i.hot,{name:"operator",label:{htmlFor:a,textContent:o_e(a)},value:a,checked:a===o[$8],id:a});s.addLocalHook("change",function(l){return i.onRadioInputChange(l)}),i.elements.push(s)})}},{key:"setChecked",value:function(i){if(this.elements.length<i)throw Error(Kt(D8||(D8=tSe(["Radio button with index "," doesn't exist."])),i));he(this.elements,function(o,a){o.setChecked(a===i)})}},{key:"getActiveOperationId",value:function(){var i=this.elements.find(function(o){return o instanceof I8&&o.isChecked()});return i?i.getValue():Yo}},{key:"getState",value:function(){return this.getActiveOperationId()}},{key:"setState",value:function(i){this.reset(),i&&this.getActiveOperationId()!==i&&he(this.elements,function(o){o.setChecked(o.getValue()===i)})}},{key:"updateState",value:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Yo,o=arguments.length>1?arguments[1]:void 0,a=i;a===uC&&(a=Vy),this.state.setValueAtIndex(o,a)}},{key:"reset",value:function(){this.setChecked($8)}},{key:"onRadioInputChange",value:function(i){this.setState(i.target.value)}}]),e}(Ly),fSe=lSe,cSe=ht,hSe=Jr,j8=xr,dSe=/"/g,pSe=cSe("".replace),ySe=function(t,r,e,n){var i=j8(hSe(t)),o="<"+r;return e!==""&&(o+=" "+e+'="'+pSe(j8(n),dSe,"&quot;")+'"'),o+">"+i+"</"+r+">"},mSe=Mt,vSe=function(t){return mSe(function(){var r=""[t]('"');return r!==r.toLowerCase()||r.split('"').length>3})},gSe=pt,bSe=ySe,wSe=vSe;gSe({target:"String",proto:!0,forced:wSe("link")},{link:function(r){return bSe(this,"a","href",r)}});function tm(t){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?tm=function(e){return typeof e}:tm=function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},tm(t)}function _Se(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}function L8(t,r){for(var e=0;e<r.length;e++){var n=r[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function SSe(t,r,e){return r&&L8(t.prototype,r),e&&L8(t,e),t}function rm(){return typeof Reflect!="undefined"&&Reflect.get?rm=Reflect.get:rm=function(r,e,n){var i=CSe(r,e);if(!!i){var o=Object.getOwnPropertyDescriptor(i,e);return o.get?o.get.call(arguments.length<3?r:n):o.value}},rm.apply(this,arguments)}function CSe(t,r){for(;!Object.prototype.hasOwnProperty.call(t,r)&&(t=$u(t),t!==null););return t}function kSe(t,r){if(typeof r!="function"&&r!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(r&&r.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),r&&bC(t,r)}function bC(t,r){return bC=Object.setPrototypeOf||function(n,i){return n.__proto__=i,n},bC(t,r)}function OSe(t){var r=ESe();return function(){var n=$u(t),i;if(r){var o=$u(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return RSe(this,i)}}function RSe(t,r){if(r&&(tm(r)==="object"||typeof r=="function"))return r;if(r!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return H8(t)}function H8(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function ESe(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function $u(t){return $u=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},$u(t)}var wC=new WeakMap,TSe=function(t){kSe(e,t);var r=OSe(e);function e(n,i){var o;return _Se(this,e),o=r.call(this,n,or(e.DEFAULTS,i)),wC.set(H8(o),{}),o}return SSe(e,[{key:"build",value:function(){rm($u(e.prototype),"build",this).call(this);var i=wC.get(this);i.link=this._element.firstChild}},{key:"update",value:function(){!this.isBuilt()||(wC.get(this).link.textContent=this.translateIfPossible(this.options.textContent))}}],[{key:"DEFAULTS",get:function(){return Br({href:"#",tagName:"a"})}}]),e}(Go),F8=TSe;function nm(t){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?nm=function(e){return typeof e}:nm=function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},nm(t)}function B8(t){return PSe(t)||MSe(t)||ASe(t)||xSe()}function xSe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function ASe(t,r){if(!!t){if(typeof t=="string")return _C(t,r);var e=Object.prototype.toString.call(t).slice(8,-1);if(e==="Object"&&t.constructor&&(e=t.constructor.name),e==="Map"||e==="Set")return Array.from(t);if(e==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return _C(t,r)}}function MSe(t){if(typeof Symbol!="undefined"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function PSe(t){if(Array.isArray(t))return _C(t)}function _C(t,r){(r==null||r>t.length)&&(r=t.length);for(var e=0,n=new Array(r);e<r;e++)n[e]=t[e];return n}function ISe(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}function V8(t,r){for(var e=0;e<r.length;e++){var n=r[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function DSe(t,r,e){return r&&V8(t.prototype,r),e&&V8(t,e),t}function ju(){return typeof Reflect!="undefined"&&Reflect.get?ju=Reflect.get:ju=function(r,e,n){var i=NSe(r,e);if(!!i){var o=Object.getOwnPropertyDescriptor(i,e);return o.get?o.get.call(arguments.length<3?r:n):o.value}},ju.apply(this,arguments)}function NSe(t,r){for(;!Object.prototype.hasOwnProperty.call(t,r)&&(t=qo(t),t!==null););return t}function $Se(t,r){if(typeof r!="function"&&r!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(r&&r.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),r&&SC(t,r)}function SC(t,r){return SC=Object.setPrototypeOf||function(n,i){return n.__proto__=i,n},SC(t,r)}function jSe(t){var r=HSe();return function(){var n=qo(t),i;if(r){var o=qo(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return LSe(this,i)}}function LSe(t,r){if(r&&(nm(r)==="object"||typeof r=="function"))return r;if(r!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return W8(t)}function W8(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function HSe(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function qo(t){return qo=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},qo(t)}var FSe=new WeakMap,BSe=function(t){$Se(e,t);var r=jSe(e);function e(n,i){var o;return ISe(this,e),o=r.call(this,n,or(e.DEFAULTS,i)),FSe.set(W8(o),{}),o.searchInput=new Pu(o.hot,{placeholder:k_,className:"htUIMultipleSelectSearch"}),o.selectAllUI=new F8(o.hot,{textContent:w_,className:"htUISelectAll"}),o.clearAllUI=new F8(o.hot,{textContent:__,className:"htUIClearAll"}),o.items=[],o.itemsBox=null,o.registerHooks(),o}return DSe(e,[{key:"registerHooks",value:function(){var i=this;this.searchInput.addLocalHook("keydown",function(o){return i.onInputKeyDown(o)}),this.searchInput.addLocalHook("input",function(o){return i.onInput(o)}),this.selectAllUI.addLocalHook("click",function(o){return i.onSelectAllClick(o)}),this.clearAllUI.addLocalHook("click",function(o){return i.onClearAllClick(o)})}},{key:"setItems",value:function(i){this.items=i,this.itemsBox&&this.itemsBox.loadData(this.items)}},{key:"setLocale",value:function(i){this.locale=i}},{key:"getLocale",value:function(){return this.locale}},{key:"getItems",value:function(){return B8(this.items)}},{key:"getValue",value:function(){return WSe(this.items)}},{key:"isSelectedAllValues",value:function(){return this.items.length===this.getValue().length}},{key:"build",value:function(){var i=this;ju(qo(e.prototype),"build",this).call(this);var o=this.hot.rootDocument,a=o.createElement("div"),s=new Go(this.hot,{className:"htUISelectionControls",children:[this.selectAllUI,this.clearAllUI]});this._element.appendChild(this.searchInput.element),this._element.appendChild(s.element),this._element.appendChild(a);var l=function(d){!i._element||(i.itemsBox&&i.itemsBox.destroy(),Ie(d,"htUIMultipleSelectHot"),i.itemsBox=new i.hot.constructor(d,{data:i.items,columns:[{data:"checked",type:"checkbox",label:{property:"visualValue",position:"after"}}],beforeRenderer:function(y,h,u,f,c,v){y.title=v.instance.getDataAtRowProp(h,v.label.property)},maxCols:1,autoWrapCol:!0,height:110,colWidths:function(){return i.itemsBox.container.scrollWidth-Pr(o)},copyPaste:!1,disableVisualSelection:"area",fillHandle:!1,fragmentSelection:"cell",tabMoves:{row:1,col:0},beforeKeyDown:function(y){return i.onItemsBoxBeforeKeyDown(y)}}),i.itemsBox.init())};l(a),setTimeout(function(){return l(a)},100)}},{key:"reset",value:function(){this.searchInput.reset(),this.selectAllUI.reset(),this.clearAllUI.reset()}},{key:"update",value:function(){!this.isBuilt()||(this.itemsBox.loadData(VSe(this.items,this.options.value)),ju(qo(e.prototype),"update",this).call(this))}},{key:"destroy",value:function(){this.itemsBox&&this.itemsBox.destroy(),this.searchInput.destroy(),this.clearAllUI.destroy(),this.selectAllUI.destroy(),this.searchInput=null,this.clearAllUI=null,this.selectAllUI=null,this.itemsBox=null,this.items=null,ju(qo(e.prototype),"destroy",this).call(this)}},{key:"onInput",value:function(i){var o=this,a=i.target.value.toLocaleLowerCase(this.getLocale()),s;a===""?s=B8(this.items):s=un(this.items,function(l){return"".concat(l.value).toLocaleLowerCase(o.getLocale()).indexOf(a)>=0}),this.itemsBox.loadData(s)}},{key:"onInputKeyDown",value:function(i){this.runLocalHooks("keydown",i,this);var o=hf(No,i.keyCode);o("ARROW_DOWN|TAB")&&!this.itemsBox.isListening()&&(rr(i),this.itemsBox.listen(),this.itemsBox.selectCell(0,0))}},{key:"onItemsBoxBeforeKeyDown",value:function(i){var o=hf(No,i.keyCode);o("ESCAPE")&&this.runLocalHooks("keydown",i,this),o("ARROW_UP|ARROW_DOWN|ARROW_LEFT|ARROW_RIGHT|TAB|SPACE|ENTER")||(rr(i),this.itemsBox.unlisten(),this.itemsBox.deselectCell(),this.searchInput.focus())}},{key:"onSelectAllClick",value:function(i){var o=[];i.preventDefault(),he(this.itemsBox.getSourceData(),function(a,s){a.checked=!0,o.push(Vw(a,s)[0])}),this.itemsBox.setSourceDataAtCell(o)}},{key:"onClearAllClick",value:function(i){var o=[];i.preventDefault(),he(this.itemsBox.getSourceData(),function(a,s){a.checked=!1,o.push(Vw(a,s)[0])}),this.itemsBox.setSourceDataAtCell(o)}}],[{key:"DEFAULTS",get:function(){return Br({className:"htUIMultipleSelect",value:[]})}}]),e}(Go),U8=BSe;function VSe(t,r){var e=rc(r);return bt(t,function(n){return n.checked=e(n.value),n})}function WSe(t){var r=[];return he(t,function(e){e.checked&&r.push(e.value)}),r}function im(t){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?im=function(e){return typeof e}:im=function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},im(t)}function USe(t,r){return KSe(t)||GSe(t,r)||YSe(t,r)||zSe()}function zSe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function YSe(t,r){if(!!t){if(typeof t=="string")return z8(t,r);var e=Object.prototype.toString.call(t).slice(8,-1);if(e==="Object"&&t.constructor&&(e=t.constructor.name),e==="Map"||e==="Set")return Array.from(t);if(e==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return z8(t,r)}}function z8(t,r){(r==null||r>t.length)&&(r=t.length);for(var e=0,n=new Array(r);e<r;e++)n[e]=t[e];return n}function GSe(t,r){var e=t==null?null:typeof Symbol!="undefined"&&t[Symbol.iterator]||t["@@iterator"];if(e!=null){var n=[],i=!0,o=!1,a,s;try{for(e=e.call(t);!(i=(a=e.next()).done)&&(n.push(a.value),!(r&&n.length===r));i=!0);}catch(l){o=!0,s=l}finally{try{!i&&e.return!=null&&e.return()}finally{if(o)throw s}}return n}}function KSe(t){if(Array.isArray(t))return t}function qSe(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}function Y8(t,r){for(var e=0;e<r.length;e++){var n=r[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function XSe(t,r,e){return r&&Y8(t.prototype,r),e&&Y8(t,e),t}function om(){return typeof Reflect!="undefined"&&Reflect.get?om=Reflect.get:om=function(r,e,n){var i=ZSe(r,e);if(!!i){var o=Object.getOwnPropertyDescriptor(i,e);return o.get?o.get.call(arguments.length<3?r:n):o.value}},om.apply(this,arguments)}function ZSe(t,r){for(;!Object.prototype.hasOwnProperty.call(t,r)&&(t=Lu(t),t!==null););return t}function JSe(t,r){if(typeof r!="function"&&r!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(r&&r.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),r&&CC(t,r)}function CC(t,r){return CC=Object.setPrototypeOf||function(n,i){return n.__proto__=i,n},CC(t,r)}function QSe(t){var r=rCe();return function(){var n=Lu(t),i;if(r){var o=Lu(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return eCe(this,i)}}function eCe(t,r){if(r&&(im(r)==="object"||typeof r=="function"))return r;if(r!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return tCe(t)}function tCe(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function rCe(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Lu(t){return Lu=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},Lu(t)}var nCe=function(t){JSe(e,t);var r=QSe(e);function e(n,i){var o;return qSe(this,e),o=r.call(this,n,{id:i.id,stateless:!1}),o.name=i.name,o.elements.push(new U8(o.hot)),o.registerHooks(),o}return XSe(e,[{key:"registerHooks",value:function(){var i=this;this.getMultipleSelectElement().addLocalHook("keydown",function(o){return i.onInputKeyDown(o)})}},{key:"setState",value:function(i){if(this.reset(),i&&i.command.key===es){var o=this.getMultipleSelectElement();o.setItems(i.itemsSnapshot),o.setValue(i.args[0]),o.setLocale(i.locale)}}},{key:"getState",value:function(){var i=this.getMultipleSelectElement(),o=i.getItems();return{command:{key:i.isSelectedAllValues()||!o.length?Hr:es},args:[i.getValue()],itemsSnapshot:o}}},{key:"updateState",value:function(i){var o=this,a=function(l,p,d,g,y){var h=un(p,function(C){return C.name===es}),u=USe(h,1),f=u[0],c={},v=o.hot.getTranslatedPhrase(_p);if(f){var m=aC(bt(g(l,y),function(C){return C.value}));d&&(f.args[0]=d);var b=[],w=v8(m,f.args[0],v,function(C){C.checked&&b.push(C.value)}),_=i.editedConditionStack.column;c.locale=o.hot.getCellMeta(0,_).locale,c.args=[b],c.command=Au(es),c.itemsSnapshot=w}else c.args=[],c.command=Au(Hr);o.state.setValueAtIndex(l,c)};a(i.editedConditionStack.column,i.editedConditionStack.conditions,i.conditionArgsChange,i.filteredRowsFactory),i.dependentConditionStacks.length&&a(i.dependentConditionStacks[0].column,i.dependentConditionStacks[0].conditions,i.conditionArgsChange,i.filteredRowsFactory,i.editedConditionStack)}},{key:"getMultipleSelectElement",value:function(){return this.elements.filter(function(i){return i instanceof U8})[0]}},{key:"getMenuItemDescriptor",value:function(){var i=this;return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:function(){return i.isHidden()},renderer:function(a,s,l,p,d,g){Ie(s.parentNode,"htFiltersMenuValue");var y=i.hot.rootDocument.createElement("div");return Ie(y,"htFiltersMenuLabel"),y.textContent=g,s.appendChild(y),s.parentNode.hasAttribute("ghost-table")||he(i.elements,function(h){return s.appendChild(h.element)}),s}}}},{key:"reset",value:function(){var i=this.hot.getTranslatedPhrase(_p),o=aC(this._getColumnVisibleValues()),a=v8(o,o,i);this.getMultipleSelectElement().setItems(a),om(Lu(e.prototype),"reset",this).call(this),this.getMultipleSelectElement().setValue(o);var s=this.hot.getPlugin("filters").getSelectedColumn().visualIndex;this.getMultipleSelectElement().setLocale(this.hot.getCellMeta(0,s).locale)}},{key:"onInputKeyDown",value:function(i){No(i.keyCode,"ESCAPE")&&(this.runLocalHooks("cancel"),rr(i))}},{key:"_getColumnVisibleValues",value:function(){var i=this.hot.getPlugin("filters").getSelectedColumn(),o=i&&i.visualIndex;return bt(this.hot.getDataAtCol(o),function(a){return m8(a)})}}]),e}(Ly),iCe=nCe;function am(t){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?am=function(e){return typeof e}:am=function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},am(t)}function oCe(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}function G8(t,r){for(var e=0;e<r.length;e++){var n=r[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function aCe(t,r,e){return r&&G8(t.prototype,r),e&&G8(t,e),t}function sCe(t,r){if(typeof r!="function"&&r!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(r&&r.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),r&&kC(t,r)}function kC(t,r){return kC=Object.setPrototypeOf||function(n,i){return n.__proto__=i,n},kC(t,r)}function uCe(t){var r=cCe();return function(){var n=sm(t),i;if(r){var o=sm(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return lCe(this,i)}}function lCe(t,r){if(r&&(am(r)==="object"||typeof r=="function"))return r;if(r!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return fCe(t)}function fCe(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function cCe(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function sm(t){return sm=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},sm(t)}var hCe=function(t){sCe(e,t);var r=uCe(e);function e(n,i){var o;return oCe(this,e),o=r.call(this,n,{id:i.id,stateless:!0}),o.name=i.name,o.elements.push(new Pu(o.hot,{type:"button",value:S_,className:"htUIButton htUIButtonOK",identifier:e.BUTTON_OK})),o.elements.push(new Pu(o.hot,{type:"button",value:C_,className:"htUIButton htUIButtonCancel",identifier:e.BUTTON_CANCEL})),o.registerHooks(),o}return aCe(e,[{key:"registerHooks",value:function(){var i=this;he(this.elements,function(o){o.addLocalHook("click",function(a,s){return i.onButtonClick(a,s)})})}},{key:"getMenuItemDescriptor",value:function(){var i=this;return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:function(){return i.isHidden()},renderer:function(a,s){return Ie(s.parentNode,"htFiltersMenuActionBar"),s.parentNode.hasAttribute("ghost-table")||he(i.elements,function(l){return s.appendChild(l.element)}),s}}}},{key:"accept",value:function(){this.runLocalHooks("accept")}},{key:"cancel",value:function(){this.runLocalHooks("cancel")}},{key:"onButtonClick",value:function(i,o){o.options.identifier===e.BUTTON_OK?this.accept():this.cancel()}}],[{key:"BUTTON_OK",get:function(){return"ok"}},{key:"BUTTON_CANCEL",get:function(){return"cancel"}}]),e}(Ly),dCe=hCe,K8,q8;function X8(t,r){return vCe(t)||mCe(t,r)||yCe(t,r)||pCe()}function pCe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function yCe(t,r){if(!!t){if(typeof t=="string")return Z8(t,r);var e=Object.prototype.toString.call(t).slice(8,-1);if(e==="Object"&&t.constructor&&(e=t.constructor.name),e==="Map"||e==="Set")return Array.from(t);if(e==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return Z8(t,r)}}function Z8(t,r){(r==null||r>t.length)&&(r=t.length);for(var e=0,n=new Array(r);e<r;e++)n[e]=t[e];return n}function mCe(t,r){var e=t==null?null:typeof Symbol!="undefined"&&t[Symbol.iterator]||t["@@iterator"];if(e!=null){var n=[],i=!0,o=!1,a,s;try{for(e=e.call(t);!(i=(a=e.next()).done)&&(n.push(a.value),!(r&&n.length===r));i=!0);}catch(l){o=!0,s=l}finally{try{!i&&e.return!=null&&e.return()}finally{if(o)throw s}}return n}}function vCe(t){if(Array.isArray(t))return t}function J8(t,r){return r||(r=t.slice(0)),Object.freeze(Object.defineProperties(t,{raw:{value:Object.freeze(r)}}))}function gCe(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}function Q8(t,r){for(var e=0;e<r.length;e++){var n=r[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function bCe(t,r,e){return r&&Q8(t.prototype,r),e&&Q8(t,e),t}var eI="ConditionCollection.filteringStates",tI=function(){function t(r){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;gCe(this,t),this.hot=r,this.isMapRegistrable=e,this.filteringStates=new up,this.isMapRegistrable===!0?this.hot.columnIndexMapper.registerMap(eI,this.filteringStates):this.filteringStates.init(this.hot.columnIndexMapper.getNumberOfIndexes())}return bCe(t,[{key:"isEmpty",value:function(){return this.getFilteredColumns().length===0}},{key:"isMatch",value:function(e,n){var i,o=this.filteringStates.getValueAtIndex(n),a=(i=o==null?void 0:o.conditions)!==null&&i!==void 0?i:[],s=o==null?void 0:o.operation;return this.isMatchInConditions(a,e,s)}},{key:"isMatchInConditions",value:function(e,n){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:Yo;return e.length?i_e(i)(e,n):!0}},{key:"addCondition",value:function(e,n){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:Yo,o=arguments.length>3?arguments[3]:void 0,a=this.hot.getCellMeta(0,e).locale,s=bt(n.args,function(g){return typeof g=="string"?g.toLocaleLowerCase(a):g}),l=n.name||n.command.key;this.runLocalHooks("beforeAdd",e);var p=this.getOperation(e);if(p){if(p!==i)throw Error(Kt(K8||(K8=J8(["The column of index "," has been already applied with a `","` \n        filter operation. Use `removeConditions` to clear the current conditions and then add new ones. \n        Mind that you cannot mix different types of operations (for instance, if you use `conjunction`, \n        use it consequently for a particular column)."],["The column of index "," has been already applied with a \\`","\\`\\x20\n        filter operation. Use \\`removeConditions\\` to clear the current conditions and then add new ones.\\x20\n        Mind that you cannot mix different types of operations (for instance, if you use \\`conjunction\\`,\\x20\n        use it consequently for a particular column)."])),e,p))}else if(er(nc[i]))throw new Error(Kt(q8||(q8=J8(["Unexpected operation named `","`. Possible ones are \n        `disjunction` and `conjunction`."],["Unexpected operation named \\`","\\`. Possible ones are\\x20\n        \\`disjunction\\` and \\`conjunction\\`."])),i));var d=this.getConditions(e);d.length===0?this.filteringStates.setValueAtIndex(e,{operation:i,conditions:[{name:l,args:s,func:zo(l,s)}]},o):d.push({name:l,args:s,func:zo(l,s)}),this.runLocalHooks("afterAdd",e)}},{key:"getConditions",value:function(e){var n,i;return(n=(i=this.filteringStates.getValueAtIndex(e))===null||i===void 0?void 0:i.conditions)!==null&&n!==void 0?n:[]}},{key:"getOperation",value:function(e){var n;return(n=this.filteringStates.getValueAtIndex(e))===null||n===void 0?void 0:n.operation}},{key:"getFilteredColumns",value:function(){return this.filteringStates.getEntries().map(function(e){var n=X8(e,1),i=n[0];return i})}},{key:"getColumnStackPosition",value:function(e){return this.getFilteredColumns().indexOf(e)}},{key:"exportAllConditions",value:function(){return pr(this.filteringStates.getEntries(),function(e,n){var i=X8(n,2),o=i[0],a=i[1],s=a.operation,l=a.conditions;return e.push({column:o,operation:s,conditions:bt(l,function(p){var d=p.name,g=p.args;return{name:d,args:g}})}),e},[])}},{key:"importAllConditions",value:function(e){var n=this;this.clean(),he(e,function(i){he(i.conditions,function(o){return n.addCondition(i.column,o)})})}},{key:"removeConditions",value:function(e){this.runLocalHooks("beforeRemove",e),this.filteringStates.clearValue(e),this.runLocalHooks("afterRemove",e)}},{key:"clean",value:function(){this.runLocalHooks("beforeClean"),this.filteringStates.clear(),this.runLocalHooks("afterClean")}},{key:"hasConditions",value:function(e,n){var i=this.getConditions(e);return n?i.some(function(o){return o.name===n}):i.length>0}},{key:"destroy",value:function(){this.isMapRegistrable&&this.hot.columnIndexMapper.unregisterMap(eI),this.filteringStates=null,this.clearLocalHooks()}}]),t}();Ut(tI,nn);var rI=tI;function wCe(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}function nI(t,r){for(var e=0;e<r.length;e++){var n=r[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function _Ce(t,r,e){return r&&nI(t.prototype,r),e&&nI(t,e),t}var SCe=function(){function t(r){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:function(){return[]};wCe(this,t),this.conditionCollection=r,this.columnDataFactory=e}return _Ce(t,[{key:"filter",value:function(){var e=this,n=[];return he(this.conditionCollection.getFilteredColumns(),function(i,o){var a=e.columnDataFactory(i);o&&(a=e._getIntersectData(a,n)),n=e.filterByColumn(i,a)}),n}},{key:"filterByColumn",value:function(e){var n=this,i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],o=[];return he(i,function(a){a!==void 0&&n.conditionCollection.isMatch(a,e)&&o.push(a)}),o}},{key:"_getIntersectData",value:function(e,n){var i=[];return he(n,function(o){var a=o.meta.visualRow;e[a]!==void 0&&(i[a]=e[a])}),i}}]),t}(),iI=SCe;function CCe(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}function oI(t,r){for(var e=0;e<r.length;e++){var n=r[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function kCe(t,r,e){return r&&oI(t.prototype,r),e&&oI(t,e),t}var aI=function(){function t(r,e){var n=this,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:function(){return[]};CCe(this,t),this.hot=r,this.conditionCollection=e,this.columnDataFactory=i,this.changes=[],this.grouping=!1,this.latestEditedColumnPosition=-1,this.latestOrderStack=[],this.conditionCollection.addLocalHook("beforeRemove",function(o){return n._onConditionBeforeModify(o)}),this.conditionCollection.addLocalHook("afterRemove",function(o){return n.updateStatesAtColumn(o)}),this.conditionCollection.addLocalHook("afterAdd",function(o){return n.updateStatesAtColumn(o)}),this.conditionCollection.addLocalHook("beforeClean",function(){return n._onConditionBeforeClean()}),this.conditionCollection.addLocalHook("afterClean",function(){return n._onConditionAfterClean()})}return kCe(t,[{key:"groupChanges",value:function(){this.grouping=!0}},{key:"flush",value:function(){var e=this;this.grouping=!1,he(this.changes,function(n){e.updateStatesAtColumn(n)}),this.changes.length=0}},{key:"_onConditionBeforeModify",value:function(e){this.latestEditedColumnPosition=this.conditionCollection.getColumnStackPosition(e)}},{key:"updateStatesAtColumn",value:function(e,n){var i=this;if(this.grouping){this.changes.indexOf(e)===-1&&this.changes.push(e);return}var o=this.conditionCollection.exportAllConditions(),a=this.conditionCollection.getColumnStackPosition(e);a===-1&&(a=this.latestEditedColumnPosition);var s=o.slice(0,a),l=o.slice(a);l.length&&l[0].column===e&&l.shift();var p=a3(function(g,y){var h=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[],u=new rI(i.hot,!1),f=[].concat(g,h);u.importAllConditions(f);var c=i.columnDataFactory(y),v;u.isEmpty()?v=c:v=new iI(u,function(b){return i.columnDataFactory(b)}).filter(),v=bt(v,function(b){return b.meta.visualRow});var m=rc(v);return u.destroy(),un(c,function(b){return m(b.meta.visualRow)})})(s),d=[].concat(this.conditionCollection.getConditions(e));this.runLocalHooks("update",{editedConditionStack:{column:e,conditions:d},dependentConditionStacks:l,filteredRowsFactory:p,conditionArgsChange:n})}},{key:"_onConditionBeforeClean",value:function(){this.latestOrderStack=this.conditionCollection.getFilteredColumns()}},{key:"_onConditionAfterClean",value:function(){var e=this;he(this.latestOrderStack,function(n){e.updateStatesAtColumn(n)})}},{key:"destroy",value:function(){var e=this;this.clearLocalHooks(),Ot(this,function(n,i){e[i]=null})}}]),t}();Ut(aI,nn);var OCe=aI;function um(t){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?um=function(e){return typeof e}:um=function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},um(t)}var sI;function RCe(t,r){return r||(r=t.slice(0)),Object.freeze(Object.defineProperties(t,{raw:{value:Object.freeze(r)}}))}function ECe(t,r){return MCe(t)||ACe(t,r)||xCe(t,r)||TCe()}function TCe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function xCe(t,r){if(!!t){if(typeof t=="string")return uI(t,r);var e=Object.prototype.toString.call(t).slice(8,-1);if(e==="Object"&&t.constructor&&(e=t.constructor.name),e==="Map"||e==="Set")return Array.from(t);if(e==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return uI(t,r)}}function uI(t,r){(r==null||r>t.length)&&(r=t.length);for(var e=0,n=new Array(r);e<r;e++)n[e]=t[e];return n}function ACe(t,r){var e=t==null?null:typeof Symbol!="undefined"&&t[Symbol.iterator]||t["@@iterator"];if(e!=null){var n=[],i=!0,o=!1,a,s;try{for(e=e.call(t);!(i=(a=e.next()).done)&&(n.push(a.value),!(r&&n.length===r));i=!0);}catch(l){o=!0,s=l}finally{try{!i&&e.return!=null&&e.return()}finally{if(o)throw s}}return n}}function MCe(t){if(Array.isArray(t))return t}function PCe(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}function lI(t,r){for(var e=0;e<r.length;e++){var n=r[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function ICe(t,r,e){return r&&lI(t.prototype,r),e&&lI(t,e),t}function Hu(){return typeof Reflect!="undefined"&&Reflect.get?Hu=Reflect.get:Hu=function(r,e,n){var i=DCe(r,e);if(!!i){var o=Object.getOwnPropertyDescriptor(i,e);return o.get?o.get.call(arguments.length<3?r:n):o.value}},Hu.apply(this,arguments)}function DCe(t,r){for(;!Object.prototype.hasOwnProperty.call(t,r)&&(t=Xo(t),t!==null););return t}function NCe(t,r){if(typeof r!="function"&&r!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(r&&r.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),r&&OC(t,r)}function OC(t,r){return OC=Object.setPrototypeOf||function(n,i){return n.__proto__=i,n},OC(t,r)}function $Ce(t){var r=LCe();return function(){var n=Xo(t),i;if(r){var o=Xo(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return jCe(this,i)}}function jCe(t,r){if(r&&(um(r)==="object"||typeof r=="function"))return r;if(r!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return fI(t)}function fI(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function LCe(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Xo(t){return Xo=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},Xo(t)}var cI="filters",HCe=250,FCe=function(t){NCe(e,t);var r=$Ce(e);function e(n){var i;return PCe(this,e),i=r.call(this,n),i.eventManager=new Wt(fI(i)),i.dropdownMenuPlugin=null,i.conditionCollection=null,i.conditionUpdateObserver=null,i.components=new Map([["filter_by_condition",null],["filter_operators",null],["filter_by_condition2",null],["filter_by_value",null],["filter_action_bar",null]]),i.lastSelectedColumn=null,i.filtersRowsMap=null,i.hot.addHook("afterGetColHeader",function(o,a){return i.onAfterGetColHeader(o,a)}),i}return ICe(e,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[cI]}},{key:"enablePlugin",value:function(){var i=this;if(!this.enabled){this.filtersRowsMap=this.hot.rowIndexMapper.registerMap(this.pluginName,new xf),this.dropdownMenuPlugin=this.hot.getPlugin("dropdownMenu");var o=this.hot.getSettings().dropdownMenu,a=o&&o.uiContainer||this.hot.rootDocument.body,s=function(h){return h.addLocalHook("accept",function(){return i.onActionBarSubmit("accept")}),h.addLocalHook("cancel",function(){return i.onActionBarSubmit("cancel")}),h.addLocalHook("change",function(u){return i.onComponentChange(h,u)}),h},l=function(){return"".concat(i.hot.getTranslatedPhrase(v_),":")},p=function(){return"".concat(i.hot.getTranslatedPhrase(g_),":")};if(!this.components.get("filter_by_condition")){var d=new mC(this.hot,{id:"filter_by_condition",name:l,addSeparator:!1,menuContainer:a});d.addLocalHook("afterClose",function(){return i.onSelectUIClosed()}),this.components.set("filter_by_condition",s(d))}if(this.components.get("filter_operators")||this.components.set("filter_operators",new fSe(this.hot,{id:"filter_operators",name:"Operators"})),!this.components.get("filter_by_condition2")){var g=new mC(this.hot,{id:"filter_by_condition2",name:"",addSeparator:!0,menuContainer:a});g.addLocalHook("afterClose",function(){return i.onSelectUIClosed()}),this.components.set("filter_by_condition2",s(g))}this.components.get("filter_by_value")||this.components.set("filter_by_value",s(new iCe(this.hot,{id:"filter_by_value",name:p}))),this.components.get("filter_action_bar")||this.components.set("filter_action_bar",s(new dCe(this.hot,{id:"filter_action_bar",name:"Action bar"}))),this.conditionCollection||(this.conditionCollection=new rI(this.hot)),this.conditionUpdateObserver||(this.conditionUpdateObserver=new OCe(this.hot,this.conditionCollection,function(y){return i.getDataMapAtColumn(y)}),this.conditionUpdateObserver.addLocalHook("update",function(y){return i.updateComponents(y)})),this.components.forEach(function(y){return y.show()}),this.registerEvents(),this.addHook("beforeDropdownMenuSetItems",function(y){return i.onBeforeDropdownMenuSetItems(y)}),this.addHook("afterDropdownMenuDefaultOptions",function(y){return i.onAfterDropdownMenuDefaultOptions(y)}),this.addHook("afterDropdownMenuShow",function(){return i.onAfterDropdownMenuShow()}),this.addHook("afterDropdownMenuHide",function(){return i.onAfterDropdownMenuHide()}),this.addHook("afterChange",function(y){return i.onAfterChange(y)}),this.hot.getSettings().dropdownMenu&&this.dropdownMenuPlugin&&(this.dropdownMenuPlugin.disablePlugin(),this.dropdownMenuPlugin.enablePlugin()),Hu(Xo(e.prototype),"enablePlugin",this).call(this)}}},{key:"registerEvents",value:function(){var i=this;this.eventManager.addEventListener(this.hot.rootElement,"click",function(o){return i.onTableClick(o)})}},{key:"disablePlugin",value:function(){var i=this;if(this.enabled){var o;(o=this.dropdownMenuPlugin)!==null&&o!==void 0&&o.enabled&&this.dropdownMenuPlugin.menu.clearLocalHooks(),this.components.forEach(function(a,s){a.destroy(),i.components.set(s,null)}),this.conditionCollection.destroy(),this.conditionCollection=null,this.hot.rowIndexMapper.unregisterMap(this.pluginName)}Hu(Xo(e.prototype),"disablePlugin",this).call(this)}},{key:"addCondition",value:function(i,o,a){var s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:Yo,l=this.hot.toPhysicalColumn(i);this.conditionCollection.addCondition(l,{command:{key:o},args:a},s)}},{key:"removeConditions",value:function(i){var o=this.hot.toPhysicalColumn(i);this.conditionCollection.removeConditions(o)}},{key:"clearConditions",value:function(i){if(i===void 0)this.conditionCollection.clean();else{var o=this.hot.toPhysicalColumn(i);this.conditionCollection.removeConditions(o)}}},{key:"filter",value:function(){var i=this,o=this._createDataFilter(),a=!this.conditionCollection.isEmpty(),s=[],l=this.conditionCollection.exportAllConditions(),p=this.hot.runHooks("beforeFilter",l);if(p!==!1)if(a){var d=[];this.hot.batchExecution(function(){i.filtersRowsMap.clear(),s=bt(o.filter(),function(y){return y.meta.visualRow});var g=rc(s);Qe(i.hot.countSourceRows()-1,function(y){g(y)||d.push(y)}),he(d,function(y){i.filtersRowsMap.setValueAtIndex(y,!0)})},!0),s.length||this.hot.deselectCell()}else this.filtersRowsMap.clear();this.hot.runHooks("afterFilter",l),this.hot.view.adjustElementsSize(!0),this.hot.render(),this.clearColumnSelection()}},{key:"getSelectedColumn",value:function(){return this.lastSelectedColumn}},{key:"clearColumnSelection",value:function(){var i,o=(i=this.hot.getSelectedRangeLast())===null||i===void 0?void 0:i.getTopLeftCorner();o!==void 0&&this.hot.selectCell(o.row,o.col)}},{key:"getDataMapAtColumn",value:function(i){var o=this,a=this.hot.toVisualColumn(i),s=[];return he(this.hot.getSourceDataAtCol(a),function(l,p){var d=o.hot.getCellMeta(p,a),g=d.row,y=d.col,h=d.visualCol,u=d.visualRow,f=d.type,c=d.instance,v=d.dateFormat,m=d.locale;s.push({meta:{row:g,col:y,visualCol:h,visualRow:u,type:f,instance:c,dateFormat:v,locale:m},value:m8(l)})}),s}},{key:"onAfterChange",value:function(i){var o=this;i&&he(i,function(a){var s=ECe(a,2),l=s[1],p=o.hot.propToCol(l);o.conditionCollection.hasConditions(p)&&o.updateValueComponentCondition(p)})}},{key:"updateValueComponentCondition",value:function(i){var o=this.hot.getDataAtCol(i),a=aC(o);this.conditionUpdateObserver.updateStatesAtColumn(i,a)}},{key:"restoreComponents",value:function(i){var o,a=(o=this.getSelectedColumn())===null||o===void 0?void 0:o.physicalIndex;i.forEach(function(s){s.isHidden()||s.restoreState(a)}),this.updateDependentComponentsVisibility()}},{key:"onAfterDropdownMenuShow",value:function(){this.restoreComponents(Array.from(this.components.values()))}},{key:"onAfterDropdownMenuHide",value:function(){this.components.get("filter_by_condition").getSelectElement().closeOptions(),this.components.get("filter_by_condition2").getSelectElement().closeOptions()}},{key:"onBeforeDropdownMenuSetItems",value:function(){var i=this;this.dropdownMenuPlugin&&this.dropdownMenuPlugin.menu.addLocalHook("afterOpen",function(){i.dropdownMenuPlugin.menu.hotMenu.updateSettings({hiddenRows:!0})})}},{key:"onAfterDropdownMenuDefaultOptions",value:function(i){i.items.push({name:St}),this.components.forEach(function(o){i.items.push(o.getMenuItemDescriptor())})}},{key:"getOperationBasedOnArguments",value:function(i,o,a,s){var l=i;return l===Vy&&o.command.key!==Hr&&a.command.key!==Hr&&s.command.key!==Hr?l=uC:s.command.key!==Hr&&(o.command.key===Hr||a.command.key===Hr)&&(l=Yo),l}},{key:"onActionBarSubmit",value:function(i){if(i==="accept"){var o,a=(o=this.getSelectedColumn())===null||o===void 0?void 0:o.physicalIndex,s=this.components.get("filter_by_condition").getState(),l=this.components.get("filter_by_condition2").getState(),p=this.components.get("filter_by_value").getState(),d=this.getOperationBasedOnArguments(this.components.get("filter_operators").getActiveOperationId(),s,l,p);this.conditionUpdateObserver.groupChanges();var g=this.conditionCollection.getColumnStackPosition(a);g===-1&&(g=void 0),this.conditionCollection.removeConditions(a),s.command.key!==Hr&&(this.conditionCollection.addCondition(a,s,d,g),l.command.key!==Hr&&this.conditionCollection.addCondition(a,l,d,g)),p.command.key!==Hr&&this.conditionCollection.addCondition(a,p,d,g),this.conditionUpdateObserver.flush(),this.components.forEach(function(y){return y.saveState(a)}),this.filtersRowsMap.clear(),this.filter()}this.dropdownMenuPlugin&&this.dropdownMenuPlugin.close()}},{key:"onComponentChange",value:function(i,o){this.updateDependentComponentsVisibility(),i.constructor===mC&&!o.inputsCount&&this.setListeningDropdownMenu()}},{key:"onSelectUIClosed",value:function(){this.setListeningDropdownMenu()}},{key:"setListeningDropdownMenu",value:function(){this.dropdownMenuPlugin&&this.dropdownMenuPlugin.setListening()}},{key:"updateDependentComponentsVisibility",value:function(){var i=this.components.get("filter_by_condition"),o=i.getState(),a=o.command,s=[this.components.get("filter_by_condition2"),this.components.get("filter_operators")];a.showOperators?this.showComponents.apply(this,s):this.hideComponents.apply(this,s)}},{key:"onAfterGetColHeader",value:function(i,o){var a=this.hot.toPhysicalColumn(i);this.enabled&&this.conditionCollection.hasConditions(a)?Ie(o,"htFiltersActive"):dt(o,"htFiltersActive")}},{key:"onTableClick",value:function(i){var o=Ti(i.target,"TH");if(o){var a=this.hot.getCoords(o).col,s=this.hot.toPhysicalColumn(a);this.lastSelectedColumn={visualIndex:a,physicalIndex:s}}}},{key:"_createDataFilter",value:function(){var i=this,o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.conditionCollection;return new iI(o,function(a){return i.getDataMapAtColumn(a)})}},{key:"updateComponents",value:function(i){var o;if(!!((o=this.dropdownMenuPlugin)!==null&&o!==void 0&&o.enabled)){var a=i.editedConditionStack,s=a.conditions,l=a.column,p=s.filter(function(y){return y.name===es}),d=s.filter(function(y){return y.name!==es});if(p.length>=2||d.length>=3)tr(Kt(sI||(sI=RCe([`The filter conditions have been applied properly, but couldn\u2019t be displayed visually. 
        The overall amount of conditions exceed the capability of the dropdown menu. 
        For more details see the documentation.`],[`The filter conditions have been applied properly, but couldn\u2019t be displayed visually.\\x20
        The overall amount of conditions exceed the capability of the dropdown menu.\\x20
        For more details see the documentation.`]))));else{var g=this.conditionCollection.getOperation(l);this.components.get("filter_by_condition").updateState(d[0],l),this.components.get("filter_by_condition2").updateState(d[1],l),this.components.get("filter_operators").updateState(g,l),this.components.get("filter_by_value").updateState(i)}}}},{key:"getIndexesOfComponents",value:function(){var i=[];if(!this.dropdownMenuPlugin)return i;for(var o=this.dropdownMenuPlugin.menu,a=arguments.length,s=new Array(a),l=0;l<a;l++)s[l]=arguments[l];return he(s,function(p){he(o.menuItems,function(d,g){d.key===p.getMenuItemDescriptor().key&&i.push(g)})}),i}},{key:"changeComponentsVisibility",value:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;if(!!this.dropdownMenuPlugin){for(var o=this.dropdownMenuPlugin.menu,a=o.hotMenu,s=a.getPlugin("hiddenRows"),l=arguments.length,p=new Array(l>1?l-1:0),d=1;d<l;d++)p[d-1]=arguments[d];var g=this.getIndexesOfComponents.apply(this,p);i?s.showRows(g):s.hideRows(g),a.render()}}},{key:"hideComponents",value:function(){for(var i=arguments.length,o=new Array(i),a=0;a<i;a++)o[a]=arguments[a];this.changeComponentsVisibility.apply(this,[!1].concat(o))}},{key:"showComponents",value:function(){for(var i=arguments.length,o=new Array(i),a=0;a<i;a++)o[a]=arguments[a];this.changeComponentsVisibility.apply(this,[!0].concat(o))}},{key:"destroy",value:function(){var i=this;this.enabled&&(this.components.forEach(function(o,a){o!==null&&(o.destroy(),i.components.set(a,null))}),this.conditionCollection.destroy(),this.conditionUpdateObserver.destroy(),this.hot.rowIndexMapper.unregisterMap(this.pluginName)),Hu(Xo(e.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return cI}},{key:"PLUGIN_PRIORITY",get:function(){return HCe}},{key:"PLUGIN_DEPS",get:function(){return["plugin:DropdownMenu","plugin:HiddenRows","cell-type:checkbox"]}}]),e}(Lt);function hI(t,r){var e=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);r&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),e.push.apply(e,n)}return e}function oc(t){for(var r=1;r<arguments.length;r++){var e=arguments[r]!=null?arguments[r]:{};r%2?hI(Object(e),!0).forEach(function(n){BCe(t,n,e[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(e)):hI(Object(e)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(e,n))})}return t}function BCe(t,r,e){return r in t?Object.defineProperty(t,r,{value:e,enumerable:!0,configurable:!0,writable:!0}):t[r]=e,t}var dI="internal-use-in-handsontable",VCe={licenseKey:dI,useArrayArithmetic:!0,useColumnIndex:!1,useStats:!1,evaluateNullToZero:!0,precisionEpsilon:1e-13,precisionRounding:14,smartRounding:!0,leapYear1900:!0,nullDate:{year:1899,month:12,day:31},nullYear:30,dateFormats:["DD/MM/YYYY","DD/MM/YY"],timeFormats:["hh:mm","hh:mm:ss.sss"],matchWholeCell:!0,useRegularExpressions:!1,useWildcards:!0,functionArgSeparator:",",thousandSeparator:"",decimalSeparator:".",language:"enGB"};function pI(t){var r,e;return{maxColumns:t.maxColumns,maxRows:t.maxRows,language:(r=t[qr])===null||r===void 0||(e=r.language)===null||e===void 0?void 0:e.langCode}}function yI(t){return Object.keys(t).reduce(function(r,e){return e!=="hyperformula"&&(r[e]=t[e]),r},{})}function WCe(t){var r,e=t[qr],n=yI(e!=null&&(r=e.engine)!==null&&r!==void 0&&r.hyperformula?e.engine:{}),i=pI(t);return oc(oc(oc({},VCe),n),i)}function UCe(t){var r,e=t[qr],n=yI(e!=null&&(r=e.engine)!==null&&r!==void 0&&r.hyperformula?e.engine:{}),i=pI(t);return oc(oc({},n),i)}function lm(t){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?lm=function(e){return typeof e}:lm=function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},lm(t)}function fm(){var t="engine_relationship",r=Rn(qr);return r.hasItem(t)||r.register(t,new Map),r.getItem(t)}function RC(){var t="shared_engine_usage",r=Rn(qr);return r.hasItem(t)||r.register(t,new Map),r.getItem(t)}function zCe(t){var r=t.getSettings(),e=r[qr],n=e==null?void 0:e.engine;if(e===!0||er(n))return null;if(typeof n.hyperformula=="function"||typeof n=="function"){var i;return YCe((i=n.hyperformula)!==null&&i!==void 0?i:n,r,t)}else if(lm(n)==="object"&&er(n.hyperformula)){var o=fm(),a=RC().get(n);return o.has(n)||o.set(n,[]),o.get(n).push(t),a&&a.push(t.guid),n.getConfig().licenseKey||n.updateConfig({licenseKey:dI}),n}return null}function YCe(t,r,e){var n=r[qr],i=WCe(r),o=fm(),a=RC();GCe(t,n.functions),KCe(t,n.language);var s=t.buildEmpty(i);return o.set(s,[e]),a.set(s,[e.guid]),qCe(s,n.namedExpressions),s.on("sheetAdded",function(){s.rebuildAndRecalculate()}),s.on("sheetRemoved",function(){s.rebuildAndRecalculate()}),s}function mI(t){var r,e=fm(),n=e.size===0?[]:Array.from((r=e.get(t))!==null&&r!==void 0?r:[]);return new Map(n.map(function(i){return[i.getPlugin("formulas").sheetId,i]}))}function vI(t,r){if(t){var e=fm(),n=e.get(t),i=RC(),o=i.get(t);n&&n.includes(r)&&(n.splice(n.indexOf(r),1),n.length===0&&e.delete(t)),o&&o.includes(r.guid)&&(o.splice(o.indexOf(r.guid),1),o.length===0&&(i.delete(t),t.destroy()))}}function GCe(t,r){r&&r.forEach(function(e){var n=e.name,i=e.plugin,o=e.translations;try{t.registerFunction(n,i,o)}catch(a){tr(a.message)}})}function KCe(t,r){if(r){var e=r.langCode;try{t.registerLanguage(e,r)}catch(n){tr(n.message)}}}function qCe(t,r){r&&(t.suspendEvaluation(),r.forEach(function(e){var n=e.name,i=e.expression,o=e.scope,a=e.options;try{t.addNamedExpression(n,i,o,a)}catch(s){tr(s.message)}}),t.resumeEvaluation())}function XCe(t,r){return(er(r)||!t.doesSheetExist(r))&&(r=t.addSheet(r)),r}function gI(t){return typeof t=="string"&&t.charAt(0)==="'"&&t.charAt(1)==="="}function ZCe(t){return gI(t)?t.substr(1):t}function JCe(t){return tke(t)||eke(t)||_I(t)||QCe()}function QCe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function eke(t){if(typeof Symbol!="undefined"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function tke(t){if(Array.isArray(t))return EC(t)}function bI(t,r){var e=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);r&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),e.push.apply(e,n)}return e}function wI(t){for(var r=1;r<arguments.length;r++){var e=arguments[r]!=null?arguments[r]:{};r%2?bI(Object(e),!0).forEach(function(n){cm(t,n,e[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(e)):bI(Object(e)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(e,n))})}return t}function Fu(t){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?Fu=function(e){return typeof e}:Fu=function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Fu(t)}function Bu(t,r){return ike(t)||nke(t,r)||_I(t,r)||rke()}function rke(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function _I(t,r){if(!!t){if(typeof t=="string")return EC(t,r);var e=Object.prototype.toString.call(t).slice(8,-1);if(e==="Object"&&t.constructor&&(e=t.constructor.name),e==="Map"||e==="Set")return Array.from(t);if(e==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return EC(t,r)}}function EC(t,r){(r==null||r>t.length)&&(r=t.length);for(var e=0,n=new Array(r);e<r;e++)n[e]=t[e];return n}function nke(t,r){var e=t==null?null:typeof Symbol!="undefined"&&t[Symbol.iterator]||t["@@iterator"];if(e!=null){var n=[],i=!0,o=!1,a,s;try{for(e=e.call(t);!(i=(a=e.next()).done)&&(n.push(a.value),!(r&&n.length===r));i=!0);}catch(l){o=!0,s=l}finally{try{!i&&e.return!=null&&e.return()}finally{if(o)throw s}}return n}}function ike(t){if(Array.isArray(t))return t}function oke(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}function SI(t,r){for(var e=0;e<r.length;e++){var n=r[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function ake(t,r,e){return r&&SI(t.prototype,r),e&&SI(t,e),t}function ts(){return typeof Reflect!="undefined"&&Reflect.get?ts=Reflect.get:ts=function(r,e,n){var i=ske(r,e);if(!!i){var o=Object.getOwnPropertyDescriptor(i,e);return o.get?o.get.call(arguments.length<3?r:n):o.value}},ts.apply(this,arguments)}function ske(t,r){for(;!Object.prototype.hasOwnProperty.call(t,r)&&(t=Yi(t),t!==null););return t}function uke(t,r){if(typeof r!="function"&&r!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(r&&r.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),r&&TC(t,r)}function TC(t,r){return TC=Object.setPrototypeOf||function(n,i){return n.__proto__=i,n},TC(t,r)}function lke(t){var r=cke();return function(){var n=Yi(t),i;if(r){var o=Yi(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return fke(this,i)}}function fke(t,r){if(r&&(Fu(r)==="object"||typeof r=="function"))return r;if(r!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return rs(t)}function rs(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function cke(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Yi(t){return Yi=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},Yi(t)}function cm(t,r,e){return r in t?Object.defineProperty(t,r,{value:e,enumerable:!0,configurable:!0,writable:!0}):t[r]=e,t}function xC(t,r,e){hke(t,r),r.set(t,e)}function hke(t,r){if(r.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Vu(t,r,e){var n=CI(t,r,"set");return dke(t,n,e),e}function dke(t,r,e){if(r.set)r.set.call(t,e);else{if(!r.writable)throw new TypeError("attempted to set read only private field");r.value=e}}function Wu(t,r){var e=CI(t,r,"get");return pke(t,e)}function CI(t,r,e){if(!r.has(t))throw new TypeError("attempted to "+e+" private field on non-instance");return r.get(t)}function pke(t,r){return r.get?r.get.call(t):r.value}var qr="formulas",yke=260,kI="row_move";Ze.getSingleton().register("afterNamedExpressionAdded");Ze.getSingleton().register("afterNamedExpressionRemoved");Ze.getSingleton().register("afterSheetAdded");Ze.getSingleton().register("afterSheetRemoved");Ze.getSingleton().register("afterSheetRenamed");Ze.getSingleton().register("afterFormulasValuesUpdate");var Uu=function(r){return r==="UndoRedo.undo"||r==="UndoRedo.redo"||r==="auto"},ns=new WeakMap,AC=new WeakMap,ac=new WeakMap,mke=function(t){uke(e,t);var r=lke(e);function e(){var n;oke(this,e);for(var i=arguments.length,o=new Array(i),a=0;a<i;a++)o[a]=arguments[a];return n=r.call.apply(r,[this].concat(o)),xC(rs(n),ns,{writable:!0,value:!1}),xC(rs(n),AC,{writable:!0,value:!1}),xC(rs(n),ac,{writable:!0,value:[["valuesUpdated",function(){var s;return(s=n).onEngineValuesUpdated.apply(s,arguments)}],["namedExpressionAdded",function(){var s;return(s=n).onEngineNamedExpressionsAdded.apply(s,arguments)}],["namedExpressionRemoved",function(){var s;return(s=n).onEngineNamedExpressionsRemoved.apply(s,arguments)}],["sheetAdded",function(){var s;return(s=n).onEngineSheetAdded.apply(s,arguments)}],["sheetRenamed",function(){var s;return(s=n).onEngineSheetRenamed.apply(s,arguments)}],["sheetRemoved",function(){var s;return(s=n).onEngineSheetRemoved.apply(s,arguments)}]]}),cm(rs(n),"staticRegister",Rn("formulas")),cm(rs(n),"engine",null),cm(rs(n),"sheetName",null),n}return ake(e,[{key:"sheetId",get:function(){return this.sheetName===null?null:this.engine.getSheetId(this.sheetName)}},{key:"isEnabled",value:function(){return!!this.hot.getSettings()[qr]}},{key:"enablePlugin",value:function(){var i,o=this;if(!this.enabled){if(this.engine=(i=zCe(this.hot))!==null&&i!==void 0?i:this.engine,!this.engine){tr("Missing the required `engine` key in the Formulas settings. Please fill it with either an engine class or an engine instance.");return}if(this.sheetName!==null&&!this.engine.doesSheetExist(this.sheetName)){var a=this.addSheet(this.sheetName,this.hot.getSourceDataArray());a!==!1&&(this.sheetName=a)}this.addHook("beforeLoadData",function(){return o.onBeforeLoadData.apply(o,arguments)}),this.addHook("afterLoadData",function(){return o.onAfterLoadData.apply(o,arguments)}),this.addHook("modifyData",function(){return o.onModifyData.apply(o,arguments)}),this.addHook("modifySourceData",function(){return o.onModifySourceData.apply(o,arguments)}),this.addHook("beforeValidate",function(){return o.onBeforeValidate.apply(o,arguments)}),this.addHook("afterSetSourceDataAtCell",function(){return o.onAfterSetSourceDataAtCell.apply(o,arguments)}),this.addHook("afterSetDataAtCell",function(){return o.onAfterSetDataAtCell.apply(o,arguments)}),this.addHook("afterSetDataAtRowProp",function(){return o.onAfterSetDataAtCell.apply(o,arguments)}),this.addHook("beforeCreateRow",function(){return o.onBeforeCreateRow.apply(o,arguments)}),this.addHook("beforeCreateCol",function(){return o.onBeforeCreateCol.apply(o,arguments)}),this.addHook("afterCreateRow",function(){return o.onAfterCreateRow.apply(o,arguments)}),this.addHook("afterCreateCol",function(){return o.onAfterCreateCol.apply(o,arguments)}),this.addHook("beforeRemoveRow",function(){return o.onBeforeRemoveRow.apply(o,arguments)}),this.addHook("beforeRemoveCol",function(){return o.onBeforeRemoveCol.apply(o,arguments)}),this.addHook("afterRemoveRow",function(){return o.onAfterRemoveRow.apply(o,arguments)}),this.addHook("afterRemoveCol",function(){return o.onAfterRemoveCol.apply(o,arguments)}),this.addHook("beforeUndo",function(s){(s==null?void 0:s.actionType)!==kI&&o.engine.undo()}),this.addHook("beforeRedo",function(s){(s==null?void 0:s.actionType)!==kI&&o.engine.redo()}),this.addHook("afterDetachChild",function(){return o.onAfterDetachChild.apply(o,arguments)}),this.addHook("beforeAutofill",function(){return o.onBeforeAutofill.apply(o,arguments)}),Wu(this,ac).forEach(function(s){var l=Bu(s,2),p=l[0],d=l[1];return o.engine.on(p,d)}),ts(Yi(e.prototype),"enablePlugin",this).call(this)}}},{key:"disablePlugin",value:function(){var i=this;Wu(this,ac).forEach(function(o){var a=Bu(o,2),s=a[0],l=a[1];return i.engine.off(s,l)}),vI(this.engine,this.hot),this.engine=null,ts(Yi(e.prototype),"disablePlugin",this).call(this)}},{key:"updatePlugin",value:function(i){this.engine.updateConfig(UCe(this.hot.getSettings()));var o=this.hot.getSettings()[qr];if(at(o)&&at(o.sheetName)&&o.sheetName!==this.sheetName&&this.switchSheet(o.sheetName),!i.data&&this.sheetName===null){var a=this.hot.getSettings()[qr].sheetName;a&&this.engine.doesSheetExist(a)?this.switchSheet(this.sheetName):this.sheetName=this.addSheet(a!=null?a:void 0,this.hot.getSourceDataArray())}ts(Yi(e.prototype),"updatePlugin",this).call(this,i)}},{key:"destroy",value:function(){var i=this;Wu(this,ac).forEach(function(o){var a,s=Bu(o,2),l=s[0],p=s[1];return(a=i.engine)===null||a===void 0?void 0:a.off(l,p)}),Vu(this,ac,null),vI(this.engine,this.hot),this.engine=null,ts(Yi(e.prototype),"destroy",this).call(this)}},{key:"getPhysicalIndexPosition",value:function(i,o,a,s,l){return!l&&i>=a?s+(i-a):o}},{key:"toPhysicalRowPosition",value:function(i){var o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return this.getPhysicalIndexPosition(i,this.hot.toPhysicalRow(i),this.hot.countRows(),this.hot.countSourceRows(),o)}},{key:"toPhysicalColumnPosition",value:function(i){var o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return this.getPhysicalIndexPosition(i,this.hot.toPhysicalColumn(i),this.hot.countCols(),this.hot.countSourceCols(),o)}},{key:"addSheet",value:function(i,o){if(at(o)&&!DA(o))return tr("The provided data should be an array of arrays."),!1;if(i!=null&&this.engine.doesSheetExist(i))return tr("Sheet with the provided name already exists."),!1;try{var a=this.engine.addSheet(i!=null?i:void 0);return o&&this.engine.setSheetContent(this.engine.getSheetId(a),o),a}catch(s){return tr(s.message),!1}}},{key:"switchSheet",value:function(i){if(!this.engine.doesSheetExist(i)){B0("The sheet named `".concat(i,"` does not exist, switch aborted."));return}this.sheetName=i;var o=this.engine.getSheetSerialized(this.sheetId);o.length>0&&this.hot.loadData(o,"".concat(Ln(qr),".switchSheet"))}},{key:"getCellType",value:function(i,o){var a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.sheetId,s=this.hot.toPhysicalRow(i),l=this.hot.toPhysicalColumn(o);return s!==null&&l!==null?this.engine.getCellType({sheet:a,row:s,col:l}):"EMPTY"}},{key:"isFormulaCellType",value:function(i,o){var a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.sheetId,s=this.hot.toPhysicalRow(i),l=this.hot.toPhysicalColumn(o);return s===null||l===null?!1:this.engine.doesCellHaveFormula({sheet:a,row:s,col:l})}},{key:"renderDependentSheets",value:function(i){var o=this,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,s=new Set;i.forEach(function(l){var p,d=l==null||(p=l.address)===null||p===void 0?void 0:p.sheet;d!==void 0&&(s.has(d)||s.add(d))}),mI(this.engine).forEach(function(l,p){if((a||p!==o.sheetId)&&s.has(p)){var d;l.render(),(d=l.view)===null||d===void 0||d.adjustElementsSize()}})}},{key:"validateDependentCells",value:function(i){var o=this,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],s=function(d){var g,y=(g=d==null?void 0:d.address)!==null&&g!==void 0?g:{},h=y.row,u=y.col,f=y.sheet;return at(f)?"".concat(f,":").concat(h,"x").concat(u):""},l=new Set(a.map(function(p){return s(p)}));i.forEach(function(p){var d,g,y=(d=p.address)!==null&&d!==void 0?d:{},h=y.row,u=y.col,f=at(h)?o.hot.toVisualRow(h):null,c=at(u)?o.hot.toVisualColumn(u):null;if(!(f===null||c===null)){var v=p==null||(g=p.address)===null||g===void 0?void 0:g.sheet,m=s(p);if(v!==void 0&&!l.has(m)){var b=mI(o.engine).get(v);b.validateCell(b.getDataAtCell(f,c),b.getCellMeta(f,c),function(){})}}})}},{key:"syncChangeWithEngine",value:function(i,o,a){var s={row:this.toPhysicalRowPosition(i),col:this.toPhysicalColumnPosition(o),sheet:this.sheetId};if(!this.engine.isItPossibleToSetCellContents(s)){tr("Not possible to set cell data at ".concat(JSON.stringify(s)));return}return this.engine.setCellContents(s,a)}},{key:"onBeforeValidate",value:function(i,o,a){var s=this.hot.propToCol(a);if(this.isFormulaCellType(o,s)){var l={row:this.hot.toPhysicalRow(o),col:this.hot.toPhysicalColumn(s),sheet:this.sheetId},p=this.engine.getCellValue(l);return Fu(p)==="object"&&p!==null?p.value:p}return i}},{key:"onBeforeAutofill",value:function(i,o,a){var s=this,l=function(y){return wI(wI({},y),{},{sheet:s.sheetId})},p={start:l(o.getTopLeftCorner()),end:l(o.getBottomRightCorner())},d={start:l(a.getTopLeftCorner()),end:l(a.getBottomRightCorner())};return this.engine.isItPossibleToSetCellContents(d)===!1?!1:this.engine.getFillRangeData(p,d)}},{key:"onBeforeLoadData",value:function(i,o){var a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"";a.includes(Ln(qr))||Vu(this,AC,er(this.hot.getSettings().data))}},{key:"onAfterLoadData",value:function(i,o){var a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"";if(!a.includes(Ln(qr)))if(this.sheetName=XCe(this.engine,this.hot.getSettings()[qr].sheetName),Wu(this,AC))this.switchSheet(this.sheetName);else{var s=this.hot.getSourceDataArray();if(this.engine.isItPossibleToReplaceSheetContent(this.sheetId,s)){Vu(this,ns,!0);var l=this.engine.setSheetContent(this.sheetId,this.hot.getSourceDataArray());this.renderDependentSheets(l),Vu(this,ns,!1)}}}},{key:"onModifyData",value:function(i,o,a,s){if(!(s!=="get"||Wu(this,ns)||this.sheetName===null||!this.engine.doesSheetExist(this.sheetName))){var l=this.hot.toVisualRow(i),p=this.isFormulaCellType(l,o);if(!p){var d=this.getCellType(l,o);if(d!=="ARRAY"){gI(a.value)&&(a.value=ZCe(a.value));return}}var g={row:i,col:this.toPhysicalColumnPosition(o),sheet:this.sheetId},y=this.engine.getCellValue(g),h=Fu(y)==="object"&&y!==null?y.value:y;a.value=h}}},{key:"onModifySourceData",value:function(i,o,a,s){if(!(s!=="get"||Wu(this,ns)||this.sheetName===null||!this.engine.doesSheetExist(this.sheetName))){var l=this.hot.toVisualRow(i),p=this.hot.propToCol(o),d=this.isFormulaCellType(l,p);if(!d){var g=this.getCellType(l,p);if(g!=="ARRAY")return}var y=this.engine.getSheetDimensions(this.engine.getSheetId(this.sheetName));if(!(y.width===0&&y.height===0)){var h={row:i,col:this.toPhysicalColumnPosition(p),sheet:this.sheetId};a.value=this.engine.getCellSerialized(h)}}}},{key:"onAfterSetDataAtCell",value:function(i,o){var a=this;if(!Uu(o)){var s=[],l=[],p=this.engine.batch(function(){i.forEach(function(d){var g=Bu(d,4),y=g[0],h=g[1],u=g[3],f=a.hot.propToCol(h),c=a.hot.toPhysicalRow(y),v=a.hot.toPhysicalColumn(f),m={row:c,col:v,sheet:a.sheetId};c!==null&&v!==null?a.syncChangeWithEngine(y,f,u):s.push([y,f,u]),l.push({address:m})})});s.length&&this.hot.addHookOnce("afterChange",function(){var d=a.engine.batch(function(){s.forEach(function(g){var y=Bu(g,3),h=y[0],u=y[1],f=y[2];a.syncChangeWithEngine(h,u,f)})});a.renderDependentSheets(d,!0)}),this.renderDependentSheets(p),this.validateDependentCells(p,l)}}},{key:"onAfterSetSourceDataAtCell",value:function(i,o){var a=this;if(!Uu(o)){var s=[],l=[];i.forEach(function(p){var d=Bu(p,4),g=d[0],y=d[1],h=d[3],u=a.hot.propToCol(y);if(!!dn(u)){var f={row:g,col:a.toPhysicalColumnPosition(u),sheet:a.sheetId};if(!a.engine.isItPossibleToSetCellContents(f)){tr("Not possible to set source cell data at ".concat(JSON.stringify(f)));return}l.push({address:f}),s.push.apply(s,JCe(a.engine.setCellContents(f,h)))}}),this.renderDependentSheets(s),this.validateDependentCells(s,l)}}},{key:"onBeforeCreateRow",value:function(i,o){if(this.sheetId===null||!this.engine.doesSheetExist(this.sheetName)||!this.engine.isItPossibleToAddRows(this.sheetId,[this.toPhysicalRowPosition(i),o]))return!1}},{key:"onBeforeCreateCol",value:function(i,o){if(this.sheetId===null||!this.engine.doesSheetExist(this.sheetName)||!this.engine.isItPossibleToAddColumns(this.sheetId,[this.toPhysicalColumnPosition(i),o]))return!1}},{key:"onBeforeRemoveRow",value:function(i,o,a){var s=this,l=a.every(function(p){return s.engine.isItPossibleToRemoveRows(s.sheetId,[p,1])});return l===!1?!1:void 0}},{key:"onBeforeRemoveCol",value:function(i,o,a){var s=this,l=a.every(function(p){return s.engine.isItPossibleToRemoveColumns(s.sheetId,[p,1])});return l===!1?!1:void 0}},{key:"onAfterCreateRow",value:function(i,o,a){if(!Uu(a)){var s=this.engine.addRows(this.sheetId,[this.toPhysicalRowPosition(i),o]);this.renderDependentSheets(s)}}},{key:"onAfterCreateCol",value:function(i,o,a){if(!Uu(a)){var s=this.engine.addColumns(this.sheetId,[this.toPhysicalColumnPosition(i),o]);this.renderDependentSheets(s)}}},{key:"onAfterRemoveRow",value:function(i,o,a,s){var l=this;if(!Uu(s)){var p=a.sort().reverse(),d=this.engine.batch(function(){p.forEach(function(g){l.engine.removeRows(l.sheetId,[g,1])})});this.renderDependentSheets(d)}}},{key:"onAfterRemoveCol",value:function(i,o,a,s){var l=this;if(!Uu(s)){var p=a.sort().reverse(),d=this.engine.batch(function(){p.forEach(function(g){l.engine.removeColumns(l.sheetId,[g,1])})});this.renderDependentSheets(d)}}},{key:"onAfterDetachChild",value:function(i,o,a){var s,l=this;Vu(this,ns,!0);var p=this.hot.getSourceDataArray(a,0,a+(((s=o.__children)===null||s===void 0?void 0:s.length)||0),this.hot.countSourceCols());Vu(this,ns,!1),p.forEach(function(d,g){d.forEach(function(y,h){l.engine.setCellContents({col:h,row:a+g,sheet:l.sheetId},[[y]])})})}},{key:"onEngineValuesUpdated",value:function(i){this.hot.runHooks("afterFormulasValuesUpdate",i)}},{key:"onEngineNamedExpressionsAdded",value:function(i,o){this.hot.runHooks("afterNamedExpressionAdded",i,o)}},{key:"onEngineNamedExpressionsRemoved",value:function(i,o){this.hot.runHooks("afterNamedExpressionRemoved",i,o)}},{key:"onEngineSheetAdded",value:function(i){this.hot.runHooks("afterSheetAdded",i)}},{key:"onEngineSheetRenamed",value:function(i,o){this.hot.runHooks("afterSheetRenamed",i,o)}},{key:"onEngineSheetRemoved",value:function(i,o){this.hot.runHooks("afterSheetRemoved",i,o)}}],[{key:"PLUGIN_KEY",get:function(){return qr}},{key:"PLUGIN_PRIORITY",get:function(){return yke}}]),e}(Lt);function vke(t,r){return _ke(t)||wke(t,r)||bke(t,r)||gke()}function gke(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function bke(t,r){if(!!t){if(typeof t=="string")return OI(t,r);var e=Object.prototype.toString.call(t).slice(8,-1);if(e==="Object"&&t.constructor&&(e=t.constructor.name),e==="Map"||e==="Set")return Array.from(t);if(e==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return OI(t,r)}}function OI(t,r){(r==null||r>t.length)&&(r=t.length);for(var e=0,n=new Array(r);e<r;e++)n[e]=t[e];return n}function wke(t,r){var e=t==null?null:typeof Symbol!="undefined"&&t[Symbol.iterator]||t["@@iterator"];if(e!=null){var n=[],i=!0,o=!1,a,s;try{for(e=e.call(t);!(i=(a=e.next()).done)&&(n.push(a.value),!(r&&n.length===r));i=!0);}catch(l){o=!0,s=l}finally{try{!i&&e.return!=null&&e.return()}finally{if(o)throw s}}return n}}function _ke(t){if(Array.isArray(t))return t}function Ske(t){return{key:"hidden_columns_hide",name:function(){var e=this.getSelectedLast(),n=0;if(Array.isArray(e)){var i=vke(e,4),o=i[1],a=i[3];o-a!=0&&(n=1)}return this.getTranslatedPhrase(K1,n)},callback:function(){for(var e=this.getSelectedRangeLast(),n=e.from,i=e.to,o=Math.max(Math.min(n.col,i.col),0),a=Math.max(n.col,i.col),s=[],l=o;l<=a;l+=1)s.push(l);var p=s[0],d=s[s.length-1],g=this.columnIndexMapper.getFirstNotHiddenIndex(d+1,1,!0,p-1);t.hideColumns(s),Number.isInteger(g)&&g>=0?this.selectColumns(g):this.deselectCell(),this.render(),this.view.adjustElementsSize(!0)},disabled:!1,hidden:function(){return!(this.selection.isSelectedByColumnHeader()||this.selection.isSelectedByCorner())}}}function hm(t){return Rke(t)||Oke(t)||kke(t)||Cke()}function Cke(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function kke(t,r){if(!!t){if(typeof t=="string")return MC(t,r);var e=Object.prototype.toString.call(t).slice(8,-1);if(e==="Object"&&t.constructor&&(e=t.constructor.name),e==="Map"||e==="Set")return Array.from(t);if(e==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return MC(t,r)}}function Oke(t){if(typeof Symbol!="undefined"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function Rke(t){if(Array.isArray(t))return MC(t)}function MC(t,r){(r==null||r>t.length)&&(r=t.length);for(var e=0,n=new Array(r);e<r;e++)n[e]=t[e];return n}function Eke(t){var r=[];return{key:"hidden_columns_show",name:function(){var n=r.length>1?1:0;return this.getTranslatedPhrase(q1,n)},callback:function(){var n,i;if(r.length!==0){var o=r[0],a=r[r.length-1];o=(n=this.columnIndexMapper.getFirstNotHiddenIndex(o-1,-1))!==null&&n!==void 0?n:0,a=(i=this.columnIndexMapper.getFirstNotHiddenIndex(a+1,1))!==null&&i!==void 0?i:this.countCols()-1,t.showColumns(r),this.render(),this.view.adjustElementsSize(!0);var s=a-o+1===this.countCols();s||this.selectColumns(o,a)}},disabled:!1,hidden:function(){var n=this,i=bt(t.getHiddenColumns(),function(m){return n.toPhysicalColumn(m)});if(!(this.selection.isSelectedByColumnHeader()||this.selection.isSelectedByCorner())||i.length<1)return!0;r.length=0;var o=this.getSelectedRangeLast(),a=o.getTopLeftCorner().col,s=o.getBottomRightCorner().col,l=this.columnIndexMapper,p=l.getRenderableFromVisualIndex(a),d=l.getRenderableFromVisualIndex(s),g=l.getNotTrimmedIndexes(),y=[];if(a!==s){var h=s-a+1,u=d-p+1;if(h>u){var f=g.slice(a,s+1);y.push.apply(y,hm(f.filter(function(m){return i.includes(m)})))}}else if(p===0&&p<a)y.push.apply(y,hm(g.slice(0,a)));else if(p===null)y.push.apply(y,hm(g.slice(0,this.countCols())));else{var c=this.countCols()-1,v=l.getRenderableFromVisualIndex(l.getFirstNotHiddenIndex(c,-1));d===v&&c>s&&y.push.apply(y,hm(g.slice(s+1)))}return he(y,function(m){r.push(n.toVisualColumn(m))}),r.length===0}}}function dm(t){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?dm=function(e){return typeof e}:dm=function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},dm(t)}function Tke(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}function RI(t,r){for(var e=0;e<r.length;e++){var n=r[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function xke(t,r,e){return r&&RI(t.prototype,r),e&&RI(t,e),t}function is(){return typeof Reflect!="undefined"&&Reflect.get?is=Reflect.get:is=function(r,e,n){var i=Ake(r,e);if(!!i){var o=Object.getOwnPropertyDescriptor(i,e);return o.get?o.get.call(arguments.length<3?r:n):o.value}},is.apply(this,arguments)}function Ake(t,r){for(;!Object.prototype.hasOwnProperty.call(t,r)&&(t=Gi(t),t!==null););return t}function Mke(t,r){if(typeof r!="function"&&r!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(r&&r.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),r&&PC(t,r)}function PC(t,r){return PC=Object.setPrototypeOf||function(n,i){return n.__proto__=i,n},PC(t,r)}function Pke(t){var r=Dke();return function(){var n=Gi(t),i;if(r){var o=Gi(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return Ike(this,i)}}function Ike(t,r){if(r&&(dm(r)==="object"||typeof r=="function"))return r;if(r!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return IC(t)}function IC(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Dke(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Gi(t){return Gi=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},Gi(t)}function EI(t,r,e){Nke(t,r),r.set(t,e)}function Nke(t,r){if(r.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function yn(t,r){var e=TI(t,r,"get");return $ke(t,e)}function $ke(t,r){return r.get?r.get.call(t):r.value}function sc(t,r,e){var n=TI(t,r,"set");return jke(t,n,e),e}function TI(t,r,e){if(!r.has(t))throw new TypeError("attempted to "+e+" private field on non-instance");return r.get(t)}function jke(t,r,e){if(r.set)r.set.call(t,e);else{if(!r.writable)throw new TypeError("attempted to set read only private field");r.value=e}}Ze.getSingleton().register("beforeHideColumns");Ze.getSingleton().register("afterHideColumns");Ze.getSingleton().register("beforeUnhideColumns");Ze.getSingleton().register("afterUnhideColumns");var DC="hiddenColumns",Lke=310,li=new WeakMap,fi=new WeakMap,Hke=function(t){Mke(e,t);var r=Pke(e);function e(){var n;Tke(this,e);for(var i=arguments.length,o=new Array(i),a=0;a<i;a++)o[a]=arguments[a];return n=r.call.apply(r,[this].concat(o)),EI(IC(n),li,{writable:!0,value:{}}),EI(IC(n),fi,{writable:!0,value:null}),n}return xke(e,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[DC]}},{key:"enablePlugin",value:function(){var i=this;if(!this.enabled){var o=this.hot.getSettings()[DC];vt(o)&&(sc(this,li,o),er(o.copyPasteEnabled)&&(o.copyPasteEnabled=!0)),sc(this,fi,new ap),yn(this,fi).addLocalHook("init",function(){return i.onMapInit()}),this.hot.columnIndexMapper.registerMap(this.pluginName,yn(this,fi)),this.addHook("afterContextMenuDefaultOptions",function(){return i.onAfterContextMenuDefaultOptions.apply(i,arguments)}),this.addHook("afterGetCellMeta",function(a,s,l){return i.onAfterGetCellMeta(a,s,l)}),this.addHook("modifyColWidth",function(a,s){return i.onModifyColWidth(a,s)}),this.addHook("afterGetColHeader",function(){return i.onAfterGetColHeader.apply(i,arguments)}),this.addHook("modifyCopyableRange",function(a){return i.onModifyCopyableRange(a)}),is(Gi(e.prototype),"enablePlugin",this).call(this)}}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),is(Gi(e.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){this.hot.columnIndexMapper.unregisterMap(this.pluginName),sc(this,li,{}),is(Gi(e.prototype),"disablePlugin",this).call(this),this.resetCellsMeta()}},{key:"showColumns",value:function(i){var o=this,a=this.getHiddenColumns(),s=this.isValidConfig(i),l=a,p=yn(this,fi).getValues().slice(),d=i.length>0;if(s&&d){var g=i.map(function(h){return o.hot.toPhysicalColumn(h)});he(g,function(h){p[h]=!1}),l=pr(p,function(h,u,f){return u&&h.push(o.hot.toVisualColumn(f)),h},[])}var y=this.hot.runHooks("beforeUnhideColumns",a,l,s&&d);y!==!1&&(s&&d&&yn(this,fi).setValues(p),this.hot.view.adjustElementsSize(),this.hot.runHooks("afterUnhideColumns",a,l,s&&d,s&&l.length<a.length))}},{key:"showColumn",value:function(){for(var i=arguments.length,o=new Array(i),a=0;a<i;a++)o[a]=arguments[a];this.showColumns(o)}},{key:"hideColumns",value:function(i){var o=this,a=this.getHiddenColumns(),s=this.isValidConfig(i),l=a;s&&(l=Array.from(new Set(a.concat(i))));var p=this.hot.runHooks("beforeHideColumns",a,l,s);p!==!1&&(s&&this.hot.batchExecution(function(){he(i,function(d){yn(o,fi).setValueAtIndex(o.hot.toPhysicalColumn(d),!0)})},!0),this.hot.runHooks("afterHideColumns",a,l,s,s&&l.length>a.length))}},{key:"hideColumn",value:function(){for(var i=arguments.length,o=new Array(i),a=0;a<i;a++)o[a]=arguments[a];this.hideColumns(o)}},{key:"getHiddenColumns",value:function(){var i=this;return bt(yn(this,fi).getHiddenIndexes(),function(o){return i.hot.toVisualColumn(o)})}},{key:"isHidden",value:function(i){return yn(this,fi).getValueAtIndex(this.hot.toPhysicalColumn(i))||!1}},{key:"isValidConfig",value:function(i){var o=this.hot.countCols();return Array.isArray(i)&&i.length>0?i.every(function(a){return Number.isInteger(a)&&a>=0&&a<o}):!1}},{key:"resetCellsMeta",value:function(){he(this.hot.getCellsMeta(),function(i){i&&(i.skipColumnOnPaste=!1)})}},{key:"onModifyColWidth",value:function(i,o){if(this.isHidden(o))return 0;if(yn(this,li).indicators&&(this.isHidden(o+1)||this.isHidden(o-1))&&typeof i=="number"&&this.hot.hasColHeaders())return i+15}},{key:"onAfterGetCellMeta",value:function(i,o,a){if(yn(this,li).copyPasteEnabled===!1&&this.isHidden(o)&&(a.skipColumnOnPaste=!0),this.isHidden(o-1))a.className=a.className||"",a.className.indexOf("afterHiddenColumn")===-1&&(a.className+=" afterHiddenColumn");else if(a.className){var s=a.className.split(" ");if(s.length>0){var l=s.indexOf("afterHiddenColumn");l>-1&&s.splice(l,1),a.className=s.join(" ")}}}},{key:"onModifyCopyableRange",value:function(i){var o=this;if(yn(this,li).copyPasteEnabled)return i;var a=[],s=function(p,d,g,y){a.push({startRow:p,endRow:d,startCol:g,endCol:y})};return he(i,function(l){var p=!0,d=0;Qe(l.startCol,l.endCol,function(g){o.isHidden(g)?(p||s(l.startRow,l.endRow,d,g-1),p=!0):(p&&(d=g),g===l.endCol&&s(l.startRow,l.endRow,d,g),p=!1)})}),a}},{key:"onAfterGetColHeader",value:function(i,o){if(!(!yn(this,li).indicators||i<0)){var a=[];i>=1&&this.isHidden(i-1)&&a.push("afterHiddenColumn"),i<this.hot.countCols()-1&&this.isHidden(i+1)&&a.push("beforeHiddenColumn"),Ie(o,a)}}},{key:"onAfterContextMenuDefaultOptions",value:function(i){i.items.push({name:St},Ske(this),Eke(this))}},{key:"onMapInit",value:function(){Array.isArray(yn(this,li).columns)&&this.hideColumns(yn(this,li).columns)}},{key:"destroy",value:function(){sc(this,li,null),sc(this,fi,null),is(Gi(e.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return DC}},{key:"PLUGIN_PRIORITY",get:function(){return Lke}}]),e}(Lt);function Fke(t,r){return Uke(t)||Wke(t,r)||Vke(t,r)||Bke()}function Bke(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Vke(t,r){if(!!t){if(typeof t=="string")return xI(t,r);var e=Object.prototype.toString.call(t).slice(8,-1);if(e==="Object"&&t.constructor&&(e=t.constructor.name),e==="Map"||e==="Set")return Array.from(t);if(e==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return xI(t,r)}}function xI(t,r){(r==null||r>t.length)&&(r=t.length);for(var e=0,n=new Array(r);e<r;e++)n[e]=t[e];return n}function Wke(t,r){var e=t==null?null:typeof Symbol!="undefined"&&t[Symbol.iterator]||t["@@iterator"];if(e!=null){var n=[],i=!0,o=!1,a,s;try{for(e=e.call(t);!(i=(a=e.next()).done)&&(n.push(a.value),!(r&&n.length===r));i=!0);}catch(l){o=!0,s=l}finally{try{!i&&e.return!=null&&e.return()}finally{if(o)throw s}}return n}}function Uke(t){if(Array.isArray(t))return t}function zke(t){return{key:"hidden_rows_hide",name:function(){var e=this.getSelectedLast(),n=0;if(Array.isArray(e)){var i=Fke(e,3),o=i[0],a=i[2];o-a!=0&&(n=1)}return this.getTranslatedPhrase(X1,n)},callback:function(){for(var e=this.getSelectedRangeLast(),n=e.from,i=e.to,o=Math.max(Math.min(n.row,i.row),0),a=Math.max(n.row,i.row),s=[],l=o;l<=a;l+=1)s.push(l);var p=s[0],d=s[s.length-1],g=this.rowIndexMapper.getFirstNotHiddenIndex(d+1,1,!0,p-1);t.hideRows(s),Number.isInteger(g)&&g>=0?this.selectRows(g):this.deselectCell(),this.render(),this.view.adjustElementsSize(!0)},disabled:!1,hidden:function(){return!(this.selection.isSelectedByRowHeader()||this.selection.isSelectedByCorner())}}}function pm(t){return qke(t)||Kke(t)||Gke(t)||Yke()}function Yke(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Gke(t,r){if(!!t){if(typeof t=="string")return NC(t,r);var e=Object.prototype.toString.call(t).slice(8,-1);if(e==="Object"&&t.constructor&&(e=t.constructor.name),e==="Map"||e==="Set")return Array.from(t);if(e==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return NC(t,r)}}function Kke(t){if(typeof Symbol!="undefined"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function qke(t){if(Array.isArray(t))return NC(t)}function NC(t,r){(r==null||r>t.length)&&(r=t.length);for(var e=0,n=new Array(r);e<r;e++)n[e]=t[e];return n}function Xke(t){var r=[];return{key:"hidden_rows_show",name:function(){var n=r.length>1?1:0;return this.getTranslatedPhrase(Z1,n)},callback:function(){var n,i;if(r.length!==0){var o=r[0],a=r[r.length-1];o=(n=this.rowIndexMapper.getFirstNotHiddenIndex(o-1,-1))!==null&&n!==void 0?n:0,a=(i=this.rowIndexMapper.getFirstNotHiddenIndex(a+1,1))!==null&&i!==void 0?i:this.countRows()-1,t.showRows(r),this.render(),this.view.adjustElementsSize(!0);var s=a-o+1===this.countRows();s||this.selectRows(o,a)}},disabled:!1,hidden:function(){var n=this,i=bt(t.getHiddenRows(),function(m){return n.toPhysicalRow(m)});if(!(this.selection.isSelectedByRowHeader()||this.selection.isSelectedByCorner())||i.length<1)return!0;r.length=0;var o=this.getSelectedRangeLast(),a=o.getTopLeftCorner().row,s=o.getBottomRightCorner().row,l=this.rowIndexMapper,p=l.getRenderableFromVisualIndex(a),d=l.getRenderableFromVisualIndex(s),g=l.getNotTrimmedIndexes(),y=[];if(a!==s){var h=s-a+1,u=d-p+1;if(h>u){var f=g.slice(a,s+1);y.push.apply(y,pm(f.filter(function(m){return i.includes(m)})))}}else if(p===0&&p<a)y.push.apply(y,pm(g.slice(0,a)));else if(p===null)y.push.apply(y,pm(g.slice(0,this.countRows())));else{var c=this.countRows()-1,v=l.getRenderableFromVisualIndex(l.getFirstNotHiddenIndex(c,-1));d===v&&c>s&&y.push.apply(y,pm(g.slice(s+1)))}return he(y,function(m){r.push(n.toVisualRow(m))}),r.length===0}}}function ym(t){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?ym=function(e){return typeof e}:ym=function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ym(t)}function Zke(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}function AI(t,r){for(var e=0;e<r.length;e++){var n=r[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function Jke(t,r,e){return r&&AI(t.prototype,r),e&&AI(t,e),t}function os(){return typeof Reflect!="undefined"&&Reflect.get?os=Reflect.get:os=function(r,e,n){var i=Qke(r,e);if(!!i){var o=Object.getOwnPropertyDescriptor(i,e);return o.get?o.get.call(arguments.length<3?r:n):o.value}},os.apply(this,arguments)}function Qke(t,r){for(;!Object.prototype.hasOwnProperty.call(t,r)&&(t=Ki(t),t!==null););return t}function eOe(t,r){if(typeof r!="function"&&r!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(r&&r.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),r&&$C(t,r)}function $C(t,r){return $C=Object.setPrototypeOf||function(n,i){return n.__proto__=i,n},$C(t,r)}function tOe(t){var r=nOe();return function(){var n=Ki(t),i;if(r){var o=Ki(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return rOe(this,i)}}function rOe(t,r){if(r&&(ym(r)==="object"||typeof r=="function"))return r;if(r!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return jC(t)}function jC(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function nOe(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Ki(t){return Ki=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},Ki(t)}function MI(t,r,e){iOe(t,r),r.set(t,e)}function iOe(t,r){if(r.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function An(t,r){var e=PI(t,r,"get");return oOe(t,e)}function oOe(t,r){return r.get?r.get.call(t):r.value}function uc(t,r,e){var n=PI(t,r,"set");return aOe(t,n,e),e}function PI(t,r,e){if(!r.has(t))throw new TypeError("attempted to "+e+" private field on non-instance");return r.get(t)}function aOe(t,r,e){if(r.set)r.set.call(t,e);else{if(!r.writable)throw new TypeError("attempted to set read only private field");r.value=e}}Ze.getSingleton().register("beforeHideRows");Ze.getSingleton().register("afterHideRows");Ze.getSingleton().register("beforeUnhideRows");Ze.getSingleton().register("afterUnhideRows");var LC="hiddenRows",sOe=320,qi=new WeakMap,ci=new WeakMap,uOe=function(t){eOe(e,t);var r=tOe(e);function e(){var n;Zke(this,e);for(var i=arguments.length,o=new Array(i),a=0;a<i;a++)o[a]=arguments[a];return n=r.call.apply(r,[this].concat(o)),MI(jC(n),qi,{writable:!0,value:{}}),MI(jC(n),ci,{writable:!0,value:null}),n}return Jke(e,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[LC]}},{key:"enablePlugin",value:function(){var i=this;if(!this.enabled){var o=this.hot.getSettings()[LC];vt(o)&&(uc(this,qi,o),er(o.copyPasteEnabled)&&(o.copyPasteEnabled=!0)),uc(this,ci,new ap),An(this,ci).addLocalHook("init",function(){return i.onMapInit()}),this.hot.rowIndexMapper.registerMap(this.pluginName,An(this,ci)),this.addHook("afterContextMenuDefaultOptions",function(){return i.onAfterContextMenuDefaultOptions.apply(i,arguments)}),this.addHook("afterGetCellMeta",function(a,s,l){return i.onAfterGetCellMeta(a,s,l)}),this.addHook("modifyRowHeight",function(a,s){return i.onModifyRowHeight(a,s)}),this.addHook("afterGetRowHeader",function(){return i.onAfterGetRowHeader.apply(i,arguments)}),this.addHook("modifyCopyableRange",function(a){return i.onModifyCopyableRange(a)}),os(Ki(e.prototype),"enablePlugin",this).call(this)}}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),os(Ki(e.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){this.hot.rowIndexMapper.unregisterMap(this.pluginName),uc(this,qi,{}),os(Ki(e.prototype),"disablePlugin",this).call(this),this.resetCellsMeta()}},{key:"showRows",value:function(i){var o=this,a=this.getHiddenRows(),s=this.isValidConfig(i),l=a,p=An(this,ci).getValues().slice(),d=i.length>0;if(s&&d){var g=i.map(function(h){return o.hot.toPhysicalRow(h)});he(g,function(h){p[h]=!1}),l=pr(p,function(h,u,f){return u&&h.push(o.hot.toVisualRow(f)),h},[])}var y=this.hot.runHooks("beforeUnhideRows",a,l,s&&d);y!==!1&&(s&&d&&An(this,ci).setValues(p),this.hot.runHooks("afterUnhideRows",a,l,s&&d,s&&l.length<a.length))}},{key:"showRow",value:function(){for(var i=arguments.length,o=new Array(i),a=0;a<i;a++)o[a]=arguments[a];this.showRows(o)}},{key:"hideRows",value:function(i){var o=this,a=this.getHiddenRows(),s=this.isValidConfig(i),l=a;s&&(l=Array.from(new Set(a.concat(i))));var p=this.hot.runHooks("beforeHideRows",a,l,s);p!==!1&&(s&&this.hot.batchExecution(function(){he(i,function(d){An(o,ci).setValueAtIndex(o.hot.toPhysicalRow(d),!0)})},!0),this.hot.runHooks("afterHideRows",a,l,s,s&&l.length>a.length))}},{key:"hideRow",value:function(){for(var i=arguments.length,o=new Array(i),a=0;a<i;a++)o[a]=arguments[a];this.hideRows(o)}},{key:"getHiddenRows",value:function(){var i=this;return bt(An(this,ci).getHiddenIndexes(),function(o){return i.hot.toVisualRow(o)})}},{key:"isHidden",value:function(i){return An(this,ci).getValueAtIndex(this.hot.toPhysicalRow(i))||!1}},{key:"isValidConfig",value:function(i){var o=this.hot.countRows();return Array.isArray(i)&&i.length>0?i.every(function(a){return Number.isInteger(a)&&a>=0&&a<o}):!1}},{key:"resetCellsMeta",value:function(){he(this.hot.getCellsMeta(),function(i){i&&(i.skipRowOnPaste=!1)})}},{key:"onModifyRowHeight",value:function(i,o){return this.isHidden(o)?0:i}},{key:"onAfterGetCellMeta",value:function(i,o,a){if(An(this,qi).copyPasteEnabled===!1&&this.isHidden(i)&&(a.skipRowOnPaste=!0),this.isHidden(i-1))a.className=a.className||"",a.className.indexOf("afterHiddenRow")===-1&&(a.className+=" afterHiddenRow");else if(a.className){var s=a.className.split(" ");if(s.length>0){var l=s.indexOf("afterHiddenRow");l>-1&&s.splice(l,1),a.className=s.join(" ")}}}},{key:"onModifyCopyableRange",value:function(i){var o=this;if(An(this,qi).copyPasteEnabled)return i;var a=[],s=function(p,d,g,y){a.push({startRow:p,endRow:d,startCol:g,endCol:y})};return he(i,function(l){var p=!0,d=0;Qe(l.startRow,l.endRow,function(g){o.isHidden(g)?(p||s(d,g-1,l.startCol,l.endCol),p=!0):(p&&(d=g),g===l.endRow&&s(d,g,l.startCol,l.endCol),p=!1)})}),a}},{key:"onAfterGetRowHeader",value:function(i,o){if(!(!An(this,qi).indicators||i<0)){var a=[];i>=1&&this.isHidden(i-1)&&a.push("afterHiddenRow"),i<this.hot.countRows()-1&&this.isHidden(i+1)&&a.push("beforeHiddenRow"),Ie(o,a)}}},{key:"onAfterContextMenuDefaultOptions",value:function(i){i.items.push({name:St},zke(this),Xke(this))}},{key:"onMapInit",value:function(){Array.isArray(An(this,qi).rows)&&this.hideRows(An(this,qi).rows)}},{key:"destroy",value:function(){uc(this,qi,null),uc(this,ci,null),os(Ki(e.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return LC}},{key:"PLUGIN_PRIORITY",get:function(){return sOe}}]),e}(Lt);function lOe(t,r){return dOe(t)||hOe(t,r)||cOe(t,r)||fOe()}function fOe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function cOe(t,r){if(!!t){if(typeof t=="string")return II(t,r);var e=Object.prototype.toString.call(t).slice(8,-1);if(e==="Object"&&t.constructor&&(e=t.constructor.name),e==="Map"||e==="Set")return Array.from(t);if(e==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return II(t,r)}}function II(t,r){(r==null||r>t.length)&&(r=t.length);for(var e=0,n=new Array(r);e<r;e++)n[e]=t[e];return n}function hOe(t,r){var e=t==null?null:typeof Symbol!="undefined"&&t[Symbol.iterator]||t["@@iterator"];if(e!=null){var n=[],i=!0,o=!1,a,s;try{for(e=e.call(t);!(i=(a=e.next()).done)&&(n.push(a.value),!(r&&n.length===r));i=!0);}catch(l){o=!0,s=l}finally{try{!i&&e.return!=null&&e.return()}finally{if(o)throw s}}return n}}function dOe(t){if(Array.isArray(t))return t}function pOe(t){return{key:"freeze_column",name:function(){return this.getTranslatedPhrase(k1)},callback:function(e,n){var i=lOe(n,1),o=i[0].start.col;t.freezeColumn(o),this.render(),this.view.adjustElementsSize(!0)},hidden:function(){var e=this.getSelectedRange(),n=!1;return(e===void 0||e.length>1||e[0].from.col!==e[0].to.col||e[0].from.col<=this.getSettings().fixedColumnsLeft-1)&&(n=!0),n}}}function yOe(t,r){return bOe(t)||gOe(t,r)||vOe(t,r)||mOe()}function mOe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function vOe(t,r){if(!!t){if(typeof t=="string")return DI(t,r);var e=Object.prototype.toString.call(t).slice(8,-1);if(e==="Object"&&t.constructor&&(e=t.constructor.name),e==="Map"||e==="Set")return Array.from(t);if(e==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return DI(t,r)}}function DI(t,r){(r==null||r>t.length)&&(r=t.length);for(var e=0,n=new Array(r);e<r;e++)n[e]=t[e];return n}function gOe(t,r){var e=t==null?null:typeof Symbol!="undefined"&&t[Symbol.iterator]||t["@@iterator"];if(e!=null){var n=[],i=!0,o=!1,a,s;try{for(e=e.call(t);!(i=(a=e.next()).done)&&(n.push(a.value),!(r&&n.length===r));i=!0);}catch(l){o=!0,s=l}finally{try{!i&&e.return!=null&&e.return()}finally{if(o)throw s}}return n}}function bOe(t){if(Array.isArray(t))return t}function wOe(t){return{key:"unfreeze_column",name:function(){return this.getTranslatedPhrase(O1)},callback:function(e,n){var i=yOe(n,1),o=i[0].start.col;t.unfreezeColumn(o),this.render(),this.view.adjustElementsSize(!0)},hidden:function(){var e=this.getSelectedRange(),n=!1;return(e===void 0||e.length>1||e[0].from.col!==e[0].to.col||e[0].from.col>=this.getSettings().fixedColumnsLeft)&&(n=!0),n}}}function mm(t){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?mm=function(e){return typeof e}:mm=function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},mm(t)}function _Oe(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}function NI(t,r){for(var e=0;e<r.length;e++){var n=r[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function SOe(t,r,e){return r&&NI(t.prototype,r),e&&NI(t,e),t}function zu(){return typeof Reflect!="undefined"&&Reflect.get?zu=Reflect.get:zu=function(r,e,n){var i=COe(r,e);if(!!i){var o=Object.getOwnPropertyDescriptor(i,e);return o.get?o.get.call(arguments.length<3?r:n):o.value}},zu.apply(this,arguments)}function COe(t,r){for(;!Object.prototype.hasOwnProperty.call(t,r)&&(t=Zo(t),t!==null););return t}function kOe(t,r){if(typeof r!="function"&&r!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(r&&r.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),r&&HC(t,r)}function HC(t,r){return HC=Object.setPrototypeOf||function(n,i){return n.__proto__=i,n},HC(t,r)}function OOe(t){var r=EOe();return function(){var n=Zo(t),i;if(r){var o=Zo(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return ROe(this,i)}}function ROe(t,r){if(r&&(mm(r)==="object"||typeof r=="function"))return r;if(r!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return $I(t)}function $I(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function EOe(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Zo(t){return Zo=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},Zo(t)}var jI="manualColumnFreeze",TOe=110,lc=new WeakMap,xOe=function(t){kOe(e,t);var r=OOe(e);function e(n){var i;return _Oe(this,e),i=r.call(this,n),lc.set($I(i),{afterFirstUse:!1}),i}return SOe(e,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[jI]}},{key:"enablePlugin",value:function(){var i=this;this.enabled||(this.addHook("afterContextMenuDefaultOptions",function(o){return i.addContextMenuEntry(o)}),this.addHook("beforeColumnMove",function(o,a){return i.onBeforeColumnMove(o,a)}),zu(Zo(e.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){var i=lc.get(this);i.afterFirstUse=!1,zu(Zo(e.prototype),"disablePlugin",this).call(this)}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),zu(Zo(e.prototype),"updatePlugin",this).call(this)}},{key:"freezeColumn",value:function(i){var o=lc.get(this),a=this.hot.getSettings();o.afterFirstUse||(o.afterFirstUse=!0),!(a.fixedColumnsLeft===this.hot.countCols()||i<=a.fixedColumnsLeft-1)&&(this.hot.columnIndexMapper.moveIndexes(i,a.fixedColumnsLeft),a.fixedColumnsLeft+=1)}},{key:"unfreezeColumn",value:function(i){var o=lc.get(this),a=this.hot.getSettings();o.afterFirstUse||(o.afterFirstUse=!0),!(a.fixedColumnsLeft<=0||i>a.fixedColumnsLeft-1)&&(a.fixedColumnsLeft-=1,this.hot.columnIndexMapper.moveIndexes(i,a.fixedColumnsLeft))}},{key:"addContextMenuEntry",value:function(i){i.items.push({name:"---------"},pOe(this),wOe(this))}},{key:"onBeforeColumnMove",value:function(i,o){var a=lc.get(this);if(a.afterFirstUse){var s=this.hot.getSettings().fixedColumnsLeft;if(o<s||i.some(function(l){return l<s}))return!1}}}],[{key:"PLUGIN_KEY",get:function(){return jI}},{key:"PLUGIN_PRIORITY",get:function(){return TOe}}]),e}(Lt);function AOe(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}function LI(t,r){for(var e=0;e<r.length;e++){var n=r[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function MOe(t,r,e){return r&&LI(t.prototype,r),e&&LI(t,e),t}var FC=0,HI=1,FI=2,Yu="px",POe=function(){function t(r){AOe(this,t),this.hot=r,this._element=null,this.state=FC}return MOe(t,[{key:"appendTo",value:function(e){e.appendChild(this._element),this.state=FI}},{key:"build",value:function(){this.state===FC&&(this._element=this.hot.rootDocument.createElement("div"),this.state=HI)}},{key:"destroy",value:function(){this.isAppended()&&this._element.parentElement.removeChild(this._element),this._element=null,this.state=FC}},{key:"isAppended",value:function(){return this.state===FI}},{key:"isBuilt",value:function(){return this.state>=HI}},{key:"setPosition",value:function(e,n){dn(e)&&(this._element.style.top=e+Yu),dn(n)&&(this._element.style.left=n+Yu)}},{key:"getPosition",value:function(){return{top:this._element.style.top?parseInt(this._element.style.top,10):0,left:this._element.style.left?parseInt(this._element.style.left,10):0}}},{key:"setSize",value:function(e,n){dn(e)&&(this._element.style.width=e+Yu),dn(n)&&(this._element.style.height=n+Yu)}},{key:"getSize",value:function(){return{width:this._element.style.width?parseInt(this._element.style.width,10):0,height:this._element.style.height?parseInt(this._element.style.height,10):0}}},{key:"setOffset",value:function(e,n){dn(e)&&(this._element.style.marginTop=e+Yu),dn(n)&&(this._element.style.marginLeft=n+Yu)}},{key:"getOffset",value:function(){return{top:this._element.style.marginTop?parseInt(this._element.style.marginTop,10):0,left:this._element.style.marginLeft?parseInt(this._element.style.marginLeft,10):0}}}]),t}(),BI=POe;function vm(t){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?vm=function(e){return typeof e}:vm=function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},vm(t)}function IOe(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}function VI(t,r){for(var e=0;e<r.length;e++){var n=r[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function DOe(t,r,e){return r&&VI(t.prototype,r),e&&VI(t,e),t}function gm(){return typeof Reflect!="undefined"&&Reflect.get?gm=Reflect.get:gm=function(r,e,n){var i=NOe(r,e);if(!!i){var o=Object.getOwnPropertyDescriptor(i,e);return o.get?o.get.call(arguments.length<3?r:n):o.value}},gm.apply(this,arguments)}function NOe(t,r){for(;!Object.prototype.hasOwnProperty.call(t,r)&&(t=Gu(t),t!==null););return t}function $Oe(t,r){if(typeof r!="function"&&r!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(r&&r.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),r&&BC(t,r)}function BC(t,r){return BC=Object.setPrototypeOf||function(n,i){return n.__proto__=i,n},BC(t,r)}function jOe(t){var r=FOe();return function(){var n=Gu(t),i;if(r){var o=Gu(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return LOe(this,i)}}function LOe(t,r){if(r&&(vm(r)==="object"||typeof r=="function"))return r;if(r!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return HOe(t)}function HOe(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function FOe(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Gu(t){return Gu=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},Gu(t)}var BOe="ht__manualColumnMove--backlight",VOe=function(t){$Oe(e,t);var r=jOe(e);function e(){return IOe(this,e),r.apply(this,arguments)}return DOe(e,[{key:"build",value:function(){gm(Gu(e.prototype),"build",this).call(this),Ie(this._element,BOe)}}]),e}(BI),WOe=VOe;function bm(t){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?bm=function(e){return typeof e}:bm=function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},bm(t)}function UOe(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}function WI(t,r){for(var e=0;e<r.length;e++){var n=r[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function zOe(t,r,e){return r&&WI(t.prototype,r),e&&WI(t,e),t}function wm(){return typeof Reflect!="undefined"&&Reflect.get?wm=Reflect.get:wm=function(r,e,n){var i=YOe(r,e);if(!!i){var o=Object.getOwnPropertyDescriptor(i,e);return o.get?o.get.call(arguments.length<3?r:n):o.value}},wm.apply(this,arguments)}function YOe(t,r){for(;!Object.prototype.hasOwnProperty.call(t,r)&&(t=Ku(t),t!==null););return t}function GOe(t,r){if(typeof r!="function"&&r!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(r&&r.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),r&&VC(t,r)}function VC(t,r){return VC=Object.setPrototypeOf||function(n,i){return n.__proto__=i,n},VC(t,r)}function KOe(t){var r=ZOe();return function(){var n=Ku(t),i;if(r){var o=Ku(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return qOe(this,i)}}function qOe(t,r){if(r&&(bm(r)==="object"||typeof r=="function"))return r;if(r!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return XOe(t)}function XOe(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function ZOe(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Ku(t){return Ku=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},Ku(t)}var JOe="ht__manualColumnMove--guideline",QOe=function(t){GOe(e,t);var r=KOe(e);function e(){return UOe(this,e),r.apply(this,arguments)}return zOe(e,[{key:"build",value:function(){wm(Ku(e.prototype),"build",this).call(this),Ie(this._element,JOe)}}]),e}(BI),e2e=QOe;function _m(t){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?_m=function(e){return typeof e}:_m=function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},_m(t)}function t2e(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}function UI(t,r){for(var e=0;e<r.length;e++){var n=r[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function r2e(t,r,e){return r&&UI(t.prototype,r),e&&UI(t,e),t}function as(){return typeof Reflect!="undefined"&&Reflect.get?as=Reflect.get:as=function(r,e,n){var i=n2e(r,e);if(!!i){var o=Object.getOwnPropertyDescriptor(i,e);return o.get?o.get.call(arguments.length<3?r:n):o.value}},as.apply(this,arguments)}function n2e(t,r){for(;!Object.prototype.hasOwnProperty.call(t,r)&&(t=Xi(t),t!==null););return t}function i2e(t,r){if(typeof r!="function"&&r!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(r&&r.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),r&&WC(t,r)}function WC(t,r){return WC=Object.setPrototypeOf||function(n,i){return n.__proto__=i,n},WC(t,r)}function o2e(t){var r=s2e();return function(){var n=Xi(t),i;if(r){var o=Xi(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return a2e(this,i)}}function a2e(t,r){if(r&&(_m(r)==="object"||typeof r=="function"))return r;if(r!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return UC(t)}function UC(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function s2e(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Xi(t){return Xi=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},Xi(t)}Ze.getSingleton().register("beforeColumnMove");Ze.getSingleton().register("afterColumnMove");var zC="manualColumnMove",u2e=120,Jo=new WeakMap,zI="ht__manualColumnMove",Sm="show-ui",YC="on-moving--columns",GC="after-selection--columns",l2e=function(t){i2e(e,t);var r=o2e(e);function e(n){var i;return t2e(this,e),i=r.call(this,n),Jo.set(UC(i),{columnsToMove:[],countCols:0,fixedColumns:0,pressed:void 0,target:{eventPageX:void 0,coords:void 0,TD:void 0,col:void 0},cachedDropIndex:void 0}),i.eventManager=new Wt(UC(i)),i.backlight=new WOe(n),i.guideline=new e2e(n),i}return r2e(e,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[zC]}},{key:"enablePlugin",value:function(){var i=this;this.enabled||(this.addHook("beforeOnCellMouseDown",function(){return i.onBeforeOnCellMouseDown.apply(i,arguments)}),this.addHook("beforeOnCellMouseOver",function(){return i.onBeforeOnCellMouseOver.apply(i,arguments)}),this.addHook("afterScrollVertically",function(){return i.onAfterScrollVertically()}),this.addHook("afterLoadData",function(){return i.onAfterLoadData()}),this.buildPluginUI(),this.registerEvents(),Ie(this.hot.rootElement,zI),as(Xi(e.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),this.moveBySettingsOrLoad(),as(Xi(e.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){dt(this.hot.rootElement,zI),this.unregisterEvents(),this.backlight.destroy(),this.guideline.destroy(),as(Xi(e.prototype),"disablePlugin",this).call(this)}},{key:"moveColumn",value:function(i,o){return this.moveColumns([i],o)}},{key:"moveColumns",value:function(i,o){var a=Jo.get(this),s=a.cachedDropIndex,l=this.isMovePossible(i,o),p=this.hot.runHooks("beforeColumnMove",i,o,s,l);if(a.cachedDropIndex=void 0,p!==!1){l&&this.hot.columnIndexMapper.moveIndexes(i,o);var d=l&&this.isColumnOrderChanged(i,o);return this.hot.runHooks("afterColumnMove",i,o,s,l,d),d}}},{key:"dragColumn",value:function(i,o){return this.dragColumns([i],o)}},{key:"dragColumns",value:function(i,o){var a=this.countFinalIndex(i,o),s=Jo.get(this);return s.cachedDropIndex=o,this.moveColumns(i,a)}},{key:"isMovePossible",value:function(i,o){var a=this.hot.columnIndexMapper.getNotTrimmedIndexesLength(),s=i.length+o>a,l=o<0,p=i.some(function(g){return g<0}),d=i.some(function(g){return g>=a});return!(s||l||p||d)}},{key:"isColumnOrderChanged",value:function(i,o){return i.some(function(a,s){return a-s!==o})}},{key:"countFinalIndex",value:function(i,o){var a=pr(i,function(s,l){return l<o&&(s+=1),s},0);return o-a}},{key:"getColumnsWidth",value:function(i,o){for(var a=this.hot.columnIndexMapper,s=0,l=i;l<=o;l+=1){var p=a.getRenderableFromVisualIndex(l);l<0?s+=this.hot.view.wt.wtViewport.getRowHeaderWidth()||0:p!==null&&(s+=this.hot.view.wt.wtTable.getStretchedColumnWidth(p)||0)}return s}},{key:"moveBySettingsOrLoad",value:function(){var i=this.hot.getSettings()[zC];if(Array.isArray(i))this.moveColumns(i,0);else if(i!==void 0){var o=this.persistentStateLoad();o.length&&this.moveColumns(o,0)}}},{key:"isFixedColumnsLeft",value:function(i){return i<this.hot.getSettings().fixedColumnsLeft}},{key:"persistentStateSave",value:function(){this.hot.runHooks("persistentStateSave","manualColumnMove",this.hot.columnIndexMapper.getIndexesSequence())}},{key:"persistentStateLoad",value:function(){var i={};return this.hot.runHooks("persistentStateLoad","manualColumnMove",i),i.value?i.value:[]}},{key:"prepareColumnsToMoving",value:function(i,o){var a=[];return Qe(i,o,function(s){a.push(s)}),a}},{key:"refreshPositions",value:function(){var i=Jo.get(this),o=this.hot.view.wt.wtTable.getFirstVisibleColumn(),a=this.hot.view.wt.wtTable.getLastVisibleColumn(),s=this.hot.view.wt.wtTable,l=this.hot.view.wt.wtOverlays.scrollableElement,p=typeof l.scrollX=="number"?l.scrollX:l.scrollLeft,d=this.hot.view.THEAD.offsetLeft+this.getColumnsWidth(0,i.coords-1),g=i.target.eventPageX-(i.rootElementOffset-(l.scrollX===void 0?p:0)),y=s.hider.offsetWidth,h=s.TBODY.offsetLeft,u=this.backlight.getOffset().left,f=this.backlight.getSize().width,c=0;if(i.rootElementOffset+s.holder.offsetWidth+p<i.target.eventPageX&&i.coords<i.countCols&&(i.coords+=1),i.hasRowHeaders&&(c=this.hot.view.wt.wtOverlays.leftOverlay.clone.wtTable.getColumnHeader(-1).offsetWidth),this.isFixedColumnsLeft(i.coords)&&(d+=p),d+=c,i.coords<0)i.fixedColumns>0?i.target.col=0:i.target.col=o>0?o-1:o;else if(i.target.TD.offsetWidth/2+d<=g){var v=i.coords>=i.countCols?i.countCols-1:i.coords;i.target.col=v+1,d+=i.target.TD.offsetWidth,i.target.col>a&&a<i.countCols&&this.hot.scrollViewportTo(void 0,a+1,void 0,!0)}else i.target.col=i.coords,i.target.col<=o&&i.target.col>=i.fixedColumns&&o>0&&this.hot.scrollViewportTo(void 0,o-1);i.target.col<=o&&i.target.col>=i.fixedColumns&&o>0&&this.hot.scrollViewportTo(void 0,o-1);var m=g,b=d;g+f+u>=y?m=y-f-u:g+u<h+c&&(m=h+c+Math.abs(u)),d>=y-1?b=y-1:b===0?b=1:l.scrollX!==void 0&&i.coords<i.fixedColumns&&(b-=i.rootElementOffset<=l.scrollX?i.rootElementOffset:0),this.backlight.setPosition(null,m),this.guideline.setPosition(null,b)}},{key:"registerEvents",value:function(){var i=this,o=this.hot.rootDocument.documentElement;this.eventManager.addEventListener(o,"mousemove",function(a){return i.onMouseMove(a)}),this.eventManager.addEventListener(o,"mouseup",function(){return i.onMouseUp()})}},{key:"unregisterEvents",value:function(){this.eventManager.clear()}},{key:"onBeforeOnCellMouseDown",value:function(i,o,a,s){var l=this.hot.view.wt.wtTable,p=this.hot.selection.isSelectedByColumnHeader(),d=this.hot.getSelectedRangeLast(),g=Jo.get(this),y=lt(i.target,"sortAction");if(!d||!p||g.pressed||i.button!==0||y){g.pressed=!1,g.columnsToMove.length=0,dt(this.hot.rootElement,[YC,Sm]);return}var h=this.guideline.isBuilt()&&!this.guideline.isAppended(),u=this.backlight.isBuilt()&&!this.backlight.isAppended();h&&u&&(this.guideline.appendTo(l.hider),this.backlight.appendTo(l.hider));var f=d.from,c=d.to,v=Math.min(f.col,c.col),m=Math.max(f.col,c.col);if(o.row<0&&o.col>=v&&o.col<=m){s.column=!0,g.pressed=!0,g.target.eventPageX=i.pageX,g.coords=o.col,g.target.TD=a,g.target.col=o.col,g.columnsToMove=this.prepareColumnsToMoving(v,m),g.hasRowHeaders=!!this.hot.getSettings().rowHeaders,g.countCols=this.hot.countCols(),g.fixedColumns=this.hot.getSettings().fixedColumnsLeft,g.rootElementOffset=ar(this.hot.rootElement).left;var b=g.hasRowHeaders?-1:0,w=l.holder.scrollTop+l.getColumnHeaderHeight(0)+1,_=o.col<g.fixedColumns,C=this.hot.view.wt.wtOverlays.scrollableElement,R=C.scrollX?C.scrollX-g.rootElementOffset:0,I=i.offsetX-(_?R:0),P=Math.abs(this.getColumnsWidth(v,o.col-1)+I);this.backlight.setPosition(w,this.getColumnsWidth(b,v-1)+P),this.backlight.setSize(this.getColumnsWidth(v,m),l.hider.offsetHeight-w),this.backlight.setOffset(null,P*-1),Ie(this.hot.rootElement,YC)}else dt(this.hot.rootElement,GC),g.pressed=!1,g.columnsToMove.length=0}},{key:"onMouseMove",value:function(i){var o=Jo.get(this);if(!!o.pressed){if(i.target===this.backlight.element){var a=this.backlight.getSize().width;this.backlight.setSize(0),setTimeout(function(){this.backlight.setPosition(a)})}o.target.eventPageX=i.pageX,this.refreshPositions()}}},{key:"onBeforeOnCellMouseOver",value:function(i,o,a,s){var l=this.hot.getSelectedRangeLast(),p=Jo.get(this);!l||!p.pressed||(p.columnsToMove.indexOf(o.col)>-1?dt(this.hot.rootElement,Sm):Ie(this.hot.rootElement,Sm),s.row=!0,s.column=!0,s.cell=!0,p.coords=o.col,p.target.TD=a)}},{key:"onMouseUp",value:function(){var i=Jo.get(this),o=i.target.col,a=i.columnsToMove.length;if(i.coords=void 0,i.pressed=!1,i.backlightWidth=0,dt(this.hot.rootElement,[YC,Sm,GC]),this.hot.selection.isSelectedByColumnHeader()&&Ie(this.hot.rootElement,GC),!(a<1||o===void 0)){var s=i.columnsToMove[0],l=this.hot.toPhysicalColumn(s),p=this.dragColumns(i.columnsToMove,o);if(i.columnsToMove.length=0,p===!0){this.persistentStateSave(),this.hot.render(),this.hot.view.adjustElementsSize(!0);var d=this.hot.toVisualColumn(l),g=d+a-1;this.hot.selectColumns(d,g)}}}},{key:"onAfterScrollVertically",value:function(){var i=this.hot.view.wt.wtTable,o=i.getColumnHeaderHeight(0)+1,a=i.holder.scrollTop,s=o+a;this.backlight.setPosition(s),this.backlight.setSize(null,i.hider.offsetHeight-s)}},{key:"buildPluginUI",value:function(){this.backlight.build(),this.guideline.build()}},{key:"onAfterLoadData",value:function(){this.moveBySettingsOrLoad()}},{key:"destroy",value:function(){this.backlight.destroy(),this.guideline.destroy(),as(Xi(e.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return zC}},{key:"PLUGIN_PRIORITY",get:function(){return u2e}}]),e}(Lt);function Cm(t){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?Cm=function(e){return typeof e}:Cm=function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Cm(t)}function f2e(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}function YI(t,r){for(var e=0;e<r.length;e++){var n=r[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function c2e(t,r,e){return r&&YI(t.prototype,r),e&&YI(t,e),t}function ss(){return typeof Reflect!="undefined"&&Reflect.get?ss=Reflect.get:ss=function(r,e,n){var i=h2e(r,e);if(!!i){var o=Object.getOwnPropertyDescriptor(i,e);return o.get?o.get.call(arguments.length<3?r:n):o.value}},ss.apply(this,arguments)}function h2e(t,r){for(;!Object.prototype.hasOwnProperty.call(t,r)&&(t=Zi(t),t!==null););return t}function d2e(t,r){if(typeof r!="function"&&r!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(r&&r.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),r&&KC(t,r)}function KC(t,r){return KC=Object.setPrototypeOf||function(n,i){return n.__proto__=i,n},KC(t,r)}function p2e(t){var r=m2e();return function(){var n=Zi(t),i;if(r){var o=Zi(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return y2e(this,i)}}function y2e(t,r){if(r&&(Cm(r)==="object"||typeof r=="function"))return r;if(r!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return qC(t)}function qC(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function m2e(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Zi(t){return Zi=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},Zi(t)}var km="manualColumnResize",v2e=130,GI="manualColumnWidths",XC=new WeakMap,g2e=function(t){d2e(e,t);var r=p2e(e);function e(n){var i;f2e(this,e),i=r.call(this,n);var o=i.hot.rootDocument;return i.currentTH=null,i.currentCol=null,i.selectedCols=[],i.currentWidth=null,i.newSize=null,i.startY=null,i.startWidth=null,i.startOffset=null,i.handle=o.createElement("DIV"),i.guide=o.createElement("DIV"),i.eventManager=new Wt(qC(i)),i.pressed=null,i.dblclick=0,i.autoresizeTimeout=null,i.columnWidthsMap=void 0,XC.set(qC(i),{config:void 0}),Ie(i.handle,"manualColumnResizer"),Ie(i.guide,"manualColumnResizerGuide"),i}return c2e(e,[{key:"isEnabled",value:function(){return this.hot.getSettings()[km]}},{key:"enablePlugin",value:function(){var i=this;this.enabled||(this.columnWidthsMap=new $o,this.columnWidthsMap.addLocalHook("init",function(){return i.onMapInit()}),this.hot.columnIndexMapper.registerMap(this.pluginName,this.columnWidthsMap),this.addHook("modifyColWidth",function(o,a){return i.onModifyColWidth(o,a)}),this.addHook("beforeStretchingColumnWidth",function(o,a){return i.onBeforeStretchingColumnWidth(o,a)}),this.addHook("beforeColumnResize",function(o,a,s){return i.onBeforeColumnResize(o,a,s)}),this.bindEvents(),ss(Zi(e.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),ss(Zi(e.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){var i=XC.get(this);i.config=this.columnWidthsMap.getValues(),this.hot.columnIndexMapper.unregisterMap(this.pluginName),ss(Zi(e.prototype),"disablePlugin",this).call(this)}},{key:"saveManualColumnWidths",value:function(){this.hot.runHooks("persistentStateSave",GI,this.columnWidthsMap.getValues())}},{key:"loadManualColumnWidths",value:function(){var i={};return this.hot.runHooks("persistentStateLoad",GI,i),i.value}},{key:"setManualSize",value:function(i,o){var a=Math.max(o,20),s=this.hot.toPhysicalColumn(i);return this.columnWidthsMap.setValueAtIndex(s,a),a}},{key:"clearManualSize",value:function(i){var o=this.hot.toPhysicalColumn(i);this.columnWidthsMap.setValueAtIndex(o,null)}},{key:"onMapInit",value:function(){var i=this,o=XC.get(this),a=this.hot.getSettings()[km],s=this.loadManualColumnWidths();typeof s!="undefined"?this.hot.batchExecution(function(){s.forEach(function(l,p){i.columnWidthsMap.setValueAtIndex(p,l)})},!0):Array.isArray(a)?(this.hot.batchExecution(function(){a.forEach(function(l,p){i.columnWidthsMap.setValueAtIndex(p,l)})},!0),o.config=a):a===!0&&Array.isArray(o.config)&&this.hot.batchExecution(function(){o.config.forEach(function(l,p){i.columnWidthsMap.setValueAtIndex(p,l)})},!0)}},{key:"setupHandlePosition",value:function(i){var o=this;if(!!i.parentNode){this.currentTH=i;var a=this.hot.view.wt,s=a.wtTable.getCoords(this.currentTH),l=s.col;if(!(l<0)){var p=yr(this.currentTH),d=this.currentTH.getBoundingClientRect(),g=l<a.getSetting("fixedColumnsLeft"),y;g&&(y=a.wtOverlays.topLeftCornerOverlay.getRelativeCellPosition(this.currentTH,s.row,s.col)),y||(y=a.wtOverlays.topOverlay.getRelativeCellPosition(this.currentTH,s.row,s.col)),this.currentCol=this.hot.columnIndexMapper.getVisualFromRenderableIndex(l),this.selectedCols=[];var h=this.hot.selection.isSelectedByCorner()||this.hot.selection.isSelectedByColumnHeader();if(this.hot.selection.isSelected()&&h){var u=this.hot.getSelectedRange();he(u,function(f){var c=f.getTopLeftCorner().col,v=f.getBottomRightCorner().col;Qe(c,v,function(m){o.selectedCols.includes(m)||o.selectedCols.push(m)})})}this.selectedCols.includes(this.currentCol)||(this.selectedCols=[this.currentCol]),this.startOffset=y.left-6,this.startWidth=parseInt(d.width,10),this.handle.style.top="".concat(y.top,"px"),this.handle.style.left="".concat(this.startOffset+this.startWidth,"px"),this.handle.style.height="".concat(p,"px"),this.hot.rootElement.appendChild(this.handle)}}}},{key:"refreshHandlePosition",value:function(){this.handle.style.left="".concat(this.startOffset+this.currentWidth,"px")}},{key:"setupGuidePosition",value:function(){var i=parseInt(yr(this.handle),10),o=parseInt(this.handle.style.top,10)+i,a=parseInt(this.hot.view.maximumVisibleElementHeight(0),10);Ie(this.handle,"active"),Ie(this.guide,"active"),this.guide.style.top="".concat(o,"px"),this.guide.style.left=this.handle.style.left,this.guide.style.height="".concat(a-i,"px"),this.hot.rootElement.appendChild(this.guide)}},{key:"refreshGuidePosition",value:function(){this.guide.style.left=this.handle.style.left}},{key:"hideHandleAndGuide",value:function(){dt(this.handle,"active"),dt(this.guide,"active")}},{key:"checkIfColumnHeader",value:function(i){return!!Ti(i,["THEAD"],this.hot.rootElement)}},{key:"getClosestTHParent",value:function(i){return i.tagName!=="TABLE"?i.tagName==="TH"?i:this.getClosestTHParent(i.parentNode):null}},{key:"onMouseOver",value:function(i){if(!x0(i.target)&&this.checkIfColumnHeader(i.target)){var o=this.getClosestTHParent(i.target);if(!o)return;var a=o.getAttribute("colspan");o&&(a===null||a==="1")&&(this.pressed||this.setupHandlePosition(o))}}},{key:"afterMouseDownTimeout",value:function(){var i=this,o=function(){i.hot.forceFullRender=!0,i.hot.view.render(),i.hot.view.adjustElementsSize(!0)},a=function(p,d){var g=i.hot.runHooks("beforeColumnResize",i.newSize,p,!0);g!==void 0&&(i.newSize=g),i.hot.getSettings().stretchH==="all"?i.clearManualSize(p):i.setManualSize(p,i.newSize),i.saveManualColumnWidths(),i.hot.runHooks("afterColumnResize",i.newSize,p,!0),d&&o()};if(this.dblclick>=2){var s=this.selectedCols.length;s>1?(he(this.selectedCols,function(l){a(l)}),o()):he(this.selectedCols,function(l){a(l,!0)})}this.dblclick=0,this.autoresizeTimeout=null}},{key:"onMouseDown",value:function(i){var o=this;lt(i.target,"manualColumnResizer")&&(this.setupHandlePosition(this.currentTH),this.setupGuidePosition(),this.pressed=!0,this.autoresizeTimeout===null&&(this.autoresizeTimeout=setTimeout(function(){return o.afterMouseDownTimeout()},500),this.hot._registerTimeout(this.autoresizeTimeout)),this.dblclick+=1,this.startX=i.pageX,this.newSize=this.startWidth)}},{key:"onMouseMove",value:function(i){var o=this;this.pressed&&(this.currentWidth=this.startWidth+(i.pageX-this.startX),he(this.selectedCols,function(a){o.newSize=o.setManualSize(a,o.currentWidth)}),this.refreshHandlePosition(),this.refreshGuidePosition())}},{key:"onMouseUp",value:function(){var i=this,o=function(){i.hot.forceFullRender=!0,i.hot.view.render(),i.hot.view.adjustElementsSize(!0)},a=function(p,d){i.hot.runHooks("beforeColumnResize",i.newSize,p,!1),d&&o(),i.saveManualColumnWidths(),i.hot.runHooks("afterColumnResize",i.newSize,p,!1)};if(this.pressed){if(this.hideHandleAndGuide(),this.pressed=!1,this.newSize!==this.startWidth){var s=this.selectedCols.length;s>1?(he(this.selectedCols,function(l){a(l)}),o()):he(this.selectedCols,function(l){a(l,!0)})}this.setupHandlePosition(this.currentTH)}}},{key:"bindEvents",value:function(){var i=this,o=this.hot,a=o.rootWindow,s=o.rootElement;this.eventManager.addEventListener(s,"mouseover",function(l){return i.onMouseOver(l)}),this.eventManager.addEventListener(s,"mousedown",function(l){return i.onMouseDown(l)}),this.eventManager.addEventListener(a,"mousemove",function(l){return i.onMouseMove(l)}),this.eventManager.addEventListener(a,"mouseup",function(){return i.onMouseUp()})}},{key:"onModifyColWidth",value:function(i,o){var a=i;if(this.enabled){var s=this.hot.toPhysicalColumn(o),l=this.columnWidthsMap.getValueAtIndex(s);this.hot.getSettings()[km]&&l&&(a=l)}return a}},{key:"onBeforeStretchingColumnWidth",value:function(i,o){var a=this.columnWidthsMap.getValueAtIndex(o);return a===null&&(a=i),a}},{key:"onBeforeColumnResize",value:function(){this.hot.view.wt.wtViewport.resetHasOversizedColumnHeadersMarked()}},{key:"destroy",value:function(){ss(Zi(e.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return km}},{key:"PLUGIN_PRIORITY",get:function(){return v2e}}]),e}(Lt);function b2e(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}function KI(t,r){for(var e=0;e<r.length;e++){var n=r[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function w2e(t,r,e){return r&&KI(t.prototype,r),e&&KI(t,e),t}var ZC=0,qI=1,XI=2,qu="px",_2e=function(){function t(r){b2e(this,t),this.hot=r,this._element=null,this.state=ZC}return w2e(t,[{key:"appendTo",value:function(e){e.appendChild(this._element),this.state=XI}},{key:"build",value:function(){this.state===ZC&&(this._element=this.hot.rootDocument.createElement("div"),this.state=qI)}},{key:"destroy",value:function(){this.isAppended()&&this._element.parentElement.removeChild(this._element),this._element=null,this.state=ZC}},{key:"isAppended",value:function(){return this.state===XI}},{key:"isBuilt",value:function(){return this.state>=qI}},{key:"setPosition",value:function(e,n){e!==void 0&&(this._element.style.top=e+qu),n!==void 0&&(this._element.style.left=n+qu)}},{key:"getPosition",value:function(){return{top:this._element.style.top?parseInt(this._element.style.top,10):0,left:this._element.style.left?parseInt(this._element.style.left,10):0}}},{key:"setSize",value:function(e,n){e&&(this._element.style.width=e+qu),n&&(this._element.style.height=n+qu)}},{key:"getSize",value:function(){return{width:this._element.style.width?parseInt(this._element.style.width,10):0,height:this._element.style.height?parseInt(this._element.style.height,10):0}}},{key:"setOffset",value:function(e,n){e&&(this._element.style.marginTop=e+qu),n&&(this._element.style.marginLeft=n+qu)}},{key:"getOffset",value:function(){return{top:this._element.style.marginTop?parseInt(this._element.style.marginTop,10):0,left:this._element.style.marginLeft?parseInt(this._element.style.marginLeft,10):0}}}]),t}(),ZI=_2e;function Om(t){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?Om=function(e){return typeof e}:Om=function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Om(t)}function S2e(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}function JI(t,r){for(var e=0;e<r.length;e++){var n=r[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function C2e(t,r,e){return r&&JI(t.prototype,r),e&&JI(t,e),t}function Rm(){return typeof Reflect!="undefined"&&Reflect.get?Rm=Reflect.get:Rm=function(r,e,n){var i=k2e(r,e);if(!!i){var o=Object.getOwnPropertyDescriptor(i,e);return o.get?o.get.call(arguments.length<3?r:n):o.value}},Rm.apply(this,arguments)}function k2e(t,r){for(;!Object.prototype.hasOwnProperty.call(t,r)&&(t=Xu(t),t!==null););return t}function O2e(t,r){if(typeof r!="function"&&r!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(r&&r.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),r&&JC(t,r)}function JC(t,r){return JC=Object.setPrototypeOf||function(n,i){return n.__proto__=i,n},JC(t,r)}function R2e(t){var r=x2e();return function(){var n=Xu(t),i;if(r){var o=Xu(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return E2e(this,i)}}function E2e(t,r){if(r&&(Om(r)==="object"||typeof r=="function"))return r;if(r!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return T2e(t)}function T2e(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function x2e(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Xu(t){return Xu=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},Xu(t)}var A2e="ht__manualRowMove--backlight",M2e=function(t){O2e(e,t);var r=R2e(e);function e(){return S2e(this,e),r.apply(this,arguments)}return C2e(e,[{key:"build",value:function(){Rm(Xu(e.prototype),"build",this).call(this),Ie(this._element,A2e)}}]),e}(ZI),P2e=M2e;function Em(t){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?Em=function(e){return typeof e}:Em=function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Em(t)}function I2e(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}function QI(t,r){for(var e=0;e<r.length;e++){var n=r[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function D2e(t,r,e){return r&&QI(t.prototype,r),e&&QI(t,e),t}function Tm(){return typeof Reflect!="undefined"&&Reflect.get?Tm=Reflect.get:Tm=function(r,e,n){var i=N2e(r,e);if(!!i){var o=Object.getOwnPropertyDescriptor(i,e);return o.get?o.get.call(arguments.length<3?r:n):o.value}},Tm.apply(this,arguments)}function N2e(t,r){for(;!Object.prototype.hasOwnProperty.call(t,r)&&(t=Zu(t),t!==null););return t}function $2e(t,r){if(typeof r!="function"&&r!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(r&&r.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),r&&QC(t,r)}function QC(t,r){return QC=Object.setPrototypeOf||function(n,i){return n.__proto__=i,n},QC(t,r)}function j2e(t){var r=F2e();return function(){var n=Zu(t),i;if(r){var o=Zu(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return L2e(this,i)}}function L2e(t,r){if(r&&(Em(r)==="object"||typeof r=="function"))return r;if(r!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return H2e(t)}function H2e(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function F2e(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Zu(t){return Zu=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},Zu(t)}var B2e="ht__manualRowMove--guideline",V2e=function(t){$2e(e,t);var r=j2e(e);function e(){return I2e(this,e),r.apply(this,arguments)}return D2e(e,[{key:"build",value:function(){Tm(Zu(e.prototype),"build",this).call(this),Ie(this._element,B2e)}}]),e}(ZI),W2e=V2e;function xm(t){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?xm=function(e){return typeof e}:xm=function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},xm(t)}function U2e(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}function e7(t,r){for(var e=0;e<r.length;e++){var n=r[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function z2e(t,r,e){return r&&e7(t.prototype,r),e&&e7(t,e),t}function us(){return typeof Reflect!="undefined"&&Reflect.get?us=Reflect.get:us=function(r,e,n){var i=Y2e(r,e);if(!!i){var o=Object.getOwnPropertyDescriptor(i,e);return o.get?o.get.call(arguments.length<3?r:n):o.value}},us.apply(this,arguments)}function Y2e(t,r){for(;!Object.prototype.hasOwnProperty.call(t,r)&&(t=Ji(t),t!==null););return t}function G2e(t,r){if(typeof r!="function"&&r!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(r&&r.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),r&&ek(t,r)}function ek(t,r){return ek=Object.setPrototypeOf||function(n,i){return n.__proto__=i,n},ek(t,r)}function K2e(t){var r=X2e();return function(){var n=Ji(t),i;if(r){var o=Ji(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return q2e(this,i)}}function q2e(t,r){if(r&&(xm(r)==="object"||typeof r=="function"))return r;if(r!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return tk(t)}function tk(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function X2e(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Ji(t){return Ji=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},Ji(t)}Ze.getSingleton().register("beforeRowMove");Ze.getSingleton().register("afterRowMove");var rk="manualRowMove",Z2e=140,Qo=new WeakMap,t7="ht__manualRowMove",Am="show-ui",nk="on-moving--rows",ik="after-selection--rows",J2e=function(t){G2e(e,t);var r=K2e(e);function e(n){var i;return U2e(this,e),i=r.call(this,n),Qo.set(tk(i),{rowsToMove:[],pressed:void 0,target:{eventPageY:void 0,coords:void 0,TD:void 0,row:void 0},cachedDropIndex:void 0}),i.eventManager=new Wt(tk(i)),i.backlight=new P2e(n),i.guideline=new W2e(n),i}return z2e(e,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[rk]}},{key:"enablePlugin",value:function(){var i=this;this.enabled||(this.addHook("beforeOnCellMouseDown",function(){return i.onBeforeOnCellMouseDown.apply(i,arguments)}),this.addHook("beforeOnCellMouseOver",function(){return i.onBeforeOnCellMouseOver.apply(i,arguments)}),this.addHook("afterScrollHorizontally",function(){return i.onAfterScrollHorizontally()}),this.addHook("afterLoadData",function(){return i.onAfterLoadData()}),this.buildPluginUI(),this.registerEvents(),Ie(this.hot.rootElement,t7),us(Ji(e.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),this.moveBySettingsOrLoad(),us(Ji(e.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){dt(this.hot.rootElement,t7),this.unregisterEvents(),this.backlight.destroy(),this.guideline.destroy(),us(Ji(e.prototype),"disablePlugin",this).call(this)}},{key:"moveRow",value:function(i,o){return this.moveRows([i],o)}},{key:"moveRows",value:function(i,o){var a=Qo.get(this),s=a.cachedDropIndex,l=this.isMovePossible(i,o),p=this.hot.runHooks("beforeRowMove",i,o,s,l);if(a.cachedDropIndex=void 0,p!==!1){l&&this.hot.rowIndexMapper.moveIndexes(i,o);var d=l&&this.isRowOrderChanged(i,o);return this.hot.runHooks("afterRowMove",i,o,s,l,d),d}}},{key:"dragRow",value:function(i,o){return this.dragRows([i],o)}},{key:"dragRows",value:function(i,o){var a=this.countFinalIndex(i,o),s=Qo.get(this);return s.cachedDropIndex=o,this.moveRows(i,a)}},{key:"isMovePossible",value:function(i,o){var a=this.hot.rowIndexMapper.getNotTrimmedIndexesLength(),s=i.length+o>a,l=o<0,p=i.some(function(g){return g<0}),d=i.some(function(g){return g>=a});return!(s||l||p||d)}},{key:"isRowOrderChanged",value:function(i,o){return i.some(function(a,s){return a-s!==o})}},{key:"countFinalIndex",value:function(i,o){var a=pr(i,function(s,l){return l<o&&(s+=1),s},0);return o-a}},{key:"getRowsHeight",value:function(i,o){for(var a=this.hot.rowIndexMapper,s=0,l=i;l<=o;l++){var p=a.getRenderableFromVisualIndex(l);p!==null&&(s+=this.hot.view.wt.wtTable.getRowHeight(p)||23)}return s}},{key:"moveBySettingsOrLoad",value:function(){var i=this.hot.getSettings()[rk];if(Array.isArray(i))this.moveRows(i,0);else if(i!==void 0){var o=this.persistentStateLoad();o.length&&this.moveRows(o,0)}}},{key:"isFixedRowTop",value:function(i){return i<this.hot.getSettings().fixedRowsTop}},{key:"isFixedRowBottom",value:function(i){return i>this.hot.getSettings().fixedRowsBottom}},{key:"persistentStateSave",value:function(){this.hot.runHooks("persistentStateSave","manualRowMove",this.hot.rowIndexMapper.getIndexesSequence())}},{key:"persistentStateLoad",value:function(){var i={};return this.hot.runHooks("persistentStateLoad","manualRowMove",i),i.value?i.value:[]}},{key:"prepareRowsToMoving",value:function(){var i=this.hot.getSelectedRangeLast(),o=[];if(!i)return o;var a=i.from,s=i.to,l=Math.min(a.row,s.row),p=Math.max(a.row,s.row);return Qe(l,p,function(d){o.push(d)}),o}},{key:"refreshPositions",value:function(){var i=Qo.get(this),o=i.target.coords,a=this.hot.view.wt.wtTable.getFirstVisibleRow(),s=this.hot.view.wt.wtTable.getLastVisibleRow(),l=this.hot.getSettings().fixedRowsTop,p=this.hot.countRows();o.row<l&&a>0&&this.hot.scrollViewportTo(a-1),o.row>=s&&s<p&&this.hot.scrollViewportTo(s+1,void 0,!0);var d=this.hot.view.wt.wtTable,g=i.target.TD,y=ar(this.hot.rootElement),h=this.hot.view.THEAD.offsetHeight+this.getRowsHeight(0,o.row-1),u=i.target.eventPageY-y.top+d.holder.scrollTop,f=d.hider.offsetHeight,c=d.TBODY.offsetTop,v=this.backlight.getOffset().top,m=this.backlight.getSize().height;this.isFixedRowTop(o.row)&&(h+=d.holder.scrollTop),o.row<0?i.target.row=a>0?a-1:a:g.offsetHeight/2+h<=u?(i.target.row=o.row+1,h+=o.row===0?g.offsetHeight-1:g.offsetHeight):i.target.row=o.row;var b=u,w=h;u+m+v>=f?b=f-m-v:u+v<c&&(b=c+Math.abs(v)),h>=f-1&&(w=f-1);var _=0;this.hot.view.wt.wtOverlays.topOverlay&&(_=this.hot.view.wt.wtOverlays.topOverlay.clone.wtTable.TABLE.offsetHeight),o.row>=l&&w-d.holder.scrollTop<_&&this.hot.scrollViewportTo(o.row),this.backlight.setPosition(b),this.guideline.setPosition(w)}},{key:"registerEvents",value:function(){var i=this,o=this.hot.rootDocument.documentElement;this.eventManager.addEventListener(o,"mousemove",function(a){return i.onMouseMove(a)}),this.eventManager.addEventListener(o,"mouseup",function(){return i.onMouseUp()})}},{key:"unregisterEvents",value:function(){this.eventManager.clear()}},{key:"onBeforeOnCellMouseDown",value:function(i,o,a,s){var l=this.hot.view.wt,p=l.wtTable,d=l.wtViewport,g=this.hot.selection.isSelectedByRowHeader(),y=this.hot.getSelectedRangeLast(),h=Qo.get(this);if(!y||!g||h.pressed||i.button!==0){h.pressed=!1,h.rowsToMove.length=0,dt(this.hot.rootElement,[nk,Am]);return}var u=this.guideline.isBuilt()&&!this.guideline.isAppended(),f=this.backlight.isBuilt()&&!this.backlight.isAppended();u&&f&&(this.guideline.appendTo(p.hider),this.backlight.appendTo(p.hider));var c=y.from,v=y.to,m=Math.min(c.row,v.row),b=Math.max(c.row,v.row);if(o.col<0&&o.row>=m&&o.row<=b){s.row=!0,h.pressed=!0,h.target.eventPageY=i.pageY,h.target.coords=o,h.target.TD=a,h.rowsToMove=this.prepareRowsToMoving();var w=p.holder.scrollLeft+d.getRowHeaderWidth();this.backlight.setPosition(null,w),this.backlight.setSize(p.hider.offsetWidth-w,this.getRowsHeight(m,b)),this.backlight.setOffset((this.getRowsHeight(m,o.row-1)+i.offsetY)*-1,null),Ie(this.hot.rootElement,nk),this.refreshPositions()}else dt(this.hot.rootElement,ik),h.pressed=!1,h.rowsToMove.length=0}},{key:"onMouseMove",value:function(i){var o=Qo.get(this);if(!!o.pressed){if(i.target===this.backlight.element){var a=this.backlight.getSize().height;this.backlight.setSize(null,0),setTimeout(function(){this.backlight.setPosition(null,a)})}o.target.eventPageY=i.pageY,this.refreshPositions()}}},{key:"onBeforeOnCellMouseOver",value:function(i,o,a,s){var l=this.hot.getSelectedRangeLast(),p=Qo.get(this);!l||!p.pressed||(p.rowsToMove.indexOf(o.row)>-1?dt(this.hot.rootElement,Am):Ie(this.hot.rootElement,Am),s.row=!0,s.column=!0,s.cell=!0,p.target.coords=o,p.target.TD=a)}},{key:"onMouseUp",value:function(){var i=Qo.get(this),o=i.target.row,a=i.rowsToMove.length;if(i.pressed=!1,i.backlightHeight=0,dt(this.hot.rootElement,[nk,Am,ik]),this.hot.selection.isSelectedByRowHeader()&&Ie(this.hot.rootElement,ik),!(a<1||o===void 0)){var s=i.rowsToMove[0],l=this.hot.toPhysicalRow(s),p=this.dragRows(i.rowsToMove,o);if(i.rowsToMove.length=0,p===!0){this.persistentStateSave(),this.hot.render(),this.hot.view.adjustElementsSize(!0);var d=this.hot.toVisualRow(l),g=d+a-1;this.hot.selectRows(d,g)}}}},{key:"onAfterScrollHorizontally",value:function(){var i=this.hot.view.wt.wtTable,o=this.hot.view.wt.wtViewport.getRowHeaderWidth(),a=i.holder.scrollLeft,s=o+a;this.backlight.setPosition(null,s),this.backlight.setSize(i.hider.offsetWidth-s)}},{key:"buildPluginUI",value:function(){this.backlight.build(),this.guideline.build()}},{key:"onAfterLoadData",value:function(){this.moveBySettingsOrLoad()}},{key:"destroy",value:function(){this.backlight.destroy(),this.guideline.destroy(),us(Ji(e.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return rk}},{key:"PLUGIN_PRIORITY",get:function(){return Z2e}}]),e}(Lt);function Mm(t){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?Mm=function(e){return typeof e}:Mm=function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Mm(t)}function Q2e(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}function r7(t,r){for(var e=0;e<r.length;e++){var n=r[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function eRe(t,r,e){return r&&r7(t.prototype,r),e&&r7(t,e),t}function ls(){return typeof Reflect!="undefined"&&Reflect.get?ls=Reflect.get:ls=function(r,e,n){var i=tRe(r,e);if(!!i){var o=Object.getOwnPropertyDescriptor(i,e);return o.get?o.get.call(arguments.length<3?r:n):o.value}},ls.apply(this,arguments)}function tRe(t,r){for(;!Object.prototype.hasOwnProperty.call(t,r)&&(t=Qi(t),t!==null););return t}function rRe(t,r){if(typeof r!="function"&&r!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(r&&r.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),r&&ok(t,r)}function ok(t,r){return ok=Object.setPrototypeOf||function(n,i){return n.__proto__=i,n},ok(t,r)}function nRe(t){var r=oRe();return function(){var n=Qi(t),i;if(r){var o=Qi(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return iRe(this,i)}}function iRe(t,r){if(r&&(Mm(r)==="object"||typeof r=="function"))return r;if(r!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return ak(t)}function ak(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function oRe(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Qi(t){return Qi=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},Qi(t)}var Pm="manualRowResize",aRe=30,n7="manualRowHeights",sk=new WeakMap,sRe=function(t){rRe(e,t);var r=nRe(e);function e(n){var i;Q2e(this,e),i=r.call(this,n);var o=i.hot.rootDocument;return i.currentTH=null,i.currentRow=null,i.selectedRows=[],i.currentHeight=null,i.newSize=null,i.startY=null,i.startHeight=null,i.startOffset=null,i.handle=o.createElement("DIV"),i.guide=o.createElement("DIV"),i.eventManager=new Wt(ak(i)),i.pressed=null,i.dblclick=0,i.autoresizeTimeout=null,i.rowHeightsMap=void 0,sk.set(ak(i),{config:void 0}),Ie(i.handle,"manualRowResizer"),Ie(i.guide,"manualRowResizerGuide"),i}return eRe(e,[{key:"isEnabled",value:function(){return this.hot.getSettings()[Pm]}},{key:"enablePlugin",value:function(){var i=this;this.enabled||(this.rowHeightsMap=new $o,this.rowHeightsMap.addLocalHook("init",function(){return i.onMapInit()}),this.hot.rowIndexMapper.registerMap(this.pluginName,this.rowHeightsMap),this.addHook("modifyRowHeight",function(o,a){return i.onModifyRowHeight(o,a)}),this.bindEvents(),ls(Qi(e.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),ls(Qi(e.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){var i=sk.get(this);i.config=this.rowHeightsMap.getValues(),this.hot.rowIndexMapper.unregisterMap(this.pluginName),ls(Qi(e.prototype),"disablePlugin",this).call(this)}},{key:"saveManualRowHeights",value:function(){this.hot.runHooks("persistentStateSave",n7,this.rowHeightsMap.getValues())}},{key:"loadManualRowHeights",value:function(){var i={};return this.hot.runHooks("persistentStateLoad",n7,i),i.value}},{key:"setManualSize",value:function(i,o){var a=this.hot.toPhysicalRow(i),s=Math.max(o,S3.DEFAULT_HEIGHT);return this.rowHeightsMap.setValueAtIndex(a,s),s}},{key:"setupHandlePosition",value:function(i){var o=this;this.currentTH=i;var a=this.hot.view,s=a.wt,l=a.wt.wtTable.getCoords(this.currentTH),p=l.row;if(!(p<0)){var d=sr(this.currentTH),g=this.currentTH.getBoundingClientRect(),y=p<s.getSetting("fixedRowsTop"),h=p>=a.countNotHiddenRowIndexes(0,1)-s.getSetting("fixedRowsBottom"),u;y?u=s.wtOverlays.topLeftCornerOverlay.getRelativeCellPosition(this.currentTH,l.row,l.col):h&&(u=s.wtOverlays.bottomLeftCornerOverlay.getRelativeCellPosition(this.currentTH,l.row,l.col)),u||(u=s.wtOverlays.leftOverlay.getRelativeCellPosition(this.currentTH,l.row,l.col)),this.currentRow=this.hot.rowIndexMapper.getVisualFromRenderableIndex(p),this.selectedRows=[];var f=this.hot.selection.isSelectedByCorner()||this.hot.selection.isSelectedByRowHeader();if(this.hot.selection.isSelected()&&f){var c=this.hot.getSelectedRange();he(c,function(v){var m=v.getTopLeftCorner().row,b=v.getBottomLeftCorner().row;Qe(m,b,function(w){o.selectedRows.includes(w)||o.selectedRows.push(w)})})}this.selectedRows.includes(this.currentRow)||(this.selectedRows=[this.currentRow]),this.startOffset=u.top-6,this.startHeight=parseInt(g.height,10),this.handle.style.top="".concat(this.startOffset+this.startHeight,"px"),this.handle.style.left="".concat(u.left,"px"),this.handle.style.width="".concat(d,"px"),this.hot.rootElement.appendChild(this.handle)}}},{key:"refreshHandlePosition",value:function(){this.handle.style.top="".concat(this.startOffset+this.currentHeight,"px")}},{key:"setupGuidePosition",value:function(){var i=parseInt(sr(this.handle),10),o=parseInt(this.handle.style.left,10)+i,a=parseInt(this.hot.view.maximumVisibleElementWidth(0),10);Ie(this.handle,"active"),Ie(this.guide,"active"),this.guide.style.top=this.handle.style.top,this.guide.style.left="".concat(o,"px"),this.guide.style.width="".concat(a-i,"px"),this.hot.rootElement.appendChild(this.guide)}},{key:"refreshGuidePosition",value:function(){this.guide.style.top=this.handle.style.top}},{key:"hideHandleAndGuide",value:function(){dt(this.handle,"active"),dt(this.guide,"active")}},{key:"checkIfRowHeader",value:function(i){var o,a,s=Ti(i,["TH"],this.hot.rootElement);return s&&((o=i.parentNode)===null||o===void 0||(a=o.parentNode)===null||a===void 0?void 0:a.tagName)==="TBODY"}},{key:"getClosestTHParent",value:function(i){return i.tagName!=="TABLE"?i.tagName==="TH"?i:this.getClosestTHParent(i.parentNode):null}},{key:"getActualRowHeight",value:function(i){var o=this.hot.view.wt.wtTable.getRowHeight(i);return o!==void 0&&this.newSize<o?o:this.newSize}},{key:"onMouseOver",value:function(i){if(!x0(i.target)&&this.checkIfRowHeader(i.target)){var o=this.getClosestTHParent(i.target);o&&(this.pressed||this.setupHandlePosition(o))}}},{key:"afterMouseDownTimeout",value:function(){var i=this,o=function(){i.hot.forceFullRender=!0,i.hot.view.render(),i.hot.view.adjustElementsSize(!0)},a=function(p,d){var g=i.hot.runHooks("beforeRowResize",i.getActualRowHeight(p),p,!0);g!==void 0&&(i.newSize=g),i.setManualSize(p,i.newSize),i.hot.runHooks("afterRowResize",i.getActualRowHeight(p),p,!0),d&&o()};if(this.dblclick>=2){var s=this.selectedRows.length;s>1?(he(this.selectedRows,function(l){a(l)}),o()):he(this.selectedRows,function(l){a(l,!0)})}this.dblclick=0,this.autoresizeTimeout=null}},{key:"onMouseDown",value:function(i){var o=this;lt(i.target,"manualRowResizer")&&(this.setupHandlePosition(this.currentTH),this.setupGuidePosition(),this.pressed=!0,this.autoresizeTimeout===null&&(this.autoresizeTimeout=setTimeout(function(){return o.afterMouseDownTimeout()},500),this.hot._registerTimeout(this.autoresizeTimeout)),this.dblclick+=1,this.startY=i.pageY,this.newSize=this.startHeight)}},{key:"onMouseMove",value:function(i){var o=this;this.pressed&&(this.currentHeight=this.startHeight+(i.pageY-this.startY),he(this.selectedRows,function(a){o.newSize=o.setManualSize(a,o.currentHeight)}),this.refreshHandlePosition(),this.refreshGuidePosition())}},{key:"onMouseUp",value:function(){var i=this,o=function(){i.hot.forceFullRender=!0,i.hot.view.render(),i.hot.view.adjustElementsSize(!0)},a=function(p,d){i.hot.runHooks("beforeRowResize",i.getActualRowHeight(p),p,!1),d&&o(),i.saveManualRowHeights(),i.hot.runHooks("afterRowResize",i.getActualRowHeight(p),p,!1)};if(this.pressed){if(this.hideHandleAndGuide(),this.pressed=!1,this.newSize!==this.startHeight){var s=this.selectedRows.length;s>1?(he(this.selectedRows,function(l){a(l)}),o()):he(this.selectedRows,function(l){a(l,!0)})}this.setupHandlePosition(this.currentTH)}}},{key:"bindEvents",value:function(){var i=this,o=this.hot,a=o.rootElement,s=o.rootWindow;this.eventManager.addEventListener(a,"mouseover",function(l){return i.onMouseOver(l)}),this.eventManager.addEventListener(a,"mousedown",function(l){return i.onMouseDown(l)}),this.eventManager.addEventListener(s,"mousemove",function(l){return i.onMouseMove(l)}),this.eventManager.addEventListener(s,"mouseup",function(){return i.onMouseUp()})}},{key:"onModifyRowHeight",value:function(i,o){var a=i;if(this.enabled){var s=this.hot.toPhysicalRow(o),l=this.rowHeightsMap.getValueAtIndex(s);this.hot.getSettings()[Pm]&&l&&(a=l)}return a}},{key:"onMapInit",value:function(){var i=this,o=sk.get(this),a=this.hot.getSettings()[Pm],s=this.loadManualRowHeights();this.hot.batchExecution(function(){typeof s!="undefined"?s.forEach(function(l,p){i.rowHeightsMap.setValueAtIndex(p,l)}):Array.isArray(a)?(a.forEach(function(l,p){i.rowHeightsMap.setValueAtIndex(p,l)}),o.config=a):a===!0&&Array.isArray(o.config)&&o.config.forEach(function(l,p){i.rowHeightsMap.setValueAtIndex(p,l)})},!0)}},{key:"destroy",value:function(){ls(Qi(e.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return Pm}},{key:"PLUGIN_PRIORITY",get:function(){return aRe}}]),e}(Lt),i7,o7,a7,s7;function Im(t,r){return r||(r=t.slice(0)),Object.freeze(Object.defineProperties(t,{raw:{value:Object.freeze(r)}}))}function uRe(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}function u7(t,r){for(var e=0;e<r.length;e++){var n=r[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function lRe(t,r,e){return r&&u7(t.prototype,r),e&&u7(t,e),t}var fRe=function(){function t(r,e,n,i){uRe(this,t),this.row=r,this.col=e,this.rowspan=n,this.colspan=i,this.removed=!1}return lRe(t,[{key:"normalize",value:function(e){var n=e.countRows(),i=e.countCols();this.row<0?this.row=0:this.row>n-1&&(this.row=n-1),this.col<0?this.col=0:this.col>i-1&&(this.col=i-1),this.row+this.rowspan>n-1&&(this.rowspan=n-this.row),this.col+this.colspan>i-1&&(this.colspan=i-this.col)}},{key:"includes",value:function(e,n){return this.row<=e&&this.col<=n&&this.row+this.rowspan-1>=e&&this.col+this.colspan-1>=n}},{key:"includesHorizontally",value:function(e){return this.col<=e&&this.col+this.colspan-1>=e}},{key:"includesVertically",value:function(e){return this.row<=e&&this.row+this.rowspan-1>=e}},{key:"shift",value:function(e,n){var i=e[0]||e[1],o=n+Math.abs(e[0]||e[1])-1,a=e[0]?"colspan":"rowspan",s=e[0]?"col":"row",l=Math.min(n,o),p=Math.max(n,o),d=this[s],g=this[s]+this[a]-1;if(d>=n&&(this[s]+=i),i>0)n<=g&&n>d&&(this[a]+=i);else if(i<0){if(l<=d&&p>=g)return this.removed=!0,!1;if(d>=l&&d<=p){var y=p-d+1,h=Math.abs(i)-y;this[s]-=h+i,this[a]-=y}else if(d<=l&&g>=p)this[a]+=i;else if(d<=l&&g>=l&&g<p){var u=g-l+1;this[a]-=u}}return!0}},{key:"isFarther",value:function(e,n){return e?n==="down"?e.row+e.rowspan-1<this.row+this.rowspan-1:n==="up"?e.row>this.row:n==="right"?e.col+e.colspan-1<this.col+this.colspan-1:n==="left"?e.col>this.col:null:!0}},{key:"getLastRow",value:function(){return this.row+this.rowspan-1}},{key:"getLastColumn",value:function(){return this.col+this.colspan-1}},{key:"getRange",value:function(){return new Rr(new ke(this.row,this.col),new ke(this.row,this.col),new ke(this.getLastRow(),this.getLastColumn()))}}],[{key:"NEGATIVE_VALUES_WARNING",value:function(e){return Kt(i7||(i7=Im(["The merged cell declared with {row: ",", col: ",`, 
      rowspan: `,", colspan: ",`} contains negative values, which is 
      not supported. It will not be added to the collection.`],["The merged cell declared with {row: ",", col: ",`,\\x20
      rowspan: `,", colspan: ",`} contains negative values, which is\\x20
      not supported. It will not be added to the collection.`])),e.row,e.col,e.rowspan,e.colspan)}},{key:"IS_OUT_OF_BOUNDS_WARNING",value:function(e){return Kt(o7||(o7=Im(["The merged cell declared at [",", ",`] is positioned 
      (or positioned partially) outside of the table range. It was not added to the table, please fix your setup.`],["The merged cell declared at [",", ",`] is positioned\\x20
      (or positioned partially) outside of the table range. It was not added to the table, please fix your setup.`])),e.row,e.col)}},{key:"IS_SINGLE_CELL",value:function(e){return Kt(a7||(a7=Im(["The merged cell declared at [",", ",`] has both "rowspan" 
      and "colspan" declared as "1", which makes it a single cell. It cannot be added to the collection.`],["The merged cell declared at [",", ",`] has both "rowspan"\\x20
      and "colspan" declared as "1", which makes it a single cell. It cannot be added to the collection.`])),e.row,e.col)}},{key:"ZERO_SPAN_WARNING",value:function(e){return Kt(s7||(s7=Im(["The merged cell declared at [",", ",`] has "rowspan" 
      or "colspan" declared as "0", which is not supported. It cannot be added to the collection.`],["The merged cell declared at [",", ",`] has "rowspan"\\x20
      or "colspan" declared as "0", which is not supported. It cannot be added to the collection.`])),e.row,e.col)}},{key:"containsNegativeValues",value:function(e){return e.row<0||e.col<0||e.rowspan<0||e.colspan<0}},{key:"isSingleCell",value:function(e){return e.colspan===1&&e.rowspan===1}},{key:"containsZeroSpan",value:function(e){return e.colspan===0||e.rowspan===0}},{key:"isOutOfBounds",value:function(e,n,i){return e.row<0||e.col<0||e.row>=n||e.row+e.rowspan-1>=n||e.col>=i||e.col+e.colspan-1>=i}}]),t}(),hi=fRe;function uk(t,r,e,n){r?r.row===e&&r.col===n?(t.setAttribute("rowspan",r.rowspan.toString()),t.setAttribute("colspan",r.colspan.toString())):(t.removeAttribute("rowspan"),t.removeAttribute("colspan"),t.style.display="none"):(t.removeAttribute("rowspan"),t.removeAttribute("colspan"),t.style.display="")}var l7;function cRe(t,r){return r||(r=t.slice(0)),Object.freeze(Object.defineProperties(t,{raw:{value:Object.freeze(r)}}))}function f7(t){return yRe(t)||pRe(t)||dRe(t)||hRe()}function hRe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function dRe(t,r){if(!!t){if(typeof t=="string")return lk(t,r);var e=Object.prototype.toString.call(t).slice(8,-1);if(e==="Object"&&t.constructor&&(e=t.constructor.name),e==="Map"||e==="Set")return Array.from(t);if(e==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return lk(t,r)}}function pRe(t){if(typeof Symbol!="undefined"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function yRe(t){if(Array.isArray(t))return lk(t)}function lk(t,r){(r==null||r>t.length)&&(r=t.length);for(var e=0,n=new Array(r);e<r;e++)n[e]=t[e];return n}function mRe(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}function c7(t,r){for(var e=0;e<r.length;e++){var n=r[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function vRe(t,r,e){return r&&c7(t.prototype,r),e&&c7(t,e),t}var gRe=function(){function t(r){mRe(this,t),this.plugin=r,this.mergedCells=[],this.hot=r.hot}return vRe(t,[{key:"get",value:function(e,n){var i=this.mergedCells,o=!1;return he(i,function(a){return a.row<=e&&a.row+a.rowspan-1>=e&&a.col<=n&&a.col+a.colspan-1>=n?(o=a,!1):!0}),o}},{key:"getByRange",value:function(e){var n=this.mergedCells,i=!1;return he(n,function(o){return o.row<=e.from.row&&o.row+o.rowspan-1>=e.to.row&&o.col<=e.from.col&&o.col+o.colspan-1>=e.to.col?(i=o,i):!0}),i}},{key:"getWithinRange",value:function(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,i=this.mergedCells,o=[],a=e;if(!a.includesRange){var s=new ke(a.from.row,a.from.col),l=new ke(a.to.row,a.to.col);a=new Rr(s,s,l)}return he(i,function(p){var d=new ke(p.row,p.col),g=new ke(p.row+p.rowspan-1,p.col+p.colspan-1),y=new Rr(d,d,g);n?a.overlaps(y)&&o.push(p):a.includesRange(y)&&o.push(p)}),o.length?o:!1}},{key:"add",value:function(e){var n=this.mergedCells,i=e.row,o=e.col,a=e.rowspan,s=e.colspan,l=new hi(i,o,a,s),p=this.get(i,o),d=this.isOverlapping(l);return!p&&!d?(this.hot&&l.normalize(this.hot),n.push(l),l):(tr(t.IS_OVERLAPPING_WARNING(l)),!1)}},{key:"remove",value:function(e,n){var i=this.mergedCells,o=this.get(e,n),a=o?this.mergedCells.indexOf(o):-1;return o&&a!==-1?(i.splice(a,1),o):!1}},{key:"clear",value:function(){var e=this,n=this.mergedCells,i=[],o=[];he(n,function(a){var s=e.hot.getCell(a.row,a.col);s&&i.push([s,e.get(a.row,a.col),a.row,a.col])}),this.mergedCells.length=0,he(i,function(a,s){Qe(0,a.rowspan-1,function(l){Qe(0,a.colspan-1,function(p){if(p!==0||l!==0){var d=e.hot.getCell(a.row+l,a.col+p);d&&o.push([d,null,null,null])}})}),i[s][1]=null}),he(i,function(a){uk.apply(void 0,f7(a))}),he(o,function(a){uk.apply(void 0,f7(a))})}},{key:"isOverlapping",value:function(e){var n=new Rr(new ke(0,0),new ke(e.row,e.col),new ke(e.row+e.rowspan-1,e.col+e.colspan-1)),i=!1;return he(this.mergedCells,function(o){var a=new Rr(new ke(0,0),new ke(o.row,o.col),new ke(o.row+o.rowspan-1,o.col+o.colspan-1));return a.overlaps(n)?(i=!0,!1):!0}),i}},{key:"isFirstRenderableMergedCell",value:function(e,n){var i=this.get(e,n);return i&&this.hot.rowIndexMapper.getFirstNotHiddenIndex(i.row,1)===e&&this.hot.columnIndexMapper.getFirstNotHiddenIndex(i.col,1)===n}},{key:"getFirstRenderableCoords",value:function(e,n){var i=this.get(e,n);if(!i||this.isFirstRenderableMergedCell(e,n))return new ke(e,n);var o=this.hot.rowIndexMapper.getFirstNotHiddenIndex(i.row,1),a=this.hot.columnIndexMapper.getFirstNotHiddenIndex(i.col,1);return new ke(o,a)}},{key:"shiftCollections",value:function(e,n,i){var o=this,a=[0,0];switch(e){case"right":a[0]+=i;break;case"left":a[0]-=i;break;case"down":a[1]+=i;break;case"up":a[1]-=i;break}he(this.mergedCells,function(s){s.shift(a,n)}),Jd(this.mergedCells.length-1,0,function(s){var l=o.mergedCells[s];l&&l.removed&&o.mergedCells.splice(o.mergedCells.indexOf(l),1)})}}],[{key:"IS_OVERLAPPING_WARNING",value:function(e){return Kt(l7||(l7=cRe(["The merged cell declared at [",", ",`], overlaps 
      with the other declared merged cell. The overlapping merged cell was not added to the table, please 
      fix your setup.`],["The merged cell declared at [",", ",`], overlaps\\x20
      with the other declared merged cell. The overlapping merged cell was not added to the table, please\\x20
      fix your setup.`])),e.row,e.col)}}]),t}(),bRe=gRe;function fs(t,r){return CRe(t)||SRe(t,r)||_Re(t,r)||wRe()}function wRe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function _Re(t,r){if(!!t){if(typeof t=="string")return h7(t,r);var e=Object.prototype.toString.call(t).slice(8,-1);if(e==="Object"&&t.constructor&&(e=t.constructor.name),e==="Map"||e==="Set")return Array.from(t);if(e==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return h7(t,r)}}function h7(t,r){(r==null||r>t.length)&&(r=t.length);for(var e=0,n=new Array(r);e<r;e++)n[e]=t[e];return n}function SRe(t,r){var e=t==null?null:typeof Symbol!="undefined"&&t[Symbol.iterator]||t["@@iterator"];if(e!=null){var n=[],i=!0,o=!1,a,s;try{for(e=e.call(t);!(i=(a=e.next()).done)&&(n.push(a.value),!(r&&n.length===r));i=!0);}catch(l){o=!0,s=l}finally{try{!i&&e.return!=null&&e.return()}finally{if(o)throw s}}return n}}function CRe(t){if(Array.isArray(t))return t}function kRe(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}function d7(t,r){for(var e=0;e<r.length;e++){var n=r[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function ORe(t,r,e){return r&&d7(t.prototype,r),e&&d7(t,e),t}var RRe=function(){function t(r){kRe(this,t),this.plugin=r,this.mergedCellsCollection=this.plugin.mergedCellsCollection,this.currentFillData=null}return ORe(t,[{key:"correctSelectionAreaSize",value:function(e){if(e[0]===e[2]&&e[1]===e[3]){var n=this.mergedCellsCollection.get(e[0],e[1]);n&&(e[2]=e[0]+n.rowspan-1,e[3]=e[1]+n.colspan-1)}}},{key:"getDirection",value:function(e,n){var i=null;return n[0]===e[0]&&n[1]===e[1]&&n[3]===e[3]?i="down":n[2]===e[2]&&n[1]===e[1]&&n[3]===e[3]?i="up":n[1]===e[1]&&n[2]===e[2]?i="right":i="left",i}},{key:"snapDragArea",value:function(e,n,i,o){var a=n.slice(0),s=this.getAutofillSize(e,n,i),l=fs(e,4),p=l[0],d=l[1],g=l[2],y=l[3],h=["up","down"].indexOf(i)>-1,u=h?g-p+1:y-d+1,f=Math.floor(s/u)*u,c=s-f,v=this.getFarthestCollection(e,n,i,o);if(v){if(i==="down"){var m=v.row+v.rowspan-p-c,b=a[2]+m;b>=this.plugin.hot.countRows()?a[2]-=c:a[2]+=c?m:0}else if(i==="right"){var w=v.col+v.colspan-d-c,_=a[3]+w;_>=this.plugin.hot.countCols()?a[3]-=c:a[3]+=c?w:0}else if(i==="up"){var C=g-c-v.row+1,R=a[0]+C;R<0?a[0]+=c:a[0]-=c?C:0}else if(i==="left"){var I=y-c-v.col+1,P=a[1]+I;P<0?a[1]+=c:a[1]-=c?I:0}}return this.updateCurrentFillCache({baseArea:e,dragDirection:i,foundMergedCells:o,fillSize:s,dragArea:a,cycleLength:u}),a}},{key:"updateCurrentFillCache",value:function(e){this.currentFillData||(this.currentFillData={}),or(this.currentFillData,e)}},{key:"getAutofillSize",value:function(e,n,i){var o=fs(e,4),a=o[0],s=o[1],l=o[2],p=o[3],d=fs(n,4),g=d[0],y=d[1],h=d[2],u=d[3];switch(i){case"up":return a-g;case"down":return h-l;case"left":return s-y;case"right":return u-p;default:return null}}},{key:"getDragArea",value:function(e,n,i){var o=fs(e,4),a=o[0],s=o[1],l=o[2],p=o[3],d=fs(n,4),g=d[0],y=d[1],h=d[2],u=d[3];switch(i){case"up":return[g,y,a-1,p];case"down":return[l+1,s,h,p];case"left":return[g,y,l,s-1];case"right":return[a,p+1,h,u];default:return null}}},{key:"getFarthestCollection",value:function(e,n,i,o){var a=fs(e,4),s=a[0],l=a[1],p=a[2],d=a[3],g=["up","down"].indexOf(i)>-1,y=g?p:d,h=g?s:l,u=this.getAutofillSize(e,n,i),f=g?p-s+1:d-l+1,c=Math.floor(u/f)*f,v=u-c,m=null,b=null,w=null;switch(i){case"up":m="includesVertically",w=y-v+1;break;case"left":m="includesHorizontally",w=y-v+1;break;case"down":m="includesVertically",w=h+v-1;break;case"right":m="includesHorizontally",w=h+v-1;break}return he(o,function(_){_[m](w)&&_.isFarther(b,i)&&(b=_)}),b}},{key:"recreateAfterDataPopulation",value:function(e){if(!!this.currentFillData){var n=this.getRangeFromChanges(e),i=this.currentFillData.foundMergedCells,o=this.currentFillData.dragDirection,a=function(y,h){switch(o){case"up":return y.row-h>=n.from.row;case"down":return y.row+y.rowspan-1+h<=n.to.row;case"left":return y.col-h>=n.from.column;case"right":return y.col+y.colspan-1+h<=n.to.column;default:return null}},s=0,l=null,p=1;do for(var d=0;d<i.length;d+=1){if(l=i[d],s=p*this.currentFillData.cycleLength,a(l,s))switch(o){case"up":this.plugin.mergedCellsCollection.add({row:l.row-s,rowspan:l.rowspan,col:l.col,colspan:l.colspan});break;case"down":this.plugin.mergedCellsCollection.add({row:l.row+s,rowspan:l.rowspan,col:l.col,colspan:l.colspan});break;case"left":this.plugin.mergedCellsCollection.add({row:l.row,rowspan:l.rowspan,col:l.col-s,colspan:l.colspan});break;case"right":this.plugin.mergedCellsCollection.add({row:l.row,rowspan:l.rowspan,col:l.col+s,colspan:l.colspan});break}d===i.length-1&&(p+=1)}while(a(l,s));this.currentFillData=null,this.plugin.hot.render()}}},{key:"getRangeFromChanges",value:function(e){var n=this,i={min:null,max:null},o={min:null,max:null};return he(e,function(a){var s=a[0],l=n.plugin.hot.propToCol(a[1]);(i.min===null||s<i.min)&&(i.min=s),(i.max===null||s>i.max)&&(i.max=s),(o.min===null||l<o.min)&&(o.min=l),(o.max===null||l>o.max)&&(o.max=l)}),{from:{row:i.min,column:o.min},to:{row:i.max,column:o.max}}}},{key:"dragAreaOverlapsCollections",value:function(e,n,i){var o=this.getDragArea(e,n,i),a=fs(o,4),s=a[0],l=a[1],p=a[2],d=a[3],g=new ke(s,l),y=new ke(p,d),h=new Rr(g,g,y);return!!this.mergedCellsCollection.getWithinRange(h,!0)}}]),t}(),ERe=RRe;function TRe(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}function p7(t,r){for(var e=0;e<r.length;e++){var n=r[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function xRe(t,r,e){return r&&p7(t.prototype,r),e&&p7(t,e),t}var ARe=function(){function t(r){TRe(this,t),this.plugin=r,this.fullySelectedMergedCellClassName="fullySelectedMergedCell"}return xRe(t,[{key:"snapDelta",value:function(e,n,i){var o=n.to,a=o.row+e.row,s=o.col+e.col;e.row?this.jumpOverMergedCell(e,i,a):e.col&&this.jumpOverMergedCell(e,i,s)}},{key:"jumpOverMergedCell",value:function(e,n,i){var o=e.row||e.col,a=null,s=null,l=null;e.row?(a=n.includesVertically(i),s=n.row,l=n.getLastRow()):e.col&&(a=n.includesHorizontally(i),s=n.col,l=n.getLastColumn()),o!==0&&(o>0?a&&i!==s&&(o+=l-i+1):a&&i!==l&&(o-=i-s+1),e.row?e.row=o:e.col&&(e.col=o))}},{key:"getUpdatedSelectionRange",value:function(e,n){return new Rr(e.highlight,e.from,new ke(e.to.row+n.row,e.to.col+n.col))}},{key:"getSelectedMergedCellClassName",value:function(e,n,i,o){var a=Math.min(i[0],i[2]),s=Math.min(i[1],i[3]),l=Math.max(i[0],i[2]),p=Math.max(i[1],i[3]);if(o!==void 0){var d=this.plugin.mergedCellsCollection.isFirstRenderableMergedCell(e,n);if(!!d){var g=this.plugin.mergedCellsCollection.get(e,n);if(!!g){var y=g.getLastRow(),h=g.getLastColumn(),u=a<=g.row&&s<=g.col&&l>=y&&p>=h;if(u)return"".concat(this.fullySelectedMergedCellClassName,"-").concat(o);if(this.plugin.selectionCalculations.isMergeCellFullySelected(g,this.plugin.hot.getSelectedRange()))return"".concat(this.fullySelectedMergedCellClassName,"-multiple")}}}}},{key:"isMergeCellFullySelected",value:function(e,n){var i=[];if(!n||!e)return!1;for(var o=0;o<e.rowspan;o+=1)for(var a=0;a<e.colspan;a+=1)i.push(new ke(e.row+o,e.col+a));for(var s=0;s<i.length;s+=1){for(var l=[],p=0;p<n.length;p+=1)l[p]=n[p].includes(i[s]);if(!l.includes(!0))return!1}return!0}},{key:"getSelectedMergedCellClassNameToRemove",value:function(){for(var e=[],n=0;n<=7;n+=1)e.push("".concat(this.fullySelectedMergedCellClassName,"-").concat(n));return e.push("".concat(this.fullySelectedMergedCellClassName,"-multiple")),e}}]),t}(),MRe=ARe;function PRe(t){return{key:"mergeCells",name:function(){var e=this.getSelectedLast();if(e){var n=t.mergedCellsCollection.get(e[0],e[1]);if(n.row===e[0]&&n.col===e[1]&&n.row+n.rowspan-1===e[2]&&n.col+n.colspan-1===e[3])return this.getTranslatedPhrase(E1)}return this.getTranslatedPhrase(R1)},callback:function(){t.toggleMergeOnSelection()},disabled:function(){var e=this.getSelectedLast();if(!e)return!0;var n=hi.isSingleCell({row:e[0],col:e[1],rowspan:e[2]-e[0]+1,colspan:e[3]-e[1]+1});return n||this.selection.isSelectedByCorner()},hidden:!1}}function Dm(t){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?Dm=function(e){return typeof e}:Dm=function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Dm(t)}function y7(t,r){return NRe(t)||DRe(t,r)||v7(t,r)||IRe()}function IRe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function DRe(t,r){var e=t==null?null:typeof Symbol!="undefined"&&t[Symbol.iterator]||t["@@iterator"];if(e!=null){var n=[],i=!0,o=!1,a,s;try{for(e=e.call(t);!(i=(a=e.next()).done)&&(n.push(a.value),!(r&&n.length===r));i=!0);}catch(l){o=!0,s=l}finally{try{!i&&e.return!=null&&e.return()}finally{if(o)throw s}}return n}}function NRe(t){if(Array.isArray(t))return t}function m7(t){return LRe(t)||jRe(t)||v7(t)||$Re()}function $Re(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function v7(t,r){if(!!t){if(typeof t=="string")return fk(t,r);var e=Object.prototype.toString.call(t).slice(8,-1);if(e==="Object"&&t.constructor&&(e=t.constructor.name),e==="Map"||e==="Set")return Array.from(t);if(e==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return fk(t,r)}}function jRe(t){if(typeof Symbol!="undefined"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function LRe(t){if(Array.isArray(t))return fk(t)}function fk(t,r){(r==null||r>t.length)&&(r=t.length);for(var e=0,n=new Array(r);e<r;e++)n[e]=t[e];return n}function HRe(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}function g7(t,r){for(var e=0;e<r.length;e++){var n=r[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function FRe(t,r,e){return r&&g7(t.prototype,r),e&&g7(t,e),t}function Ju(){return typeof Reflect!="undefined"&&Reflect.get?Ju=Reflect.get:Ju=function(r,e,n){var i=BRe(r,e);if(!!i){var o=Object.getOwnPropertyDescriptor(i,e);return o.get?o.get.call(arguments.length<3?r:n):o.value}},Ju.apply(this,arguments)}function BRe(t,r){for(;!Object.prototype.hasOwnProperty.call(t,r)&&(t=ea(t),t!==null););return t}function VRe(t,r){if(typeof r!="function"&&r!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(r&&r.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),r&&ck(t,r)}function ck(t,r){return ck=Object.setPrototypeOf||function(n,i){return n.__proto__=i,n},ck(t,r)}function WRe(t){var r=zRe();return function(){var n=ea(t),i;if(r){var o=ea(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return URe(this,i)}}function URe(t,r){if(r&&(Dm(r)==="object"||typeof r=="function"))return r;if(r!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return b7(t)}function b7(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function zRe(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function ea(t){return ea=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},ea(t)}Ze.getSingleton().register("beforeMergeCells");Ze.getSingleton().register("afterMergeCells");Ze.getSingleton().register("beforeUnmergeCells");Ze.getSingleton().register("afterUnmergeCells");var Nm="mergeCells",YRe=150,w7=new WeakMap,GRe=function(t){VRe(e,t);var r=WRe(e);function e(n){var i;return HRe(this,e),i=r.call(this,n),w7.set(b7(i),{lastDesiredCoords:null}),i.mergedCellsCollection=null,i.autofillCalculations=null,i.selectionCalculations=null,i}return FRe(e,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[Nm]}},{key:"enablePlugin",value:function(){var i=this;this.enabled||(this.mergedCellsCollection=new bRe(this),this.autofillCalculations=new ERe(this),this.selectionCalculations=new MRe(this),this.addHook("afterInit",function(){return i.onAfterInit.apply(i,arguments)}),this.addHook("beforeKeyDown",function(){return i.onBeforeKeyDown.apply(i,arguments)}),this.addHook("modifyTransformStart",function(){return i.onModifyTransformStart.apply(i,arguments)}),this.addHook("afterModifyTransformStart",function(){return i.onAfterModifyTransformStart.apply(i,arguments)}),this.addHook("modifyTransformEnd",function(){return i.onModifyTransformEnd.apply(i,arguments)}),this.addHook("modifyGetCellCoords",function(){return i.onModifyGetCellCoords.apply(i,arguments)}),this.addHook("beforeSetRangeStart",function(){return i.onBeforeSetRangeStart.apply(i,arguments)}),this.addHook("beforeSetRangeStartOnly",function(){return i.onBeforeSetRangeStart.apply(i,arguments)}),this.addHook("beforeSetRangeEnd",function(){return i.onBeforeSetRangeEnd.apply(i,arguments)}),this.addHook("afterIsMultipleSelection",function(){return i.onAfterIsMultipleSelection.apply(i,arguments)}),this.addHook("afterRenderer",function(){return i.onAfterRenderer.apply(i,arguments)}),this.addHook("afterContextMenuDefaultOptions",function(){return i.addMergeActionsToContextMenu.apply(i,arguments)}),this.addHook("afterGetCellMeta",function(){return i.onAfterGetCellMeta.apply(i,arguments)}),this.addHook("afterViewportRowCalculatorOverride",function(){return i.onAfterViewportRowCalculatorOverride.apply(i,arguments)}),this.addHook("afterViewportColumnCalculatorOverride",function(){return i.onAfterViewportColumnCalculatorOverride.apply(i,arguments)}),this.addHook("modifyAutofillRange",function(){return i.onModifyAutofillRange.apply(i,arguments)}),this.addHook("afterCreateCol",function(){return i.onAfterCreateCol.apply(i,arguments)}),this.addHook("afterRemoveCol",function(){return i.onAfterRemoveCol.apply(i,arguments)}),this.addHook("afterCreateRow",function(){return i.onAfterCreateRow.apply(i,arguments)}),this.addHook("afterRemoveRow",function(){return i.onAfterRemoveRow.apply(i,arguments)}),this.addHook("afterChange",function(){return i.onAfterChange.apply(i,arguments)}),this.addHook("beforeDrawBorders",function(){return i.onBeforeDrawAreaBorders.apply(i,arguments)}),this.addHook("afterDrawSelection",function(){return i.onAfterDrawSelection.apply(i,arguments)}),this.addHook("beforeRemoveCellClassNames",function(){return i.onBeforeRemoveCellClassNames.apply(i,arguments)}),this.addHook("beforeUndoStackChange",function(o,a){if(a==="MergeCells")return!1}),Ju(ea(e.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){this.clearCollections(),this.hot.render(),Ju(ea(e.prototype),"disablePlugin",this).call(this)}},{key:"updatePlugin",value:function(){var i=this.hot.getSettings()[Nm];this.disablePlugin(),this.enablePlugin(),this.generateFromSettings(i),Ju(ea(e.prototype),"updatePlugin",this).call(this)}},{key:"validateSetting",value:function(i){var o=!0;return i?(hi.containsNegativeValues(i)?(tr(hi.NEGATIVE_VALUES_WARNING(i)),o=!1):hi.isOutOfBounds(i,this.hot.countRows(),this.hot.countCols())?(tr(hi.IS_OUT_OF_BOUNDS_WARNING(i)),o=!1):hi.isSingleCell(i)?(tr(hi.IS_SINGLE_CELL(i)),o=!1):hi.containsZeroSpan(i)&&(tr(hi.ZERO_SPAN_WARNING(i)),o=!1),o):!1}},{key:"generateFromSettings",value:function(i){var o=this;if(Array.isArray(i)){var a,s=[];he(i,function(p){if(!!o.validateSetting(p)){var d=new ke(p.row,p.col),g=new ke(p.row+p.rowspan-1,p.col+p.colspan-1),y=new Rr(d,d,g);s.push(o.mergeRange(y,!0,!0))}}),s=s.filter(function(p){return p!==!0});var l=this.getBulkCollectionData(s);(a=this.hot).populateFromArray.apply(a,m7(l))}}},{key:"getBulkCollectionData",value:function(i){var o,a=this.getBulkCollectionDataRange(i),s=(o=this.hot).getData.apply(o,m7(a)),l=s.splice(0);return he(i,function(p){var d=y7(p,3),g=d[0],y=d[1],h=d[2];he(h,function(u,f){he(u,function(c,v){l[g-a[0]+f][y-a[1]+v]=c})})}),[a[0],a[1],l]}},{key:"getBulkCollectionDataRange",value:function(i){var o=[0,0],a=[0,0],s=null,l=null,p=null;return he(i,function(d){s=d[0],l=d[1],p=d[2],o[0]=Math.min(s,o[0]),o[1]=Math.min(l,o[1]),a[0]=Math.max(s+p.length-1,a[0]),a[1]=Math.max(l+p[0].length-1,a[1])}),[].concat(o,a)}},{key:"clearCollections",value:function(){this.mergedCellsCollection.clear()}},{key:"canMergeRange",value:function(i){var o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return o?!0:this.validateSetting(i)}},{key:"toggleMergeOnSelection",value:function(){var i=this.hot.getSelectedRangeLast();if(!!i){i.setDirection("NW-SE");var o=i.from,a=i.to;this.toggleMerge(i),this.hot.selectCell(o.row,o.col,a.row,a.col,!1)}}},{key:"mergeSelection",value:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.hot.getSelectedRangeLast();if(!!i){i.setDirection("NW-SE");var o=i.from,a=i.to;this.unmergeRange(i,!0),this.mergeRange(i),this.hot.selectCell(o.row,o.col,a.row,a.col,!1)}}},{key:"unmergeSelection",value:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.hot.getSelectedRangeLast();if(!!i){var o=i.from,a=i.to;this.unmergeRange(i,!0),this.hot.selectCell(o.row,o.col,a.row,a.col,!1)}}},{key:"mergeRange",value:function(i){var o=this,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,l=i.getTopLeftCorner(),p=i.getBottomRightCorner(),d={row:l.row,col:l.col,rowspan:p.row-l.row+1,colspan:p.col-l.col+1},g=[],y=null;if(!this.canMergeRange(d,a))return!1;this.hot.runHooks("beforeMergeCells",i,a),Qe(0,d.rowspan-1,function(u){Qe(0,d.colspan-1,function(f){var c=null;g[u]||(g[u]=[]),u===0&&f===0?c=o.hot.getDataAtCell(d.row,d.col):o.hot.setCellMeta(d.row+u,d.col+f,"hidden",!0),g[u][f]=c})}),this.hot.setCellMeta(d.row,d.col,"spanned",!0);var h=this.mergedCellsCollection.add(d);return h?(s?y=[d.row,d.col,g]:this.hot.populateFromArray(d.row,d.col,g,void 0,void 0,this.pluginName),this.hot.runHooks("afterMergeCells",i,d,a),y):!0}},{key:"unmergeRange",value:function(i){var o=this,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,s=this.mergedCellsCollection.getWithinRange(i);!s||(this.hot.runHooks("beforeUnmergeCells",i,a),he(s,function(l){o.mergedCellsCollection.remove(l.row,l.col),Qe(0,l.rowspan-1,function(p){Qe(0,l.colspan-1,function(d){o.hot.removeCellMeta(l.row+p,l.col+d,"hidden")})}),o.hot.removeCellMeta(l.row,l.col,"spanned")}),this.hot.runHooks("afterUnmergeCells",i,a),this.hot.render())}},{key:"toggleMerge",value:function(i){var o=this.mergedCellsCollection.get(i.from.row,i.from.col),a=o.row===i.from.row&&o.col===i.from.col&&o.row+o.rowspan-1===i.to.row&&o.col+o.colspan-1===i.to.col;a?this.unmergeRange(i):this.mergeSelection(i)}},{key:"merge",value:function(i,o,a,s){var l=new ke(i,o),p=new ke(a,s);this.mergeRange(new Rr(l,l,p))}},{key:"unmerge",value:function(i,o,a,s){var l=new ke(i,o),p=new ke(a,s);this.unmergeRange(new Rr(l,l,p))}},{key:"onAfterInit",value:function(){this.generateFromSettings(this.hot.getSettings()[Nm]),this.hot.render()}},{key:"onBeforeKeyDown",value:function(i){var o=(i.ctrlKey||i.metaKey)&&!i.altKey;o&&i.keyCode===77&&(this.toggleMerge(this.hot.getSelectedRangeLast()),this.hot.render(),rr(i))}},{key:"onAfterIsMultipleSelection",value:function(i){if(i){for(var o=this.mergedCellsCollection.mergedCells,a=this.hot.getSelectedRangeLast(),s=0;s<o.length;s+=1)if(a.from.row===o[s].row&&a.from.col===o[s].col&&a.to.row===o[s].row+o[s].rowspan-1&&a.to.col===o[s].col+o[s].colspan-1)return!1}return i}},{key:"onModifyTransformStart",value:function(i){var o=w7.get(this),a=this.hot.getSelectedRangeLast(),s={row:i.row,col:i.col},l=null,p=new ke(a.highlight.row,a.highlight.col),d=this.mergedCellsCollection.get(p.row,p.col);if(o.lastDesiredCoords||(o.lastDesiredCoords=new ke(null,null)),d){var g=new ke(d.row,d.col),y=new ke(d.row+d.rowspan-1,d.col+d.colspan-1),h=new Rr(g,g,y);h.includes(o.lastDesiredCoords)||(o.lastDesiredCoords=new ke(null,null)),s.row=o.lastDesiredCoords.row?o.lastDesiredCoords.row-p.row:s.row,s.col=o.lastDesiredCoords.col?o.lastDesiredCoords.col-p.col:s.col,i.row>0?s.row=d.row+d.rowspan-1-p.row+i.row:i.row<0&&(s.row=p.row-d.row+i.row),i.col>0?s.col=d.col+d.colspan-1-p.col+i.col:i.col<0&&(s.col=p.col-d.col+i.col)}l=new ke(a.highlight.row+s.row,a.highlight.col+s.col);var u=this.mergedCellsCollection.get(l.row,l.col);if(u){var f=this.mergedCellsCollection.getFirstRenderableCoords(u.row,u.col);o.lastDesiredCoords=l,s={row:f.row-p.row,col:f.col-p.col}}s.row!==0&&(i.row=s.row),s.col!==0&&(i.col=s.col)}},{key:"onModifyTransformEnd",value:function(i){var o=this,a=this.hot.getSelectedRangeLast(),s=Br(i),l=this.selectionCalculations.getUpdatedSelectionRange(a,i),p=Br(s),d=this.mergedCellsCollection.getWithinRange(l,!0);do p=Br(s),this.selectionCalculations.getUpdatedSelectionRange(a,s),he(d,function(g){o.selectionCalculations.snapDelta(s,a,g)});while(s.row!==p.row||s.col!==p.col);i.row=s.row,i.col=s.col}},{key:"onModifyGetCellCoords",value:function(i,o){if(!(i<0||o<0)){var a=this.mergedCellsCollection.get(i,o);if(!!a){var s=a.row,l=a.col,p=a.colspan,d=a.rowspan;return[s,l,s+d-1,l+p-1]}}}},{key:"addMergeActionsToContextMenu",value:function(i){i.items.push({name:"---------"},PRe(this))}},{key:"onAfterRenderer",value:function(i,o,a){var s=this.mergedCellsCollection.get(o,a),l=vt(s)?Br(s):void 0;if(vt(l)){var p=this.hot,d=p.rowIndexMapper,g=p.columnIndexMapper,y=l.row,h=l.col,u=l.colspan,f=l.rowspan,c=this.translateMergedCellToRenderable(y,f,h,u),v=y7(c,2),m=v[0],b=v[1],w=d.getRenderableFromVisualIndex(o),_=g.getRenderableFromVisualIndex(a),C=m-w+1,R=b-_+1;l.row=d.getFirstNotHiddenIndex(l.row,1),l.col=g.getFirstNotHiddenIndex(l.col,1),l.rowspan=Math.min(l.rowspan,C),l.colspan=Math.min(l.colspan,R)}uk(i,l,o,a)}},{key:"onBeforeSetRangeStart",value:function(i){if(this.mergedCellsCollection.isFirstRenderableMergedCell(i.row,i.col)){var o=this.mergedCellsCollection.get(i.row,i.col),a=[o.row,o.col];i.row=a[0],i.col=a[1]}}},{key:"onBeforeSetRangeEnd",value:function(i){var o=this.hot.getSelectedRangeLast();o.highlight=new ke(o.highlight.row,o.highlight.col),o.to=i;var a=!1;if(!(this.hot.selection.isSelectedByColumnHeader()||this.hot.selection.isSelectedByRowHeader()))do{a=!1;for(var s=0;s<this.mergedCellsCollection.mergedCells.length;s+=1){var l=this.mergedCellsCollection.mergedCells[s],p=l.getRange();o.expandByRange(p)&&(i.row=o.to.row,i.col=o.to.col,a=!0)}}while(a)}},{key:"onAfterGetCellMeta",value:function(i,o,a){var s=this.mergedCellsCollection.get(i,o);s&&(s.row!==i||s.col!==o?a.copyable=!1:(a.rowspan=s.rowspan,a.colspan=s.colspan))}},{key:"onAfterViewportRowCalculatorOverride",value:function(i){var o=this.hot.countCols();this.modifyViewportRowStart(i,o),this.modifyViewportRowEnd(i,o)}},{key:"modifyViewportRowStart",value:function(i,o){for(var a=this.hot.rowIndexMapper,s=a.getVisualFromRenderableIndex(i.startRow),l=0;l<o;l+=1){var p=this.mergedCellsCollection.get(s,l);if(vt(p)){var d=a.getRenderableFromVisualIndex(a.getFirstNotHiddenIndex(p.row,1));if(d<i.startRow){i.startRow=d,this.modifyViewportRowStart(i,o);return}}}}},{key:"modifyViewportRowEnd",value:function(i,o){for(var a=this.hot.rowIndexMapper,s=a.getVisualFromRenderableIndex(i.endRow),l=0;l<o;l+=1){var p=this.mergedCellsCollection.get(s,l);if(vt(p)){var d=p.row+p.rowspan-1,g=a.getRenderableFromVisualIndex(a.getFirstNotHiddenIndex(d,-1));if(g>i.endRow){i.endRow=g,this.modifyViewportRowEnd(i,o);return}}}}},{key:"onAfterViewportColumnCalculatorOverride",value:function(i){var o=this.hot.countRows();this.modifyViewportColumnStart(i,o),this.modifyViewportColumnEnd(i,o)}},{key:"modifyViewportColumnStart",value:function(i,o){for(var a=this.hot.columnIndexMapper,s=a.getVisualFromRenderableIndex(i.startColumn),l=0;l<o;l+=1){var p=this.mergedCellsCollection.get(l,s);if(vt(p)){var d=a.getRenderableFromVisualIndex(a.getFirstNotHiddenIndex(p.col,1));if(d<i.startColumn){i.startColumn=d,this.modifyViewportColumnStart(i,o);return}}}}},{key:"modifyViewportColumnEnd",value:function(i,o){for(var a=this.hot.columnIndexMapper,s=a.getVisualFromRenderableIndex(i.endColumn),l=0;l<o;l+=1){var p=this.mergedCellsCollection.get(l,s);if(vt(p)){var d=p.col+p.colspan-1,g=a.getRenderableFromVisualIndex(a.getFirstNotHiddenIndex(d,-1));if(g>i.endColumn){i.endColumn=g,this.modifyViewportColumnEnd(i,o);return}}}}},{key:"translateMergedCellToRenderable",value:function(i,o,a,s){var l=this.hot,p=l.rowIndexMapper,d=l.columnIndexMapper,g,y;o===0?g=p.getFirstNotHiddenIndex(i,1):g=p.getFirstNotHiddenIndex(i+o-1,-1),s===0?y=d.getFirstNotHiddenIndex(a,1):y=d.getFirstNotHiddenIndex(a+s-1,-1);var h=i>=0?p.getRenderableFromVisualIndex(g):i,u=a>=0?d.getRenderableFromVisualIndex(y):a;return[h,u]}},{key:"onModifyAutofillRange",value:function(i,o){this.autofillCalculations.correctSelectionAreaSize(o);var a=this.autofillCalculations.getDirection(o,i),s=i;if(this.autofillCalculations.dragAreaOverlapsCollections(o,s,a))return s=o,s;var l=this.mergedCellsCollection.getWithinRange({from:{row:o[0],col:o[1]},to:{row:o[2],col:o[3]}});return l&&(s=this.autofillCalculations.snapDragArea(o,s,a,l)),s}},{key:"onAfterCreateCol",value:function(i,o){this.mergedCellsCollection.shiftCollections("right",i,o)}},{key:"onAfterRemoveCol",value:function(i,o){this.mergedCellsCollection.shiftCollections("left",i,o)}},{key:"onAfterCreateRow",value:function(i,o,a){a!=="auto"&&this.mergedCellsCollection.shiftCollections("down",i,o)}},{key:"onAfterRemoveRow",value:function(i,o){this.mergedCellsCollection.shiftCollections("up",i,o)}},{key:"onAfterChange",value:function(i,o){o==="Autofill.fill"&&this.autofillCalculations.recreateAfterDataPopulation(i)}},{key:"onBeforeDrawAreaBorders",value:function(i,o){if(o&&o==="area"){var a=this.hot.getSelectedRangeLast(),s=this.mergedCellsCollection.getWithinRange(a);he(s,function(l){a.getBottomRightCorner().row===l.getLastRow()&&a.getBottomRightCorner().col===l.getLastColumn()&&(i[2]=l.row,i[3]=l.col)})}}},{key:"onAfterModifyTransformStart",value:function(i,o,a){if(!!this.enabled){var s=this.mergedCellsCollection.get(i.row,i.col);if(!!s){var l=o>0,p=o<0,d=a<0,g=a>0,y=s.row+s.rowspan-1==this.hot.countRows()-1,h=s.row===0,u=s.col+s.colspan-1==this.hot.countCols()-1,f=s.col===0;(l&&y||p&&h||g&&u||d&&f)&&(i.row=s.row,i.col=s.col)}}}},{key:"onAfterDrawSelection",value:function(i,o,a,s){if(!!a)return this.selectionCalculations.getSelectedMergedCellClassName(i,o,a,s)}},{key:"onBeforeRemoveCellClassNames",value:function(){return this.selectionCalculations.getSelectedMergedCellClassNameToRemove()}}],[{key:"PLUGIN_KEY",get:function(){return Nm}},{key:"PLUGIN_PRIORITY",get:function(){return YRe}}]),e}(Lt);function _7(t){return ZRe(t)||XRe(t)||qRe(t)||KRe()}function KRe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function qRe(t,r){if(!!t){if(typeof t=="string")return S7(t,r);var e=Object.prototype.toString.call(t).slice(8,-1);if(e==="Object"&&t.constructor&&(e=t.constructor.name),e==="Map"||e==="Set")return Array.from(t);if(e==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return S7(t,r)}}function S7(t,r){(r==null||r>t.length)&&(r=t.length);for(var e=0,n=new Array(r);e<r;e++)n[e]=t[e];return n}function XRe(t){if(typeof Symbol!="undefined"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function ZRe(t){if(Array.isArray(t))return t}function JRe(t,r){return function(e,n){var i=_7(e),o=i.slice(1),a=_7(n),s=a.slice(1);return function l(p){var d=t[p],g=r[p],y=o[p],h=s[p],u=g.multiColumnSorting,f=u.compareFunctionFactory?u.compareFunctionFactory:AP(g.type),c=f(d,g,u)(y,h);if(c===ai){var v=p+1;if(typeof r[v]!="undefined")return l(v)}return c}(0)}}var C7;function QRe(t,r){return r||(r=t.slice(0)),Object.freeze(Object.defineProperties(t,{raw:{value:Object.freeze(r)}}))}function k7(){tr(Kt(C7||(C7=QRe(["Plugins `columnSorting` and `multiColumnSorting` should not be enabled simultaneously. \n    Only `multiColumnSorting` will work."],["Plugins \\`columnSorting\\` and \\`multiColumnSorting\\` should not be enabled simultaneously. \n    Only \\`multiColumnSorting\\` will work."]))))}var O7="sort";function eEe(t,r,e){var n=[];return e===!1||t.isColumnSorted(r)&&t.getNumberOfSortedColumns()>1&&n.push("".concat(O7,"-").concat(t.getIndexOfColumnInSortQueue(r)+1)),n}function tEe(t){var r=t.className.split(" "),e=new RegExp("^".concat(O7,"-[0-9]{1,2}$"));return r.filter(function(n){return e.test(n)})}function $m(t){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?$m=function(e){return typeof e}:$m=function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},$m(t)}function rEe(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}function R7(t,r){for(var e=0;e<r.length;e++){var n=r[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function nEe(t,r,e){return r&&R7(t.prototype,r),e&&R7(t,e),t}function mn(){return typeof Reflect!="undefined"&&Reflect.get?mn=Reflect.get:mn=function(r,e,n){var i=iEe(r,e);if(!!i){var o=Object.getOwnPropertyDescriptor(i,e);return o.get?o.get.call(arguments.length<3?r:n):o.value}},mn.apply(this,arguments)}function iEe(t,r){for(;!Object.prototype.hasOwnProperty.call(t,r)&&(t=Xr(t),t!==null););return t}function oEe(t,r){if(typeof r!="function"&&r!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(r&&r.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),r&&hk(t,r)}function hk(t,r){return hk=Object.setPrototypeOf||function(n,i){return n.__proto__=i,n},hk(t,r)}function aEe(t){var r=lEe();return function(){var n=Xr(t),i;if(r){var o=Xr(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return sEe(this,i)}}function sEe(t,r){if(r&&($m(r)==="object"||typeof r=="function"))return r;if(r!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return uEe(t)}function uEe(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function lEe(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Xr(t){return Xr=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},Xr(t)}var dk="multiColumnSorting",fEe=170,cEe="append",E7="columnSorting";xP(dk,JRe);var hEe=function(t){oEe(e,t);var r=aEe(e);function e(n){var i;return rEe(this,e),i=r.call(this,n),i.pluginKey=dk,i}return nEe(e,[{key:"isEnabled",value:function(){return mn(Xr(e.prototype),"isEnabled",this).call(this)}},{key:"enablePlugin",value:function(){!this.enabled&&this.hot.getSettings()[this.pluginKey]&&this.hot.getSettings()[E7]&&k7(),mn(Xr(e.prototype),"enablePlugin",this).call(this)}},{key:"disablePlugin",value:function(){mn(Xr(e.prototype),"disablePlugin",this).call(this)}},{key:"sort",value:function(i){mn(Xr(e.prototype),"sort",this).call(this,i)}},{key:"clearSort",value:function(){mn(Xr(e.prototype),"clearSort",this).call(this)}},{key:"isSorted",value:function(){return mn(Xr(e.prototype),"isSorted",this).call(this)}},{key:"getSortConfig",value:function(i){return mn(Xr(e.prototype),"getSortConfig",this).call(this,i)}},{key:"setSortConfig",value:function(i){mn(Xr(e.prototype),"setSortConfig",this).call(this,i)}},{key:"getNormalizedSortConfigs",value:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return Array.isArray(i)?i:[i]}},{key:"updateHeaderClasses",value:function(i){for(var o,a=arguments.length,s=new Array(a>1?a-1:0),l=1;l<a;l++)s[l-1]=arguments[l];(o=mn(Xr(e.prototype),"updateHeaderClasses",this)).call.apply(o,[this,i].concat(s)),dt(i,tEe(i)),this.enabled!==!1&&Ie(i,eEe.apply(void 0,s))}},{key:"onUpdateSettings",value:function(i){this.hot.getSettings()[this.pluginKey]&&this.hot.getSettings()[E7]&&k7(),mn(Xr(e.prototype),"onUpdateSettings",this).call(this,i)}},{key:"onAfterOnCellMouseDown",value:function(i,o){ES(o.row,o.col,i)!==!1&&this.wasClickableHeaderClicked(i,o.col)&&(Cp()?(this.hot.deselectCell(),this.hot.selectColumns(o.col),this.sort(this.getNextSortConfig(o.col,cEe))):this.sort(this.getColumnNextConfig(o.col)))}}],[{key:"PLUGIN_KEY",get:function(){return dk}},{key:"PLUGIN_PRIORITY",get:function(){return fEe}}]),e}(VP);function jm(t){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?jm=function(e){return typeof e}:jm=function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},jm(t)}function dEe(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}function T7(t,r){for(var e=0;e<r.length;e++){var n=r[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function pEe(t,r,e){return r&&T7(t.prototype,r),e&&T7(t,e),t}function Lm(){return typeof Reflect!="undefined"&&Reflect.get?Lm=Reflect.get:Lm=function(r,e,n){var i=yEe(r,e);if(!!i){var o=Object.getOwnPropertyDescriptor(i,e);return o.get?o.get.call(arguments.length<3?r:n):o.value}},Lm.apply(this,arguments)}function yEe(t,r){for(;!Object.prototype.hasOwnProperty.call(t,r)&&(t=Qu(t),t!==null););return t}function mEe(t,r){if(typeof r!="function"&&r!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(r&&r.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),r&&pk(t,r)}function pk(t,r){return pk=Object.setPrototypeOf||function(n,i){return n.__proto__=i,n},pk(t,r)}function vEe(t){var r=wEe();return function(){var n=Qu(t),i;if(r){var o=Qu(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return gEe(this,i)}}function gEe(t,r){if(r&&(jm(r)==="object"||typeof r=="function"))return r;if(r!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return bEe(t)}function bEe(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function wEe(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Qu(t){return Qu=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},Qu(t)}var _Ee="multipleSelectionHandles",SEe=160,CEe=function(t){mEe(e,t);var r=vEe(e);function e(n){var i;return dEe(this,e),i=r.call(this,n),i.dragged=[],i.eventManager=null,i.lastSetCell=null,i}return pEe(e,[{key:"isEnabled",value:function(){return In()}},{key:"enablePlugin",value:function(){this.enabled||(this.eventManager||(this.eventManager=new Wt(this)),this.registerListeners(),Lm(Qu(e.prototype),"enablePlugin",this).call(this))}},{key:"registerListeners",value:function(){var i=this,o=this,a=this.hot.rootElement;function s(l){if(o.dragged.length===1)return o.dragged.splice(0,o.dragged.length),!0;var p=o.dragged.indexOf(l);if(p===-1)return!1;p===0?o.dragged=o.dragged.slice(0,1):p===1&&(o.dragged=o.dragged.slice(-1))}this.eventManager.addEventListener(a,"touchstart",function(l){var p;if(lt(l.target,"topLeftSelectionHandle-HitArea"))return p=o.hot.getSelectedRangeLast(),o.dragged.push("topLeft"),o.touchStartRange={width:p.getWidth(),height:p.getHeight(),direction:p.getDirection()},l.preventDefault(),!1;if(lt(l.target,"bottomRightSelectionHandle-HitArea"))return p=o.hot.getSelectedRangeLast(),o.dragged.push("bottomRight"),o.touchStartRange={width:p.getWidth(),height:p.getHeight(),direction:p.getDirection()},l.preventDefault(),!1}),this.eventManager.addEventListener(a,"touchend",function(l){if(lt(l.target,"topLeftSelectionHandle-HitArea"))return s.call(o,"topLeft"),o.touchStartRange=void 0,l.preventDefault(),!1;if(lt(l.target,"bottomRightSelectionHandle-HitArea"))return s.call(o,"bottomRight"),o.touchStartRange=void 0,l.preventDefault(),!1}),this.eventManager.addEventListener(a,"touchmove",function(l){var p=i.hot,d=p.rootWindow,g=p.rootDocument,y=Ra(d),h=Po(d),u,f,c,v,m,b;if(o.dragged.length!==0){var w=g.elementFromPoint(l.touches[0].screenX-h,l.touches[0].screenY-y);!w||w===o.lastSetCell||((w.nodeName==="TD"||w.nodeName==="TH")&&(u=o.hot.getCoords(w),u.col===-1&&(u.col=0),f=o.hot.getSelectedRangeLast(),c=f.getWidth(),v=f.getHeight(),m=f.getDirection(),c===1&&v===1&&o.hot.selection.setRangeEnd(u),b=o.getCurrentRangeCoords(f,u,o.touchStartRange.direction,m,o.dragged[0]),b.start!==null&&o.hot.selection.setRangeStart(b.start),o.hot.selection.setRangeEnd(b.end),o.lastSetCell=w),l.preventDefault())}})}},{key:"getCurrentRangeCoords",value:function(i,o,a,s,l){var p=i.getTopLeftCorner(),d=i.getBottomRightCorner(),g=i.getBottomLeftCorner(),y=i.getTopRightCorner(),h={start:null,end:null};switch(a){case"NE-SW":switch(s){case"NE-SW":case"NW-SE":l==="topLeft"?h={start:new ke(o.row,i.highlight.col),end:new ke(g.row,o.col)}:h={start:new ke(i.highlight.row,o.col),end:new ke(o.row,p.col)};break;case"SE-NW":l==="bottomRight"&&(h={start:new ke(d.row,o.col),end:new ke(o.row,p.col)});break}break;case"NW-SE":switch(s){case"NE-SW":l==="topLeft"?h={start:o,end:g}:h.end=o;break;case"NW-SE":l==="topLeft"?h={start:o,end:d}:h.end=o;break;case"SE-NW":l==="topLeft"?h={start:o,end:p}:h.end=o;break;case"SW-NE":l==="topLeft"?h={start:o,end:y}:h.end=o;break}break;case"SW-NE":switch(s){case"NW-SE":l==="bottomRight"?h={start:new ke(o.row,p.col),end:new ke(g.row,o.col)}:h={start:new ke(p.row,o.col),end:new ke(o.row,d.col)};break;case"SW-NE":l==="topLeft"?h={start:new ke(i.highlight.row,o.col),end:new ke(o.row,d.col)}:h={start:new ke(o.row,p.col),end:new ke(p.row,o.col)};break;case"SE-NW":l==="bottomRight"?h={start:new ke(o.row,y.col),end:new ke(p.row,o.col)}:l==="topLeft"&&(h={start:g,end:o});break}break;case"SE-NW":switch(s){case"NW-SE":case"NE-SW":case"SW-NE":l==="topLeft"&&(h.end=o);break;case"SE-NW":l==="topLeft"?h.end=o:h={start:o,end:p};break}break}return h}},{key:"isDragged",value:function(){return this.dragged.length>0}}],[{key:"PLUGIN_KEY",get:function(){return _Ee}},{key:"PLUGIN_PRIORITY",get:function(){return SEe}}]),e}(Lt);function yk(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},r=t.label,e=r===void 0?"":r,n=t.colspan,i=n===void 0?1:n,o=t.origColspan,a=o===void 0?1:o,s=t.collapsible,l=s===void 0?!1:s,p=t.crossHiddenColumns,d=p===void 0?[]:p,g=t.isCollapsed,y=g===void 0?!1:g,h=t.isHidden,u=h===void 0?!1:h,f=t.isRoot,c=f===void 0?!1:f,v=t.isPlaceholder,m=v===void 0?!1:v;return{label:e,colspan:i,origColspan:a,collapsible:l,isCollapsed:y,crossHiddenColumns:d,isHidden:u,isRoot:c,isPlaceholder:m}}function x7(){return{label:"",isPlaceholder:!0}}function A7(t){return EEe(t)||REe(t)||OEe(t)||kEe()}function kEe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function OEe(t,r){if(!!t){if(typeof t=="string")return mk(t,r);var e=Object.prototype.toString.call(t).slice(8,-1);if(e==="Object"&&t.constructor&&(e=t.constructor.name),e==="Map"||e==="Set")return Array.from(t);if(e==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return mk(t,r)}}function REe(t){if(typeof Symbol!="undefined"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function EEe(t){if(Array.isArray(t))return mk(t)}function mk(t,r){(r==null||r>t.length)&&(r=t.length);for(var e=0,n=new Array(r);e<r;e++)n[e]=t[e];return n}function TEe(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1/0,e=[];if(r===0)return e;he(t,function(i){var o=[],a=0;e.push(o),he(i,function(s){var l=yk();if(vt(s)){var p=s.label,d=s.colspan;l.label=lr(p),typeof d=="number"&&d>1&&(l.colspan=d,l.origColspan=d)}else l.label=lr(s);a+=l.origColspan;var g=!1;if(a>=r&&(l.colspan=l.origColspan-(a-r),l.origColspan=l.colspan,g=!0),o.push(l),l.colspan>1)for(var y=0;y<l.colspan-1;y++)o.push(x7());return!g})});var n=Math.max.apply(Math,A7(bt(e,function(i){return i.length})));return he(e,function(i){if(i.length<n){var o=bt(new Array(n-i.length),function(){return yk()});i.splice.apply(i,[i.length,0].concat(A7(o)))}}),e}var xEe=["row","col"];function M7(t,r){var e=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);r&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),e.push.apply(e,n)}return e}function AEe(t){for(var r=1;r<arguments.length;r++){var e=arguments[r]!=null?arguments[r]:{};r%2?M7(Object(e),!0).forEach(function(n){MEe(t,n,e[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(e)):M7(Object(e)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(e,n))})}return t}function MEe(t,r,e){return r in t?Object.defineProperty(t,r,{value:e,enumerable:!0,configurable:!0,writable:!0}):t[r]=e,t}function PEe(t,r){if(t==null)return{};var e=IEe(t,r),n,i;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);for(i=0;i<o.length;i++)n=o[i],!(r.indexOf(n)>=0)&&(!Object.prototype.propertyIsEnumerable.call(t,n)||(e[n]=t[n]))}return e}function IEe(t,r){if(t==null)return{};var e={},n=Object.keys(t),i,o;for(o=0;o<n.length;o++)i=n[o],!(r.indexOf(i)>=0)&&(e[i]=t[i]);return e}function DEe(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}function P7(t,r){for(var e=0;e<r.length;e++){var n=r[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function NEe(t,r,e){return r&&P7(t.prototype,r),e&&P7(t,e),t}function vk(t,r,e){$Ee(t,r),r.set(t,e)}function $Ee(t,r){if(r.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Un(t,r){var e=I7(t,r,"get");return jEe(t,e)}function jEe(t,r){return r.get?r.get.call(t):r.value}function fc(t,r,e){var n=I7(t,r,"set");return LEe(t,n,e),e}function I7(t,r,e){if(!r.has(t))throw new TypeError("attempted to "+e+" private field on non-instance");return r.get(t)}function LEe(t,r,e){if(r.set)r.set.call(t,e);else{if(!r.writable)throw new TypeError("attempted to set read only private field");r.value=e}}var D7=["label","collapsible"],eo=new WeakMap,cs=new WeakMap,gk=new WeakMap,HEe=function(){function t(){DEe(this,t),vk(this,eo,{writable:!0,value:[]}),vk(this,cs,{writable:!0,value:0}),vk(this,gk,{writable:!0,value:1/0})}return NEe(t,[{key:"setColumnsLimit",value:function(e){fc(this,gk,e)}},{key:"setData",value:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];fc(this,eo,TEe(e,Un(this,gk))),fc(this,cs,Un(this,eo).length)}},{key:"getData",value:function(){return Un(this,eo)}},{key:"mergeWith",value:function(e){var n=this;he(e,function(i){var o=i.row,a=i.col,s=PEe(i,xEe),l=n.getHeaderSettings(o,a);l!==null&&or(l,s,D7)})}},{key:"map",value:function(e){he(Un(this,eo),function(n){he(n,function(i){var o=e(AEe({},i));vt(o)&&or(i,o,D7)})})}},{key:"getHeaderSettings",value:function(e,n){var i;if(e>=Un(this,cs)||e<0)return null;var o=Un(this,eo)[e];return n>=o.length?null:(i=o[n])!==null&&i!==void 0?i:null}},{key:"getHeadersSettings",value:function(e,n){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,o=[];if(e>=Un(this,cs)||e<0)return o;for(var a=Un(this,eo)[e],s=0,l=n;l<a.length;l++){var p=a[l];if(p.isPlaceholder)throw new Error("The first column settings cannot overlap the other header layers");if(s+=p.colspan,o.push(p),p.colspan>1&&(l+=p.colspan-1),s===i)break;if(s>i)throw new Error("The last column settings cannot overlap the other header layers")}return o}},{key:"getLayersCount",value:function(){return Un(this,cs)}},{key:"getColumnsCount",value:function(){return Un(this,cs)>0?Un(this,eo)[0].length:0}},{key:"clear",value:function(){fc(this,eo,[]),fc(this,cs,0)}}]),t}();function N7(t,r){var e=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);r&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),e.push.apply(e,n)}return e}function $7(t){for(var r=1;r<arguments.length;r++){var e=arguments[r]!=null?arguments[r]:{};r%2?N7(Object(e),!0).forEach(function(n){Hm(t,n,e[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(e)):N7(Object(e)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(e,n))})}return t}function FEe(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}function j7(t,r){for(var e=0;e<r.length;e++){var n=r[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function BEe(t,r,e){return r&&j7(t.prototype,r),e&&j7(t,e),t}function Hm(t,r,e){return r in t?Object.defineProperty(t,r,{value:e,enumerable:!0,configurable:!0,writable:!0}):t[r]=e,t}function VEe(t){return YEe(t)||zEe(t)||UEe(t)||WEe()}function WEe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function UEe(t,r){if(!!t){if(typeof t=="string")return bk(t,r);var e=Object.prototype.toString.call(t).slice(8,-1);if(e==="Object"&&t.constructor&&(e=t.constructor.name),e==="Map"||e==="Set")return Array.from(t);if(e==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return bk(t,r)}}function zEe(t){if(typeof Symbol!="undefined"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function YEe(t){if(Array.isArray(t))return bk(t)}function bk(t,r){(r==null||r>t.length)&&(r=t.length);for(var e=0,n=new Array(r);e<r;e++)n[e]=t[e];return n}var GEe="DF-pre-order";function L7(t,r){for(var e=t.call(r,this),n=0;n<this.childs.length;n++){if(e===!1)return!1;e=L7.call(this.childs[n],t,r)}return e}var KEe="DF-post-order";function H7(t,r){for(var e=0;e<this.childs.length;e++){var n=H7.call(this.childs[e],t,r);if(n===!1)return!1}return t.call(r,this)}var F7="BF";function qEe(t,r){var e=[this];function n(){if(e.length!==0){var i=e.shift();e.push.apply(e,VEe(i.childs)),t.call(r,i)!==!1&&n()}}n()}var XEe=F7,B7=new Map([[GEe,L7],[KEe,H7],[F7,qEe]]),V7=function(){function t(r){FEe(this,t),Hm(this,"data",{}),Hm(this,"parent",null),Hm(this,"childs",[]),this.data=r}return BEe(t,[{key:"addChild",value:function(e){e.parent=this,this.childs.push(e)}},{key:"cloneTree",value:function(){for(var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this,n=new t($7({},e.data)),i=0;i<e.childs.length;i++)n.addChild(this.cloneTree(e.childs[i]));return n}},{key:"replaceTreeWith",value:function(e){this.data=$7({},e.data),this.childs=[];for(var n=0;n<e.childs.length;n++)this.addChild(e.childs[n])}},{key:"walkDown",value:function(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:XEe;if(!B7.has(n))throw new Error('Traversal strategy "'.concat(n,'" does not exist'));B7.get(n).call(this,e,this)}},{key:"walkUp",value:function(e){var n=this,i=function o(a){var s=e.call(n,a);s!==!1&&a.parent!==null&&o(a.parent)};i(this)}}]),t}();function W7(t,r){var e=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);r&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),e.push.apply(e,n)}return e}function U7(t){for(var r=1;r<arguments.length;r++){var e=arguments[r]!=null?arguments[r]:{};r%2?W7(Object(e),!0).forEach(function(n){ZEe(t,n,e[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(e)):W7(Object(e)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(e,n))})}return t}function ZEe(t,r,e){return r in t?Object.defineProperty(t,r,{value:e,enumerable:!0,configurable:!0,writable:!0}):t[r]=e,t}function JEe(t,r){return rTe(t)||tTe(t,r)||eTe(t,r)||QEe()}function QEe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function eTe(t,r){if(!!t){if(typeof t=="string")return z7(t,r);var e=Object.prototype.toString.call(t).slice(8,-1);if(e==="Object"&&t.constructor&&(e=t.constructor.name),e==="Map"||e==="Set")return Array.from(t);if(e==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return z7(t,r)}}function z7(t,r){(r==null||r>t.length)&&(r=t.length);for(var e=0,n=new Array(r);e<r;e++)n[e]=t[e];return n}function tTe(t,r){var e=t==null?null:typeof Symbol!="undefined"&&t[Symbol.iterator]||t["@@iterator"];if(e!=null){var n=[],i=!0,o=!1,a,s;try{for(e=e.call(t);!(i=(a=e.next()).done)&&(n.push(a.value),!(r&&n.length===r));i=!0);}catch(l){o=!0,s=l}finally{try{!i&&e.return!=null&&e.return()}finally{if(o)throw s}}return n}}function rTe(t){if(Array.isArray(t))return t}function nTe(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}function Y7(t,r){for(var e=0;e<r.length;e++){var n=r[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function iTe(t,r,e){return r&&Y7(t.prototype,r),e&&Y7(t,e),t}function wk(t,r,e){oTe(t,r),r.set(t,e)}function oTe(t,r){if(r.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Zr(t,r){var e=G7(t,r,"get");return aTe(t,e)}function aTe(t,r){return r.get?r.get.call(t):r.value}function sTe(t,r,e){var n=G7(t,r,"set");return uTe(t,n,e),e}function G7(t,r,e){if(!r.has(t))throw new TypeError("attempted to "+e+" private field on non-instance");return r.get(t)}function uTe(t,r,e){if(r.set)r.set.call(t,e);else{if(!r.writable)throw new TypeError("attempted to set read only private field");r.value=e}}var el=new WeakMap,hs=new WeakMap,tl=new WeakMap,lTe=function(){function t(r){nTe(this,t),wk(this,el,{writable:!0,value:new Map}),wk(this,hs,{writable:!0,value:new Map}),wk(this,tl,{writable:!0,value:null}),sTe(this,tl,r)}return iTe(t,[{key:"getRoots",value:function(){return Array.from(Zr(this,el).values())}},{key:"getRootByColumn",value:function(e){var n;return Zr(this,hs).has(e)&&(n=Zr(this,el).get(Zr(this,hs).get(e))),n}},{key:"getNode",value:function(e,n){var i=this.getRootByColumn(n);if(!!i){var o=n-Zr(this,hs).get(n),a=0,s;return i.walkDown(function(l){var p=l.data,d=p.origColspan,g=p.headerLevel;if(e===g){if(o>=a&&o<=a+d-1)return s=l,!1;a+=d}}),s}}},{key:"rebuildTreeIndex",value:function(){var e=this,n=0;Zr(this,hs).clear(),he(Zr(this,el),function(i){for(var o=JEe(i,2),a=o[1].data.colspan,s=n;s<n+a;s++)Zr(e,hs).set(s,n);n+=a})}},{key:"buildTree",value:function(){this.clear();for(var e=Zr(this,tl).getColumnsCount(),n=0;n<e;){var i=Zr(this,tl).getHeaderSettings(0,n),o=new V7;Zr(this,el).set(n,o),this.buildLeaves(o,n,0,i.origColspan),n+=i.origColspan}this.rebuildTreeIndex()}},{key:"buildLeaves",value:function(e,n,i){var o=this,a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:1,s=Zr(this,tl).getHeadersSettings(i,n,a);i+=1,he(s,function(l){var p=U7(U7({},l),{},{headerLevel:i-1,columnIndex:n}),d;i===1?(e.data=p,d=e):(d=new V7(p),e.addChild(d)),i<Zr(o,tl).getLayersCount()&&o.buildLeaves(d,n,i,l.origColspan),n+=l.origColspan})}},{key:"clear",value:function(){Zr(this,el).clear(),Zr(this,hs).clear()}}]),t}();function K7(t,r){t.walkDown(function(e){var n=e.data,i=e.childs;if(!n.isHidden&&(r(n.columnIndex),i.length===0))for(var o=1;o<n.colspan;o++)r(n.columnIndex+o)})}function Fm(t,r){var e=t.childs;if(e.length!==0)return e[0].data[r]}function Bm(t){return Fm(t,"origColspan")===t.data.origColspan}function _k(t){var r=t.data,e=t.childs;if(!r.isCollapsed||r.isHidden||r.origColspan<=1)return{rollbackModification:function(){},affectedColumns:[],colspanCompensation:0};var n=Bm(t);if(n)return _k(e[0]);r.isCollapsed=!1;var i=e.slice(1),o=new Set,a=0;if(i.length>0)he(i,function(g){g.replaceTreeWith(g.data.clonedTree),g.data.clonedTree=null;var y=g.data;a+=y.colspan,K7(g,function(h){o.add(h)})});else{var s=r.colspan,l=r.origColspan,p=r.columnIndex;a=l-s;for(var d=1;d<l;d++)o.add(p+d)}return t.walkUp(function(g){var y=g.data;y.colspan+=a,y.colspan>=y.origColspan?(y.colspan=y.origColspan,y.isCollapsed=!1):Bm(g)&&(y.isCollapsed=Fm(g,"isCollapsed"))}),{rollbackModification:function(){return Sk(t)},affectedColumns:Array.from(o),colspanCompensation:a}}function Sk(t){var r,e=t.data,n=t.childs;if(e.isCollapsed||e.isHidden||e.origColspan<=1)return{rollbackModification:function(){},affectedColumns:[],colspanCompensation:0};var i=Bm(t);if(i)return Sk(n[0]);e.isCollapsed=!0;var o=n.slice(1),a=new Set;if(o.length>0)he(o,function(y){K7(y,function(h){a.add(h)}),y.data.clonedTree=y.cloneTree(),y.walkDown(function(h){var u=h.data;u.isHidden=!0})});else for(var s=e.origColspan,l=e.columnIndex,p=1;p<s;p++){var d=l+p;a.add(d)}var g=e.colspan-((r=Fm(t,"colspan"))!==null&&r!==void 0?r:1);return t.walkUp(function(y){var h=y.data;h.colspan-=g,h.colspan<=1?(h.colspan=1,h.isCollapsed=!0):Bm(y)&&(h.isCollapsed=Fm(y,"isCollapsed"))}),{rollbackModification:function(){return _k(t)},affectedColumns:Array.from(a),colspanCompensation:g}}var q7;function fTe(t,r){return r||(r=t.slice(0)),Object.freeze(Object.defineProperties(t,{raw:{value:Object.freeze(r)}}))}function cTe(t,r){if(!Number.isInteger(r))throw new Error("The passed gridColumnIndex argument has invalid type.");if(t.childs.length>0)throw new Error(Kt(q7||(q7=fTe([`The passed node is not the last node on the tree. Only for 
the last node, the hide column modification can be applied.`],[`The passed node is not the last node on the tree. Only for\\x20
the last node, the hide column modification can be applied.`]))));var e=t.data.crossHiddenColumns;if(!e.includes(r)){var n=!1;t.walkUp(function(i){var o=i.data.collapsible;if(o)return n=!0,!1}),!n&&t.walkUp(function(i){var o=i.data;o.crossHiddenColumns.push(r),o.colspan>1?o.colspan-=1:o.isHidden=!0})}}var X7;function hTe(t,r){return r||(r=t.slice(0)),Object.freeze(Object.defineProperties(t,{raw:{value:Object.freeze(r)}}))}function dTe(t,r){if(!Number.isInteger(r))throw new Error("The passed gridColumnIndex argument has invalid type.");if(t.childs.length>0)throw new Error(Kt(X7||(X7=hTe([`The passed node is not the last node on the tree. Only for 
the last node, the show column modification can be applied.`],[`The passed node is not the last node on the tree. Only for\\x20
the last node, the show column modification can be applied.`]))));var e=t.data.crossHiddenColumns;if(!!e.includes(r)){var n=!1;t.walkUp(function(i){var o=i.data.collapsible;if(o)return n=!0,!1}),!n&&t.walkUp(function(i){var o=i.data;o.crossHiddenColumns.splice(o.crossHiddenColumns.indexOf(r),1),!o.isHidden&&o.colspan<o.origColspan&&(o.colspan+=1),o.isHidden=!1})}}var Z7=new Map([["collapse",Sk],["expand",_k],["hide-column",cTe],["show-column",dTe]]);function pTe(t,r,e){if(!Z7.has(t))throw new Error('The node modifier action ("'.concat(t,'") does not exist.'));return Z7.get(t)(r,e)}var yTe=["crossHiddenColumns"];function mTe(t,r){if(t==null)return{};var e=vTe(t,r),n,i;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);for(i=0;i<o.length;i++)n=o[i],!(r.indexOf(n)>=0)&&(!Object.prototype.propertyIsEnumerable.call(t,n)||(e[n]=t[n]))}return e}function vTe(t,r){if(t==null)return{};var e={},n=Object.keys(t),i,o;for(o=0;o<n.length;o++)i=n[o],!(r.indexOf(i)>=0)&&(e[i]=t[i]);return e}function Vm(t){var r=[];return he(t,function(e){e.walkDown(function(n){for(var i=n.data,o=i.origColspan,a=i.columnIndex,s=i.headerLevel,l=i.crossHiddenColumns,p=bTe(r,s),d=!1,g=a;g<a+o;g++){var y=l.includes(g);if(y||d)p.push(x7());else{var h=gTe(i);h.isRoot=!0,p.push(h),d=!0}}})}),r}function gTe(t){var r=yk(t);r.crossHiddenColumns;var e=mTe(r,yTe);return e}function bTe(t,r){var e;return Array.isArray(t[r])?e=t[r]:(e=[],t[r]=e),e}var wTe=["row"];function J7(t,r){var e=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);r&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),e.push.apply(e,n)}return e}function Q7(t){for(var r=1;r<arguments.length;r++){var e=arguments[r]!=null?arguments[r]:{};r%2?J7(Object(e),!0).forEach(function(n){_Te(t,n,e[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(e)):J7(Object(e)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(e,n))})}return t}function _Te(t,r,e){return r in t?Object.defineProperty(t,r,{value:e,enumerable:!0,configurable:!0,writable:!0}):t[r]=e,t}function STe(t,r){if(t==null)return{};var e=CTe(t,r),n,i;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);for(i=0;i<o.length;i++)n=o[i],!(r.indexOf(n)>=0)&&(!Object.prototype.propertyIsEnumerable.call(t,n)||(e[n]=t[n]))}return e}function CTe(t,r){if(t==null)return{};var e={},n=Object.keys(t),i,o;for(o=0;o<n.length;o++)i=n[o],!(r.indexOf(i)>=0)&&(e[i]=t[i]);return e}function kTe(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}function eD(t,r){for(var e=0;e<r.length;e++){var n=r[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function OTe(t,r,e){return r&&eD(t.prototype,r),e&&eD(t,e),t}function Ck(t,r,e){RTe(t,r),r.set(t,e)}function RTe(t,r){if(r.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function cc(t,r,e){var n=tD(t,r,"set");return ETe(t,n,e),e}function ETe(t,r,e){if(r.set)r.set.call(t,e);else{if(!r.writable)throw new TypeError("attempted to set read only private field");r.value=e}}function mr(t,r){var e=tD(t,r,"get");return TTe(t,e)}function tD(t,r,e){if(!r.has(t))throw new TypeError("attempted to "+e+" private field on non-instance");return r.get(t)}function TTe(t,r){return r.get?r.get.call(t):r.value}var di=new WeakMap,vn=new WeakMap,ds=new WeakMap,xTe=function(){function t(){kTe(this,t),Ck(this,di,{writable:!0,value:new HEe}),Ck(this,vn,{writable:!0,value:new lTe(mr(this,di))}),Ck(this,ds,{writable:!0,value:[[]]})}return OTe(t,[{key:"setState",value:function(e){mr(this,di).setData(e);var n=!1;try{mr(this,vn).buildTree()}catch{mr(this,vn).clear(),mr(this,di).clear(),n=!0}return cc(this,ds,Vm(mr(this,vn).getRoots())),n}},{key:"setColumnsLimit",value:function(e){mr(this,di).setColumnsLimit(e)}},{key:"mergeStateWith",value:function(e){var n=this,i=bt(e,function(o){var a=o.row,s=STe(o,wTe);return Q7({row:a<0?n.rowCoordsToLevel(a):a},s)});mr(this,di).mergeWith(i),mr(this,vn).buildTree(),cc(this,ds,Vm(mr(this,vn).getRoots()))}},{key:"mapState",value:function(e){mr(this,di).map(e),mr(this,vn).buildTree(),cc(this,ds,Vm(mr(this,vn).getRoots()))}},{key:"mapNodes",value:function(e){return pr(mr(this,vn).getRoots(),function(n,i){return i.walkDown(function(o){var a=e(o.data);a!==void 0&&n.push(a)}),n},[])}},{key:"triggerNodeModification",value:function(e,n,i){n<0&&(n=this.rowCoordsToLevel(n));var o=mr(this,vn).getNode(n,i),a;return o&&(a=pTe(e,o,i),cc(this,ds,Vm(mr(this,vn).getRoots()))),a}},{key:"triggerColumnModification",value:function(e,n){return this.triggerNodeModification(e,-1,n)}},{key:"rowCoordsToLevel",value:function(e){var n=Math.max(this.getLayersCount(),1),i=n-1,o=0;return Math.min(Math.max(e+n,o),i)}},{key:"levelToRowCoords",value:function(e){var n=Math.max(this.getLayersCount(),1),i=-1,o=-n;return Math.min(Math.max(e-n,o),i)}},{key:"getHeaderSettings",value:function(e,n){var i,o;return e<0&&(e=this.rowCoordsToLevel(e)),e>=this.getLayersCount()?null:(i=(o=mr(this,ds)[e])===null||o===void 0?void 0:o[n])!==null&&i!==void 0?i:null}},{key:"getHeaderTreeNodeData",value:function(e,n){e<0&&(e=this.rowCoordsToLevel(e));var i=mr(this,vn).getNode(e,n);return i?Q7({},i.data):null}},{key:"findLeftMostColumnIndex",value:function(e,n){var i,o=(i=this.getHeaderSettings(e,n))!==null&&i!==void 0?i:{isRoot:!0},a=o.isRoot;if(a)return n;for(var s=n-1;s>=0;){var l,p=(l=this.getHeaderSettings(e,s))!==null&&l!==void 0?l:{isRoot:!0},d=p.isRoot;if(d)break;s-=1}return s}},{key:"getLayersCount",value:function(){return mr(this,di).getLayersCount()}},{key:"getColumnsCount",value:function(){return mr(this,di).getColumnsCount()}},{key:"clear",value:function(){cc(this,ds,[]),mr(this,di).clear(),mr(this,vn).clear()}}]),t}();function ATe(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}function rD(t,r){for(var e=0;e<r.length;e++){var n=r[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function MTe(t,r,e){return r&&rD(t.prototype,r),e&&rD(t,e),t}var PTe=function(){function t(r){ATe(this,t),this.nestedHeaders=r,this.container=void 0,this.widthsCache=[]}return MTe(t,[{key:"buildWidthsMapper",value:function(){this.container=this.nestedHeaders.hot.rootDocument.createElement("div"),this.buildGhostTable(this.container),this.nestedHeaders.hot.rootElement.appendChild(this.container);var e=this.container.querySelectorAll("tr:last-of-type th"),n=e.length;this.widthsCache.length=0;for(var i=0;i<n;i++)this.widthsCache.push(e[i].offsetWidth);this.container.parentNode.removeChild(this.container),this.container=null,this.nestedHeaders.hot.render()}},{key:"buildGhostTable",value:function(e){for(var n=this.nestedHeaders.hot.rootDocument,i=n.createDocumentFragment(),o=n.createElement("table"),a=!1,s=!!this.nestedHeaders.hot.getSettings().dropdownMenu,l=this.nestedHeaders.getLayersCount(),p=this.nestedHeaders.hot.countCols(),d=l-1,g=0;g<l;g++){var y=n.createElement("tr");a=!1;for(var h=0;h<p;h++){var u=n.createElement("th"),f=Br(this.nestedHeaders.getHeaderSettings(g,h));f&&!f.isHidden&&(g===d&&(f.colspan>1&&(a=!0),s&&(f.label+='<button class="changeType"></button>')),Ao(u,f.label),f.colspan!==void 0&&(u.colSpan=f.colspan),y.appendChild(u))}o.appendChild(y)}if(a){for(var c=n.createElement("tr"),v=0;v<p;v++){var m=n.createElement("th");c.appendChild(m)}o.appendChild(c)}i.appendChild(o),e.appendChild(i)}},{key:"clear",value:function(){this.container=null,this.widthsCache.length=0}}]),t}(),ITe=PTe;function Wm(t){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?Wm=function(e){return typeof e}:Wm=function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Wm(t)}var nD,iD;function oD(t,r){return r||(r=t.slice(0)),Object.freeze(Object.defineProperties(t,{raw:{value:Object.freeze(r)}}))}function DTe(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}function aD(t,r){for(var e=0;e<r.length;e++){var n=r[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function NTe(t,r,e){return r&&aD(t.prototype,r),e&&aD(t,e),t}function ps(){return typeof Reflect!="undefined"&&Reflect.get?ps=Reflect.get:ps=function(r,e,n){var i=$Te(r,e);if(!!i){var o=Object.getOwnPropertyDescriptor(i,e);return o.get?o.get.call(arguments.length<3?r:n):o.value}},ps.apply(this,arguments)}function $Te(t,r){for(;!Object.prototype.hasOwnProperty.call(t,r)&&(t=to(t),t!==null););return t}function jTe(t,r){if(typeof r!="function"&&r!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(r&&r.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),r&&kk(t,r)}function kk(t,r){return kk=Object.setPrototypeOf||function(n,i){return n.__proto__=i,n},kk(t,r)}function LTe(t){var r=FTe();return function(){var n=to(t),i;if(r){var o=to(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return HTe(this,i)}}function HTe(t,r){if(r&&(Wm(r)==="object"||typeof r=="function"))return r;if(r!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return rl(t)}function rl(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function FTe(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function to(t){return to=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},to(t)}function sD(t,r,e){return r in t?Object.defineProperty(t,r,{value:e,enumerable:!0,configurable:!0,writable:!0}):t[r]=e,t}function uD(t,r,e){BTe(t,r),r.set(t,e)}function BTe(t,r){if(r.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Um(t,r,e){var n=lD(t,r,"set");return VTe(t,n,e),e}function VTe(t,r,e){if(r.set)r.set.call(t,e);else{if(!r.writable)throw new TypeError("attempted to set read only private field");r.value=e}}function Er(t,r){var e=lD(t,r,"get");return WTe(t,e)}function lD(t,r,e){if(!r.has(t))throw new TypeError("attempted to "+e+" private field on non-instance");return r.get(t)}function WTe(t,r){return r.get?r.get.call(t):r.value}var fD="nestedHeaders",UTe=280,Nr=new WeakMap,ta=new WeakMap,zTe=function(t){jTe(e,t);var r=LTe(e);function e(){var n;DTe(this,e);for(var i=arguments.length,o=new Array(i),a=0;a<i;a++)o[a]=arguments[a];return n=r.call.apply(r,[this].concat(o)),uD(rl(n),Nr,{writable:!0,value:new xTe}),uD(rl(n),ta,{writable:!0,value:null}),sD(rl(n),"ghostTable",new ITe(rl(n))),sD(rl(n),"detectedOverlappedHeaders",!1),n}return NTe(e,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[fD]}},{key:"enablePlugin",value:function(){var i=this;if(!this.enabled){var o=this.hot.getSettings(),a=o.nestedHeaders;(!Array.isArray(a)||!Array.isArray(a[0]))&&tr(Kt(nD||(nD=oD([`Your Nested Headers plugin configuration is invalid. The settings has to be 
                        passed as an array of arrays e.q. [['A1', { label: 'A2', colspan: 2 }]]`],[`Your Nested Headers plugin configuration is invalid. The settings has to be\\x20
                        passed as an array of arrays e.q. [['A1', { label: 'A2', colspan: 2 }]]`])))),this.addHook("init",function(){return i.onInit()}),this.addHook("afterLoadData",function(){return i.onAfterLoadData.apply(i,arguments)}),this.addHook("beforeOnCellMouseDown",function(){return i.onBeforeOnCellMouseDown.apply(i,arguments)}),this.addHook("afterOnCellMouseDown",function(){return i.onAfterOnCellMouseDown.apply(i,arguments)}),this.addHook("beforeOnCellMouseOver",function(){return i.onBeforeOnCellMouseOver.apply(i,arguments)}),this.addHook("afterGetColumnHeaderRenderers",function(s){return i.onAfterGetColumnHeaderRenderers(s)}),this.addHook("modifyColWidth",function(){return i.onModifyColWidth.apply(i,arguments)}),this.addHook("beforeHighlightingColumnHeader",function(){return i.onBeforeHighlightingColumnHeader.apply(i,arguments)}),this.addHook("afterViewportColumnCalculatorOverride",function(){return i.onAfterViewportColumnCalculatorOverride.apply(i,arguments)}),ps(to(e.prototype),"enablePlugin",this).call(this),this.updatePlugin()}}},{key:"updatePlugin",value:function(){var i=this;if(!!this.hot.view){var o=this.hot.getSettings(),a=o.nestedHeaders;Er(this,Nr).setColumnsLimit(this.hot.countSourceCols()),Array.isArray(a)&&(this.detectedOverlappedHeaders=Er(this,Nr).setState(a)),this.detectedOverlappedHeaders&&tr(Kt(iD||(iD=oD([`Your Nested Headers plugin setup contains overlapping headers. This kind of configuration 
                        is currently not supported.`],[`Your Nested Headers plugin setup contains overlapping headers. This kind of configuration\\x20
                        is currently not supported.`])))),this.enabled&&this.hot.columnIndexMapper.hidingMapsCollection.getMergedValues().forEach(function(s,l){var p=s===!0?"hide-column":"show-column";Er(i,Nr).triggerColumnModification(p,l)}),!Er(this,ta)&&this.enabled&&Um(this,ta,this.hot.columnIndexMapper.createChangesObserver("hiding").subscribe(function(s){s.forEach(function(l){var p=l.op,d=l.index,g=l.newValue;if(p==="replace"){var y=g===!0?"hide-column":"show-column";Er(i,Nr).triggerColumnModification(y,d)}})})),this.ghostTable.buildWidthsMapper(),ps(to(e.prototype),"updatePlugin",this).call(this)}}},{key:"disablePlugin",value:function(){this.clearColspans(),Er(this,Nr).clear(),Er(this,ta).unsubscribe(),Um(this,ta,null),this.ghostTable.clear(),ps(to(e.prototype),"disablePlugin",this).call(this)}},{key:"getStateManager",value:function(){return Er(this,Nr)}},{key:"getLayersCount",value:function(){return Er(this,Nr).getLayersCount()}},{key:"getHeaderSettings",value:function(i,o){return Er(this,Nr).getHeaderSettings(i,o)}},{key:"clearColspans",value:function(){if(!!this.hot.view)for(var i=this.hot.view.wt,o=i.getSetting("columnHeaders").length,a=i.wtTable.THEAD,s=i.wtOverlays.topOverlay.clone.wtTable.THEAD,l=i.wtOverlays.topLeftCornerOverlay?i.wtOverlays.topLeftCornerOverlay.clone.wtTable.THEAD:null,p=0;p<o;p++){var d=a.childNodes[p];if(!d)break;for(var g=s.childNodes[p],y=l?l.childNodes[p]:null,h=0,u=d.childNodes.length;h<u;h++)d.childNodes[h].removeAttribute("colspan"),dt(d.childNodes[h],"hiddenHeader"),g&&g.childNodes[h]&&(g.childNodes[h].removeAttribute("colspan"),dt(g.childNodes[h],"hiddenHeader")),l&&y&&y.childNodes[h]&&(y.childNodes[h].removeAttribute("colspan"),dt(y.childNodes[h],"hiddenHeader"))}}},{key:"headerRendererFactory",value:function(i){var o=this,a=this.hot.view.wt.getSetting("fixedColumnsLeft");return function(s,l){var p,d=o.hot,g=d.rootDocument,y=d.columnIndexMapper,h=d.view,u=y.getVisualFromRenderableIndex(s);u===null&&(u=s),l.removeAttribute("colspan"),dt(l,"hiddenHeader");var f=(p=Er(o,Nr).getHeaderSettings(i,u))!==null&&p!==void 0?p:{label:""},c=f.colspan,v=f.label,m=f.isHidden,b=f.isPlaceholder;if(b||m)Ie(l,"hiddenHeader");else if(c>1){var w,_,C=(w=h.wt.wtOverlays.topLeftCornerOverlay)===null||w===void 0?void 0:w.clone.wtTable.THEAD.contains(l),R=(_=h.wt.wtOverlays.leftOverlay)===null||_===void 0?void 0:_.clone.wtTable.THEAD.contains(l),I=C||R?Math.min(c,a-s):c;I>1&&l.setAttribute("colspan",I)}var P=g.createElement("div"),N=g.createElement("span");Ie(P,"relative"),Ie(N,"colHeader"),Ao(N,v),P.appendChild(N),kn(l),l.appendChild(P),o.hot.runHooks("afterGetColHeader",u,l)}}},{key:"onBeforeHighlightingColumnHeader",value:function(i,o,a){var s=Er(this,Nr).getHeaderTreeNodeData(o,i);if(!s)return i;var l=a.classNames,p=a.columnCursor,d=a.selectionType,g=a.selectionWidth,y=Er(this,Nr).getHeaderSettings(o,i),h=y.isRoot,u=y.colspan;if(d===Nf){if(!h)return s.columnIndex}else d===kp&&(u>g-p||!h)&&(l.length=0);return i}},{key:"onBeforeOnCellMouseDown",value:function(i,o,a,s){var l=this._getHeaderTreeNodeDataByCoords(o);l&&(s.column=!0)}},{key:"onAfterOnCellMouseDown",value:function(i,o){var a=this._getHeaderTreeNodeDataByCoords(o);if(!!a){var s=this.hot.selection,l=s.isSelected()?s.getSelectedRange().current():null,p=[],d=a.columnIndex,g=a.origColspan,y=!s.inInSelection(o);i.shiftKey&&l?o.col<l.from.col?p.push(l.getTopRightCorner().col,d,o.row):o.col>l.from.col?p.push(l.getTopLeftCorner().col,d+g-1,o.row):p.push(d,d+g-1,o.row):(bd(i)||Do(i)&&y)&&p.push(d,d+g-1,o.row),s.selectColumns.apply(s,p)}}},{key:"onBeforeOnCellMouseOver",value:function(i,o,a,s){var l;if(!!this.hot.view.isMouseDown()){var p=this._getHeaderTreeNodeDataByCoords(o);if(!!p){var d=p.columnIndex,g=p.origColspan,y=this.hot.getSelectedRangeLast(),h=y.getTopLeftCorner(),u=y.getBottomRightCorner(),f=y.from;s.column=!0,s.cell=!0;var c=[];o.col<f.col?c.push(u.col,d):o.col>f.col?c.push(h.col,d+g-1):c.push(d,d+g-1),(l=this.hot).selectColumns.apply(l,c)}}}},{key:"onAfterGetColumnHeaderRenderers",value:function(i){if(i){i.length=0;for(var o=0;o<Er(this,Nr).getLayersCount();o++)i.push(this.headerRendererFactory(o))}}},{key:"onAfterViewportColumnCalculatorOverride",value:function(i){for(var o=Er(this,Nr).getLayersCount(),a=i.startColumn,s=!!o,l=0;l<o;l++){var p=Er(this,Nr).findLeftMostColumnIndex(l,i.startColumn),d=this.hot.columnIndexMapper.getRenderableFromVisualIndex(p);if(p>=0&&(s=!1),dn(d)&&d<i.startColumn){a=d;break}}i.startColumn=s?Er(this,Nr).getHeaderTreeNodeData(0,a).columnIndex:a}},{key:"onModifyColWidth",value:function(i,o){var a=this.ghostTable.widthsCache[o];return i>a?i:a}},{key:"onInit",value:function(){this.updatePlugin()}},{key:"onAfterLoadData",value:function(i,o){o||this.updatePlugin()}},{key:"destroy",value:function(){Um(this,Nr,null),Er(this,ta)!==null&&(Er(this,ta).unsubscribe(),Um(this,ta,null)),ps(to(e.prototype),"destroy",this).call(this)}},{key:"_getHeaderTreeNodeDataByCoords",value:function(i){if(!(i.row>=0||i.col<0))return Er(this,Nr).getHeaderTreeNodeData(i.row,i.col)}}],[{key:"PLUGIN_KEY",get:function(){return fD}},{key:"PLUGIN_PRIORITY",get:function(){return UTe}}]),e}(Lt);function cD(t){return qTe(t)||KTe(t)||GTe(t)||YTe()}function YTe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function GTe(t,r){if(!!t){if(typeof t=="string")return Ok(t,r);var e=Object.prototype.toString.call(t).slice(8,-1);if(e==="Object"&&t.constructor&&(e=t.constructor.name),e==="Map"||e==="Set")return Array.from(t);if(e==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return Ok(t,r)}}function KTe(t){if(typeof Symbol!="undefined"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function qTe(t){if(Array.isArray(t))return Ok(t)}function Ok(t,r){(r==null||r>t.length)&&(r=t.length);for(var e=0,n=new Array(r);e<r;e++)n[e]=t[e];return n}function zm(t){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?zm=function(e){return typeof e}:zm=function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},zm(t)}function XTe(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}function hD(t,r){for(var e=0;e<r.length;e++){var n=r[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function ZTe(t,r,e){return r&&hD(t.prototype,r),e&&hD(t,e),t}var JTe=function(){function t(r,e){XTe(this,t),this.hot=e,this.data=null,this.plugin=r,this.parentReference=new WeakMap,this.cache={levels:[],levelCount:0,rows:[],nodeInfo:new WeakMap}}return ZTe(t,[{key:"setData",value:function(e){this.data=e}},{key:"getData",value:function(){return this.data}},{key:"getRawSourceData",value:function(){var e=null;return this.plugin.disableCoreAPIModifiers(),e=this.hot.getSourceData(),this.plugin.enableCoreAPIModifiers(),e}},{key:"updateWithData",value:function(e){this.setData(e),this.rewriteCache()}},{key:"rewriteCache",value:function(){var e=this;this.cache={levels:[],levelCount:0,rows:[],nodeInfo:new WeakMap},Qe(0,this.data.length-1,function(n){e.cacheNode(e.data[n],0,null)})}},{key:"cacheNode",value:function(e,n,i){var o=this;this.cache.levels[n]||(this.cache.levels[n]=[],this.cache.levelCount+=1),this.cache.levels[n].push(e),this.cache.rows.push(e),this.cache.nodeInfo.set(e,{parent:i,row:this.cache.rows.length-1,level:n}),this.hasChildren(e)&&he(e.__children,function(a){o.cacheNode(a,n+1,e)})}},{key:"getDataObject",value:function(e){return e==null?null:this.cache.rows[e]}},{key:"readTreeNodes",value:function(e,n,i,o){var a=this,s=!1,l=n;if(isNaN(l)&&l.end)return l;var p=e;return p||(p={__children:this.data},s=!0,l-=1),i!=null&&l===i?{result:p,end:!0}:o!=null&&p===o?{result:l,end:!0}:(l+=1,p.__children&&he(p.__children,function(d){if(a.parentReference.set(d,s?null:p),l=a.readTreeNodes(d,l,i,o),isNaN(l)&&l.end)return!1}),l)}},{key:"mockParent",value:function(){var e=this.mockNode();return e.__children=this.data,e}},{key:"mockNode",value:function(){var e={};return Ot(this.data[0],function(n,i){e[i]=null}),e}},{key:"getRowIndex",value:function(e){return e==null?null:this.cache.nodeInfo.get(e).row}},{key:"getRowIndexWithinParent",value:function(e){var n=null;isNaN(e)?n=e:n=this.getDataObject(e);var i=this.getRowParent(e);return i==null?this.data.indexOf(n):i.__children.indexOf(n)}},{key:"countAllRows",value:function(){var e={__children:this.data};return this.countChildren(e)}},{key:"countChildren",value:function(e){var n=this,i=0,o=e;return isNaN(o)||(o=this.getDataObject(o)),!o||!o.__children?0:(he(o.__children,function(a){i+=1,a.__children&&(i+=n.countChildren(a))}),i)}},{key:"getRowParent",value:function(e){var n;return isNaN(e)?n=e:n=this.getDataObject(e),this.getRowObjectParent(n)}},{key:"getRowObjectParent",value:function(e){return!e||zm(e)!=="object"?null:this.cache.nodeInfo.get(e).parent}},{key:"getRowLevel",value:function(e){var n=null;return isNaN(e)?n=e:n=this.getDataObject(e),n?this.getRowObjectLevel(n):null}},{key:"getRowObjectLevel",value:function(e){return e==null?null:this.cache.nodeInfo.get(e).level}},{key:"hasChildren",value:function(e){var n=e;return isNaN(n)||(n=this.getDataObject(n)),!!(n.__children&&n.__children.length)}},{key:"isChild",value:function(e){return this.getRowParent(e)!==null}},{key:"getChild",value:function(e,n){var i;return((i=e.__children)===null||i===void 0?void 0:i[n])||null}},{key:"isRowHighestLevel",value:function(e){return!this.isChild(e)}},{key:"isParent",value:function(e){var n,i=e;return isNaN(i)||(i=this.getDataObject(i)),i&&!!i.__children&&((n=i.__children)===null||n===void 0?void 0:n.length)!==0}},{key:"addChild",value:function(e,n){var i=n;this.hot.runHooks("beforeAddChild",e,i);var o=null;e&&(o=this.getRowIndex(e)),this.hot.runHooks("beforeCreateRow",o+this.countChildren(e)+1,1);var a=e;e||(a=this.mockParent()),a.__children||(a.__children=[]),i||(i=this.mockNode()),a.__children.push(i),this.rewriteCache();var s=this.getRowIndex(i);this.hot.rowIndexMapper.insertIndexes(s,1),this.hot.runHooks("afterCreateRow",s,1),this.hot.runHooks("afterAddChild",e,i)}},{key:"addChildAtIndex",value:function(e,n,i){var o=i,a;if(o||(o=this.mockNode()),this.hot.runHooks("beforeAddChild",e,o,n),e){var s=this.getRowIndex(e),l=s+n+1;this.hot.runHooks("beforeCreateRow",l,1),e.__children.splice(n,null,o),this.rewriteCache(),this.plugin.disableCoreAPIModifiers(),this.hot.setSourceDataAtCell(this.getRowIndexWithinParent(e),"__children",e.__children,"NestedRows.addChildAtIndex"),this.hot.rowIndexMapper.insertIndexes(l,1),this.plugin.enableCoreAPIModifiers(),this.hot.runHooks("afterCreateRow",l,1),a=l}else this.plugin.disableCoreAPIModifiers(),this.hot.alter("insert_row",n,1,"NestedRows.addChildAtIndex"),this.plugin.enableCoreAPIModifiers(),a=this.getRowIndex(this.data[n]);o=this.getDataObject(a),this.hot.runHooks("afterAddChild",e,o,n)}},{key:"addSibling",value:function(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"below",i=this.translateTrimmedRow(e),o=this.getRowParent(i),a=this.getRowIndexWithinParent(i);switch(n){case"below":this.addChildAtIndex(o,a+1,null);break;case"above":this.addChildAtIndex(o,a,null);break}}},{key:"detachFromParent",value:function(e){var n=this,i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,o=null,a=[];Array.isArray(e)?(Qe(e[0],e[2],function(v){var m=n.translateTrimmedRow(v);a.push(n.getDataObject(m))}),Qe(0,a.length-2,function(v){n.detachFromParent(a[v],!1)}),o=a[a.length-1]):o=e;var s=this.getRowIndex(o),l=this.countChildren(o),p=this.getRowIndexWithinParent(o),d=this.getRowParent(o),g=this.getRowParent(d),y=this.getRowIndex(g),h=null;if(this.hot.runHooks("beforeDetachChild",d,o),p!=null){var u=Array.from(new Array(s+l+1).keys()).splice(-1*(l+1));if(this.hot.runHooks("beforeRemoveRow",s,l+1,u,this.plugin.pluginName),d.__children.splice(p,1),this.rewriteCache(),this.hot.runHooks("afterRemoveRow",s,l+1,u,this.plugin.pluginName),g){h=y+this.countChildren(g);var f=this.getChild(g,this.countChildren(g)-1),c=this.getRowIndex(f);this.hot.runHooks("beforeCreateRow",c+1,l+1,this.plugin.pluginName),g.__children.push(o)}else h=this.hot.countRows()+1,this.hot.runHooks("beforeCreateRow",h-2,l+1,this.plugin.pluginName),this.data.push(o)}this.rewriteCache(),this.hot.runHooks("afterCreateRow",h-2,l+1,this.plugin.pluginName),this.hot.runHooks("afterDetachChild",d,o,this.getRowIndex(o)),i&&this.hot.render()}},{key:"filterData",value:function(e,n,i){var o=this,a=[];he(i,function(s){a.push(o.getDataObject(s))}),he(a,function(s){var l=o.getRowIndexWithinParent(s),p=o.getRowParent(s);p===null?o.data.splice(l,1):p.__children.splice(l,1)}),this.rewriteCache()}},{key:"spliceData",value:function(e,n,i){var o=this.getDataObject(e-1),a=null,s=e;if(o&&o.__children&&o.__children.length===0?(a=o,s=0):e<this.countAllRows()&&(a=this.getRowParent(e),s=this.getRowIndexWithinParent(e)),a)if(i){var l;(l=a.__children).splice.apply(l,[s,n].concat(cD(i)))}else a.__children.splice(s,n);else if(i){var p;(p=this.data).splice.apply(p,[s,n].concat(cD(i)))}else this.data.splice(s,n);this.rewriteCache()}},{key:"syncRowWithRawSource",value:function(e){var n=e,i=null;do i=this.getRowParent(i),i!==null&&(n=i);while(i!==null);this.plugin.disableCoreAPIModifiers(),this.hot.setSourceDataAtCell(this.getRowIndex(n),"__children",n.__children,"NestedRows.syncRowWithRawSource"),this.plugin.enableCoreAPIModifiers()}},{key:"moveRow",value:function(e,n,i,o){var a=n===this.hot.countRows(),s=this.getRowParent(e),l=this.getRowIndexWithinParent(e),p=s.__children.slice(l,l+1),d=e>n,g=a?this.getRowParent(n-1):this.getRowParent(n);g==null&&(g=this.getRowParent(n-1)),g==null&&(g=this.getDataObject(n-1)),g?g.__children||(g.__children=[]):(g=this.getDataObject(n),g.__children=[]);var y=a||i||o?g.__children.length:this.getRowIndexWithinParent(n),h=s===g;g.__children.splice(y,0,p[0]),s.__children.splice(l+(d&&h?1:0),1),this.syncRowWithRawSource(s),h||this.syncRowWithRawSource(g)}},{key:"translateTrimmedRow",value:function(e){return this.plugin.collapsingUI?this.plugin.collapsingUI.translateTrimmedRow(e):e}},{key:"untranslateTrimmedRow",value:function(e){return this.plugin.collapsingUI?this.plugin.collapsingUI.untranslateTrimmedRow(e):e}}]),t}(),QTe=JTe;function exe(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}var txe=function t(r,e){exe(this,t),this.hot=e,this.plugin=r},Rk=txe;function Ym(t){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?Ym=function(e){return typeof e}:Ym=function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ym(t)}function rxe(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}function dD(t,r){for(var e=0;e<r.length;e++){var n=r[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function nxe(t,r,e){return r&&dD(t.prototype,r),e&&dD(t,e),t}function ixe(t,r){if(typeof r!="function"&&r!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(r&&r.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),r&&Ek(t,r)}function Ek(t,r){return Ek=Object.setPrototypeOf||function(n,i){return n.__proto__=i,n},Ek(t,r)}function oxe(t){var r=uxe();return function(){var n=Gm(t),i;if(r){var o=Gm(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return axe(this,i)}}function axe(t,r){if(r&&(Ym(r)==="object"||typeof r=="function"))return r;if(r!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return sxe(t)}function sxe(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function uxe(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Gm(t){return Gm=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},Gm(t)}var lxe=function(t){ixe(e,t);var r=oxe(e);function e(n,i){var o;return rxe(this,e),o=r.call(this,n,i),o.dataManager=o.plugin.dataManager,o.collapsingUI=o.plugin.collapsingUI,o.rowHeaderWidthCache=null,o}return nxe(e,[{key:"appendLevelIndicators",value:function(i,o){var a=this.hot.toPhysicalRow(i),s=this.dataManager.getRowLevel(a),l=this.dataManager.getDataObject(a),p=o.getElementsByTagName("DIV")[0],d=p.querySelector("span.rowHeader"),g=p.querySelectorAll('[class^="ht_nesting"]');if(he(g,function(f){f&&p.removeChild(f)}),Ie(o,e.CSS_CLASSES.indicatorContainer),s){var y=this.hot.rootDocument,h=d.cloneNode(!0);p.innerHTML="",Qe(0,s-1,function(){var f=y.createElement("SPAN");Ie(f,e.CSS_CLASSES.emptyIndicator),p.appendChild(f)}),p.appendChild(h)}if(this.dataManager.hasChildren(l)){var u=this.hot.rootDocument.createElement("DIV");Ie(o,e.CSS_CLASSES.parent),this.collapsingUI.areChildrenCollapsed(a)?Ie(u,"".concat(e.CSS_CLASSES.button," ").concat(e.CSS_CLASSES.expandButton)):Ie(u,"".concat(e.CSS_CLASSES.button," ").concat(e.CSS_CLASSES.collapseButton)),p.appendChild(u)}}},{key:"updateRowHeaderWidth",value:function(i){var o=i;o||(o=this.dataManager.cache.levelCount),this.rowHeaderWidthCache=Math.max(50,11+10*o+25),this.hot.render()}}],[{key:"CSS_CLASSES",get:function(){return{indicatorContainer:"ht_nestingLevels",parent:"ht_nestingParent",indicator:"ht_nestingLevel",emptyIndicator:"ht_nestingLevel_empty",button:"ht_nestingButton",expandButton:"ht_nestingExpand",collapseButton:"ht_nestingCollapse"}}}]),e}(Rk),pD=lxe;function Km(t){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?Km=function(e){return typeof e}:Km=function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Km(t)}function yD(t){return dxe(t)||hxe(t)||cxe(t)||fxe()}function fxe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function cxe(t,r){if(!!t){if(typeof t=="string")return Tk(t,r);var e=Object.prototype.toString.call(t).slice(8,-1);if(e==="Object"&&t.constructor&&(e=t.constructor.name),e==="Map"||e==="Set")return Array.from(t);if(e==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return Tk(t,r)}}function hxe(t){if(typeof Symbol!="undefined"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function dxe(t){if(Array.isArray(t))return Tk(t)}function Tk(t,r){(r==null||r>t.length)&&(r=t.length);for(var e=0,n=new Array(r);e<r;e++)n[e]=t[e];return n}function pxe(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}function mD(t,r){for(var e=0;e<r.length;e++){var n=r[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function yxe(t,r,e){return r&&mD(t.prototype,r),e&&mD(t,e),t}function mxe(t,r){if(typeof r!="function"&&r!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(r&&r.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),r&&xk(t,r)}function xk(t,r){return xk=Object.setPrototypeOf||function(n,i){return n.__proto__=i,n},xk(t,r)}function vxe(t){var r=wxe();return function(){var n=qm(t),i;if(r){var o=qm(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return gxe(this,i)}}function gxe(t,r){if(r&&(Km(r)==="object"||typeof r=="function"))return r;if(r!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return bxe(t)}function bxe(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function wxe(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function qm(t){return qm=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},qm(t)}var _xe=function(t){mxe(e,t);var r=vxe(e);function e(n,i){var o;return pxe(this,e),o=r.call(this,n,i),o.dataManager=o.plugin.dataManager,o.collapsedRows=[],o.collapsedRowsStash={stash:function(){var s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;o.lastCollapsedRows=o.collapsedRows.slice(0),o.expandMultipleChildren(o.lastCollapsedRows,s)},shiftStash:function(s,l){var p=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1;l==null&&(l=1/0),he(o.lastCollapsedRows,function(d,g){d>=s&&d<l&&(o.lastCollapsedRows[g]=d+p)})},applyStash:function(){var s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;o.collapseMultipleChildren(o.lastCollapsedRows,s),o.lastCollapsedRows=void 0},trimStash:function(s,l){Qe(s,s+l-1,function(p){var d=o.lastCollapsedRows.indexOf(p);d>-1&&o.lastCollapsedRows.splice(d,1)})}},o}return yxe(e,[{key:"collapseChildren",value:function(i){var o=this,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,l=[],p=null,d=null,g=null;return isNaN(i)?(p=i,d=this.dataManager.getRowIndex(p)):(p=this.dataManager.getDataObject(i),d=i),this.dataManager.hasChildren(p)&&he(p.__children,function(y){l.push(o.dataManager.getRowIndex(y))}),g=this.collapseRows(l,!0,!1),s&&this.trimRows(g),a&&this.renderAndAdjust(),this.collapsedRows.indexOf(d)===-1&&this.collapsedRows.push(d),g}},{key:"collapseMultipleChildren",value:function(i){var o=this,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,l=[];he(i,function(p){l.push.apply(l,yD(o.collapseChildren(p,!1,!1)))}),s&&this.trimRows(l),a&&this.renderAndAdjust()}},{key:"collapseRow",value:function(i){var o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;this.collapseRows([i],o)}},{key:"collapseRows",value:function(i){var o=this,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,l=[];return he(i,function(p){l.push(p),a&&o.collapseChildRows(p,l)}),s&&this.trimRows(l),l}},{key:"collapseChildRows",value:function(i){var o=this,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(this.dataManager.hasChildren(i)){var l=this.dataManager.getDataObject(i);he(l.__children,function(p){var d=o.dataManager.getRowIndex(p);a.push(d),o.collapseChildRows(d,a)})}s&&this.trimRows(a)}},{key:"expandRow",value:function(i){var o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;this.expandRows([i],o)}},{key:"expandRows",value:function(i){var o=this,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,l=[];return he(i,function(p){l.push(p),a&&o.expandChildRows(p,l)}),s&&this.untrimRows(l),l}},{key:"expandChildRows",value:function(i){var o=this,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(this.dataManager.hasChildren(i)){var l=this.dataManager.getDataObject(i);he(l.__children,function(p){if(!o.isAnyParentCollapsed(p)){var d=o.dataManager.getRowIndex(p);a.push(d),o.expandChildRows(d,a)}})}s&&this.untrimRows(a)}},{key:"expandChildren",value:function(i){var o=this,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,l=[],p=null,d=null,g=null;return isNaN(i)?(p=i,d=this.dataManager.getRowIndex(i)):(p=this.dataManager.getDataObject(i),d=i),this.collapsedRows.splice(this.collapsedRows.indexOf(d),1),this.dataManager.hasChildren(p)&&he(p.__children,function(y){var h=o.dataManager.getRowIndex(y);l.push(h)}),g=this.expandRows(l,!0,!1),s&&this.untrimRows(g),a&&this.renderAndAdjust(),g}},{key:"expandMultipleChildren",value:function(i){var o=this,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,l=[];he(i,function(p){l.push.apply(l,yD(o.expandChildren(p,!1,!1)))}),s&&this.untrimRows(l),a&&this.renderAndAdjust()}},{key:"collapseAll",value:function(){var i=this,o=this.dataManager.getData(),a=[];he(o,function(s){i.dataManager.hasChildren(s)&&a.push(s)}),this.collapseMultipleChildren(a),this.renderAndAdjust()}},{key:"expandAll",value:function(){var i=this,o=this.dataManager.getData(),a=[];he(o,function(s){i.dataManager.hasChildren(s)&&a.push(s)}),this.expandMultipleChildren(a),this.renderAndAdjust()}},{key:"trimRows",value:function(i){var o=this;this.hot.batchExecution(function(){he(i,function(a){o.plugin.collapsedRowsMap.setValueAtIndex(a,!0)})},!0)}},{key:"untrimRows",value:function(i){var o=this;this.hot.batchExecution(function(){he(i,function(a){o.plugin.collapsedRowsMap.setValueAtIndex(a,!1)})},!0)}},{key:"areChildrenCollapsed",value:function(i){var o=this,a=isNaN(i)?i:this.dataManager.getDataObject(i),s=!0;return a===null&&(a={__children:this.dataManager.data}),this.dataManager.hasChildren(a)&&he(a.__children,function(l){var p=o.dataManager.getRowIndex(l);if(!o.plugin.collapsedRowsMap.getValueAtIndex(p))return s=!1,!1}),s}},{key:"isAnyParentCollapsed",value:function(i){for(var o=i;o!==null;){o=this.dataManager.getRowParent(o);var a=this.dataManager.getRowIndex(o);if(this.collapsedRows.indexOf(a)>-1)return!0}return!1}},{key:"toggleState",value:function(i,o){if(!(o.col>=0)){var a=this.translateTrimmedRow(o.row);lt(i.target,pD.CSS_CLASSES.button)&&(this.areChildrenCollapsed(a)?this.expandChildren(a):this.collapseChildren(a),rr(i))}}},{key:"translateTrimmedRow",value:function(i){return this.hot.toPhysicalRow(i)}},{key:"untranslateTrimmedRow",value:function(i){return this.hot.toVisualRow(i)}},{key:"renderAndAdjust",value:function(){this.hot.render(),this.hot.view.adjustElementsSize()}}]),e}(Rk),Sxe=_xe;function Xm(t){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?Xm=function(e){return typeof e}:Xm=function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Xm(t)}function Cxe(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}function vD(t,r){for(var e=0;e<r.length;e++){var n=r[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function kxe(t,r,e){return r&&vD(t.prototype,r),e&&vD(t,e),t}function Oxe(t,r){if(typeof r!="function"&&r!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(r&&r.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),r&&Ak(t,r)}function Ak(t,r){return Ak=Object.setPrototypeOf||function(n,i){return n.__proto__=i,n},Ak(t,r)}function Rxe(t){var r=Txe();return function(){var n=Zm(t),i;if(r){var o=Zm(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return Exe(this,i)}}function Exe(t,r){if(r&&(Xm(r)==="object"||typeof r=="function"))return r;if(r!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return gD(t)}function gD(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Txe(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Zm(t){return Zm=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},Zm(t)}var bD=new WeakMap,xxe=function(t){Oxe(e,t);var r=Rxe(e);function e(n,i){var o;return Cxe(this,e),o=r.call(this,n,i),bD.set(gD(o),{row_above:function(s,l){var p=l[l.length-1];o.dataManager.addSibling(p.start.row,"above")},row_below:function(s,l){var p=l[l.length-1];o.dataManager.addSibling(p.start.row,"below")}}),o.dataManager=o.plugin.dataManager,o}return kxe(e,[{key:"appendOptions",value:function(i){var o=this,a=[{key:"add_child",name:function(){return this.getTranslatedPhrase(Y1)},callback:function(){var l=o.dataManager.translateTrimmedRow(o.hot.getSelectedLast()[0]),p=o.dataManager.getDataObject(l);o.dataManager.addChild(p)},disabled:function(){var l=o.hot.getSelectedLast();return!l||l[0]<0||o.hot.selection.isSelectedByColumnHeader()||o.hot.countRows()>=o.hot.getSettings().maxRows}},{key:"detach_from_parent",name:function(){return this.getTranslatedPhrase(G1)},callback:function(){o.dataManager.detachFromParent(o.hot.getSelectedLast())},disabled:function(){var l=o.hot.getSelectedLast(),p=o.dataManager.translateTrimmedRow(l[0]),d=o.dataManager.getRowParent(p);return!d||!l||l[0]<0||o.hot.selection.isSelectedByColumnHeader()||o.hot.countRows()>=o.hot.getSettings().maxRows}},{name:"---------"}];return Qe(0,i.items.length-1,function(s){if(s===0)return he(a,function(l,p){i.items.splice(s+p,0,l)}),!1}),this.modifyRowInsertingOptions(i)}},{key:"modifyRowInsertingOptions",value:function(i){var o=bD.get(this);return Qe(0,i.items.length-1,function(a){var s=o[i.items[a].key];s!=null&&(i.items[a].callback=s)}),i}}]),e}(Rk),Axe=xxe,wD;function _D(t){return Dxe(t)||Ixe(t)||Pxe(t)||Mxe()}function Mxe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Pxe(t,r){if(!!t){if(typeof t=="string")return Mk(t,r);var e=Object.prototype.toString.call(t).slice(8,-1);if(e==="Object"&&t.constructor&&(e=t.constructor.name),e==="Map"||e==="Set")return Array.from(t);if(e==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return Mk(t,r)}}function Ixe(t){if(typeof Symbol!="undefined"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function Dxe(t){if(Array.isArray(t))return Mk(t)}function Mk(t,r){(r==null||r>t.length)&&(r=t.length);for(var e=0,n=new Array(r);e<r;e++)n[e]=t[e];return n}function Nxe(t,r){return r||(r=t.slice(0)),Object.freeze(Object.defineProperties(t,{raw:{value:Object.freeze(r)}}))}function $xe(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}function SD(t,r){for(var e=0;e<r.length;e++){var n=r[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function jxe(t,r,e){return r&&SD(t.prototype,r),e&&SD(t,e),t}var Lxe=function(){function t(r){$xe(this,t),this.plugin=r,this.hot=r.hot,this.dataManager=r.dataManager,this.collapsingUI=r.collapsingUI}return jxe(t,[{key:"onBeforeRowMove",value:function(e,n,i,o){var a=this,s=this.displayAPICompatibilityWarning({rows:e,finalIndex:n,dropIndex:i,movePossible:o});if(s)return!1;this.movedToCollapsed=!1;var l=i===this.hot.countRows(),p=l?this.hot.countSourceRows():this.dataManager.translateTrimmedRow(i),d=!0,g=e.map(function(c){if(!d)return!1;var v=a.dataManager.translateTrimmedRow(c);return d=a.shouldAllowMoving(v,p),v}),y=g.indexOf(p)===-1;if(!d||!y)return!1;var h=this.getBaseParent(g),u=this.getTargetParent(l,p),f=h===u;return this.movedToCollapsed=this.collapsingUI.areChildrenCollapsed(u),this.collapsingUI.collapsedRowsStash.stash(),this.shiftCollapsibleParentsLocations(g,p,f),this.moveRows(g,p,u),this.dataManager.rewriteCache(),this.moveCellsMeta(g,p),this.collapsingUI.collapsedRowsStash.applyStash(!1),this.hot.runHooks("afterRowMove",e,n,i,o,o&&this.isRowOrderChanged(e,n)),this.hot.render(),this.selectCells(e,i),!1}},{key:"displayAPICompatibilityWarning",value:function(e){var n=e.rows,i=e.finalIndex,o=e.dropIndex,a=e.movePossible,s=!1;return er(o)&&(tr(Kt(wD||(wD=Nxe([`Since version 8.0.0 of the Handsontable the 'moveRows' method isn't used for moving rows 
      when the NestedRows plugin is enabled. Please use the 'dragRows' method instead.`],[`Since version 8.0.0 of the Handsontable the 'moveRows' method isn't used for moving rows\\x20
      when the NestedRows plugin is enabled. Please use the 'dragRows' method instead.`])))),this.hot.runHooks("afterRowMove",n,i,o,a,!1),s=!0),s}},{key:"shouldAllowMoving",value:function(e,n){return!(this.dataManager.isParent(e)||this.dataManager.isRowHighestLevel(e)||e===n||n===0)}},{key:"getBaseParent",value:function(e){return this.dataManager.getRowParent(e[0])}},{key:"getTargetParent",value:function(e,n){var i=this.dataManager.getRowParent(e?n-1:n);return i==null&&(i=this.dataManager.getRowParent(n-1)),i}},{key:"shiftCollapsibleParentsLocations",value:function(e,n,i){i||(Math.max.apply(Math,_D(e))<=n?this.collapsingUI.collapsedRowsStash.shiftStash(e[0],n,-1*e.length):this.collapsingUI.collapsedRowsStash.shiftStash(n,e[0],e.length))}},{key:"moveRows",value:function(e,n,i){var o=this,a=n===this.dataManager.getRowIndex(i)+this.dataManager.countChildren(i)+1;this.hot.batchRender(function(){e.forEach(function(s){o.dataManager.moveRow(s,n,o.movedToCollapsed,a)})})}},{key:"moveCellsMeta",value:function(e,n){var i=this,o,a=[],s=Math.max.apply(Math,_D(e))<n;e.forEach(function(l){a.push(i.hot.getCellMetaAtRow(l))}),this.hot.spliceCellsMeta(e[0],e.length),(o=this.hot).spliceCellsMeta.apply(o,[n-(s?a.length:0),0].concat(a))}},{key:"selectCells",value:function(e,n){var i=e.length,o=0,a=0,s=null,l=null;if(this.movedToCollapsed){var p=null;e[i-1]<n?p=this.dataManager.translateTrimmedRow(n-i):p=this.dataManager.translateTrimmedRow(n);var d=this.dataManager.getRowParent(p===null?this.hot.countSourceRows()-1:p-1),g=this.dataManager.getRowIndex(d);o=this.dataManager.untranslateTrimmedRow(g),a=o}else e[i-1]<n?(a=n-1,o=a-i+1):(o=n,a=o+i-1);s=this.hot.selection,l=this.hot.countCols()-1,s.setRangeStart(new ke(o,0)),s.setRangeEnd(new ke(a,l),!0)}},{key:"isRowOrderChanged",value:function(e,n){return e.some(function(i,o){return i-o!==n})}}]),t}();function Jm(t){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?Jm=function(e){return typeof e}:Jm=function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Jm(t)}function CD(t){return Vxe(t)||Bxe(t)||Fxe(t)||Hxe()}function Hxe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Fxe(t,r){if(!!t){if(typeof t=="string")return Pk(t,r);var e=Object.prototype.toString.call(t).slice(8,-1);if(e==="Object"&&t.constructor&&(e=t.constructor.name),e==="Map"||e==="Set")return Array.from(t);if(e==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return Pk(t,r)}}function Bxe(t){if(typeof Symbol!="undefined"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function Vxe(t){if(Array.isArray(t))return Pk(t)}function Pk(t,r){(r==null||r>t.length)&&(r=t.length);for(var e=0,n=new Array(r);e<r;e++)n[e]=t[e];return n}function Wxe(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}function kD(t,r){for(var e=0;e<r.length;e++){var n=r[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function Uxe(t,r,e){return r&&kD(t.prototype,r),e&&kD(t,e),t}function ys(){return typeof Reflect!="undefined"&&Reflect.get?ys=Reflect.get:ys=function(r,e,n){var i=zxe(r,e);if(!!i){var o=Object.getOwnPropertyDescriptor(i,e);return o.get?o.get.call(arguments.length<3?r:n):o.value}},ys.apply(this,arguments)}function zxe(t,r){for(;!Object.prototype.hasOwnProperty.call(t,r)&&(t=ro(t),t!==null););return t}function Yxe(t,r){if(typeof r!="function"&&r!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(r&&r.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),r&&Ik(t,r)}function Ik(t,r){return Ik=Object.setPrototypeOf||function(n,i){return n.__proto__=i,n},Ik(t,r)}function Gxe(t){var r=qxe();return function(){var n=ro(t),i;if(r){var o=ro(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return Kxe(this,i)}}function Kxe(t,r){if(r&&(Jm(r)==="object"||typeof r=="function"))return r;if(r!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return OD(t)}function OD(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function qxe(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function ro(t){return ro=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},ro(t)}var RD="nestedRows",Xxe=300,no=new WeakMap,Zxe="The Nested Rows plugin requires an Array of Objects as a dataset to be provided. The plugin has been disabled.",Jxe=function(t){Yxe(e,t);var r=Gxe(e);function e(n){var i;return Wxe(this,e),i=r.call(this,n),i.dataManager=null,i.headersUI=null,i.collapsedRowsMap=null,no.set(OD(i),{movedToCollapsed:!1,skipRender:null,skipCoreAPIModifiers:!1}),i}return Uxe(e,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[RD]}},{key:"enablePlugin",value:function(){var i=this;this.enabled||(this.collapsedRowsMap=this.hot.rowIndexMapper.registerMap("nestedRows",new xf),this.dataManager=new QTe(this,this.hot),this.collapsingUI=new Sxe(this,this.hot),this.headersUI=new pD(this,this.hot),this.contextMenuUI=new Axe(this,this.hot),this.rowMoveController=new Lxe(this),this.addHook("afterInit",function(){return i.onAfterInit.apply(i,arguments)}),this.addHook("beforeViewRender",function(){return i.onBeforeViewRender.apply(i,arguments)}),this.addHook("modifyRowData",function(){return i.onModifyRowData.apply(i,arguments)}),this.addHook("modifySourceLength",function(){return i.onModifySourceLength.apply(i,arguments)}),this.addHook("beforeDataSplice",function(){return i.onBeforeDataSplice.apply(i,arguments)}),this.addHook("filterData",function(){return i.onFilterData.apply(i,arguments)}),this.addHook("afterContextMenuDefaultOptions",function(){return i.onAfterContextMenuDefaultOptions.apply(i,arguments)}),this.addHook("afterGetRowHeader",function(){return i.onAfterGetRowHeader.apply(i,arguments)}),this.addHook("beforeOnCellMouseDown",function(){return i.onBeforeOnCellMouseDown.apply(i,arguments)}),this.addHook("beforeRemoveRow",function(){return i.onBeforeRemoveRow.apply(i,arguments)}),this.addHook("afterRemoveRow",function(){return i.onAfterRemoveRow.apply(i,arguments)}),this.addHook("beforeAddChild",function(){return i.onBeforeAddChild.apply(i,arguments)}),this.addHook("afterAddChild",function(){return i.onAfterAddChild.apply(i,arguments)}),this.addHook("beforeDetachChild",function(){return i.onBeforeDetachChild.apply(i,arguments)}),this.addHook("afterDetachChild",function(){return i.onAfterDetachChild.apply(i,arguments)}),this.addHook("modifyRowHeaderWidth",function(){return i.onModifyRowHeaderWidth.apply(i,arguments)}),this.addHook("afterCreateRow",function(){return i.onAfterCreateRow.apply(i,arguments)}),this.addHook("beforeRowMove",function(){return i.onBeforeRowMove.apply(i,arguments)}),this.addHook("beforeLoadData",function(o){return i.onBeforeLoadData(o)}),ys(ro(e.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){this.hot.rowIndexMapper.unregisterMap("nestedRows"),ys(ro(e.prototype),"disablePlugin",this).call(this)}},{key:"updatePlugin",value:function(){this.disablePlugin();var i=this.dataManager.getData();this.enablePlugin(),this.dataManager.updateWithData(i),ys(ro(e.prototype),"updatePlugin",this).call(this)}},{key:"onBeforeRowMove",value:function(i,o,a,s){return this.rowMoveController.onBeforeRowMove(i,o,a,s)}},{key:"disableCoreAPIModifiers",value:function(){var i=no.get(this);i.skipCoreAPIModifiers=!0}},{key:"enableCoreAPIModifiers",value:function(){var i=no.get(this);i.skipCoreAPIModifiers=!1}},{key:"onBeforeOnCellMouseDown",value:function(i,o,a){this.collapsingUI.toggleState(i,o,a)}},{key:"onModifyRowData",value:function(i){var o=no.get(this);if(!o.skipCoreAPIModifiers)return this.dataManager.getDataObject(i)}},{key:"onModifySourceLength",value:function(){var i=no.get(this);if(!i.skipCoreAPIModifiers)return this.dataManager.countAllRows()}},{key:"onBeforeDataSplice",value:function(i,o,a){var s=no.get(this);return s.skipCoreAPIModifiers||this.dataManager.isRowHighestLevel(i)?!0:(this.dataManager.spliceData(i,o,a),!1)}},{key:"onFilterData",value:function(i,o,a){var s=no.get(this);return this.collapsingUI.collapsedRowsStash.stash(),this.collapsingUI.collapsedRowsStash.trimStash(a[0],o),this.collapsingUI.collapsedRowsStash.shiftStash(a[0],null,-1*o),this.dataManager.filterData(i,o,a),s.skipRender=!0,this.dataManager.getData().slice()}},{key:"onAfterContextMenuDefaultOptions",value:function(i){return this.contextMenuUI.appendOptions(i)}},{key:"onAfterGetRowHeader",value:function(i,o){this.headersUI.appendLevelIndicators(i,o)}},{key:"onModifyRowHeaderWidth",value:function(i){return this.headersUI.rowHeaderWidthCache||i}},{key:"onAfterRemoveRow",value:function(i,o,a,s){var l=this;if(s!==this.pluginName){var p=no.get(this);setTimeout(function(){p.skipRender=null,l.headersUI.updateRowHeaderWidth(),l.collapsingUI.collapsedRowsStash.applyStash()},0)}}},{key:"onBeforeRemoveRow",value:function(i,o,a){var s=this,l=Array.from(a.reduce(function(p,d){if(s.dataManager.isParent(d)){var g=s.dataManager.getDataObject(d).__children;return p.add(d),Array.isArray(g)&&g.forEach(function(y){return p.add(s.dataManager.getRowIndex(y))}),p}return p.add(d)},new Set));a.length=0,a.push.apply(a,CD(l))}},{key:"onBeforeAddChild",value:function(){this.collapsingUI.collapsedRowsStash.stash()}},{key:"onAfterAddChild",value:function(i,o){this.collapsingUI.collapsedRowsStash.shiftStash(this.dataManager.getRowIndex(o)),this.collapsingUI.collapsedRowsStash.applyStash(),this.headersUI.updateRowHeaderWidth()}},{key:"onBeforeDetachChild",value:function(){this.collapsingUI.collapsedRowsStash.stash()}},{key:"onAfterDetachChild",value:function(i,o,a){this.collapsingUI.collapsedRowsStash.shiftStash(a,null,-1),this.collapsingUI.collapsedRowsStash.applyStash(),this.headersUI.updateRowHeaderWidth()}},{key:"onAfterCreateRow",value:function(){this.dataManager.rewriteCache()}},{key:"onAfterInit",value:function(){var i=Math.max.apply(Math,CD(this.dataManager.cache.levels));i>0&&this.headersUI.updateRowHeaderWidth(i)}},{key:"onBeforeViewRender",value:function(i,o){var a=no.get(this);a.skipRender&&(o.skipRender=!0)}},{key:"destroy",value:function(){ys(ro(e.prototype),"destroy",this).call(this)}},{key:"onBeforeLoadData",value:function(i){if(!NA(i)){B0(Zxe),this.disablePlugin();return}this.dataManager.setData(i),this.dataManager.rewriteCache()}}],[{key:"PLUGIN_KEY",get:function(){return RD}},{key:"PLUGIN_PRIORITY",get:function(){return Xxe}}]),e}(Lt);function Qxe(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}function ED(t,r){for(var e=0;e<r.length;e++){var n=r[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function e3e(t,r,e){return r&&ED(t.prototype,r),e&&ED(t,e),t}var t3e=function(){function t(r){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;Qxe(this,t),this.rootWindow=e,this.prefix=r,this.savedKeys=[],this.loadSavedKeys()}return e3e(t,[{key:"saveValue",value:function(e,n){this.rootWindow.localStorage.setItem("".concat(this.prefix,"_").concat(e),JSON.stringify(n)),this.savedKeys.indexOf(e)===-1&&(this.savedKeys.push(e),this.saveSavedKeys())}},{key:"loadValue",value:function(e,n){var i=typeof e=="undefined"?n:e,o=this.rootWindow.localStorage.getItem("".concat(this.prefix,"_").concat(i));return o===null?void 0:JSON.parse(o)}},{key:"reset",value:function(e){this.rootWindow.localStorage.removeItem("".concat(this.prefix,"_").concat(e))}},{key:"resetAll",value:function(){var e=this;he(this.savedKeys,function(n,i){e.rootWindow.localStorage.removeItem("".concat(e.prefix,"_").concat(e.savedKeys[i]))}),this.clearSavedKeys()}},{key:"loadSavedKeys",value:function(){var e=this.rootWindow.localStorage.getItem("".concat(this.prefix,"__persistentStateKeys")),n=typeof e=="string"?JSON.parse(e):void 0;this.savedKeys=n||[]}},{key:"saveSavedKeys",value:function(){this.rootWindow.localStorage.setItem("".concat(this.prefix,"__persistentStateKeys"),JSON.stringify(this.savedKeys))}},{key:"clearSavedKeys",value:function(){this.savedKeys.length=0,this.saveSavedKeys()}}]),t}(),r3e=t3e;function Qm(t){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?Qm=function(e){return typeof e}:Qm=function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Qm(t)}function n3e(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}function TD(t,r){for(var e=0;e<r.length;e++){var n=r[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function i3e(t,r,e){return r&&TD(t.prototype,r),e&&TD(t,e),t}function ms(){return typeof Reflect!="undefined"&&Reflect.get?ms=Reflect.get:ms=function(r,e,n){var i=o3e(r,e);if(!!i){var o=Object.getOwnPropertyDescriptor(i,e);return o.get?o.get.call(arguments.length<3?r:n):o.value}},ms.apply(this,arguments)}function o3e(t,r){for(;!Object.prototype.hasOwnProperty.call(t,r)&&(t=io(t),t!==null););return t}function a3e(t,r){if(typeof r!="function"&&r!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(r&&r.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),r&&Dk(t,r)}function Dk(t,r){return Dk=Object.setPrototypeOf||function(n,i){return n.__proto__=i,n},Dk(t,r)}function s3e(t){var r=f3e();return function(){var n=io(t),i;if(r){var o=io(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return u3e(this,i)}}function u3e(t,r){if(r&&(Qm(r)==="object"||typeof r=="function"))return r;if(r!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return l3e(t)}function l3e(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function f3e(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function io(t){return io=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},io(t)}Ze.getSingleton().register("persistentStateSave");Ze.getSingleton().register("persistentStateLoad");Ze.getSingleton().register("persistentStateReset");var xD="persistentState",c3e=0,h3e=function(t){a3e(e,t);var r=s3e(e);function e(n){var i;return n3e(this,e),i=r.call(this,n),i.storage=void 0,i}return i3e(e,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[xD]}},{key:"enablePlugin",value:function(){var i=this;this.enabled||(this.storage||(this.storage=new r3e(this.hot.rootElement.id,this.hot.rootWindow)),this.addHook("persistentStateSave",function(o,a){return i.saveValue(o,a)}),this.addHook("persistentStateLoad",function(o,a){return i.loadValue(o,a)}),this.addHook("persistentStateReset",function(){return i.resetValue()}),ms(io(e.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){this.storage=void 0,ms(io(e.prototype),"disablePlugin",this).call(this)}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),ms(io(e.prototype),"updatePlugin",this).call(this)}},{key:"loadValue",value:function(i,o){o.value=this.storage.loadValue(i)}},{key:"saveValue",value:function(i,o){this.storage.saveValue(i,o)}},{key:"resetValue",value:function(i){typeof i=="undefined"?this.storage.resetAll():this.storage.reset(i)}},{key:"destroy",value:function(){ms(io(e.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return xD}},{key:"PLUGIN_PRIORITY",get:function(){return c3e}}]),e}(Lt);function ev(t){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?ev=function(e){return typeof e}:ev=function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ev(t)}function d3e(t){return v3e(t)||m3e(t)||y3e(t)||p3e()}function p3e(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function y3e(t,r){if(!!t){if(typeof t=="string")return Nk(t,r);var e=Object.prototype.toString.call(t).slice(8,-1);if(e==="Object"&&t.constructor&&(e=t.constructor.name),e==="Map"||e==="Set")return Array.from(t);if(e==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return Nk(t,r)}}function m3e(t){if(typeof Symbol!="undefined"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function v3e(t){if(Array.isArray(t))return Nk(t)}function Nk(t,r){(r==null||r>t.length)&&(r=t.length);for(var e=0,n=new Array(r);e<r;e++)n[e]=t[e];return n}function g3e(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}function AD(t,r){for(var e=0;e<r.length;e++){var n=r[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function b3e(t,r,e){return r&&AD(t.prototype,r),e&&AD(t,e),t}function vs(){return typeof Reflect!="undefined"&&Reflect.get?vs=Reflect.get:vs=function(r,e,n){var i=w3e(r,e);if(!!i){var o=Object.getOwnPropertyDescriptor(i,e);return o.get?o.get.call(arguments.length<3?r:n):o.value}},vs.apply(this,arguments)}function w3e(t,r){for(;!Object.prototype.hasOwnProperty.call(t,r)&&(t=oo(t),t!==null););return t}function _3e(t,r){if(typeof r!="function"&&r!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(r&&r.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),r&&$k(t,r)}function $k(t,r){return $k=Object.setPrototypeOf||function(n,i){return n.__proto__=i,n},$k(t,r)}function S3e(t){var r=O3e();return function(){var n=oo(t),i;if(r){var o=oo(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return C3e(this,i)}}function C3e(t,r){if(r&&(ev(r)==="object"||typeof r=="function"))return r;if(r!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return k3e(t)}function k3e(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function O3e(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function oo(t){return oo=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},oo(t)}var jk="search",R3e=190,E3e="htSearchResult",T3e=function(r,e,n,i,o){r.getCellMeta(e,n).isSearchResult=o},x3e=function(r,e,n){return er(r)||r===null||!r.toLocaleLowerCase||r.length===0||er(e)||e===null?!1:e.toString().toLocaleLowerCase(n.locale).indexOf(r.toLocaleLowerCase(n.locale))!==-1},A3e=function(t){_3e(e,t);var r=S3e(e);function e(n){var i;return g3e(this,e),i=r.call(this,n),i.callback=T3e,i.queryMethod=x3e,i.searchResultClass=E3e,i}return b3e(e,[{key:"isEnabled",value:function(){return this.hot.getSettings()[jk]}},{key:"enablePlugin",value:function(){var i=this;if(!this.enabled){var o=this.hot.getSettings()[jk];this.updatePluginSettings(o),this.addHook("beforeRenderer",function(){return i.onBeforeRenderer.apply(i,arguments)}),vs(oo(e.prototype),"enablePlugin",this).call(this)}}},{key:"disablePlugin",value:function(){var i=this,o=function(){return i.onBeforeRenderer.apply(i,arguments)};this.hot.addHook("beforeRenderer",o),this.hot.addHookOnce("afterViewRender",function(){i.hot.removeHook("beforeRenderer",o)}),vs(oo(e.prototype),"disablePlugin",this).call(this)}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),vs(oo(e.prototype),"updatePlugin",this).call(this)}},{key:"query",value:function(i){var o=this,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.getCallback(),s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.getQueryMethod(),l=this.hot.countRows(),p=this.hot.countCols(),d=[],g=this.hot;return Qe(0,l-1,function(y){Qe(0,p-1,function(h){var u=o.hot.getDataAtCell(y,h),f=o.hot.getCellMeta(y,h),c=f.search.callback||a,v=f.search.queryMethod||s,m=v(i,u,f);if(m){var b={row:y,col:h,data:u};d.push(b)}c&&c(g,y,h,u,m)})}),d}},{key:"getCallback",value:function(){return this.callback}},{key:"setCallback",value:function(i){this.callback=i}},{key:"getQueryMethod",value:function(){return this.queryMethod}},{key:"setQueryMethod",value:function(i){this.queryMethod=i}},{key:"getSearchResultClass",value:function(){return this.searchResultClass}},{key:"setSearchResultClass",value:function(i){this.searchResultClass=i}},{key:"updatePluginSettings",value:function(i){vt(i)&&(i.searchResultClass&&this.setSearchResultClass(i.searchResultClass),i.queryMethod&&this.setQueryMethod(i.queryMethod),i.callback&&this.setCallback(i.callback))}},{key:"onBeforeRenderer",value:function(i,o,a,s,l,p){var d=p.className||[],g=[];if(typeof d=="string")g=d.split(" ");else{var y;(y=g).push.apply(y,d3e(d))}this.isEnabled()&&p.isSearchResult?g.includes(this.searchResultClass)||g.push("".concat(this.searchResultClass)):g.includes(this.searchResultClass)&&g.splice(g.indexOf(this.searchResultClass),1),p.className=g.join(" ")}},{key:"destroy",value:function(){vs(oo(e.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return jk}},{key:"PLUGIN_PRIORITY",get:function(){return R3e}}]),e}(Lt);function tv(t){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?tv=function(e){return typeof e}:tv=function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},tv(t)}function M3e(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}function MD(t,r){for(var e=0;e<r.length;e++){var n=r[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function P3e(t,r,e){return r&&MD(t.prototype,r),e&&MD(t,e),t}function nl(){return typeof Reflect!="undefined"&&Reflect.get?nl=Reflect.get:nl=function(r,e,n){var i=I3e(r,e);if(!!i){var o=Object.getOwnPropertyDescriptor(i,e);return o.get?o.get.call(arguments.length<3?r:n):o.value}},nl.apply(this,arguments)}function I3e(t,r){for(;!Object.prototype.hasOwnProperty.call(t,r)&&(t=ra(t),t!==null););return t}function D3e(t,r){if(typeof r!="function"&&r!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(r&&r.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),r&&Lk(t,r)}function Lk(t,r){return Lk=Object.setPrototypeOf||function(n,i){return n.__proto__=i,n},Lk(t,r)}function N3e(t){var r=L3e();return function(){var n=ra(t),i;if(r){var o=ra(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return $3e(this,i)}}function $3e(t,r){if(r&&(tv(r)==="object"||typeof r=="function"))return r;if(r!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return j3e(t)}function j3e(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function L3e(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function ra(t){return ra=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},ra(t)}var H3e="touchScroll",F3e=200,B3e=function(t){D3e(e,t);var r=N3e(e);function e(n){var i;return M3e(this,e),i=r.call(this,n),i.scrollbars=[],i.clones=[],i.lockedCollection=!1,i.freezeOverlays=!1,i}return P3e(e,[{key:"isEnabled",value:function(){return hb()}},{key:"enablePlugin",value:function(){var i=this;this.enabled||(this.addHook("afterViewRender",function(){return i.onAfterViewRender()}),this.registerEvents(),nl(ra(e.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){this.lockedCollection=!1,nl(ra(e.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){nl(ra(e.prototype),"disablePlugin",this).call(this)}},{key:"registerEvents",value:function(){var i=this;this.addHook("beforeTouchScroll",function(){return i.onBeforeTouchScroll()}),this.addHook("afterMomentumScroll",function(){return i.onAfterMomentumScroll()})}},{key:"onAfterViewRender",value:function(){if(!this.lockedCollection){var i=this.hot.view.wt.wtOverlays,o=i.topOverlay,a=i.bottomOverlay,s=i.leftOverlay,l=i.topLeftCornerOverlay,p=i.bottomLeftCornerOverlay;this.lockedCollection=!0,this.scrollbars.length=0,this.scrollbars.push(o),a.clone&&this.scrollbars.push(a),this.scrollbars.push(s),l&&this.scrollbars.push(l),p&&p.clone&&this.scrollbars.push(p),this.clones.length=0,o.needFullRender&&this.clones.push(o.clone.wtTable.holder.parentNode),a.needFullRender&&this.clones.push(a.clone.wtTable.holder.parentNode),s.needFullRender&&this.clones.push(s.clone.wtTable.holder.parentNode),l&&this.clones.push(l.clone.wtTable.holder.parentNode),p&&p.clone&&this.clones.push(p.clone.wtTable.holder.parentNode)}}},{key:"onBeforeTouchScroll",value:function(){this.freezeOverlays=!0,he(this.clones,function(i){Ie(i,"hide-tween")})}},{key:"onAfterMomentumScroll",value:function(){var i=this;this.freezeOverlays=!1,he(this.clones,function(o){dt(o,"hide-tween"),Ie(o,"show-tween")}),setTimeout(function(){he(i.clones,function(o){dt(o,"show-tween")})},400),he(this.scrollbars,function(o){o.refresh(),o.resetFixedPosition()}),this.hot.view.wt.wtOverlays.syncScrollWithMaster()}}],[{key:"PLUGIN_KEY",get:function(){return H3e}},{key:"PLUGIN_PRIORITY",get:function(){return F3e}}]),e}(Lt);function rv(t){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?rv=function(e){return typeof e}:rv=function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},rv(t)}function V3e(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}function PD(t,r){for(var e=0;e<r.length;e++){var n=r[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function W3e(t,r,e){return r&&PD(t.prototype,r),e&&PD(t,e),t}function gs(){return typeof Reflect!="undefined"&&Reflect.get?gs=Reflect.get:gs=function(r,e,n){var i=U3e(r,e);if(!!i){var o=Object.getOwnPropertyDescriptor(i,e);return o.get?o.get.call(arguments.length<3?r:n):o.value}},gs.apply(this,arguments)}function U3e(t,r){for(;!Object.prototype.hasOwnProperty.call(t,r)&&(t=ao(t),t!==null););return t}function z3e(t,r){if(typeof r!="function"&&r!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(r&&r.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),r&&Hk(t,r)}function Hk(t,r){return Hk=Object.setPrototypeOf||function(n,i){return n.__proto__=i,n},Hk(t,r)}function Y3e(t){var r=q3e();return function(){var n=ao(t),i;if(r){var o=ao(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return G3e(this,i)}}function G3e(t,r){if(r&&(rv(r)==="object"||typeof r=="function"))return r;if(r!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return K3e(t)}function K3e(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function q3e(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function ao(t){return ao=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},ao(t)}var nv="trimRows",X3e=330,Z3e=function(t){z3e(e,t);var r=Y3e(e);function e(n){var i;return V3e(this,e),i=r.call(this,n),i.trimmedRowsMap=null,i}return W3e(e,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[nv]}},{key:"enablePlugin",value:function(){var i=this;this.enabled||(this.trimmedRowsMap=this.hot.rowIndexMapper.registerMap("trimRows",new xf),this.trimmedRowsMap.addLocalHook("init",function(){return i.onMapInit()}),gs(ao(e.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){var i=this,o=this.hot.getSettings()[nv];Array.isArray(o)&&this.hot.batchExecution(function(){i.trimmedRowsMap.clear(),he(o,function(a){i.trimmedRowsMap.setValueAtIndex(a,!0)})},!0),gs(ao(e.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){this.hot.rowIndexMapper.unregisterMap("trimRows"),gs(ao(e.prototype),"disablePlugin",this).call(this)}},{key:"getTrimmedRows",value:function(){return this.trimmedRowsMap.getTrimmedIndexes()}},{key:"trimRows",value:function(i){var o=this,a=this.getTrimmedRows(),s=this.isValidConfig(i),l=a;s&&(l=Array.from(new Set(a.concat(i))));var p=this.hot.runHooks("beforeTrimRow",a,l,s);p!==!1&&(s&&this.hot.batchExecution(function(){he(i,function(d){o.trimmedRowsMap.setValueAtIndex(d,!0)})},!0),this.hot.runHooks("afterTrimRow",a,l,s,s&&l.length>a.length))}},{key:"trimRow",value:function(){for(var i=arguments.length,o=new Array(i),a=0;a<i;a++)o[a]=arguments[a];this.trimRows(o)}},{key:"untrimRows",value:function(i){var o=this.getTrimmedRows(),a=this.isValidConfig(i),s=o,l=this.trimmedRowsMap.getValues().slice(),p=i.length>0;a&&p&&(he(i,function(g){l[g]=!1}),s=pr(l,function(g,y,h){return y&&g.push(h),g},[]));var d=this.hot.runHooks("beforeUntrimRow",o,s,a&&p);d!==!1&&(a&&p&&this.trimmedRowsMap.setValues(l),this.hot.runHooks("afterUntrimRow",o,s,a&&p,a&&s.length<o.length))}},{key:"untrimRow",value:function(){for(var i=arguments.length,o=new Array(i),a=0;a<i;a++)o[a]=arguments[a];this.untrimRows(o)}},{key:"isTrimmed",value:function(i){return this.trimmedRowsMap.getValueAtIndex(i)||!1}},{key:"untrimAll",value:function(){this.untrimRows(this.getTrimmedRows())}},{key:"isValidConfig",value:function(i){var o=this.hot.countSourceRows();return i.every(function(a){return Number.isInteger(a)&&a>=0&&a<o})}},{key:"onMapInit",value:function(){var i=this,o=this.hot.getSettings()[nv];Array.isArray(o)&&this.hot.batchExecution(function(){he(o,function(a){i.trimmedRowsMap.setValueAtIndex(a,!0)})},!0)}},{key:"destroy",value:function(){gs(ao(e.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return nv}},{key:"PLUGIN_PRIORITY",get:function(){return X3e}}]),e}(Lt);function iv(t){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?iv=function(e){return typeof e}:iv=function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},iv(t)}function ID(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}function DD(t,r){for(var e=0;e<r.length;e++){var n=r[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function ND(t,r,e){return r&&DD(t.prototype,r),e&&DD(t,e),t}function $D(t,r){if(typeof r!="function"&&r!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(r&&r.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),r&&Fk(t,r)}function Fk(t,r){return Fk=Object.setPrototypeOf||function(n,i){return n.__proto__=i,n},Fk(t,r)}function jD(t){var r=e6e();return function(){var n=ov(t),i;if(r){var o=ov(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return J3e(this,i)}}function J3e(t,r){if(r&&(iv(r)==="object"||typeof r=="function"))return r;if(r!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Q3e(t)}function Q3e(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function e6e(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function ov(t){return ov=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},ov(t)}function t6e(t){return i6e(t)||n6e(t)||HD(t)||r6e()}function r6e(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function n6e(t){if(typeof Symbol!="undefined"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function i6e(t){if(Array.isArray(t))return Bk(t)}function LD(t,r){return s6e(t)||a6e(t,r)||HD(t,r)||o6e()}function o6e(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function HD(t,r){if(!!t){if(typeof t=="string")return Bk(t,r);var e=Object.prototype.toString.call(t).slice(8,-1);if(e==="Object"&&t.constructor&&(e=t.constructor.name),e==="Map"||e==="Set")return Array.from(t);if(e==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return Bk(t,r)}}function Bk(t,r){(r==null||r>t.length)&&(r=t.length);for(var e=0,n=new Array(r);e<r;e++)n[e]=t[e];return n}function a6e(t,r){var e=t==null?null:typeof Symbol!="undefined"&&t[Symbol.iterator]||t["@@iterator"];if(e!=null){var n=[],i=!0,o=!1,a,s;try{for(e=e.call(t);!(i=(a=e.next()).done)&&(n.push(a.value),!(r&&n.length===r));i=!0);}catch(l){o=!0,s=l}finally{try{!i&&e.return!=null&&e.return()}finally{if(o)throw s}}return n}}function s6e(t){if(Array.isArray(t))return t}var u6e="undoRedo";function Ke(t){var r=this;this.instance=t,this.doneActions=[],this.undoneActions=[],this.ignoreNewActions=!1,this.enabled=!1,t.addHook("afterChange",function(e,n){var i=this,o=e&&e.length;if(!!o){var a=e.find(function(l){var p=LD(l,4),d=p[2],g=p[3];return d!==g});if(!!a){var s=function(){var p=e.reduce(function(g,y){return g.push(t6e(y)),g},[]);he(p,function(g){g[1]=t.propToCol(g[1])});var d=o>1?i.getSelected():[[p[0][0],p[0][1]]];return new Ke.ChangeAction(p,d)};r.done(s,n)}}}),t.addHook("afterCreateRow",function(e,n,i){r.done(function(){return new Ke.CreateRowAction(e,n)},i)}),t.addHook("beforeRemoveRow",function(e,n,i,o){var a=function(){var l=r.instance.getSourceDataArray(),p=(l.length+e)%l.length,d=t.toPhysicalRow(p),g=zr(l.slice(d,d+n));return new Ke.RemoveRowAction(p,g,t.getSettings().fixedRowsBottom,t.getSettings().fixedRowsTop)};r.done(a,o)}),t.addHook("afterCreateCol",function(e,n,i){r.done(function(){return new Ke.CreateColumnAction(e,n)},i)}),t.addHook("beforeRemoveCol",function(e,n,i,o){var a=function(){var l=r.instance.getSourceDataArray(),p=(r.instance.countCols()+e)%r.instance.countCols(),d=[],g=[],y=[];Qe(l.length-1,function(f){var c=[],v=l[f];Qe(p,p+(n-1),function(m){c.push(v[t.toPhysicalColumn(m)])}),d.push(c)}),Qe(n-1,function(f){y.push(t.toPhysicalColumn(p+f))}),Array.isArray(t.getSettings().colHeaders)&&Qe(n-1,function(f){g.push(t.getSettings().colHeaders[t.toPhysicalColumn(p+f)]||null)});var h=t.columnIndexMapper.getIndexesSequence(),u=t.rowIndexMapper.getIndexesSequence();return new Ke.RemoveColumnAction(p,y,d,g,h,u,t.getSettings().fixedColumnsLeft)};r.done(a,o)}),t.addHook("beforeCellAlignment",function(e,n,i,o){r.done(function(){return new Ke.CellAlignmentAction(e,n,i,o)})}),t.addHook("beforeFilter",function(e){r.done(function(){return new Ke.FiltersAction(e)})}),t.addHook("beforeRowMove",function(e,n){e!==!1&&r.done(function(){return new Ke.RowMoveAction(e,n)})}),t.addHook("beforeMergeCells",function(e,n){n||r.done(function(){return new Ke.MergeCellsAction(t,e)})}),t.addHook("afterUnmergeCells",function(e,n){n||r.done(function(){return new Ke.UnmergeCellsAction(t,e)})}),t.addHook("afterInit",function(){r.init()})}Ke.prototype.done=function(t,r){if(!this.ignoreNewActions){var e=r==="UndoRedo.undo"||r==="UndoRedo.redo"||r==="auto";if(!e){var n=this.doneActions.slice(),i=this.instance.runHooks("beforeUndoStackChange",n,r);if(i!==!1){var o=t(),a=this.undoneActions.slice();this.doneActions.push(o),this.instance.runHooks("afterUndoStackChange",n,this.doneActions.slice()),this.instance.runHooks("beforeRedoStackChange",a),this.undoneActions.length=0,this.instance.runHooks("afterRedoStackChange",a,this.undoneActions.slice())}}}};Ke.prototype.undo=function(){if(this.isUndoAvailable()){var t=this.doneActions.slice();this.instance.runHooks("beforeUndoStackChange",t);var r=this.doneActions.pop();this.instance.runHooks("afterUndoStackChange",t,this.doneActions.slice());var e=zr(r),n=this.instance.runHooks("beforeUndo",e);if(n===!1)return;this.ignoreNewActions=!0;var i=this,o=this.undoneActions.slice();this.instance.runHooks("beforeRedoStackChange",o),r.undo(this.instance,function(){i.ignoreNewActions=!1,i.undoneActions.push(r)}),this.instance.runHooks("afterRedoStackChange",o,this.undoneActions.slice()),this.instance.runHooks("afterUndo",e)}};Ke.prototype.redo=function(){if(this.isRedoAvailable()){var t=this.undoneActions.slice();this.instance.runHooks("beforeRedoStackChange",t);var r=this.undoneActions.pop();this.instance.runHooks("afterRedoStackChange",t,this.undoneActions.slice());var e=zr(r),n=this.instance.runHooks("beforeRedo",e);if(n===!1)return;this.ignoreNewActions=!0;var i=this,o=this.doneActions.slice();this.instance.runHooks("beforeUndoStackChange",o),r.redo(this.instance,function(){i.ignoreNewActions=!1,i.doneActions.push(r)}),this.instance.runHooks("afterUndoStackChange",o,this.doneActions.slice()),this.instance.runHooks("afterRedo",e)}};Ke.prototype.isUndoAvailable=function(){return this.doneActions.length>0};Ke.prototype.isRedoAvailable=function(){return this.undoneActions.length>0};Ke.prototype.clear=function(){this.doneActions.length=0,this.undoneActions.length=0};Ke.prototype.isEnabled=function(){return this.enabled};Ke.prototype.enable=function(){if(!this.isEnabled()){var t=this.instance;this.enabled=!0,c6e(t),t.addHook("beforeKeyDown",FD),t.addHook("afterChange",BD)}};Ke.prototype.disable=function(){if(!!this.isEnabled()){var t=this.instance;this.enabled=!1,h6e(t),t.removeHook("beforeKeyDown",FD),t.removeHook("afterChange",BD)}};Ke.prototype.destroy=function(){this.clear(),this.instance=null,this.doneActions=null,this.undoneActions=null};Ke.Action=function(){};Ke.Action.prototype.undo=function(){};Ke.Action.prototype.redo=function(){};Ke.ChangeAction=function(t,r){this.changes=t,this.selected=r,this.actionType="change"};_i(Ke.ChangeAction,Ke.Action);Ke.ChangeAction.prototype.undo=function(t,r){for(var e=zr(this.changes),n=t.countEmptyRows(!0),i=t.countEmptyCols(!0),o=0,a=e.length;o<a;o++)e[o].splice(3,1);t.addHookOnce("afterChange",r),t.setDataAtCell(e,null,null,"UndoRedo.undo");for(var s=0,l=e.length;s<l;s++){var p=LD(e[s],2),d=p[0],g=p[1];t.getSettings().minSpareRows&&d+1+t.getSettings().minSpareRows===t.countRows()&&n===t.getSettings().minSpareRows&&(t.alter("remove_row",parseInt(d+1,10),t.getSettings().minSpareRows),t.undoRedo.doneActions.pop()),t.getSettings().minSpareCols&&g+1+t.getSettings().minSpareCols===t.countCols()&&i===t.getSettings().minSpareCols&&(t.alter("remove_col",parseInt(g+1,10),t.getSettings().minSpareCols),t.undoRedo.doneActions.pop())}t.selectCells(this.selected,!1,!1)};Ke.ChangeAction.prototype.redo=function(t,r){for(var e=zr(this.changes),n=0,i=e.length;n<i;n++)e[n].splice(2,1);t.addHookOnce("afterChange",r),t.setDataAtCell(e,null,null,"UndoRedo.redo"),this.selected&&t.selectCells(this.selected,!1,!1)};Ke.CreateRowAction=function(t,r){this.index=t,this.amount=r,this.actionType="insert_row"};_i(Ke.CreateRowAction,Ke.Action);Ke.CreateRowAction.prototype.undo=function(t,r){var e=t.countRows(),n=t.getSettings().minSpareRows;this.index>=e&&this.index-n<e&&(this.index-=n),t.addHookOnce("afterRemoveRow",r),t.alter("remove_row",this.index,this.amount,"UndoRedo.undo")};Ke.CreateRowAction.prototype.redo=function(t,r){t.addHookOnce("afterCreateRow",r),t.alter("insert_row",this.index,this.amount,"UndoRedo.redo")};Ke.RemoveRowAction=function(t,r,e,n){this.index=t,this.data=r,this.actionType="remove_row",this.fixedRowsBottom=e,this.fixedRowsTop=n};_i(Ke.RemoveRowAction,Ke.Action);Ke.RemoveRowAction.prototype.undo=function(t,r){var e=t.getSettings();e.fixedRowsBottom=this.fixedRowsBottom,e.fixedRowsTop=this.fixedRowsTop,t.alter("insert_row",this.index,this.data.length,"UndoRedo.undo"),t.addHookOnce("afterViewRender",r),t.populateFromArray(this.index,0,this.data,void 0,void 0,"UndoRedo.undo")};Ke.RemoveRowAction.prototype.redo=function(t,r){t.addHookOnce("afterRemoveRow",r),t.alter("remove_row",this.index,this.data.length,"UndoRedo.redo")};Ke.CreateColumnAction=function(t,r){this.index=t,this.amount=r,this.actionType="insert_col"};_i(Ke.CreateColumnAction,Ke.Action);Ke.CreateColumnAction.prototype.undo=function(t,r){t.addHookOnce("afterRemoveCol",r),t.alter("remove_col",this.index,this.amount,"UndoRedo.undo")};Ke.CreateColumnAction.prototype.redo=function(t,r){t.addHookOnce("afterCreateCol",r),t.alter("insert_col",this.index,this.amount,"UndoRedo.redo")};Ke.RemoveColumnAction=function(t,r,e,n,i,o,a){this.index=t,this.indexes=r,this.data=e,this.amount=this.data[0].length,this.headers=n,this.columnPositions=i.slice(0),this.rowPositions=o.slice(0),this.actionType="remove_col",this.fixedColumnsLeft=a};_i(Ke.RemoveColumnAction,Ke.Action);Ke.RemoveColumnAction.prototype.undo=function(t,r){var e=this,n=t.getSettings();n.fixedColumnsLeft=this.fixedColumnsLeft;for(var i=this.indexes.slice(0).sort(),o=function(y,h,u){return u[e.indexes.indexOf(i[h])]},a=this.data.length,s=[],l=0;l<a;l++)s.push(bt(this.data[l],o));var p=bt(this.headers,o),d=[];t.alter("insert_col",this.indexes[0],this.indexes.length,"UndoRedo.undo"),he(t.getSourceDataArray(),function(g,y){he(i,function(h,u){g[h]=s[y][u],d.push([y,h,g[h]])})}),t.setSourceDataAtCell(d,void 0,void 0,"UndoRedo.undo"),t.columnIndexMapper.insertIndexes(i[0],i.length),typeof this.headers!="undefined"&&he(p,function(g,y){t.getSettings().colHeaders[i[y]]=g}),t.batchExecution(function(){t.rowIndexMapper.setIndexesSequence(e.rowPositions),t.columnIndexMapper.setIndexesSequence(e.columnPositions)},!0),t.addHookOnce("afterViewRender",r),t.render()};Ke.RemoveColumnAction.prototype.redo=function(t,r){t.addHookOnce("afterRemoveCol",r),t.alter("remove_col",this.index,this.amount,"UndoRedo.redo")};Ke.CellAlignmentAction=function(t,r,e,n){this.stateBefore=t,this.range=r,this.type=e,this.alignment=n};Ke.CellAlignmentAction.prototype.undo=function(t,r){var e=this;he(this.range,function(n){n.forAll(function(i,o){i>=0&&o>=0&&t.setCellMeta(i,o,"className",e.stateBefore[i][o]||" htLeft")})}),t.addHookOnce("afterViewRender",r),t.render()};Ke.CellAlignmentAction.prototype.redo=function(t,r){Uo(this.range,this.type,this.alignment,function(e,n){return t.getCellMeta(e,n)},function(e,n,i,o){return t.setCellMeta(e,n,i,o)}),t.addHookOnce("afterViewRender",r),t.render()};Ke.FiltersAction=function(t){this.conditionsStack=t,this.actionType="filter"};_i(Ke.FiltersAction,Ke.Action);Ke.FiltersAction.prototype.undo=function(t,r){var e=t.getPlugin("filters");t.addHookOnce("afterViewRender",r),e.conditionCollection.importAllConditions(this.conditionsStack.slice(0,this.conditionsStack.length-1)),e.filter()};Ke.FiltersAction.prototype.redo=function(t,r){var e=t.getPlugin("filters");t.addHookOnce("afterViewRender",r),e.conditionCollection.importAllConditions(this.conditionsStack),e.filter()};var l6e=function(t){$D(e,t);var r=jD(e);function e(n,i){var o;ID(this,e),o=r.call(this),o.cellRange=i;var a=o.cellRange.getTopLeftCorner(),s=o.cellRange.getBottomRightCorner();return o.rangeData=n.getData(a.row,a.col,s.row,s.col),o}return ND(e,[{key:"undo",value:function(i,o){var a=i.getPlugin("mergeCells");i.addHookOnce("afterViewRender",o),a.unmergeRange(this.cellRange,!0);var s=this.cellRange.getTopLeftCorner();i.populateFromArray(s.row,s.col,this.rangeData,void 0,void 0,"MergeCells")}},{key:"redo",value:function(i,o){var a=i.getPlugin("mergeCells");i.addHookOnce("afterViewRender",o),a.mergeRange(this.cellRange)}}]),e}(Ke.Action);Ke.MergeCellsAction=l6e;var f6e=function(t){$D(e,t);var r=jD(e);function e(n,i){var o;return ID(this,e),o=r.call(this),o.cellRange=i,o}return ND(e,[{key:"undo",value:function(i,o){var a=i.getPlugin("mergeCells");i.addHookOnce("afterViewRender",o),a.mergeRange(this.cellRange,!0)}},{key:"redo",value:function(i,o){var a=i.getPlugin("mergeCells");i.addHookOnce("afterViewRender",o),a.unmergeRange(this.cellRange,!0),i.render()}}]),e}(Ke.Action);Ke.UnmergeCellsAction=f6e;Ke.RowMoveAction=function(t,r){this.rows=t.slice(),this.finalIndex=r,this.actionType="row_move"};_i(Ke.RowMoveAction,Ke.Action);Ke.RowMoveAction.prototype.undo=function(t,r){var e=this,n=t.getPlugin("manualRowMove"),i=[].concat(this.rows),o=i.filter(function(d){return d>e.finalIndex}),a=i.filter(function(d){return d<=e.finalIndex}),s=o.sort(function(d,g){return g-d}).concat(a.sort(function(d,g){return d-g}));t.addHookOnce("afterViewRender",r);for(var l=0;l<s.length;l+=1){var p=t.toVisualRow(s[l]);n.moveRow(p,s[l])}t.render(),t.deselectCell(),t.selectRows(this.rows[0],this.rows[0]+this.rows.length-1)};Ke.RowMoveAction.prototype.redo=function(t,r){var e=t.getPlugin("manualRowMove");t.addHookOnce("afterViewRender",r),e.moveRows(this.rows.slice(),this.finalIndex),t.render(),t.deselectCell(),t.selectRows(this.finalIndex,this.finalIndex+this.rows.length-1)};Ke.prototype.init=function(){var t=this.instance.getSettings().undo,r=typeof t=="undefined"||t;this.instance.undoRedo||(this.instance.undoRedo=this),r?this.instance.undoRedo.enable():this.instance.undoRedo.disable()};function FD(t){if(!Fn(t)){var r=this,e=r.getActiveEditor();if(!(e&&e.isOpened())){var n=t.altKey,i=t.ctrlKey,o=t.keyCode,a=t.metaKey,s=t.shiftKey,l=(i||a)&&!n;if(!!l){var p=o===89||s&&o===90;p?(r.undoRedo.redo(),rr(t)):o===90&&(r.undoRedo.undo(),rr(t))}}}}function BD(t,r){var e=this;if(r==="loadData")return e.undoRedo.clear()}function c6e(t){t.undo=function(){return t.undoRedo.undo()},t.redo=function(){return t.undoRedo.redo()},t.isUndoAvailable=function(){return t.undoRedo.isUndoAvailable()},t.isRedoAvailable=function(){return t.undoRedo.isRedoAvailable()},t.clearUndo=function(){return t.undoRedo.clear()}}function h6e(t){delete t.undo,delete t.redo,delete t.isUndoAvailable,delete t.isRedoAvailable,delete t.clearUndo}var hc=Ze.getSingleton();hc.add("afterUpdateSettings",function(){var t;(t=this.getPlugin("undoRedo"))===null||t===void 0||t.init()});hc.register("beforeUndo");hc.register("afterUndo");hc.register("beforeRedo");hc.register("afterRedo");Ke.PLUGIN_KEY=u6e;function d6e(){Nt(Bpe),Nt(fye),Nt(Rye),Nt(dme),Nt(Ame),Nt(VP),Nt(ege),Nt(Tge),Nt(g5),Nt(Xbe),Nt(v0e),Nt(R0e),Nt($5),Nt(gwe),Nt(FCe),Nt(mke),Nt(Hke),Nt(uOe),Nt(xOe),Nt(l2e),Nt(g2e),Nt(J2e),Nt(sRe),Nt(GRe),Nt(hEe),Nt(CEe),Nt(zTe),Nt(Jxe),Nt(h3e),Nt(A3e),Nt(B3e),Nt(Z3e),Nt(Ke)}function p6e(){vde(),xde(),Ude(),spe(),d6e()}function y6e(t){var r=typeof window=="undefined"?!1:window.jQuery;!r||(r.fn.handsontable=function(e){var n=this.first(),i=n.data("handsontable");if(typeof e!="string"){var o=e||{};return i?i.updateSettings(o):(i=new t.Core(n[0],o),n.data("handsontable",i),i.init()),n}var a;if(i)if(typeof i[e]!="undefined"){for(var s,l=arguments.length,p=new Array(l>1?l-1:0),d=1;d<l;d++)p[d-1]=arguments[d];a=(s=i[e]).call.apply(s,[i].concat(p)),e==="destroy"&&n.removeData()}else throw new Error("Handsontable do not provide action: ".concat(e));return a})}var Vk,Wk,Uk,zk,Yk;p6e();y6e(yt);yt.__GhostTable=hS;yt._getListenersCounter=Yte;yt._getRegisteredMapsCounter=mue;yt.EventManager=Wt;var m6e=[UG,qG,qae,Lde,jY,WJ,EJ,Poe,zG,xJ,gne,Roe],v6e=[HJ,Bte];yt.helper={};yt.dom={};he(m6e,function(t){he(Object.getOwnPropertyNames(t),function(r){r.charAt(0)!=="_"&&(yt.helper[r]=t[r])})});he(v6e,function(t){he(Object.getOwnPropertyNames(t),function(r){r.charAt(0)!=="_"&&(yt.dom[r]=t[r])})});yt.cellTypes=(Vk=yt.cellTypes)!==null&&Vk!==void 0?Vk:{};he(Uae(),function(t){yt.cellTypes[t]=ep(t)});yt.cellTypes.registerCellType=Bn;yt.cellTypes.getCellType=ep;yt.editors=(Wk=yt.editors)!==null&&Wk!==void 0?Wk:{};he(die(),function(t){yt.editors["".concat(Ln(t),"Editor")]=X6(t)});yt.editors.registerEditor=hn;yt.editors.getEditor=X6;yt.renderers=(Uk=yt.renderers)!==null&&Uk!==void 0?Uk:{};he(Cae(),function(t){var r=Nw(t);t==="base"&&(yt.renderers.cellDecorator=r),yt.renderers["".concat(Ln(t),"Renderer")]=r});yt.renderers.registerRenderer=Ai;yt.renderers.getRenderer=Nw;yt.validators=(zk=yt.validators)!==null&&zk!==void 0?zk:{};he(Rae(),function(t){yt.validators["".concat(Ln(t),"Validator")]=$w(t)});yt.validators.registerValidator=su;yt.validators.getValidator=$w;yt.plugins=(Yk=yt.plugins)!==null&&Yk!==void 0?Yk:{};he(Dw(),function(t){yt.plugins[t]=_f(t)});yt.plugins["".concat(Ln(Lt.PLUGIN_KEY),"Plugin")]=Lt;yt.plugins.registerPlugin=Nt;yt.plugins.getPlugin=_f;var VD={exports:{}};/*! ExcelJS 21-08-2021 */(function(t,r){(function(e){t.exports=e()})(function(){return function e(n,i,o){function a(p,d){if(!i[p]){if(!n[p]){var g=typeof fo=="function"&&fo;if(!d&&g)return g(p,!0);if(s)return s(p,!0);var y=new Error("Cannot find module '"+p+"'");throw y.code="MODULE_NOT_FOUND",y}var h=i[p]={exports:{}};n[p][0].call(h.exports,function(u){return a(n[p][1][u]||u)},h,h.exports,e,n,i,o)}return i[p].exports}for(var s=typeof fo=="function"&&fo,l=0;l<o.length;l++)a(o[l]);return a}({1:[function(e,n,i){function o(m){return(o=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(b){return typeof b}:function(b){return b&&typeof Symbol=="function"&&b.constructor===Symbol&&b!==Symbol.prototype?"symbol":typeof b})(m)}function a(m,b,w,_,C,R,I){try{var P=m[R](I),N=P.value}catch(A){return void w(A)}P.done?b(N):Promise.resolve(N).then(_,C)}function s(m){return function(){var b=this,w=arguments;return new Promise(function(_,C){var R=m.apply(b,w);function I(N){a(R,_,C,I,P,"next",N)}function P(N){a(R,_,C,I,P,"throw",N)}I(void 0)})}}function l(m,b){for(var w=0;w<b.length;w++){var _=b[w];_.enumerable=_.enumerable||!1,_.configurable=!0,"value"in _&&(_.writable=!0),Object.defineProperty(m,_.key,_)}}var p=e("fs"),d=e("fast-csv"),g=e("dayjs/plugin/customParseFormat"),y=e("dayjs/plugin/utc"),h=e("dayjs").extend(g).extend(y),u=e("../utils/stream-buf"),f=e("../utils/utils").fs.exists,c={true:!0,false:!1,"#N/A":{error:"#N/A"},"#REF!":{error:"#REF!"},"#NAME?":{error:"#NAME?"},"#DIV/0!":{error:"#DIV/0!"},"#NULL!":{error:"#NULL!"},"#VALUE!":{error:"#VALUE!"},"#NUM!":{error:"#NUM!"}},v=function(){function m(R){(function(I,P){if(!(I instanceof P))throw new TypeError("Cannot call a class as a function")})(this,m),this.workbook=R,this.worksheet=null}var b,w,_,C;return b=m,(w=[{key:"readFile",value:(C=s(regeneratorRuntime.mark(function R(I,P){var N,A;return regeneratorRuntime.wrap(function($){for(;;)switch($.prev=$.next){case 0:return P=P||{},$.next=3,f(I);case 3:if($.sent){$.next=5;break}throw new Error("File not found: ".concat(I));case 5:return N=p.createReadStream(I),$.next=8,this.read(N,P);case 8:return A=$.sent,N.close(),$.abrupt("return",A);case 11:case"end":return $.stop()}},R,this)})),function(R,I){return C.apply(this,arguments)})},{key:"read",value:function(R,I){var P=this;return I=I||{},new Promise(function(N,A){var $=P.workbook.addWorksheet(I.sheetName),T=I.dateFormats||["YYYY-MM-DD[T]HH:mm:ssZ","YYYY-MM-DD[T]HH:mm:ss","MM-DD-YYYY","YYYY-MM-DD"],M=I.map||function(E){if(E==="")return null;var k=Number(E);if(!Number.isNaN(k)&&k!==1/0)return k;var O=T.reduce(function(j,H){if(j)return j;var F=h(E,H,!0);return F.isValid()?F:null},null);if(O)return new Date(O.valueOf());var x=c[E];return x!==void 0?x:E},S=d.parse(I.parserOptions).on("data",function(E){$.addRow(E.map(M))}).on("end",function(){S.emit("worksheet",$)});S.on("worksheet",N).on("error",A),R.pipe(S)})}},{key:"createInputStream",value:function(){throw new Error("`CSV#createInputStream` is deprecated. You should use `CSV#read` instead. This method will be removed in version 5.0. Please follow upgrade instruction: https://github.com/exceljs/exceljs/blob/master/UPGRADE-4.0.md")}},{key:"write",value:function(R,I){var P=this;return new Promise(function(N,A){I=I||{};var $=P.workbook.getWorksheet(I.sheetName||I.sheetId),T=d.format(I.formatterOptions);R.on("finish",function(){N()}),T.on("error",A),T.pipe(R);var M=I,S=M.dateFormat,E=M.dateUTC,k=I.map||function(j){if(j){if(j.text||j.hyperlink)return j.hyperlink||j.text||"";if(j.formula||j.result)return j.result||"";if(j instanceof Date)return S?E?h.utc(j).format(S):h(j).format(S):E?h.utc(j).format():h(j).format();if(j.error)return j.error;if(o(j)==="object")return JSON.stringify(j)}return j},O=I.includeEmptyRows===void 0||I.includeEmptyRows,x=1;$&&$.eachRow(function(j,H){if(O)for(;x++<H-1;)T.write([]);var F=j.values;F.shift(),T.write(F.map(k)),x=H}),T.end()})}},{key:"writeFile",value:function(R,I){var P={encoding:(I=I||{}).encoding||"utf8"},N=p.createWriteStream(R,P);return this.write(N,I)}},{key:"writeBuffer",value:(_=s(regeneratorRuntime.mark(function R(I){var P;return regeneratorRuntime.wrap(function(N){for(;;)switch(N.prev=N.next){case 0:return P=new u,N.next=3,this.write(P,I);case 3:return N.abrupt("return",P.read());case 4:case"end":return N.stop()}},R,this)})),function(R){return _.apply(this,arguments)})}])&&l(b.prototype,w),m}();n.exports=v},{"../utils/stream-buf":23,"../utils/utils":26,dayjs:336,"dayjs/plugin/customParseFormat":337,"dayjs/plugin/utc":338,"fast-csv":369,fs:215}],2:[function(e,n,i){function o(p,d){if(!(p instanceof d))throw new TypeError("Cannot call a class as a function")}function a(p,d){for(var g=0;g<d.length;g++){var y=d[g];y.enumerable=y.enumerable||!1,y.configurable=!0,"value"in y&&(y.writable=!0),Object.defineProperty(p,y.key,y)}}var s=e("../utils/col-cache"),l=function(){function p(h,u){var f=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;if(o(this,p),u)if(typeof u=="string"){var c=s.decodeAddress(u);this.nativeCol=c.col+f,this.nativeColOff=0,this.nativeRow=c.row+f,this.nativeRowOff=0}else u.nativeCol!==void 0?(this.nativeCol=u.nativeCol||0,this.nativeColOff=u.nativeColOff||0,this.nativeRow=u.nativeRow||0,this.nativeRowOff=u.nativeRowOff||0):u.col!==void 0?(this.col=u.col+f,this.row=u.row+f):(this.nativeCol=0,this.nativeColOff=0,this.nativeRow=0,this.nativeRowOff=0);else this.nativeCol=0,this.nativeColOff=0,this.nativeRow=0,this.nativeRowOff=0;this.worksheet=h}var d,g,y;return d=p,y=[{key:"asInstance",value:function(h){return h instanceof p||h==null?h:new p(h)}}],(g=[{key:"col",get:function(){return this.nativeCol+Math.min(this.colWidth-1,this.nativeColOff)/this.colWidth},set:function(h){this.nativeCol=Math.floor(h),this.nativeColOff=Math.floor((h-this.nativeCol)*this.colWidth)}},{key:"row",get:function(){return this.nativeRow+Math.min(this.rowHeight-1,this.nativeRowOff)/this.rowHeight},set:function(h){this.nativeRow=Math.floor(h),this.nativeRowOff=Math.floor((h-this.nativeRow)*this.rowHeight)}},{key:"colWidth",get:function(){return this.worksheet&&this.worksheet.getColumn(this.nativeCol+1)&&this.worksheet.getColumn(this.nativeCol+1).isCustomWidth?Math.floor(1e4*this.worksheet.getColumn(this.nativeCol+1).width):64e4}},{key:"rowHeight",get:function(){return this.worksheet&&this.worksheet.getRow(this.nativeRow+1)&&this.worksheet.getRow(this.nativeRow+1).height?Math.floor(1e4*this.worksheet.getRow(this.nativeRow+1).height):18e4}},{key:"model",get:function(){return{nativeCol:this.nativeCol,nativeColOff:this.nativeColOff,nativeRow:this.nativeRow,nativeRowOff:this.nativeRowOff}},set:function(h){this.nativeCol=h.nativeCol,this.nativeColOff=h.nativeColOff,this.nativeRow=h.nativeRow,this.nativeRowOff=h.nativeRowOff}}])&&a(d.prototype,g),y&&a(d,y),p}();n.exports=l},{"../utils/col-cache":19}],3:[function(e,n,i){function o(A,$){if(!(A instanceof $))throw new TypeError("Cannot call a class as a function")}function a(A,$){for(var T=0;T<$.length;T++){var M=$[T];M.enumerable=M.enumerable||!1,M.configurable=!0,"value"in M&&(M.writable=!0),Object.defineProperty(A,M.key,M)}}function s(A,$,T){return $&&a(A.prototype,$),T&&a(A,T),A}var l=e("../utils/col-cache"),p=e("../utils/under-dash"),d=e("./enums"),g=e("../utils/shared-formula").slideFormula,y=e("./note"),h=function(){function A($,T,M){if(o(this,A),!$||!T)throw new Error("A Cell needs a Row");this._row=$,this._column=T,l.validateAddress(M),this._address=M,this._value=N.create(A.Types.Null,this),this.style=this._mergeStyle($.style,T.style,{}),this._mergeCount=0}return s(A,[{key:"destroy",value:function(){delete this.style,delete this._value,delete this._row,delete this._column,delete this._address}},{key:"_mergeStyle",value:function($,T,M){var S=$&&$.numFmt||T&&T.numFmt;S&&(M.numFmt=S);var E=$&&$.font||T&&T.font;E&&(M.font=E);var k=$&&$.alignment||T&&T.alignment;k&&(M.alignment=k);var O=$&&$.border||T&&T.border;O&&(M.border=O);var x=$&&$.fill||T&&T.fill;x&&(M.fill=x);var j=$&&$.protection||T&&T.protection;return j&&(M.protection=j),M}},{key:"toCsvString",value:function(){return this._value.toCsvString()}},{key:"addMergeRef",value:function(){this._mergeCount++}},{key:"releaseMergeRef",value:function(){this._mergeCount--}},{key:"merge",value:function($,T){this._value.release(),this._value=N.create(A.Types.Merge,this,$),T||(this.style=$.style)}},{key:"unmerge",value:function(){this.type===A.Types.Merge&&(this._value.release(),this._value=N.create(A.Types.Null,this),this.style=this._mergeStyle(this._row.style,this._column.style,{}))}},{key:"isMergedTo",value:function($){return this._value.type===A.Types.Merge&&this._value.isMergedTo($)}},{key:"toString",value:function(){return this.text}},{key:"_upgradeToHyperlink",value:function($){this.type===A.Types.String&&(this._value=N.create(A.Types.Hyperlink,this,{text:this._value.value,hyperlink:$}))}},{key:"addName",value:function($){this.workbook.definedNames.addEx(this.fullAddress,$)}},{key:"removeName",value:function($){this.workbook.definedNames.removeEx(this.fullAddress,$)}},{key:"removeAllNames",value:function(){this.workbook.definedNames.removeAllNames(this.fullAddress)}},{key:"worksheet",get:function(){return this._row.worksheet}},{key:"workbook",get:function(){return this._row.worksheet.workbook}},{key:"numFmt",get:function(){return this.style.numFmt},set:function($){this.style.numFmt=$}},{key:"font",get:function(){return this.style.font},set:function($){this.style.font=$}},{key:"alignment",get:function(){return this.style.alignment},set:function($){this.style.alignment=$}},{key:"border",get:function(){return this.style.border},set:function($){this.style.border=$}},{key:"fill",get:function(){return this.style.fill},set:function($){this.style.fill=$}},{key:"protection",get:function(){return this.style.protection},set:function($){this.style.protection=$}},{key:"address",get:function(){return this._address}},{key:"row",get:function(){return this._row.number}},{key:"col",get:function(){return this._column.number}},{key:"$col$row",get:function(){return"$".concat(this._column.letter,"$").concat(this.row)}},{key:"type",get:function(){return this._value.type}},{key:"effectiveType",get:function(){return this._value.effectiveType}},{key:"isMerged",get:function(){return this._mergeCount>0||this.type===A.Types.Merge}},{key:"master",get:function(){return this.type===A.Types.Merge?this._value.master:this}},{key:"isHyperlink",get:function(){return this._value.type===A.Types.Hyperlink}},{key:"hyperlink",get:function(){return this._value.hyperlink}},{key:"value",get:function(){return this._value.value},set:function($){this.type!==A.Types.Merge?(this._value.release(),this._value=N.create(N.getType($),this,$)):this._value.master.value=$}},{key:"note",get:function(){return this._comment&&this._comment.note},set:function($){this._comment=new y($)}},{key:"text",get:function(){return this._value.toString()}},{key:"html",get:function(){return p.escapeHtml(this.text)}},{key:"formula",get:function(){return this._value.formula}},{key:"result",get:function(){return this._value.result}},{key:"formulaType",get:function(){return this._value.formulaType}},{key:"fullAddress",get:function(){return{sheetName:this._row.worksheet.name,address:this.address,row:this.row,col:this.col}}},{key:"name",get:function(){return this.names[0]},set:function($){this.names=[$]}},{key:"names",get:function(){return this.workbook.definedNames.getNamesEx(this.fullAddress)},set:function($){var T=this,M=this.workbook.definedNames;M.removeAllNames(this.fullAddress),$.forEach(function(S){M.addEx(T.fullAddress,S)})}},{key:"_dataValidations",get:function(){return this.worksheet.dataValidations}},{key:"dataValidation",get:function(){return this._dataValidations.find(this.address)},set:function($){this._dataValidations.add(this.address,$)}},{key:"model",get:function(){var $=this._value.model;return $.style=this.style,this._comment&&($.comment=this._comment.model),$},set:function($){if(this._value.release(),this._value=N.create($.type,this),this._value.model=$,$.comment)switch($.comment.type){case"note":this._comment=y.fromModel($.comment)}$.style?this.style=$.style:this.style={}}}]),A}();h.Types=d.ValueType;var u=function(){function A($){o(this,A),this.model={address:$.address,type:h.Types.Null}}return s(A,[{key:"toCsvString",value:function(){return""}},{key:"release",value:function(){}},{key:"toString",value:function(){return""}},{key:"value",get:function(){return null},set:function($){}},{key:"type",get:function(){return h.Types.Null}},{key:"effectiveType",get:function(){return h.Types.Null}},{key:"address",get:function(){return this.model.address},set:function($){this.model.address=$}}]),A}(),f=function(){function A($,T){o(this,A),this.model={address:$.address,type:h.Types.Number,value:T}}return s(A,[{key:"toCsvString",value:function(){return this.model.value.toString()}},{key:"release",value:function(){}},{key:"toString",value:function(){return this.model.value.toString()}},{key:"value",get:function(){return this.model.value},set:function($){this.model.value=$}},{key:"type",get:function(){return h.Types.Number}},{key:"effectiveType",get:function(){return h.Types.Number}},{key:"address",get:function(){return this.model.address},set:function($){this.model.address=$}}]),A}(),c=function(){function A($,T){o(this,A),this.model={address:$.address,type:h.Types.String,value:T}}return s(A,[{key:"toCsvString",value:function(){return'"'.concat(this.model.value.replace(/"/g,'""'),'"')}},{key:"release",value:function(){}},{key:"toString",value:function(){return this.model.value}},{key:"value",get:function(){return this.model.value},set:function($){this.model.value=$}},{key:"type",get:function(){return h.Types.String}},{key:"effectiveType",get:function(){return h.Types.String}},{key:"address",get:function(){return this.model.address},set:function($){this.model.address=$}}]),A}(),v=function(){function A($,T){o(this,A),this.model={address:$.address,type:h.Types.String,value:T}}return s(A,[{key:"toString",value:function(){return this.model.value.richText.map(function($){return $.text}).join("")}},{key:"toCsvString",value:function(){return'"'.concat(this.text.replace(/"/g,'""'),'"')}},{key:"release",value:function(){}},{key:"value",get:function(){return this.model.value},set:function($){this.model.value=$}},{key:"type",get:function(){return h.Types.RichText}},{key:"effectiveType",get:function(){return h.Types.RichText}},{key:"address",get:function(){return this.model.address},set:function($){this.model.address=$}}]),A}(),m=function(){function A($,T){o(this,A),this.model={address:$.address,type:h.Types.Date,value:T}}return s(A,[{key:"toCsvString",value:function(){return this.model.value.toISOString()}},{key:"release",value:function(){}},{key:"toString",value:function(){return this.model.value.toString()}},{key:"value",get:function(){return this.model.value},set:function($){this.model.value=$}},{key:"type",get:function(){return h.Types.Date}},{key:"effectiveType",get:function(){return h.Types.Date}},{key:"address",get:function(){return this.model.address},set:function($){this.model.address=$}}]),A}(),b=function(){function A($,T){o(this,A),this.model={address:$.address,type:h.Types.Hyperlink,text:T?T.text:void 0,hyperlink:T?T.hyperlink:void 0},T&&T.tooltip&&(this.model.tooltip=T.tooltip)}return s(A,[{key:"toCsvString",value:function(){return this.model.hyperlink}},{key:"release",value:function(){}},{key:"toString",value:function(){return this.model.text}},{key:"value",get:function(){var $={text:this.model.text,hyperlink:this.model.hyperlink};return this.model.tooltip&&($.tooltip=this.model.tooltip),$},set:function($){this.model={text:$.text,hyperlink:$.hyperlink},$.tooltip&&(this.model.tooltip=$.tooltip)}},{key:"text",get:function(){return this.model.text},set:function($){this.model.text=$}},{key:"hyperlink",get:function(){return this.model.hyperlink},set:function($){this.model.hyperlink=$}},{key:"type",get:function(){return h.Types.Hyperlink}},{key:"effectiveType",get:function(){return h.Types.Hyperlink}},{key:"address",get:function(){return this.model.address},set:function($){this.model.address=$}}]),A}(),w=function(){function A($,T){o(this,A),this.model={address:$.address,type:h.Types.Merge,master:T?T.address:void 0},this._master=T,T&&T.addMergeRef()}return s(A,[{key:"isMergedTo",value:function($){return $===this._master}},{key:"toCsvString",value:function(){return""}},{key:"release",value:function(){this._master.releaseMergeRef()}},{key:"toString",value:function(){return this.value.toString()}},{key:"value",get:function(){return this._master.value},set:function($){$ instanceof h?(this._master&&this._master.releaseMergeRef(),$.addMergeRef(),this._master=$):this._master.value=$}},{key:"master",get:function(){return this._master}},{key:"type",get:function(){return h.Types.Merge}},{key:"effectiveType",get:function(){return this._master.effectiveType}},{key:"address",get:function(){return this.model.address},set:function($){this.model.address=$}}]),A}(),_=function(){function A($,T){o(this,A),this.cell=$,this.model={address:$.address,type:h.Types.Formula,shareType:T?T.shareType:void 0,ref:T?T.ref:void 0,formula:T?T.formula:void 0,sharedFormula:T?T.sharedFormula:void 0,result:T?T.result:void 0}}return s(A,[{key:"_copyModel",value:function($){var T={},M=function(S){var E=$[S];E&&(T[S]=E)};return M("formula"),M("result"),M("ref"),M("shareType"),M("sharedFormula"),T}},{key:"validate",value:function($){switch(N.getType($)){case h.Types.Null:case h.Types.String:case h.Types.Number:case h.Types.Date:break;case h.Types.Hyperlink:case h.Types.Formula:default:throw new Error("Cannot process that type of result value")}}},{key:"_getTranslatedFormula",value:function(){if(!this._translatedFormula&&this.model.sharedFormula){var $=this.cell.worksheet.findCell(this.model.sharedFormula);this._translatedFormula=$&&g($.formula,$.address,this.model.address)}return this._translatedFormula}},{key:"toCsvString",value:function(){return"".concat(this.model.result||"")}},{key:"release",value:function(){}},{key:"toString",value:function(){return this.model.result?this.model.result.toString():""}},{key:"value",get:function(){return this._copyModel(this.model)},set:function($){this.model=this._copyModel($)}},{key:"dependencies",get:function(){return{ranges:this.formula.match(/([a-zA-Z0-9]+!)?[A-Z]{1,3}\d{1,4}:[A-Z]{1,3}\d{1,4}/g),cells:this.formula.replace(/([a-zA-Z0-9]+!)?[A-Z]{1,3}\d{1,4}:[A-Z]{1,3}\d{1,4}/g,"").match(/([a-zA-Z0-9]+!)?[A-Z]{1,3}\d{1,4}/g)}}},{key:"formula",get:function(){return this.model.formula||this._getTranslatedFormula()},set:function($){this.model.formula=$}},{key:"formulaType",get:function(){return this.model.formula?d.FormulaType.Master:this.model.sharedFormula?d.FormulaType.Shared:d.FormulaType.None}},{key:"result",get:function(){return this.model.result},set:function($){this.model.result=$}},{key:"type",get:function(){return h.Types.Formula}},{key:"effectiveType",get:function(){var $=this.model.result;return $==null?d.ValueType.Null:$ instanceof String||typeof $=="string"?d.ValueType.String:typeof $=="number"?d.ValueType.Number:$ instanceof Date?d.ValueType.Date:$.text&&$.hyperlink?d.ValueType.Hyperlink:$.formula?d.ValueType.Formula:d.ValueType.Null}},{key:"address",get:function(){return this.model.address},set:function($){this.model.address=$}}]),A}(),C=function(){function A($,T){o(this,A),this.model={address:$.address,type:h.Types.SharedString,value:T}}return s(A,[{key:"toCsvString",value:function(){return this.model.value.toString()}},{key:"release",value:function(){}},{key:"toString",value:function(){return this.model.value.toString()}},{key:"value",get:function(){return this.model.value},set:function($){this.model.value=$}},{key:"type",get:function(){return h.Types.SharedString}},{key:"effectiveType",get:function(){return h.Types.SharedString}},{key:"address",get:function(){return this.model.address},set:function($){this.model.address=$}}]),A}(),R=function(){function A($,T){o(this,A),this.model={address:$.address,type:h.Types.Boolean,value:T}}return s(A,[{key:"toCsvString",value:function(){return this.model.value?1:0}},{key:"release",value:function(){}},{key:"toString",value:function(){return this.model.value.toString()}},{key:"value",get:function(){return this.model.value},set:function($){this.model.value=$}},{key:"type",get:function(){return h.Types.Boolean}},{key:"effectiveType",get:function(){return h.Types.Boolean}},{key:"address",get:function(){return this.model.address},set:function($){this.model.address=$}}]),A}(),I=function(){function A($,T){o(this,A),this.model={address:$.address,type:h.Types.Error,value:T}}return s(A,[{key:"toCsvString",value:function(){return this.toString()}},{key:"release",value:function(){}},{key:"toString",value:function(){return this.model.value.error.toString()}},{key:"value",get:function(){return this.model.value},set:function($){this.model.value=$}},{key:"type",get:function(){return h.Types.Error}},{key:"effectiveType",get:function(){return h.Types.Error}},{key:"address",get:function(){return this.model.address},set:function($){this.model.address=$}}]),A}(),P=function(){function A($,T){o(this,A),this.model={address:$.address,type:h.Types.String,value:JSON.stringify(T),rawValue:T}}return s(A,[{key:"toCsvString",value:function(){return this.model.value}},{key:"release",value:function(){}},{key:"toString",value:function(){return this.model.value}},{key:"value",get:function(){return this.model.rawValue},set:function($){this.model.rawValue=$,this.model.value=JSON.stringify($)}},{key:"type",get:function(){return h.Types.String}},{key:"effectiveType",get:function(){return h.Types.String}},{key:"address",get:function(){return this.model.address},set:function($){this.model.address=$}}]),A}(),N={getType:function(A){return A==null?h.Types.Null:A instanceof String||typeof A=="string"?h.Types.String:typeof A=="number"?h.Types.Number:typeof A=="boolean"?h.Types.Boolean:A instanceof Date?h.Types.Date:A.text&&A.hyperlink?h.Types.Hyperlink:A.formula||A.sharedFormula?h.Types.Formula:A.richText?h.Types.RichText:A.sharedString?h.Types.SharedString:A.error?h.Types.Error:h.Types.JSON},types:[{t:h.Types.Null,f:u},{t:h.Types.Number,f},{t:h.Types.String,f:c},{t:h.Types.Date,f:m},{t:h.Types.Hyperlink,f:b},{t:h.Types.Formula,f:_},{t:h.Types.Merge,f:w},{t:h.Types.JSON,f:P},{t:h.Types.SharedString,f:C},{t:h.Types.RichText,f:v},{t:h.Types.Boolean,f:R},{t:h.Types.Error,f:I}].reduce(function(A,$){return A[$.t]=$.f,A},[]),create:function(A,$,T){var M=this.types[A];if(!M)throw new Error("Could not create Value of type ".concat(A));return new M($,T)}};n.exports=h},{"../utils/col-cache":19,"../utils/shared-formula":22,"../utils/under-dash":25,"./enums":7,"./note":9}],4:[function(e,n,i){function o(d,g){for(var y=0;y<g.length;y++){var h=g[y];h.enumerable=h.enumerable||!1,h.configurable=!0,"value"in h&&(h.writable=!0),Object.defineProperty(d,h.key,h)}}var a=e("../utils/under-dash"),s=e("./enums"),l=e("../utils/col-cache"),p=function(){function d(u,f,c){(function(v,m){if(!(v instanceof m))throw new TypeError("Cannot call a class as a function")})(this,d),this._worksheet=u,this._number=f,c!==!1&&(this.defn=c)}var g,y,h;return g=d,h=[{key:"toModel",value:function(u){var f=[],c=null;return u&&u.forEach(function(v,m){v.isDefault?c&&(c=null):c&&v.equivalentTo(c)?c.max=m+1:(c={min:m+1,max:m+1,width:v.width!==void 0?v.width:9,style:v.style,isCustomWidth:v.isCustomWidth,hidden:v.hidden,outlineLevel:v.outlineLevel,collapsed:v.collapsed},f.push(c))}),f.length?f:void 0}},{key:"fromModel",value:function(u,f){f=f||[];for(var c=[],v=1,m=0;m<f.length;){for(var b=f[m++];v<b.min;)c.push(new d(u,v++));for(;v<=b.max;)c.push(new d(u,v++,b))}return c.length?c:null}}],(y=[{key:"toString",value:function(){return JSON.stringify({key:this.key,width:this.width,headers:this.headers.length?this.headers:void 0})}},{key:"equivalentTo",value:function(u){return this.width===u.width&&this.hidden===u.hidden&&this.outlineLevel===u.outlineLevel&&a.isEqual(this.style,u.style)}},{key:"eachCell",value:function(u,f){var c=this.number;f||(f=u,u=null),this._worksheet.eachRow(u,function(v,m){f(v.getCell(c),m)})}},{key:"_applyStyle",value:function(u,f){return this.style[u]=f,this.eachCell(function(c){c[u]=f}),f}},{key:"number",get:function(){return this._number}},{key:"worksheet",get:function(){return this._worksheet}},{key:"letter",get:function(){return l.n2l(this._number)}},{key:"isCustomWidth",get:function(){return this.width!==void 0&&this.width!==9}},{key:"defn",get:function(){return{header:this._header,key:this.key,width:this.width,style:this.style,hidden:this.hidden,outlineLevel:this.outlineLevel}},set:function(u){u?(this.key=u.key,this.width=u.width!==void 0?u.width:9,this.outlineLevel=u.outlineLevel,u.style?this.style=u.style:this.style={},this.header=u.header,this._hidden=!!u.hidden):(delete this._header,delete this._key,delete this.width,this.style={},this.outlineLevel=0)}},{key:"headers",get:function(){return this._header&&this._header instanceof Array?this._header:[this._header]}},{key:"header",get:function(){return this._header},set:function(u){var f=this;u!==void 0?(this._header=u,this.headers.forEach(function(c,v){f._worksheet.getCell(v+1,f.number).value=c})):this._header=void 0}},{key:"key",get:function(){return this._key},set:function(u){(this._key&&this._worksheet.getColumnKey(this._key))===this&&this._worksheet.deleteColumnKey(this._key),this._key=u,u&&this._worksheet.setColumnKey(this._key,this)}},{key:"hidden",get:function(){return!!this._hidden},set:function(u){this._hidden=u}},{key:"outlineLevel",get:function(){return this._outlineLevel||0},set:function(u){this._outlineLevel=u}},{key:"collapsed",get:function(){return!!(this._outlineLevel&&this._outlineLevel>=this._worksheet.properties.outlineLevelCol)}},{key:"isDefault",get:function(){if(this.isCustomWidth||this.hidden||this.outlineLevel)return!1;var u=this.style;return!u||!(u.font||u.numFmt||u.alignment||u.border||u.fill||u.protection)}},{key:"headerCount",get:function(){return this.headers.length}},{key:"values",get:function(){var u=[];return this.eachCell(function(f,c){f&&f.type!==s.ValueType.Null&&(u[c]=f.value)}),u},set:function(u){var f=this;if(u){var c=this.number,v=0;u.hasOwnProperty("0")&&(v=1),u.forEach(function(m,b){f._worksheet.getCell(b+v,c).value=m})}}},{key:"numFmt",get:function(){return this.style.numFmt},set:function(u){this._applyStyle("numFmt",u)}},{key:"font",get:function(){return this.style.font},set:function(u){this._applyStyle("font",u)}},{key:"alignment",get:function(){return this.style.alignment},set:function(u){this._applyStyle("alignment",u)}},{key:"protection",get:function(){return this.style.protection},set:function(u){this._applyStyle("protection",u)}},{key:"border",get:function(){return this.style.border},set:function(u){this._applyStyle("border",u)}},{key:"fill",get:function(){return this.style.fill},set:function(u){this._applyStyle("fill",u)}}])&&o(g.prototype,y),h&&o(g,h),d}();n.exports=p},{"../utils/col-cache":19,"../utils/under-dash":25,"./enums":7}],5:[function(e,n,i){function o(s,l){for(var p=0;p<l.length;p++){var d=l[p];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(s,d.key,d)}}var a=function(){function s(d){(function(g,y){if(!(g instanceof y))throw new TypeError("Cannot call a class as a function")})(this,s),this.model=d||{}}var l,p;return l=s,(p=[{key:"add",value:function(d,g){return this.model[d]=g}},{key:"find",value:function(d){return this.model[d]}},{key:"remove",value:function(d){this.model[d]=void 0}}])&&o(l.prototype,p),s}();n.exports=a},{}],6:[function(e,n,i){function o(y,h){for(var u=0;u<h.length;u++){var f=h[u];f.enumerable=f.enumerable||!1,f.configurable=!0,"value"in f&&(f.writable=!0),Object.defineProperty(y,f.key,f)}}var a=e("../utils/under-dash"),s=e("../utils/col-cache"),l=e("../utils/cell-matrix"),p=e("./range"),d=/[$](\w+)[$](\d+)(:[$](\w+)[$](\d+))?/,g=function(){function y(){(function(f,c){if(!(f instanceof c))throw new TypeError("Cannot call a class as a function")})(this,y),this.matrixMap={}}var h,u;return h=y,(u=[{key:"getMatrix",value:function(f){return this.matrixMap[f]||(this.matrixMap[f]=new l)}},{key:"add",value:function(f,c){var v=s.decodeEx(f);this.addEx(v,c)}},{key:"addEx",value:function(f,c){var v=this.getMatrix(c);if(f.top)for(var m=f.left;m<=f.right;m++)for(var b=f.top;b<=f.bottom;b++){var w={sheetName:f.sheetName,address:s.n2l(m)+b,row:b,col:m};v.addCellEx(w)}else v.addCellEx(f)}},{key:"remove",value:function(f,c){var v=s.decodeEx(f);this.removeEx(v,c)}},{key:"removeEx",value:function(f,c){this.getMatrix(c).removeCellEx(f)}},{key:"removeAllNames",value:function(f){a.each(this.matrixMap,function(c){c.removeCellEx(f)})}},{key:"forEach",value:function(f){a.each(this.matrixMap,function(c,v){c.forEach(function(m){f(v,m)})})}},{key:"getNames",value:function(f){return this.getNamesEx(s.decodeEx(f))}},{key:"getNamesEx",value:function(f){return a.map(this.matrixMap,function(c,v){return c.findCellEx(f)&&v}).filter(Boolean)}},{key:"_explore",value:function(f,c){c.mark=!1;var v,m,b=c.sheetName,w=new p(c.row,c.col,c.row,c.col,b);function _(R,I){var P=f.findCellAt(b,R,c.col);return!(!P||!P.mark||(w[I]=R,P.mark=!1,0))}for(m=c.row-1;_(m,"top");m--);for(m=c.row+1;_(m,"bottom");m++);function C(R,I){var P=[];for(m=w.top;m<=w.bottom;m++){var N=f.findCellAt(b,m,R);if(!N||!N.mark)return!1;P.push(N)}w[I]=R;for(var A=0;A<P.length;A++)P[A].mark=!1;return!0}for(v=c.col-1;C(v,"left");v--);for(v=c.col+1;C(v,"right");v++);return w}},{key:"getRanges",value:function(f,c){var v=this;return(c=c||this.matrixMap[f])?(c.forEach(function(m){m.mark=!0}),{name:f,ranges:c.map(function(m){return m.mark&&v._explore(c,m)}).filter(Boolean).map(function(m){return m.$shortRange})}):{name:f,ranges:[]}}},{key:"normaliseMatrix",value:function(f,c){f.forEachInSheet(c,function(v,m,b){v&&(v.row===m&&v.col===b||(v.row=m,v.col=b,v.address=s.n2l(b)+m))})}},{key:"spliceRows",value:function(f,c,v,m){var b=this;a.each(this.matrixMap,function(w){w.spliceRows(f,c,v,m),b.normaliseMatrix(w,f)})}},{key:"spliceColumns",value:function(f,c,v,m){var b=this;a.each(this.matrixMap,function(w){w.spliceColumns(f,c,v,m),b.normaliseMatrix(w,f)})}},{key:"model",get:function(){var f=this;return a.map(this.matrixMap,function(c,v){return f.getRanges(v,c)}).filter(function(c){return c.ranges.length})},set:function(f){var c=this.matrixMap={};f.forEach(function(v){var m=c[v.name]=new l;v.ranges.forEach(function(b){d.test(b.split("!").pop()||"")&&m.addCell(b)})})}}])&&o(h.prototype,u),y}();n.exports=g},{"../utils/cell-matrix":18,"../utils/col-cache":19,"../utils/under-dash":25,"./range":10}],7:[function(e,n,i){n.exports={ValueType:{Null:0,Merge:1,Number:2,String:3,Date:4,Hyperlink:5,Formula:6,SharedString:7,RichText:8,Boolean:9,Error:10},FormulaType:{None:0,Master:1,Shared:2},RelationshipType:{None:0,OfficeDocument:1,Worksheet:2,CalcChain:3,SharedStrings:4,Styles:5,Theme:6,Hyperlink:7},DocumentType:{Xlsx:1},ReadingOrder:{LeftToRight:1,RightToLeft:2},ErrorValue:{NotApplicable:"#N/A",Ref:"#REF!",Name:"#NAME?",DivZero:"#DIV/0!",Null:"#NULL!",Value:"#VALUE!",Num:"#NUM!"}}},{}],8:[function(e,n,i){function o(p,d){for(var g=0;g<d.length;g++){var y=d[g];y.enumerable=y.enumerable||!1,y.configurable=!0,"value"in y&&(y.writable=!0),Object.defineProperty(p,y.key,y)}}var a=e("../utils/col-cache"),s=e("./anchor"),l=function(){function p(y,h){(function(u,f){if(!(u instanceof f))throw new TypeError("Cannot call a class as a function")})(this,p),this.worksheet=y,this.model=h}var d,g;return d=p,(g=[{key:"model",get:function(){switch(this.type){case"background":return{type:this.type,imageId:this.imageId};case"image":return{type:this.type,imageId:this.imageId,hyperlinks:this.range.hyperlinks,range:{tl:this.range.tl.model,br:this.range.br&&this.range.br.model,ext:this.range.ext,editAs:this.range.editAs}};default:throw new Error("Invalid Image Type")}},set:function(y){var h=y.type,u=y.imageId,f=y.range,c=y.hyperlinks;if(this.type=h,this.imageId=u,h==="image")if(typeof f=="string"){var v=a.decode(f);this.range={tl:new s(this.worksheet,{col:v.left,row:v.top},-1),br:new s(this.worksheet,{col:v.right,row:v.bottom},0),editAs:"oneCell"}}else this.range={tl:new s(this.worksheet,f.tl,0),br:f.br&&new s(this.worksheet,f.br,0),ext:f.ext,editAs:f.editAs,hyperlinks:c||f.hyperlinks}}}])&&o(d.prototype,g),p}();n.exports=l},{"../utils/col-cache":19,"./anchor":2}],9:[function(e,n,i){function o(p){return(o=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(d){return typeof d}:function(d){return d&&typeof Symbol=="function"&&d.constructor===Symbol&&d!==Symbol.prototype?"symbol":typeof d})(p)}function a(p,d){for(var g=0;g<d.length;g++){var y=d[g];y.enumerable=y.enumerable||!1,y.configurable=!0,"value"in y&&(y.writable=!0),Object.defineProperty(p,y.key,y)}}var s=e("../utils/under-dash"),l=function(){function p(h){(function(u,f){if(!(u instanceof f))throw new TypeError("Cannot call a class as a function")})(this,p),this.note=h}var d,g,y;return d=p,y=[{key:"fromModel",value:function(h){var u=new p;return u.model=h,u}}],(g=[{key:"model",get:function(){var h=null;switch(o(this.note)){case"string":h={type:"note",note:{texts:[{text:this.note}]}};break;default:h={type:"note",note:this.note}}return s.deepMerge({},p.DEFAULT_CONFIGS,h)},set:function(h){var u=h.note,f=u.texts;f.length===1&&Object.keys(f[0]).length===1?this.note=f[0].text:this.note=u}}])&&a(d.prototype,g),y&&a(d,y),p}();l.DEFAULT_CONFIGS={note:{margins:{insetmode:"auto",inset:[.13,.13,.25,.25]},protection:{locked:"True",lockText:"True"},editAs:"absolute"}},n.exports=l},{"../utils/under-dash":25}],10:[function(e,n,i){function o(p,d){if(!(p instanceof d))throw new TypeError("Cannot call a class as a function")}function a(p,d){for(var g=0;g<d.length;g++){var y=d[g];y.enumerable=y.enumerable||!1,y.configurable=!0,"value"in y&&(y.writable=!0),Object.defineProperty(p,y.key,y)}}var s=e("../utils/col-cache"),l=function(){function p(){o(this,p),this.decode(arguments)}var d,g;return d=p,(g=[{key:"setTLBR",value:function(y,h,u,f,c){if(arguments.length<4){var v=s.decodeAddress(y),m=s.decodeAddress(h);this.model={top:Math.min(v.row,m.row),left:Math.min(v.col,m.col),bottom:Math.max(v.row,m.row),right:Math.max(v.col,m.col),sheetName:u},this.setTLBR(v.row,v.col,m.row,m.col,c)}else this.model={top:Math.min(y,u),left:Math.min(h,f),bottom:Math.max(y,u),right:Math.max(h,f),sheetName:c}}},{key:"decode",value:function(y){switch(y.length){case 5:this.setTLBR(y[0],y[1],y[2],y[3],y[4]);break;case 4:this.setTLBR(y[0],y[1],y[2],y[3]);break;case 3:this.setTLBR(y[0],y[1],y[2]);break;case 2:this.setTLBR(y[0],y[1]);break;case 1:var h=y[0];if(h instanceof p)this.model={top:h.model.top,left:h.model.left,bottom:h.model.bottom,right:h.model.right,sheetName:h.sheetName};else if(h instanceof Array)this.decode(h);else if(h.top&&h.left&&h.bottom&&h.right)this.model={top:h.top,left:h.left,bottom:h.bottom,right:h.right,sheetName:h.sheetName};else{var u=s.decodeEx(h);u.top?this.model={top:u.top,left:u.left,bottom:u.bottom,right:u.right,sheetName:u.sheetName}:this.model={top:u.row,left:u.col,bottom:u.row,right:u.col,sheetName:u.sheetName}}break;case 0:this.model={top:0,left:0,bottom:0,right:0};break;default:throw new Error("Invalid number of arguments to _getDimensions() - ".concat(y.length))}}},{key:"expand",value:function(y,h,u,f){(!this.model.top||y<this.top)&&(this.top=y),(!this.model.left||h<this.left)&&(this.left=h),(!this.model.bottom||u>this.bottom)&&(this.bottom=u),(!this.model.right||f>this.right)&&(this.right=f)}},{key:"expandRow",value:function(y){if(y){var h=y.dimensions,u=y.number;h&&this.expand(u,h.min,u,h.max)}}},{key:"expandToAddress",value:function(y){var h=s.decodeEx(y);this.expand(h.row,h.col,h.row,h.col)}},{key:"toString",value:function(){return this.range}},{key:"intersects",value:function(y){return!(y.sheetName&&this.sheetName&&y.sheetName!==this.sheetName||y.bottom<this.top||y.top>this.bottom||y.right<this.left||y.left>this.right)}},{key:"contains",value:function(y){var h=s.decodeEx(y);return this.containsEx(h)}},{key:"containsEx",value:function(y){return(!y.sheetName||!this.sheetName||y.sheetName===this.sheetName)&&y.row>=this.top&&y.row<=this.bottom&&y.col>=this.left&&y.col<=this.right}},{key:"forEachAddress",value:function(y){for(var h=this.left;h<=this.right;h++)for(var u=this.top;u<=this.bottom;u++)y(s.encodeAddress(u,h),u,h)}},{key:"top",get:function(){return this.model.top||1},set:function(y){this.model.top=y}},{key:"left",get:function(){return this.model.left||1},set:function(y){this.model.left=y}},{key:"bottom",get:function(){return this.model.bottom||1},set:function(y){this.model.bottom=y}},{key:"right",get:function(){return this.model.right||1},set:function(y){this.model.right=y}},{key:"sheetName",get:function(){return this.model.sheetName},set:function(y){this.model.sheetName=y}},{key:"_serialisedSheetName",get:function(){var y=this.model.sheetName;return y?/^[a-zA-Z0-9]*$/.test(y)?"".concat(y,"!"):"'".concat(y,"'!"):""}},{key:"tl",get:function(){return s.n2l(this.left)+this.top}},{key:"$t$l",get:function(){return"$".concat(s.n2l(this.left),"$").concat(this.top)}},{key:"br",get:function(){return s.n2l(this.right)+this.bottom}},{key:"$b$r",get:function(){return"$".concat(s.n2l(this.right),"$").concat(this.bottom)}},{key:"range",get:function(){return"".concat(this._serialisedSheetName+this.tl,":").concat(this.br)}},{key:"$range",get:function(){return"".concat(this._serialisedSheetName+this.$t$l,":").concat(this.$b$r)}},{key:"shortRange",get:function(){return this.count>1?this.range:this._serialisedSheetName+this.tl}},{key:"$shortRange",get:function(){return this.count>1?this.$range:this._serialisedSheetName+this.$t$l}},{key:"count",get:function(){return(1+this.bottom-this.top)*(1+this.right-this.left)}}])&&a(d.prototype,g),p}();n.exports=l},{"../utils/col-cache":19}],11:[function(e,n,i){function o(g,y){for(var h=0;h<y.length;h++){var u=y[h];u.enumerable=u.enumerable||!1,u.configurable=!0,"value"in u&&(u.writable=!0),Object.defineProperty(g,u.key,u)}}var a=e("../utils/under-dash"),s=e("./enums"),l=e("../utils/col-cache"),p=e("./cell"),d=function(){function g(u,f){(function(c,v){if(!(c instanceof v))throw new TypeError("Cannot call a class as a function")})(this,g),this._worksheet=u,this._number=f,this._cells=[],this.style={},this.outlineLevel=0}var y,h;return y=g,(h=[{key:"commit",value:function(){this._worksheet._commitRow(this)}},{key:"destroy",value:function(){delete this._worksheet,delete this._cells,delete this.style}},{key:"findCell",value:function(u){return this._cells[u-1]}},{key:"getCellEx",value:function(u){var f=this._cells[u.col-1];if(!f){var c=this._worksheet.getColumn(u.col);f=new p(this,c,u.address),this._cells[u.col-1]=f}return f}},{key:"getCell",value:function(u){if(typeof u=="string"){var f=this._worksheet.getColumnKey(u);u=f?f.number:l.l2n(u)}return this._cells[u-1]||this.getCellEx({address:l.encodeAddress(this._number,u),row:this._number,col:u})}},{key:"splice",value:function(u,f){for(var c=u+f,v=arguments.length,m=new Array(v>2?v-2:0),b=2;b<v;b++)m[b-2]=arguments[b];var w,_,C,R=m.length-f,I=this._cells.length;if(R<0)for(w=u+m.length;w<=I;w++)C=this._cells[w-1],(_=this._cells[w-R-1])?((C=this.getCell(w)).value=_.value,C.style=_.style,C._comment=_._comment):C&&(C.value=null,C.style={},C._comment=void 0);else if(R>0)for(w=I;w>=c;w--)(_=this._cells[w-1])?((C=this.getCell(w+R)).value=_.value,C.style=_.style,C._comment=_._comment):this._cells[w+R-1]=void 0;for(w=0;w<m.length;w++)(C=this.getCell(u+w)).value=m[w],C.style={},C._comment=void 0}},{key:"eachCell",value:function(u,f){if(f||(f=u,u=null),u&&u.includeEmpty)for(var c=this._cells.length,v=1;v<=c;v++)f(this.getCell(v),v);else this._cells.forEach(function(m,b){m&&m.type!==s.ValueType.Null&&f(m,b+1)})}},{key:"addPageBreak",value:function(u,f){var c=this._worksheet,v=Math.max(0,u-1)||0,m=Math.max(0,f-1)||16838,b={id:this._number,max:m,man:1};v&&(b.min=v),c.rowBreaks.push(b)}},{key:"_applyStyle",value:function(u,f){return this.style[u]=f,this._cells.forEach(function(c){c&&(c[u]=f)}),f}},{key:"number",get:function(){return this._number}},{key:"worksheet",get:function(){return this._worksheet}},{key:"values",get:function(){var u=[];return this._cells.forEach(function(f){f&&f.type!==s.ValueType.Null&&(u[f.col]=f.value)}),u},set:function(u){var f=this;if(this._cells=[],u)if(u instanceof Array){var c=0;u.hasOwnProperty("0")&&(c=1),u.forEach(function(v,m){v!==void 0&&(f.getCellEx({address:l.encodeAddress(f._number,m+c),row:f._number,col:m+c}).value=v)})}else this._worksheet.eachColumnKey(function(v,m){u[m]!==void 0&&(f.getCellEx({address:l.encodeAddress(f._number,v.number),row:f._number,col:v.number}).value=u[m])})}},{key:"hasValues",get:function(){return a.some(this._cells,function(u){return u&&u.type!==s.ValueType.Null})}},{key:"cellCount",get:function(){return this._cells.length}},{key:"actualCellCount",get:function(){var u=0;return this.eachCell(function(){u++}),u}},{key:"dimensions",get:function(){var u=0,f=0;return this._cells.forEach(function(c){c&&c.type!==s.ValueType.Null&&((!u||u>c.col)&&(u=c.col),f<c.col&&(f=c.col))}),u>0?{min:u,max:f}:null}},{key:"numFmt",get:function(){return this.style.numFmt},set:function(u){this._applyStyle("numFmt",u)}},{key:"font",get:function(){return this.style.font},set:function(u){this._applyStyle("font",u)}},{key:"alignment",get:function(){return this.style.alignment},set:function(u){this._applyStyle("alignment",u)}},{key:"protection",get:function(){return this.style.protection},set:function(u){this._applyStyle("protection",u)}},{key:"border",get:function(){return this.style.border},set:function(u){this._applyStyle("border",u)}},{key:"fill",get:function(){return this.style.fill},set:function(u){this._applyStyle("fill",u)}},{key:"hidden",get:function(){return!!this._hidden},set:function(u){this._hidden=u}},{key:"outlineLevel",get:function(){return this._outlineLevel||0},set:function(u){this._outlineLevel=u}},{key:"collapsed",get:function(){return!!(this._outlineLevel&&this._outlineLevel>=this._worksheet.properties.outlineLevelRow)}},{key:"model",get:function(){var u=[],f=0,c=0;return this._cells.forEach(function(v){if(v){var m=v.model;m&&((!f||f>v.col)&&(f=v.col),c<v.col&&(c=v.col),u.push(m))}}),this.height||u.length?{cells:u,number:this.number,min:f,max:c,height:this.height,style:this.style,hidden:this.hidden,outlineLevel:this.outlineLevel,collapsed:this.collapsed}:null},set:function(u){var f,c=this;if(u.number!==this._number)throw new Error("Invalid row number in model");this._cells=[],u.cells.forEach(function(v){switch(v.type){case p.Types.Merge:break;default:var m;if(v.address)m=l.decodeAddress(v.address);else if(f){var b=f.row,w=f.col+1;m={row:b,col:w,address:l.encodeAddress(b,w),$col$row:"$".concat(l.n2l(w),"$").concat(b)}}f=m,c.getCellEx(m).model=v}}),u.height?this.height=u.height:delete this.height,this.hidden=u.hidden,this.outlineLevel=u.outlineLevel||0,this.style=u.style&&JSON.parse(JSON.stringify(u.style))||{}}}])&&o(y.prototype,h),g}();n.exports=d},{"../utils/col-cache":19,"../utils/under-dash":25,"./cell":3,"./enums":7}],12:[function(e,n,i){function o(g,y){if(!(g instanceof y))throw new TypeError("Cannot call a class as a function")}function a(g,y){for(var h=0;h<y.length;h++){var u=y[h];u.enumerable=u.enumerable||!1,u.configurable=!0,"value"in u&&(u.writable=!0),Object.defineProperty(g,u.key,u)}}function s(g,y,h){return y&&a(g.prototype,y),h&&a(g,h),g}var l=e("../utils/col-cache"),p=function(){function g(y,h,u){o(this,g),this.table=y,this.column=h,this.index=u}return s(g,[{key:"_set",value:function(y,h){this.table.cacheState(),this.column[y]=h}},{key:"name",get:function(){return this.column.name},set:function(y){this._set("name",y)}},{key:"filterButton",get:function(){return this.column.filterButton},set:function(y){this.column.filterButton=y}},{key:"style",get:function(){return this.column.style},set:function(y){this.column.style=y}},{key:"totalsRowLabel",get:function(){return this.column.totalsRowLabel},set:function(y){this._set("totalsRowLabel",y)}},{key:"totalsRowFunction",get:function(){return this.column.totalsRowFunction},set:function(y){this._set("totalsRowFunction",y)}},{key:"totalsRowResult",get:function(){return this.column.totalsRowResult},set:function(y){this._set("totalsRowResult",y)}},{key:"totalsRowFormula",get:function(){return this.column.totalsRowFormula},set:function(y){this._set("totalsRowFormula",y)}}]),g}(),d=function(){function g(y,h){o(this,g),this.worksheet=y,h&&(this.table=h,this.validate(),this.store())}return s(g,[{key:"getFormula",value:function(y){switch(y.totalsRowFunction){case"none":return null;case"average":return"SUBTOTAL(101,".concat(this.table.name,"[").concat(y.name,"])");case"countNums":return"SUBTOTAL(102,".concat(this.table.name,"[").concat(y.name,"])");case"count":return"SUBTOTAL(103,".concat(this.table.name,"[").concat(y.name,"])");case"max":return"SUBTOTAL(104,".concat(this.table.name,"[").concat(y.name,"])");case"min":return"SUBTOTAL(105,".concat(this.table.name,"[").concat(y.name,"])");case"stdDev":return"SUBTOTAL(106,".concat(this.table.name,"[").concat(y.name,"])");case"var":return"SUBTOTAL(107,".concat(this.table.name,"[").concat(y.name,"])");case"sum":return"SUBTOTAL(109,".concat(this.table.name,"[").concat(y.name,"])");case"custom":return y.totalsRowFormula;default:throw new Error("Invalid Totals Row Function: ".concat(y.totalsRowFunction))}}},{key:"validate",value:function(){var y=this,h=this.table,u=function(C,R,I){C[R]===void 0&&(C[R]=I)};u(h,"headerRow",!0),u(h,"totalsRow",!1),u(h,"style",{}),u(h.style,"theme","TableStyleMedium2"),u(h.style,"showFirstColumn",!1),u(h.style,"showLastColumn",!1),u(h.style,"showRowStripes",!1),u(h.style,"showColumnStripes",!1);var f=function(C,R){if(!C)throw new Error(R)};f(h.ref,"Table must have ref"),f(h.columns,"Table must have column definitions"),f(h.rows,"Table must have row definitions"),h.tl=l.decodeAddress(h.ref);var c=h.tl,v=c.row,m=c.col;f(v>0,"Table must be on valid row"),f(m>0,"Table must be on valid col");var b=this.width,w=this.filterHeight,_=this.tableHeight;h.autoFilterRef=l.encode(v,m,v+w-1,m+b-1),h.tableRef=l.encode(v,m,v+_-1,m+b-1),h.columns.forEach(function(C,R){f(C.name,"Column ".concat(R," must have a name")),R===0?u(C,"totalsRowLabel","Total"):(u(C,"totalsRowFunction","none"),C.totalsRowFormula=y.getFormula(C))})}},{key:"store",value:function(){var y=this,h=function(C,R){R&&Object.keys(R).forEach(function(I){C[I]=R[I]})},u=this.worksheet,f=this.table,c=f.tl,v=c.row,m=c.col,b=0;if(f.headerRow){var w=u.getRow(v+b++);f.columns.forEach(function(C,R){var I=C.style,P=C.name,N=w.getCell(m+R);N.value=P,h(N,I)})}if(f.rows.forEach(function(C){var R=u.getRow(v+b++);C.forEach(function(I,P){var N=R.getCell(m+P);N.value=I,h(N,f.columns[P].style)})}),f.totalsRow){var _=u.getRow(v+b++);f.columns.forEach(function(C,R){var I=_.getCell(m+R);if(R===0)I.value=C.totalsRowLabel;else{var P=y.getFormula(C);I.value=P?{formula:C.totalsRowFormula,result:C.totalsRowResult}:null}h(I,C.style)})}}},{key:"load",value:function(y){var h=this,u=this.table,f=u.tl,c=f.row,v=f.col,m=0;if(u.headerRow){var b=y.getRow(c+m++);u.columns.forEach(function(_,C){b.getCell(v+C).value=_.name})}if(u.rows.forEach(function(_){var C=y.getRow(c+m++);_.forEach(function(R,I){C.getCell(v+I).value=R})}),u.totalsRow){var w=y.getRow(c+m++);u.columns.forEach(function(_,C){var R=w.getCell(v+C);C===0?R.value=_.totalsRowLabel:h.getFormula(_)&&(R.value={formula:_.totalsRowFormula,result:_.totalsRowResult})})}}},{key:"cacheState",value:function(){this._cache||(this._cache={ref:this.ref,width:this.width,tableHeight:this.tableHeight})}},{key:"commit",value:function(){if(this._cache){this.validate();var y=l.decodeAddress(this._cache.ref);if(this.ref!==this._cache.ref)for(var h=0;h<this._cache.tableHeight;h++)for(var u=this.worksheet.getRow(y.row+h),f=0;f<this._cache.width;f++)u.getCell(y.col+f).value=null;else{for(var c=this.tableHeight;c<this._cache.tableHeight;c++)for(var v=this.worksheet.getRow(y.row+c),m=0;m<this._cache.width;m++)v.getCell(y.col+m).value=null;for(var b=0;b<this.tableHeight;b++)for(var w=this.worksheet.getRow(y.row+b),_=this.width;_<this._cache.width;_++)w.getCell(y.col+_).value=null}this.store()}}},{key:"addRow",value:function(y,h){this.cacheState(),h===void 0?this.table.rows.push(y):this.table.rows.splice(h,0,y)}},{key:"removeRows",value:function(y){var h=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cacheState(),this.table.rows.splice(y,h)}},{key:"getColumn",value:function(y){var h=this.table.columns[y];return new p(this,h,y)}},{key:"addColumn",value:function(y,h,u){this.cacheState(),u===void 0?(this.table.columns.push(y),this.table.rows.forEach(function(f,c){f.push(h[c])})):(this.table.columns.splice(u,0,y),this.table.rows.forEach(function(f,c){f.splice(u,0,h[c])}))}},{key:"removeColumns",value:function(y){var h=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cacheState(),this.table.columns.splice(y,h),this.table.rows.forEach(function(u){u.splice(y,h)})}},{key:"_assign",value:function(y,h,u){this.cacheState(),y[h]=u}},{key:"width",get:function(){return this.table.columns.length}},{key:"height",get:function(){return this.table.rows.length}},{key:"filterHeight",get:function(){return this.height+(this.table.headerRow?1:0)}},{key:"tableHeight",get:function(){return this.filterHeight+(this.table.totalsRow?1:0)}},{key:"model",get:function(){return this.table},set:function(y){this.table=y}},{key:"ref",get:function(){return this.table.ref},set:function(y){this._assign(this.table,"ref",y)}},{key:"name",get:function(){return this.table.name},set:function(y){this.table.name=y}},{key:"displayName",get:function(){return this.table.displyName||this.table.name}},{key:"displayNamename",set:function(y){this.table.displayName=y}},{key:"headerRow",get:function(){return this.table.headerRow},set:function(y){this._assign(this.table,"headerRow",y)}},{key:"totalsRow",get:function(){return this.table.totalsRow},set:function(y){this._assign(this.table,"totalsRow",y)}},{key:"theme",get:function(){return this.table.style.name},set:function(y){this.table.style.name=y}},{key:"showFirstColumn",get:function(){return this.table.style.showFirstColumn},set:function(y){this.table.style.showFirstColumn=y}},{key:"showLastColumn",get:function(){return this.table.style.showLastColumn},set:function(y){this.table.style.showLastColumn=y}},{key:"showRowStripes",get:function(){return this.table.style.showRowStripes},set:function(y){this.table.style.showRowStripes=y}},{key:"showColumnStripes",get:function(){return this.table.style.showColumnStripes},set:function(y){this.table.style.showColumnStripes=y}}]),g}();n.exports=d},{"../utils/col-cache":19}],13:[function(e,n,i){function o(g,y){for(var h=0;h<y.length;h++){var u=y[h];u.enumerable=u.enumerable||!1,u.configurable=!0,"value"in u&&(u.writable=!0),Object.defineProperty(g,u.key,u)}}var a=e("./worksheet"),s=e("./defined-names"),l=e("../xlsx/xlsx"),p=e("../csv/csv"),d=function(){function g(){(function(u,f){if(!(u instanceof f))throw new TypeError("Cannot call a class as a function")})(this,g),this.category="",this.company="",this.created=new Date,this.description="",this.keywords="",this.manager="",this.modified=this.created,this.properties={},this.calcProperties={},this._worksheets=[],this.subject="",this.title="",this.views=[],this.media=[],this._definedNames=new s}var y,h;return y=g,(h=[{key:"addWorksheet",value:function(u,f){var c=this.nextId;if(u&&u.length>31&&console.warn("Worksheet name ".concat(u," exceeds 31 chars. This will be truncated")),/[*?:/\\[\]]/.test(u))throw new Error("Worksheet name ".concat(u," cannot include any of the following characters: * ? : \\ / [ ]"));if(/(^')|('$)/.test(u))throw new Error("The first or last character of worksheet name cannot be a single quotation mark: ".concat(u));if(u=(u||"sheet".concat(c)).substring(0,31),this._worksheets.find(function(w){return w&&w.name.toLowerCase()===u.toLowerCase()}))throw new Error("Worksheet name already exists: ".concat(u));f&&(typeof f=="string"?(console.trace('tabColor argument is now deprecated. Please use workbook.addWorksheet(name, {properties: { tabColor: { argb: "rbg value" } }'),f={properties:{tabColor:{argb:f}}}):(f.argb||f.theme||f.indexed)&&(console.trace("tabColor argument is now deprecated. Please use workbook.addWorksheet(name, {properties: { tabColor: { ... } }"),f={properties:{tabColor:f}}));var v=this._worksheets.reduce(function(w,_){return(_&&_.orderNo)>w?_.orderNo:w},0),m=Object.assign({},f,{id:c,name:u,orderNo:v+1,workbook:this}),b=new a(m);return this._worksheets[c]=b,b}},{key:"removeWorksheetEx",value:function(u){delete this._worksheets[u.id]}},{key:"removeWorksheet",value:function(u){var f=this.getWorksheet(u);f&&f.destroy()}},{key:"getWorksheet",value:function(u){return u===void 0?this._worksheets.find(Boolean):typeof u=="number"?this._worksheets[u]:typeof u=="string"?this._worksheets.find(function(f){return f&&f.name===u}):void 0}},{key:"eachSheet",value:function(u){this.worksheets.forEach(function(f){u(f,f.id)})}},{key:"clearThemes",value:function(){this._themes=void 0}},{key:"addImage",value:function(u){var f=this.media.length;return this.media.push(Object.assign({},u,{type:"image"})),f}},{key:"getImage",value:function(u){return this.media[u]}},{key:"xlsx",get:function(){return this._xlsx||(this._xlsx=new l(this)),this._xlsx}},{key:"csv",get:function(){return this._csv||(this._csv=new p(this)),this._csv}},{key:"nextId",get:function(){for(var u=1;u<this._worksheets.length;u++)if(!this._worksheets[u])return u;return this._worksheets.length||1}},{key:"worksheets",get:function(){return this._worksheets.slice(1).sort(function(u,f){return u.orderNo-f.orderNo}).filter(Boolean)}},{key:"definedNames",get:function(){return this._definedNames}},{key:"model",get:function(){return{creator:this.creator||"Unknown",lastModifiedBy:this.lastModifiedBy||"Unknown",lastPrinted:this.lastPrinted,created:this.created,modified:this.modified,properties:this.properties,worksheets:this.worksheets.map(function(u){return u.model}),sheets:this.worksheets.map(function(u){return u.model}).filter(Boolean),definedNames:this._definedNames.model,views:this.views,company:this.company,manager:this.manager,title:this.title,subject:this.subject,keywords:this.keywords,category:this.category,description:this.description,language:this.language,revision:this.revision,contentStatus:this.contentStatus,themes:this._themes,media:this.media,calcProperties:this.calcProperties}},set:function(u){var f=this;this.creator=u.creator,this.lastModifiedBy=u.lastModifiedBy,this.lastPrinted=u.lastPrinted,this.created=u.created,this.modified=u.modified,this.company=u.company,this.manager=u.manager,this.title=u.title,this.subject=u.subject,this.keywords=u.keywords,this.category=u.category,this.description=u.description,this.language=u.language,this.revision=u.revision,this.contentStatus=u.contentStatus,this.properties=u.properties,this.calcProperties=u.calcProperties,this._worksheets=[],u.worksheets.forEach(function(c){var v=c.id,m=c.name,b=c.state,w=u.sheets&&u.sheets.findIndex(function(_){return _.id===v});(f._worksheets[v]=new a({id:v,name:m,orderNo:w,state:b,workbook:f})).model=c}),this._definedNames.model=u.definedNames,this.views=u.views,this._themes=u.themes,this.media=u.media||[]}}])&&o(y.prototype,h),g}();n.exports=d},{"../csv/csv":1,"../xlsx/xlsx":141,"./defined-names":6,"./worksheet":14}],14:[function(e,n,i){function o(C,R){var I=Object.keys(C);if(Object.getOwnPropertySymbols){var P=Object.getOwnPropertySymbols(C);R&&(P=P.filter(function(N){return Object.getOwnPropertyDescriptor(C,N).enumerable})),I.push.apply(I,P)}return I}function a(C){for(var R=1;R<arguments.length;R++){var I=arguments[R]!=null?arguments[R]:{};R%2?o(Object(I),!0).forEach(function(P){s(C,P,I[P])}):Object.getOwnPropertyDescriptors?Object.defineProperties(C,Object.getOwnPropertyDescriptors(I)):o(Object(I)).forEach(function(P){Object.defineProperty(C,P,Object.getOwnPropertyDescriptor(I,P))})}return C}function s(C,R,I){return R in C?Object.defineProperty(C,R,{value:I,enumerable:!0,configurable:!0,writable:!0}):C[R]=I,C}function l(C){return function(R){if(Array.isArray(R))return p(R)}(C)||function(R){if(typeof Symbol!="undefined"&&Symbol.iterator in Object(R))return Array.from(R)}(C)||function(R,I){if(!!R){if(typeof R=="string")return p(R,I);var P=Object.prototype.toString.call(R).slice(8,-1);if(P==="Object"&&R.constructor&&(P=R.constructor.name),P==="Map"||P==="Set")return Array.from(R);if(P==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(P))return p(R,I)}}(C)||function(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}()}function p(C,R){(R==null||R>C.length)&&(R=C.length);for(var I=0,P=new Array(R);I<R;I++)P[I]=C[I];return P}function d(C,R){for(var I=0;I<R.length;I++){var P=R[I];P.enumerable=P.enumerable||!1,P.configurable=!0,"value"in P&&(P.writable=!0),Object.defineProperty(C,P.key,P)}}var g=e("../utils/under-dash"),y=e("../utils/col-cache"),h=e("./range"),u=e("./row"),f=e("./column"),c=e("./enums"),v=e("./image"),m=e("./table"),b=e("./data-validations"),w=e("../utils/encryptor"),_=function(){function C(P){(function(N,A){if(!(N instanceof A))throw new TypeError("Cannot call a class as a function")})(this,C),P=P||{},this.id=P.id,this.orderNo=P.orderNo,this.name=P.name||"Sheet".concat(this.id),this.state=P.state||"visible",this._rows=[],this._columns=null,this._keys={},this._merges={},this.rowBreaks=[],this._workbook=P.workbook,this.properties=Object.assign({},{defaultRowHeight:15,dyDescent:55,outlineLevelCol:0,outlineLevelRow:0},P.properties),this.pageSetup=Object.assign({},{margins:{left:.7,right:.7,top:.75,bottom:.75,header:.3,footer:.3},orientation:"portrait",horizontalDpi:4294967295,verticalDpi:4294967295,fitToPage:!(!P.pageSetup||!P.pageSetup.fitToWidth&&!P.pageSetup.fitToHeight||P.pageSetup.scale),pageOrder:"downThenOver",blackAndWhite:!1,draft:!1,cellComments:"None",errors:"displayed",scale:100,fitToWidth:1,fitToHeight:1,paperSize:void 0,showRowColHeaders:!1,showGridLines:!1,firstPageNumber:void 0,horizontalCentered:!1,verticalCentered:!1,rowBreaks:null,colBreaks:null},P.pageSetup),this.headerFooter=Object.assign({},{differentFirst:!1,differentOddEven:!1,oddHeader:null,oddFooter:null,evenHeader:null,evenFooter:null,firstHeader:null,firstFooter:null},P.headerFooter),this.dataValidations=new b,this.views=P.views||[],this.autoFilter=P.autoFilter||null,this._media=[],this.sheetProtection=null,this.tables={},this.conditionalFormattings=[]}var R,I;return R=C,(I=[{key:"destroy",value:function(){this._workbook.removeWorksheetEx(this)}},{key:"getColumnKey",value:function(P){return this._keys[P]}},{key:"setColumnKey",value:function(P,N){this._keys[P]=N}},{key:"deleteColumnKey",value:function(P){delete this._keys[P]}},{key:"eachColumnKey",value:function(P){g.each(this._keys,P)}},{key:"getColumn",value:function(P){if(typeof P=="string"){var N=this._keys[P];if(N)return N;P=y.l2n(P)}if(this._columns||(this._columns=[]),P>this._columns.length)for(var A=this._columns.length+1;A<=P;)this._columns.push(new f(this,A++));return this._columns[P-1]}},{key:"spliceColumns",value:function(P,N){for(var A=this,$=this._rows,T=$.length,M=arguments.length,S=new Array(M>2?M-2:0),E=2;E<M;E++)S[E-2]=arguments[E];if(S.length>0)for(var k=function(U){var Y=[P,N];S.forEach(function(D){Y.push(D[U]||null)});var K=A.getRow(U+1);K.splice.apply(K,Y)},O=0;O<T;O++)k(O);else this._rows.forEach(function(U){U&&U.splice(P,N)});var x=S.length-N,j=P+N,H=this._columns.length;if(x<0)for(var F=P+S.length;F<=H;F++)this.getColumn(F).defn=this.getColumn(F-x).defn;else if(x>0)for(var V=H;V>=j;V--)this.getColumn(V+x).defn=this.getColumn(V).defn;for(var W=P;W<P+S.length;W++)this.getColumn(W).defn=null;this.workbook.definedNames.spliceColumns(this.name,P,N,S.length)}},{key:"_commitRow",value:function(){}},{key:"findRow",value:function(P){return this._rows[P-1]}},{key:"findRows",value:function(P,N){return this._rows.slice(P-1,P-1+N)}},{key:"getRow",value:function(P){var N=this._rows[P-1];return N||(N=this._rows[P-1]=new u(this,P)),N}},{key:"getRows",value:function(P,N){if(!(N<1)){for(var A=[],$=P;$<P+N;$++)A.push(this.getRow($));return A}}},{key:"addRow",value:function(P){var N=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"n",A=this._nextRow,$=this.getRow(A);return $.values=P,this._setStyleOption(A,N[0]==="i"?N:"n"),$}},{key:"addRows",value:function(P){var N=this,A=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"n",$=[];return P.forEach(function(T){$.push(N.addRow(T,A))}),$}},{key:"insertRow",value:function(P,N){var A=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"n";return this.spliceRows(P,0,N),this._setStyleOption(P,A),this.getRow(P)}},{key:"insertRows",value:function(P,N){var A=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"n";if(this.spliceRows.apply(this,[P,0].concat(l(N))),A!=="n")for(var $=0;$<N.length;$++)A[0]==="o"&&this.findRow(N.length+P+$)!==void 0?this._copyStyle(N.length+P+$,P+$,A[1]==="+"):A[0]==="i"&&this.findRow(P-1)!==void 0&&this._copyStyle(P-1,P+$,A[1]==="+");return this.getRows(P,N.length)}},{key:"_setStyleOption",value:function(P){var N=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"n";N[0]==="o"&&this.findRow(P+1)!==void 0?this._copyStyle(P+1,P,N[1]==="+"):N[0]==="i"&&this.findRow(P-1)!==void 0&&this._copyStyle(P-1,P,N[1]==="+")}},{key:"_copyStyle",value:function(P,N){var A=arguments.length>2&&arguments[2]!==void 0&&arguments[2],$=this.getRow(P),T=this.getRow(N);T.style=Object.freeze(a({},$.style)),$.eachCell({includeEmpty:A},function(M,S){T.getCell(S).style=Object.freeze(a({},M.style))}),T.height=$.height}},{key:"duplicateRow",value:function(P,N){var A=this,$=arguments.length>2&&arguments[2]!==void 0&&arguments[2],T=this._rows[P-1],M=new Array(N).fill(T.values);this.spliceRows.apply(this,[P+1,$?0:N].concat(l(M)));for(var S=function(k){var O=A._rows[P+k];O.style=T.style,O.height=T.height,T.eachCell({includeEmpty:!0},function(x,j){O.getCell(j).style=x.style})},E=0;E<N;E++)S(E)}},{key:"spliceRows",value:function(P,N){for(var A=this,$=P+N,T=arguments.length,M=new Array(T>2?T-2:0),S=2;S<T;S++)M[S-2]=arguments[S];var E,k,O=M.length,x=O-N,j=this._rows.length;if(x<0)for(E=$;E<=j;E++)(k=this._rows[E-1])?function(){var F=A.getRow(E+x);F.values=k.values,F.style=k.style,F.height=k.height,k.eachCell({includeEmpty:!0},function(V,W){F.getCell(W).style=V.style}),A._rows[E-1]=void 0}():this._rows[E+x-1]=void 0;else if(x>0)for(E=j;E>=$;E--)(k=this._rows[E-1])?function(){var F=A.getRow(E+x);F.values=k.values,F.style=k.style,F.height=k.height,k.eachCell({includeEmpty:!0},function(V,W){if(F.getCell(W).style=V.style,V._value.constructor.name==="MergeValue"){var U=A.getRow(V._row._number+O).getCell(W),Y=V._value._master,K=A.getRow(Y._row._number+O).getCell(Y._column._number);U.merge(K)}})}():this._rows[E+x-1]=void 0;for(E=0;E<O;E++){var H=this.getRow(P+E);H.style={},H.values=M[E]}this.workbook.definedNames.spliceRows(this.name,P,N,O)}},{key:"eachRow",value:function(P,N){if(N||(N=P,P=void 0),P&&P.includeEmpty)for(var A=this._rows.length,$=1;$<=A;$++)N(this.getRow($),$);else this._rows.forEach(function(T){T&&T.hasValues&&N(T,T.number)})}},{key:"getSheetValues",value:function(){var P=[];return this._rows.forEach(function(N){N&&(P[N.number]=N.values)}),P}},{key:"findCell",value:function(P,N){var A=y.getAddress(P,N),$=this._rows[A.row-1];return $?$.findCell(A.col):void 0}},{key:"getCell",value:function(P,N){var A=y.getAddress(P,N);return this.getRow(A.row).getCellEx(A)}},{key:"mergeCells",value:function(){for(var P=arguments.length,N=new Array(P),A=0;A<P;A++)N[A]=arguments[A];var $=new h(N);this._mergeCellsInternal($)}},{key:"mergeCellsWithoutStyle",value:function(){for(var P=arguments.length,N=new Array(P),A=0;A<P;A++)N[A]=arguments[A];var $=new h(N);this._mergeCellsInternal($,!0)}},{key:"_mergeCellsInternal",value:function(P,N){g.each(this._merges,function(M){if(M.intersects(P))throw new Error("Cannot merge already merged cells")});for(var A=this.getCell(P.top,P.left),$=P.top;$<=P.bottom;$++)for(var T=P.left;T<=P.right;T++)($>P.top||T>P.left)&&this.getCell($,T).merge(A,N);this._merges[A.address]=P}},{key:"_unMergeMaster",value:function(P){var N=this._merges[P.address];if(N){for(var A=N.top;A<=N.bottom;A++)for(var $=N.left;$<=N.right;$++)this.getCell(A,$).unmerge();delete this._merges[P.address]}}},{key:"unMergeCells",value:function(){for(var P=arguments.length,N=new Array(P),A=0;A<P;A++)N[A]=arguments[A];for(var $=new h(N),T=$.top;T<=$.bottom;T++)for(var M=$.left;M<=$.right;M++){var S=this.findCell(T,M);S&&(S.type===c.ValueType.Merge?this._unMergeMaster(S.master):this._merges[S.address]&&this._unMergeMaster(S))}}},{key:"fillFormula",value:function(P,N,A){var $,T=arguments.length>3&&arguments[3]!==void 0?arguments[3]:"shared",M=y.decode(P),S=M.top,E=M.left,k=M.bottom,O=M.right,x=O-E+1,j=y.encodeAddress(S,E),H=T==="shared";$=typeof A=="function"?A:Array.isArray(A)?Array.isArray(A[0])?function(U,Y){return A[U-S][Y-E]}:function(U,Y){return A[(U-S)*x+(Y-E)]}:function(){};for(var F=!0,V=S;V<=k;V++)for(var W=E;W<=O;W++)F?(this.getCell(V,W).value={shareType:T,formula:N,ref:P,result:$(V,W)},F=!1):this.getCell(V,W).value=H?{sharedFormula:j,result:$(V,W)}:$(V,W)}},{key:"addImage",value:function(P,N){var A={type:"image",imageId:P,range:N};this._media.push(new v(this,A))}},{key:"getImages",value:function(){return this._media.filter(function(P){return P.type==="image"})}},{key:"addBackgroundImage",value:function(P){var N={type:"background",imageId:P};this._media.push(new v(this,N))}},{key:"getBackgroundImageId",value:function(){var P=this._media.find(function(N){return N.type==="background"});return P&&P.imageId}},{key:"protect",value:function(P,N){var A=this;return new Promise(function($){A.sheetProtection={sheet:!0},N&&"spinCount"in N&&(N.spinCount=Number.isFinite(N.spinCount)?Math.round(Math.max(0,N.spinCount)):1e5),P&&(A.sheetProtection.algorithmName="SHA-512",A.sheetProtection.saltValue=w.randomBytes(16).toString("base64"),A.sheetProtection.spinCount=N&&"spinCount"in N?N.spinCount:1e5,A.sheetProtection.hashValue=w.convertPasswordToHash(P,"SHA512",A.sheetProtection.saltValue,A.sheetProtection.spinCount)),N&&(A.sheetProtection=Object.assign(A.sheetProtection,N),!P&&"spinCount"in N&&delete A.sheetProtection.spinCount),$()})}},{key:"unprotect",value:function(){this.sheetProtection=null}},{key:"addTable",value:function(P){var N=new m(this,P);return this.tables[P.name]=N,N}},{key:"getTable",value:function(P){return this.tables[P]}},{key:"removeTable",value:function(P){delete this.tables[P]}},{key:"getTables",value:function(){return Object.values(this.tables)}},{key:"addConditionalFormatting",value:function(P){this.conditionalFormattings.push(P)}},{key:"removeConditionalFormatting",value:function(P){typeof P=="number"?this.conditionalFormattings.splice(P,1):this.conditionalFormattings=P instanceof Function?this.conditionalFormattings.filter(P):[]}},{key:"_parseRows",value:function(P){var N=this;this._rows=[],P.rows.forEach(function(A){var $=new u(N,A.number);N._rows[$.number-1]=$,$.model=A})}},{key:"_parseMergeCells",value:function(P){var N=this;g.each(P.mergeCells,function(A){N.mergeCellsWithoutStyle(A)})}},{key:"workbook",get:function(){return this._workbook}},{key:"dimensions",get:function(){var P=new h;return this._rows.forEach(function(N){if(N){var A=N.dimensions;A&&P.expand(N.number,A.min,N.number,A.max)}}),P}},{key:"columns",get:function(){return this._columns},set:function(P){var N=this;this._headerRowCount=P.reduce(function(T,M){var S=(M.header?1:M.headers&&M.headers.length)||0;return Math.max(T,S)},0);var A=1,$=this._columns=[];P.forEach(function(T){var M=new f(N,A++,!1);$.push(M),M.defn=T})}},{key:"lastColumn",get:function(){return this.getColumn(this.columnCount)}},{key:"columnCount",get:function(){var P=0;return this.eachRow(function(N){P=Math.max(P,N.cellCount)}),P}},{key:"actualColumnCount",get:function(){var P=[],N=0;return this.eachRow(function(A){A.eachCell(function($){var T=$.col;P[T]||(P[T]=!0,N++)})}),N}},{key:"_lastRowNumber",get:function(){for(var P=this._rows,N=P.length;N>0&&P[N-1]===void 0;)N--;return N}},{key:"_nextRow",get:function(){return this._lastRowNumber+1}},{key:"lastRow",get:function(){if(this._rows.length)return this._rows[this._rows.length-1]}},{key:"rowCount",get:function(){return this._lastRowNumber}},{key:"actualRowCount",get:function(){var P=0;return this.eachRow(function(){P++}),P}},{key:"hasMerges",get:function(){return g.some(this._merges,Boolean)}},{key:"tabColor",get:function(){return console.trace("worksheet.tabColor property is now deprecated. Please use worksheet.properties.tabColor"),this.properties.tabColor},set:function(P){console.trace("worksheet.tabColor property is now deprecated. Please use worksheet.properties.tabColor"),this.properties.tabColor=P}},{key:"model",get:function(){var P={id:this.id,name:this.name,dataValidations:this.dataValidations.model,properties:this.properties,state:this.state,pageSetup:this.pageSetup,headerFooter:this.headerFooter,rowBreaks:this.rowBreaks,views:this.views,autoFilter:this.autoFilter,media:this._media.map(function($){return $.model}),sheetProtection:this.sheetProtection,tables:Object.values(this.tables).map(function($){return $.model}),conditionalFormattings:this.conditionalFormattings};P.cols=f.toModel(this.columns);var N=P.rows=[],A=P.dimensions=new h;return this._rows.forEach(function($){var T=$&&$.model;T&&(A.expand(T.number,T.min,T.number,T.max),N.push(T))}),P.merges=[],g.each(this._merges,function($){P.merges.push($.range)}),P},set:function(P){var N=this;this.name=P.name,this._columns=f.fromModel(this,P.cols),this._parseRows(P),this._parseMergeCells(P),this.dataValidations=new b(P.dataValidations),this.properties=P.properties,this.pageSetup=P.pageSetup,this.headerFooter=P.headerFooter,this.views=P.views,this.autoFilter=P.autoFilter,this._media=P.media.map(function(A){return new v(N,A)}),this.sheetProtection=P.sheetProtection,this.tables=P.tables.reduce(function(A,$){var T=new m;return T.model=$,A[$.name]=T,A},{}),this.conditionalFormattings=P.conditionalFormattings}}])&&d(R.prototype,I),C}();n.exports=_},{"../utils/col-cache":19,"../utils/encryptor":20,"../utils/under-dash":25,"./column":4,"./data-validations":5,"./enums":7,"./image":8,"./range":10,"./row":11,"./table":12}],15:[function(e,n,i){e("core-js/modules/es.promise"),e("core-js/modules/es.object.assign"),e("core-js/modules/es.object.keys"),e("core-js/modules/es.object.values"),e("core-js/modules/es.symbol"),e("core-js/modules/es.symbol.async-iterator"),e("core-js/modules/es.array.iterator"),e("core-js/modules/es.array.includes"),e("core-js/modules/es.array.find-index"),e("core-js/modules/es.array.find"),e("core-js/modules/es.string.from-code-point"),e("core-js/modules/es.string.includes"),e("core-js/modules/es.number.is-nan"),e("regenerator-runtime/runtime");var o={Workbook:e("./doc/workbook")},a=e("./doc/enums");Object.keys(a).forEach(function(s){o[s]=a[s]}),n.exports=o},{"./doc/enums":7,"./doc/workbook":13,"core-js/modules/es.array.find":316,"core-js/modules/es.array.find-index":315,"core-js/modules/es.array.includes":317,"core-js/modules/es.array.iterator":318,"core-js/modules/es.number.is-nan":319,"core-js/modules/es.object.assign":320,"core-js/modules/es.object.keys":321,"core-js/modules/es.object.values":322,"core-js/modules/es.promise":323,"core-js/modules/es.string.from-code-point":324,"core-js/modules/es.string.includes":325,"core-js/modules/es.symbol":327,"core-js/modules/es.symbol.async-iterator":326,"regenerator-runtime/runtime":492}],16:[function(e,n,i){var o=typeof TextDecoder=="undefined"?null:new TextDecoder("utf-8");i.bufferToString=function(a){return typeof a=="string"?a:o?o.decode(a):a.toString()}},{}],17:[function(e,n,i){var o=typeof TextEncoder=="undefined"?null:new TextEncoder("utf-8"),a=e("buffer").Buffer;i.stringToBuffer=function(s){return typeof s!="string"?s:o?a.from(o.encode(s).buffer):a.from(s)}},{buffer:216}],18:[function(e,n,i){function o(p,d){for(var g=0;g<d.length;g++){var y=d[g];y.enumerable=y.enumerable||!1,y.configurable=!0,"value"in y&&(y.writable=!0),Object.defineProperty(p,y.key,y)}}var a=e("./under-dash"),s=e("./col-cache"),l=function(){function p(y){(function(h,u){if(!(h instanceof u))throw new TypeError("Cannot call a class as a function")})(this,p),this.template=y,this.sheets={}}var d,g;return d=p,(g=[{key:"addCell",value:function(y){this.addCellEx(s.decodeEx(y))}},{key:"getCell",value:function(y){return this.findCellEx(s.decodeEx(y),!0)}},{key:"findCell",value:function(y){return this.findCellEx(s.decodeEx(y),!1)}},{key:"findCellAt",value:function(y,h,u){var f=this.sheets[y],c=f&&f[h];return c&&c[u]}},{key:"addCellEx",value:function(y){if(y.top)for(var h=y.top;h<=y.bottom;h++)for(var u=y.left;u<=y.right;u++)this.getCellAt(y.sheetName,h,u);else this.findCellEx(y,!0)}},{key:"getCellEx",value:function(y){return this.findCellEx(y,!0)}},{key:"findCellEx",value:function(y,h){var u=this.findSheet(y,h),f=this.findSheetRow(u,y,h);return this.findRowCell(f,y,h)}},{key:"getCellAt",value:function(y,h,u){var f=this.sheets[y]||(this.sheets[y]=[]),c=f[h]||(f[h]=[]);return c[u]||(c[u]={sheetName:y,address:s.n2l(u)+h,row:h,col:u})}},{key:"removeCellEx",value:function(y){var h=this.findSheet(y);if(h){var u=this.findSheetRow(h,y);u&&delete u[y.col]}}},{key:"forEachInSheet",value:function(y,h){var u=this.sheets[y];u&&u.forEach(function(f,c){f&&f.forEach(function(v,m){v&&h(v,c,m)})})}},{key:"forEach",value:function(y){var h=this;a.each(this.sheets,function(u,f){h.forEachInSheet(f,y)})}},{key:"map",value:function(y){var h=[];return this.forEach(function(u){h.push(y(u))}),h}},{key:"findSheet",value:function(y,h){var u=y.sheetName;return this.sheets[u]?this.sheets[u]:h?this.sheets[u]=[]:void 0}},{key:"findSheetRow",value:function(y,h,u){var f=h.row;return y&&y[f]?y[f]:u?y[f]=[]:void 0}},{key:"findRowCell",value:function(y,h,u){var f=h.col;return y&&y[f]?y[f]:u?y[f]=this.template?Object.assign(h,JSON.parse(JSON.stringify(this.template))):h:void 0}},{key:"spliceRows",value:function(y,h,u,f){var c=this.sheets[y];if(c){for(var v=[],m=0;m<f;m++)v.push([]);c.splice.apply(c,[h,u].concat(v))}}},{key:"spliceColumns",value:function(y,h,u,f){var c=this.sheets[y];if(c){for(var v=[],m=0;m<f;m++)v.push(null);a.each(c,function(b){b.splice.apply(b,[h,u].concat(v))})}}}])&&o(d.prototype,g),p}();n.exports=l},{"./col-cache":19,"./under-dash":25}],19:[function(e,n,i){function o(g,y){return function(h){if(Array.isArray(h))return h}(g)||function(h,u){if(!(typeof Symbol=="undefined"||!(Symbol.iterator in Object(h)))){var f=[],c=!0,v=!1,m=void 0;try{for(var b,w=h[Symbol.iterator]();!(c=(b=w.next()).done)&&(f.push(b.value),!u||f.length!==u);c=!0);}catch(_){v=!0,m=_}finally{try{c||w.return==null||w.return()}finally{if(v)throw m}}return f}}(g,y)||function(h,u){if(!!h){if(typeof h=="string")return a(h,u);var f=Object.prototype.toString.call(h).slice(8,-1);if(f==="Object"&&h.constructor&&(f=h.constructor.name),f==="Map"||f==="Set")return Array.from(h);if(f==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(f))return a(h,u)}}(g,y)||function(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}()}function a(g,y){(y==null||y>g.length)&&(y=g.length);for(var h=0,u=new Array(y);h<y;h++)u[h]=g[h];return u}function s(g,y){var h=Object.keys(g);if(Object.getOwnPropertySymbols){var u=Object.getOwnPropertySymbols(g);y&&(u=u.filter(function(f){return Object.getOwnPropertyDescriptor(g,f).enumerable})),h.push.apply(h,u)}return h}function l(g,y,h){return y in g?Object.defineProperty(g,y,{value:h,enumerable:!0,configurable:!0,writable:!0}):g[y]=h,g}var p=/^[A-Z]+\d+$/,d={_dictionary:["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"],_l2nFill:0,_l2n:{},_n2l:[],_level:function(g){return g<=26?1:g<=676?2:3},_fill:function(g){var y,h,u,f,c,v=1;if(g>=4)throw new Error("Out of bounds. Excel supports columns from 1 to 16384");if(this._l2nFill<1&&g>=1){for(;v<=26;)y=this._dictionary[v-1],this._n2l[v]=y,this._l2n[y]=v,v++;this._l2nFill=1}if(this._l2nFill<2&&g>=2){for(v=27;v<=702;)u=(h=v-27)%26,f=Math.floor(h/26),y=this._dictionary[f]+this._dictionary[u],this._n2l[v]=y,this._l2n[y]=v,v++;this._l2nFill=2}if(this._l2nFill<3&&g>=3){for(v=703;v<=16384;)u=(h=v-703)%26,f=Math.floor(h/26)%26,c=Math.floor(h/676),y=this._dictionary[c]+this._dictionary[f]+this._dictionary[u],this._n2l[v]=y,this._l2n[y]=v,v++;this._l2nFill=3}},l2n:function(g){if(this._l2n[g]||this._fill(g.length),!this._l2n[g])throw new Error("Out of bounds. Invalid column letter: ".concat(g));return this._l2n[g]},n2l:function(g){if(g<1||g>16384)throw new Error("".concat(g," is out of bounds. Excel supports columns from 1 to 16384"));return this._n2l[g]||this._fill(this._level(g)),this._n2l[g]},_hash:{},validateAddress:function(g){if(!p.test(g))throw new Error("Invalid Address: ".concat(g));return!0},decodeAddress:function(g){var y=g.length<5&&this._hash[g];if(y)return y;for(var h,u=!1,f="",c=0,v=!1,m="",b=0,w=0;w<g.length;w++)if(h=g.charCodeAt(w),!v&&h>=65&&h<=90)u=!0,f+=g[w],c=26*c+h-64;else if(h>=48&&h<=57)v=!0,m+=g[w],b=10*b+h-48;else if(v&&u&&h!==36)break;if(u){if(c>16384)throw new Error("Out of bounds. Invalid column letter: ".concat(f))}else c=void 0;v||(b=void 0);var _={address:g=f+m,col:c,row:b,$col$row:"$".concat(f,"$").concat(m)};return c<=100&&b<=100&&(this._hash[g]=_,this._hash[_.$col$row]=_),_},getAddress:function(g,y){if(y){var h=this.n2l(y)+g;return this.decodeAddress(h)}return this.decodeAddress(g)},decode:function(g){var y=g.split(":");if(y.length===2){var h=this.decodeAddress(y[0]),u=this.decodeAddress(y[1]),f={top:Math.min(h.row,u.row),left:Math.min(h.col,u.col),bottom:Math.max(h.row,u.row),right:Math.max(h.col,u.col)};return f.tl=this.n2l(f.left)+f.top,f.br=this.n2l(f.right)+f.bottom,f.dimensions="".concat(f.tl,":").concat(f.br),f}return this.decodeAddress(g)},decodeEx:function(g){var y=g.match(/(?:(?:(?:'((?:[^']|'')*)')|([^'^ !]*))!)?(.*)/),h=y[1]||y[2],u=y[3],f=u.split(":");if(f.length>1){var c=this.decodeAddress(f[0]),v=this.decodeAddress(f[1]),m=Math.min(c.row,v.row),b=Math.min(c.col,v.col),w=Math.max(c.row,v.row),_=Math.max(c.col,v.col);return c=this.n2l(b)+m,v=this.n2l(_)+w,{top:m,left:b,bottom:w,right:_,sheetName:h,tl:{address:c,col:b,row:m,$col$row:"$".concat(this.n2l(b),"$").concat(m),sheetName:h},br:{address:v,col:_,row:w,$col$row:"$".concat(this.n2l(_),"$").concat(w),sheetName:h},dimensions:"".concat(c,":").concat(v)}}if(u.startsWith("#"))return h?{sheetName:h,error:u}:{error:u};var C=this.decodeAddress(u);return h?function(R){for(var I=1;I<arguments.length;I++){var P=arguments[I]!=null?arguments[I]:{};I%2?s(Object(P),!0).forEach(function(N){l(R,N,P[N])}):Object.getOwnPropertyDescriptors?Object.defineProperties(R,Object.getOwnPropertyDescriptors(P)):s(Object(P)).forEach(function(N){Object.defineProperty(R,N,Object.getOwnPropertyDescriptor(P,N))})}return R}({sheetName:h},C):C},encodeAddress:function(g,y){return d.n2l(y)+g},encode:function(){switch(arguments.length){case 2:return d.encodeAddress(arguments[0],arguments[1]);case 4:return"".concat(d.encodeAddress(arguments[0],arguments[1]),":").concat(d.encodeAddress(arguments[2],arguments[3]));default:throw new Error("Can only encode with 2 or 4 arguments")}},inRange:function(g,y){var h=o(g,5),u=h[0],f=h[1],c=h[3],v=h[4],m=o(y,2),b=m[0],w=m[1];return b>=u&&b<=c&&w>=f&&w<=v}};n.exports=d},{}],20:[function(e,n,i){(function(o){var a=e("crypto"),s={hash:function(l){for(var p=a.createHash(l),d=arguments.length,g=new Array(d>1?d-1:0),y=1;y<d;y++)g[y-1]=arguments[y];return p.update(o.concat(g)),p.digest()},convertPasswordToHash:function(l,p,d,g){if(p=p.toLowerCase(),a.getHashes().indexOf(p)<0)throw new Error("Hash algorithm '".concat(p,"' not supported!"));for(var y=o.from(l,"utf16le"),h=this.hash(p,o.from(d,"base64"),y),u=0;u<g;u++){var f=o.alloc(4);f.writeUInt32LE(u,0),h=this.hash(p,h,f)}return h.toString("base64")},randomBytes:function(l){return a.randomBytes(l)}};n.exports=s}).call(this,e("buffer").Buffer)},{buffer:216,crypto:335}],21:[function(e,n,i){function o(y){return new s(y)}function a(y){var h,u;function f(v,m){try{var b=y[v](m),w=b.value,_=w instanceof s;Promise.resolve(_?w.wrapped:w).then(function(C){_?f(v==="return"?"return":"next",C):c(b.done?"return":"normal",C)},function(C){f("throw",C)})}catch(C){c("throw",C)}}function c(v,m){switch(v){case"return":h.resolve({value:m,done:!0});break;case"throw":h.reject(m);break;default:h.resolve({value:m,done:!1})}(h=h.next)?f(h.key,h.arg):u=null}this._invoke=function(v,m){return new Promise(function(b,w){var _={key:v,arg:m,resolve:b,reject:w,next:null};u?u=u.next=_:(h=u=_,f(v,m))})},typeof y.return!="function"&&(this.return=void 0)}function s(y){this.wrapped=y}function l(y){var h;if(typeof Symbol!="undefined"&&(Symbol.asyncIterator&&(h=y[Symbol.asyncIterator])!=null||Symbol.iterator&&(h=y[Symbol.iterator])!=null))return h.call(y);throw new TypeError("Object is not async iterable")}typeof Symbol=="function"&&Symbol.asyncIterator&&(a.prototype[Symbol.asyncIterator]=function(){return this}),a.prototype.next=function(y){return this._invoke("next",y)},a.prototype.throw=function(y){return this._invoke("throw",y)},a.prototype.return=function(y){return this._invoke("return",y)};var p=e("saxes").SaxesParser,d=e("readable-stream").PassThrough,g=e("./browser-buffer-decode").bufferToString;n.exports=function(){var y,h=(y=regeneratorRuntime.mark(function u(f){var c,v,m,b,w,_,C,R,I,P;return regeneratorRuntime.wrap(function(N){for(;;)switch(N.prev=N.next){case 0:f.pipe&&!f[Symbol.asyncIterator]&&(f=f.pipe(new d)),(c=new p).on("error",function(A){v=A}),m=[],c.on("opentag",function(A){return m.push({eventType:"opentag",value:A})}),c.on("text",function(A){return m.push({eventType:"text",value:A})}),c.on("closetag",function(A){return m.push({eventType:"closetag",value:A})}),b=!0,w=!1,N.prev=9,C=l(f);case 11:return N.next=13,o(C.next());case 13:return R=N.sent,b=R.done,N.next=17,o(R.value);case 17:if(I=N.sent,b){N.next=29;break}if(P=I,c.write(g(P)),!v){N.next=23;break}throw v;case 23:return N.next=25,m;case 25:m=[];case 26:b=!0,N.next=11;break;case 29:N.next=35;break;case 31:N.prev=31,N.t0=N.catch(9),w=!0,_=N.t0;case 35:if(N.prev=35,N.prev=36,b||C.return==null){N.next=40;break}return N.next=40,o(C.return());case 40:if(N.prev=40,!w){N.next=43;break}throw _;case 43:return N.finish(40);case 44:return N.finish(35);case 45:case"end":return N.stop()}},u,null,[[9,31,35,45],[36,,40,44]])}),function(){return new a(y.apply(this,arguments))});return function(u){return h.apply(this,arguments)}}()},{"./browser-buffer-decode":16,"readable-stream":491,saxes:496}],22:[function(e,n,i){var o=e("./col-cache"),a=/(([a-z_\-0-9]*)!)?([a-z0-9_$]{2,})([(])?/gi,s=/^([$])?([a-z]+)([$])?([1-9][0-9]*)$/i;n.exports={slideFormula:function(l,p,d){var g=o.decode(p),y=o.decode(d);return l.replace(a,function(h,u,f,c,v){if(v)return h;var m=s.exec(c);if(m){var b=m[1],w=m[2].toUpperCase(),_=m[3],C=m[4];if(w.length>3||w.length===3&&w>"XFD")return h;var R=o.l2n(w),I=parseInt(C,10);return b||(R+=y.col-g.col),_||(I+=y.row-g.row),(u||"")+(b||"")+o.n2l(R)+(_||"")+I}return h})}}},{"./col-cache":19}],23:[function(e,n,i){(function(o,a){function s(w,_,C,R,I,P,N){try{var A=w[P](N),$=A.value}catch(T){return void C(T)}A.done?_($):Promise.resolve($).then(R,I)}function l(w){return function(){var _=this,C=arguments;return new Promise(function(R,I){var P=w.apply(_,C);function N($){s(P,R,I,N,A,"next",$)}function A($){s(P,R,I,N,A,"throw",$)}N(void 0)})}}function p(w,_){if(!(w instanceof _))throw new TypeError("Cannot call a class as a function")}function d(w,_){for(var C=0;C<_.length;C++){var R=_[C];R.enumerable=R.enumerable||!1,R.configurable=!0,"value"in R&&(R.writable=!0),Object.defineProperty(w,R.key,R)}}function g(w,_,C){return _&&d(w.prototype,_),C&&d(w,C),w}var y=e("readable-stream"),h=e("./utils"),u=e("./string-buf"),f=function(){function w(_,C){p(this,w),this._data=_,this._encoding=C}return g(w,[{key:"copy",value:function(_,C,R,I){return this.toBuffer().copy(_,C,R,I)}},{key:"toBuffer",value:function(){return this._buffer||(this._buffer=a.from(this._data,this._encoding)),this._buffer}},{key:"length",get:function(){return this.toBuffer().length}}]),w}(),c=function(){function w(_){p(this,w),this._data=_}return g(w,[{key:"copy",value:function(_,C,R,I){return this._data._buf.copy(_,C,R,I)}},{key:"toBuffer",value:function(){return this._data.toBuffer()}},{key:"length",get:function(){return this._data.length}}]),w}(),v=function(){function w(_){p(this,w),this._data=_}return g(w,[{key:"copy",value:function(_,C,R,I){this._data.copy(_,C,R,I)}},{key:"toBuffer",value:function(){return this._data}},{key:"length",get:function(){return this._data.length}}]),w}(),m=function(){function w(_){p(this,w),this.size=_,this.buffer=a.alloc(_),this.iRead=0,this.iWrite=0}return g(w,[{key:"toBuffer",value:function(){if(this.iRead===0&&this.iWrite===this.size)return this.buffer;var _=a.alloc(this.iWrite-this.iRead);return this.buffer.copy(_,0,this.iRead,this.iWrite),_}},{key:"read",value:function(_){var C;return _===0?null:_===void 0||_>=this.length?(C=this.toBuffer(),this.iRead=this.iWrite,C):(C=a.alloc(_),this.buffer.copy(C,0,this.iRead,_),this.iRead+=_,C)}},{key:"write",value:function(_,C,R){var I=Math.min(R,this.size-this.iWrite);return _.copy(this.buffer,this.iWrite,C,C+I),this.iWrite+=I,I}},{key:"length",get:function(){return this.iWrite-this.iRead}},{key:"eod",get:function(){return this.iRead===this.iWrite}},{key:"full",get:function(){return this.iWrite===this.size}}]),w}(),b=function(w){w=w||{},this.bufSize=w.bufSize||1048576,this.buffers=[],this.batch=w.batch||!1,this.corked=!1,this.inPos=0,this.outPos=0,this.pipes=[],this.paused=!1,this.encoding=null};h.inherits(b,y.Duplex,{toBuffer:function(){switch(this.buffers.length){case 0:return null;case 1:return this.buffers[0].toBuffer();default:return a.concat(this.buffers.map(function(w){return w.toBuffer()}))}},_getWritableBuffer:function(){if(this.buffers.length){var w=this.buffers[this.buffers.length-1];if(!w.full)return w}var _=new m(this.bufSize);return this.buffers.push(_),_},_pipe:function(w){var _=this;return l(regeneratorRuntime.mark(function C(){var R;return regeneratorRuntime.wrap(function(I){for(;;)switch(I.prev=I.next){case 0:return R=function(P){return new Promise(function(N){P.write(w.toBuffer(),function(){N()})})},I.next=3,Promise.all(_.pipes.map(R));case 3:case"end":return I.stop()}},C)}))()},_writeToBuffers:function(w){for(var _=0,C=w.length;_<C;)_+=this._getWritableBuffer().write(w,_,C-_)},write:function(w,_,C){var R=this;return l(regeneratorRuntime.mark(function I(){var P;return regeneratorRuntime.wrap(function(N){for(;;)switch(N.prev=N.next){case 0:if(_ instanceof Function&&(C=_,_="utf8"),C=C||h.nop,!(w instanceof u)){N.next=6;break}P=new c(w),N.next=15;break;case 6:if(!(w instanceof a)){N.next=10;break}P=new v(w),N.next=15;break;case 10:if(!(typeof w=="string"||w instanceof String||w instanceof ArrayBuffer)){N.next=14;break}P=new f(w,_),N.next=15;break;case 14:throw new Error("Chunk must be one of type String, Buffer or StringBuf.");case 15:if(!R.pipes.length){N.next=31;break}if(!R.batch){N.next=21;break}for(R._writeToBuffers(P);!R.corked&&R.buffers.length>1;)R._pipe(R.buffers.shift());N.next=29;break;case 21:if(R.corked){N.next=27;break}return N.next=24,R._pipe(P);case 24:C(),N.next=29;break;case 27:R._writeToBuffers(P),o.nextTick(C);case 29:N.next=34;break;case 31:R.paused||R.emit("data",P.toBuffer()),R._writeToBuffers(P),R.emit("readable");case 34:return N.abrupt("return",!0);case 35:case"end":return N.stop()}},I)}))()},cork:function(){this.corked=!0},_flush:function(){if(this.pipes.length)for(;this.buffers.length;)this._pipe(this.buffers.shift())},uncork:function(){this.corked=!1,this._flush()},end:function(w,_,C){var R=this,I=function(P){P?C(P):(R._flush(),R.pipes.forEach(function(N){N.end()}),R.emit("finish"))};w?this.write(w,_,I):I()},read:function(w){var _;if(w){for(_=[];w&&this.buffers.length&&!this.buffers[0].eod;){var C=this.buffers[0],R=C.read(w);w-=R.length,_.push(R),C.eod&&C.full&&this.buffers.shift()}return a.concat(_)}return _=this.buffers.map(function(I){return I.toBuffer()}).filter(Boolean),this.buffers=[],a.concat(_)},setEncoding:function(w){this.encoding=w},pause:function(){this.paused=!0},resume:function(){this.paused=!1},isPaused:function(){return!!this.paused},pipe:function(w){this.pipes.push(w),!this.paused&&this.buffers.length&&this.end()},unpipe:function(w){this.pipes=this.pipes.filter(function(_){return _!==w})},unshift:function(){throw new Error("Not Implemented")},wrap:function(){throw new Error("Not Implemented")}}),n.exports=b}).call(this,e("_process"),e("buffer").Buffer)},{"./string-buf":24,"./utils":26,_process:467,buffer:216,"readable-stream":491}],24:[function(e,n,i){(function(o){function a(l,p){for(var d=0;d<p.length;d++){var g=p[d];g.enumerable=g.enumerable||!1,g.configurable=!0,"value"in g&&(g.writable=!0),Object.defineProperty(l,g.key,g)}}var s=function(){function l(g){(function(y,h){if(!(y instanceof h))throw new TypeError("Cannot call a class as a function")})(this,l),this._buf=o.alloc(g&&g.size||16384),this._encoding=g&&g.encoding||"utf8",this._inPos=0,this._buffer=void 0}var p,d;return p=l,(d=[{key:"toBuffer",value:function(){return this._buffer||(this._buffer=o.alloc(this.length),this._buf.copy(this._buffer,0,0,this.length)),this._buffer}},{key:"reset",value:function(g){g=g||0,this._buffer=void 0,this._inPos=g}},{key:"_grow",value:function(g){for(var y=2*this._buf.length;y<g;)y*=2;var h=o.alloc(y);this._buf.copy(h,0),this._buf=h}},{key:"addText",value:function(g){this._buffer=void 0;for(var y=this._inPos+this._buf.write(g,this._inPos,this._encoding);y>=this._buf.length-4;)this._grow(this._inPos+g.length),y=this._inPos+this._buf.write(g,this._inPos,this._encoding);this._inPos=y}},{key:"addStringBuf",value:function(g){g.length&&(this._buffer=void 0,this.length+g.length>this.capacity&&this._grow(this.length+g.length),g._buf.copy(this._buf,this._inPos,0,g.length),this._inPos+=g.length)}},{key:"length",get:function(){return this._inPos}},{key:"capacity",get:function(){return this._buf.length}},{key:"buffer",get:function(){return this._buf}}])&&a(p.prototype,d),l}();n.exports=s}).call(this,e("buffer").Buffer)},{buffer:216}],25:[function(e,n,i){function o(p){return(o=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(d){return typeof d}:function(d){return d&&typeof Symbol=="function"&&d.constructor===Symbol&&d!==Symbol.prototype?"symbol":typeof d})(p)}var a=Object.prototype.toString,s=/["&<>]/,l={each:function(p,d){p&&(Array.isArray(p)?p.forEach(d):Object.keys(p).forEach(function(g){d(p[g],g)}))},some:function(p,d){return!!p&&(Array.isArray(p)?p.some(d):Object.keys(p).some(function(g){return d(p[g],g)}))},every:function(p,d){return!p||(Array.isArray(p)?p.every(d):Object.keys(p).every(function(g){return d(p[g],g)}))},map:function(p,d){return p?Array.isArray(p)?p.map(d):Object.keys(p).map(function(g){return d(p[g],g)}):[]},keyBy:function(p,d){return p.reduce(function(g,y){return g[y[d]]=y,g},{})},isEqual:function(p,d){var g=o(p),y=o(d),h=Array.isArray(p),u=Array.isArray(d);if(g!==y)return!1;switch(o(p)){case"object":return h||u?!(!h||!u)&&p.length===d.length&&p.every(function(f,c){var v=d[c];return l.isEqual(f,v)}):l.every(p,function(f,c){var v=d[c];return l.isEqual(f,v)});default:return p===d}},escapeHtml:function(p){var d=s.exec(p);if(!d)return p;for(var g="",y="",h=0,u=d.index;u<p.length;u++){switch(p.charAt(u)){case'"':y="&quot;";break;case"&":y="&amp;";break;case"'":y="&apos;";break;case"<":y="&lt;";break;case">":y="&gt;";break;default:continue}h!==u&&(g+=p.substring(h,u)),h=u+1,g+=y}return h!==u?g+p.substring(h,u):g},strcmp:function(p,d){return p<d?-1:p>d?1:0},isUndefined:function(p){return a.call(p)==="[object Undefined]"},isObject:function(p){return a.call(p)==="[object Object]"},deepMerge:function(){var p,d,g,y=arguments[0]||{},h=arguments.length;function u(c,v){p=y[v],g=Array.isArray(c),l.isObject(c)||g?(g?(g=!1,d=p&&Array.isArray(p)?p:[]):d=p&&l.isObject(p)?p:{},y[v]=l.deepMerge(d,c)):l.isUndefined(c)||(y[v]=c)}for(var f=0;f<h;f++)l.each(arguments[f],u);return y}};n.exports=l},{}],26:[function(e,n,i){(function(o,a){var s=e("fs"),l=/[<>&'"\x7F\x00-\x08\x0B-\x0C\x0E-\x1F]/,p={nop:function(){},promiseImmediate:function(d){return new Promise(function(g){o.setImmediate?a(function(){g(d)}):setTimeout(function(){g(d)},1)})},inherits:function(d,g,y,h){d.super_=g,h||(h=y,y=null),y&&Object.keys(y).forEach(function(f){Object.defineProperty(d,f,Object.getOwnPropertyDescriptor(y,f))});var u={constructor:{value:d,enumerable:!1,writable:!1,configurable:!0}};h&&Object.keys(h).forEach(function(f){u[f]=Object.getOwnPropertyDescriptor(h,f)}),d.prototype=Object.create(g.prototype,u)},dateToExcel:function(d,g){return 25569+d.getTime()/864e5-(g?1462:0)},excelToDate:function(d,g){var y=Math.round(24*(d-25569+(g?1462:0))*3600*1e3);return new Date(y)},parsePath:function(d){var g=d.lastIndexOf("/");return{path:d.substring(0,g),name:d.substring(g+1)}},getRelsPath:function(d){var g=p.parsePath(d);return"".concat(g.path,"/_rels/").concat(g.name,".rels")},xmlEncode:function(d){var g=l.exec(d);if(!g)return d;for(var y="",h="",u=0,f=g.index;f<d.length;f++){var c=d.charCodeAt(f);switch(c){case 34:h="&quot;";break;case 38:h="&amp;";break;case 39:h="&apos;";break;case 60:h="&lt;";break;case 62:h="&gt;";break;case 127:h="";break;default:if(c<=31&&(c<=8||c>=11&&c!==13)){h="";break}continue}u!==f&&(y+=d.substring(u,f)),u=f+1,h&&(y+=h)}return u!==f?y+d.substring(u,f):y},xmlDecode:function(d){return d.replace(/&([a-z]*);/g,function(g){switch(g){case"&lt;":return"<";case"&gt;":return">";case"&amp;":return"&";case"&apos;":return"'";case"&quot;":return'"';default:return g}})},validInt:function(d){var g=parseInt(d,10);return Number.isNaN(g)?0:g},isDateFmt:function(d){return!!d&&(d=(d=d.replace(/\[[^\]]*]/g,"")).replace(/"[^"]*"/g,"")).match(/[ymdhMsb]+/)!==null},fs:{exists:function(d){return new Promise(function(g){s.access(d,s.constants.F_OK,function(y){g(!y)})})}},toIsoDateString:function(d){return d.toIsoString().subsstr(0,10)}};n.exports=p}).call(this,typeof At!="undefined"?At:typeof self!="undefined"?self:typeof window!="undefined"?window:{},e("timers").setImmediate)},{fs:215,timers:521}],27:[function(e,n,i){function o(g,y){for(var h=0;h<y.length;h++){var u=y[h];u.enumerable=u.enumerable||!1,u.configurable=!0,"value"in u&&(u.writable=!0),Object.defineProperty(g,u.key,u)}}var a=e("./under-dash"),s=e("./utils");function l(g,y,h){g.push(" "),g.push(y),g.push('="'),g.push(s.xmlEncode(h.toString())),g.push('"')}function p(g,y){y&&a.each(y,function(h,u){h!==void 0&&l(g,u,h)})}var d=function(){function g(){(function(u,f){if(!(u instanceof f))throw new TypeError("Cannot call a class as a function")})(this,g),this._xml=[],this._stack=[],this._rollbacks=[]}var y,h;return y=g,(h=[{key:"openXml",value:function(u){var f=this._xml;f.push("<?xml"),p(f,u),f.push(`?>
`)}},{key:"openNode",value:function(u,f){var c=this.tos,v=this._xml;c&&this.open&&v.push(">"),this._stack.push(u),v.push("<"),v.push(u),p(v,f),this.leaf=!0,this.open=!0}},{key:"addAttribute",value:function(u,f){if(!this.open)throw new Error("Cannot write attributes to node if it is not open");f!==void 0&&l(this._xml,u,f)}},{key:"addAttributes",value:function(u){if(!this.open)throw new Error("Cannot write attributes to node if it is not open");p(this._xml,u)}},{key:"writeText",value:function(u){var f=this._xml;this.open&&(f.push(">"),this.open=!1),this.leaf=!1,f.push(s.xmlEncode(u.toString()))}},{key:"writeXml",value:function(u){this.open&&(this._xml.push(">"),this.open=!1),this.leaf=!1,this._xml.push(u)}},{key:"closeNode",value:function(){var u=this._stack.pop(),f=this._xml;this.leaf?f.push("/>"):(f.push("</"),f.push(u),f.push(">")),this.open=!1,this.leaf=!1}},{key:"leafNode",value:function(u,f,c){this.openNode(u,f),c!==void 0&&this.writeText(c),this.closeNode()}},{key:"closeAll",value:function(){for(;this._stack.length;)this.closeNode()}},{key:"addRollback",value:function(){return this._rollbacks.push({xml:this._xml.length,stack:this._stack.length,leaf:this.leaf,open:this.open}),this.cursor}},{key:"commit",value:function(){this._rollbacks.pop()}},{key:"rollback",value:function(){var u=this._rollbacks.pop();this._xml.length>u.xml&&this._xml.splice(u.xml,this._xml.length-u.xml),this._stack.length>u.stack&&this._stack.splice(u.stack,this._stack.length-u.stack),this.leaf=u.leaf,this.open=u.open}},{key:"tos",get:function(){return this._stack.length?this._stack[this._stack.length-1]:void 0}},{key:"cursor",get:function(){return this._xml.length}},{key:"xml",get:function(){return this.closeAll(),this._xml.join("")}}])&&o(y.prototype,h),g}();d.StdDocAttributes={version:"1.0",encoding:"UTF-8",standalone:"yes"},n.exports=d},{"./under-dash":25,"./utils":26}],28:[function(e,n,i){(function(o){function a(m){return(a=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(b){return typeof b}:function(b){return b&&typeof Symbol=="function"&&b.constructor===Symbol&&b!==Symbol.prototype?"symbol":typeof b})(m)}function s(m,b,w,_,C,R,I){try{var P=m[R](I),N=P.value}catch(A){return void w(A)}P.done?b(N):Promise.resolve(N).then(_,C)}function l(m,b){for(var w=0;w<b.length;w++){var _=b[w];_.enumerable=_.enumerable||!1,_.configurable=!0,"value"in _&&(_.writable=!0),Object.defineProperty(m,_.key,_)}}function p(m,b){return(p=Object.setPrototypeOf||function(w,_){return w.__proto__=_,w})(m,b)}function d(m){var b=function(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch{return!1}}();return function(){var w,_=y(m);if(b){var C=y(this).constructor;w=Reflect.construct(_,arguments,C)}else w=_.apply(this,arguments);return g(this,w)}}function g(m,b){return!b||a(b)!=="object"&&typeof b!="function"?function(w){if(w===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return w}(m):b}function y(m){return(y=Object.setPrototypeOf?Object.getPrototypeOf:function(b){return b.__proto__||Object.getPrototypeOf(b)})(m)}var h=e("events"),u=e("jszip"),f=e("./stream-buf"),c=e("./browser-buffer-encode").stringToBuffer,v=function(m){(function(P,N){if(typeof N!="function"&&N!==null)throw new TypeError("Super expression must either be null or a function");P.prototype=Object.create(N&&N.prototype,{constructor:{value:P,writable:!0,configurable:!0}}),N&&p(P,N)})(I,m);var b,w,_,C,R=d(I);function I(P){var N;return function(A,$){if(!(A instanceof $))throw new TypeError("Cannot call a class as a function")}(this,I),(N=R.call(this)).options=Object.assign({type:"nodebuffer",compression:"DEFLATE"},P),N.zip=new u,N.stream=new f,N}return b=I,(w=[{key:"append",value:function(P,N){N.hasOwnProperty("base64")&&N.base64?this.zip.file(N.name,P,{base64:!0}):(o.browser&&typeof P=="string"&&(P=c(P)),this.zip.file(N.name,P))}},{key:"finalize",value:(_=regeneratorRuntime.mark(function P(){var N;return regeneratorRuntime.wrap(function(A){for(;;)switch(A.prev=A.next){case 0:return A.next=2,this.zip.generateAsync(this.options);case 2:N=A.sent,this.stream.end(N),this.emit("finish");case 5:case"end":return A.stop()}},P,this)}),C=function(){var P=this,N=arguments;return new Promise(function(A,$){var T=_.apply(P,N);function M(E){s(T,A,$,M,S,"next",E)}function S(E){s(T,A,$,M,S,"throw",E)}M(void 0)})},function(){return C.apply(this,arguments)})},{key:"read",value:function(P){return this.stream.read(P)}},{key:"setEncoding",value:function(P){return this.stream.setEncoding(P)}},{key:"pause",value:function(){return this.stream.pause()}},{key:"resume",value:function(){return this.stream.resume()}},{key:"isPaused",value:function(){return this.stream.isPaused()}},{key:"pipe",value:function(P,N){return this.stream.pipe(P,N)}},{key:"unpipe",value:function(P){return this.stream.unpipe(P)}},{key:"unshift",value:function(P){return this.stream.unshift(P)}},{key:"wrap",value:function(P){return this.stream.wrap(P)}}])&&l(b.prototype,w),I}(h.EventEmitter);n.exports={ZipWriter:v}}).call(this,e("_process"))},{"./browser-buffer-encode":17,"./stream-buf":23,_process:467,events:367,jszip:399}],29:[function(e,n,i){n.exports={0:{f:"General"},1:{f:"0"},2:{f:"0.00"},3:{f:"#,##0"},4:{f:"#,##0.00"},9:{f:"0%"},10:{f:"0.00%"},11:{f:"0.00E+00"},12:{f:"# ?/?"},13:{f:"# ??/??"},14:{f:"mm-dd-yy"},15:{f:"d-mmm-yy"},16:{f:"d-mmm"},17:{f:"mmm-yy"},18:{f:"h:mm AM/PM"},19:{f:"h:mm:ss AM/PM"},20:{f:"h:mm"},21:{f:"h:mm:ss"},22:{f:'m/d/yy "h":mm'},27:{"zh-tw":"[$-404]e/m/d","zh-cn":'yyyy"\u5E74"m"\u6708"',"ja-jp":"[$-411]ge.m.d","ko-kr":'yyyy"\u5E74" mm"\u6708" dd"\u65E5"'},28:{"zh-tw":'[$-404]e"\u5E74"m"\u6708"d"\u65E5"',"zh-cn":'m"\u6708"d"\u65E5"',"ja-jp":'[$-411]ggge"\u5E74"m"\u6708"d"\u65E5"',"ko-kr":"mm-dd"},29:{"zh-tw":'[$-404]e"\u5E74"m"\u6708"d"\u65E5"',"zh-cn":'m"\u6708"d"\u65E5"',"ja-jp":'[$-411]ggge"\u5E74"m"\u6708"d"\u65E5"',"ko-kr":"mm-dd"},30:{"zh-tw":"m/d/yy ","zh-cn":"m-d-yy","ja-jp":"m/d/yy","ko-kr":"mm-dd-yy"},31:{"zh-tw":'yyyy"\u5E74"m"\u6708"d"\u65E5"',"zh-cn":'yyyy"\u5E74"m"\u6708"d"\u65E5"',"ja-jp":'yyyy"\u5E74"m"\u6708"d"\u65E5"',"ko-kr":'yyyy"\uB144" mm"\uC6D4" dd"\uC77C"'},32:{"zh-tw":'hh"\u6642"mm"\u5206"',"zh-cn":'h"\u65F6"mm"\u5206"',"ja-jp":'h"\u6642"mm"\u5206"',"ko-kr":'h"\uC2DC" mm"\uBD84"'},33:{"zh-tw":'hh"\u6642"mm"\u5206"ss"\u79D2"',"zh-cn":'h"\u65F6"mm"\u5206"ss"\u79D2"',"ja-jp":'h"\u6642"mm"\u5206"ss"\u79D2"',"ko-kr":'h"\uC2DC" mm"\uBD84" ss"\uCD08"'},34:{"zh-tw":'\u4E0A\u5348/\u4E0B\u5348 hh"\u6642"mm"\u5206"',"zh-cn":'\u4E0A\u5348/\u4E0B\u5348 h"\u65F6"mm"\u5206"',"ja-jp":'yyyy"\u5E74"m"\u6708"',"ko-kr":"yyyy-mm-dd"},35:{"zh-tw":'\u4E0A\u5348/\u4E0B\u5348 hh"\u6642"mm"\u5206"ss"\u79D2"',"zh-cn":'\u4E0A\u5348/\u4E0B\u5348 h"\u65F6"mm"\u5206"ss"\u79D2"',"ja-jp":'m"\u6708"d"\u65E5"',"ko-kr":"yyyy-mm-dd"},36:{"zh-tw":"[$-404]e/m/d","zh-cn":'yyyy"\u5E74"m"\u6708"',"ja-jp":"[$-411]ge.m.d","ko-kr":'yyyy"\u5E74" mm"\u6708" dd"\u65E5"'},37:{f:"#,##0 ;(#,##0)"},38:{f:"#,##0 ;[Red](#,##0)"},39:{f:"#,##0.00 ;(#,##0.00)"},40:{f:"#,##0.00 ;[Red](#,##0.00)"},45:{f:"mm:ss"},46:{f:"[h]:mm:ss"},47:{f:"mmss.0"},48:{f:"##0.0E+0"},49:{f:"@"},50:{"zh-tw":"[$-404]e/m/d","zh-cn":'yyyy"\u5E74"m"\u6708"',"ja-jp":"[$-411]ge.m.d","ko-kr":'yyyy"\u5E74" mm"\u6708" dd"\u65E5"'},51:{"zh-tw":'[$-404]e"\u5E74"m"\u6708"d"\u65E5"',"zh-cn":'m"\u6708"d"\u65E5"',"ja-jp":'[$-411]ggge"\u5E74"m"\u6708"d"\u65E5"',"ko-kr":"mm-dd"},52:{"zh-tw":'\u4E0A\u5348/\u4E0B\u5348 hh"\u6642"mm"\u5206"',"zh-cn":'yyyy"\u5E74"m"\u6708"',"ja-jp":'yyyy"\u5E74"m"\u6708"',"ko-kr":"yyyy-mm-dd"},53:{"zh-tw":'\u4E0A\u5348/\u4E0B\u5348 hh"\u6642"mm"\u5206"ss"\u79D2"',"zh-cn":'m"\u6708"d"\u65E5"',"ja-jp":'m"\u6708"d"\u65E5"',"ko-kr":"yyyy-mm-dd"},54:{"zh-tw":'[$-404]e"\u5E74"m"\u6708"d"\u65E5"',"zh-cn":'m"\u6708"d"\u65E5"',"ja-jp":'[$-411]ggge"\u5E74"m"\u6708"d"\u65E5"',"ko-kr":"mm-dd"},55:{"zh-tw":'\u4E0A\u5348/\u4E0B\u5348 hh"\u6642"mm"\u5206"',"zh-cn":'\u4E0A\u5348/\u4E0B\u5348 h"\u65F6"mm"\u5206"',"ja-jp":'yyyy"\u5E74"m"\u6708"',"ko-kr":"yyyy-mm-dd"},56:{"zh-tw":'\u4E0A\u5348/\u4E0B\u5348 hh"\u6642"mm"\u5206"ss"\u79D2"',"zh-cn":'\u4E0A\u5348/\u4E0B\u5348 h"\u65F6"mm"\u5206"ss"\u79D2"',"ja-jp":'m"\u6708"d"\u65E5"',"ko-kr":"yyyy-mm-dd"},57:{"zh-tw":"[$-404]e/m/d","zh-cn":'yyyy"\u5E74"m"\u6708"',"ja-jp":"[$-411]ge.m.d","ko-kr":'yyyy"\u5E74" mm"\u6708" dd"\u65E5"'},58:{"zh-tw":'[$-404]e"\u5E74"m"\u6708"d"\u65E5"',"zh-cn":'m"\u6708"d"\u65E5"',"ja-jp":'[$-411]ggge"\u5E74"m"\u6708"d"\u65E5"',"ko-kr":"mm-dd"},59:{"th-th":"t0"},60:{"th-th":"t0.00"},61:{"th-th":"t#,##0"},62:{"th-th":"t#,##0.00"},67:{"th-th":"t0%"},68:{"th-th":"t0.00%"},69:{"th-th":"t# ?/?"},70:{"th-th":"t# ??/??"},81:{"th-th":"d/m/bb"}}},{}],30:[function(e,n,i){n.exports={OfficeDocument:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",Worksheet:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet",CalcChain:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/calcChain",SharedStrings:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",Styles:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",Theme:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",Hyperlink:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",Image:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",CoreProperties:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",ExtenderProperties:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",Comments:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",VmlDrawing:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",Table:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/table"}},{}],31:[function(e,n,i){function o(u,f){var c;if(typeof Symbol=="undefined"||u[Symbol.iterator]==null){if(Array.isArray(u)||(c=function(C,R){if(!!C){if(typeof C=="string")return a(C,R);var I=Object.prototype.toString.call(C).slice(8,-1);if(I==="Object"&&C.constructor&&(I=C.constructor.name),I==="Map"||I==="Set")return Array.from(C);if(I==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(I))return a(C,R)}}(u))||f&&u&&typeof u.length=="number"){c&&(u=c);var v=0,m=function(){};return{s:m,n:function(){return v>=u.length?{done:!0}:{done:!1,value:u[v++]}},e:function(C){throw C},f:m}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var b,w=!0,_=!1;return{s:function(){c=u[Symbol.iterator]()},n:function(){var C=c.next();return w=C.done,C},e:function(C){_=!0,b=C},f:function(){try{w||c.return==null||c.return()}finally{if(_)throw b}}}}function a(u,f){(f==null||f>u.length)&&(f=u.length);for(var c=0,v=new Array(f);c<f;c++)v[c]=u[c];return v}function s(u,f,c,v,m,b,w){try{var _=u[b](w),C=_.value}catch(R){return void c(R)}_.done?f(C):Promise.resolve(C).then(v,m)}function l(u){return function(){var f=this,c=arguments;return new Promise(function(v,m){var b=u.apply(f,c);function w(C){s(b,v,m,w,_,"next",C)}function _(C){s(b,v,m,w,_,"throw",C)}w(void 0)})}}function p(u,f){for(var c=0;c<f.length;c++){var v=f[c];v.enumerable=v.enumerable||!1,v.configurable=!0,"value"in v&&(v.writable=!0),Object.defineProperty(u,v.key,v)}}function d(u){var f;if(typeof Symbol!="undefined"&&(Symbol.asyncIterator&&(f=u[Symbol.asyncIterator])!=null||Symbol.iterator&&(f=u[Symbol.iterator])!=null))return f.call(u);throw new TypeError("Object is not async iterable")}var g=e("../../utils/parse-sax"),y=e("../../utils/xml-stream"),h=function(){function u(){(function(w,_){if(!(w instanceof _))throw new TypeError("Cannot call a class as a function")})(this,u)}var f,c,v,m,b;return f=u,c=[{key:"prepare",value:function(){}},{key:"render",value:function(){}},{key:"parseOpen",value:function(w){}},{key:"parseText",value:function(w){}},{key:"parseClose",value:function(w){}},{key:"reconcile",value:function(w,_){}},{key:"reset",value:function(){this.model=null,this.map&&Object.values(this.map).forEach(function(w){w instanceof u?w.reset():w.xform&&w.xform.reset()})}},{key:"mergeModel",value:function(w){this.model=Object.assign(this.model||{},w)}},{key:"parse",value:(b=l(regeneratorRuntime.mark(function w(_){var C,R,I,P,N,A,$,T,M,S,E;return regeneratorRuntime.wrap(function(k){for(;;)switch(k.prev=k.next){case 0:C=!0,R=!1,k.prev=2,P=d(_);case 4:return k.next=6,P.next();case 6:return N=k.sent,C=N.done,k.next=10,N.value;case 10:if(A=k.sent,C){k.next=42;break}$=o(A),k.prev=14,$.s();case 16:if((T=$.n()).done){k.next=31;break}if(M=T.value,S=M.eventType,E=M.value,S!=="opentag"){k.next=22;break}this.parseOpen(E),k.next=29;break;case 22:if(S!=="text"){k.next=26;break}this.parseText(E),k.next=29;break;case 26:if(S!=="closetag"){k.next=29;break}if(this.parseClose(E.name)){k.next=29;break}return k.abrupt("return",this.model);case 29:k.next=16;break;case 31:k.next=36;break;case 33:k.prev=33,k.t0=k.catch(14),$.e(k.t0);case 36:return k.prev=36,$.f(),k.finish(36);case 39:C=!0,k.next=4;break;case 42:k.next=48;break;case 44:k.prev=44,k.t1=k.catch(2),R=!0,I=k.t1;case 48:if(k.prev=48,k.prev=49,C||P.return==null){k.next=53;break}return k.next=53,P.return();case 53:if(k.prev=53,!R){k.next=56;break}throw I;case 56:return k.finish(53);case 57:return k.finish(48);case 58:return k.abrupt("return",this.model);case 59:case"end":return k.stop()}},w,this,[[2,44,48,58],[14,33,36,39],[49,,53,57]])})),function(w){return b.apply(this,arguments)})},{key:"parseStream",value:(m=l(regeneratorRuntime.mark(function w(_){return regeneratorRuntime.wrap(function(C){for(;;)switch(C.prev=C.next){case 0:return C.abrupt("return",this.parse(g(_)));case 1:case"end":return C.stop()}},w,this)})),function(w){return m.apply(this,arguments)})},{key:"toXml",value:function(w){var _=new y;return this.render(_,w),_.xml}},{key:"xml",get:function(){return this.toXml(this.model)}}],v=[{key:"toAttribute",value:function(w,_){var C=arguments.length>2&&arguments[2]!==void 0&&arguments[2];if(w===void 0){if(C)return _}else if(C||w!==_)return w.toString()}},{key:"toStringAttribute",value:function(w,_){var C=arguments.length>2&&arguments[2]!==void 0&&arguments[2];return u.toAttribute(w,_,C)}},{key:"toStringValue",value:function(w,_){return w===void 0?_:w}},{key:"toBoolAttribute",value:function(w,_){var C=arguments.length>2&&arguments[2]!==void 0&&arguments[2];if(w===void 0){if(C)return _}else if(C||w!==_)return w?"1":"0"}},{key:"toBoolValue",value:function(w,_){return w===void 0?_:w==="1"}},{key:"toIntAttribute",value:function(w,_){var C=arguments.length>2&&arguments[2]!==void 0&&arguments[2];return u.toAttribute(w,_,C)}},{key:"toIntValue",value:function(w,_){return w===void 0?_:parseInt(w,10)}},{key:"toFloatAttribute",value:function(w,_){var C=arguments.length>2&&arguments[2]!==void 0&&arguments[2];return u.toAttribute(w,_,C)}},{key:"toFloatValue",value:function(w,_){return w===void 0?_:parseFloat(w)}}],c&&p(f.prototype,c),v&&p(f,v),u}();n.exports=h},{"../../utils/parse-sax":21,"../../utils/xml-stream":27}],32:[function(e,n,i){function o(v){return(o=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(m){return typeof m}:function(m){return m&&typeof Symbol=="function"&&m.constructor===Symbol&&m!==Symbol.prototype?"symbol":typeof m})(v)}function a(v,m){if(!(v instanceof m))throw new TypeError("Cannot call a class as a function")}function s(v,m){for(var b=0;b<m.length;b++){var w=m[b];w.enumerable=w.enumerable||!1,w.configurable=!0,"value"in w&&(w.writable=!0),Object.defineProperty(v,w.key,w)}}function l(v,m){return(l=Object.setPrototypeOf||function(b,w){return b.__proto__=w,b})(v,m)}function p(v){var m=function(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch{return!1}}();return function(){var b,w=g(v);if(m){var _=g(this).constructor;b=Reflect.construct(w,arguments,_)}else b=w.apply(this,arguments);return d(this,b)}}function d(v,m){return!m||o(m)!=="object"&&typeof m!="function"?function(b){if(b===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return b}(v):m}function g(v){return(g=Object.setPrototypeOf?Object.getPrototypeOf:function(m){return m.__proto__||Object.getPrototypeOf(m)})(v)}var y=e("../base-xform"),h=e("../../../utils/col-cache"),u=function(v){(function(C,R){if(typeof R!="function"&&R!==null)throw new TypeError("Super expression must either be null or a function");C.prototype=Object.create(R&&R.prototype,{constructor:{value:C,writable:!0,configurable:!0}}),R&&l(C,R)})(_,v);var m,b,w=p(_);function _(){return a(this,_),w.apply(this,arguments)}return m=_,(b=[{key:"render",value:function(C,R){C.openNode("definedName",{name:R.name,localSheetId:R.localSheetId}),C.writeText(R.ranges.join(",")),C.closeNode()}},{key:"parseOpen",value:function(C){switch(C.name){case"definedName":return this._parsedName=C.attributes.name,this._parsedLocalSheetId=C.attributes.localSheetId,this._parsedText=[],!0;default:return!1}}},{key:"parseText",value:function(C){this._parsedText.push(C)}},{key:"parseClose",value:function(){return this.model={name:this._parsedName,ranges:c(this._parsedText.join(""))},this._parsedLocalSheetId!==void 0&&(this.model.localSheetId=parseInt(this._parsedLocalSheetId,10)),!1}}])&&s(m.prototype,b),_}(y);function f(v){try{return h.decodeEx(v),!0}catch{return!1}}function c(v){var m=[],b=!1,w="";return v.split(",").forEach(function(_){if(_){var C=(_.match(/'/g)||[]).length;if(C){var R=C%2==0;!b&&R&&f(_)?m.push(_):b&&!R?(b=!1,f(w+_)&&m.push(w+_),w=""):(b=!0,w+="".concat(_,","))}else b?w+="".concat(_,","):f(_)&&m.push(_)}}),m}n.exports=u},{"../../../utils/col-cache":19,"../base-xform":31}],33:[function(e,n,i){function o(u){return(o=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(f){return typeof f}:function(f){return f&&typeof Symbol=="function"&&f.constructor===Symbol&&f!==Symbol.prototype?"symbol":typeof f})(u)}function a(u,f){if(!(u instanceof f))throw new TypeError("Cannot call a class as a function")}function s(u,f){for(var c=0;c<f.length;c++){var v=f[c];v.enumerable=v.enumerable||!1,v.configurable=!0,"value"in v&&(v.writable=!0),Object.defineProperty(u,v.key,v)}}function l(u,f){return(l=Object.setPrototypeOf||function(c,v){return c.__proto__=v,c})(u,f)}function p(u){var f=function(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch{return!1}}();return function(){var c,v=g(u);if(f){var m=g(this).constructor;c=Reflect.construct(v,arguments,m)}else c=v.apply(this,arguments);return d(this,c)}}function d(u,f){return!f||o(f)!=="object"&&typeof f!="function"?function(c){if(c===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return c}(u):f}function g(u){return(g=Object.setPrototypeOf?Object.getPrototypeOf:function(f){return f.__proto__||Object.getPrototypeOf(f)})(u)}var y=e("../../../utils/utils"),h=function(u){(function(b,w){if(typeof w!="function"&&w!==null)throw new TypeError("Super expression must either be null or a function");b.prototype=Object.create(w&&w.prototype,{constructor:{value:b,writable:!0,configurable:!0}}),w&&l(b,w)})(m,u);var f,c,v=p(m);function m(){return a(this,m),v.apply(this,arguments)}return f=m,(c=[{key:"render",value:function(b,w){b.leafNode("sheet",{sheetId:w.id,name:w.name,state:w.state,"r:id":w.rId})}},{key:"parseOpen",value:function(b){return b.name==="sheet"&&(this.model={name:y.xmlDecode(b.attributes.name),id:parseInt(b.attributes.sheetId,10),state:b.attributes.state,rId:b.attributes["r:id"]},!0)}},{key:"parseText",value:function(){}},{key:"parseClose",value:function(){return!1}}])&&s(f.prototype,c),m}(e("../base-xform"));n.exports=h},{"../../../utils/utils":26,"../base-xform":31}],34:[function(e,n,i){function o(h){return(o=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(u){return typeof u}:function(u){return u&&typeof Symbol=="function"&&u.constructor===Symbol&&u!==Symbol.prototype?"symbol":typeof u})(h)}function a(h,u){if(!(h instanceof u))throw new TypeError("Cannot call a class as a function")}function s(h,u){for(var f=0;f<u.length;f++){var c=u[f];c.enumerable=c.enumerable||!1,c.configurable=!0,"value"in c&&(c.writable=!0),Object.defineProperty(h,c.key,c)}}function l(h,u){return(l=Object.setPrototypeOf||function(f,c){return f.__proto__=c,f})(h,u)}function p(h){var u=function(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch{return!1}}();return function(){var f,c=g(h);if(u){var v=g(this).constructor;f=Reflect.construct(c,arguments,v)}else f=c.apply(this,arguments);return d(this,f)}}function d(h,u){return!u||o(u)!=="object"&&typeof u!="function"?function(f){if(f===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return f}(h):u}function g(h){return(g=Object.setPrototypeOf?Object.getPrototypeOf:function(u){return u.__proto__||Object.getPrototypeOf(u)})(h)}var y=function(h){(function(m,b){if(typeof b!="function"&&b!==null)throw new TypeError("Super expression must either be null or a function");m.prototype=Object.create(b&&b.prototype,{constructor:{value:m,writable:!0,configurable:!0}}),b&&l(m,b)})(v,h);var u,f,c=p(v);function v(){return a(this,v),c.apply(this,arguments)}return u=v,(f=[{key:"render",value:function(m,b){m.leafNode("calcPr",{calcId:171027,fullCalcOnLoad:b.fullCalcOnLoad?1:void 0})}},{key:"parseOpen",value:function(m){return m.name==="calcPr"&&(this.model={},!0)}},{key:"parseText",value:function(){}},{key:"parseClose",value:function(){return!1}}])&&s(u.prototype,f),v}(e("../base-xform"));n.exports=y},{"../base-xform":31}],35:[function(e,n,i){function o(h){return(o=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(u){return typeof u}:function(u){return u&&typeof Symbol=="function"&&u.constructor===Symbol&&u!==Symbol.prototype?"symbol":typeof u})(h)}function a(h,u){if(!(h instanceof u))throw new TypeError("Cannot call a class as a function")}function s(h,u){for(var f=0;f<u.length;f++){var c=u[f];c.enumerable=c.enumerable||!1,c.configurable=!0,"value"in c&&(c.writable=!0),Object.defineProperty(h,c.key,c)}}function l(h,u){return(l=Object.setPrototypeOf||function(f,c){return f.__proto__=c,f})(h,u)}function p(h){var u=function(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch{return!1}}();return function(){var f,c=g(h);if(u){var v=g(this).constructor;f=Reflect.construct(c,arguments,v)}else f=c.apply(this,arguments);return d(this,f)}}function d(h,u){return!u||o(u)!=="object"&&typeof u!="function"?function(f){if(f===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return f}(h):u}function g(h){return(g=Object.setPrototypeOf?Object.getPrototypeOf:function(u){return u.__proto__||Object.getPrototypeOf(u)})(h)}var y=function(h){(function(m,b){if(typeof b!="function"&&b!==null)throw new TypeError("Super expression must either be null or a function");m.prototype=Object.create(b&&b.prototype,{constructor:{value:m,writable:!0,configurable:!0}}),b&&l(m,b)})(v,h);var u,f,c=p(v);function v(){return a(this,v),c.apply(this,arguments)}return u=v,(f=[{key:"render",value:function(m,b){m.leafNode("workbookPr",{date1904:b.date1904?1:void 0,defaultThemeVersion:164011,filterPrivacy:1})}},{key:"parseOpen",value:function(m){return m.name==="workbookPr"&&(this.model={date1904:m.attributes.date1904==="1"},!0)}},{key:"parseText",value:function(){}},{key:"parseClose",value:function(){return!1}}])&&s(u.prototype,f),v}(e("../base-xform"));n.exports=y},{"../base-xform":31}],36:[function(e,n,i){function o(h){return(o=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(u){return typeof u}:function(u){return u&&typeof Symbol=="function"&&u.constructor===Symbol&&u!==Symbol.prototype?"symbol":typeof u})(h)}function a(h,u){if(!(h instanceof u))throw new TypeError("Cannot call a class as a function")}function s(h,u){for(var f=0;f<u.length;f++){var c=u[f];c.enumerable=c.enumerable||!1,c.configurable=!0,"value"in c&&(c.writable=!0),Object.defineProperty(h,c.key,c)}}function l(h,u){return(l=Object.setPrototypeOf||function(f,c){return f.__proto__=c,f})(h,u)}function p(h){var u=function(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch{return!1}}();return function(){var f,c=g(h);if(u){var v=g(this).constructor;f=Reflect.construct(c,arguments,v)}else f=c.apply(this,arguments);return d(this,f)}}function d(h,u){return!u||o(u)!=="object"&&typeof u!="function"?function(f){if(f===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return f}(h):u}function g(h){return(g=Object.setPrototypeOf?Object.getPrototypeOf:function(u){return u.__proto__||Object.getPrototypeOf(u)})(h)}var y=function(h){(function(m,b){if(typeof b!="function"&&b!==null)throw new TypeError("Super expression must either be null or a function");m.prototype=Object.create(b&&b.prototype,{constructor:{value:m,writable:!0,configurable:!0}}),b&&l(m,b)})(v,h);var u,f,c=p(v);function v(){return a(this,v),c.apply(this,arguments)}return u=v,(f=[{key:"render",value:function(m,b){var w={xWindow:b.x||0,yWindow:b.y||0,windowWidth:b.width||12e3,windowHeight:b.height||24e3,firstSheet:b.firstSheet,activeTab:b.activeTab};b.visibility&&b.visibility!=="visible"&&(w.visibility=b.visibility),m.leafNode("workbookView",w)}},{key:"parseOpen",value:function(m){if(m.name==="workbookView"){var b=this.model={},w=function(P,N,A){var $=N!==void 0?b[P]=parseInt(N,10):A;$!==void 0&&(b[P]=$)};return w("x",m.attributes.xWindow,0),w("y",m.attributes.yWindow,0),w("width",m.attributes.windowWidth,25e3),w("height",m.attributes.windowHeight,1e4),_="visibility",C=m.attributes.visibility,R="visible",(I=C!==void 0?b[_]=C:R)!==void 0&&(b[_]=I),w("activeTab",m.attributes.activeTab,void 0),w("firstSheet",m.attributes.firstSheet,void 0),!0}var _,C,R,I;return!1}},{key:"parseText",value:function(){}},{key:"parseClose",value:function(){return!1}}])&&s(u.prototype,f),v}(e("../base-xform"));n.exports=y},{"../base-xform":31}],37:[function(e,n,i){function o(R){return(o=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(I){return typeof I}:function(I){return I&&typeof Symbol=="function"&&I.constructor===Symbol&&I!==Symbol.prototype?"symbol":typeof I})(R)}function a(R,I){for(var P=0;P<I.length;P++){var N=I[P];N.enumerable=N.enumerable||!1,N.configurable=!0,"value"in N&&(N.writable=!0),Object.defineProperty(R,N.key,N)}}function s(R,I){return(s=Object.setPrototypeOf||function(P,N){return P.__proto__=N,P})(R,I)}function l(R){var I=function(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch{return!1}}();return function(){var P,N=d(R);if(I){var A=d(this).constructor;P=Reflect.construct(N,arguments,A)}else P=N.apply(this,arguments);return p(this,P)}}function p(R,I){return!I||o(I)!=="object"&&typeof I!="function"?function(P){if(P===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return P}(R):I}function d(R){return(d=Object.setPrototypeOf?Object.getPrototypeOf:function(I){return I.__proto__||Object.getPrototypeOf(I)})(R)}var g=e("../../../utils/under-dash"),y=e("../../../utils/col-cache"),h=e("../../../utils/xml-stream"),u=e("../base-xform"),f=e("../static-xform"),c=e("../list-xform"),v=e("./defined-name-xform"),m=e("./sheet-xform"),b=e("./workbook-view-xform"),w=e("./workbook-properties-xform"),_=e("./workbook-calc-properties-xform"),C=function(R){(function($,T){if(typeof T!="function"&&T!==null)throw new TypeError("Super expression must either be null or a function");$.prototype=Object.create(T&&T.prototype,{constructor:{value:$,writable:!0,configurable:!0}}),T&&s($,T)})(A,R);var I,P,N=l(A);function A(){var $;return function(T,M){if(!(T instanceof M))throw new TypeError("Cannot call a class as a function")}(this,A),($=N.call(this)).map={fileVersion:A.STATIC_XFORMS.fileVersion,workbookPr:new w,bookViews:new c({tag:"bookViews",count:!1,childXform:new b}),sheets:new c({tag:"sheets",count:!1,childXform:new m}),definedNames:new c({tag:"definedNames",count:!1,childXform:new v}),calcPr:new _},$}return I=A,(P=[{key:"prepare",value:function($){$.sheets=$.worksheets;var T=[],M=0;$.sheets.forEach(function(S){if(S.pageSetup&&S.pageSetup.printArea&&S.pageSetup.printArea.split("&&").forEach(function(j){var H=j.split(":"),F={name:"_xlnm.Print_Area",ranges:["'".concat(S.name,"'!$").concat(H[0],":$").concat(H[1])],localSheetId:M};T.push(F)}),S.pageSetup&&(S.pageSetup.printTitlesRow||S.pageSetup.printTitlesColumn)){var E=[];if(S.pageSetup.printTitlesColumn){var k=S.pageSetup.printTitlesColumn.split(":");E.push("'".concat(S.name,"'!$").concat(k[0],":$").concat(k[1]))}if(S.pageSetup.printTitlesRow){var O=S.pageSetup.printTitlesRow.split(":");E.push("'".concat(S.name,"'!$").concat(O[0],":$").concat(O[1]))}var x={name:"_xlnm.Print_Titles",ranges:E,localSheetId:M};T.push(x)}M++}),T.length&&($.definedNames=$.definedNames.concat(T)),($.media||[]).forEach(function(S,E){S.name=S.type+(E+1)})}},{key:"render",value:function($,T){$.openXml(h.StdDocAttributes),$.openNode("workbook",A.WORKBOOK_ATTRIBUTES),this.map.fileVersion.render($),this.map.workbookPr.render($,T.properties),this.map.bookViews.render($,T.views),this.map.sheets.render($,T.sheets),this.map.definedNames.render($,T.definedNames),this.map.calcPr.render($,T.calcProperties),$.closeNode()}},{key:"parseOpen",value:function($){if(this.parser)return this.parser.parseOpen($),!0;switch($.name){case"workbook":return!0;default:return this.parser=this.map[$.name],this.parser&&this.parser.parseOpen($),!0}}},{key:"parseText",value:function($){this.parser&&this.parser.parseText($)}},{key:"parseClose",value:function($){if(this.parser)return this.parser.parseClose($)||(this.parser=void 0),!0;switch($){case"workbook":return this.model={sheets:this.map.sheets.model,properties:this.map.workbookPr.model||{},views:this.map.bookViews.model,calcProperties:{}},this.map.definedNames.model&&(this.model.definedNames=this.map.definedNames.model),!1;default:return!0}}},{key:"reconcile",value:function($){var T,M=($.workbookRels||[]).reduce(function(O,x){return O[x.Id]=x,O},{}),S=[],E=0;($.sheets||[]).forEach(function(O){var x=M[O.rId];x&&(T=$.worksheetHash["xl/".concat(x.Target.replace(/^(\s|\/xl\/)+/,""))])&&(T.name=O.name,T.id=O.id,T.state=O.state,S[E++]=T)});var k=[];g.each($.definedNames,function(O){if(O.name==="_xlnm.Print_Area"){if(T=S[O.localSheetId]){T.pageSetup||(T.pageSetup={});var x=y.decodeEx(O.ranges[0]);T.pageSetup.printArea=T.pageSetup.printArea?"".concat(T.pageSetup.printArea,"&&").concat(x.dimensions):x.dimensions}}else if(O.name==="_xlnm.Print_Titles"){if(T=S[O.localSheetId]){T.pageSetup||(T.pageSetup={});var j=O.ranges.join(","),H=/\$/g,F=j.match(/\$\d+:\$\d+/);if(F&&F.length){var V=F[0];T.pageSetup.printTitlesRow=V.replace(H,"")}var W=j.match(/\$[A-Z]+:\$[A-Z]+/);if(W&&W.length){var U=W[0];T.pageSetup.printTitlesColumn=U.replace(H,"")}}}else k.push(O)}),$.definedNames=k,$.media.forEach(function(O,x){O.index=x})}}])&&a(I.prototype,P),A}(u);C.WORKBOOK_ATTRIBUTES={xmlns:"http://schemas.openxmlformats.org/spreadsheetml/2006/main","xmlns:r":"http://schemas.openxmlformats.org/officeDocument/2006/relationships","xmlns:mc":"http://schemas.openxmlformats.org/markup-compatibility/2006","mc:Ignorable":"x15","xmlns:x15":"http://schemas.microsoft.com/office/spreadsheetml/2010/11/main"},C.STATIC_XFORMS={fileVersion:new f({tag:"fileVersion",$:{appName:"xl",lastEdited:5,lowestEdited:5,rupBuild:9303}})},n.exports=C},{"../../../utils/col-cache":19,"../../../utils/under-dash":25,"../../../utils/xml-stream":27,"../base-xform":31,"../list-xform":70,"../static-xform":119,"./defined-name-xform":32,"./sheet-xform":33,"./workbook-calc-properties-xform":34,"./workbook-properties-xform":35,"./workbook-view-xform":36}],38:[function(e,n,i){function o(g,y){var h=Object.keys(g);if(Object.getOwnPropertySymbols){var u=Object.getOwnPropertySymbols(g);y&&(u=u.filter(function(f){return Object.getOwnPropertyDescriptor(g,f).enumerable})),h.push.apply(h,u)}return h}function a(g,y,h){return y in g?Object.defineProperty(g,y,{value:h,enumerable:!0,configurable:!0,writable:!0}):g[y]=h,g}var s=e("../strings/rich-text-xform"),l=e("../../../utils/utils"),p=e("../base-xform"),d=n.exports=function(g){this.model=g};l.inherits(d,p,{get tag(){return"r"},get richTextXform(){return this._richTextXform||(this._richTextXform=new s),this._richTextXform},render:function(g,y){var h=this;y=y||this.model,g.openNode("comment",{ref:y.ref,authorId:0}),g.openNode("text"),y&&y.note&&y.note.texts&&y.note.texts.forEach(function(u){h.richTextXform.render(g,u)}),g.closeNode(),g.closeNode()},parseOpen:function(g){if(this.parser)return this.parser.parseOpen(g),!0;switch(g.name){case"comment":return this.model=function(y){for(var h=1;h<arguments.length;h++){var u=arguments[h]!=null?arguments[h]:{};h%2?o(Object(u),!0).forEach(function(f){a(y,f,u[f])}):Object.getOwnPropertyDescriptors?Object.defineProperties(y,Object.getOwnPropertyDescriptors(u)):o(Object(u)).forEach(function(f){Object.defineProperty(y,f,Object.getOwnPropertyDescriptor(u,f))})}return y}({type:"note",note:{texts:[]}},g.attributes),!0;case"r":return this.parser=this.richTextXform,this.parser.parseOpen(g),!0;default:return!1}},parseText:function(g){this.parser&&this.parser.parseText(g)},parseClose:function(g){switch(g){case"comment":return!1;case"r":return this.model.note.texts.push(this.parser.model),this.parser=void 0,!0;default:return this.parser&&this.parser.parseClose(g),!0}}})},{"../../../utils/utils":26,"../base-xform":31,"../strings/rich-text-xform":121}],39:[function(e,n,i){var o=e("../../../utils/xml-stream"),a=e("../../../utils/utils"),s=e("../base-xform"),l=e("./comment-xform"),p=n.exports=function(){this.map={comment:new l}};a.inherits(p,s,{COMMENTS_ATTRIBUTES:{xmlns:"http://schemas.openxmlformats.org/spreadsheetml/2006/main"}},{render:function(d,g){var y=this;g=g||this.model,d.openXml(o.StdDocAttributes),d.openNode("comments",p.COMMENTS_ATTRIBUTES),d.openNode("authors"),d.leafNode("author",null,"Author"),d.closeNode(),d.openNode("commentList"),g.comments.forEach(function(h){y.map.comment.render(d,h)}),d.closeNode(),d.closeNode()},parseOpen:function(d){if(this.parser)return this.parser.parseOpen(d),!0;switch(d.name){case"commentList":return this.model={comments:[]},!0;case"comment":return this.parser=this.map.comment,this.parser.parseOpen(d),!0;default:return!1}},parseText:function(d){this.parser&&this.parser.parseText(d)},parseClose:function(d){switch(d){case"commentList":return!1;case"comment":return this.model.comments.push(this.parser.model),this.parser=void 0,!0;default:return this.parser&&this.parser.parseClose(d),!0}}})},{"../../../utils/utils":26,"../../../utils/xml-stream":27,"../base-xform":31,"./comment-xform":38}],40:[function(e,n,i){function o(y){return(o=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(h){return typeof h}:function(h){return h&&typeof Symbol=="function"&&h.constructor===Symbol&&h!==Symbol.prototype?"symbol":typeof h})(y)}function a(y,h){for(var u=0;u<h.length;u++){var f=h[u];f.enumerable=f.enumerable||!1,f.configurable=!0,"value"in f&&(f.writable=!0),Object.defineProperty(y,f.key,f)}}function s(y,h){return(s=Object.setPrototypeOf||function(u,f){return u.__proto__=f,u})(y,h)}function l(y){var h=function(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch{return!1}}();return function(){var u,f=d(y);if(h){var c=d(this).constructor;u=Reflect.construct(f,arguments,c)}else u=f.apply(this,arguments);return p(this,u)}}function p(y,h){return!h||o(h)!=="object"&&typeof h!="function"?function(u){if(u===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return u}(y):h}function d(y){return(d=Object.setPrototypeOf?Object.getPrototypeOf:function(h){return h.__proto__||Object.getPrototypeOf(h)})(y)}var g=function(y){(function(v,m){if(typeof m!="function"&&m!==null)throw new TypeError("Super expression must either be null or a function");v.prototype=Object.create(m&&m.prototype,{constructor:{value:v,writable:!0,configurable:!0}}),m&&s(v,m)})(c,y);var h,u,f=l(c);function c(v){var m;return function(b,w){if(!(b instanceof w))throw new TypeError("Cannot call a class as a function")}(this,c),(m=f.call(this))._model=v,m}return h=c,(u=[{key:"render",value:function(v,m,b){(m===b[2]||this.tag==="x:SizeWithCells"&&m===b[1])&&v.leafNode(this.tag)}},{key:"parseOpen",value:function(v){switch(v.name){case this.tag:return this.model={},this.model[this.tag]=!0,!0;default:return!1}}},{key:"parseText",value:function(){}},{key:"parseClose",value:function(){return!1}},{key:"tag",get:function(){return this._model&&this._model.tag}}])&&a(h.prototype,u),c}(e("../../base-xform"));n.exports=g},{"../../base-xform":31}],41:[function(e,n,i){function o(y){return(o=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(h){return typeof h}:function(h){return h&&typeof Symbol=="function"&&h.constructor===Symbol&&h!==Symbol.prototype?"symbol":typeof h})(y)}function a(y,h){for(var u=0;u<h.length;u++){var f=h[u];f.enumerable=f.enumerable||!1,f.configurable=!0,"value"in f&&(f.writable=!0),Object.defineProperty(y,f.key,f)}}function s(y,h){return(s=Object.setPrototypeOf||function(u,f){return u.__proto__=f,u})(y,h)}function l(y){var h=function(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch{return!1}}();return function(){var u,f=d(y);if(h){var c=d(this).constructor;u=Reflect.construct(f,arguments,c)}else u=f.apply(this,arguments);return p(this,u)}}function p(y,h){return!h||o(h)!=="object"&&typeof h!="function"?function(u){if(u===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return u}(y):h}function d(y){return(d=Object.setPrototypeOf?Object.getPrototypeOf:function(h){return h.__proto__||Object.getPrototypeOf(h)})(y)}var g=function(y){(function(v,m){if(typeof m!="function"&&m!==null)throw new TypeError("Super expression must either be null or a function");v.prototype=Object.create(m&&m.prototype,{constructor:{value:v,writable:!0,configurable:!0}}),m&&s(v,m)})(c,y);var h,u,f=l(c);function c(v){var m;return function(b,w){if(!(b instanceof w))throw new TypeError("Cannot call a class as a function")}(this,c),(m=f.call(this))._model=v,m}return h=c,(u=[{key:"render",value:function(v,m){v.leafNode(this.tag,null,m)}},{key:"parseOpen",value:function(v){switch(v.name){case this.tag:return this.text="",!0;default:return!1}}},{key:"parseText",value:function(v){this.text=v}},{key:"parseClose",value:function(){return!1}},{key:"tag",get:function(){return this._model&&this._model.tag}}])&&a(h.prototype,u),c}(e("../../base-xform"));n.exports=g},{"../../base-xform":31}],42:[function(e,n,i){function o(h){return(o=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(u){return typeof u}:function(u){return u&&typeof Symbol=="function"&&u.constructor===Symbol&&u!==Symbol.prototype?"symbol":typeof u})(h)}function a(h,u){if(!(h instanceof u))throw new TypeError("Cannot call a class as a function")}function s(h,u){for(var f=0;f<u.length;f++){var c=u[f];c.enumerable=c.enumerable||!1,c.configurable=!0,"value"in c&&(c.writable=!0),Object.defineProperty(h,c.key,c)}}function l(h,u){return(l=Object.setPrototypeOf||function(f,c){return f.__proto__=c,f})(h,u)}function p(h){var u=function(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch{return!1}}();return function(){var f,c=g(h);if(u){var v=g(this).constructor;f=Reflect.construct(c,arguments,v)}else f=c.apply(this,arguments);return d(this,f)}}function d(h,u){return!u||o(u)!=="object"&&typeof u!="function"?function(f){if(f===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return f}(h):u}function g(h){return(g=Object.setPrototypeOf?Object.getPrototypeOf:function(u){return u.__proto__||Object.getPrototypeOf(u)})(h)}var y=function(h){(function(m,b){if(typeof b!="function"&&b!==null)throw new TypeError("Super expression must either be null or a function");m.prototype=Object.create(b&&b.prototype,{constructor:{value:m,writable:!0,configurable:!0}}),b&&l(m,b)})(v,h);var u,f,c=p(v);function v(){return a(this,v),c.apply(this,arguments)}return u=v,(f=[{key:"getAnchorRect",value:function(m){var b=Math.floor(m.left),w=Math.floor(68*(m.left-b)),_=Math.floor(m.top),C=Math.floor(18*(m.top-_)),R=Math.floor(m.right),I=Math.floor(68*(m.right-R)),P=Math.floor(m.bottom);return[b,w,_,C,R,I,P,Math.floor(18*(m.bottom-P))]}},{key:"getDefaultRect",value:function(m){var b=m.col,w=Math.max(m.row-2,0);return[b,6,w,14,b+2,2,w+4,16]}},{key:"render",value:function(m,b){var w=b.anchor?this.getAnchorRect(b.anchor):this.getDefaultRect(b.refAddress);m.leafNode("x:Anchor",null,w.join(", "))}},{key:"parseOpen",value:function(m){switch(m.name){case this.tag:return this.text="",!0;default:return!1}}},{key:"parseText",value:function(m){this.text=m}},{key:"parseClose",value:function(){return!1}},{key:"tag",get:function(){return"x:Anchor"}}])&&s(u.prototype,f),v}(e("../base-xform"));n.exports=y},{"../base-xform":31}],43:[function(e,n,i){function o(v){return(o=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(m){return typeof m}:function(m){return m&&typeof Symbol=="function"&&m.constructor===Symbol&&m!==Symbol.prototype?"symbol":typeof m})(v)}function a(v,m){for(var b=0;b<m.length;b++){var w=m[b];w.enumerable=w.enumerable||!1,w.configurable=!0,"value"in w&&(w.writable=!0),Object.defineProperty(v,w.key,w)}}function s(v,m){return(s=Object.setPrototypeOf||function(b,w){return b.__proto__=w,b})(v,m)}function l(v){var m=function(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch{return!1}}();return function(){var b,w=d(v);if(m){var _=d(this).constructor;b=Reflect.construct(w,arguments,_)}else b=w.apply(this,arguments);return p(this,b)}}function p(v,m){return!m||o(m)!=="object"&&typeof m!="function"?function(b){if(b===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return b}(v):m}function d(v){return(d=Object.setPrototypeOf?Object.getPrototypeOf:function(m){return m.__proto__||Object.getPrototypeOf(m)})(v)}var g=e("../base-xform"),y=e("./vml-anchor-xform"),h=e("./style/vml-protection-xform"),u=e("./style/vml-position-xform"),f=["twoCells","oneCells","absolute"],c=function(v){(function(C,R){if(typeof R!="function"&&R!==null)throw new TypeError("Super expression must either be null or a function");C.prototype=Object.create(R&&R.prototype,{constructor:{value:C,writable:!0,configurable:!0}}),R&&s(C,R)})(_,v);var m,b,w=l(_);function _(){var C;return function(R,I){if(!(R instanceof I))throw new TypeError("Cannot call a class as a function")}(this,_),(C=w.call(this)).map={"x:Anchor":new y,"x:Locked":new h({tag:"x:Locked"}),"x:LockText":new h({tag:"x:LockText"}),"x:SizeWithCells":new u({tag:"x:SizeWithCells"}),"x:MoveWithCells":new u({tag:"x:MoveWithCells"})},C}return m=_,(b=[{key:"render",value:function(C,R){var I=R.note,P=I.protection,N=I.editAs;C.openNode(this.tag,{ObjectType:"Note"}),this.map["x:MoveWithCells"].render(C,N,f),this.map["x:SizeWithCells"].render(C,N,f),this.map["x:Anchor"].render(C,R),this.map["x:Locked"].render(C,P.locked),C.leafNode("x:AutoFill",null,"False"),this.map["x:LockText"].render(C,P.lockText),C.leafNode("x:Row",null,R.refAddress.row-1),C.leafNode("x:Column",null,R.refAddress.col-1),C.closeNode()}},{key:"parseOpen",value:function(C){switch(C.name){case this.tag:this.reset(),this.model={anchor:[],protection:{},editAs:""};break;default:this.parser=this.map[C.name],this.parser&&this.parser.parseOpen(C)}return!0}},{key:"parseText",value:function(C){this.parser&&this.parser.parseText(C)}},{key:"parseClose",value:function(C){if(this.parser)return this.parser.parseClose(C)||(this.parser=void 0),!0;switch(C){case this.tag:return this.normalizeModel(),!1;default:return!0}}},{key:"normalizeModel",value:function(){var C=Object.assign({},this.map["x:MoveWithCells"].model,this.map["x:SizeWithCells"].model),R=Object.keys(C).length;this.model.editAs=f[R],this.model.anchor=this.map["x:Anchor"].text,this.model.protection.locked=this.map["x:Locked"].text,this.model.protection.lockText=this.map["x:LockText"].text}},{key:"tag",get:function(){return"x:ClientData"}}])&&a(m.prototype,b),_}(g);n.exports=c},{"../base-xform":31,"./style/vml-position-xform":40,"./style/vml-protection-xform":41,"./vml-anchor-xform":42}],44:[function(e,n,i){function o(f){return(o=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(c){return typeof c}:function(c){return c&&typeof Symbol=="function"&&c.constructor===Symbol&&c!==Symbol.prototype?"symbol":typeof c})(f)}function a(f,c){for(var v=0;v<c.length;v++){var m=c[v];m.enumerable=m.enumerable||!1,m.configurable=!0,"value"in m&&(m.writable=!0),Object.defineProperty(f,m.key,m)}}function s(f,c){return(s=Object.setPrototypeOf||function(v,m){return v.__proto__=m,v})(f,c)}function l(f){var c=function(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch{return!1}}();return function(){var v,m=d(f);if(c){var b=d(this).constructor;v=Reflect.construct(m,arguments,b)}else v=m.apply(this,arguments);return p(this,v)}}function p(f,c){return!c||o(c)!=="object"&&typeof c!="function"?function(v){if(v===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return v}(f):c}function d(f){return(d=Object.setPrototypeOf?Object.getPrototypeOf:function(c){return c.__proto__||Object.getPrototypeOf(c)})(f)}var g=e("../../../utils/xml-stream"),y=e("../base-xform"),h=e("./vml-shape-xform"),u=function(f){(function(w,_){if(typeof _!="function"&&_!==null)throw new TypeError("Super expression must either be null or a function");w.prototype=Object.create(_&&_.prototype,{constructor:{value:w,writable:!0,configurable:!0}}),_&&s(w,_)})(b,f);var c,v,m=l(b);function b(){var w;return function(_,C){if(!(_ instanceof C))throw new TypeError("Cannot call a class as a function")}(this,b),(w=m.call(this)).map={"v:shape":new h},w}return c=b,(v=[{key:"render",value:function(w,_){var C=this;w.openXml(g.StdDocAttributes),w.openNode(this.tag,b.DRAWING_ATTRIBUTES),w.openNode("o:shapelayout",{"v:ext":"edit"}),w.leafNode("o:idmap",{"v:ext":"edit",data:1}),w.closeNode(),w.openNode("v:shapetype",{id:"_x0000_t202",coordsize:"21600,21600","o:spt":202,path:"m,l,21600r21600,l21600,xe"}),w.leafNode("v:stroke",{joinstyle:"miter"}),w.leafNode("v:path",{gradientshapeok:"t","o:connecttype":"rect"}),w.closeNode(),_.comments.forEach(function(R,I){C.map["v:shape"].render(w,R,I)}),w.closeNode()}},{key:"parseOpen",value:function(w){if(this.parser)return this.parser.parseOpen(w),!0;switch(w.name){case this.tag:this.reset(),this.model={comments:[]};break;default:this.parser=this.map[w.name],this.parser&&this.parser.parseOpen(w)}return!0}},{key:"parseText",value:function(w){this.parser&&this.parser.parseText(w)}},{key:"parseClose",value:function(w){if(this.parser)return this.parser.parseClose(w)||(this.model.comments.push(this.parser.model),this.parser=void 0),!0;switch(w){case this.tag:return!1;default:return!0}}},{key:"reconcile",value:function(w,_){var C=this;w.anchors.forEach(function(R){R.br?C.map["xdr:twoCellAnchor"].reconcile(R,_):C.map["xdr:oneCellAnchor"].reconcile(R,_)})}},{key:"tag",get:function(){return"xml"}}])&&a(c.prototype,v),b}(y);u.DRAWING_ATTRIBUTES={"xmlns:v":"urn:schemas-microsoft-com:vml","xmlns:o":"urn:schemas-microsoft-com:office:office","xmlns:x":"urn:schemas-microsoft-com:office:excel"},n.exports=u},{"../../../utils/xml-stream":27,"../base-xform":31,"./vml-shape-xform":45}],45:[function(e,n,i){function o(f){return(o=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(c){return typeof c}:function(c){return c&&typeof Symbol=="function"&&c.constructor===Symbol&&c!==Symbol.prototype?"symbol":typeof c})(f)}function a(f,c){for(var v=0;v<c.length;v++){var m=c[v];m.enumerable=m.enumerable||!1,m.configurable=!0,"value"in m&&(m.writable=!0),Object.defineProperty(f,m.key,m)}}function s(f,c){return(s=Object.setPrototypeOf||function(v,m){return v.__proto__=m,v})(f,c)}function l(f){var c=function(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch{return!1}}();return function(){var v,m=d(f);if(c){var b=d(this).constructor;v=Reflect.construct(m,arguments,b)}else v=m.apply(this,arguments);return p(this,v)}}function p(f,c){return!c||o(c)!=="object"&&typeof c!="function"?function(v){if(v===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return v}(f):c}function d(f){return(d=Object.setPrototypeOf?Object.getPrototypeOf:function(c){return c.__proto__||Object.getPrototypeOf(c)})(f)}var g=e("../base-xform"),y=e("./vml-textbox-xform"),h=e("./vml-client-data-xform"),u=function(f){(function(w,_){if(typeof _!="function"&&_!==null)throw new TypeError("Super expression must either be null or a function");w.prototype=Object.create(_&&_.prototype,{constructor:{value:w,writable:!0,configurable:!0}}),_&&s(w,_)})(b,f);var c,v,m=l(b);function b(){var w;return function(_,C){if(!(_ instanceof C))throw new TypeError("Cannot call a class as a function")}(this,b),(w=m.call(this)).map={"v:textbox":new y,"x:ClientData":new h},w}return c=b,(v=[{key:"render",value:function(w,_,C){w.openNode("v:shape",b.V_SHAPE_ATTRIBUTES(_,C)),w.leafNode("v:fill",{color2:"infoBackground [80]"}),w.leafNode("v:shadow",{color:"none [81]",obscured:"t"}),w.leafNode("v:path",{"o:connecttype":"none"}),this.map["v:textbox"].render(w,_),this.map["x:ClientData"].render(w,_),w.closeNode()}},{key:"parseOpen",value:function(w){if(this.parser)return this.parser.parseOpen(w),!0;switch(w.name){case this.tag:this.reset(),this.model={margins:{insetmode:w.attributes["o:insetmode"]},anchor:"",editAs:"",protection:{}};break;default:this.parser=this.map[w.name],this.parser&&this.parser.parseOpen(w)}return!0}},{key:"parseText",value:function(w){this.parser&&this.parser.parseText(w)}},{key:"parseClose",value:function(w){if(this.parser)return this.parser.parseClose(w)||(this.parser=void 0),!0;switch(w){case this.tag:return this.model.margins.inset=this.map["v:textbox"].model&&this.map["v:textbox"].model.inset,this.model.protection=this.map["x:ClientData"].model&&this.map["x:ClientData"].model.protection,this.model.anchor=this.map["x:ClientData"].model&&this.map["x:ClientData"].model.anchor,this.model.editAs=this.map["x:ClientData"].model&&this.map["x:ClientData"].model.editAs,!1;default:return!0}}},{key:"tag",get:function(){return"v:shape"}}])&&a(c.prototype,v),b}(g);u.V_SHAPE_ATTRIBUTES=function(f,c){return{id:"_x0000_s".concat(1025+c),type:"#_x0000_t202",style:"position:absolute; margin-left:105.3pt;margin-top:10.5pt;width:97.8pt;height:59.1pt;z-index:1;visibility:hidden",fillcolor:"infoBackground [80]",strokecolor:"none [81]","o:insetmode":f.note.margins&&f.note.margins.insetmode}},n.exports=u},{"../base-xform":31,"./vml-client-data-xform":43,"./vml-textbox-xform":46}],46:[function(e,n,i){function o(h){return(o=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(u){return typeof u}:function(u){return u&&typeof Symbol=="function"&&u.constructor===Symbol&&u!==Symbol.prototype?"symbol":typeof u})(h)}function a(h,u){if(!(h instanceof u))throw new TypeError("Cannot call a class as a function")}function s(h,u){for(var f=0;f<u.length;f++){var c=u[f];c.enumerable=c.enumerable||!1,c.configurable=!0,"value"in c&&(c.writable=!0),Object.defineProperty(h,c.key,c)}}function l(h,u){return(l=Object.setPrototypeOf||function(f,c){return f.__proto__=c,f})(h,u)}function p(h){var u=function(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch{return!1}}();return function(){var f,c=g(h);if(u){var v=g(this).constructor;f=Reflect.construct(c,arguments,v)}else f=c.apply(this,arguments);return d(this,f)}}function d(h,u){return!u||o(u)!=="object"&&typeof u!="function"?function(f){if(f===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return f}(h):u}function g(h){return(g=Object.setPrototypeOf?Object.getPrototypeOf:function(u){return u.__proto__||Object.getPrototypeOf(u)})(h)}var y=function(h){(function(m,b){if(typeof b!="function"&&b!==null)throw new TypeError("Super expression must either be null or a function");m.prototype=Object.create(b&&b.prototype,{constructor:{value:m,writable:!0,configurable:!0}}),b&&l(m,b)})(v,h);var u,f,c=p(v);function v(){return a(this,v),c.apply(this,arguments)}return u=v,(f=[{key:"conversionUnit",value:function(m,b,w){return"".concat(parseFloat(m)*b.toFixed(2)).concat(w)}},{key:"reverseConversionUnit",value:function(m){var b=this;return(m||"").split(",").map(function(w){return Number(parseFloat(b.conversionUnit(parseFloat(w),.1,"")).toFixed(2))})}},{key:"render",value:function(m,b){var w=this,_={style:"mso-direction-alt:auto"};if(b&&b.note){var C=(b.note&&b.note.margins).inset;Array.isArray(C)&&(C=C.map(function(R){return w.conversionUnit(R,10,"mm")}).join(",")),C&&(_.inset=C)}m.openNode("v:textbox",_),m.leafNode("div",{style:"text-align:left"}),m.closeNode()}},{key:"parseOpen",value:function(m){switch(m.name){case this.tag:return this.model={inset:this.reverseConversionUnit(m.attributes.inset)},!0;default:return!0}}},{key:"parseText",value:function(){}},{key:"parseClose",value:function(m){switch(m){case this.tag:return!1;default:return!0}}},{key:"tag",get:function(){return"v:textbox"}}])&&s(u.prototype,f),v}(e("../base-xform"));n.exports=y},{"../base-xform":31}],47:[function(e,n,i){function o(h){return(o=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(u){return typeof u}:function(u){return u&&typeof Symbol=="function"&&u.constructor===Symbol&&u!==Symbol.prototype?"symbol":typeof u})(h)}function a(h,u){if(!(h instanceof u))throw new TypeError("Cannot call a class as a function")}function s(h,u){for(var f=0;f<u.length;f++){var c=u[f];c.enumerable=c.enumerable||!1,c.configurable=!0,"value"in c&&(c.writable=!0),Object.defineProperty(h,c.key,c)}}function l(h,u){return(l=Object.setPrototypeOf||function(f,c){return f.__proto__=c,f})(h,u)}function p(h){var u=function(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch{return!1}}();return function(){var f,c=g(h);if(u){var v=g(this).constructor;f=Reflect.construct(c,arguments,v)}else f=c.apply(this,arguments);return d(this,f)}}function d(h,u){return!u||o(u)!=="object"&&typeof u!="function"?function(f){if(f===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return f}(h):u}function g(h){return(g=Object.setPrototypeOf?Object.getPrototypeOf:function(u){return u.__proto__||Object.getPrototypeOf(u)})(h)}var y=function(h){(function(m,b){if(typeof b!="function"&&b!==null)throw new TypeError("Super expression must either be null or a function");m.prototype=Object.create(b&&b.prototype,{constructor:{value:m,writable:!0,configurable:!0}}),b&&l(m,b)})(v,h);var u,f,c=p(v);function v(){return a(this,v),c.apply(this,arguments)}return u=v,(f=[{key:"createNewModel",value:function(m){return{}}},{key:"parseOpen",value:function(m){return this.parser=this.parser||this.map[m.name],this.parser?(this.parser.parseOpen(m),!0):m.name===this.tag&&(this.model=this.createNewModel(m),!0)}},{key:"parseText",value:function(m){this.parser&&this.parser.parseText(m)}},{key:"onParserClose",value:function(m,b){this.model[m]=b.model}},{key:"parseClose",value:function(m){return this.parser?(this.parser.parseClose(m)||(this.onParserClose(m,this.parser),this.parser=void 0),!0):m!==this.tag}}])&&s(u.prototype,f),v}(e("./base-xform"));n.exports=y},{"./base-xform":31}],48:[function(e,n,i){function o(h){return(o=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(u){return typeof u}:function(u){return u&&typeof Symbol=="function"&&u.constructor===Symbol&&u!==Symbol.prototype?"symbol":typeof u})(h)}function a(h,u){if(!(h instanceof u))throw new TypeError("Cannot call a class as a function")}function s(h,u){for(var f=0;f<u.length;f++){var c=u[f];c.enumerable=c.enumerable||!1,c.configurable=!0,"value"in c&&(c.writable=!0),Object.defineProperty(h,c.key,c)}}function l(h,u){return(l=Object.setPrototypeOf||function(f,c){return f.__proto__=c,f})(h,u)}function p(h){var u=function(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch{return!1}}();return function(){var f,c=g(h);if(u){var v=g(this).constructor;f=Reflect.construct(c,arguments,v)}else f=c.apply(this,arguments);return d(this,f)}}function d(h,u){return!u||o(u)!=="object"&&typeof u!="function"?function(f){if(f===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return f}(h):u}function g(h){return(g=Object.setPrototypeOf?Object.getPrototypeOf:function(u){return u.__proto__||Object.getPrototypeOf(u)})(h)}var y=function(h){(function(m,b){if(typeof b!="function"&&b!==null)throw new TypeError("Super expression must either be null or a function");m.prototype=Object.create(b&&b.prototype,{constructor:{value:m,writable:!0,configurable:!0}}),b&&l(m,b)})(v,h);var u,f,c=p(v);function v(){return a(this,v),c.apply(this,arguments)}return u=v,(f=[{key:"render",value:function(m,b){m.openNode("HeadingPairs"),m.openNode("vt:vector",{size:2,baseType:"variant"}),m.openNode("vt:variant"),m.leafNode("vt:lpstr",void 0,"Worksheets"),m.closeNode(),m.openNode("vt:variant"),m.leafNode("vt:i4",void 0,b.length),m.closeNode(),m.closeNode(),m.closeNode()}},{key:"parseOpen",value:function(m){return m.name==="HeadingPairs"}},{key:"parseText",value:function(){}},{key:"parseClose",value:function(m){return m!=="HeadingPairs"}}])&&s(u.prototype,f),v}(e("../base-xform"));n.exports=y},{"../base-xform":31}],49:[function(e,n,i){function o(h){return(o=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(u){return typeof u}:function(u){return u&&typeof Symbol=="function"&&u.constructor===Symbol&&u!==Symbol.prototype?"symbol":typeof u})(h)}function a(h,u){if(!(h instanceof u))throw new TypeError("Cannot call a class as a function")}function s(h,u){for(var f=0;f<u.length;f++){var c=u[f];c.enumerable=c.enumerable||!1,c.configurable=!0,"value"in c&&(c.writable=!0),Object.defineProperty(h,c.key,c)}}function l(h,u){return(l=Object.setPrototypeOf||function(f,c){return f.__proto__=c,f})(h,u)}function p(h){var u=function(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch{return!1}}();return function(){var f,c=g(h);if(u){var v=g(this).constructor;f=Reflect.construct(c,arguments,v)}else f=c.apply(this,arguments);return d(this,f)}}function d(h,u){return!u||o(u)!=="object"&&typeof u!="function"?function(f){if(f===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return f}(h):u}function g(h){return(g=Object.setPrototypeOf?Object.getPrototypeOf:function(u){return u.__proto__||Object.getPrototypeOf(u)})(h)}var y=function(h){(function(m,b){if(typeof b!="function"&&b!==null)throw new TypeError("Super expression must either be null or a function");m.prototype=Object.create(b&&b.prototype,{constructor:{value:m,writable:!0,configurable:!0}}),b&&l(m,b)})(v,h);var u,f,c=p(v);function v(){return a(this,v),c.apply(this,arguments)}return u=v,(f=[{key:"render",value:function(m,b){m.openNode("TitlesOfParts"),m.openNode("vt:vector",{size:b.length,baseType:"lpstr"}),b.forEach(function(w){m.leafNode("vt:lpstr",void 0,w.name)}),m.closeNode(),m.closeNode()}},{key:"parseOpen",value:function(m){return m.name==="TitlesOfParts"}},{key:"parseText",value:function(){}},{key:"parseClose",value:function(m){return m!=="TitlesOfParts"}}])&&s(u.prototype,f),v}(e("../base-xform"));n.exports=y},{"../base-xform":31}],50:[function(e,n,i){function o(v){return(o=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(m){return typeof m}:function(m){return m&&typeof Symbol=="function"&&m.constructor===Symbol&&m!==Symbol.prototype?"symbol":typeof m})(v)}function a(v,m){for(var b=0;b<m.length;b++){var w=m[b];w.enumerable=w.enumerable||!1,w.configurable=!0,"value"in w&&(w.writable=!0),Object.defineProperty(v,w.key,w)}}function s(v,m){return(s=Object.setPrototypeOf||function(b,w){return b.__proto__=w,b})(v,m)}function l(v){var m=function(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch{return!1}}();return function(){var b,w=d(v);if(m){var _=d(this).constructor;b=Reflect.construct(w,arguments,_)}else b=w.apply(this,arguments);return p(this,b)}}function p(v,m){return!m||o(m)!=="object"&&typeof m!="function"?function(b){if(b===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return b}(v):m}function d(v){return(d=Object.setPrototypeOf?Object.getPrototypeOf:function(m){return m.__proto__||Object.getPrototypeOf(m)})(v)}var g=e("../../../utils/xml-stream"),y=e("../base-xform"),h=e("../simple/string-xform"),u=e("./app-heading-pairs-xform"),f=e("./app-titles-of-parts-xform"),c=function(v){(function(C,R){if(typeof R!="function"&&R!==null)throw new TypeError("Super expression must either be null or a function");C.prototype=Object.create(R&&R.prototype,{constructor:{value:C,writable:!0,configurable:!0}}),R&&s(C,R)})(_,v);var m,b,w=l(_);function _(){var C;return function(R,I){if(!(R instanceof I))throw new TypeError("Cannot call a class as a function")}(this,_),(C=w.call(this)).map={Company:new h({tag:"Company"}),Manager:new h({tag:"Manager"}),HeadingPairs:new u,TitleOfParts:new f},C}return m=_,(b=[{key:"render",value:function(C,R){C.openXml(g.StdDocAttributes),C.openNode("Properties",_.PROPERTY_ATTRIBUTES),C.leafNode("Application",void 0,"Microsoft Excel"),C.leafNode("DocSecurity",void 0,"0"),C.leafNode("ScaleCrop",void 0,"false"),this.map.HeadingPairs.render(C,R.worksheets),this.map.TitleOfParts.render(C,R.worksheets),this.map.Company.render(C,R.company||""),this.map.Manager.render(C,R.manager),C.leafNode("LinksUpToDate",void 0,"false"),C.leafNode("SharedDoc",void 0,"false"),C.leafNode("HyperlinksChanged",void 0,"false"),C.leafNode("AppVersion",void 0,"16.0300"),C.closeNode()}},{key:"parseOpen",value:function(C){if(this.parser)return this.parser.parseOpen(C),!0;switch(C.name){case"Properties":return!0;default:return this.parser=this.map[C.name],!!this.parser&&(this.parser.parseOpen(C),!0)}}},{key:"parseText",value:function(C){this.parser&&this.parser.parseText(C)}},{key:"parseClose",value:function(C){if(this.parser)return this.parser.parseClose(C)||(this.parser=void 0),!0;switch(C){case"Properties":return this.model={worksheets:this.map.TitleOfParts.model,company:this.map.Company.model,manager:this.map.Manager.model},!1;default:return!0}}}])&&a(m.prototype,b),_}(y);c.DateFormat=function(v){return v.toISOString().replace(/[.]\d{3,6}/,"")},c.DateAttrs={"xsi:type":"dcterms:W3CDTF"},c.PROPERTY_ATTRIBUTES={xmlns:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties","xmlns:vt":"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes"},n.exports=c},{"../../../utils/xml-stream":27,"../base-xform":31,"../simple/string-xform":118,"./app-heading-pairs-xform":48,"./app-titles-of-parts-xform":49}],51:[function(e,n,i){function o(u){return(o=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(f){return typeof f}:function(f){return f&&typeof Symbol=="function"&&f.constructor===Symbol&&f!==Symbol.prototype?"symbol":typeof f})(u)}function a(u,f){if(!(u instanceof f))throw new TypeError("Cannot call a class as a function")}function s(u,f){for(var c=0;c<f.length;c++){var v=f[c];v.enumerable=v.enumerable||!1,v.configurable=!0,"value"in v&&(v.writable=!0),Object.defineProperty(u,v.key,v)}}function l(u,f){return(l=Object.setPrototypeOf||function(c,v){return c.__proto__=v,c})(u,f)}function p(u){var f=function(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch{return!1}}();return function(){var c,v=g(u);if(f){var m=g(this).constructor;c=Reflect.construct(v,arguments,m)}else c=v.apply(this,arguments);return d(this,c)}}function d(u,f){return!f||o(f)!=="object"&&typeof f!="function"?function(c){if(c===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return c}(u):f}function g(u){return(g=Object.setPrototypeOf?Object.getPrototypeOf:function(f){return f.__proto__||Object.getPrototypeOf(f)})(u)}var y=e("../../../utils/xml-stream"),h=function(u){(function(b,w){if(typeof w!="function"&&w!==null)throw new TypeError("Super expression must either be null or a function");b.prototype=Object.create(w&&w.prototype,{constructor:{value:b,writable:!0,configurable:!0}}),w&&l(b,w)})(m,u);var f,c,v=p(m);function m(){return a(this,m),v.apply(this,arguments)}return f=m,(c=[{key:"render",value:function(b,w){b.openXml(y.StdDocAttributes),b.openNode("Types",m.PROPERTY_ATTRIBUTES);var _={};(w.media||[]).forEach(function(C){if(C.type==="image"){var R=C.extension;_[R]||(_[R]=!0,b.leafNode("Default",{Extension:R,ContentType:"image/".concat(R)}))}}),b.leafNode("Default",{Extension:"rels",ContentType:"application/vnd.openxmlformats-package.relationships+xml"}),b.leafNode("Default",{Extension:"xml",ContentType:"application/xml"}),b.leafNode("Override",{PartName:"/xl/workbook.xml",ContentType:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml"}),w.worksheets.forEach(function(C){var R="/xl/worksheets/sheet".concat(C.id,".xml");b.leafNode("Override",{PartName:R,ContentType:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml"})}),b.leafNode("Override",{PartName:"/xl/theme/theme1.xml",ContentType:"application/vnd.openxmlformats-officedocument.theme+xml"}),b.leafNode("Override",{PartName:"/xl/styles.xml",ContentType:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml"}),w.sharedStrings&&w.sharedStrings.count&&b.leafNode("Override",{PartName:"/xl/sharedStrings.xml",ContentType:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml"}),w.tables&&w.tables.forEach(function(C){b.leafNode("Override",{PartName:"/xl/tables/".concat(C.target),ContentType:"application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml"})}),w.drawings&&w.drawings.forEach(function(C){b.leafNode("Override",{PartName:"/xl/drawings/".concat(C.name,".xml"),ContentType:"application/vnd.openxmlformats-officedocument.drawing+xml"})}),w.commentRefs&&(b.leafNode("Default",{Extension:"vml",ContentType:"application/vnd.openxmlformats-officedocument.vmlDrawing"}),w.commentRefs.forEach(function(C){var R=C.commentName;b.leafNode("Override",{PartName:"/xl/".concat(R,".xml"),ContentType:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml"})})),b.leafNode("Override",{PartName:"/docProps/core.xml",ContentType:"application/vnd.openxmlformats-package.core-properties+xml"}),b.leafNode("Override",{PartName:"/docProps/app.xml",ContentType:"application/vnd.openxmlformats-officedocument.extended-properties+xml"}),b.closeNode()}},{key:"parseOpen",value:function(){return!1}},{key:"parseText",value:function(){}},{key:"parseClose",value:function(){return!1}}])&&s(f.prototype,c),m}(e("../base-xform"));h.PROPERTY_ATTRIBUTES={xmlns:"http://schemas.openxmlformats.org/package/2006/content-types"},n.exports=h},{"../../../utils/xml-stream":27,"../base-xform":31}],52:[function(e,n,i){function o(v){return(o=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(m){return typeof m}:function(m){return m&&typeof Symbol=="function"&&m.constructor===Symbol&&m!==Symbol.prototype?"symbol":typeof m})(v)}function a(v,m){for(var b=0;b<m.length;b++){var w=m[b];w.enumerable=w.enumerable||!1,w.configurable=!0,"value"in w&&(w.writable=!0),Object.defineProperty(v,w.key,w)}}function s(v,m){return(s=Object.setPrototypeOf||function(b,w){return b.__proto__=w,b})(v,m)}function l(v){var m=function(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch{return!1}}();return function(){var b,w=d(v);if(m){var _=d(this).constructor;b=Reflect.construct(w,arguments,_)}else b=w.apply(this,arguments);return p(this,b)}}function p(v,m){return!m||o(m)!=="object"&&typeof m!="function"?function(b){if(b===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return b}(v):m}function d(v){return(d=Object.setPrototypeOf?Object.getPrototypeOf:function(m){return m.__proto__||Object.getPrototypeOf(m)})(v)}var g=e("../../../utils/xml-stream"),y=e("../base-xform"),h=e("../simple/date-xform"),u=e("../simple/string-xform"),f=e("../simple/integer-xform"),c=function(v){(function(C,R){if(typeof R!="function"&&R!==null)throw new TypeError("Super expression must either be null or a function");C.prototype=Object.create(R&&R.prototype,{constructor:{value:C,writable:!0,configurable:!0}}),R&&s(C,R)})(_,v);var m,b,w=l(_);function _(){var C;return function(R,I){if(!(R instanceof I))throw new TypeError("Cannot call a class as a function")}(this,_),(C=w.call(this)).map={"dc:creator":new u({tag:"dc:creator"}),"dc:title":new u({tag:"dc:title"}),"dc:subject":new u({tag:"dc:subject"}),"dc:description":new u({tag:"dc:description"}),"dc:identifier":new u({tag:"dc:identifier"}),"dc:language":new u({tag:"dc:language"}),"cp:keywords":new u({tag:"cp:keywords"}),"cp:category":new u({tag:"cp:category"}),"cp:lastModifiedBy":new u({tag:"cp:lastModifiedBy"}),"cp:lastPrinted":new h({tag:"cp:lastPrinted",format:_.DateFormat}),"cp:revision":new f({tag:"cp:revision"}),"cp:version":new u({tag:"cp:version"}),"cp:contentStatus":new u({tag:"cp:contentStatus"}),"cp:contentType":new u({tag:"cp:contentType"}),"dcterms:created":new h({tag:"dcterms:created",attrs:_.DateAttrs,format:_.DateFormat}),"dcterms:modified":new h({tag:"dcterms:modified",attrs:_.DateAttrs,format:_.DateFormat})},C}return m=_,(b=[{key:"render",value:function(C,R){C.openXml(g.StdDocAttributes),C.openNode("cp:coreProperties",_.CORE_PROPERTY_ATTRIBUTES),this.map["dc:creator"].render(C,R.creator),this.map["dc:title"].render(C,R.title),this.map["dc:subject"].render(C,R.subject),this.map["dc:description"].render(C,R.description),this.map["dc:identifier"].render(C,R.identifier),this.map["dc:language"].render(C,R.language),this.map["cp:keywords"].render(C,R.keywords),this.map["cp:category"].render(C,R.category),this.map["cp:lastModifiedBy"].render(C,R.lastModifiedBy),this.map["cp:lastPrinted"].render(C,R.lastPrinted),this.map["cp:revision"].render(C,R.revision),this.map["cp:version"].render(C,R.version),this.map["cp:contentStatus"].render(C,R.contentStatus),this.map["cp:contentType"].render(C,R.contentType),this.map["dcterms:created"].render(C,R.created),this.map["dcterms:modified"].render(C,R.modified),C.closeNode()}},{key:"parseOpen",value:function(C){if(this.parser)return this.parser.parseOpen(C),!0;switch(C.name){case"cp:coreProperties":case"coreProperties":return!0;default:if(this.parser=this.map[C.name],this.parser)return this.parser.parseOpen(C),!0;throw new Error("Unexpected xml node in parseOpen: ".concat(JSON.stringify(C)))}}},{key:"parseText",value:function(C){this.parser&&this.parser.parseText(C)}},{key:"parseClose",value:function(C){if(this.parser)return this.parser.parseClose(C)||(this.parser=void 0),!0;switch(C){case"cp:coreProperties":case"coreProperties":return this.model={creator:this.map["dc:creator"].model,title:this.map["dc:title"].model,subject:this.map["dc:subject"].model,description:this.map["dc:description"].model,identifier:this.map["dc:identifier"].model,language:this.map["dc:language"].model,keywords:this.map["cp:keywords"].model,category:this.map["cp:category"].model,lastModifiedBy:this.map["cp:lastModifiedBy"].model,lastPrinted:this.map["cp:lastPrinted"].model,revision:this.map["cp:revision"].model,contentStatus:this.map["cp:contentStatus"].model,contentType:this.map["cp:contentType"].model,created:this.map["dcterms:created"].model,modified:this.map["dcterms:modified"].model},!1;default:throw new Error("Unexpected xml node in parseClose: ".concat(C))}}}])&&a(m.prototype,b),_}(y);c.DateFormat=function(v){return v.toISOString().replace(/[.]\d{3}/,"")},c.DateAttrs={"xsi:type":"dcterms:W3CDTF"},c.CORE_PROPERTY_ATTRIBUTES={"xmlns:cp":"http://schemas.openxmlformats.org/package/2006/metadata/core-properties","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:dcterms":"http://purl.org/dc/terms/","xmlns:dcmitype":"http://purl.org/dc/dcmitype/","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance"},n.exports=c},{"../../../utils/xml-stream":27,"../base-xform":31,"../simple/date-xform":116,"../simple/integer-xform":117,"../simple/string-xform":118}],53:[function(e,n,i){function o(h){return(o=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(u){return typeof u}:function(u){return u&&typeof Symbol=="function"&&u.constructor===Symbol&&u!==Symbol.prototype?"symbol":typeof u})(h)}function a(h,u){if(!(h instanceof u))throw new TypeError("Cannot call a class as a function")}function s(h,u){for(var f=0;f<u.length;f++){var c=u[f];c.enumerable=c.enumerable||!1,c.configurable=!0,"value"in c&&(c.writable=!0),Object.defineProperty(h,c.key,c)}}function l(h,u){return(l=Object.setPrototypeOf||function(f,c){return f.__proto__=c,f})(h,u)}function p(h){var u=function(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch{return!1}}();return function(){var f,c=g(h);if(u){var v=g(this).constructor;f=Reflect.construct(c,arguments,v)}else f=c.apply(this,arguments);return d(this,f)}}function d(h,u){return!u||o(u)!=="object"&&typeof u!="function"?function(f){if(f===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return f}(h):u}function g(h){return(g=Object.setPrototypeOf?Object.getPrototypeOf:function(u){return u.__proto__||Object.getPrototypeOf(u)})(h)}var y=function(h){(function(m,b){if(typeof b!="function"&&b!==null)throw new TypeError("Super expression must either be null or a function");m.prototype=Object.create(b&&b.prototype,{constructor:{value:m,writable:!0,configurable:!0}}),b&&l(m,b)})(v,h);var u,f,c=p(v);function v(){return a(this,v),c.apply(this,arguments)}return u=v,(f=[{key:"render",value:function(m,b){m.leafNode("Relationship",b)}},{key:"parseOpen",value:function(m){switch(m.name){case"Relationship":return this.model=m.attributes,!0;default:return!1}}},{key:"parseText",value:function(){}},{key:"parseClose",value:function(){return!1}}])&&s(u.prototype,f),v}(e("../base-xform"));n.exports=y},{"../base-xform":31}],54:[function(e,n,i){function o(f){return(o=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(c){return typeof c}:function(c){return c&&typeof Symbol=="function"&&c.constructor===Symbol&&c!==Symbol.prototype?"symbol":typeof c})(f)}function a(f,c){for(var v=0;v<c.length;v++){var m=c[v];m.enumerable=m.enumerable||!1,m.configurable=!0,"value"in m&&(m.writable=!0),Object.defineProperty(f,m.key,m)}}function s(f,c){return(s=Object.setPrototypeOf||function(v,m){return v.__proto__=m,v})(f,c)}function l(f){var c=function(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch{return!1}}();return function(){var v,m=d(f);if(c){var b=d(this).constructor;v=Reflect.construct(m,arguments,b)}else v=m.apply(this,arguments);return p(this,v)}}function p(f,c){return!c||o(c)!=="object"&&typeof c!="function"?function(v){if(v===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return v}(f):c}function d(f){return(d=Object.setPrototypeOf?Object.getPrototypeOf:function(c){return c.__proto__||Object.getPrototypeOf(c)})(f)}var g=e("../../../utils/xml-stream"),y=e("../base-xform"),h=e("./relationship-xform"),u=function(f){(function(w,_){if(typeof _!="function"&&_!==null)throw new TypeError("Super expression must either be null or a function");w.prototype=Object.create(_&&_.prototype,{constructor:{value:w,writable:!0,configurable:!0}}),_&&s(w,_)})(b,f);var c,v,m=l(b);function b(){var w;return function(_,C){if(!(_ instanceof C))throw new TypeError("Cannot call a class as a function")}(this,b),(w=m.call(this)).map={Relationship:new h},w}return c=b,(v=[{key:"render",value:function(w,_){var C=this;_=_||this._values,w.openXml(g.StdDocAttributes),w.openNode("Relationships",b.RELATIONSHIPS_ATTRIBUTES),_.forEach(function(R){C.map.Relationship.render(w,R)}),w.closeNode()}},{key:"parseOpen",value:function(w){if(this.parser)return this.parser.parseOpen(w),!0;switch(w.name){case"Relationships":return this.model=[],!0;default:if(this.parser=this.map[w.name],this.parser)return this.parser.parseOpen(w),!0;throw new Error("Unexpected xml node in parseOpen: ".concat(JSON.stringify(w)))}}},{key:"parseText",value:function(w){this.parser&&this.parser.parseText(w)}},{key:"parseClose",value:function(w){if(this.parser)return this.parser.parseClose(w)||(this.model.push(this.parser.model),this.parser=void 0),!0;switch(w){case"Relationships":return!1;default:throw new Error("Unexpected xml node in parseClose: ".concat(w))}}}])&&a(c.prototype,v),b}(y);u.RELATIONSHIPS_ATTRIBUTES={xmlns:"http://schemas.openxmlformats.org/package/2006/relationships"},n.exports=u},{"../../../utils/xml-stream":27,"../base-xform":31,"./relationship-xform":53}],55:[function(e,n,i){function o(h){return(o=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(u){return typeof u}:function(u){return u&&typeof Symbol=="function"&&u.constructor===Symbol&&u!==Symbol.prototype?"symbol":typeof u})(h)}function a(h,u){if(!(h instanceof u))throw new TypeError("Cannot call a class as a function")}function s(h,u){for(var f=0;f<u.length;f++){var c=u[f];c.enumerable=c.enumerable||!1,c.configurable=!0,"value"in c&&(c.writable=!0),Object.defineProperty(h,c.key,c)}}function l(h,u){return(l=Object.setPrototypeOf||function(f,c){return f.__proto__=c,f})(h,u)}function p(h){var u=function(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch{return!1}}();return function(){var f,c=g(h);if(u){var v=g(this).constructor;f=Reflect.construct(c,arguments,v)}else f=c.apply(this,arguments);return d(this,f)}}function d(h,u){return!u||o(u)!=="object"&&typeof u!="function"?function(f){if(f===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return f}(h):u}function g(h){return(g=Object.setPrototypeOf?Object.getPrototypeOf:function(u){return u.__proto__||Object.getPrototypeOf(u)})(h)}var y=function(h){(function(m,b){if(typeof b!="function"&&b!==null)throw new TypeError("Super expression must either be null or a function");m.prototype=Object.create(b&&b.prototype,{constructor:{value:m,writable:!0,configurable:!0}}),b&&l(m,b)})(v,h);var u,f,c=p(v);function v(){return a(this,v),c.apply(this,arguments)}return u=v,(f=[{key:"parseOpen",value:function(m){if(this.parser)return this.parser.parseOpen(m),!0;switch(m.name){case this.tag:this.reset(),this.model={range:{editAs:m.attributes.editAs||"oneCell"}};break;default:this.parser=this.map[m.name],this.parser&&this.parser.parseOpen(m)}return!0}},{key:"parseText",value:function(m){this.parser&&this.parser.parseText(m)}},{key:"reconcilePicture",value:function(m,b){if(m&&m.rId){var w=b.rels[m.rId].Target.match(/.*\/media\/(.+[.][a-zA-Z]{3,4})/);if(w){var _=w[1],C=b.mediaIndex[_];return b.media[C]}}}}])&&s(u.prototype,f),v}(e("../base-xform"));n.exports=y},{"../base-xform":31}],56:[function(e,n,i){function o(u){return(o=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(f){return typeof f}:function(f){return f&&typeof Symbol=="function"&&f.constructor===Symbol&&f!==Symbol.prototype?"symbol":typeof f})(u)}function a(u,f){for(var c=0;c<f.length;c++){var v=f[c];v.enumerable=v.enumerable||!1,v.configurable=!0,"value"in v&&(v.writable=!0),Object.defineProperty(u,v.key,v)}}function s(u,f){return(s=Object.setPrototypeOf||function(c,v){return c.__proto__=v,c})(u,f)}function l(u){var f=function(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch{return!1}}();return function(){var c,v=d(u);if(f){var m=d(this).constructor;c=Reflect.construct(v,arguments,m)}else c=v.apply(this,arguments);return p(this,c)}}function p(u,f){return!f||o(f)!=="object"&&typeof f!="function"?function(c){if(c===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return c}(u):f}function d(u){return(d=Object.setPrototypeOf?Object.getPrototypeOf:function(f){return f.__proto__||Object.getPrototypeOf(f)})(u)}var g=e("../base-xform"),y=e("./blip-xform"),h=function(u){(function(b,w){if(typeof w!="function"&&w!==null)throw new TypeError("Super expression must either be null or a function");b.prototype=Object.create(w&&w.prototype,{constructor:{value:b,writable:!0,configurable:!0}}),w&&s(b,w)})(m,u);var f,c,v=l(m);function m(){var b;return function(w,_){if(!(w instanceof _))throw new TypeError("Cannot call a class as a function")}(this,m),(b=v.call(this)).map={"a:blip":new y},b}return f=m,(c=[{key:"render",value:function(b,w){b.openNode(this.tag),this.map["a:blip"].render(b,w),b.openNode("a:stretch"),b.leafNode("a:fillRect"),b.closeNode(),b.closeNode()}},{key:"parseOpen",value:function(b){if(this.parser)return this.parser.parseOpen(b),!0;switch(b.name){case this.tag:this.reset();break;default:this.parser=this.map[b.name],this.parser&&this.parser.parseOpen(b)}return!0}},{key:"parseText",value:function(){}},{key:"parseClose",value:function(b){if(this.parser)return this.parser.parseClose(b)||(this.parser=void 0),!0;switch(b){case this.tag:return this.model=this.map["a:blip"].model,!1;default:return!0}}},{key:"tag",get:function(){return"xdr:blipFill"}}])&&a(f.prototype,c),m}(g);n.exports=h},{"../base-xform":31,"./blip-xform":57}],57:[function(e,n,i){function o(h){return(o=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(u){return typeof u}:function(u){return u&&typeof Symbol=="function"&&u.constructor===Symbol&&u!==Symbol.prototype?"symbol":typeof u})(h)}function a(h,u){if(!(h instanceof u))throw new TypeError("Cannot call a class as a function")}function s(h,u){for(var f=0;f<u.length;f++){var c=u[f];c.enumerable=c.enumerable||!1,c.configurable=!0,"value"in c&&(c.writable=!0),Object.defineProperty(h,c.key,c)}}function l(h,u){return(l=Object.setPrototypeOf||function(f,c){return f.__proto__=c,f})(h,u)}function p(h){var u=function(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch{return!1}}();return function(){var f,c=g(h);if(u){var v=g(this).constructor;f=Reflect.construct(c,arguments,v)}else f=c.apply(this,arguments);return d(this,f)}}function d(h,u){return!u||o(u)!=="object"&&typeof u!="function"?function(f){if(f===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return f}(h):u}function g(h){return(g=Object.setPrototypeOf?Object.getPrototypeOf:function(u){return u.__proto__||Object.getPrototypeOf(u)})(h)}var y=function(h){(function(m,b){if(typeof b!="function"&&b!==null)throw new TypeError("Super expression must either be null or a function");m.prototype=Object.create(b&&b.prototype,{constructor:{value:m,writable:!0,configurable:!0}}),b&&l(m,b)})(v,h);var u,f,c=p(v);function v(){return a(this,v),c.apply(this,arguments)}return u=v,(f=[{key:"render",value:function(m,b){m.leafNode(this.tag,{"xmlns:r":"http://schemas.openxmlformats.org/officeDocument/2006/relationships","r:embed":b.rId,cstate:"print"})}},{key:"parseOpen",value:function(m){switch(m.name){case this.tag:return this.model={rId:m.attributes["r:embed"]},!0;default:return!0}}},{key:"parseText",value:function(){}},{key:"parseClose",value:function(m){switch(m){case this.tag:return!1;default:return!0}}},{key:"tag",get:function(){return"a:blip"}}])&&s(u.prototype,f),v}(e("../base-xform"));n.exports=y},{"../base-xform":31}],58:[function(e,n,i){function o(h){return(o=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(u){return typeof u}:function(u){return u&&typeof Symbol=="function"&&u.constructor===Symbol&&u!==Symbol.prototype?"symbol":typeof u})(h)}function a(h,u){if(!(h instanceof u))throw new TypeError("Cannot call a class as a function")}function s(h,u){for(var f=0;f<u.length;f++){var c=u[f];c.enumerable=c.enumerable||!1,c.configurable=!0,"value"in c&&(c.writable=!0),Object.defineProperty(h,c.key,c)}}function l(h,u){return(l=Object.setPrototypeOf||function(f,c){return f.__proto__=c,f})(h,u)}function p(h){var u=function(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch{return!1}}();return function(){var f,c=g(h);if(u){var v=g(this).constructor;f=Reflect.construct(c,arguments,v)}else f=c.apply(this,arguments);return d(this,f)}}function d(h,u){return!u||o(u)!=="object"&&typeof u!="function"?function(f){if(f===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return f}(h):u}function g(h){return(g=Object.setPrototypeOf?Object.getPrototypeOf:function(u){return u.__proto__||Object.getPrototypeOf(u)})(h)}var y=function(h){(function(m,b){if(typeof b!="function"&&b!==null)throw new TypeError("Super expression must either be null or a function");m.prototype=Object.create(b&&b.prototype,{constructor:{value:m,writable:!0,configurable:!0}}),b&&l(m,b)})(v,h);var u,f,c=p(v);function v(){return a(this,v),c.apply(this,arguments)}return u=v,(f=[{key:"render",value:function(m){m.openNode(this.tag),m.leafNode("a:picLocks",{noChangeAspect:"1"}),m.closeNode()}},{key:"parseOpen",value:function(m){switch(m.name){case this.tag:default:return!0}}},{key:"parseText",value:function(){}},{key:"parseClose",value:function(m){switch(m){case this.tag:return!1;default:return!0}}},{key:"tag",get:function(){return"xdr:cNvPicPr"}}])&&s(u.prototype,f),v}(e("../base-xform"));n.exports=y},{"../base-xform":31}],59:[function(e,n,i){function o(f){return(o=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(c){return typeof c}:function(c){return c&&typeof Symbol=="function"&&c.constructor===Symbol&&c!==Symbol.prototype?"symbol":typeof c})(f)}function a(f,c){for(var v=0;v<c.length;v++){var m=c[v];m.enumerable=m.enumerable||!1,m.configurable=!0,"value"in m&&(m.writable=!0),Object.defineProperty(f,m.key,m)}}function s(f,c){return(s=Object.setPrototypeOf||function(v,m){return v.__proto__=m,v})(f,c)}function l(f){var c=function(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch{return!1}}();return function(){var v,m=d(f);if(c){var b=d(this).constructor;v=Reflect.construct(m,arguments,b)}else v=m.apply(this,arguments);return p(this,v)}}function p(f,c){return!c||o(c)!=="object"&&typeof c!="function"?function(v){if(v===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return v}(f):c}function d(f){return(d=Object.setPrototypeOf?Object.getPrototypeOf:function(c){return c.__proto__||Object.getPrototypeOf(c)})(f)}var g=e("../base-xform"),y=e("./hlink-click-xform"),h=e("./ext-lst-xform"),u=function(f){(function(w,_){if(typeof _!="function"&&_!==null)throw new TypeError("Super expression must either be null or a function");w.prototype=Object.create(_&&_.prototype,{constructor:{value:w,writable:!0,configurable:!0}}),_&&s(w,_)})(b,f);var c,v,m=l(b);function b(){var w;return function(_,C){if(!(_ instanceof C))throw new TypeError("Cannot call a class as a function")}(this,b),(w=m.call(this)).map={"a:hlinkClick":new y,"a:extLst":new h},w}return c=b,(v=[{key:"render",value:function(w,_){w.openNode(this.tag,{id:_.index,name:"Picture ".concat(_.index)}),this.map["a:hlinkClick"].render(w,_),this.map["a:extLst"].render(w,_),w.closeNode()}},{key:"parseOpen",value:function(w){if(this.parser)return this.parser.parseOpen(w),!0;switch(w.name){case this.tag:this.reset();break;default:this.parser=this.map[w.name],this.parser&&this.parser.parseOpen(w)}return!0}},{key:"parseText",value:function(){}},{key:"parseClose",value:function(w){if(this.parser)return this.parser.parseClose(w)||(this.parser=void 0),!0;switch(w){case this.tag:return this.model=this.map["a:hlinkClick"].model,!1;default:return!0}}},{key:"tag",get:function(){return"xdr:cNvPr"}}])&&a(c.prototype,v),b}(g);n.exports=u},{"../base-xform":31,"./ext-lst-xform":62,"./hlink-click-xform":64}],60:[function(e,n,i){function o(u){return(o=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(f){return typeof f}:function(f){return f&&typeof Symbol=="function"&&f.constructor===Symbol&&f!==Symbol.prototype?"symbol":typeof f})(u)}function a(u,f){for(var c=0;c<f.length;c++){var v=f[c];v.enumerable=v.enumerable||!1,v.configurable=!0,"value"in v&&(v.writable=!0),Object.defineProperty(u,v.key,v)}}function s(u,f){return(s=Object.setPrototypeOf||function(c,v){return c.__proto__=v,c})(u,f)}function l(u){var f=function(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch{return!1}}();return function(){var c,v=d(u);if(f){var m=d(this).constructor;c=Reflect.construct(v,arguments,m)}else c=v.apply(this,arguments);return p(this,c)}}function p(u,f){return!f||o(f)!=="object"&&typeof f!="function"?function(c){if(c===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return c}(u):f}function d(u){return(d=Object.setPrototypeOf?Object.getPrototypeOf:function(f){return f.__proto__||Object.getPrototypeOf(f)})(u)}var g=e("../base-xform"),y=e("../simple/integer-xform"),h=function(u){(function(b,w){if(typeof w!="function"&&w!==null)throw new TypeError("Super expression must either be null or a function");b.prototype=Object.create(w&&w.prototype,{constructor:{value:b,writable:!0,configurable:!0}}),w&&s(b,w)})(m,u);var f,c,v=l(m);function m(b){var w;return function(_,C){if(!(_ instanceof C))throw new TypeError("Cannot call a class as a function")}(this,m),(w=v.call(this)).tag=b.tag,w.map={"xdr:col":new y({tag:"xdr:col",zero:!0}),"xdr:colOff":new y({tag:"xdr:colOff",zero:!0}),"xdr:row":new y({tag:"xdr:row",zero:!0}),"xdr:rowOff":new y({tag:"xdr:rowOff",zero:!0})},w}return f=m,(c=[{key:"render",value:function(b,w){b.openNode(this.tag),this.map["xdr:col"].render(b,w.nativeCol),this.map["xdr:colOff"].render(b,w.nativeColOff),this.map["xdr:row"].render(b,w.nativeRow),this.map["xdr:rowOff"].render(b,w.nativeRowOff),b.closeNode()}},{key:"parseOpen",value:function(b){if(this.parser)return this.parser.parseOpen(b),!0;switch(b.name){case this.tag:this.reset();break;default:this.parser=this.map[b.name],this.parser&&this.parser.parseOpen(b)}return!0}},{key:"parseText",value:function(b){this.parser&&this.parser.parseText(b)}},{key:"parseClose",value:function(b){if(this.parser)return this.parser.parseClose(b)||(this.parser=void 0),!0;switch(b){case this.tag:return this.model={nativeCol:this.map["xdr:col"].model,nativeColOff:this.map["xdr:colOff"].model,nativeRow:this.map["xdr:row"].model,nativeRowOff:this.map["xdr:rowOff"].model},!1;default:return!0}}}])&&a(f.prototype,c),m}(g);n.exports=h},{"../base-xform":31,"../simple/integer-xform":117}],61:[function(e,n,i){function o(v){return(o=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(m){return typeof m}:function(m){return m&&typeof Symbol=="function"&&m.constructor===Symbol&&m!==Symbol.prototype?"symbol":typeof m})(v)}function a(v,m){for(var b=0;b<m.length;b++){var w=m[b];w.enumerable=w.enumerable||!1,w.configurable=!0,"value"in w&&(w.writable=!0),Object.defineProperty(v,w.key,w)}}function s(v,m){return(s=Object.setPrototypeOf||function(b,w){return b.__proto__=w,b})(v,m)}function l(v){var m=function(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch{return!1}}();return function(){var b,w=d(v);if(m){var _=d(this).constructor;b=Reflect.construct(w,arguments,_)}else b=w.apply(this,arguments);return p(this,b)}}function p(v,m){return!m||o(m)!=="object"&&typeof m!="function"?function(b){if(b===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return b}(v):m}function d(v){return(d=Object.setPrototypeOf?Object.getPrototypeOf:function(m){return m.__proto__||Object.getPrototypeOf(m)})(v)}var g=e("../../../utils/col-cache"),y=e("../../../utils/xml-stream"),h=e("../base-xform"),u=e("./two-cell-anchor-xform"),f=e("./one-cell-anchor-xform"),c=function(v){(function(C,R){if(typeof R!="function"&&R!==null)throw new TypeError("Super expression must either be null or a function");C.prototype=Object.create(R&&R.prototype,{constructor:{value:C,writable:!0,configurable:!0}}),R&&s(C,R)})(_,v);var m,b,w=l(_);function _(){var C;return function(R,I){if(!(R instanceof I))throw new TypeError("Cannot call a class as a function")}(this,_),(C=w.call(this)).map={"xdr:twoCellAnchor":new u,"xdr:oneCellAnchor":new f},C}return m=_,(b=[{key:"prepare",value:function(C){var R=this;C.anchors.forEach(function(I,P){I.anchorType=function(N){return(typeof N.range=="string"?g.decode(N.range):N.range).br?"xdr:twoCellAnchor":"xdr:oneCellAnchor"}(I),R.map[I.anchorType].prepare(I,{index:P})})}},{key:"render",value:function(C,R){var I=this;C.openXml(y.StdDocAttributes),C.openNode(this.tag,_.DRAWING_ATTRIBUTES),R.anchors.forEach(function(P){I.map[P.anchorType].render(C,P)}),C.closeNode()}},{key:"parseOpen",value:function(C){if(this.parser)return this.parser.parseOpen(C),!0;switch(C.name){case this.tag:this.reset(),this.model={anchors:[]};break;default:this.parser=this.map[C.name],this.parser&&this.parser.parseOpen(C)}return!0}},{key:"parseText",value:function(C){this.parser&&this.parser.parseText(C)}},{key:"parseClose",value:function(C){if(this.parser)return this.parser.parseClose(C)||(this.model.anchors.push(this.parser.model),this.parser=void 0),!0;switch(C){case this.tag:return!1;default:return!0}}},{key:"reconcile",value:function(C,R){var I=this;C.anchors.forEach(function(P){P.br?I.map["xdr:twoCellAnchor"].reconcile(P,R):I.map["xdr:oneCellAnchor"].reconcile(P,R)})}},{key:"tag",get:function(){return"xdr:wsDr"}}])&&a(m.prototype,b),_}(h);c.DRAWING_ATTRIBUTES={"xmlns:xdr":"http://schemas.openxmlformats.org/drawingml/2006/spreadsheetDrawing","xmlns:a":"http://schemas.openxmlformats.org/drawingml/2006/main"},n.exports=c},{"../../../utils/col-cache":19,"../../../utils/xml-stream":27,"../base-xform":31,"./one-cell-anchor-xform":66,"./two-cell-anchor-xform":69}],62:[function(e,n,i){function o(h){return(o=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(u){return typeof u}:function(u){return u&&typeof Symbol=="function"&&u.constructor===Symbol&&u!==Symbol.prototype?"symbol":typeof u})(h)}function a(h,u){if(!(h instanceof u))throw new TypeError("Cannot call a class as a function")}function s(h,u){for(var f=0;f<u.length;f++){var c=u[f];c.enumerable=c.enumerable||!1,c.configurable=!0,"value"in c&&(c.writable=!0),Object.defineProperty(h,c.key,c)}}function l(h,u){return(l=Object.setPrototypeOf||function(f,c){return f.__proto__=c,f})(h,u)}function p(h){var u=function(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch{return!1}}();return function(){var f,c=g(h);if(u){var v=g(this).constructor;f=Reflect.construct(c,arguments,v)}else f=c.apply(this,arguments);return d(this,f)}}function d(h,u){return!u||o(u)!=="object"&&typeof u!="function"?function(f){if(f===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return f}(h):u}function g(h){return(g=Object.setPrototypeOf?Object.getPrototypeOf:function(u){return u.__proto__||Object.getPrototypeOf(u)})(h)}var y=function(h){(function(m,b){if(typeof b!="function"&&b!==null)throw new TypeError("Super expression must either be null or a function");m.prototype=Object.create(b&&b.prototype,{constructor:{value:m,writable:!0,configurable:!0}}),b&&l(m,b)})(v,h);var u,f,c=p(v);function v(){return a(this,v),c.apply(this,arguments)}return u=v,(f=[{key:"render",value:function(m){m.openNode(this.tag),m.openNode("a:ext",{uri:"{FF2B5EF4-FFF2-40B4-BE49-F238E27FC236}"}),m.leafNode("a16:creationId",{"xmlns:a16":"http://schemas.microsoft.com/office/drawing/2014/main",id:"{00000000-0008-0000-0000-000002000000}"}),m.closeNode(),m.closeNode()}},{key:"parseOpen",value:function(m){switch(m.name){case this.tag:default:return!0}}},{key:"parseText",value:function(){}},{key:"parseClose",value:function(m){switch(m){case this.tag:return!1;default:return!0}}},{key:"tag",get:function(){return"a:extLst"}}])&&s(u.prototype,f),v}(e("../base-xform"));n.exports=y},{"../base-xform":31}],63:[function(e,n,i){function o(h){return(o=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(u){return typeof u}:function(u){return u&&typeof Symbol=="function"&&u.constructor===Symbol&&u!==Symbol.prototype?"symbol":typeof u})(h)}function a(h,u){for(var f=0;f<u.length;f++){var c=u[f];c.enumerable=c.enumerable||!1,c.configurable=!0,"value"in c&&(c.writable=!0),Object.defineProperty(h,c.key,c)}}function s(h,u){return(s=Object.setPrototypeOf||function(f,c){return f.__proto__=c,f})(h,u)}function l(h){var u=function(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch{return!1}}();return function(){var f,c=d(h);if(u){var v=d(this).constructor;f=Reflect.construct(c,arguments,v)}else f=c.apply(this,arguments);return p(this,f)}}function p(h,u){return!u||o(u)!=="object"&&typeof u!="function"?function(f){if(f===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return f}(h):u}function d(h){return(d=Object.setPrototypeOf?Object.getPrototypeOf:function(u){return u.__proto__||Object.getPrototypeOf(u)})(h)}var g=e("../base-xform"),y=function(h){(function(m,b){if(typeof b!="function"&&b!==null)throw new TypeError("Super expression must either be null or a function");m.prototype=Object.create(b&&b.prototype,{constructor:{value:m,writable:!0,configurable:!0}}),b&&s(m,b)})(v,h);var u,f,c=l(v);function v(m){var b;return function(w,_){if(!(w instanceof _))throw new TypeError("Cannot call a class as a function")}(this,v),(b=c.call(this)).tag=m.tag,b.map={},b}return u=v,(f=[{key:"render",value:function(m,b){m.openNode(this.tag);var w=Math.floor(9525*b.width),_=Math.floor(9525*b.height);m.addAttribute("cx",w),m.addAttribute("cy",_),m.closeNode()}},{key:"parseOpen",value:function(m){return m.name===this.tag&&(this.model={width:parseInt(m.attributes.cx||"0",10)/9525,height:parseInt(m.attributes.cy||"0",10)/9525},!0)}},{key:"parseText",value:function(){}},{key:"parseClose",value:function(){return!1}}])&&a(u.prototype,f),v}(g);n.exports=y},{"../base-xform":31}],64:[function(e,n,i){function o(h){return(o=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(u){return typeof u}:function(u){return u&&typeof Symbol=="function"&&u.constructor===Symbol&&u!==Symbol.prototype?"symbol":typeof u})(h)}function a(h,u){if(!(h instanceof u))throw new TypeError("Cannot call a class as a function")}function s(h,u){for(var f=0;f<u.length;f++){var c=u[f];c.enumerable=c.enumerable||!1,c.configurable=!0,"value"in c&&(c.writable=!0),Object.defineProperty(h,c.key,c)}}function l(h,u){return(l=Object.setPrototypeOf||function(f,c){return f.__proto__=c,f})(h,u)}function p(h){var u=function(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch{return!1}}();return function(){var f,c=g(h);if(u){var v=g(this).constructor;f=Reflect.construct(c,arguments,v)}else f=c.apply(this,arguments);return d(this,f)}}function d(h,u){return!u||o(u)!=="object"&&typeof u!="function"?function(f){if(f===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return f}(h):u}function g(h){return(g=Object.setPrototypeOf?Object.getPrototypeOf:function(u){return u.__proto__||Object.getPrototypeOf(u)})(h)}var y=function(h){(function(m,b){if(typeof b!="function"&&b!==null)throw new TypeError("Super expression must either be null or a function");m.prototype=Object.create(b&&b.prototype,{constructor:{value:m,writable:!0,configurable:!0}}),b&&l(m,b)})(v,h);var u,f,c=p(v);function v(){return a(this,v),c.apply(this,arguments)}return u=v,(f=[{key:"render",value:function(m,b){b.hyperlinks&&b.hyperlinks.rId&&m.leafNode(this.tag,{"xmlns:r":"http://schemas.openxmlformats.org/officeDocument/2006/relationships","r:id":b.hyperlinks.rId,tooltip:b.hyperlinks.tooltip})}},{key:"parseOpen",value:function(m){switch(m.name){case this.tag:return this.model={hyperlinks:{rId:m.attributes["r:id"],tooltip:m.attributes.tooltip}},!0;default:return!0}}},{key:"parseText",value:function(){}},{key:"parseClose",value:function(){return!1}},{key:"tag",get:function(){return"a:hlinkClick"}}])&&s(u.prototype,f),v}(e("../base-xform"));n.exports=y},{"../base-xform":31}],65:[function(e,n,i){function o(f){return(o=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(c){return typeof c}:function(c){return c&&typeof Symbol=="function"&&c.constructor===Symbol&&c!==Symbol.prototype?"symbol":typeof c})(f)}function a(f,c){for(var v=0;v<c.length;v++){var m=c[v];m.enumerable=m.enumerable||!1,m.configurable=!0,"value"in m&&(m.writable=!0),Object.defineProperty(f,m.key,m)}}function s(f,c){return(s=Object.setPrototypeOf||function(v,m){return v.__proto__=m,v})(f,c)}function l(f){var c=function(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch{return!1}}();return function(){var v,m=d(f);if(c){var b=d(this).constructor;v=Reflect.construct(m,arguments,b)}else v=m.apply(this,arguments);return p(this,v)}}function p(f,c){return!c||o(c)!=="object"&&typeof c!="function"?function(v){if(v===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return v}(f):c}function d(f){return(d=Object.setPrototypeOf?Object.getPrototypeOf:function(c){return c.__proto__||Object.getPrototypeOf(c)})(f)}var g=e("../base-xform"),y=e("./c-nv-pr-xform"),h=e("./c-nv-pic-pr-xform"),u=function(f){(function(w,_){if(typeof _!="function"&&_!==null)throw new TypeError("Super expression must either be null or a function");w.prototype=Object.create(_&&_.prototype,{constructor:{value:w,writable:!0,configurable:!0}}),_&&s(w,_)})(b,f);var c,v,m=l(b);function b(){var w;return function(_,C){if(!(_ instanceof C))throw new TypeError("Cannot call a class as a function")}(this,b),(w=m.call(this)).map={"xdr:cNvPr":new y,"xdr:cNvPicPr":new h},w}return c=b,(v=[{key:"render",value:function(w,_){w.openNode(this.tag),this.map["xdr:cNvPr"].render(w,_),this.map["xdr:cNvPicPr"].render(w,_),w.closeNode()}},{key:"parseOpen",value:function(w){if(this.parser)return this.parser.parseOpen(w),!0;switch(w.name){case this.tag:this.reset();break;default:this.parser=this.map[w.name],this.parser&&this.parser.parseOpen(w)}return!0}},{key:"parseText",value:function(){}},{key:"parseClose",value:function(w){if(this.parser)return this.parser.parseClose(w)||(this.parser=void 0),!0;switch(w){case this.tag:return this.model=this.map["xdr:cNvPr"].model,!1;default:return!0}}},{key:"tag",get:function(){return"xdr:nvPicPr"}}])&&a(c.prototype,v),b}(g);n.exports=u},{"../base-xform":31,"./c-nv-pic-pr-xform":58,"./c-nv-pr-xform":59}],66:[function(e,n,i){function o(v){return(o=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(m){return typeof m}:function(m){return m&&typeof Symbol=="function"&&m.constructor===Symbol&&m!==Symbol.prototype?"symbol":typeof m})(v)}function a(v,m){for(var b=0;b<m.length;b++){var w=m[b];w.enumerable=w.enumerable||!1,w.configurable=!0,"value"in w&&(w.writable=!0),Object.defineProperty(v,w.key,w)}}function s(v,m){return(s=Object.setPrototypeOf||function(b,w){return b.__proto__=w,b})(v,m)}function l(v){var m=function(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch{return!1}}();return function(){var b,w=d(v);if(m){var _=d(this).constructor;b=Reflect.construct(w,arguments,_)}else b=w.apply(this,arguments);return p(this,b)}}function p(v,m){return!m||o(m)!=="object"&&typeof m!="function"?function(b){if(b===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return b}(v):m}function d(v){return(d=Object.setPrototypeOf?Object.getPrototypeOf:function(m){return m.__proto__||Object.getPrototypeOf(m)})(v)}var g=e("./base-cell-anchor-xform"),y=e("../static-xform"),h=e("./cell-position-xform"),u=e("./ext-xform"),f=e("./pic-xform"),c=function(v){(function(C,R){if(typeof R!="function"&&R!==null)throw new TypeError("Super expression must either be null or a function");C.prototype=Object.create(R&&R.prototype,{constructor:{value:C,writable:!0,configurable:!0}}),R&&s(C,R)})(_,v);var m,b,w=l(_);function _(){var C;return function(R,I){if(!(R instanceof I))throw new TypeError("Cannot call a class as a function")}(this,_),(C=w.call(this)).map={"xdr:from":new h({tag:"xdr:from"}),"xdr:ext":new u({tag:"xdr:ext"}),"xdr:pic":new f,"xdr:clientData":new y({tag:"xdr:clientData"})},C}return m=_,(b=[{key:"prepare",value:function(C,R){this.map["xdr:pic"].prepare(C.picture,R)}},{key:"render",value:function(C,R){C.openNode(this.tag,{editAs:R.range.editAs||"oneCell"}),this.map["xdr:from"].render(C,R.range.tl),this.map["xdr:ext"].render(C,R.range.ext),this.map["xdr:pic"].render(C,R.picture),this.map["xdr:clientData"].render(C,{}),C.closeNode()}},{key:"parseClose",value:function(C){if(this.parser)return this.parser.parseClose(C)||(this.parser=void 0),!0;switch(C){case this.tag:return this.model.range.tl=this.map["xdr:from"].model,this.model.range.ext=this.map["xdr:ext"].model,this.model.picture=this.map["xdr:pic"].model,!1;default:return!0}}},{key:"reconcile",value:function(C,R){C.medium=this.reconcilePicture(C.picture,R)}},{key:"tag",get:function(){return"xdr:oneCellAnchor"}}])&&a(m.prototype,b),_}(g);n.exports=c},{"../static-xform":119,"./base-cell-anchor-xform":55,"./cell-position-xform":60,"./ext-xform":63,"./pic-xform":67}],67:[function(e,n,i){function o(v){return(o=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(m){return typeof m}:function(m){return m&&typeof Symbol=="function"&&m.constructor===Symbol&&m!==Symbol.prototype?"symbol":typeof m})(v)}function a(v,m){for(var b=0;b<m.length;b++){var w=m[b];w.enumerable=w.enumerable||!1,w.configurable=!0,"value"in w&&(w.writable=!0),Object.defineProperty(v,w.key,w)}}function s(v,m){return(s=Object.setPrototypeOf||function(b,w){return b.__proto__=w,b})(v,m)}function l(v){var m=function(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch{return!1}}();return function(){var b,w=d(v);if(m){var _=d(this).constructor;b=Reflect.construct(w,arguments,_)}else b=w.apply(this,arguments);return p(this,b)}}function p(v,m){return!m||o(m)!=="object"&&typeof m!="function"?function(b){if(b===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return b}(v):m}function d(v){return(d=Object.setPrototypeOf?Object.getPrototypeOf:function(m){return m.__proto__||Object.getPrototypeOf(m)})(v)}var g=e("../base-xform"),y=e("../static-xform"),h=e("./blip-fill-xform"),u=e("./nv-pic-pr-xform"),f=e("./sp-pr"),c=function(v){(function(C,R){if(typeof R!="function"&&R!==null)throw new TypeError("Super expression must either be null or a function");C.prototype=Object.create(R&&R.prototype,{constructor:{value:C,writable:!0,configurable:!0}}),R&&s(C,R)})(_,v);var m,b,w=l(_);function _(){var C;return function(R,I){if(!(R instanceof I))throw new TypeError("Cannot call a class as a function")}(this,_),(C=w.call(this)).map={"xdr:nvPicPr":new u,"xdr:blipFill":new h,"xdr:spPr":new y(f)},C}return m=_,(b=[{key:"prepare",value:function(C,R){C.index=R.index+1}},{key:"render",value:function(C,R){C.openNode(this.tag),this.map["xdr:nvPicPr"].render(C,R),this.map["xdr:blipFill"].render(C,R),this.map["xdr:spPr"].render(C,R),C.closeNode()}},{key:"parseOpen",value:function(C){if(this.parser)return this.parser.parseOpen(C),!0;switch(C.name){case this.tag:this.reset();break;default:this.parser=this.map[C.name],this.parser&&this.parser.parseOpen(C)}return!0}},{key:"parseText",value:function(){}},{key:"parseClose",value:function(C){if(this.parser)return this.parser.parseClose(C)||(this.mergeModel(this.parser.model),this.parser=void 0),!0;switch(C){case this.tag:return!1;default:return!0}}},{key:"tag",get:function(){return"xdr:pic"}}])&&a(m.prototype,b),_}(g);n.exports=c},{"../base-xform":31,"../static-xform":119,"./blip-fill-xform":56,"./nv-pic-pr-xform":65,"./sp-pr":68}],68:[function(e,n,i){n.exports={tag:"xdr:spPr",c:[{tag:"a:xfrm",c:[{tag:"a:off",$:{x:"0",y:"0"}},{tag:"a:ext",$:{cx:"0",cy:"0"}}]},{tag:"a:prstGeom",$:{prst:"rect"},c:[{tag:"a:avLst"}]}]}},{}],69:[function(e,n,i){function o(c){return(o=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(v){return typeof v}:function(v){return v&&typeof Symbol=="function"&&v.constructor===Symbol&&v!==Symbol.prototype?"symbol":typeof v})(c)}function a(c,v){for(var m=0;m<v.length;m++){var b=v[m];b.enumerable=b.enumerable||!1,b.configurable=!0,"value"in b&&(b.writable=!0),Object.defineProperty(c,b.key,b)}}function s(c,v){return(s=Object.setPrototypeOf||function(m,b){return m.__proto__=b,m})(c,v)}function l(c){var v=function(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch{return!1}}();return function(){var m,b=d(c);if(v){var w=d(this).constructor;m=Reflect.construct(b,arguments,w)}else m=b.apply(this,arguments);return p(this,m)}}function p(c,v){return!v||o(v)!=="object"&&typeof v!="function"?function(m){if(m===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return m}(c):v}function d(c){return(d=Object.setPrototypeOf?Object.getPrototypeOf:function(v){return v.__proto__||Object.getPrototypeOf(v)})(c)}var g=e("./base-cell-anchor-xform"),y=e("../static-xform"),h=e("./cell-position-xform"),u=e("./pic-xform"),f=function(c){(function(_,C){if(typeof C!="function"&&C!==null)throw new TypeError("Super expression must either be null or a function");_.prototype=Object.create(C&&C.prototype,{constructor:{value:_,writable:!0,configurable:!0}}),C&&s(_,C)})(w,c);var v,m,b=l(w);function w(){var _;return function(C,R){if(!(C instanceof R))throw new TypeError("Cannot call a class as a function")}(this,w),(_=b.call(this)).map={"xdr:from":new h({tag:"xdr:from"}),"xdr:to":new h({tag:"xdr:to"}),"xdr:pic":new u,"xdr:clientData":new y({tag:"xdr:clientData"})},_}return v=w,(m=[{key:"prepare",value:function(_,C){this.map["xdr:pic"].prepare(_.picture,C)}},{key:"render",value:function(_,C){_.openNode(this.tag,{editAs:C.range.editAs||"oneCell"}),this.map["xdr:from"].render(_,C.range.tl),this.map["xdr:to"].render(_,C.range.br),this.map["xdr:pic"].render(_,C.picture),this.map["xdr:clientData"].render(_,{}),_.closeNode()}},{key:"parseClose",value:function(_){if(this.parser)return this.parser.parseClose(_)||(this.parser=void 0),!0;switch(_){case this.tag:return this.model.range.tl=this.map["xdr:from"].model,this.model.range.br=this.map["xdr:to"].model,this.model.picture=this.map["xdr:pic"].model,!1;default:return!0}}},{key:"reconcile",value:function(_,C){_.medium=this.reconcilePicture(_.picture,C)}},{key:"tag",get:function(){return"xdr:twoCellAnchor"}}])&&a(v.prototype,m),w}(g);n.exports=f},{"../static-xform":119,"./base-cell-anchor-xform":55,"./cell-position-xform":60,"./pic-xform":67}],70:[function(e,n,i){function o(y){return(o=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(h){return typeof h}:function(h){return h&&typeof Symbol=="function"&&h.constructor===Symbol&&h!==Symbol.prototype?"symbol":typeof h})(y)}function a(y,h){for(var u=0;u<h.length;u++){var f=h[u];f.enumerable=f.enumerable||!1,f.configurable=!0,"value"in f&&(f.writable=!0),Object.defineProperty(y,f.key,f)}}function s(y,h){return(s=Object.setPrototypeOf||function(u,f){return u.__proto__=f,u})(y,h)}function l(y){var h=function(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch{return!1}}();return function(){var u,f=d(y);if(h){var c=d(this).constructor;u=Reflect.construct(f,arguments,c)}else u=f.apply(this,arguments);return p(this,u)}}function p(y,h){return!h||o(h)!=="object"&&typeof h!="function"?function(u){if(u===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return u}(y):h}function d(y){return(d=Object.setPrototypeOf?Object.getPrototypeOf:function(h){return h.__proto__||Object.getPrototypeOf(h)})(y)}var g=function(y){(function(v,m){if(typeof m!="function"&&m!==null)throw new TypeError("Super expression must either be null or a function");v.prototype=Object.create(m&&m.prototype,{constructor:{value:v,writable:!0,configurable:!0}}),m&&s(v,m)})(c,y);var h,u,f=l(c);function c(v){var m;return function(b,w){if(!(b instanceof w))throw new TypeError("Cannot call a class as a function")}(this,c),(m=f.call(this)).tag=v.tag,m.always=!!v.always,m.count=v.count,m.empty=v.empty,m.$count=v.$count||"count",m.$=v.$,m.childXform=v.childXform,m.maxItems=v.maxItems,m}return h=c,(u=[{key:"prepare",value:function(v,m){var b=this.childXform;v&&v.forEach(function(w,_){m.index=_,b.prepare(w,m)})}},{key:"render",value:function(v,m){if(this.always||m&&m.length){v.openNode(this.tag,this.$),this.count&&v.addAttribute(this.$count,m&&m.length||0);var b=this.childXform;(m||[]).forEach(function(w,_){b.render(v,w,_)}),v.closeNode()}else this.empty&&v.leafNode(this.tag)}},{key:"parseOpen",value:function(v){if(this.parser)return this.parser.parseOpen(v),!0;switch(v.name){case this.tag:return this.model=[],!0;default:return!!this.childXform.parseOpen(v)&&(this.parser=this.childXform,!0)}}},{key:"parseText",value:function(v){this.parser&&this.parser.parseText(v)}},{key:"parseClose",value:function(v){if(this.parser){if(!this.parser.parseClose(v)&&(this.model.push(this.parser.model),this.parser=void 0,this.maxItems&&this.model.length>this.maxItems))throw new Error("Max ".concat(this.childXform.tag," count (").concat(this.maxItems,") exceeded"));return!0}return!1}},{key:"reconcile",value:function(v,m){if(v){var b=this.childXform;v.forEach(function(w){b.reconcile(w,m)})}}}])&&a(h.prototype,u),c}(e("./base-xform"));n.exports=g},{"./base-xform":31}],71:[function(e,n,i){function o(u){return(o=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(f){return typeof f}:function(f){return f&&typeof Symbol=="function"&&f.constructor===Symbol&&f!==Symbol.prototype?"symbol":typeof f})(u)}function a(u,f){if(!(u instanceof f))throw new TypeError("Cannot call a class as a function")}function s(u,f){for(var c=0;c<f.length;c++){var v=f[c];v.enumerable=v.enumerable||!1,v.configurable=!0,"value"in v&&(v.writable=!0),Object.defineProperty(u,v.key,v)}}function l(u,f){return(l=Object.setPrototypeOf||function(c,v){return c.__proto__=v,c})(u,f)}function p(u){var f=function(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch{return!1}}();return function(){var c,v=g(u);if(f){var m=g(this).constructor;c=Reflect.construct(v,arguments,m)}else c=v.apply(this,arguments);return d(this,c)}}function d(u,f){return!f||o(f)!=="object"&&typeof f!="function"?function(c){if(c===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return c}(u):f}function g(u){return(g=Object.setPrototypeOf?Object.getPrototypeOf:function(f){return f.__proto__||Object.getPrototypeOf(f)})(u)}var y=e("../../../utils/col-cache"),h=function(u){(function(b,w){if(typeof w!="function"&&w!==null)throw new TypeError("Super expression must either be null or a function");b.prototype=Object.create(w&&w.prototype,{constructor:{value:b,writable:!0,configurable:!0}}),w&&l(b,w)})(m,u);var f,c,v=p(m);function m(){return a(this,m),v.apply(this,arguments)}return f=m,(c=[{key:"render",value:function(b,w){if(w)if(typeof w=="string")b.leafNode("autoFilter",{ref:w});else{var _=function(I){return typeof I=="string"?I:y.getAddress(I.row,I.column).address},C=_(w.from),R=_(w.to);C&&R&&b.leafNode("autoFilter",{ref:"".concat(C,":").concat(R)})}}},{key:"parseOpen",value:function(b){b.name==="autoFilter"&&(this.model=b.attributes.ref)}},{key:"tag",get:function(){return"autoFilter"}}])&&s(f.prototype,c),m}(e("../base-xform"));n.exports=h},{"../../../utils/col-cache":19,"../base-xform":31}],72:[function(e,n,i){function o(_){return(o=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(C){return typeof C}:function(C){return C&&typeof Symbol=="function"&&C.constructor===Symbol&&C!==Symbol.prototype?"symbol":typeof C})(_)}function a(_,C){var R=Object.keys(_);if(Object.getOwnPropertySymbols){var I=Object.getOwnPropertySymbols(_);C&&(I=I.filter(function(P){return Object.getOwnPropertyDescriptor(_,P).enumerable})),R.push.apply(R,I)}return R}function s(_){for(var C=1;C<arguments.length;C++){var R=arguments[C]!=null?arguments[C]:{};C%2?a(Object(R),!0).forEach(function(I){l(_,I,R[I])}):Object.getOwnPropertyDescriptors?Object.defineProperties(_,Object.getOwnPropertyDescriptors(R)):a(Object(R)).forEach(function(I){Object.defineProperty(_,I,Object.getOwnPropertyDescriptor(R,I))})}return _}function l(_,C,R){return C in _?Object.defineProperty(_,C,{value:R,enumerable:!0,configurable:!0,writable:!0}):_[C]=R,_}function p(_,C){for(var R=0;R<C.length;R++){var I=C[R];I.enumerable=I.enumerable||!1,I.configurable=!0,"value"in I&&(I.writable=!0),Object.defineProperty(_,I.key,I)}}function d(_,C){return(d=Object.setPrototypeOf||function(R,I){return R.__proto__=I,R})(_,C)}function g(_){var C=function(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch{return!1}}();return function(){var R,I=h(_);if(C){var P=h(this).constructor;R=Reflect.construct(I,arguments,P)}else R=I.apply(this,arguments);return y(this,R)}}function y(_,C){return!C||o(C)!=="object"&&typeof C!="function"?function(R){if(R===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return R}(_):C}function h(_){return(h=Object.setPrototypeOf?Object.getPrototypeOf:function(C){return C.__proto__||Object.getPrototypeOf(C)})(_)}var u=e("../../../utils/utils"),f=e("../base-xform"),c=e("../../../doc/range"),v=e("../../../doc/enums"),m=e("../strings/rich-text-xform");function b(_){if(_==null)return v.ValueType.Null;if(_ instanceof String||typeof _=="string")return v.ValueType.String;if(typeof _=="number")return v.ValueType.Number;if(typeof _=="boolean")return v.ValueType.Boolean;if(_ instanceof Date)return v.ValueType.Date;if(_.text&&_.hyperlink)return v.ValueType.Hyperlink;if(_.formula)return v.ValueType.Formula;if(_.error)return v.ValueType.Error;throw new Error("I could not understand type of value")}var w=function(_){(function(N,A){if(typeof A!="function"&&A!==null)throw new TypeError("Super expression must either be null or a function");N.prototype=Object.create(A&&A.prototype,{constructor:{value:N,writable:!0,configurable:!0}}),A&&d(N,A)})(P,_);var C,R,I=g(P);function P(){var N;return function(A,$){if(!(A instanceof $))throw new TypeError("Cannot call a class as a function")}(this,P),(N=I.call(this)).richTextXForm=new m,N}return C=P,(R=[{key:"prepare",value:function(N,A){var $=A.styles.addStyleModel(N.style||{},function(M){switch(M.type){case v.ValueType.Formula:return b(M.result);default:return M.type}}(N));switch($&&(N.styleId=$),N.comment&&A.comments.push(s(s({},N.comment),{},{ref:N.address})),N.type){case v.ValueType.String:case v.ValueType.RichText:A.sharedStrings&&(N.ssId=A.sharedStrings.add(N.value));break;case v.ValueType.Date:A.date1904&&(N.date1904=!0);break;case v.ValueType.Hyperlink:A.sharedStrings&&N.text!==void 0&&N.text!==null&&(N.ssId=A.sharedStrings.add(N.text)),A.hyperlinks.push({address:N.address,target:N.hyperlink,tooltip:N.tooltip});break;case v.ValueType.Merge:A.merges.add(N);break;case v.ValueType.Formula:if(A.date1904&&(N.date1904=!0),N.shareType==="shared"&&(N.si=A.siFormulae++),N.formula)A.formulae[N.address]=N;else if(N.sharedFormula){var T=A.formulae[N.sharedFormula];if(!T)throw new Error("Shared Formula master must exist above and or left of clone for cell ".concat(N.address));T.si===void 0?(T.shareType="shared",T.si=A.siFormulae++,T.range=new c(T.address,N.address)):T.range&&T.range.expandToAddress(N.address),N.si=T.si}}}},{key:"renderFormula",value:function(N,A){var $=null;switch(A.shareType){case"shared":$={t:"shared",ref:A.ref||A.range.range,si:A.si};break;case"array":$={t:"array",ref:A.ref};break;default:A.si!==void 0&&($={t:"shared",si:A.si})}switch(b(A.result)){case v.ValueType.Null:N.leafNode("f",$,A.formula);break;case v.ValueType.String:N.addAttribute("t","str"),N.leafNode("f",$,A.formula),N.leafNode("v",null,A.result);break;case v.ValueType.Number:N.leafNode("f",$,A.formula),N.leafNode("v",null,A.result);break;case v.ValueType.Boolean:N.addAttribute("t","b"),N.leafNode("f",$,A.formula),N.leafNode("v",null,A.result?1:0);break;case v.ValueType.Error:N.addAttribute("t","e"),N.leafNode("f",$,A.formula),N.leafNode("v",null,A.result.error);break;case v.ValueType.Date:N.leafNode("f",$,A.formula),N.leafNode("v",null,u.dateToExcel(A.result,A.date1904));break;default:throw new Error("I could not understand type of value")}}},{key:"render",value:function(N,A){var $=this;if(A.type!==v.ValueType.Null||A.styleId){switch(N.openNode("c"),N.addAttribute("r",A.address),A.styleId&&N.addAttribute("s",A.styleId),A.type){case v.ValueType.Null:break;case v.ValueType.Number:N.leafNode("v",null,A.value);break;case v.ValueType.Boolean:N.addAttribute("t","b"),N.leafNode("v",null,A.value?"1":"0");break;case v.ValueType.Error:N.addAttribute("t","e"),N.leafNode("v",null,A.value.error);break;case v.ValueType.String:case v.ValueType.RichText:A.ssId!==void 0?(N.addAttribute("t","s"),N.leafNode("v",null,A.ssId)):A.value&&A.value.richText?(N.addAttribute("t","inlineStr"),N.openNode("is"),A.value.richText.forEach(function(T){$.richTextXForm.render(N,T)}),N.closeNode("is")):(N.addAttribute("t","str"),N.leafNode("v",null,A.value));break;case v.ValueType.Date:N.leafNode("v",null,u.dateToExcel(A.value,A.date1904));break;case v.ValueType.Hyperlink:A.ssId!==void 0?(N.addAttribute("t","s"),N.leafNode("v",null,A.ssId)):(N.addAttribute("t","str"),N.leafNode("v",null,A.text));break;case v.ValueType.Formula:this.renderFormula(N,A);break;case v.ValueType.Merge:}N.closeNode()}}},{key:"parseOpen",value:function(N){if(this.parser)return this.parser.parseOpen(N),!0;switch(N.name){case"c":return this.model={address:N.attributes.r},this.t=N.attributes.t,N.attributes.s&&(this.model.styleId=parseInt(N.attributes.s,10)),!0;case"f":return this.currentNode="f",this.model.si=N.attributes.si,this.model.shareType=N.attributes.t,this.model.ref=N.attributes.ref,!0;case"v":return this.currentNode="v",!0;case"t":return this.currentNode="t",!0;case"r":return this.parser=this.richTextXForm,this.parser.parseOpen(N),!0;default:return!1}}},{key:"parseText",value:function(N){if(this.parser)this.parser.parseText(N);else switch(this.currentNode){case"f":this.model.formula=this.model.formula?this.model.formula+N:N;break;case"v":case"t":this.model.value&&this.model.value.richText?this.model.value.richText.text=this.model.value.richText.text?this.model.value.richText.text+N:N:this.model.value=this.model.value?this.model.value+N:N}}},{key:"parseClose",value:function(N){switch(N){case"c":var A=this.model;if(A.formula||A.shareType)A.type=v.ValueType.Formula,A.value&&(this.t==="str"?A.result=u.xmlDecode(A.value):this.t==="b"?A.result=parseInt(A.value,10)!==0:this.t==="e"?A.result={error:A.value}:A.result=parseFloat(A.value),A.value=void 0);else if(A.value!==void 0)switch(this.t){case"s":A.type=v.ValueType.String,A.value=parseInt(A.value,10);break;case"str":A.type=v.ValueType.String,A.value=u.xmlDecode(A.value);break;case"inlineStr":A.type=v.ValueType.String;break;case"b":A.type=v.ValueType.Boolean,A.value=parseInt(A.value,10)!==0;break;case"e":A.type=v.ValueType.Error,A.value={error:A.value};break;default:A.type=v.ValueType.Number,A.value=parseFloat(A.value)}else A.styleId?A.type=v.ValueType.Null:A.type=v.ValueType.Merge;return!1;case"f":case"v":case"is":return this.currentNode=void 0,!0;case"t":return this.parser?(this.parser.parseClose(N),!0):(this.currentNode=void 0,!0);case"r":return this.model.value=this.model.value||{},this.model.value.richText=this.model.value.richText||[],this.model.value.richText.push(this.parser.model),this.parser=void 0,this.currentNode=void 0,!0;default:return!!this.parser&&(this.parser.parseClose(N),!0)}}},{key:"reconcile",value:function(N,A){var $=N.styleId&&A.styles&&A.styles.getStyleModel(N.styleId);switch($&&(N.style=$),N.styleId!==void 0&&(N.styleId=void 0),N.type){case v.ValueType.String:typeof N.value=="number"&&A.sharedStrings&&(N.value=A.sharedStrings.getString(N.value)),N.value.richText&&(N.type=v.ValueType.RichText);break;case v.ValueType.Number:$&&u.isDateFmt($.numFmt)&&(N.type=v.ValueType.Date,N.value=u.excelToDate(N.value,A.date1904));break;case v.ValueType.Formula:N.result!==void 0&&$&&u.isDateFmt($.numFmt)&&(N.result=u.excelToDate(N.result,A.date1904)),N.shareType==="shared"&&(N.ref?A.formulae[N.si]=N.address:(N.sharedFormula=A.formulae[N.si],delete N.shareType),delete N.si)}var T=A.hyperlinkMap[N.address];T&&(N.type===v.ValueType.Formula?(N.text=N.result,N.result=void 0):(N.text=N.value,N.value=void 0),N.type=v.ValueType.Hyperlink,N.hyperlink=T);var M=A.commentsMap&&A.commentsMap[N.address];M&&(N.comment=M)}},{key:"tag",get:function(){return"c"}}])&&p(C.prototype,R),P}(f);n.exports=w},{"../../../doc/enums":7,"../../../doc/range":10,"../../../utils/utils":26,"../base-xform":31,"../strings/rich-text-xform":121}],73:[function(e,n,i){function o(u){return(o=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(f){return typeof f}:function(f){return f&&typeof Symbol=="function"&&f.constructor===Symbol&&f!==Symbol.prototype?"symbol":typeof f})(u)}function a(u,f){if(!(u instanceof f))throw new TypeError("Cannot call a class as a function")}function s(u,f){for(var c=0;c<f.length;c++){var v=f[c];v.enumerable=v.enumerable||!1,v.configurable=!0,"value"in v&&(v.writable=!0),Object.defineProperty(u,v.key,v)}}function l(u,f){return(l=Object.setPrototypeOf||function(c,v){return c.__proto__=v,c})(u,f)}function p(u){var f=function(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch{return!1}}();return function(){var c,v=g(u);if(f){var m=g(this).constructor;c=Reflect.construct(v,arguments,m)}else c=v.apply(this,arguments);return d(this,c)}}function d(u,f){return!f||o(f)!=="object"&&typeof f!="function"?function(c){if(c===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return c}(u):f}function g(u){return(g=Object.setPrototypeOf?Object.getPrototypeOf:function(f){return f.__proto__||Object.getPrototypeOf(f)})(u)}var y=e("../../base-xform"),h=function(u){(function(b,w){if(typeof w!="function"&&w!==null)throw new TypeError("Super expression must either be null or a function");b.prototype=Object.create(w&&w.prototype,{constructor:{value:b,writable:!0,configurable:!0}}),w&&l(b,w)})(m,u);var f,c,v=p(m);function m(){return a(this,m),v.apply(this,arguments)}return f=m,(c=[{key:"render",value:function(b,w){b.leafNode(this.tag,{iconSet:w.iconSet,iconId:w.iconId})}},{key:"parseOpen",value:function(b){var w=b.attributes;this.model={iconSet:w.iconSet,iconId:y.toIntValue(w.iconId)}}},{key:"parseClose",value:function(b){return b!==this.tag}},{key:"tag",get:function(){return"x14:cfIcon"}}])&&s(f.prototype,c),m}(y);n.exports=h},{"../../base-xform":31}],74:[function(e,n,i){function o(m){return(o=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(b){return typeof b}:function(b){return b&&typeof Symbol=="function"&&b.constructor===Symbol&&b!==Symbol.prototype?"symbol":typeof b})(m)}function a(m,b){for(var w=0;w<b.length;w++){var _=b[w];_.enumerable=_.enumerable||!1,_.configurable=!0,"value"in _&&(_.writable=!0),Object.defineProperty(m,_.key,_)}}function s(m,b){return(s=Object.setPrototypeOf||function(w,_){return w.__proto__=_,w})(m,b)}function l(m){var b=function(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch{return!1}}();return function(){var w,_=d(m);if(b){var C=d(this).constructor;w=Reflect.construct(_,arguments,C)}else w=_.apply(this,arguments);return p(this,w)}}function p(m,b){return!b||o(b)!=="object"&&typeof b!="function"?function(w){if(w===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return w}(m):b}function d(m){return(d=Object.setPrototypeOf?Object.getPrototypeOf:function(b){return b.__proto__||Object.getPrototypeOf(b)})(m)}var g=e("uuid").v4,y=e("../../base-xform"),h=e("../../composite-xform"),u=e("./databar-ext-xform"),f=e("./icon-set-ext-xform"),c={"3Triangles":!0,"3Stars":!0,"5Boxes":!0},v=function(m){(function(I,P){if(typeof P!="function"&&P!==null)throw new TypeError("Super expression must either be null or a function");I.prototype=Object.create(P&&P.prototype,{constructor:{value:I,writable:!0,configurable:!0}}),P&&s(I,P)})(R,m);var b,w,_,C=l(R);function R(){var I;return function(P,N){if(!(P instanceof N))throw new TypeError("Cannot call a class as a function")}(this,R),(I=C.call(this)).map={"x14:dataBar":I.databarXform=new u,"x14:iconSet":I.iconSetXform=new f},I}return b=R,_=[{key:"isExt",value:function(I){return I.type==="dataBar"?u.isExt(I):!(I.type!=="iconSet"||!I.custom&&!c[I.iconSet])}}],(w=[{key:"prepare",value:function(I){R.isExt(I)&&(I.x14Id="{".concat(g(),"}").toUpperCase())}},{key:"render",value:function(I,P){if(R.isExt(P))switch(P.type){case"dataBar":this.renderDataBar(I,P);break;case"iconSet":this.renderIconSet(I,P)}}},{key:"renderDataBar",value:function(I,P){I.openNode(this.tag,{type:"dataBar",id:P.x14Id}),this.databarXform.render(I,P),I.closeNode()}},{key:"renderIconSet",value:function(I,P){I.openNode(this.tag,{type:"iconSet",priority:P.priority,id:P.x14Id||"{".concat(g(),"}")}),this.iconSetXform.render(I,P),I.closeNode()}},{key:"createNewModel",value:function(I){var P=I.attributes;return{type:P.type,x14Id:P.id,priority:y.toIntValue(P.priority)}}},{key:"onParserClose",value:function(I,P){Object.assign(this.model,P.model)}},{key:"tag",get:function(){return"x14:cfRule"}}])&&a(b.prototype,w),_&&a(b,_),R}(h);n.exports=v},{"../../base-xform":31,"../../composite-xform":47,"./databar-ext-xform":78,"./icon-set-ext-xform":80,uuid:526}],75:[function(e,n,i){function o(u){return(o=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(f){return typeof f}:function(f){return f&&typeof Symbol=="function"&&f.constructor===Symbol&&f!==Symbol.prototype?"symbol":typeof f})(u)}function a(u,f){for(var c=0;c<f.length;c++){var v=f[c];v.enumerable=v.enumerable||!1,v.configurable=!0,"value"in v&&(v.writable=!0),Object.defineProperty(u,v.key,v)}}function s(u,f){return(s=Object.setPrototypeOf||function(c,v){return c.__proto__=v,c})(u,f)}function l(u){var f=function(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch{return!1}}();return function(){var c,v=d(u);if(f){var m=d(this).constructor;c=Reflect.construct(v,arguments,m)}else c=v.apply(this,arguments);return p(this,c)}}function p(u,f){return!f||o(f)!=="object"&&typeof f!="function"?function(c){if(c===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return c}(u):f}function d(u){return(d=Object.setPrototypeOf?Object.getPrototypeOf:function(f){return f.__proto__||Object.getPrototypeOf(f)})(u)}var g=e("../../composite-xform"),y=e("./f-ext-xform"),h=function(u){(function(b,w){if(typeof w!="function"&&w!==null)throw new TypeError("Super expression must either be null or a function");b.prototype=Object.create(w&&w.prototype,{constructor:{value:b,writable:!0,configurable:!0}}),w&&s(b,w)})(m,u);var f,c,v=l(m);function m(){var b;return function(w,_){if(!(w instanceof _))throw new TypeError("Cannot call a class as a function")}(this,m),(b=v.call(this)).map={"xm:f":b.fExtXform=new y},b}return f=m,(c=[{key:"render",value:function(b,w){b.openNode(this.tag,{type:w.type}),w.value!==void 0&&this.fExtXform.render(b,w.value),b.closeNode()}},{key:"createNewModel",value:function(b){return{type:b.attributes.type}}},{key:"onParserClose",value:function(b,w){switch(b){case"xm:f":this.model.value=w.model?parseFloat(w.model):0}}},{key:"tag",get:function(){return"x14:cfvo"}}])&&a(f.prototype,c),m}(g);n.exports=h},{"../../composite-xform":47,"./f-ext-xform":79}],76:[function(e,n,i){function o(f){return(o=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(c){return typeof c}:function(c){return c&&typeof Symbol=="function"&&c.constructor===Symbol&&c!==Symbol.prototype?"symbol":typeof c})(f)}function a(f,c){for(var v=0;v<c.length;v++){var m=c[v];m.enumerable=m.enumerable||!1,m.configurable=!0,"value"in m&&(m.writable=!0),Object.defineProperty(f,m.key,m)}}function s(f,c){return(s=Object.setPrototypeOf||function(v,m){return v.__proto__=m,v})(f,c)}function l(f){var c=function(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch{return!1}}();return function(){var v,m=d(f);if(c){var b=d(this).constructor;v=Reflect.construct(m,arguments,b)}else v=m.apply(this,arguments);return p(this,v)}}function p(f,c){return!c||o(c)!=="object"&&typeof c!="function"?function(v){if(v===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return v}(f):c}function d(f){return(d=Object.setPrototypeOf?Object.getPrototypeOf:function(c){return c.__proto__||Object.getPrototypeOf(c)})(f)}var g=e("../../composite-xform"),y=e("./sqref-ext-xform"),h=e("./cf-rule-ext-xform"),u=function(f){(function(w,_){if(typeof _!="function"&&_!==null)throw new TypeError("Super expression must either be null or a function");w.prototype=Object.create(_&&_.prototype,{constructor:{value:w,writable:!0,configurable:!0}}),_&&s(w,_)})(b,f);var c,v,m=l(b);function b(){var w;return function(_,C){if(!(_ instanceof C))throw new TypeError("Cannot call a class as a function")}(this,b),(w=m.call(this)).map={"xm:sqref":w.sqRef=new y,"x14:cfRule":w.cfRule=new h},w}return c=b,(v=[{key:"prepare",value:function(w,_){var C=this;w.rules.forEach(function(R){C.cfRule.prepare(R,_)})}},{key:"render",value:function(w,_){var C=this;_.rules.some(h.isExt)&&(w.openNode(this.tag,{"xmlns:xm":"http://schemas.microsoft.com/office/excel/2006/main"}),_.rules.filter(h.isExt).forEach(function(R){return C.cfRule.render(w,R)}),this.sqRef.render(w,_.ref),w.closeNode())}},{key:"createNewModel",value:function(){return{rules:[]}}},{key:"onParserClose",value:function(w,_){switch(w){case"xm:sqref":this.model.ref=_.model;break;case"x14:cfRule":this.model.rules.push(_.model)}}},{key:"tag",get:function(){return"x14:conditionalFormatting"}}])&&a(c.prototype,v),b}(g);n.exports=u},{"../../composite-xform":47,"./cf-rule-ext-xform":74,"./sqref-ext-xform":81}],77:[function(e,n,i){function o(f){return(o=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(c){return typeof c}:function(c){return c&&typeof Symbol=="function"&&c.constructor===Symbol&&c!==Symbol.prototype?"symbol":typeof c})(f)}function a(f,c){for(var v=0;v<c.length;v++){var m=c[v];m.enumerable=m.enumerable||!1,m.configurable=!0,"value"in m&&(m.writable=!0),Object.defineProperty(f,m.key,m)}}function s(f,c){return(s=Object.setPrototypeOf||function(v,m){return v.__proto__=m,v})(f,c)}function l(f){var c=function(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch{return!1}}();return function(){var v,m=d(f);if(c){var b=d(this).constructor;v=Reflect.construct(m,arguments,b)}else v=m.apply(this,arguments);return p(this,v)}}function p(f,c){return!c||o(c)!=="object"&&typeof c!="function"?function(v){if(v===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return v}(f):c}function d(f){return(d=Object.setPrototypeOf?Object.getPrototypeOf:function(c){return c.__proto__||Object.getPrototypeOf(c)})(f)}var g=e("../../composite-xform"),y=e("./cf-rule-ext-xform"),h=e("./conditional-formatting-ext-xform"),u=function(f){(function(w,_){if(typeof _!="function"&&_!==null)throw new TypeError("Super expression must either be null or a function");w.prototype=Object.create(_&&_.prototype,{constructor:{value:w,writable:!0,configurable:!0}}),_&&s(w,_)})(b,f);var c,v,m=l(b);function b(){var w;return function(_,C){if(!(_ instanceof C))throw new TypeError("Cannot call a class as a function")}(this,b),(w=m.call(this)).map={"x14:conditionalFormatting":w.cfXform=new h},w}return c=b,(v=[{key:"hasContent",value:function(w){return w.hasExtContent===void 0&&(w.hasExtContent=w.some(function(_){return _.rules.some(y.isExt)})),w.hasExtContent}},{key:"prepare",value:function(w,_){var C=this;w.forEach(function(R){C.cfXform.prepare(R,_)})}},{key:"render",value:function(w,_){var C=this;this.hasContent(_)&&(w.openNode(this.tag),_.forEach(function(R){return C.cfXform.render(w,R)}),w.closeNode())}},{key:"createNewModel",value:function(){return[]}},{key:"onParserClose",value:function(w,_){this.model.push(_.model)}},{key:"tag",get:function(){return"x14:conditionalFormattings"}}])&&a(c.prototype,v),b}(g);n.exports=u},{"../../composite-xform":47,"./cf-rule-ext-xform":74,"./conditional-formatting-ext-xform":76}],78:[function(e,n,i){function o(m){return(o=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(b){return typeof b}:function(b){return b&&typeof Symbol=="function"&&b.constructor===Symbol&&b!==Symbol.prototype?"symbol":typeof b})(m)}function a(m,b){return function(w){if(Array.isArray(w))return w}(m)||function(w,_){if(!(typeof Symbol=="undefined"||!(Symbol.iterator in Object(w)))){var C=[],R=!0,I=!1,P=void 0;try{for(var N,A=w[Symbol.iterator]();!(R=(N=A.next()).done)&&(C.push(N.value),!_||C.length!==_);R=!0);}catch($){I=!0,P=$}finally{try{R||A.return==null||A.return()}finally{if(I)throw P}}return C}}(m,b)||function(w,_){if(!!w){if(typeof w=="string")return s(w,_);var C=Object.prototype.toString.call(w).slice(8,-1);if(C==="Object"&&w.constructor&&(C=w.constructor.name),C==="Map"||C==="Set")return Array.from(w);if(C==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(C))return s(w,_)}}(m,b)||function(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}()}function s(m,b){(b==null||b>m.length)&&(b=m.length);for(var w=0,_=new Array(b);w<b;w++)_[w]=m[w];return _}function l(m,b){for(var w=0;w<b.length;w++){var _=b[w];_.enumerable=_.enumerable||!1,_.configurable=!0,"value"in _&&(_.writable=!0),Object.defineProperty(m,_.key,_)}}function p(m,b){return(p=Object.setPrototypeOf||function(w,_){return w.__proto__=_,w})(m,b)}function d(m){var b=function(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch{return!1}}();return function(){var w,_=y(m);if(b){var C=y(this).constructor;w=Reflect.construct(_,arguments,C)}else w=_.apply(this,arguments);return g(this,w)}}function g(m,b){return!b||o(b)!=="object"&&typeof b!="function"?function(w){if(w===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return w}(m):b}function y(m){return(y=Object.setPrototypeOf?Object.getPrototypeOf:function(b){return b.__proto__||Object.getPrototypeOf(b)})(m)}var h=e("../../base-xform"),u=e("../../composite-xform"),f=e("../../style/color-xform"),c=e("./cfvo-ext-xform"),v=function(m){(function(I,P){if(typeof P!="function"&&P!==null)throw new TypeError("Super expression must either be null or a function");I.prototype=Object.create(P&&P.prototype,{constructor:{value:I,writable:!0,configurable:!0}}),P&&p(I,P)})(R,m);var b,w,_,C=d(R);function R(){var I;return function(P,N){if(!(P instanceof N))throw new TypeError("Cannot call a class as a function")}(this,R),(I=C.call(this)).map={"x14:cfvo":I.cfvoXform=new c,"x14:borderColor":I.borderColorXform=new f("x14:borderColor"),"x14:negativeBorderColor":I.negativeBorderColorXform=new f("x14:negativeBorderColor"),"x14:negativeFillColor":I.negativeFillColorXform=new f("x14:negativeFillColor"),"x14:axisColor":I.axisColorXform=new f("x14:axisColor")},I}return b=R,_=[{key:"isExt",value:function(I){return!I.gradient}}],(w=[{key:"render",value:function(I,P){var N=this;I.openNode(this.tag,{minLength:h.toIntAttribute(P.minLength,0,!0),maxLength:h.toIntAttribute(P.maxLength,100,!0),border:h.toBoolAttribute(P.border,!1),gradient:h.toBoolAttribute(P.gradient,!0),negativeBarColorSameAsPositive:h.toBoolAttribute(P.negativeBarColorSameAsPositive,!0),negativeBarBorderColorSameAsPositive:h.toBoolAttribute(P.negativeBarBorderColorSameAsPositive,!0),axisPosition:h.toAttribute(P.axisPosition,"auto"),direction:h.toAttribute(P.direction,"leftToRight")}),P.cfvo.forEach(function(A){N.cfvoXform.render(I,A)}),this.borderColorXform.render(I,P.borderColor),this.negativeBorderColorXform.render(I,P.negativeBorderColor),this.negativeFillColorXform.render(I,P.negativeFillColor),this.axisColorXform.render(I,P.axisColor),I.closeNode()}},{key:"createNewModel",value:function(I){var P=I.attributes;return{cfvo:[],minLength:h.toIntValue(P.minLength,0),maxLength:h.toIntValue(P.maxLength,100),border:h.toBoolValue(P.border,!1),gradient:h.toBoolValue(P.gradient,!0),negativeBarColorSameAsPositive:h.toBoolValue(P.negativeBarColorSameAsPositive,!0),negativeBarBorderColorSameAsPositive:h.toBoolValue(P.negativeBarBorderColorSameAsPositive,!0),axisPosition:h.toStringValue(P.axisPosition,"auto"),direction:h.toStringValue(P.direction,"leftToRight")}}},{key:"onParserClose",value:function(I,P){var N=a(I.split(":"),2)[1];switch(N){case"cfvo":this.model.cfvo.push(P.model);break;default:this.model[N]=P.model}}},{key:"tag",get:function(){return"x14:dataBar"}}])&&l(b.prototype,w),_&&l(b,_),R}(u);n.exports=v},{"../../base-xform":31,"../../composite-xform":47,"../../style/color-xform":127,"./cfvo-ext-xform":75}],79:[function(e,n,i){function o(h){return(o=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(u){return typeof u}:function(u){return u&&typeof Symbol=="function"&&u.constructor===Symbol&&u!==Symbol.prototype?"symbol":typeof u})(h)}function a(h,u){if(!(h instanceof u))throw new TypeError("Cannot call a class as a function")}function s(h,u){for(var f=0;f<u.length;f++){var c=u[f];c.enumerable=c.enumerable||!1,c.configurable=!0,"value"in c&&(c.writable=!0),Object.defineProperty(h,c.key,c)}}function l(h,u){return(l=Object.setPrototypeOf||function(f,c){return f.__proto__=c,f})(h,u)}function p(h){var u=function(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch{return!1}}();return function(){var f,c=g(h);if(u){var v=g(this).constructor;f=Reflect.construct(c,arguments,v)}else f=c.apply(this,arguments);return d(this,f)}}function d(h,u){return!u||o(u)!=="object"&&typeof u!="function"?function(f){if(f===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return f}(h):u}function g(h){return(g=Object.setPrototypeOf?Object.getPrototypeOf:function(u){return u.__proto__||Object.getPrototypeOf(u)})(h)}var y=function(h){(function(m,b){if(typeof b!="function"&&b!==null)throw new TypeError("Super expression must either be null or a function");m.prototype=Object.create(b&&b.prototype,{constructor:{value:m,writable:!0,configurable:!0}}),b&&l(m,b)})(v,h);var u,f,c=p(v);function v(){return a(this,v),c.apply(this,arguments)}return u=v,(f=[{key:"render",value:function(m,b){m.leafNode(this.tag,null,b)}},{key:"parseOpen",value:function(){this.model=""}},{key:"parseText",value:function(m){this.model+=m}},{key:"parseClose",value:function(m){return m!==this.tag}},{key:"tag",get:function(){return"xm:f"}}])&&s(u.prototype,f),v}(e("../../base-xform"));n.exports=y},{"../../base-xform":31}],80:[function(e,n,i){function o(m){return(o=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(b){return typeof b}:function(b){return b&&typeof Symbol=="function"&&b.constructor===Symbol&&b!==Symbol.prototype?"symbol":typeof b})(m)}function a(m,b){return function(w){if(Array.isArray(w))return w}(m)||function(w,_){if(!(typeof Symbol=="undefined"||!(Symbol.iterator in Object(w)))){var C=[],R=!0,I=!1,P=void 0;try{for(var N,A=w[Symbol.iterator]();!(R=(N=A.next()).done)&&(C.push(N.value),!_||C.length!==_);R=!0);}catch($){I=!0,P=$}finally{try{R||A.return==null||A.return()}finally{if(I)throw P}}return C}}(m,b)||function(w,_){if(!!w){if(typeof w=="string")return s(w,_);var C=Object.prototype.toString.call(w).slice(8,-1);if(C==="Object"&&w.constructor&&(C=w.constructor.name),C==="Map"||C==="Set")return Array.from(w);if(C==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(C))return s(w,_)}}(m,b)||function(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}()}function s(m,b){(b==null||b>m.length)&&(b=m.length);for(var w=0,_=new Array(b);w<b;w++)_[w]=m[w];return _}function l(m,b){for(var w=0;w<b.length;w++){var _=b[w];_.enumerable=_.enumerable||!1,_.configurable=!0,"value"in _&&(_.writable=!0),Object.defineProperty(m,_.key,_)}}function p(m,b){return(p=Object.setPrototypeOf||function(w,_){return w.__proto__=_,w})(m,b)}function d(m){var b=function(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch{return!1}}();return function(){var w,_=y(m);if(b){var C=y(this).constructor;w=Reflect.construct(_,arguments,C)}else w=_.apply(this,arguments);return g(this,w)}}function g(m,b){return!b||o(b)!=="object"&&typeof b!="function"?function(w){if(w===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return w}(m):b}function y(m){return(y=Object.setPrototypeOf?Object.getPrototypeOf:function(b){return b.__proto__||Object.getPrototypeOf(b)})(m)}var h=e("../../base-xform"),u=e("../../composite-xform"),f=e("./cfvo-ext-xform"),c=e("./cf-icon-ext-xform"),v=function(m){(function(R,I){if(typeof I!="function"&&I!==null)throw new TypeError("Super expression must either be null or a function");R.prototype=Object.create(I&&I.prototype,{constructor:{value:R,writable:!0,configurable:!0}}),I&&p(R,I)})(C,m);var b,w,_=d(C);function C(){var R;return function(I,P){if(!(I instanceof P))throw new TypeError("Cannot call a class as a function")}(this,C),(R=_.call(this)).map={"x14:cfvo":R.cfvoXform=new f,"x14:cfIcon":R.cfIconXform=new c},R}return b=C,(w=[{key:"render",value:function(R,I){var P=this;R.openNode(this.tag,{iconSet:h.toStringAttribute(I.iconSet),reverse:h.toBoolAttribute(I.reverse,!1),showValue:h.toBoolAttribute(I.showValue,!0),custom:h.toBoolAttribute(I.icons,!1)}),I.cfvo.forEach(function(N){P.cfvoXform.render(R,N)}),I.icons&&I.icons.forEach(function(N,A){N.iconId=A,P.cfIconXform.render(R,N)}),R.closeNode()}},{key:"createNewModel",value:function(R){var I=R.attributes;return{cfvo:[],iconSet:h.toStringValue(I.iconSet,"3TrafficLights"),reverse:h.toBoolValue(I.reverse,!1),showValue:h.toBoolValue(I.showValue,!0)}}},{key:"onParserClose",value:function(R,I){var P=a(R.split(":"),2)[1];switch(P){case"cfvo":this.model.cfvo.push(I.model);break;case"cfIcon":this.model.icons||(this.model.icons=[]),this.model.icons.push(I.model);break;default:this.model[P]=I.model}}},{key:"tag",get:function(){return"x14:iconSet"}}])&&l(b.prototype,w),C}(u);n.exports=v},{"../../base-xform":31,"../../composite-xform":47,"./cf-icon-ext-xform":73,"./cfvo-ext-xform":75}],81:[function(e,n,i){function o(h){return(o=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(u){return typeof u}:function(u){return u&&typeof Symbol=="function"&&u.constructor===Symbol&&u!==Symbol.prototype?"symbol":typeof u})(h)}function a(h,u){if(!(h instanceof u))throw new TypeError("Cannot call a class as a function")}function s(h,u){for(var f=0;f<u.length;f++){var c=u[f];c.enumerable=c.enumerable||!1,c.configurable=!0,"value"in c&&(c.writable=!0),Object.defineProperty(h,c.key,c)}}function l(h,u){return(l=Object.setPrototypeOf||function(f,c){return f.__proto__=c,f})(h,u)}function p(h){var u=function(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch{return!1}}();return function(){var f,c=g(h);if(u){var v=g(this).constructor;f=Reflect.construct(c,arguments,v)}else f=c.apply(this,arguments);return d(this,f)}}function d(h,u){return!u||o(u)!=="object"&&typeof u!="function"?function(f){if(f===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return f}(h):u}function g(h){return(g=Object.setPrototypeOf?Object.getPrototypeOf:function(u){return u.__proto__||Object.getPrototypeOf(u)})(h)}var y=function(h){(function(m,b){if(typeof b!="function"&&b!==null)throw new TypeError("Super expression must either be null or a function");m.prototype=Object.create(b&&b.prototype,{constructor:{value:m,writable:!0,configurable:!0}}),b&&l(m,b)})(v,h);var u,f,c=p(v);function v(){return a(this,v),c.apply(this,arguments)}return u=v,(f=[{key:"render",value:function(m,b){m.leafNode(this.tag,null,b)}},{key:"parseOpen",value:function(){this.model=""}},{key:"parseText",value:function(m){this.model+=m}},{key:"parseClose",value:function(m){return m!==this.tag}},{key:"tag",get:function(){return"xm:sqref"}}])&&s(u.prototype,f),v}(e("../../base-xform"));n.exports=y},{"../../base-xform":31}],82:[function(e,n,i){function o(I){return(o=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(P){return typeof P}:function(P){return P&&typeof Symbol=="function"&&P.constructor===Symbol&&P!==Symbol.prototype?"symbol":typeof P})(I)}function a(I,P){var N=Object.keys(I);if(Object.getOwnPropertySymbols){var A=Object.getOwnPropertySymbols(I);P&&(A=A.filter(function($){return Object.getOwnPropertyDescriptor(I,$).enumerable})),N.push.apply(N,A)}return N}function s(I){for(var P=1;P<arguments.length;P++){var N=arguments[P]!=null?arguments[P]:{};P%2?a(Object(N),!0).forEach(function(A){l(I,A,N[A])}):Object.getOwnPropertyDescriptors?Object.defineProperties(I,Object.getOwnPropertyDescriptors(N)):a(Object(N)).forEach(function(A){Object.defineProperty(I,A,Object.getOwnPropertyDescriptor(N,A))})}return I}function l(I,P,N){return P in I?Object.defineProperty(I,P,{value:N,enumerable:!0,configurable:!0,writable:!0}):I[P]=N,I}function p(I,P){for(var N=0;N<P.length;N++){var A=P[N];A.enumerable=A.enumerable||!1,A.configurable=!0,"value"in A&&(A.writable=!0),Object.defineProperty(I,A.key,A)}}function d(I,P){return(d=Object.setPrototypeOf||function(N,A){return N.__proto__=A,N})(I,P)}function g(I){var P=function(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch{return!1}}();return function(){var N,A=h(I);if(P){var $=h(this).constructor;N=Reflect.construct(A,arguments,$)}else N=A.apply(this,arguments);return y(this,N)}}function y(I,P){return!P||o(P)!=="object"&&typeof P!="function"?function(N){if(N===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return N}(I):P}function h(I){return(h=Object.setPrototypeOf?Object.getPrototypeOf:function(P){return P.__proto__||Object.getPrototypeOf(P)})(I)}var u=e("../../base-xform"),f=e("../../composite-xform"),c=e("../../../../doc/range"),v=e("./databar-xform"),m=e("./ext-lst-ref-xform"),b=e("./formula-xform"),w=e("./color-scale-xform"),_=e("./icon-set-xform"),C={"3Triangles":!0,"3Stars":!0,"5Boxes":!0},R=function(I){(function(M,S){if(typeof S!="function"&&S!==null)throw new TypeError("Super expression must either be null or a function");M.prototype=Object.create(S&&S.prototype,{constructor:{value:M,writable:!0,configurable:!0}}),S&&d(M,S)})(T,I);var P,N,A,$=g(T);function T(){var M;return function(S,E){if(!(S instanceof E))throw new TypeError("Cannot call a class as a function")}(this,T),(M=$.call(this)).map={dataBar:M.databarXform=new v,extLst:M.extLstRefXform=new m,formula:M.formulaXform=new b,colorScale:M.colorScaleXform=new w,iconSet:M.iconSetXform=new _},M}return P=T,A=[{key:"isPrimitive",value:function(M){return M.type!=="iconSet"||!M.custom&&!C[M.iconSet]}}],(N=[{key:"render",value:function(M,S){switch(S.type){case"expression":this.renderExpression(M,S);break;case"cellIs":this.renderCellIs(M,S);break;case"top10":this.renderTop10(M,S);break;case"aboveAverage":this.renderAboveAverage(M,S);break;case"dataBar":this.renderDataBar(M,S);break;case"colorScale":this.renderColorScale(M,S);break;case"iconSet":this.renderIconSet(M,S);break;case"containsText":this.renderText(M,S);break;case"timePeriod":this.renderTimePeriod(M,S)}}},{key:"renderExpression",value:function(M,S){M.openNode(this.tag,{type:"expression",dxfId:S.dxfId,priority:S.priority}),this.formulaXform.render(M,S.formulae[0]),M.closeNode()}},{key:"renderCellIs",value:function(M,S){var E=this;M.openNode(this.tag,{type:"cellIs",dxfId:S.dxfId,priority:S.priority,operator:S.operator}),S.formulae.forEach(function(k){E.formulaXform.render(M,k)}),M.closeNode()}},{key:"renderTop10",value:function(M,S){M.leafNode(this.tag,{type:"top10",dxfId:S.dxfId,priority:S.priority,percent:u.toBoolAttribute(S.percent,!1),bottom:u.toBoolAttribute(S.bottom,!1),rank:u.toIntValue(S.rank,10,!0)})}},{key:"renderAboveAverage",value:function(M,S){M.leafNode(this.tag,{type:"aboveAverage",dxfId:S.dxfId,priority:S.priority,aboveAverage:u.toBoolAttribute(S.aboveAverage,!0)})}},{key:"renderDataBar",value:function(M,S){M.openNode(this.tag,{type:"dataBar",priority:S.priority}),this.databarXform.render(M,S),this.extLstRefXform.render(M,S),M.closeNode()}},{key:"renderColorScale",value:function(M,S){M.openNode(this.tag,{type:"colorScale",priority:S.priority}),this.colorScaleXform.render(M,S),M.closeNode()}},{key:"renderIconSet",value:function(M,S){T.isPrimitive(S)&&(M.openNode(this.tag,{type:"iconSet",priority:S.priority}),this.iconSetXform.render(M,S),M.closeNode())}},{key:"renderText",value:function(M,S){M.openNode(this.tag,{type:S.operator,dxfId:S.dxfId,priority:S.priority,operator:u.toStringAttribute(S.operator,"containsText")});var E=function(k){if(k.formulae&&k.formulae[0])return k.formulae[0];var O=new c(k.ref).tl;switch(k.operator){case"containsText":return'NOT(ISERROR(SEARCH("'.concat(k.text,'",').concat(O,")))");case"containsBlanks":return"LEN(TRIM(".concat(O,"))=0");case"notContainsBlanks":return"LEN(TRIM(".concat(O,"))>0");case"containsErrors":return"ISERROR(".concat(O,")");case"notContainsErrors":return"NOT(ISERROR(".concat(O,"))");default:return}}(S);E&&this.formulaXform.render(M,E),M.closeNode()}},{key:"renderTimePeriod",value:function(M,S){M.openNode(this.tag,{type:"timePeriod",dxfId:S.dxfId,priority:S.priority,timePeriod:S.timePeriod});var E=function(k){if(k.formulae&&k.formulae[0])return k.formulae[0];var O=new c(k.ref).tl;switch(k.timePeriod){case"thisWeek":return"AND(TODAY()-ROUNDDOWN(".concat(O,",0)<=WEEKDAY(TODAY())-1,ROUNDDOWN(").concat(O,",0)-TODAY()<=7-WEEKDAY(TODAY()))");case"lastWeek":return"AND(TODAY()-ROUNDDOWN(".concat(O,",0)>=(WEEKDAY(TODAY())),TODAY()-ROUNDDOWN(").concat(O,",0)<(WEEKDAY(TODAY())+7))");case"nextWeek":return"AND(ROUNDDOWN(".concat(O,",0)-TODAY()>(7-WEEKDAY(TODAY())),ROUNDDOWN(").concat(O,",0)-TODAY()<(15-WEEKDAY(TODAY())))");case"yesterday":return"FLOOR(".concat(O,",1)=TODAY()-1");case"today":return"FLOOR(".concat(O,",1)=TODAY()");case"tomorrow":return"FLOOR(".concat(O,",1)=TODAY()+1");case"last7Days":return"AND(TODAY()-FLOOR(".concat(O,",1)<=6,FLOOR(").concat(O,",1)<=TODAY())");case"lastMonth":return"AND(MONTH(".concat(O,")=MONTH(EDATE(TODAY(),0-1)),YEAR(").concat(O,")=YEAR(EDATE(TODAY(),0-1)))");case"thisMonth":return"AND(MONTH(".concat(O,")=MONTH(TODAY()),YEAR(").concat(O,")=YEAR(TODAY()))");case"nextMonth":return"AND(MONTH(".concat(O,")=MONTH(EDATE(TODAY(),0+1)),YEAR(").concat(O,")=YEAR(EDATE(TODAY(),0+1)))");default:return}}(S);E&&this.formulaXform.render(M,E),M.closeNode()}},{key:"createNewModel",value:function(M){var S=M.attributes;return s(s({},function(E){var k=E.type,O=E.operator;switch(k){case"containsText":case"containsBlanks":case"notContainsBlanks":case"containsErrors":case"notContainsErrors":return{type:"containsText",operator:k};default:return{type:k,operator:O}}}(S)),{},{dxfId:u.toIntValue(S.dxfId),priority:u.toIntValue(S.priority),timePeriod:S.timePeriod,percent:u.toBoolValue(S.percent),bottom:u.toBoolValue(S.bottom),rank:u.toIntValue(S.rank),aboveAverage:u.toBoolValue(S.aboveAverage)})}},{key:"onParserClose",value:function(M,S){switch(M){case"dataBar":case"extLst":case"colorScale":case"iconSet":Object.assign(this.model,S.model);break;case"formula":this.model.formulae=this.model.formulae||[],this.model.formulae.push(S.model)}}},{key:"tag",get:function(){return"cfRule"}}])&&p(P.prototype,N),A&&p(P,A),T}(f);n.exports=R},{"../../../../doc/range":10,"../../base-xform":31,"../../composite-xform":47,"./color-scale-xform":84,"./databar-xform":87,"./ext-lst-ref-xform":88,"./formula-xform":89,"./icon-set-xform":90}],83:[function(e,n,i){function o(u){return(o=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(f){return typeof f}:function(f){return f&&typeof Symbol=="function"&&f.constructor===Symbol&&f!==Symbol.prototype?"symbol":typeof f})(u)}function a(u,f){if(!(u instanceof f))throw new TypeError("Cannot call a class as a function")}function s(u,f){for(var c=0;c<f.length;c++){var v=f[c];v.enumerable=v.enumerable||!1,v.configurable=!0,"value"in v&&(v.writable=!0),Object.defineProperty(u,v.key,v)}}function l(u,f){return(l=Object.setPrototypeOf||function(c,v){return c.__proto__=v,c})(u,f)}function p(u){var f=function(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch{return!1}}();return function(){var c,v=g(u);if(f){var m=g(this).constructor;c=Reflect.construct(v,arguments,m)}else c=v.apply(this,arguments);return d(this,c)}}function d(u,f){return!f||o(f)!=="object"&&typeof f!="function"?function(c){if(c===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return c}(u):f}function g(u){return(g=Object.setPrototypeOf?Object.getPrototypeOf:function(f){return f.__proto__||Object.getPrototypeOf(f)})(u)}var y=e("../../base-xform"),h=function(u){(function(b,w){if(typeof w!="function"&&w!==null)throw new TypeError("Super expression must either be null or a function");b.prototype=Object.create(w&&w.prototype,{constructor:{value:b,writable:!0,configurable:!0}}),w&&l(b,w)})(m,u);var f,c,v=p(m);function m(){return a(this,m),v.apply(this,arguments)}return f=m,(c=[{key:"render",value:function(b,w){b.leafNode(this.tag,{type:w.type,val:w.value})}},{key:"parseOpen",value:function(b){this.model={type:b.attributes.type,value:y.toFloatValue(b.attributes.val)}}},{key:"parseClose",value:function(b){return b!==this.tag}},{key:"tag",get:function(){return"cfvo"}}])&&s(f.prototype,c),m}(y);n.exports=h},{"../../base-xform":31}],84:[function(e,n,i){function o(f){return(o=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(c){return typeof c}:function(c){return c&&typeof Symbol=="function"&&c.constructor===Symbol&&c!==Symbol.prototype?"symbol":typeof c})(f)}function a(f,c){for(var v=0;v<c.length;v++){var m=c[v];m.enumerable=m.enumerable||!1,m.configurable=!0,"value"in m&&(m.writable=!0),Object.defineProperty(f,m.key,m)}}function s(f,c){return(s=Object.setPrototypeOf||function(v,m){return v.__proto__=m,v})(f,c)}function l(f){var c=function(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch{return!1}}();return function(){var v,m=d(f);if(c){var b=d(this).constructor;v=Reflect.construct(m,arguments,b)}else v=m.apply(this,arguments);return p(this,v)}}function p(f,c){return!c||o(c)!=="object"&&typeof c!="function"?function(v){if(v===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return v}(f):c}function d(f){return(d=Object.setPrototypeOf?Object.getPrototypeOf:function(c){return c.__proto__||Object.getPrototypeOf(c)})(f)}var g=e("../../composite-xform"),y=e("../../style/color-xform"),h=e("./cfvo-xform"),u=function(f){(function(w,_){if(typeof _!="function"&&_!==null)throw new TypeError("Super expression must either be null or a function");w.prototype=Object.create(_&&_.prototype,{constructor:{value:w,writable:!0,configurable:!0}}),_&&s(w,_)})(b,f);var c,v,m=l(b);function b(){var w;return function(_,C){if(!(_ instanceof C))throw new TypeError("Cannot call a class as a function")}(this,b),(w=m.call(this)).map={cfvo:w.cfvoXform=new h,color:w.colorXform=new y},w}return c=b,(v=[{key:"render",value:function(w,_){var C=this;w.openNode(this.tag),_.cfvo.forEach(function(R){C.cfvoXform.render(w,R)}),_.color.forEach(function(R){C.colorXform.render(w,R)}),w.closeNode()}},{key:"createNewModel",value:function(w){return{cfvo:[],color:[]}}},{key:"onParserClose",value:function(w,_){this.model[w].push(_.model)}},{key:"tag",get:function(){return"colorScale"}}])&&a(c.prototype,v),b}(g);n.exports=u},{"../../composite-xform":47,"../../style/color-xform":127,"./cfvo-xform":83}],85:[function(e,n,i){function o(u){return(o=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(f){return typeof f}:function(f){return f&&typeof Symbol=="function"&&f.constructor===Symbol&&f!==Symbol.prototype?"symbol":typeof f})(u)}function a(u,f){for(var c=0;c<f.length;c++){var v=f[c];v.enumerable=v.enumerable||!1,v.configurable=!0,"value"in v&&(v.writable=!0),Object.defineProperty(u,v.key,v)}}function s(u,f){return(s=Object.setPrototypeOf||function(c,v){return c.__proto__=v,c})(u,f)}function l(u){var f=function(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch{return!1}}();return function(){var c,v=d(u);if(f){var m=d(this).constructor;c=Reflect.construct(v,arguments,m)}else c=v.apply(this,arguments);return p(this,c)}}function p(u,f){return!f||o(f)!=="object"&&typeof f!="function"?function(c){if(c===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return c}(u):f}function d(u){return(d=Object.setPrototypeOf?Object.getPrototypeOf:function(f){return f.__proto__||Object.getPrototypeOf(f)})(u)}var g=e("../../composite-xform"),y=e("./cf-rule-xform"),h=function(u){(function(b,w){if(typeof w!="function"&&w!==null)throw new TypeError("Super expression must either be null or a function");b.prototype=Object.create(w&&w.prototype,{constructor:{value:b,writable:!0,configurable:!0}}),w&&s(b,w)})(m,u);var f,c,v=l(m);function m(){var b;return function(w,_){if(!(w instanceof _))throw new TypeError("Cannot call a class as a function")}(this,m),(b=v.call(this)).map={cfRule:new y},b}return f=m,(c=[{key:"render",value:function(b,w){var _=this;w.rules.some(y.isPrimitive)&&(b.openNode(this.tag,{sqref:w.ref}),w.rules.forEach(function(C){y.isPrimitive(C)&&(C.ref=w.ref,_.map.cfRule.render(b,C))}),b.closeNode())}},{key:"createNewModel",value:function(b){return{ref:b.attributes.sqref,rules:[]}}},{key:"onParserClose",value:function(b,w){this.model.rules.push(w.model)}},{key:"tag",get:function(){return"conditionalFormatting"}}])&&a(f.prototype,c),m}(g);n.exports=h},{"../../composite-xform":47,"./cf-rule-xform":82}],86:[function(e,n,i){function o(c){return(o=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(v){return typeof v}:function(v){return v&&typeof Symbol=="function"&&v.constructor===Symbol&&v!==Symbol.prototype?"symbol":typeof v})(c)}function a(c){return function(v){if(Array.isArray(v))return s(v)}(c)||function(v){if(typeof Symbol!="undefined"&&Symbol.iterator in Object(v))return Array.from(v)}(c)||function(v,m){if(!!v){if(typeof v=="string")return s(v,m);var b=Object.prototype.toString.call(v).slice(8,-1);if(b==="Object"&&v.constructor&&(b=v.constructor.name),b==="Map"||b==="Set")return Array.from(v);if(b==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(b))return s(v,m)}}(c)||function(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}()}function s(c,v){(v==null||v>c.length)&&(v=c.length);for(var m=0,b=new Array(v);m<v;m++)b[m]=c[m];return b}function l(c,v){for(var m=0;m<v.length;m++){var b=v[m];b.enumerable=b.enumerable||!1,b.configurable=!0,"value"in b&&(b.writable=!0),Object.defineProperty(c,b.key,b)}}function p(c,v){return(p=Object.setPrototypeOf||function(m,b){return m.__proto__=b,m})(c,v)}function d(c){var v=function(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch{return!1}}();return function(){var m,b=y(c);if(v){var w=y(this).constructor;m=Reflect.construct(b,arguments,w)}else m=b.apply(this,arguments);return g(this,m)}}function g(c,v){return!v||o(v)!=="object"&&typeof v!="function"?function(m){if(m===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return m}(c):v}function y(c){return(y=Object.setPrototypeOf?Object.getPrototypeOf:function(v){return v.__proto__||Object.getPrototypeOf(v)})(c)}var h=e("../../base-xform"),u=e("./conditional-formatting-xform"),f=function(c){(function(_,C){if(typeof C!="function"&&C!==null)throw new TypeError("Super expression must either be null or a function");_.prototype=Object.create(C&&C.prototype,{constructor:{value:_,writable:!0,configurable:!0}}),C&&p(_,C)})(w,c);var v,m,b=d(w);function w(){var _;return function(C,R){if(!(C instanceof R))throw new TypeError("Cannot call a class as a function")}(this,w),(_=b.call(this)).cfXform=new u,_}return v=w,(m=[{key:"reset",value:function(){this.model=[]}},{key:"prepare",value:function(_,C){var R=_.reduce(function(I,P){return Math.max.apply(Math,[I].concat(a(P.rules.map(function(N){return N.priority||0}))))},1);_.forEach(function(I){I.rules.forEach(function(P){P.priority||(P.priority=R++),P.style&&(P.dxfId=C.styles.addDxfStyle(P.style))})})}},{key:"render",value:function(_,C){var R=this;C.forEach(function(I){R.cfXform.render(_,I)})}},{key:"parseOpen",value:function(_){if(this.parser)return this.parser.parseOpen(_),!0;switch(_.name){case"conditionalFormatting":return this.parser=this.cfXform,this.parser.parseOpen(_),!0;default:return!1}}},{key:"parseText",value:function(_){this.parser&&this.parser.parseText(_)}},{key:"parseClose",value:function(_){return!(!this.parser||!this.parser.parseClose(_)&&(this.model.push(this.parser.model),this.parser=void 0,1))}},{key:"reconcile",value:function(_,C){_.forEach(function(R){R.rules.forEach(function(I){I.dxfId!==void 0&&(I.style=C.styles.getDxfStyle(I.dxfId),delete I.dxfId)})})}},{key:"tag",get:function(){return"conditionalFormatting"}}])&&l(v.prototype,m),w}(h);n.exports=f},{"../../base-xform":31,"./conditional-formatting-xform":85}],87:[function(e,n,i){function o(f){return(o=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(c){return typeof c}:function(c){return c&&typeof Symbol=="function"&&c.constructor===Symbol&&c!==Symbol.prototype?"symbol":typeof c})(f)}function a(f,c){for(var v=0;v<c.length;v++){var m=c[v];m.enumerable=m.enumerable||!1,m.configurable=!0,"value"in m&&(m.writable=!0),Object.defineProperty(f,m.key,m)}}function s(f,c){return(s=Object.setPrototypeOf||function(v,m){return v.__proto__=m,v})(f,c)}function l(f){var c=function(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch{return!1}}();return function(){var v,m=d(f);if(c){var b=d(this).constructor;v=Reflect.construct(m,arguments,b)}else v=m.apply(this,arguments);return p(this,v)}}function p(f,c){return!c||o(c)!=="object"&&typeof c!="function"?function(v){if(v===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return v}(f):c}function d(f){return(d=Object.setPrototypeOf?Object.getPrototypeOf:function(c){return c.__proto__||Object.getPrototypeOf(c)})(f)}var g=e("../../composite-xform"),y=e("../../style/color-xform"),h=e("./cfvo-xform"),u=function(f){(function(w,_){if(typeof _!="function"&&_!==null)throw new TypeError("Super expression must either be null or a function");w.prototype=Object.create(_&&_.prototype,{constructor:{value:w,writable:!0,configurable:!0}}),_&&s(w,_)})(b,f);var c,v,m=l(b);function b(){var w;return function(_,C){if(!(_ instanceof C))throw new TypeError("Cannot call a class as a function")}(this,b),(w=m.call(this)).map={cfvo:w.cfvoXform=new h,color:w.colorXform=new y},w}return c=b,(v=[{key:"render",value:function(w,_){var C=this;w.openNode(this.tag),_.cfvo.forEach(function(R){C.cfvoXform.render(w,R)}),this.colorXform.render(w,_.color),w.closeNode()}},{key:"createNewModel",value:function(){return{cfvo:[]}}},{key:"onParserClose",value:function(w,_){switch(w){case"cfvo":this.model.cfvo.push(_.model);break;case"color":this.model.color=_.model}}},{key:"tag",get:function(){return"dataBar"}}])&&a(c.prototype,v),b}(g);n.exports=u},{"../../composite-xform":47,"../../style/color-xform":127,"./cfvo-xform":83}],88:[function(e,n,i){function o(b){return(o=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(w){return typeof w}:function(w){return w&&typeof Symbol=="function"&&w.constructor===Symbol&&w!==Symbol.prototype?"symbol":typeof w})(b)}function a(b,w){if(!(b instanceof w))throw new TypeError("Cannot call a class as a function")}function s(b,w){for(var _=0;_<w.length;_++){var C=w[_];C.enumerable=C.enumerable||!1,C.configurable=!0,"value"in C&&(C.writable=!0),Object.defineProperty(b,C.key,C)}}function l(b,w,_){return w&&s(b.prototype,w),_&&s(b,_),b}function p(b,w){if(typeof w!="function"&&w!==null)throw new TypeError("Super expression must either be null or a function");b.prototype=Object.create(w&&w.prototype,{constructor:{value:b,writable:!0,configurable:!0}}),w&&d(b,w)}function d(b,w){return(d=Object.setPrototypeOf||function(_,C){return _.__proto__=C,_})(b,w)}function g(b){var w=function(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch{return!1}}();return function(){var _,C=h(b);if(w){var R=h(this).constructor;_=Reflect.construct(C,arguments,R)}else _=C.apply(this,arguments);return y(this,_)}}function y(b,w){return!w||o(w)!=="object"&&typeof w!="function"?function(_){if(_===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return _}(b):w}function h(b){return(h=Object.setPrototypeOf?Object.getPrototypeOf:function(w){return w.__proto__||Object.getPrototypeOf(w)})(b)}var u=e("../../base-xform"),f=e("../../composite-xform"),c=function(b){p(_,b);var w=g(_);function _(){return a(this,_),w.apply(this,arguments)}return l(_,[{key:"render",value:function(C,R){C.leafNode(this.tag,null,R)}},{key:"parseOpen",value:function(){this.model=""}},{key:"parseText",value:function(C){this.model+=C}},{key:"parseClose",value:function(C){return C!==this.tag}},{key:"tag",get:function(){return"x14:id"}}]),_}(u),v=function(b){p(_,b);var w=g(_);function _(){var C;return a(this,_),(C=w.call(this)).map={"x14:id":C.idXform=new c},C}return l(_,[{key:"render",value:function(C,R){C.openNode(this.tag,{uri:"{B025F937-C7B1-47D3-B67F-A62EFF666E3E}","xmlns:x14":"http://schemas.microsoft.com/office/spreadsheetml/2009/9/main"}),this.idXform.render(C,R.x14Id),C.closeNode()}},{key:"createNewModel",value:function(){return{}}},{key:"onParserClose",value:function(C,R){this.model.x14Id=R.model}},{key:"tag",get:function(){return"ext"}}]),_}(f),m=function(b){p(_,b);var w=g(_);function _(){var C;return a(this,_),(C=w.call(this)).map={ext:new v},C}return l(_,[{key:"render",value:function(C,R){C.openNode(this.tag),this.map.ext.render(C,R),C.closeNode()}},{key:"createNewModel",value:function(){return{}}},{key:"onParserClose",value:function(C,R){Object.assign(this.model,R.model)}},{key:"tag",get:function(){return"extLst"}}]),_}(f);n.exports=m},{"../../base-xform":31,"../../composite-xform":47}],89:[function(e,n,i){function o(h){return(o=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(u){return typeof u}:function(u){return u&&typeof Symbol=="function"&&u.constructor===Symbol&&u!==Symbol.prototype?"symbol":typeof u})(h)}function a(h,u){if(!(h instanceof u))throw new TypeError("Cannot call a class as a function")}function s(h,u){for(var f=0;f<u.length;f++){var c=u[f];c.enumerable=c.enumerable||!1,c.configurable=!0,"value"in c&&(c.writable=!0),Object.defineProperty(h,c.key,c)}}function l(h,u){return(l=Object.setPrototypeOf||function(f,c){return f.__proto__=c,f})(h,u)}function p(h){var u=function(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch{return!1}}();return function(){var f,c=g(h);if(u){var v=g(this).constructor;f=Reflect.construct(c,arguments,v)}else f=c.apply(this,arguments);return d(this,f)}}function d(h,u){return!u||o(u)!=="object"&&typeof u!="function"?function(f){if(f===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return f}(h):u}function g(h){return(g=Object.setPrototypeOf?Object.getPrototypeOf:function(u){return u.__proto__||Object.getPrototypeOf(u)})(h)}var y=function(h){(function(m,b){if(typeof b!="function"&&b!==null)throw new TypeError("Super expression must either be null or a function");m.prototype=Object.create(b&&b.prototype,{constructor:{value:m,writable:!0,configurable:!0}}),b&&l(m,b)})(v,h);var u,f,c=p(v);function v(){return a(this,v),c.apply(this,arguments)}return u=v,(f=[{key:"render",value:function(m,b){m.leafNode(this.tag,null,b)}},{key:"parseOpen",value:function(){this.model=""}},{key:"parseText",value:function(m){this.model+=m}},{key:"parseClose",value:function(m){return m!==this.tag}},{key:"tag",get:function(){return"formula"}}])&&s(u.prototype,f),v}(e("../../base-xform"));n.exports=y},{"../../base-xform":31}],90:[function(e,n,i){function o(f){return(o=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(c){return typeof c}:function(c){return c&&typeof Symbol=="function"&&c.constructor===Symbol&&c!==Symbol.prototype?"symbol":typeof c})(f)}function a(f,c){for(var v=0;v<c.length;v++){var m=c[v];m.enumerable=m.enumerable||!1,m.configurable=!0,"value"in m&&(m.writable=!0),Object.defineProperty(f,m.key,m)}}function s(f,c){return(s=Object.setPrototypeOf||function(v,m){return v.__proto__=m,v})(f,c)}function l(f){var c=function(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch{return!1}}();return function(){var v,m=d(f);if(c){var b=d(this).constructor;v=Reflect.construct(m,arguments,b)}else v=m.apply(this,arguments);return p(this,v)}}function p(f,c){return!c||o(c)!=="object"&&typeof c!="function"?function(v){if(v===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return v}(f):c}function d(f){return(d=Object.setPrototypeOf?Object.getPrototypeOf:function(c){return c.__proto__||Object.getPrototypeOf(c)})(f)}var g=e("../../base-xform"),y=e("../../composite-xform"),h=e("./cfvo-xform"),u=function(f){(function(w,_){if(typeof _!="function"&&_!==null)throw new TypeError("Super expression must either be null or a function");w.prototype=Object.create(_&&_.prototype,{constructor:{value:w,writable:!0,configurable:!0}}),_&&s(w,_)})(b,f);var c,v,m=l(b);function b(){var w;return function(_,C){if(!(_ instanceof C))throw new TypeError("Cannot call a class as a function")}(this,b),(w=m.call(this)).map={cfvo:w.cfvoXform=new h},w}return c=b,(v=[{key:"render",value:function(w,_){var C=this;w.openNode(this.tag,{iconSet:g.toStringAttribute(_.iconSet,"3TrafficLights"),reverse:g.toBoolAttribute(_.reverse,!1),showValue:g.toBoolAttribute(_.showValue,!0)}),_.cfvo.forEach(function(R){C.cfvoXform.render(w,R)}),w.closeNode()}},{key:"createNewModel",value:function(w){var _=w.attributes;return{iconSet:g.toStringValue(_.iconSet,"3TrafficLights"),reverse:g.toBoolValue(_.reverse),showValue:g.toBoolValue(_.showValue),cfvo:[]}}},{key:"onParserClose",value:function(w,_){this.model[w].push(_.model)}},{key:"tag",get:function(){return"iconSet"}}])&&a(c.prototype,v),b}(y);n.exports=u},{"../../base-xform":31,"../../composite-xform":47,"./cfvo-xform":83}],91:[function(e,n,i){function o(h){return(o=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(u){return typeof u}:function(u){return u&&typeof Symbol=="function"&&u.constructor===Symbol&&u!==Symbol.prototype?"symbol":typeof u})(h)}function a(h,u){if(!(h instanceof u))throw new TypeError("Cannot call a class as a function")}function s(h,u){for(var f=0;f<u.length;f++){var c=u[f];c.enumerable=c.enumerable||!1,c.configurable=!0,"value"in c&&(c.writable=!0),Object.defineProperty(h,c.key,c)}}function l(h,u){return(l=Object.setPrototypeOf||function(f,c){return f.__proto__=c,f})(h,u)}function p(h){var u=function(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch{return!1}}();return function(){var f,c=g(h);if(u){var v=g(this).constructor;f=Reflect.construct(c,arguments,v)}else f=c.apply(this,arguments);return d(this,f)}}function d(h,u){return!u||o(u)!=="object"&&typeof u!="function"?function(f){if(f===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return f}(h):u}function g(h){return(g=Object.setPrototypeOf?Object.getPrototypeOf:function(u){return u.__proto__||Object.getPrototypeOf(u)})(h)}var y=function(h){(function(m,b){if(typeof b!="function"&&b!==null)throw new TypeError("Super expression must either be null or a function");m.prototype=Object.create(b&&b.prototype,{constructor:{value:m,writable:!0,configurable:!0}}),b&&l(m,b)})(v,h);var u,f,c=p(v);function v(){return a(this,v),c.apply(this,arguments)}return u=v,(f=[{key:"prepare",value:function(m,b){var w=b.styles.addStyleModel(m.style||{});w&&(m.styleId=w)}},{key:"render",value:function(m,b){m.openNode("col"),m.addAttribute("min",b.min),m.addAttribute("max",b.max),b.width&&m.addAttribute("width",b.width),b.styleId&&m.addAttribute("style",b.styleId),b.hidden&&m.addAttribute("hidden","1"),b.bestFit&&m.addAttribute("bestFit","1"),b.outlineLevel&&m.addAttribute("outlineLevel",b.outlineLevel),b.collapsed&&m.addAttribute("collapsed","1"),m.addAttribute("customWidth","1"),m.closeNode()}},{key:"parseOpen",value:function(m){if(m.name==="col"){var b=this.model={min:parseInt(m.attributes.min||"0",10),max:parseInt(m.attributes.max||"0",10),width:m.attributes.width===void 0?void 0:parseFloat(m.attributes.width||"0")};return m.attributes.style&&(b.styleId=parseInt(m.attributes.style,10)),m.attributes.hidden!==!0&&m.attributes.hidden!=="true"&&m.attributes.hidden!==1&&m.attributes.hidden!=="1"||(b.hidden=!0),m.attributes.bestFit&&(b.bestFit=!0),m.attributes.outlineLevel&&(b.outlineLevel=parseInt(m.attributes.outlineLevel,10)),m.attributes.collapsed&&(b.collapsed=!0),!0}return!1}},{key:"parseText",value:function(){}},{key:"parseClose",value:function(){return!1}},{key:"reconcile",value:function(m,b){m.styleId&&(m.style=b.styles.getStyleModel(m.styleId))}},{key:"tag",get:function(){return"col"}}])&&s(u.prototype,f),v}(e("../base-xform"));n.exports=y},{"../base-xform":31}],92:[function(e,n,i){function o(R){return(o=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(I){return typeof I}:function(I){return I&&typeof Symbol=="function"&&I.constructor===Symbol&&I!==Symbol.prototype?"symbol":typeof I})(R)}function a(R,I){if(!(R instanceof I))throw new TypeError("Cannot call a class as a function")}function s(R,I){for(var P=0;P<I.length;P++){var N=I[P];N.enumerable=N.enumerable||!1,N.configurable=!0,"value"in N&&(N.writable=!0),Object.defineProperty(R,N.key,N)}}function l(R,I){return(l=Object.setPrototypeOf||function(P,N){return P.__proto__=N,P})(R,I)}function p(R){var I=function(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch{return!1}}();return function(){var P,N=g(R);if(I){var A=g(this).constructor;P=Reflect.construct(N,arguments,A)}else P=N.apply(this,arguments);return d(this,P)}}function d(R,I){return!I||o(I)!=="object"&&typeof I!="function"?function(P){if(P===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return P}(R):I}function g(R){return(g=Object.setPrototypeOf?Object.getPrototypeOf:function(I){return I.__proto__||Object.getPrototypeOf(I)})(R)}function y(R,I){var P=Object.keys(R);if(Object.getOwnPropertySymbols){var N=Object.getOwnPropertySymbols(R);I&&(N=N.filter(function(A){return Object.getOwnPropertyDescriptor(R,A).enumerable})),P.push.apply(P,N)}return P}function h(R){for(var I=1;I<arguments.length;I++){var P=arguments[I]!=null?arguments[I]:{};I%2?y(Object(P),!0).forEach(function(N){u(R,N,P[N])}):Object.getOwnPropertyDescriptors?Object.defineProperties(R,Object.getOwnPropertyDescriptors(P)):y(Object(P)).forEach(function(N){Object.defineProperty(R,N,Object.getOwnPropertyDescriptor(P,N))})}return R}function u(R,I,P){return I in R?Object.defineProperty(R,I,{value:P,enumerable:!0,configurable:!0,writable:!0}):R[I]=P,R}var f=e("../../../utils/under-dash"),c=e("../../../utils/utils"),v=e("../../../utils/col-cache"),m=e("../base-xform"),b=e("../../../doc/range");function w(R,I,P,N){var A=I[P];A!==void 0?R[P]=A:N!==void 0&&(R[P]=N)}function _(R,I,P,N){var A=I[P];A!==void 0?R[P]=function($){switch($){case"1":case"true":return!0;default:return!1}}(A):N!==void 0&&(R[P]=N)}var C=function(R){(function($,T){if(typeof T!="function"&&T!==null)throw new TypeError("Super expression must either be null or a function");$.prototype=Object.create(T&&T.prototype,{constructor:{value:$,writable:!0,configurable:!0}}),T&&l($,T)})(A,R);var I,P,N=p(A);function A(){return a(this,A),N.apply(this,arguments)}return I=A,(P=[{key:"render",value:function($,T){var M=function(S){var E=f.map(S,function(x,j){return{address:j,dataValidation:x,marked:!1}}).sort(function(x,j){return f.strcmp(x.address,j.address)}),k=f.keyBy(E,"address"),O=function(x,j,H){for(var F=0;F<j;F++){var V=v.encodeAddress(x.row+F,H);if(!S[V]||!f.isEqual(S[x.address],S[V]))return!1}return!0};return E.map(function(x){if(!x.marked){var j=v.decodeEx(x.address);if(j.dimensions)return k[j.dimensions].marked=!0,h(h({},x.dataValidation),{},{sqref:x.address});for(var H=1,F=v.encodeAddress(j.row+H,j.col);S[F]&&f.isEqual(x.dataValidation,S[F]);)H++,F=v.encodeAddress(j.row+H,j.col);for(var V=1;O(j,H,j.col+V);)V++;for(var W=0;W<H;W++)for(var U=0;U<V;U++)F=v.encodeAddress(j.row+W,j.col+U),k[F].marked=!0;if(H>1||V>1){var Y=j.row+(H-1),K=j.col+(V-1);return h(h({},x.dataValidation),{},{sqref:"".concat(x.address,":").concat(v.encodeAddress(Y,K))})}return h(h({},x.dataValidation),{},{sqref:x.address})}return null}).filter(Boolean)}(T);M.length&&($.openNode("dataValidations",{count:M.length}),M.forEach(function(S){$.openNode("dataValidation"),S.type!=="any"&&($.addAttribute("type",S.type),S.operator&&S.type!=="list"&&S.operator!=="between"&&$.addAttribute("operator",S.operator),S.allowBlank&&$.addAttribute("allowBlank","1")),S.showInputMessage&&$.addAttribute("showInputMessage","1"),S.promptTitle&&$.addAttribute("promptTitle",S.promptTitle),S.prompt&&$.addAttribute("prompt",S.prompt),S.showErrorMessage&&$.addAttribute("showErrorMessage","1"),S.errorStyle&&$.addAttribute("errorStyle",S.errorStyle),S.errorTitle&&$.addAttribute("errorTitle",S.errorTitle),S.error&&$.addAttribute("error",S.error),$.addAttribute("sqref",S.sqref),(S.formulae||[]).forEach(function(E,k){$.openNode("formula".concat(k+1)),S.type==="date"?$.writeText(c.dateToExcel(new Date(E))):$.writeText(E),$.closeNode()}),$.closeNode()}),$.closeNode())}},{key:"parseOpen",value:function($){switch($.name){case"dataValidations":return this.model={},!0;case"dataValidation":this._address=$.attributes.sqref;var T={type:$.attributes.type||"any",formulae:[]};switch($.attributes.type&&_(T,$.attributes,"allowBlank"),_(T,$.attributes,"showInputMessage"),_(T,$.attributes,"showErrorMessage"),T.type){case"any":case"list":case"custom":break;default:w(T,$.attributes,"operator","between")}return w(T,$.attributes,"promptTitle"),w(T,$.attributes,"prompt"),w(T,$.attributes,"errorStyle"),w(T,$.attributes,"errorTitle"),w(T,$.attributes,"error"),this._dataValidation=T,!0;case"formula1":case"formula2":return this._formula=[],!0;default:return!1}}},{key:"parseText",value:function($){this._formula&&this._formula.push($)}},{key:"parseClose",value:function($){var T=this;switch($){case"dataValidations":return!1;case"dataValidation":return this._dataValidation.formulae&&this._dataValidation.formulae.length||(delete this._dataValidation.formulae,delete this._dataValidation.operator),(this._address.split(/\s+/g)||[]).forEach(function(S){S.includes(":")?new b(S).forEachAddress(function(E){T.model[E]=T._dataValidation}):T.model[S]=T._dataValidation}),!0;case"formula1":case"formula2":var M=this._formula.join("");switch(this._dataValidation.type){case"whole":case"textLength":M=parseInt(M,10);break;case"decimal":M=parseFloat(M);break;case"date":M=c.excelToDate(parseFloat(M))}return this._dataValidation.formulae.push(M),this._formula=void 0,!0;default:return!0}}},{key:"tag",get:function(){return"dataValidations"}}])&&s(I.prototype,P),A}(m);n.exports=C},{"../../../doc/range":10,"../../../utils/col-cache":19,"../../../utils/under-dash":25,"../../../utils/utils":26,"../base-xform":31}],93:[function(e,n,i){function o(h){return(o=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(u){return typeof u}:function(u){return u&&typeof Symbol=="function"&&u.constructor===Symbol&&u!==Symbol.prototype?"symbol":typeof u})(h)}function a(h,u){if(!(h instanceof u))throw new TypeError("Cannot call a class as a function")}function s(h,u){for(var f=0;f<u.length;f++){var c=u[f];c.enumerable=c.enumerable||!1,c.configurable=!0,"value"in c&&(c.writable=!0),Object.defineProperty(h,c.key,c)}}function l(h,u){return(l=Object.setPrototypeOf||function(f,c){return f.__proto__=c,f})(h,u)}function p(h){var u=function(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch{return!1}}();return function(){var f,c=g(h);if(u){var v=g(this).constructor;f=Reflect.construct(c,arguments,v)}else f=c.apply(this,arguments);return d(this,f)}}function d(h,u){return!u||o(u)!=="object"&&typeof u!="function"?function(f){if(f===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return f}(h):u}function g(h){return(g=Object.setPrototypeOf?Object.getPrototypeOf:function(u){return u.__proto__||Object.getPrototypeOf(u)})(h)}var y=function(h){(function(m,b){if(typeof b!="function"&&b!==null)throw new TypeError("Super expression must either be null or a function");m.prototype=Object.create(b&&b.prototype,{constructor:{value:m,writable:!0,configurable:!0}}),b&&l(m,b)})(v,h);var u,f,c=p(v);function v(){return a(this,v),c.apply(this,arguments)}return u=v,(f=[{key:"render",value:function(m,b){b&&m.leafNode("dimension",{ref:b})}},{key:"parseOpen",value:function(m){return m.name==="dimension"&&(this.model=m.attributes.ref,!0)}},{key:"parseText",value:function(){}},{key:"parseClose",value:function(){return!1}},{key:"tag",get:function(){return"dimension"}}])&&s(u.prototype,f),v}(e("../base-xform"));n.exports=y},{"../base-xform":31}],94:[function(e,n,i){function o(h){return(o=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(u){return typeof u}:function(u){return u&&typeof Symbol=="function"&&u.constructor===Symbol&&u!==Symbol.prototype?"symbol":typeof u})(h)}function a(h,u){if(!(h instanceof u))throw new TypeError("Cannot call a class as a function")}function s(h,u){for(var f=0;f<u.length;f++){var c=u[f];c.enumerable=c.enumerable||!1,c.configurable=!0,"value"in c&&(c.writable=!0),Object.defineProperty(h,c.key,c)}}function l(h,u){return(l=Object.setPrototypeOf||function(f,c){return f.__proto__=c,f})(h,u)}function p(h){var u=function(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch{return!1}}();return function(){var f,c=g(h);if(u){var v=g(this).constructor;f=Reflect.construct(c,arguments,v)}else f=c.apply(this,arguments);return d(this,f)}}function d(h,u){return!u||o(u)!=="object"&&typeof u!="function"?function(f){if(f===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return f}(h):u}function g(h){return(g=Object.setPrototypeOf?Object.getPrototypeOf:function(u){return u.__proto__||Object.getPrototypeOf(u)})(h)}var y=function(h){(function(m,b){if(typeof b!="function"&&b!==null)throw new TypeError("Super expression must either be null or a function");m.prototype=Object.create(b&&b.prototype,{constructor:{value:m,writable:!0,configurable:!0}}),b&&l(m,b)})(v,h);var u,f,c=p(v);function v(){return a(this,v),c.apply(this,arguments)}return u=v,(f=[{key:"render",value:function(m,b){b&&m.leafNode(this.tag,{"r:id":b.rId})}},{key:"parseOpen",value:function(m){switch(m.name){case this.tag:return this.model={rId:m.attributes["r:id"]},!0;default:return!1}}},{key:"parseText",value:function(){}},{key:"parseClose",value:function(){return!1}},{key:"tag",get:function(){return"drawing"}}])&&s(u.prototype,f),v}(e("../base-xform"));n.exports=y},{"../base-xform":31}],95:[function(e,n,i){function o(m){return(o=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(b){return typeof b}:function(b){return b&&typeof Symbol=="function"&&b.constructor===Symbol&&b!==Symbol.prototype?"symbol":typeof b})(m)}function a(m,b){if(!(m instanceof b))throw new TypeError("Cannot call a class as a function")}function s(m,b){for(var w=0;w<b.length;w++){var _=b[w];_.enumerable=_.enumerable||!1,_.configurable=!0,"value"in _&&(_.writable=!0),Object.defineProperty(m,_.key,_)}}function l(m,b,w){return b&&s(m.prototype,b),w&&s(m,w),m}function p(m,b){if(typeof b!="function"&&b!==null)throw new TypeError("Super expression must either be null or a function");m.prototype=Object.create(b&&b.prototype,{constructor:{value:m,writable:!0,configurable:!0}}),b&&d(m,b)}function d(m,b){return(d=Object.setPrototypeOf||function(w,_){return w.__proto__=_,w})(m,b)}function g(m){var b=function(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch{return!1}}();return function(){var w,_=h(m);if(b){var C=h(this).constructor;w=Reflect.construct(_,arguments,C)}else w=_.apply(this,arguments);return y(this,w)}}function y(m,b){return!b||o(b)!=="object"&&typeof b!="function"?function(w){if(w===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return w}(m):b}function h(m){return(h=Object.setPrototypeOf?Object.getPrototypeOf:function(b){return b.__proto__||Object.getPrototypeOf(b)})(m)}var u=e("../composite-xform"),f=e("./cf-ext/conditional-formattings-ext-xform"),c=function(m){p(w,m);var b=g(w);function w(){var _;return a(this,w),(_=b.call(this)).map={"x14:conditionalFormattings":_.conditionalFormattings=new f},_}return l(w,[{key:"hasContent",value:function(_){return this.conditionalFormattings.hasContent(_.conditionalFormattings)}},{key:"prepare",value:function(_,C){this.conditionalFormattings.prepare(_.conditionalFormattings,C)}},{key:"render",value:function(_,C){_.openNode("ext",{uri:"{78C0D931-6437-407d-A8EE-F0AAD7539E65}","xmlns:x14":"http://schemas.microsoft.com/office/spreadsheetml/2009/9/main"}),this.conditionalFormattings.render(_,C.conditionalFormattings),_.closeNode()}},{key:"createNewModel",value:function(){return{}}},{key:"onParserClose",value:function(_,C){this.model[_]=C.model}},{key:"tag",get:function(){return"ext"}}]),w}(u),v=function(m){p(w,m);var b=g(w);function w(){var _;return a(this,w),(_=b.call(this)).map={ext:_.ext=new c},_}return l(w,[{key:"prepare",value:function(_,C){this.ext.prepare(_,C)}},{key:"hasContent",value:function(_){return this.ext.hasContent(_)}},{key:"render",value:function(_,C){this.hasContent(C)&&(_.openNode("extLst"),this.ext.render(_,C),_.closeNode())}},{key:"createNewModel",value:function(){return{}}},{key:"onParserClose",value:function(_,C){Object.assign(this.model,C.model)}},{key:"tag",get:function(){return"extLst"}}]),w}(u);n.exports=v},{"../composite-xform":47,"./cf-ext/conditional-formattings-ext-xform":77}],96:[function(e,n,i){function o(h){return(o=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(u){return typeof u}:function(u){return u&&typeof Symbol=="function"&&u.constructor===Symbol&&u!==Symbol.prototype?"symbol":typeof u})(h)}function a(h,u){if(!(h instanceof u))throw new TypeError("Cannot call a class as a function")}function s(h,u){for(var f=0;f<u.length;f++){var c=u[f];c.enumerable=c.enumerable||!1,c.configurable=!0,"value"in c&&(c.writable=!0),Object.defineProperty(h,c.key,c)}}function l(h,u){return(l=Object.setPrototypeOf||function(f,c){return f.__proto__=c,f})(h,u)}function p(h){var u=function(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch{return!1}}();return function(){var f,c=g(h);if(u){var v=g(this).constructor;f=Reflect.construct(c,arguments,v)}else f=c.apply(this,arguments);return d(this,f)}}function d(h,u){return!u||o(u)!=="object"&&typeof u!="function"?function(f){if(f===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return f}(h):u}function g(h){return(g=Object.setPrototypeOf?Object.getPrototypeOf:function(u){return u.__proto__||Object.getPrototypeOf(u)})(h)}var y=function(h){(function(m,b){if(typeof b!="function"&&b!==null)throw new TypeError("Super expression must either be null or a function");m.prototype=Object.create(b&&b.prototype,{constructor:{value:m,writable:!0,configurable:!0}}),b&&l(m,b)})(v,h);var u,f,c=p(v);function v(){return a(this,v),c.apply(this,arguments)}return u=v,(f=[{key:"render",value:function(m,b){if(b){m.addRollback();var w=!1;m.openNode("headerFooter"),b.differentFirst&&(m.addAttribute("differentFirst","1"),w=!0),b.differentOddEven&&(m.addAttribute("differentOddEven","1"),w=!0),b.oddHeader&&typeof b.oddHeader=="string"&&(m.leafNode("oddHeader",null,b.oddHeader),w=!0),b.oddFooter&&typeof b.oddFooter=="string"&&(m.leafNode("oddFooter",null,b.oddFooter),w=!0),b.evenHeader&&typeof b.evenHeader=="string"&&(m.leafNode("evenHeader",null,b.evenHeader),w=!0),b.evenFooter&&typeof b.evenFooter=="string"&&(m.leafNode("evenFooter",null,b.evenFooter),w=!0),b.firstHeader&&typeof b.firstHeader=="string"&&(m.leafNode("firstHeader",null,b.firstHeader),w=!0),b.firstFooter&&typeof b.firstFooter=="string"&&(m.leafNode("firstFooter",null,b.firstFooter),w=!0),w?(m.closeNode(),m.commit()):m.rollback()}}},{key:"parseOpen",value:function(m){switch(m.name){case"headerFooter":return this.model={},m.attributes.differentFirst&&(this.model.differentFirst=parseInt(m.attributes.differentFirst,0)===1),m.attributes.differentOddEven&&(this.model.differentOddEven=parseInt(m.attributes.differentOddEven,0)===1),!0;case"oddHeader":return this.currentNode="oddHeader",!0;case"oddFooter":return this.currentNode="oddFooter",!0;case"evenHeader":return this.currentNode="evenHeader",!0;case"evenFooter":return this.currentNode="evenFooter",!0;case"firstHeader":return this.currentNode="firstHeader",!0;case"firstFooter":return this.currentNode="firstFooter",!0;default:return!1}}},{key:"parseText",value:function(m){switch(this.currentNode){case"oddHeader":this.model.oddHeader=m;break;case"oddFooter":this.model.oddFooter=m;break;case"evenHeader":this.model.evenHeader=m;break;case"evenFooter":this.model.evenFooter=m;break;case"firstHeader":this.model.firstHeader=m;break;case"firstFooter":this.model.firstFooter=m}}},{key:"parseClose",value:function(){switch(this.currentNode){case"oddHeader":case"oddFooter":case"evenHeader":case"evenFooter":case"firstHeader":case"firstFooter":return this.currentNode=void 0,!0;default:return!1}}},{key:"tag",get:function(){return"headerFooter"}}])&&s(u.prototype,f),v}(e("../base-xform"));n.exports=y},{"../base-xform":31}],97:[function(e,n,i){function o(h){return(o=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(u){return typeof u}:function(u){return u&&typeof Symbol=="function"&&u.constructor===Symbol&&u!==Symbol.prototype?"symbol":typeof u})(h)}function a(h,u){if(!(h instanceof u))throw new TypeError("Cannot call a class as a function")}function s(h,u){for(var f=0;f<u.length;f++){var c=u[f];c.enumerable=c.enumerable||!1,c.configurable=!0,"value"in c&&(c.writable=!0),Object.defineProperty(h,c.key,c)}}function l(h,u){return(l=Object.setPrototypeOf||function(f,c){return f.__proto__=c,f})(h,u)}function p(h){var u=function(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch{return!1}}();return function(){var f,c=g(h);if(u){var v=g(this).constructor;f=Reflect.construct(c,arguments,v)}else f=c.apply(this,arguments);return d(this,f)}}function d(h,u){return!u||o(u)!=="object"&&typeof u!="function"?function(f){if(f===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return f}(h):u}function g(h){return(g=Object.setPrototypeOf?Object.getPrototypeOf:function(u){return u.__proto__||Object.getPrototypeOf(u)})(h)}var y=function(h){(function(m,b){if(typeof b!="function"&&b!==null)throw new TypeError("Super expression must either be null or a function");m.prototype=Object.create(b&&b.prototype,{constructor:{value:m,writable:!0,configurable:!0}}),b&&l(m,b)})(v,h);var u,f,c=p(v);function v(){return a(this,v),c.apply(this,arguments)}return u=v,(f=[{key:"render",value:function(m,b){m.leafNode("hyperlink",{ref:b.address,"r:id":b.rId,tooltip:b.tooltip})}},{key:"parseOpen",value:function(m){return m.name==="hyperlink"&&(this.model={address:m.attributes.ref,rId:m.attributes["r:id"],tooltip:m.attributes.tooltip},!0)}},{key:"parseText",value:function(){}},{key:"parseClose",value:function(){return!1}},{key:"tag",get:function(){return"hyperlink"}}])&&s(u.prototype,f),v}(e("../base-xform"));n.exports=y},{"../base-xform":31}],98:[function(e,n,i){function o(h){return(o=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(u){return typeof u}:function(u){return u&&typeof Symbol=="function"&&u.constructor===Symbol&&u!==Symbol.prototype?"symbol":typeof u})(h)}function a(h,u){if(!(h instanceof u))throw new TypeError("Cannot call a class as a function")}function s(h,u){for(var f=0;f<u.length;f++){var c=u[f];c.enumerable=c.enumerable||!1,c.configurable=!0,"value"in c&&(c.writable=!0),Object.defineProperty(h,c.key,c)}}function l(h,u){return(l=Object.setPrototypeOf||function(f,c){return f.__proto__=c,f})(h,u)}function p(h){var u=function(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch{return!1}}();return function(){var f,c=g(h);if(u){var v=g(this).constructor;f=Reflect.construct(c,arguments,v)}else f=c.apply(this,arguments);return d(this,f)}}function d(h,u){return!u||o(u)!=="object"&&typeof u!="function"?function(f){if(f===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return f}(h):u}function g(h){return(g=Object.setPrototypeOf?Object.getPrototypeOf:function(u){return u.__proto__||Object.getPrototypeOf(u)})(h)}var y=function(h){(function(m,b){if(typeof b!="function"&&b!==null)throw new TypeError("Super expression must either be null or a function");m.prototype=Object.create(b&&b.prototype,{constructor:{value:m,writable:!0,configurable:!0}}),b&&l(m,b)})(v,h);var u,f,c=p(v);function v(){return a(this,v),c.apply(this,arguments)}return u=v,(f=[{key:"render",value:function(m,b){m.leafNode("mergeCell",{ref:b})}},{key:"parseOpen",value:function(m){return m.name==="mergeCell"&&(this.model=m.attributes.ref,!0)}},{key:"parseText",value:function(){}},{key:"parseClose",value:function(){return!1}},{key:"tag",get:function(){return"mergeCell"}}])&&s(u.prototype,f),v}(e("../base-xform"));n.exports=y},{"../base-xform":31}],99:[function(e,n,i){function o(g,y){for(var h=0;h<y.length;h++){var u=y[h];u.enumerable=u.enumerable||!1,u.configurable=!0,"value"in u&&(u.writable=!0),Object.defineProperty(g,u.key,u)}}var a=e("../../../utils/under-dash"),s=e("../../../doc/range"),l=e("../../../utils/col-cache"),p=e("../../../doc/enums"),d=function(){function g(){(function(u,f){if(!(u instanceof f))throw new TypeError("Cannot call a class as a function")})(this,g),this.merges={}}var y,h;return y=g,(h=[{key:"add",value:function(u){if(this.merges[u.master])this.merges[u.master].expandToAddress(u.address);else{var f="".concat(u.master,":").concat(u.address);this.merges[u.master]=new s(f)}}},{key:"reconcile",value:function(u,f){a.each(u,function(c){for(var v=l.decode(c),m=v.top;m<=v.bottom;m++)for(var b=f[m-1],w=v.left;w<=v.right;w++){var _=b.cells[w-1];_?_.type===p.ValueType.Merge&&(_.master=v.tl):b.cells[w]={type:p.ValueType.Null,address:l.encodeAddress(m,w)}}})}},{key:"getMasterAddress",value:function(u){var f=this.hash[u];return f&&f.tl}},{key:"mergeCells",get:function(){return a.map(this.merges,function(u){return u.range})}}])&&o(y.prototype,h),g}();n.exports=d},{"../../../doc/enums":7,"../../../doc/range":10,"../../../utils/col-cache":19,"../../../utils/under-dash":25}],100:[function(e,n,i){function o(f){return(o=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(c){return typeof c}:function(c){return c&&typeof Symbol=="function"&&c.constructor===Symbol&&c!==Symbol.prototype?"symbol":typeof c})(f)}function a(f,c){if(!(f instanceof c))throw new TypeError("Cannot call a class as a function")}function s(f,c){for(var v=0;v<c.length;v++){var m=c[v];m.enumerable=m.enumerable||!1,m.configurable=!0,"value"in m&&(m.writable=!0),Object.defineProperty(f,m.key,m)}}function l(f,c){return(l=Object.setPrototypeOf||function(v,m){return v.__proto__=m,v})(f,c)}function p(f){var c=function(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch{return!1}}();return function(){var v,m=g(f);if(c){var b=g(this).constructor;v=Reflect.construct(m,arguments,b)}else v=m.apply(this,arguments);return d(this,v)}}function d(f,c){return!c||o(c)!=="object"&&typeof c!="function"?function(v){if(v===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return v}(f):c}function g(f){return(g=Object.setPrototypeOf?Object.getPrototypeOf:function(c){return c.__proto__||Object.getPrototypeOf(c)})(f)}var y=e("../base-xform"),h=function(f){return f!==void 0},u=function(f){(function(w,_){if(typeof _!="function"&&_!==null)throw new TypeError("Super expression must either be null or a function");w.prototype=Object.create(_&&_.prototype,{constructor:{value:w,writable:!0,configurable:!0}}),_&&l(w,_)})(b,f);var c,v,m=p(b);function b(){return a(this,b),m.apply(this,arguments)}return c=b,(v=[{key:"render",value:function(w,_){return!(!_||!h(_.summaryBelow)&&!h(_.summaryRight)||(w.leafNode(this.tag,{summaryBelow:h(_.summaryBelow)?Number(_.summaryBelow):void 0,summaryRight:h(_.summaryRight)?Number(_.summaryRight):void 0}),0))}},{key:"parseOpen",value:function(w){return w.name===this.tag&&(this.model={summaryBelow:h(w.attributes.summaryBelow)?Boolean(Number(w.attributes.summaryBelow)):void 0,summaryRight:h(w.attributes.summaryRight)?Boolean(Number(w.attributes.summaryRight)):void 0},!0)}},{key:"parseText",value:function(){}},{key:"parseClose",value:function(){return!1}},{key:"tag",get:function(){return"outlinePr"}}])&&s(c.prototype,v),b}(y);n.exports=u},{"../base-xform":31}],101:[function(e,n,i){function o(h){return(o=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(u){return typeof u}:function(u){return u&&typeof Symbol=="function"&&u.constructor===Symbol&&u!==Symbol.prototype?"symbol":typeof u})(h)}function a(h,u){if(!(h instanceof u))throw new TypeError("Cannot call a class as a function")}function s(h,u){for(var f=0;f<u.length;f++){var c=u[f];c.enumerable=c.enumerable||!1,c.configurable=!0,"value"in c&&(c.writable=!0),Object.defineProperty(h,c.key,c)}}function l(h,u){return(l=Object.setPrototypeOf||function(f,c){return f.__proto__=c,f})(h,u)}function p(h){var u=function(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch{return!1}}();return function(){var f,c=g(h);if(u){var v=g(this).constructor;f=Reflect.construct(c,arguments,v)}else f=c.apply(this,arguments);return d(this,f)}}function d(h,u){return!u||o(u)!=="object"&&typeof u!="function"?function(f){if(f===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return f}(h):u}function g(h){return(g=Object.setPrototypeOf?Object.getPrototypeOf:function(u){return u.__proto__||Object.getPrototypeOf(u)})(h)}var y=function(h){(function(m,b){if(typeof b!="function"&&b!==null)throw new TypeError("Super expression must either be null or a function");m.prototype=Object.create(b&&b.prototype,{constructor:{value:m,writable:!0,configurable:!0}}),b&&l(m,b)})(v,h);var u,f,c=p(v);function v(){return a(this,v),c.apply(this,arguments)}return u=v,(f=[{key:"render",value:function(m,b){m.leafNode("brk",b)}},{key:"parseOpen",value:function(m){return m.name==="brk"&&(this.model=m.attributes.ref,!0)}},{key:"parseText",value:function(){}},{key:"parseClose",value:function(){return!1}},{key:"tag",get:function(){return"brk"}}])&&s(u.prototype,f),v}(e("../base-xform"));n.exports=y},{"../base-xform":31}],102:[function(e,n,i){function o(u){return(o=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(f){return typeof f}:function(f){return f&&typeof Symbol=="function"&&f.constructor===Symbol&&f!==Symbol.prototype?"symbol":typeof f})(u)}function a(u,f){if(!(u instanceof f))throw new TypeError("Cannot call a class as a function")}function s(u,f){for(var c=0;c<f.length;c++){var v=f[c];v.enumerable=v.enumerable||!1,v.configurable=!0,"value"in v&&(v.writable=!0),Object.defineProperty(u,v.key,v)}}function l(u,f){return(l=Object.setPrototypeOf||function(c,v){return c.__proto__=v,c})(u,f)}function p(u){var f=function(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch{return!1}}();return function(){var c,v=g(u);if(f){var m=g(this).constructor;c=Reflect.construct(v,arguments,m)}else c=v.apply(this,arguments);return d(this,c)}}function d(u,f){return!f||o(f)!=="object"&&typeof f!="function"?function(c){if(c===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return c}(u):f}function g(u){return(g=Object.setPrototypeOf?Object.getPrototypeOf:function(f){return f.__proto__||Object.getPrototypeOf(f)})(u)}var y=e("../../../utils/under-dash"),h=function(u){(function(b,w){if(typeof w!="function"&&w!==null)throw new TypeError("Super expression must either be null or a function");b.prototype=Object.create(w&&w.prototype,{constructor:{value:b,writable:!0,configurable:!0}}),w&&l(b,w)})(m,u);var f,c,v=p(m);function m(){return a(this,m),v.apply(this,arguments)}return f=m,(c=[{key:"render",value:function(b,w){if(w){var _={left:w.left,right:w.right,top:w.top,bottom:w.bottom,header:w.header,footer:w.footer};y.some(_,function(C){return C!==void 0})&&b.leafNode(this.tag,_)}}},{key:"parseOpen",value:function(b){switch(b.name){case this.tag:return this.model={left:parseFloat(b.attributes.left||.7),right:parseFloat(b.attributes.right||.7),top:parseFloat(b.attributes.top||.75),bottom:parseFloat(b.attributes.bottom||.75),header:parseFloat(b.attributes.header||.3),footer:parseFloat(b.attributes.footer||.3)},!0;default:return!1}}},{key:"parseText",value:function(){}},{key:"parseClose",value:function(){return!1}},{key:"tag",get:function(){return"pageMargins"}}])&&s(f.prototype,c),m}(e("../base-xform"));n.exports=h},{"../../../utils/under-dash":25,"../base-xform":31}],103:[function(e,n,i){function o(h){return(o=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(u){return typeof u}:function(u){return u&&typeof Symbol=="function"&&u.constructor===Symbol&&u!==Symbol.prototype?"symbol":typeof u})(h)}function a(h,u){if(!(h instanceof u))throw new TypeError("Cannot call a class as a function")}function s(h,u){for(var f=0;f<u.length;f++){var c=u[f];c.enumerable=c.enumerable||!1,c.configurable=!0,"value"in c&&(c.writable=!0),Object.defineProperty(h,c.key,c)}}function l(h,u){return(l=Object.setPrototypeOf||function(f,c){return f.__proto__=c,f})(h,u)}function p(h){var u=function(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch{return!1}}();return function(){var f,c=g(h);if(u){var v=g(this).constructor;f=Reflect.construct(c,arguments,v)}else f=c.apply(this,arguments);return d(this,f)}}function d(h,u){return!u||o(u)!=="object"&&typeof u!="function"?function(f){if(f===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return f}(h):u}function g(h){return(g=Object.setPrototypeOf?Object.getPrototypeOf:function(u){return u.__proto__||Object.getPrototypeOf(u)})(h)}var y=function(h){(function(m,b){if(typeof b!="function"&&b!==null)throw new TypeError("Super expression must either be null or a function");m.prototype=Object.create(b&&b.prototype,{constructor:{value:m,writable:!0,configurable:!0}}),b&&l(m,b)})(v,h);var u,f,c=p(v);function v(){return a(this,v),c.apply(this,arguments)}return u=v,(f=[{key:"render",value:function(m,b){return!(!b||!b.fitToPage||(m.leafNode(this.tag,{fitToPage:b.fitToPage?"1":void 0}),0))}},{key:"parseOpen",value:function(m){return m.name===this.tag&&(this.model={fitToPage:m.attributes.fitToPage==="1"},!0)}},{key:"parseText",value:function(){}},{key:"parseClose",value:function(){return!1}},{key:"tag",get:function(){return"pageSetUpPr"}}])&&s(u.prototype,f),v}(e("../base-xform"));n.exports=y},{"../base-xform":31}],104:[function(e,n,i){function o(m){return(o=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(b){return typeof b}:function(b){return b&&typeof Symbol=="function"&&b.constructor===Symbol&&b!==Symbol.prototype?"symbol":typeof b})(m)}function a(m,b){if(!(m instanceof b))throw new TypeError("Cannot call a class as a function")}function s(m,b){for(var w=0;w<b.length;w++){var _=b[w];_.enumerable=_.enumerable||!1,_.configurable=!0,"value"in _&&(_.writable=!0),Object.defineProperty(m,_.key,_)}}function l(m,b){return(l=Object.setPrototypeOf||function(w,_){return w.__proto__=_,w})(m,b)}function p(m){var b=function(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch{return!1}}();return function(){var w,_=g(m);if(b){var C=g(this).constructor;w=Reflect.construct(_,arguments,C)}else w=_.apply(this,arguments);return d(this,w)}}function d(m,b){return!b||o(b)!=="object"&&typeof b!="function"?function(w){if(w===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return w}(m):b}function g(m){return(g=Object.setPrototypeOf?Object.getPrototypeOf:function(b){return b.__proto__||Object.getPrototypeOf(b)})(m)}var y=e("../../../utils/under-dash");function h(m){return m?"1":void 0}function u(m){switch(m){case"overThenDown":return m;default:return}}function f(m){switch(m){case"atEnd":case"asDisplyed":return m;default:return}}function c(m){switch(m){case"dash":case"blank":case"NA":return m;default:return}}var v=function(m){(function(R,I){if(typeof I!="function"&&I!==null)throw new TypeError("Super expression must either be null or a function");R.prototype=Object.create(I&&I.prototype,{constructor:{value:R,writable:!0,configurable:!0}}),I&&l(R,I)})(C,m);var b,w,_=p(C);function C(){return a(this,C),_.apply(this,arguments)}return b=C,(w=[{key:"render",value:function(R,I){if(I){var P={paperSize:I.paperSize,orientation:I.orientation,horizontalDpi:I.horizontalDpi,verticalDpi:I.verticalDpi,pageOrder:u(I.pageOrder),blackAndWhite:h(I.blackAndWhite),draft:h(I.draft),cellComments:f(I.cellComments),errors:c(I.errors),scale:I.scale,fitToWidth:I.fitToWidth,fitToHeight:I.fitToHeight,firstPageNumber:I.firstPageNumber,useFirstPageNumber:h(I.firstPageNumber),usePrinterDefaults:h(I.usePrinterDefaults),copies:I.copies};y.some(P,function(N){return N!==void 0})&&R.leafNode(this.tag,P)}}},{key:"parseOpen",value:function(R){switch(R.name){case this.tag:return this.model={paperSize:(I=R.attributes.paperSize,I!==void 0?parseInt(I,10):void 0),orientation:R.attributes.orientation||"portrait",horizontalDpi:parseInt(R.attributes.horizontalDpi||"4294967295",10),verticalDpi:parseInt(R.attributes.verticalDpi||"4294967295",10),pageOrder:R.attributes.pageOrder||"downThenOver",blackAndWhite:R.attributes.blackAndWhite==="1",draft:R.attributes.draft==="1",cellComments:R.attributes.cellComments||"None",errors:R.attributes.errors||"displayed",scale:parseInt(R.attributes.scale||"100",10),fitToWidth:parseInt(R.attributes.fitToWidth||"1",10),fitToHeight:parseInt(R.attributes.fitToHeight||"1",10),firstPageNumber:parseInt(R.attributes.firstPageNumber||"1",10),useFirstPageNumber:R.attributes.useFirstPageNumber==="1",usePrinterDefaults:R.attributes.usePrinterDefaults==="1",copies:parseInt(R.attributes.copies||"1",10)},!0;default:return!1}var I}},{key:"parseText",value:function(){}},{key:"parseClose",value:function(){return!1}},{key:"tag",get:function(){return"pageSetup"}}])&&s(b.prototype,w),C}(e("../base-xform"));n.exports=v},{"../../../utils/under-dash":25,"../base-xform":31}],105:[function(e,n,i){function o(h){return(o=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(u){return typeof u}:function(u){return u&&typeof Symbol=="function"&&u.constructor===Symbol&&u!==Symbol.prototype?"symbol":typeof u})(h)}function a(h,u){if(!(h instanceof u))throw new TypeError("Cannot call a class as a function")}function s(h,u){for(var f=0;f<u.length;f++){var c=u[f];c.enumerable=c.enumerable||!1,c.configurable=!0,"value"in c&&(c.writable=!0),Object.defineProperty(h,c.key,c)}}function l(h,u){return(l=Object.setPrototypeOf||function(f,c){return f.__proto__=c,f})(h,u)}function p(h){var u=function(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch{return!1}}();return function(){var f,c=g(h);if(u){var v=g(this).constructor;f=Reflect.construct(c,arguments,v)}else f=c.apply(this,arguments);return d(this,f)}}function d(h,u){return!u||o(u)!=="object"&&typeof u!="function"?function(f){if(f===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return f}(h):u}function g(h){return(g=Object.setPrototypeOf?Object.getPrototypeOf:function(u){return u.__proto__||Object.getPrototypeOf(u)})(h)}var y=function(h){(function(m,b){if(typeof b!="function"&&b!==null)throw new TypeError("Super expression must either be null or a function");m.prototype=Object.create(b&&b.prototype,{constructor:{value:m,writable:!0,configurable:!0}}),b&&l(m,b)})(v,h);var u,f,c=p(v);function v(){return a(this,v),c.apply(this,arguments)}return u=v,(f=[{key:"render",value:function(m,b){b&&m.leafNode(this.tag,{"r:id":b.rId})}},{key:"parseOpen",value:function(m){switch(m.name){case this.tag:return this.model={rId:m.attributes["r:id"]},!0;default:return!1}}},{key:"parseText",value:function(){}},{key:"parseClose",value:function(){return!1}},{key:"tag",get:function(){return"picture"}}])&&s(u.prototype,f),v}(e("../base-xform"));n.exports=y},{"../base-xform":31}],106:[function(e,n,i){function o(f){return(o=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(c){return typeof c}:function(c){return c&&typeof Symbol=="function"&&c.constructor===Symbol&&c!==Symbol.prototype?"symbol":typeof c})(f)}function a(f,c){if(!(f instanceof c))throw new TypeError("Cannot call a class as a function")}function s(f,c){for(var v=0;v<c.length;v++){var m=c[v];m.enumerable=m.enumerable||!1,m.configurable=!0,"value"in m&&(m.writable=!0),Object.defineProperty(f,m.key,m)}}function l(f,c){return(l=Object.setPrototypeOf||function(v,m){return v.__proto__=m,v})(f,c)}function p(f){var c=function(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch{return!1}}();return function(){var v,m=g(f);if(c){var b=g(this).constructor;v=Reflect.construct(m,arguments,b)}else v=m.apply(this,arguments);return d(this,v)}}function d(f,c){return!c||o(c)!=="object"&&typeof c!="function"?function(v){if(v===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return v}(f):c}function g(f){return(g=Object.setPrototypeOf?Object.getPrototypeOf:function(c){return c.__proto__||Object.getPrototypeOf(c)})(f)}var y=e("../../../utils/under-dash");function h(f){return f?"1":void 0}var u=function(f){(function(w,_){if(typeof _!="function"&&_!==null)throw new TypeError("Super expression must either be null or a function");w.prototype=Object.create(_&&_.prototype,{constructor:{value:w,writable:!0,configurable:!0}}),_&&l(w,_)})(b,f);var c,v,m=p(b);function b(){return a(this,b),m.apply(this,arguments)}return c=b,(v=[{key:"render",value:function(w,_){if(_){var C={headings:h(_.showRowColHeaders),gridLines:h(_.showGridLines),horizontalCentered:h(_.horizontalCentered),verticalCentered:h(_.verticalCentered)};y.some(C,function(R){return R!==void 0})&&w.leafNode(this.tag,C)}}},{key:"parseOpen",value:function(w){switch(w.name){case this.tag:return this.model={showRowColHeaders:w.attributes.headings==="1",showGridLines:w.attributes.gridLines==="1",horizontalCentered:w.attributes.horizontalCentered==="1",verticalCentered:w.attributes.verticalCentered==="1"},!0;default:return!1}}},{key:"parseText",value:function(){}},{key:"parseClose",value:function(){return!1}},{key:"tag",get:function(){return"printOptions"}}])&&s(c.prototype,v),b}(e("../base-xform"));n.exports=u},{"../../../utils/under-dash":25,"../base-xform":31}],107:[function(e,n,i){function o(h){return(o=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(u){return typeof u}:function(u){return u&&typeof Symbol=="function"&&u.constructor===Symbol&&u!==Symbol.prototype?"symbol":typeof u})(h)}function a(h,u){for(var f=0;f<u.length;f++){var c=u[f];c.enumerable=c.enumerable||!1,c.configurable=!0,"value"in c&&(c.writable=!0),Object.defineProperty(h,c.key,c)}}function s(h,u){return(s=Object.setPrototypeOf||function(f,c){return f.__proto__=c,f})(h,u)}function l(h){var u=function(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch{return!1}}();return function(){var f,c=d(h);if(u){var v=d(this).constructor;f=Reflect.construct(c,arguments,v)}else f=c.apply(this,arguments);return p(this,f)}}function p(h,u){return!u||o(u)!=="object"&&typeof u!="function"?function(f){if(f===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return f}(h):u}function d(h){return(d=Object.setPrototypeOf?Object.getPrototypeOf:function(u){return u.__proto__||Object.getPrototypeOf(u)})(h)}var g=e("./page-breaks-xform"),y=function(h){(function(m,b){if(typeof b!="function"&&b!==null)throw new TypeError("Super expression must either be null or a function");m.prototype=Object.create(b&&b.prototype,{constructor:{value:m,writable:!0,configurable:!0}}),b&&s(m,b)})(v,h);var u,f,c=l(v);function v(){(function(b,w){if(!(b instanceof w))throw new TypeError("Cannot call a class as a function")})(this,v);var m={tag:"rowBreaks",count:!0,childXform:new g};return c.call(this,m)}return u=v,(f=[{key:"render",value:function(m,b){if(b&&b.length){m.openNode(this.tag,this.$),this.count&&(m.addAttribute(this.$count,b.length),m.addAttribute("manualBreakCount",b.length));var w=this.childXform;b.forEach(function(_){w.render(m,_)}),m.closeNode()}else this.empty&&m.leafNode(this.tag)}}])&&a(u.prototype,f),v}(e("../list-xform"));n.exports=y},{"../list-xform":70,"./page-breaks-xform":101}],108:[function(e,n,i){function o(u){return(o=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(f){return typeof f}:function(f){return f&&typeof Symbol=="function"&&f.constructor===Symbol&&f!==Symbol.prototype?"symbol":typeof f})(u)}function a(u,f){for(var c=0;c<f.length;c++){var v=f[c];v.enumerable=v.enumerable||!1,v.configurable=!0,"value"in v&&(v.writable=!0),Object.defineProperty(u,v.key,v)}}function s(u,f){return(s=Object.setPrototypeOf||function(c,v){return c.__proto__=v,c})(u,f)}function l(u){var f=function(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch{return!1}}();return function(){var c,v=d(u);if(f){var m=d(this).constructor;c=Reflect.construct(v,arguments,m)}else c=v.apply(this,arguments);return p(this,c)}}function p(u,f){return!f||o(f)!=="object"&&typeof f!="function"?function(c){if(c===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return c}(u):f}function d(u){return(d=Object.setPrototypeOf?Object.getPrototypeOf:function(f){return f.__proto__||Object.getPrototypeOf(f)})(u)}var g=e("../base-xform"),y=e("./cell-xform"),h=function(u){(function(b,w){if(typeof w!="function"&&w!==null)throw new TypeError("Super expression must either be null or a function");b.prototype=Object.create(w&&w.prototype,{constructor:{value:b,writable:!0,configurable:!0}}),w&&s(b,w)})(m,u);var f,c,v=l(m);function m(b){var w;return function(_,C){if(!(_ instanceof C))throw new TypeError("Cannot call a class as a function")}(this,m),(w=v.call(this)).maxItems=b&&b.maxItems,w.map={c:new y},w}return f=m,(c=[{key:"prepare",value:function(b,w){var _=w.styles.addStyleModel(b.style);_&&(b.styleId=_);var C=this.map.c;b.cells.forEach(function(R){C.prepare(R,w)})}},{key:"render",value:function(b,w,_){b.openNode("row"),b.addAttribute("r",w.number),w.height&&(b.addAttribute("ht",w.height),b.addAttribute("customHeight","1")),w.hidden&&b.addAttribute("hidden","1"),w.min>0&&w.max>0&&w.min<=w.max&&b.addAttribute("spans","".concat(w.min,":").concat(w.max)),w.styleId&&(b.addAttribute("s",w.styleId),b.addAttribute("customFormat","1")),b.addAttribute("x14ac:dyDescent","0.25"),w.outlineLevel&&b.addAttribute("outlineLevel",w.outlineLevel),w.collapsed&&b.addAttribute("collapsed","1");var C=this.map.c;w.cells.forEach(function(R){C.render(b,R,_)}),b.closeNode()}},{key:"parseOpen",value:function(b){if(this.parser)return this.parser.parseOpen(b),!0;if(b.name==="row"){this.numRowsSeen+=1;var w=b.attributes.spans?b.attributes.spans.split(":").map(function(C){return parseInt(C,10)}):[void 0,void 0],_=this.model={number:parseInt(b.attributes.r,10),min:w[0],max:w[1],cells:[]};return b.attributes.s&&(_.styleId=parseInt(b.attributes.s,10)),b.attributes.hidden!==!0&&b.attributes.hidden!=="true"&&b.attributes.hidden!==1&&b.attributes.hidden!=="1"||(_.hidden=!0),b.attributes.bestFit&&(_.bestFit=!0),b.attributes.ht&&(_.height=parseFloat(b.attributes.ht)),b.attributes.outlineLevel&&(_.outlineLevel=parseInt(b.attributes.outlineLevel,10)),b.attributes.collapsed&&(_.collapsed=!0),!0}return this.parser=this.map[b.name],!!this.parser&&(this.parser.parseOpen(b),!0)}},{key:"parseText",value:function(b){this.parser&&this.parser.parseText(b)}},{key:"parseClose",value:function(b){if(this.parser){if(!this.parser.parseClose(b)){if(this.model.cells.push(this.parser.model),this.maxItems&&this.model.cells.length>this.maxItems)throw new Error("Max column count (".concat(this.maxItems,") exceeded"));this.parser=void 0}return!0}return!1}},{key:"reconcile",value:function(b,w){b.style=b.styleId?w.styles.getStyleModel(b.styleId):{},b.styleId!==void 0&&(b.styleId=void 0);var _=this.map.c;b.cells.forEach(function(C){_.reconcile(C,w)})}},{key:"tag",get:function(){return"row"}}])&&a(f.prototype,c),m}(g);n.exports=h},{"../base-xform":31,"./cell-xform":72}],109:[function(e,n,i){function o(u){return(o=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(f){return typeof f}:function(f){return f&&typeof Symbol=="function"&&f.constructor===Symbol&&f!==Symbol.prototype?"symbol":typeof f})(u)}function a(u,f){if(!(u instanceof f))throw new TypeError("Cannot call a class as a function")}function s(u,f){for(var c=0;c<f.length;c++){var v=f[c];v.enumerable=v.enumerable||!1,v.configurable=!0,"value"in v&&(v.writable=!0),Object.defineProperty(u,v.key,v)}}function l(u,f){return(l=Object.setPrototypeOf||function(c,v){return c.__proto__=v,c})(u,f)}function p(u){var f=function(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch{return!1}}();return function(){var c,v=g(u);if(f){var m=g(this).constructor;c=Reflect.construct(v,arguments,m)}else c=v.apply(this,arguments);return d(this,c)}}function d(u,f){return!f||o(f)!=="object"&&typeof f!="function"?function(c){if(c===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return c}(u):f}function g(u){return(g=Object.setPrototypeOf?Object.getPrototypeOf:function(f){return f.__proto__||Object.getPrototypeOf(f)})(u)}var y=e("../../../utils/under-dash"),h=function(u){(function(b,w){if(typeof w!="function"&&w!==null)throw new TypeError("Super expression must either be null or a function");b.prototype=Object.create(w&&w.prototype,{constructor:{value:b,writable:!0,configurable:!0}}),w&&l(b,w)})(m,u);var f,c,v=p(m);function m(){return a(this,m),v.apply(this,arguments)}return f=m,(c=[{key:"render",value:function(b,w){if(w){var _={defaultRowHeight:w.defaultRowHeight,outlineLevelRow:w.outlineLevelRow,outlineLevelCol:w.outlineLevelCol,"x14ac:dyDescent":w.dyDescent};w.defaultColWidth&&(_.defaultColWidth=w.defaultColWidth),w.defaultRowHeight&&w.defaultRowHeight===15||(_.customHeight="1"),y.some(_,function(C){return C!==void 0})&&b.leafNode("sheetFormatPr",_)}}},{key:"parseOpen",value:function(b){return b.name==="sheetFormatPr"&&(this.model={defaultRowHeight:parseFloat(b.attributes.defaultRowHeight||"0"),dyDescent:parseFloat(b.attributes["x14ac:dyDescent"]||"0"),outlineLevelRow:parseInt(b.attributes.outlineLevelRow||"0",10),outlineLevelCol:parseInt(b.attributes.outlineLevelCol||"0",10)},b.attributes.defaultColWidth&&(this.model.defaultColWidth=parseFloat(b.attributes.defaultColWidth)),!0)}},{key:"parseText",value:function(){}},{key:"parseClose",value:function(){return!1}},{key:"tag",get:function(){return"sheetFormatPr"}}])&&s(f.prototype,c),m}(e("../base-xform"));n.exports=h},{"../../../utils/under-dash":25,"../base-xform":31}],110:[function(e,n,i){function o(c){return(o=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(v){return typeof v}:function(v){return v&&typeof Symbol=="function"&&v.constructor===Symbol&&v!==Symbol.prototype?"symbol":typeof v})(c)}function a(c,v){for(var m=0;m<v.length;m++){var b=v[m];b.enumerable=b.enumerable||!1,b.configurable=!0,"value"in b&&(b.writable=!0),Object.defineProperty(c,b.key,b)}}function s(c,v){return(s=Object.setPrototypeOf||function(m,b){return m.__proto__=b,m})(c,v)}function l(c){var v=function(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch{return!1}}();return function(){var m,b=d(c);if(v){var w=d(this).constructor;m=Reflect.construct(b,arguments,w)}else m=b.apply(this,arguments);return p(this,m)}}function p(c,v){return!v||o(v)!=="object"&&typeof v!="function"?function(m){if(m===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return m}(c):v}function d(c){return(d=Object.setPrototypeOf?Object.getPrototypeOf:function(v){return v.__proto__||Object.getPrototypeOf(v)})(c)}var g=e("../base-xform"),y=e("../style/color-xform"),h=e("./page-setup-properties-xform"),u=e("./outline-properties-xform"),f=function(c){(function(_,C){if(typeof C!="function"&&C!==null)throw new TypeError("Super expression must either be null or a function");_.prototype=Object.create(C&&C.prototype,{constructor:{value:_,writable:!0,configurable:!0}}),C&&s(_,C)})(w,c);var v,m,b=l(w);function w(){var _;return function(C,R){if(!(C instanceof R))throw new TypeError("Cannot call a class as a function")}(this,w),(_=b.call(this)).map={tabColor:new y("tabColor"),pageSetUpPr:new h,outlinePr:new u},_}return v=w,(m=[{key:"render",value:function(_,C){if(C){_.addRollback(),_.openNode("sheetPr");var R=!1;R=this.map.tabColor.render(_,C.tabColor)||R,R=this.map.pageSetUpPr.render(_,C.pageSetup)||R,(R=this.map.outlinePr.render(_,C.outlineProperties)||R)?(_.closeNode(),_.commit()):_.rollback()}}},{key:"parseOpen",value:function(_){return this.parser?(this.parser.parseOpen(_),!0):_.name===this.tag?(this.reset(),!0):!!this.map[_.name]&&(this.parser=this.map[_.name],this.parser.parseOpen(_),!0)}},{key:"parseText",value:function(_){return!!this.parser&&(this.parser.parseText(_),!0)}},{key:"parseClose",value:function(_){return this.parser?(this.parser.parseClose(_)||(this.parser=void 0),!0):(this.map.tabColor.model||this.map.pageSetUpPr.model||this.map.outlinePr.model?(this.model={},this.map.tabColor.model&&(this.model.tabColor=this.map.tabColor.model),this.map.pageSetUpPr.model&&(this.model.pageSetup=this.map.pageSetUpPr.model),this.map.outlinePr.model&&(this.model.outlineProperties=this.map.outlinePr.model)):this.model=null,!1)}},{key:"tag",get:function(){return"sheetPr"}}])&&a(v.prototype,m),w}(g);n.exports=f},{"../base-xform":31,"../style/color-xform":127,"./outline-properties-xform":100,"./page-setup-properties-xform":103}],111:[function(e,n,i){function o(c){return(o=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(v){return typeof v}:function(v){return v&&typeof Symbol=="function"&&v.constructor===Symbol&&v!==Symbol.prototype?"symbol":typeof v})(c)}function a(c,v){if(!(c instanceof v))throw new TypeError("Cannot call a class as a function")}function s(c,v){for(var m=0;m<v.length;m++){var b=v[m];b.enumerable=b.enumerable||!1,b.configurable=!0,"value"in b&&(b.writable=!0),Object.defineProperty(c,b.key,b)}}function l(c,v){return(l=Object.setPrototypeOf||function(m,b){return m.__proto__=b,m})(c,v)}function p(c){var v=function(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch{return!1}}();return function(){var m,b=g(c);if(v){var w=g(this).constructor;m=Reflect.construct(b,arguments,w)}else m=b.apply(this,arguments);return d(this,m)}}function d(c,v){return!v||o(v)!=="object"&&typeof v!="function"?function(m){if(m===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return m}(c):v}function g(c){return(g=Object.setPrototypeOf?Object.getPrototypeOf:function(v){return v.__proto__||Object.getPrototypeOf(v)})(c)}var y=e("../../../utils/under-dash");function h(c,v){return c?v:void 0}function u(c,v){return c===v||void 0}var f=function(c){(function(_,C){if(typeof C!="function"&&C!==null)throw new TypeError("Super expression must either be null or a function");_.prototype=Object.create(C&&C.prototype,{constructor:{value:_,writable:!0,configurable:!0}}),C&&l(_,C)})(w,c);var v,m,b=p(w);function w(){return a(this,w),b.apply(this,arguments)}return v=w,(m=[{key:"render",value:function(_,C){if(C){var R={sheet:h(C.sheet,"1"),selectLockedCells:C.selectLockedCells===!1?"1":void 0,selectUnlockedCells:C.selectUnlockedCells===!1?"1":void 0,formatCells:h(C.formatCells,"0"),formatColumns:h(C.formatColumns,"0"),formatRows:h(C.formatRows,"0"),insertColumns:h(C.insertColumns,"0"),insertRows:h(C.insertRows,"0"),insertHyperlinks:h(C.insertHyperlinks,"0"),deleteColumns:h(C.deleteColumns,"0"),deleteRows:h(C.deleteRows,"0"),sort:h(C.sort,"0"),autoFilter:h(C.autoFilter,"0"),pivotTables:h(C.pivotTables,"0")};C.sheet&&(R.algorithmName=C.algorithmName,R.hashValue=C.hashValue,R.saltValue=C.saltValue,R.spinCount=C.spinCount,R.objects=h(C.objects===!1,"1"),R.scenarios=h(C.scenarios===!1,"1")),y.some(R,function(I){return I!==void 0})&&_.leafNode(this.tag,R)}}},{key:"parseOpen",value:function(_){switch(_.name){case this.tag:return this.model={sheet:u(_.attributes.sheet,"1"),objects:_.attributes.objects!=="1"&&void 0,scenarios:_.attributes.scenarios!=="1"&&void 0,selectLockedCells:_.attributes.selectLockedCells!=="1"&&void 0,selectUnlockedCells:_.attributes.selectUnlockedCells!=="1"&&void 0,formatCells:u(_.attributes.formatCells,"0"),formatColumns:u(_.attributes.formatColumns,"0"),formatRows:u(_.attributes.formatRows,"0"),insertColumns:u(_.attributes.insertColumns,"0"),insertRows:u(_.attributes.insertRows,"0"),insertHyperlinks:u(_.attributes.insertHyperlinks,"0"),deleteColumns:u(_.attributes.deleteColumns,"0"),deleteRows:u(_.attributes.deleteRows,"0"),sort:u(_.attributes.sort,"0"),autoFilter:u(_.attributes.autoFilter,"0"),pivotTables:u(_.attributes.pivotTables,"0")},_.attributes.algorithmName&&(this.model.algorithmName=_.attributes.algorithmName,this.model.hashValue=_.attributes.hashValue,this.model.saltValue=_.attributes.saltValue,this.model.spinCount=parseInt(_.attributes.spinCount,10)),!0;default:return!1}}},{key:"parseText",value:function(){}},{key:"parseClose",value:function(){return!1}},{key:"tag",get:function(){return"sheetProtection"}}])&&s(v.prototype,m),w}(e("../base-xform"));n.exports=f},{"../../../utils/under-dash":25,"../base-xform":31}],112:[function(e,n,i){function o(c){return(o=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(v){return typeof v}:function(v){return v&&typeof Symbol=="function"&&v.constructor===Symbol&&v!==Symbol.prototype?"symbol":typeof v})(c)}function a(c,v){if(!(c instanceof v))throw new TypeError("Cannot call a class as a function")}function s(c,v){for(var m=0;m<v.length;m++){var b=v[m];b.enumerable=b.enumerable||!1,b.configurable=!0,"value"in b&&(b.writable=!0),Object.defineProperty(c,b.key,b)}}function l(c,v){return(l=Object.setPrototypeOf||function(m,b){return m.__proto__=b,m})(c,v)}function p(c){var v=function(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch{return!1}}();return function(){var m,b=g(c);if(v){var w=g(this).constructor;m=Reflect.construct(b,arguments,w)}else m=b.apply(this,arguments);return d(this,m)}}function d(c,v){return!v||o(v)!=="object"&&typeof v!="function"?function(m){if(m===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return m}(c):v}function g(c){return(g=Object.setPrototypeOf?Object.getPrototypeOf:function(v){return v.__proto__||Object.getPrototypeOf(v)})(c)}var y=e("../../../utils/col-cache"),h=e("../base-xform"),u={frozen:"frozen",frozenSplit:"frozen",split:"split"},f=function(c){(function(_,C){if(typeof C!="function"&&C!==null)throw new TypeError("Super expression must either be null or a function");_.prototype=Object.create(C&&C.prototype,{constructor:{value:_,writable:!0,configurable:!0}}),C&&l(_,C)})(w,c);var v,m,b=p(w);function w(){return a(this,w),b.apply(this,arguments)}return v=w,(m=[{key:"prepare",value:function(_){switch(_.state){case"frozen":case"split":break;default:_.state="normal"}}},{key:"render",value:function(_,C){_.openNode("sheetView",{workbookViewId:C.workbookViewId||0});var R,I,P,N,A=function($,T,M){M&&_.addAttribute($,T)};switch(A("rightToLeft","1",C.rightToLeft===!0),A("tabSelected","1",C.tabSelected),A("showRuler","0",C.showRuler===!1),A("showRowColHeaders","0",C.showRowColHeaders===!1),A("showGridLines","0",C.showGridLines===!1),A("zoomScale",C.zoomScale,C.zoomScale),A("zoomScaleNormal",C.zoomScaleNormal,C.zoomScaleNormal),A("view",C.style,C.style),C.state){case"frozen":I=C.xSplit||0,P=C.ySplit||0,R=C.topLeftCell||y.getAddress(P+1,I+1).address,N=(C.xSplit&&C.ySplit?"bottomRight":C.xSplit&&"topRight")||"bottomLeft",_.leafNode("pane",{xSplit:C.xSplit||void 0,ySplit:C.ySplit||void 0,topLeftCell:R,activePane:N,state:"frozen"}),_.leafNode("selection",{pane:N,activeCell:C.activeCell,sqref:C.activeCell});break;case"split":C.activePane==="topLeft"&&(C.activePane=void 0),_.leafNode("pane",{xSplit:C.xSplit||void 0,ySplit:C.ySplit||void 0,topLeftCell:C.topLeftCell,activePane:C.activePane}),_.leafNode("selection",{pane:C.activePane,activeCell:C.activeCell,sqref:C.activeCell});break;case"normal":C.activeCell&&_.leafNode("selection",{activeCell:C.activeCell,sqref:C.activeCell})}_.closeNode()}},{key:"parseOpen",value:function(_){switch(_.name){case"sheetView":return this.sheetView={workbookViewId:parseInt(_.attributes.workbookViewId,10),rightToLeft:_.attributes.rightToLeft==="1",tabSelected:_.attributes.tabSelected==="1",showRuler:_.attributes.showRuler!=="0",showRowColHeaders:_.attributes.showRowColHeaders!=="0",showGridLines:_.attributes.showGridLines!=="0",zoomScale:parseInt(_.attributes.zoomScale||"100",10),zoomScaleNormal:parseInt(_.attributes.zoomScaleNormal||"100",10),style:_.attributes.view},this.pane=void 0,this.selections={},!0;case"pane":return this.pane={xSplit:parseInt(_.attributes.xSplit||"0",10),ySplit:parseInt(_.attributes.ySplit||"0",10),topLeftCell:_.attributes.topLeftCell,activePane:_.attributes.activePane||"topLeft",state:_.attributes.state},!0;case"selection":var C=_.attributes.pane||"topLeft";return this.selections[C]={pane:C,activeCell:_.attributes.activeCell},!0;default:return!1}}},{key:"parseText",value:function(){}},{key:"parseClose",value:function(_){var C,R;switch(_){case"sheetView":return this.sheetView&&this.pane?(C=this.model={workbookViewId:this.sheetView.workbookViewId,rightToLeft:this.sheetView.rightToLeft,state:u[this.pane.state]||"split",xSplit:this.pane.xSplit,ySplit:this.pane.ySplit,topLeftCell:this.pane.topLeftCell,showRuler:this.sheetView.showRuler,showRowColHeaders:this.sheetView.showRowColHeaders,showGridLines:this.sheetView.showGridLines,zoomScale:this.sheetView.zoomScale,zoomScaleNormal:this.sheetView.zoomScaleNormal},this.model.state==="split"&&(C.activePane=this.pane.activePane),(R=this.selections[this.pane.activePane])&&R.activeCell&&(C.activeCell=R.activeCell),this.sheetView.style&&(C.style=this.sheetView.style)):(C=this.model={workbookViewId:this.sheetView.workbookViewId,rightToLeft:this.sheetView.rightToLeft,state:"normal",showRuler:this.sheetView.showRuler,showRowColHeaders:this.sheetView.showRowColHeaders,showGridLines:this.sheetView.showGridLines,zoomScale:this.sheetView.zoomScale,zoomScaleNormal:this.sheetView.zoomScaleNormal},(R=this.selections.topLeft)&&R.activeCell&&(C.activeCell=R.activeCell),this.sheetView.style&&(C.style=this.sheetView.style)),!1;default:return!0}}},{key:"reconcile",value:function(){}},{key:"tag",get:function(){return"sheetView"}}])&&s(v.prototype,m),w}(h);n.exports=f},{"../../../utils/col-cache":19,"../base-xform":31}],113:[function(e,n,i){function o(h){return(o=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(u){return typeof u}:function(u){return u&&typeof Symbol=="function"&&u.constructor===Symbol&&u!==Symbol.prototype?"symbol":typeof u})(h)}function a(h,u){if(!(h instanceof u))throw new TypeError("Cannot call a class as a function")}function s(h,u){for(var f=0;f<u.length;f++){var c=u[f];c.enumerable=c.enumerable||!1,c.configurable=!0,"value"in c&&(c.writable=!0),Object.defineProperty(h,c.key,c)}}function l(h,u){return(l=Object.setPrototypeOf||function(f,c){return f.__proto__=c,f})(h,u)}function p(h){var u=function(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch{return!1}}();return function(){var f,c=g(h);if(u){var v=g(this).constructor;f=Reflect.construct(c,arguments,v)}else f=c.apply(this,arguments);return d(this,f)}}function d(h,u){return!u||o(u)!=="object"&&typeof u!="function"?function(f){if(f===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return f}(h):u}function g(h){return(g=Object.setPrototypeOf?Object.getPrototypeOf:function(u){return u.__proto__||Object.getPrototypeOf(u)})(h)}var y=function(h){(function(m,b){if(typeof b!="function"&&b!==null)throw new TypeError("Super expression must either be null or a function");m.prototype=Object.create(b&&b.prototype,{constructor:{value:m,writable:!0,configurable:!0}}),b&&l(m,b)})(v,h);var u,f,c=p(v);function v(){return a(this,v),c.apply(this,arguments)}return u=v,(f=[{key:"render",value:function(m,b){b&&m.leafNode(this.tag,{"r:id":b.rId})}},{key:"parseOpen",value:function(m){switch(m.name){case this.tag:return this.model={rId:m.attributes["r:id"]},!0;default:return!1}}},{key:"parseText",value:function(){}},{key:"parseClose",value:function(){return!1}},{key:"tag",get:function(){return"tablePart"}}])&&s(u.prototype,f),v}(e("../base-xform"));n.exports=y},{"../base-xform":31}],114:[function(e,n,i){function o(U){return(o=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(Y){return typeof Y}:function(Y){return Y&&typeof Symbol=="function"&&Y.constructor===Symbol&&Y!==Symbol.prototype?"symbol":typeof Y})(U)}function a(U,Y){for(var K=0;K<Y.length;K++){var D=Y[K];D.enumerable=D.enumerable||!1,D.configurable=!0,"value"in D&&(D.writable=!0),Object.defineProperty(U,D.key,D)}}function s(U,Y){return(s=Object.setPrototypeOf||function(K,D){return K.__proto__=D,K})(U,Y)}function l(U){var Y=function(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch{return!1}}();return function(){var K,D=d(U);if(Y){var L=d(this).constructor;K=Reflect.construct(D,arguments,L)}else K=D.apply(this,arguments);return p(this,K)}}function p(U,Y){return!Y||o(Y)!=="object"&&typeof Y!="function"?function(K){if(K===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return K}(U):Y}function d(U){return(d=Object.setPrototypeOf?Object.getPrototypeOf:function(Y){return Y.__proto__||Object.getPrototypeOf(Y)})(U)}var g=e("../../../utils/under-dash"),y=e("../../../utils/col-cache"),h=e("../../../utils/xml-stream"),u=e("../../rel-type"),f=e("./merges"),c=e("../base-xform"),v=e("../list-xform"),m=e("./row-xform"),b=e("./col-xform"),w=e("./dimension-xform"),_=e("./hyperlink-xform"),C=e("./merge-cell-xform"),R=e("./data-validations-xform"),I=e("./sheet-properties-xform"),P=e("./sheet-format-properties-xform"),N=e("./sheet-view-xform"),A=e("./sheet-protection-xform"),$=e("./page-margins-xform"),T=e("./page-setup-xform"),M=e("./print-options-xform"),S=e("./auto-filter-xform"),E=e("./picture-xform"),k=e("./drawing-xform"),O=e("./table-part-xform"),x=e("./row-breaks-xform"),j=e("./header-footer-xform"),H=e("./cf/conditional-formattings-xform"),F=e("./ext-lst-xform"),V=function(U,Y){if(!Y||!Y.length)return U;if(!U||!U.length)return Y;var K={},D={};return U.forEach(function(L){K[L.ref]=L,L.rules.forEach(function(B){var z=B.x14Id;z&&(D[z]=B)})}),Y.forEach(function(L){L.rules.forEach(function(B){var z=D[B.x14Id];z?function(q,X){Object.keys(X).forEach(function(ee){var ye=q[ee],de=X[ee];ye===void 0&&de!==void 0&&(q[ee]=de)})}(z,B):K[L.ref]?K[L.ref].rules.push(B):U.push({ref:L.ref,rules:[B]})})}),U},W=function(U){(function(B,z){if(typeof z!="function"&&z!==null)throw new TypeError("Super expression must either be null or a function");B.prototype=Object.create(z&&z.prototype,{constructor:{value:B,writable:!0,configurable:!0}}),z&&s(B,z)})(L,U);var Y,K,D=l(L);function L(B){var z;(function(ye,de){if(!(ye instanceof de))throw new TypeError("Cannot call a class as a function")})(this,L),z=D.call(this);var q=B||{},X=q.maxRows,ee=q.maxCols;return z.map={sheetPr:new I,dimension:new w,sheetViews:new v({tag:"sheetViews",count:!1,childXform:new N}),sheetFormatPr:new P,cols:new v({tag:"cols",count:!1,childXform:new b}),sheetData:new v({tag:"sheetData",count:!1,empty:!0,childXform:new m({maxItems:ee}),maxItems:X}),autoFilter:new S,mergeCells:new v({tag:"mergeCells",count:!0,childXform:new C}),rowBreaks:new x,hyperlinks:new v({tag:"hyperlinks",count:!1,childXform:new _}),pageMargins:new $,dataValidations:new R,pageSetup:new T,headerFooter:new j,printOptions:new M,picture:new E,drawing:new k,sheetProtection:new A,tableParts:new v({tag:"tableParts",count:!0,childXform:new O}),conditionalFormatting:new H,extLst:new F},z}return Y=L,(K=[{key:"prepare",value:function(B,z){var q=this;z.merges=new f,B.hyperlinks=z.hyperlinks=[],B.comments=z.comments=[],z.formulae={},z.siFormulae=0,this.map.cols.prepare(B.cols,z),this.map.sheetData.prepare(B.rows,z),this.map.conditionalFormatting.prepare(B.conditionalFormattings,z),B.mergeCells=z.merges.mergeCells;var X=B.rels=[];function ee(be){return"rId".concat(be.length+1)}if(B.hyperlinks.forEach(function(be){var J=ee(X);be.rId=J,X.push({Id:J,Type:u.Hyperlink,Target:be.target,TargetMode:"External"})}),B.comments.length>0){var ye={Id:ee(X),Type:u.Comments,Target:"../comments".concat(B.id,".xml")};X.push(ye);var de={Id:ee(X),Type:u.VmlDrawing,Target:"../drawings/vmlDrawing".concat(B.id,".vml")};X.push(de),B.comments.forEach(function(be){be.refAddress=y.decodeAddress(be.ref)}),z.commentRefs.push({commentName:"comments".concat(B.id),vmlDrawing:"vmlDrawing".concat(B.id)})}var ge,we=[];B.media.forEach(function(be){if(be.type==="background"){var J=ee(X);ge=z.media[be.imageId],X.push({Id:J,Type:u.Image,Target:"../media/".concat(ge.name,".").concat(ge.extension)}),B.background={rId:J},B.image=z.media[be.imageId]}else if(be.type==="image"){var te=B.drawing;ge=z.media[be.imageId],te||(te=B.drawing={rId:ee(X),name:"drawing".concat(++z.drawingsCount),anchors:[],rels:[]},z.drawings.push(te),X.push({Id:te.rId,Type:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",Target:"../drawings/".concat(te.name,".xml")}));var ie=q.preImageId===be.imageId?we[be.imageId]:we[te.rels.length];ie||(ie=ee(te.rels),we[te.rels.length]=ie,te.rels.push({Id:ie,Type:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",Target:"../media/".concat(ge.name,".").concat(ge.extension)}));var fe={picture:{rId:ie},range:be.range};if(be.hyperlinks&&be.hyperlinks.hyperlink){var se=ee(te.rels);we[te.rels.length]=se,fe.picture.hyperlinks={tooltip:be.hyperlinks.tooltip,rId:se},te.rels.push({Id:se,Type:u.Hyperlink,Target:be.hyperlinks.hyperlink,TargetMode:"External"})}q.preImageId=be.imageId,te.anchors.push(fe)}}),B.tables.forEach(function(be){var J=ee(X);be.rId=J,X.push({Id:J,Type:u.Table,Target:"../tables/".concat(be.target)}),be.columns.forEach(function(te){var ie=te.style;ie&&(te.dxfId=z.styles.addDxfStyle(ie))})}),this.map.extLst.prepare(B,z)}},{key:"render",value:function(B,z){B.openXml(h.StdDocAttributes),B.openNode("worksheet",L.WORKSHEET_ATTRIBUTES);var q=z.properties?{defaultRowHeight:z.properties.defaultRowHeight,dyDescent:z.properties.dyDescent,outlineLevelCol:z.properties.outlineLevelCol,outlineLevelRow:z.properties.outlineLevelRow}:void 0;z.properties&&z.properties.defaultColWidth&&(q.defaultColWidth=z.properties.defaultColWidth);var X={outlineProperties:z.properties&&z.properties.outlineProperties,tabColor:z.properties&&z.properties.tabColor,pageSetup:z.pageSetup&&z.pageSetup.fitToPage?{fitToPage:z.pageSetup.fitToPage}:void 0},ee=z.pageSetup&&z.pageSetup.margins,ye={showRowColHeaders:z.pageSetup&&z.pageSetup.showRowColHeaders,showGridLines:z.pageSetup&&z.pageSetup.showGridLines,horizontalCentered:z.pageSetup&&z.pageSetup.horizontalCentered,verticalCentered:z.pageSetup&&z.pageSetup.verticalCentered},de=z.sheetProtection;this.map.sheetPr.render(B,X),this.map.dimension.render(B,z.dimensions),this.map.sheetViews.render(B,z.views),this.map.sheetFormatPr.render(B,q),this.map.cols.render(B,z.cols),this.map.sheetData.render(B,z.rows),this.map.sheetProtection.render(B,de),this.map.autoFilter.render(B,z.autoFilter),this.map.mergeCells.render(B,z.mergeCells),this.map.conditionalFormatting.render(B,z.conditionalFormattings),this.map.dataValidations.render(B,z.dataValidations),this.map.hyperlinks.render(B,z.hyperlinks),this.map.printOptions.render(B,ye),this.map.pageMargins.render(B,ee),this.map.pageSetup.render(B,z.pageSetup),this.map.headerFooter.render(B,z.headerFooter),this.map.rowBreaks.render(B,z.rowBreaks),this.map.drawing.render(B,z.drawing),this.map.picture.render(B,z.background),this.map.tableParts.render(B,z.tables),this.map.extLst.render(B,z),z.rels&&z.rels.forEach(function(ge){ge.Type===u.VmlDrawing&&B.leafNode("legacyDrawing",{"r:id":ge.Id})}),B.closeNode()}},{key:"parseOpen",value:function(B){return this.parser?(this.parser.parseOpen(B),!0):B.name==="worksheet"?(g.each(this.map,function(z){z.reset()}),!0):(this.parser=this.map[B.name],this.parser&&this.parser.parseOpen(B),!0)}},{key:"parseText",value:function(B){this.parser&&this.parser.parseText(B)}},{key:"parseClose",value:function(B){if(this.parser)return this.parser.parseClose(B)||(this.parser=void 0),!0;switch(B){case"worksheet":var z=this.map.sheetFormatPr.model||{};this.map.sheetPr.model&&this.map.sheetPr.model.tabColor&&(z.tabColor=this.map.sheetPr.model.tabColor),this.map.sheetPr.model&&this.map.sheetPr.model.outlineProperties&&(z.outlineProperties=this.map.sheetPr.model.outlineProperties);var q={fitToPage:this.map.sheetPr.model&&this.map.sheetPr.model.pageSetup&&this.map.sheetPr.model.pageSetup.fitToPage||!1,margins:this.map.pageMargins.model},X=Object.assign(q,this.map.pageSetup.model,this.map.printOptions.model),ee=V(this.map.conditionalFormatting.model,this.map.extLst.model&&this.map.extLst.model["x14:conditionalFormattings"]);return this.model={dimensions:this.map.dimension.model,cols:this.map.cols.model,rows:this.map.sheetData.model,mergeCells:this.map.mergeCells.model,hyperlinks:this.map.hyperlinks.model,dataValidations:this.map.dataValidations.model,properties:z,views:this.map.sheetViews.model,pageSetup:X,headerFooter:this.map.headerFooter.model,background:this.map.picture.model,drawing:this.map.drawing.model,tables:this.map.tableParts.model,conditionalFormattings:ee},this.map.autoFilter.model&&(this.model.autoFilter=this.map.autoFilter.model),this.map.sheetProtection.model&&(this.model.sheetProtection=this.map.sheetProtection.model),!1;default:return!0}}},{key:"reconcile",value:function(B,z){var q=(B.relationships||[]).reduce(function(we,be){if(we[be.Id]=be,be.Type===u.Comments&&(B.comments=z.comments[be.Target].comments),be.Type===u.VmlDrawing&&B.comments&&B.comments.length){var J=z.vmlDrawings[be.Target].comments;B.comments.forEach(function(te,ie){te.note=Object.assign({},te.note,J[ie])})}return we},{});if(z.commentsMap=(B.comments||[]).reduce(function(we,be){return be.ref&&(we[be.ref]=be),we},{}),z.hyperlinkMap=(B.hyperlinks||[]).reduce(function(we,be){return be.rId&&(we[be.address]=q[be.rId].Target),we},{}),z.formulae={},B.rows=B.rows&&B.rows.filter(Boolean)||[],B.rows.forEach(function(we){we.cells=we.cells&&we.cells.filter(Boolean)||[]}),this.map.cols.reconcile(B.cols,z),this.map.sheetData.reconcile(B.rows,z),this.map.conditionalFormatting.reconcile(B.conditionalFormattings,z),B.media=[],B.drawing){var X=q[B.drawing.rId].Target.match(/\/drawings\/([a-zA-Z0-9]+)[.][a-zA-Z]{3,4}$/);if(X){var ee=X[1];z.drawings[ee].anchors.forEach(function(we){if(we.medium){var be={type:"image",imageId:we.medium.index,range:we.range,hyperlinks:we.picture.hyperlinks};B.media.push(be)}})}}var ye=B.background&&q[B.background.rId];if(ye){var de=ye.Target.split("/media/")[1],ge=z.mediaIndex&&z.mediaIndex[de];ge!==void 0&&B.media.push({type:"background",imageId:ge})}B.tables=(B.tables||[]).map(function(we){var be=q[we.rId];return z.tables[be.Target]}),delete B.relationships,delete B.hyperlinks,delete B.comments}}])&&a(Y.prototype,K),L}(c);W.WORKSHEET_ATTRIBUTES={xmlns:"http://schemas.openxmlformats.org/spreadsheetml/2006/main","xmlns:r":"http://schemas.openxmlformats.org/officeDocument/2006/relationships","xmlns:mc":"http://schemas.openxmlformats.org/markup-compatibility/2006","mc:Ignorable":"x14ac","xmlns:x14ac":"http://schemas.microsoft.com/office/spreadsheetml/2009/9/ac"},n.exports=W},{"../../../utils/col-cache":19,"../../../utils/under-dash":25,"../../../utils/xml-stream":27,"../../rel-type":30,"../base-xform":31,"../list-xform":70,"./auto-filter-xform":71,"./cf/conditional-formattings-xform":86,"./col-xform":91,"./data-validations-xform":92,"./dimension-xform":93,"./drawing-xform":94,"./ext-lst-xform":95,"./header-footer-xform":96,"./hyperlink-xform":97,"./merge-cell-xform":98,"./merges":99,"./page-margins-xform":102,"./page-setup-xform":104,"./picture-xform":105,"./print-options-xform":106,"./row-breaks-xform":107,"./row-xform":108,"./sheet-format-properties-xform":109,"./sheet-properties-xform":110,"./sheet-protection-xform":111,"./sheet-view-xform":112,"./table-part-xform":113}],115:[function(e,n,i){function o(y){return(o=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(h){return typeof h}:function(h){return h&&typeof Symbol=="function"&&h.constructor===Symbol&&h!==Symbol.prototype?"symbol":typeof h})(y)}function a(y,h){for(var u=0;u<h.length;u++){var f=h[u];f.enumerable=f.enumerable||!1,f.configurable=!0,"value"in f&&(f.writable=!0),Object.defineProperty(y,f.key,f)}}function s(y,h){return(s=Object.setPrototypeOf||function(u,f){return u.__proto__=f,u})(y,h)}function l(y){var h=function(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch{return!1}}();return function(){var u,f=d(y);if(h){var c=d(this).constructor;u=Reflect.construct(f,arguments,c)}else u=f.apply(this,arguments);return p(this,u)}}function p(y,h){return!h||o(h)!=="object"&&typeof h!="function"?function(u){if(u===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return u}(y):h}function d(y){return(d=Object.setPrototypeOf?Object.getPrototypeOf:function(h){return h.__proto__||Object.getPrototypeOf(h)})(y)}var g=function(y){(function(v,m){if(typeof m!="function"&&m!==null)throw new TypeError("Super expression must either be null or a function");v.prototype=Object.create(m&&m.prototype,{constructor:{value:v,writable:!0,configurable:!0}}),m&&s(v,m)})(c,y);var h,u,f=l(c);function c(v){var m;return function(b,w){if(!(b instanceof w))throw new TypeError("Cannot call a class as a function")}(this,c),(m=f.call(this)).tag=v.tag,m.attr=v.attr,m}return h=c,(u=[{key:"render",value:function(v,m){m&&(v.openNode(this.tag),v.closeNode())}},{key:"parseOpen",value:function(v){v.name===this.tag&&(this.model=!0)}},{key:"parseText",value:function(){}},{key:"parseClose",value:function(){return!1}}])&&a(h.prototype,u),c}(e("../base-xform"));n.exports=g},{"../base-xform":31}],116:[function(e,n,i){function o(y){return(o=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(h){return typeof h}:function(h){return h&&typeof Symbol=="function"&&h.constructor===Symbol&&h!==Symbol.prototype?"symbol":typeof h})(y)}function a(y,h){for(var u=0;u<h.length;u++){var f=h[u];f.enumerable=f.enumerable||!1,f.configurable=!0,"value"in f&&(f.writable=!0),Object.defineProperty(y,f.key,f)}}function s(y,h){return(s=Object.setPrototypeOf||function(u,f){return u.__proto__=f,u})(y,h)}function l(y){var h=function(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch{return!1}}();return function(){var u,f=d(y);if(h){var c=d(this).constructor;u=Reflect.construct(f,arguments,c)}else u=f.apply(this,arguments);return p(this,u)}}function p(y,h){return!h||o(h)!=="object"&&typeof h!="function"?function(u){if(u===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return u}(y):h}function d(y){return(d=Object.setPrototypeOf?Object.getPrototypeOf:function(h){return h.__proto__||Object.getPrototypeOf(h)})(y)}var g=function(y){(function(v,m){if(typeof m!="function"&&m!==null)throw new TypeError("Super expression must either be null or a function");v.prototype=Object.create(m&&m.prototype,{constructor:{value:v,writable:!0,configurable:!0}}),m&&s(v,m)})(c,y);var h,u,f=l(c);function c(v){var m;return function(b,w){if(!(b instanceof w))throw new TypeError("Cannot call a class as a function")}(this,c),(m=f.call(this)).tag=v.tag,m.attr=v.attr,m.attrs=v.attrs,m._format=v.format||function(b){try{return Number.isNaN(b.getTime())?"":b.toISOString()}catch{return""}},m._parse=v.parse||function(b){return new Date(b)},m}return h=c,(u=[{key:"render",value:function(v,m){m&&(v.openNode(this.tag),this.attrs&&v.addAttributes(this.attrs),this.attr?v.addAttribute(this.attr,this._format(m)):v.writeText(this._format(m)),v.closeNode())}},{key:"parseOpen",value:function(v){v.name===this.tag&&(this.attr?this.model=this._parse(v.attributes[this.attr]):this.text=[])}},{key:"parseText",value:function(v){this.attr||this.text.push(v)}},{key:"parseClose",value:function(){return this.attr||(this.model=this._parse(this.text.join(""))),!1}}])&&a(h.prototype,u),c}(e("../base-xform"));n.exports=g},{"../base-xform":31}],117:[function(e,n,i){function o(y){return(o=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(h){return typeof h}:function(h){return h&&typeof Symbol=="function"&&h.constructor===Symbol&&h!==Symbol.prototype?"symbol":typeof h})(y)}function a(y,h){for(var u=0;u<h.length;u++){var f=h[u];f.enumerable=f.enumerable||!1,f.configurable=!0,"value"in f&&(f.writable=!0),Object.defineProperty(y,f.key,f)}}function s(y,h){return(s=Object.setPrototypeOf||function(u,f){return u.__proto__=f,u})(y,h)}function l(y){var h=function(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch{return!1}}();return function(){var u,f=d(y);if(h){var c=d(this).constructor;u=Reflect.construct(f,arguments,c)}else u=f.apply(this,arguments);return p(this,u)}}function p(y,h){return!h||o(h)!=="object"&&typeof h!="function"?function(u){if(u===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return u}(y):h}function d(y){return(d=Object.setPrototypeOf?Object.getPrototypeOf:function(h){return h.__proto__||Object.getPrototypeOf(h)})(y)}var g=function(y){(function(v,m){if(typeof m!="function"&&m!==null)throw new TypeError("Super expression must either be null or a function");v.prototype=Object.create(m&&m.prototype,{constructor:{value:v,writable:!0,configurable:!0}}),m&&s(v,m)})(c,y);var h,u,f=l(c);function c(v){var m;return function(b,w){if(!(b instanceof w))throw new TypeError("Cannot call a class as a function")}(this,c),(m=f.call(this)).tag=v.tag,m.attr=v.attr,m.attrs=v.attrs,m.zero=v.zero,m}return h=c,(u=[{key:"render",value:function(v,m){(m||this.zero)&&(v.openNode(this.tag),this.attrs&&v.addAttributes(this.attrs),this.attr?v.addAttribute(this.attr,m):v.writeText(m),v.closeNode())}},{key:"parseOpen",value:function(v){return v.name===this.tag&&(this.attr?this.model=parseInt(v.attributes[this.attr],10):this.text=[],!0)}},{key:"parseText",value:function(v){this.attr||this.text.push(v)}},{key:"parseClose",value:function(){return this.attr||(this.model=parseInt(this.text.join("")||0,10)),!1}}])&&a(h.prototype,u),c}(e("../base-xform"));n.exports=g},{"../base-xform":31}],118:[function(e,n,i){function o(y){return(o=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(h){return typeof h}:function(h){return h&&typeof Symbol=="function"&&h.constructor===Symbol&&h!==Symbol.prototype?"symbol":typeof h})(y)}function a(y,h){for(var u=0;u<h.length;u++){var f=h[u];f.enumerable=f.enumerable||!1,f.configurable=!0,"value"in f&&(f.writable=!0),Object.defineProperty(y,f.key,f)}}function s(y,h){return(s=Object.setPrototypeOf||function(u,f){return u.__proto__=f,u})(y,h)}function l(y){var h=function(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch{return!1}}();return function(){var u,f=d(y);if(h){var c=d(this).constructor;u=Reflect.construct(f,arguments,c)}else u=f.apply(this,arguments);return p(this,u)}}function p(y,h){return!h||o(h)!=="object"&&typeof h!="function"?function(u){if(u===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return u}(y):h}function d(y){return(d=Object.setPrototypeOf?Object.getPrototypeOf:function(h){return h.__proto__||Object.getPrototypeOf(h)})(y)}var g=function(y){(function(v,m){if(typeof m!="function"&&m!==null)throw new TypeError("Super expression must either be null or a function");v.prototype=Object.create(m&&m.prototype,{constructor:{value:v,writable:!0,configurable:!0}}),m&&s(v,m)})(c,y);var h,u,f=l(c);function c(v){var m;return function(b,w){if(!(b instanceof w))throw new TypeError("Cannot call a class as a function")}(this,c),(m=f.call(this)).tag=v.tag,m.attr=v.attr,m.attrs=v.attrs,m}return h=c,(u=[{key:"render",value:function(v,m){m!==void 0&&(v.openNode(this.tag),this.attrs&&v.addAttributes(this.attrs),this.attr?v.addAttribute(this.attr,m):v.writeText(m),v.closeNode())}},{key:"parseOpen",value:function(v){v.name===this.tag&&(this.attr?this.model=v.attributes[this.attr]:this.text=[])}},{key:"parseText",value:function(v){this.attr||this.text.push(v)}},{key:"parseClose",value:function(){return this.attr||(this.model=this.text.join("")),!1}}])&&a(h.prototype,u),c}(e("../base-xform"));n.exports=g},{"../base-xform":31}],119:[function(e,n,i){function o(u){return(o=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(f){return typeof f}:function(f){return f&&typeof Symbol=="function"&&f.constructor===Symbol&&f!==Symbol.prototype?"symbol":typeof f})(u)}function a(u,f){for(var c=0;c<f.length;c++){var v=f[c];v.enumerable=v.enumerable||!1,v.configurable=!0,"value"in v&&(v.writable=!0),Object.defineProperty(u,v.key,v)}}function s(u,f){return(s=Object.setPrototypeOf||function(c,v){return c.__proto__=v,c})(u,f)}function l(u){var f=function(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch{return!1}}();return function(){var c,v=d(u);if(f){var m=d(this).constructor;c=Reflect.construct(v,arguments,m)}else c=v.apply(this,arguments);return p(this,c)}}function p(u,f){return!f||o(f)!=="object"&&typeof f!="function"?function(c){if(c===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return c}(u):f}function d(u){return(d=Object.setPrototypeOf?Object.getPrototypeOf:function(f){return f.__proto__||Object.getPrototypeOf(f)})(u)}var g=e("./base-xform"),y=e("../../utils/xml-stream"),h=function(u){(function(b,w){if(typeof w!="function"&&w!==null)throw new TypeError("Super expression must either be null or a function");b.prototype=Object.create(w&&w.prototype,{constructor:{value:b,writable:!0,configurable:!0}}),w&&s(b,w)})(m,u);var f,c,v=l(m);function m(b){var w;return function(_,C){if(!(_ instanceof C))throw new TypeError("Cannot call a class as a function")}(this,m),(w=v.call(this))._model=b,w}return f=m,(c=[{key:"render",value:function(b){if(!this._xml){var w=new y;(function _(C,R){C.openNode(R.tag,R.$),R.c&&R.c.forEach(function(I){_(C,I)}),R.t&&C.writeText(R.t),C.closeNode()})(w,this._model),this._xml=w.xml}b.writeXml(this._xml)}},{key:"parseOpen",value:function(){return!0}},{key:"parseText",value:function(){}},{key:"parseClose",value:function(b){switch(b){case this._model.tag:return!1;default:return!0}}}])&&a(f.prototype,c),m}(g);n.exports=h},{"../../utils/xml-stream":27,"./base-xform":31}],120:[function(e,n,i){function o(u){return(o=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(f){return typeof f}:function(f){return f&&typeof Symbol=="function"&&f.constructor===Symbol&&f!==Symbol.prototype?"symbol":typeof f})(u)}function a(u,f){for(var c=0;c<f.length;c++){var v=f[c];v.enumerable=v.enumerable||!1,v.configurable=!0,"value"in v&&(v.writable=!0),Object.defineProperty(u,v.key,v)}}function s(u,f){return(s=Object.setPrototypeOf||function(c,v){return c.__proto__=v,c})(u,f)}function l(u){var f=function(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch{return!1}}();return function(){var c,v=d(u);if(f){var m=d(this).constructor;c=Reflect.construct(v,arguments,m)}else c=v.apply(this,arguments);return p(this,c)}}function p(u,f){return!f||o(f)!=="object"&&typeof f!="function"?function(c){if(c===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return c}(u):f}function d(u){return(d=Object.setPrototypeOf?Object.getPrototypeOf:function(f){return f.__proto__||Object.getPrototypeOf(f)})(u)}var g=e("./text-xform"),y=e("./rich-text-xform"),h=function(u){(function(b,w){if(typeof w!="function"&&w!==null)throw new TypeError("Super expression must either be null or a function");b.prototype=Object.create(w&&w.prototype,{constructor:{value:b,writable:!0,configurable:!0}}),w&&s(b,w)})(m,u);var f,c,v=l(m);function m(){var b;return function(w,_){if(!(w instanceof _))throw new TypeError("Cannot call a class as a function")}(this,m),(b=v.call(this)).map={r:new y,t:new g},b}return f=m,(c=[{key:"render",value:function(b,w){if(b.openNode(this.tag,{sb:w.sb||0,eb:w.eb||0}),w&&w.hasOwnProperty("richText")&&w.richText){var _=this.map.r;w.richText.forEach(function(C){_.render(b,C)})}else w&&this.map.t.render(b,w.text);b.closeNode()}},{key:"parseOpen",value:function(b){var w=b.name;return this.parser?(this.parser.parseOpen(b),!0):w===this.tag?(this.model={sb:parseInt(b.attributes.sb,10),eb:parseInt(b.attributes.eb,10)},!0):(this.parser=this.map[w],!!this.parser&&(this.parser.parseOpen(b),!0))}},{key:"parseText",value:function(b){this.parser&&this.parser.parseText(b)}},{key:"parseClose",value:function(b){if(this.parser){if(!this.parser.parseClose(b)){switch(b){case"r":var w=this.model.richText;w||(w=this.model.richText=[]),w.push(this.parser.model);break;case"t":this.model.text=this.parser.model}this.parser=void 0}return!0}switch(b){case this.tag:return!1;default:return!0}}},{key:"tag",get:function(){return"rPh"}}])&&a(f.prototype,c),m}(e("../base-xform"));n.exports=h},{"../base-xform":31,"./rich-text-xform":121,"./text-xform":124}],121:[function(e,n,i){function o(u){return(o=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(f){return typeof f}:function(f){return f&&typeof Symbol=="function"&&f.constructor===Symbol&&f!==Symbol.prototype?"symbol":typeof f})(u)}function a(u,f){for(var c=0;c<f.length;c++){var v=f[c];v.enumerable=v.enumerable||!1,v.configurable=!0,"value"in v&&(v.writable=!0),Object.defineProperty(u,v.key,v)}}function s(u,f){return(s=Object.setPrototypeOf||function(c,v){return c.__proto__=v,c})(u,f)}function l(u){var f=function(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch{return!1}}();return function(){var c,v=d(u);if(f){var m=d(this).constructor;c=Reflect.construct(v,arguments,m)}else c=v.apply(this,arguments);return p(this,c)}}function p(u,f){return!f||o(f)!=="object"&&typeof f!="function"?function(c){if(c===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return c}(u):f}function d(u){return(d=Object.setPrototypeOf?Object.getPrototypeOf:function(f){return f.__proto__||Object.getPrototypeOf(f)})(u)}var g=e("./text-xform"),y=e("../style/font-xform"),h=function(u){(function(b,w){if(typeof w!="function"&&w!==null)throw new TypeError("Super expression must either be null or a function");b.prototype=Object.create(w&&w.prototype,{constructor:{value:b,writable:!0,configurable:!0}}),w&&s(b,w)})(m,u);var f,c,v=l(m);function m(b){var w;return function(_,C){if(!(_ instanceof C))throw new TypeError("Cannot call a class as a function")}(this,m),(w=v.call(this)).model=b,w}return f=m,(c=[{key:"render",value:function(b,w){w=w||this.model,b.openNode("r"),w.font&&this.fontXform.render(b,w.font),this.textXform.render(b,w.text),b.closeNode()}},{key:"parseOpen",value:function(b){if(this.parser)return this.parser.parseOpen(b),!0;switch(b.name){case"r":return this.model={},!0;case"t":return this.parser=this.textXform,this.parser.parseOpen(b),!0;case"rPr":return this.parser=this.fontXform,this.parser.parseOpen(b),!0;default:return!1}}},{key:"parseText",value:function(b){this.parser&&this.parser.parseText(b)}},{key:"parseClose",value:function(b){switch(b){case"r":return!1;case"t":return this.model.text=this.parser.model,this.parser=void 0,!0;case"rPr":return this.model.font=this.parser.model,this.parser=void 0,!0;default:return this.parser&&this.parser.parseClose(b),!0}}},{key:"tag",get:function(){return"r"}},{key:"textXform",get:function(){return this._textXform||(this._textXform=new g)}},{key:"fontXform",get:function(){return this._fontXform||(this._fontXform=new y(m.FONT_OPTIONS))}}])&&a(f.prototype,c),m}(e("../base-xform"));h.FONT_OPTIONS={tagName:"rPr",fontNameTag:"rFont"},n.exports=h},{"../base-xform":31,"../style/font-xform":130,"./text-xform":124}],122:[function(e,n,i){function o(f){return(o=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(c){return typeof c}:function(c){return c&&typeof Symbol=="function"&&c.constructor===Symbol&&c!==Symbol.prototype?"symbol":typeof c})(f)}function a(f,c){for(var v=0;v<c.length;v++){var m=c[v];m.enumerable=m.enumerable||!1,m.configurable=!0,"value"in m&&(m.writable=!0),Object.defineProperty(f,m.key,m)}}function s(f,c){return(s=Object.setPrototypeOf||function(v,m){return v.__proto__=m,v})(f,c)}function l(f){var c=function(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch{return!1}}();return function(){var v,m=d(f);if(c){var b=d(this).constructor;v=Reflect.construct(m,arguments,b)}else v=m.apply(this,arguments);return p(this,v)}}function p(f,c){return!c||o(c)!=="object"&&typeof c!="function"?function(v){if(v===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return v}(f):c}function d(f){return(d=Object.setPrototypeOf?Object.getPrototypeOf:function(c){return c.__proto__||Object.getPrototypeOf(c)})(f)}var g=e("./text-xform"),y=e("./rich-text-xform"),h=e("./phonetic-text-xform"),u=function(f){(function(w,_){if(typeof _!="function"&&_!==null)throw new TypeError("Super expression must either be null or a function");w.prototype=Object.create(_&&_.prototype,{constructor:{value:w,writable:!0,configurable:!0}}),_&&s(w,_)})(b,f);var c,v,m=l(b);function b(w){var _;return function(C,R){if(!(C instanceof R))throw new TypeError("Cannot call a class as a function")}(this,b),(_=m.call(this)).model=w,_.map={r:new y,t:new g,rPh:new h},_}return c=b,(v=[{key:"render",value:function(w,_){var C=this;w.openNode(this.tag),_&&_.hasOwnProperty("richText")&&_.richText?_.richText.length?_.richText.forEach(function(R){C.map.r.render(w,R)}):this.map.t.render(w,""):_!=null&&this.map.t.render(w,_),w.closeNode()}},{key:"parseOpen",value:function(w){var _=w.name;return this.parser?(this.parser.parseOpen(w),!0):_===this.tag?(this.model={},!0):(this.parser=this.map[_],!!this.parser&&(this.parser.parseOpen(w),!0))}},{key:"parseText",value:function(w){this.parser&&this.parser.parseText(w)}},{key:"parseClose",value:function(w){if(this.parser){if(!this.parser.parseClose(w)){switch(w){case"r":var _=this.model.richText;_||(_=this.model.richText=[]),_.push(this.parser.model);break;case"t":this.model=this.parser.model}this.parser=void 0}return!0}switch(w){case this.tag:return!1;default:return!0}}},{key:"tag",get:function(){return"si"}}])&&a(c.prototype,v),b}(e("../base-xform"));n.exports=u},{"../base-xform":31,"./phonetic-text-xform":120,"./rich-text-xform":121,"./text-xform":124}],123:[function(e,n,i){function o(f){return(o=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(c){return typeof c}:function(c){return c&&typeof Symbol=="function"&&c.constructor===Symbol&&c!==Symbol.prototype?"symbol":typeof c})(f)}function a(f,c){for(var v=0;v<c.length;v++){var m=c[v];m.enumerable=m.enumerable||!1,m.configurable=!0,"value"in m&&(m.writable=!0),Object.defineProperty(f,m.key,m)}}function s(f,c){return(s=Object.setPrototypeOf||function(v,m){return v.__proto__=m,v})(f,c)}function l(f){var c=function(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch{return!1}}();return function(){var v,m=d(f);if(c){var b=d(this).constructor;v=Reflect.construct(m,arguments,b)}else v=m.apply(this,arguments);return p(this,v)}}function p(f,c){return!c||o(c)!=="object"&&typeof c!="function"?function(v){if(v===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return v}(f):c}function d(f){return(d=Object.setPrototypeOf?Object.getPrototypeOf:function(c){return c.__proto__||Object.getPrototypeOf(c)})(f)}var g=e("../../../utils/xml-stream"),y=e("../base-xform"),h=e("./shared-string-xform"),u=function(f){(function(w,_){if(typeof _!="function"&&_!==null)throw new TypeError("Super expression must either be null or a function");w.prototype=Object.create(_&&_.prototype,{constructor:{value:w,writable:!0,configurable:!0}}),_&&s(w,_)})(b,f);var c,v,m=l(b);function b(w){var _;return function(C,R){if(!(C instanceof R))throw new TypeError("Cannot call a class as a function")}(this,b),(_=m.call(this)).model=w||{values:[],count:0},_.hash=Object.create(null),_.rich=Object.create(null),_}return c=b,(v=[{key:"getString",value:function(w){return this.model.values[w]}},{key:"add",value:function(w){return w.richText?this.addRichText(w):this.addText(w)}},{key:"addText",value:function(w){var _=this.hash[w];return _===void 0&&(_=this.hash[w]=this.model.values.length,this.model.values.push(w)),this.model.count++,_}},{key:"addRichText",value:function(w){var _=this.sharedStringXform.toXml(w),C=this.rich[_];return C===void 0&&(C=this.rich[_]=this.model.values.length,this.model.values.push(w)),this.model.count++,C}},{key:"render",value:function(w,_){_=_||this._values,w.openXml(g.StdDocAttributes),w.openNode("sst",{xmlns:"http://schemas.openxmlformats.org/spreadsheetml/2006/main",count:_.count,uniqueCount:_.values.length});var C=this.sharedStringXform;_.values.forEach(function(R){C.render(w,R)}),w.closeNode()}},{key:"parseOpen",value:function(w){if(this.parser)return this.parser.parseOpen(w),!0;switch(w.name){case"sst":return!0;case"si":return this.parser=this.sharedStringXform,this.parser.parseOpen(w),!0;default:throw new Error("Unexpected xml node in parseOpen: ".concat(JSON.stringify(w)))}}},{key:"parseText",value:function(w){this.parser&&this.parser.parseText(w)}},{key:"parseClose",value:function(w){if(this.parser)return this.parser.parseClose(w)||(this.model.values.push(this.parser.model),this.model.count++,this.parser=void 0),!0;switch(w){case"sst":return!1;default:throw new Error("Unexpected xml node in parseClose: ".concat(w))}}},{key:"sharedStringXform",get:function(){return this._sharedStringXform||(this._sharedStringXform=new h)}},{key:"values",get:function(){return this.model.values}},{key:"uniqueCount",get:function(){return this.model.values.length}},{key:"count",get:function(){return this.model.count}}])&&a(c.prototype,v),b}(y);n.exports=u},{"../../../utils/xml-stream":27,"../base-xform":31,"./shared-string-xform":122}],124:[function(e,n,i){function o(h){return(o=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(u){return typeof u}:function(u){return u&&typeof Symbol=="function"&&u.constructor===Symbol&&u!==Symbol.prototype?"symbol":typeof u})(h)}function a(h,u){if(!(h instanceof u))throw new TypeError("Cannot call a class as a function")}function s(h,u){for(var f=0;f<u.length;f++){var c=u[f];c.enumerable=c.enumerable||!1,c.configurable=!0,"value"in c&&(c.writable=!0),Object.defineProperty(h,c.key,c)}}function l(h,u){return(l=Object.setPrototypeOf||function(f,c){return f.__proto__=c,f})(h,u)}function p(h){var u=function(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch{return!1}}();return function(){var f,c=g(h);if(u){var v=g(this).constructor;f=Reflect.construct(c,arguments,v)}else f=c.apply(this,arguments);return d(this,f)}}function d(h,u){return!u||o(u)!=="object"&&typeof u!="function"?function(f){if(f===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return f}(h):u}function g(h){return(g=Object.setPrototypeOf?Object.getPrototypeOf:function(u){return u.__proto__||Object.getPrototypeOf(u)})(h)}var y=function(h){(function(m,b){if(typeof b!="function"&&b!==null)throw new TypeError("Super expression must either be null or a function");m.prototype=Object.create(b&&b.prototype,{constructor:{value:m,writable:!0,configurable:!0}}),b&&l(m,b)})(v,h);var u,f,c=p(v);function v(){return a(this,v),c.apply(this,arguments)}return u=v,(f=[{key:"render",value:function(m,b){m.openNode("t"),/^\s|\n|\s$/.test(b)&&m.addAttribute("xml:space","preserve"),m.writeText(b),m.closeNode()}},{key:"parseOpen",value:function(m){switch(m.name){case"t":return this._text=[],!0;default:return!1}}},{key:"parseText",value:function(m){this._text.push(m)}},{key:"parseClose",value:function(){return!1}},{key:"tag",get:function(){return"t"}},{key:"model",get:function(){return this._text.join("").replace(/_x([0-9A-F]{4})_/g,function(m,b){return String.fromCharCode(parseInt(b,16))})}}])&&s(u.prototype,f),v}(e("../base-xform"));n.exports=y},{"../base-xform":31}],125:[function(e,n,i){function o(b){return(o=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(w){return typeof w}:function(w){return w&&typeof Symbol=="function"&&w.constructor===Symbol&&w!==Symbol.prototype?"symbol":typeof w})(b)}function a(b,w){if(!(b instanceof w))throw new TypeError("Cannot call a class as a function")}function s(b,w){for(var _=0;_<w.length;_++){var C=w[_];C.enumerable=C.enumerable||!1,C.configurable=!0,"value"in C&&(C.writable=!0),Object.defineProperty(b,C.key,C)}}function l(b,w){return(l=Object.setPrototypeOf||function(_,C){return _.__proto__=C,_})(b,w)}function p(b){var w=function(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch{return!1}}();return function(){var _,C=g(b);if(w){var R=g(this).constructor;_=Reflect.construct(C,arguments,R)}else _=C.apply(this,arguments);return d(this,_)}}function d(b,w){return!w||o(w)!=="object"&&typeof w!="function"?function(_){if(_===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return _}(b):w}function g(b){return(g=Object.setPrototypeOf?Object.getPrototypeOf:function(w){return w.__proto__||Object.getPrototypeOf(w)})(b)}var y=e("../../../doc/enums"),h=e("../../../utils/utils"),u=e("../base-xform"),f={horizontalValues:["left","center","right","fill","centerContinuous","distributed","justify"].reduce(function(b,w){return b[w]=!0,b},{}),horizontal:function(b){return this.horizontalValues[b]?b:void 0},verticalValues:["top","middle","bottom","distributed","justify"].reduce(function(b,w){return b[w]=!0,b},{}),vertical:function(b){return b==="middle"?"center":this.verticalValues[b]?b:void 0},wrapText:function(b){return!!b||void 0},shrinkToFit:function(b){return!!b||void 0},textRotation:function(b){switch(b){case"vertical":return b;default:return(b=h.validInt(b))>=-90&&b<=90?b:void 0}},indent:function(b){return b=h.validInt(b),Math.max(0,b)},readingOrder:function(b){switch(b){case"ltr":return y.ReadingOrder.LeftToRight;case"rtl":return y.ReadingOrder.RightToLeft;default:return}}},c=function(b){if(b=f.textRotation(b)){if(b==="vertical")return 255;var w=Math.round(b);if(w>=0&&w<=90)return w;if(w<0&&w>=-90)return 90-w}},v=function(b){var w=h.validInt(b);if(w!==void 0){if(w===255)return"vertical";if(w>=0&&w<=90)return w;if(w>90&&w<=180)return 90-w}},m=function(b){(function(I,P){if(typeof P!="function"&&P!==null)throw new TypeError("Super expression must either be null or a function");I.prototype=Object.create(P&&P.prototype,{constructor:{value:I,writable:!0,configurable:!0}}),P&&l(I,P)})(R,b);var w,_,C=p(R);function R(){return a(this,R),C.apply(this,arguments)}return w=R,(_=[{key:"render",value:function(I,P){I.addRollback(),I.openNode("alignment");var N=!1;function A($,T){T&&(I.addAttribute($,T),N=!0)}A("horizontal",f.horizontal(P.horizontal)),A("vertical",f.vertical(P.vertical)),A("wrapText",!!f.wrapText(P.wrapText)&&"1"),A("shrinkToFit",!!f.shrinkToFit(P.shrinkToFit)&&"1"),A("indent",f.indent(P.indent)),A("textRotation",c(P.textRotation)),A("readingOrder",f.readingOrder(P.readingOrder)),I.closeNode(),N?I.commit():I.rollback()}},{key:"parseOpen",value:function(I){var P={},N=!1;function A($,T,M){$&&(P[T]=M,N=!0)}A(I.attributes.horizontal,"horizontal",I.attributes.horizontal),A(I.attributes.vertical,"vertical",I.attributes.vertical==="center"?"middle":I.attributes.vertical),A(I.attributes.wrapText,"wrapText",!!I.attributes.wrapText),A(I.attributes.shrinkToFit,"shrinkToFit",!!I.attributes.shrinkToFit),A(I.attributes.indent,"indent",parseInt(I.attributes.indent,10)),A(I.attributes.textRotation,"textRotation",v(I.attributes.textRotation)),A(I.attributes.readingOrder,"readingOrder",I.attributes.readingOrder==="2"?"rtl":"ltr"),this.model=N?P:null}},{key:"parseText",value:function(){}},{key:"parseClose",value:function(){return!1}},{key:"tag",get:function(){return"alignment"}}])&&s(w.prototype,_),R}(u);n.exports=m},{"../../../doc/enums":7,"../../../utils/utils":26,"../base-xform":31}],126:[function(e,n,i){function o(_,C){var R=Object.keys(_);if(Object.getOwnPropertySymbols){var I=Object.getOwnPropertySymbols(_);C&&(I=I.filter(function(P){return Object.getOwnPropertyDescriptor(_,P).enumerable})),R.push.apply(R,I)}return R}function a(_){for(var C=1;C<arguments.length;C++){var R=arguments[C]!=null?arguments[C]:{};C%2?o(Object(R),!0).forEach(function(I){s(_,I,R[I])}):Object.getOwnPropertyDescriptors?Object.defineProperties(_,Object.getOwnPropertyDescriptors(R)):o(Object(R)).forEach(function(I){Object.defineProperty(_,I,Object.getOwnPropertyDescriptor(R,I))})}return _}function s(_,C,R){return C in _?Object.defineProperty(_,C,{value:R,enumerable:!0,configurable:!0,writable:!0}):_[C]=R,_}function l(_){return(l=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(C){return typeof C}:function(C){return C&&typeof Symbol=="function"&&C.constructor===Symbol&&C!==Symbol.prototype?"symbol":typeof C})(_)}function p(_,C){if(!(_ instanceof C))throw new TypeError("Cannot call a class as a function")}function d(_,C){for(var R=0;R<C.length;R++){var I=C[R];I.enumerable=I.enumerable||!1,I.configurable=!0,"value"in I&&(I.writable=!0),Object.defineProperty(_,I.key,I)}}function g(_,C,R){return C&&d(_.prototype,C),R&&d(_,R),_}function y(_,C){if(typeof C!="function"&&C!==null)throw new TypeError("Super expression must either be null or a function");_.prototype=Object.create(C&&C.prototype,{constructor:{value:_,writable:!0,configurable:!0}}),C&&h(_,C)}function h(_,C){return(h=Object.setPrototypeOf||function(R,I){return R.__proto__=I,R})(_,C)}function u(_){var C=function(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch{return!1}}();return function(){var R,I=c(_);if(C){var P=c(this).constructor;R=Reflect.construct(I,arguments,P)}else R=I.apply(this,arguments);return f(this,R)}}function f(_,C){return!C||l(C)!=="object"&&typeof C!="function"?function(R){if(R===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return R}(_):C}function c(_){return(c=Object.setPrototypeOf?Object.getPrototypeOf:function(C){return C.__proto__||Object.getPrototypeOf(C)})(_)}var v=e("../base-xform"),m=e("./color-xform"),b=function(_){y(R,_);var C=u(R);function R(I){var P;return p(this,R),(P=C.call(this)).name=I,P.map={color:new m},P}return g(R,[{key:"render",value:function(I,P,N){var A=P&&P.color||N||this.defaultColor;I.openNode(this.name),P&&P.style&&(I.addAttribute("style",P.style),A&&this.map.color.render(I,A)),I.closeNode()}},{key:"parseOpen",value:function(I){if(this.parser)return this.parser.parseOpen(I),!0;switch(I.name){case this.name:var P=I.attributes.style;return this.model=P?{style:P}:void 0,!0;case"color":return this.parser=this.map.color,this.parser.parseOpen(I),!0;default:return!1}}},{key:"parseText",value:function(I){this.parser&&this.parser.parseText(I)}},{key:"parseClose",value:function(I){return this.parser?(this.parser.parseClose(I)||(this.parser=void 0),!0):(I===this.name&&this.map.color.model&&(this.model||(this.model={}),this.model.color=this.map.color.model),!1)}},{key:"validStyle",value:function(I){return R.validStyleValues[I]}},{key:"tag",get:function(){return this.name}}]),R}(v);b.validStyleValues=["thin","dotted","dashDot","hair","dashDotDot","slantDashDot","mediumDashed","mediumDashDotDot","mediumDashDot","medium","double","thick"].reduce(function(_,C){return _[C]=!0,_},{});var w=function(_){y(R,_);var C=u(R);function R(){var I;return p(this,R),(I=C.call(this)).map={top:new b("top"),left:new b("left"),bottom:new b("bottom"),right:new b("right"),diagonal:new b("diagonal")},I}return g(R,[{key:"render",value:function(I,P){var N=P.color;function A($,T){$&&!$.color&&P.color&&($=a(a({},$),{},{color:P.color})),T.render(I,$,N)}I.openNode("border"),P.diagonal&&P.diagonal.style&&(P.diagonal.up&&I.addAttribute("diagonalUp","1"),P.diagonal.down&&I.addAttribute("diagonalDown","1")),A(P.left,this.map.left),A(P.right,this.map.right),A(P.top,this.map.top),A(P.bottom,this.map.bottom),A(P.diagonal,this.map.diagonal),I.closeNode()}},{key:"parseOpen",value:function(I){if(this.parser)return this.parser.parseOpen(I),!0;switch(I.name){case"border":return this.reset(),this.diagonalUp=!!I.attributes.diagonalUp,this.diagonalDown=!!I.attributes.diagonalDown,!0;default:return this.parser=this.map[I.name],!!this.parser&&(this.parser.parseOpen(I),!0)}}},{key:"parseText",value:function(I){this.parser&&this.parser.parseText(I)}},{key:"parseClose",value:function(I){if(this.parser)return this.parser.parseClose(I)||(this.parser=void 0),!0;if(I==="border"){var P=this.model={},N=function(A,$,T){$&&(T&&Object.assign($,T),P[A]=$)};N("left",this.map.left.model),N("right",this.map.right.model),N("top",this.map.top.model),N("bottom",this.map.bottom.model),N("diagonal",this.map.diagonal.model,{up:this.diagonalUp,down:this.diagonalDown})}return!1}}]),R}(v);n.exports=w},{"../base-xform":31,"./color-xform":127}],127:[function(e,n,i){function o(y){return(o=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(h){return typeof h}:function(h){return h&&typeof Symbol=="function"&&h.constructor===Symbol&&h!==Symbol.prototype?"symbol":typeof h})(y)}function a(y,h){for(var u=0;u<h.length;u++){var f=h[u];f.enumerable=f.enumerable||!1,f.configurable=!0,"value"in f&&(f.writable=!0),Object.defineProperty(y,f.key,f)}}function s(y,h){return(s=Object.setPrototypeOf||function(u,f){return u.__proto__=f,u})(y,h)}function l(y){var h=function(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch{return!1}}();return function(){var u,f=d(y);if(h){var c=d(this).constructor;u=Reflect.construct(f,arguments,c)}else u=f.apply(this,arguments);return p(this,u)}}function p(y,h){return!h||o(h)!=="object"&&typeof h!="function"?function(u){if(u===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return u}(y):h}function d(y){return(d=Object.setPrototypeOf?Object.getPrototypeOf:function(h){return h.__proto__||Object.getPrototypeOf(h)})(y)}var g=function(y){(function(v,m){if(typeof m!="function"&&m!==null)throw new TypeError("Super expression must either be null or a function");v.prototype=Object.create(m&&m.prototype,{constructor:{value:v,writable:!0,configurable:!0}}),m&&s(v,m)})(c,y);var h,u,f=l(c);function c(v){var m;return function(b,w){if(!(b instanceof w))throw new TypeError("Cannot call a class as a function")}(this,c),(m=f.call(this)).name=v||"color",m}return h=c,(u=[{key:"render",value:function(v,m){return!!m&&(v.openNode(this.name),m.argb?v.addAttribute("rgb",m.argb):m.theme!==void 0?(v.addAttribute("theme",m.theme),m.tint!==void 0&&v.addAttribute("tint",m.tint)):m.indexed!==void 0?v.addAttribute("indexed",m.indexed):v.addAttribute("auto","1"),v.closeNode(),!0)}},{key:"parseOpen",value:function(v){return v.name===this.name&&(v.attributes.rgb?this.model={argb:v.attributes.rgb}:v.attributes.theme?(this.model={theme:parseInt(v.attributes.theme,10)},v.attributes.tint&&(this.model.tint=parseFloat(v.attributes.tint))):v.attributes.indexed?this.model={indexed:parseInt(v.attributes.indexed,10)}:this.model=void 0,!0)}},{key:"parseText",value:function(){}},{key:"parseClose",value:function(){return!1}},{key:"tag",get:function(){return this.name}}])&&a(h.prototype,u),c}(e("../base-xform"));n.exports=g},{"../base-xform":31}],128:[function(e,n,i){function o(b){return(o=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(w){return typeof w}:function(w){return w&&typeof Symbol=="function"&&w.constructor===Symbol&&w!==Symbol.prototype?"symbol":typeof w})(b)}function a(b,w){for(var _=0;_<w.length;_++){var C=w[_];C.enumerable=C.enumerable||!1,C.configurable=!0,"value"in C&&(C.writable=!0),Object.defineProperty(b,C.key,C)}}function s(b,w){return(s=Object.setPrototypeOf||function(_,C){return _.__proto__=C,_})(b,w)}function l(b){var w=function(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch{return!1}}();return function(){var _,C=d(b);if(w){var R=d(this).constructor;_=Reflect.construct(C,arguments,R)}else _=C.apply(this,arguments);return p(this,_)}}function p(b,w){return!w||o(w)!=="object"&&typeof w!="function"?function(_){if(_===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return _}(b):w}function d(b){return(d=Object.setPrototypeOf?Object.getPrototypeOf:function(w){return w.__proto__||Object.getPrototypeOf(w)})(b)}var g=e("../base-xform"),y=e("./alignment-xform"),h=e("./border-xform"),u=e("./fill-xform"),f=e("./font-xform"),c=e("./numfmt-xform"),v=e("./protection-xform"),m=function(b){(function(I,P){if(typeof P!="function"&&P!==null)throw new TypeError("Super expression must either be null or a function");I.prototype=Object.create(P&&P.prototype,{constructor:{value:I,writable:!0,configurable:!0}}),P&&s(I,P)})(R,b);var w,_,C=l(R);function R(){var I;return function(P,N){if(!(P instanceof N))throw new TypeError("Cannot call a class as a function")}(this,R),(I=C.call(this)).map={alignment:new y,border:new h,fill:new u,font:new f,numFmt:new c,protection:new v},I}return w=R,(_=[{key:"render",value:function(I,P){I.openNode(this.tag),P.font&&this.map.font.render(I,P.font),P.numFmt&&this.map.numFmt.render(I,P.numFmt),P.fill&&this.map.fill.render(I,P.fill),P.alignment&&this.map.alignment.render(I,P.alignment),P.border&&this.map.border.render(I,P.border),P.protection&&this.map.protection.render(I,P.protection),I.closeNode()}},{key:"parseOpen",value:function(I){if(this.parser)return this.parser.parseOpen(I),!0;switch(I.name){case this.tag:return this.reset(),!0;default:return this.parser=this.map[I.name],this.parser&&this.parser.parseOpen(I),!0}}},{key:"parseText",value:function(I){this.parser&&this.parser.parseText(I)}},{key:"parseClose",value:function(I){return this.parser?(this.parser.parseClose(I)||(this.parser=void 0),!0):I!==this.tag||(this.model={alignment:this.map.alignment.model,border:this.map.border.model,fill:this.map.fill.model,font:this.map.font.model,numFmt:this.map.numFmt.model,protection:this.map.protection.model},!1)}},{key:"tag",get:function(){return"dxf"}}])&&a(w.prototype,_),R}(g);n.exports=m},{"../base-xform":31,"./alignment-xform":125,"./border-xform":126,"./fill-xform":129,"./font-xform":130,"./numfmt-xform":131,"./protection-xform":132}],129:[function(e,n,i){function o(w){return(o=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(_){return typeof _}:function(_){return _&&typeof Symbol=="function"&&_.constructor===Symbol&&_!==Symbol.prototype?"symbol":typeof _})(w)}function a(w,_){if(!(w instanceof _))throw new TypeError("Cannot call a class as a function")}function s(w,_){for(var C=0;C<_.length;C++){var R=_[C];R.enumerable=R.enumerable||!1,R.configurable=!0,"value"in R&&(R.writable=!0),Object.defineProperty(w,R.key,R)}}function l(w,_,C){return _&&s(w.prototype,_),C&&s(w,C),w}function p(w,_){if(typeof _!="function"&&_!==null)throw new TypeError("Super expression must either be null or a function");w.prototype=Object.create(_&&_.prototype,{constructor:{value:w,writable:!0,configurable:!0}}),_&&d(w,_)}function d(w,_){return(d=Object.setPrototypeOf||function(C,R){return C.__proto__=R,C})(w,_)}function g(w){var _=function(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch{return!1}}();return function(){var C,R=h(w);if(_){var I=h(this).constructor;C=Reflect.construct(R,arguments,I)}else C=R.apply(this,arguments);return y(this,C)}}function y(w,_){return!_||o(_)!=="object"&&typeof _!="function"?function(C){if(C===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return C}(w):_}function h(w){return(h=Object.setPrototypeOf?Object.getPrototypeOf:function(_){return _.__proto__||Object.getPrototypeOf(_)})(w)}var u=e("../base-xform"),f=e("./color-xform"),c=function(w){p(C,w);var _=g(C);function C(){var R;return a(this,C),(R=_.call(this)).map={color:new f},R}return l(C,[{key:"render",value:function(R,I){R.openNode("stop"),R.addAttribute("position",I.position),this.map.color.render(R,I.color),R.closeNode()}},{key:"parseOpen",value:function(R){if(this.parser)return this.parser.parseOpen(R),!0;switch(R.name){case"stop":return this.model={position:parseFloat(R.attributes.position)},!0;case"color":return this.parser=this.map.color,this.parser.parseOpen(R),!0;default:return!1}}},{key:"parseText",value:function(){}},{key:"parseClose",value:function(R){return!!this.parser&&(this.parser.parseClose(R)||(this.model.color=this.parser.model,this.parser=void 0),!0)}},{key:"tag",get:function(){return"stop"}}]),C}(u),v=function(w){p(C,w);var _=g(C);function C(){var R;return a(this,C),(R=_.call(this)).map={fgColor:new f("fgColor"),bgColor:new f("bgColor")},R}return l(C,[{key:"render",value:function(R,I){R.openNode("patternFill"),R.addAttribute("patternType",I.pattern),I.fgColor&&this.map.fgColor.render(R,I.fgColor),I.bgColor&&this.map.bgColor.render(R,I.bgColor),R.closeNode()}},{key:"parseOpen",value:function(R){if(this.parser)return this.parser.parseOpen(R),!0;switch(R.name){case"patternFill":return this.model={type:"pattern",pattern:R.attributes.patternType},!0;default:return this.parser=this.map[R.name],!!this.parser&&(this.parser.parseOpen(R),!0)}}},{key:"parseText",value:function(R){this.parser&&this.parser.parseText(R)}},{key:"parseClose",value:function(R){return!!this.parser&&(this.parser.parseClose(R)||(this.parser.model&&(this.model[R]=this.parser.model),this.parser=void 0),!0)}},{key:"name",get:function(){return"pattern"}},{key:"tag",get:function(){return"patternFill"}}]),C}(u),m=function(w){p(C,w);var _=g(C);function C(){var R;return a(this,C),(R=_.call(this)).map={stop:new c},R}return l(C,[{key:"render",value:function(R,I){switch(R.openNode("gradientFill"),I.gradient){case"angle":R.addAttribute("degree",I.degree);break;case"path":R.addAttribute("type","path"),I.center.left&&(R.addAttribute("left",I.center.left),I.center.right===void 0&&R.addAttribute("right",I.center.left)),I.center.right&&R.addAttribute("right",I.center.right),I.center.top&&(R.addAttribute("top",I.center.top),I.center.bottom===void 0&&R.addAttribute("bottom",I.center.top)),I.center.bottom&&R.addAttribute("bottom",I.center.bottom)}var P=this.map.stop;I.stops.forEach(function(N){P.render(R,N)}),R.closeNode()}},{key:"parseOpen",value:function(R){if(this.parser)return this.parser.parseOpen(R),!0;switch(R.name){case"gradientFill":var I=this.model={stops:[]};return R.attributes.degree?(I.gradient="angle",I.degree=parseInt(R.attributes.degree,10)):R.attributes.type==="path"&&(I.gradient="path",I.center={left:R.attributes.left?parseFloat(R.attributes.left):0,top:R.attributes.top?parseFloat(R.attributes.top):0},R.attributes.right!==R.attributes.left&&(I.center.right=R.attributes.right?parseFloat(R.attributes.right):0),R.attributes.bottom!==R.attributes.top&&(I.center.bottom=R.attributes.bottom?parseFloat(R.attributes.bottom):0)),!0;case"stop":return this.parser=this.map.stop,this.parser.parseOpen(R),!0;default:return!1}}},{key:"parseText",value:function(R){this.parser&&this.parser.parseText(R)}},{key:"parseClose",value:function(R){return!!this.parser&&(this.parser.parseClose(R)||(this.model.stops.push(this.parser.model),this.parser=void 0),!0)}},{key:"name",get:function(){return"gradient"}},{key:"tag",get:function(){return"gradientFill"}}]),C}(u),b=function(w){p(C,w);var _=g(C);function C(){var R;return a(this,C),(R=_.call(this)).map={patternFill:new v,gradientFill:new m},R}return l(C,[{key:"render",value:function(R,I){switch(R.addRollback(),R.openNode("fill"),I.type){case"pattern":this.map.patternFill.render(R,I);break;case"gradient":this.map.gradientFill.render(R,I);break;default:return void R.rollback()}R.closeNode(),R.commit()}},{key:"parseOpen",value:function(R){if(this.parser)return this.parser.parseOpen(R),!0;switch(R.name){case"fill":return this.model={},!0;default:return this.parser=this.map[R.name],!!this.parser&&(this.parser.parseOpen(R),!0)}}},{key:"parseText",value:function(R){this.parser&&this.parser.parseText(R)}},{key:"parseClose",value:function(R){return!!this.parser&&(this.parser.parseClose(R)||(this.model=this.parser.model,this.model.type=this.parser.name,this.parser=void 0),!0)}},{key:"validStyle",value:function(R){return C.validPatternValues[R]}},{key:"tag",get:function(){return"fill"}}]),C}(u);b.validPatternValues=["none","solid","darkVertical","darkGray","mediumGray","lightGray","gray125","gray0625","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","lightGrid"].reduce(function(w,_){return w[_]=!0,w},{}),b.StopXform=c,b.PatternFillXform=v,b.GradientFillXform=m,n.exports=b},{"../base-xform":31,"./color-xform":127}],130:[function(e,n,i){function o(m){return(o=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(b){return typeof b}:function(b){return b&&typeof Symbol=="function"&&b.constructor===Symbol&&b!==Symbol.prototype?"symbol":typeof b})(m)}function a(m,b){for(var w=0;w<b.length;w++){var _=b[w];_.enumerable=_.enumerable||!1,_.configurable=!0,"value"in _&&(_.writable=!0),Object.defineProperty(m,_.key,_)}}function s(m,b){return(s=Object.setPrototypeOf||function(w,_){return w.__proto__=_,w})(m,b)}function l(m){var b=function(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch{return!1}}();return function(){var w,_=d(m);if(b){var C=d(this).constructor;w=Reflect.construct(_,arguments,C)}else w=_.apply(this,arguments);return p(this,w)}}function p(m,b){return!b||o(b)!=="object"&&typeof b!="function"?function(w){if(w===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return w}(m):b}function d(m){return(d=Object.setPrototypeOf?Object.getPrototypeOf:function(b){return b.__proto__||Object.getPrototypeOf(b)})(m)}var g=e("./color-xform"),y=e("../simple/boolean-xform"),h=e("../simple/integer-xform"),u=e("../simple/string-xform"),f=e("./underline-xform"),c=e("../../../utils/under-dash"),v=function(m){(function(R,I){if(typeof I!="function"&&I!==null)throw new TypeError("Super expression must either be null or a function");R.prototype=Object.create(I&&I.prototype,{constructor:{value:R,writable:!0,configurable:!0}}),I&&s(R,I)})(C,m);var b,w,_=l(C);function C(R){var I;return function(P,N){if(!(P instanceof N))throw new TypeError("Cannot call a class as a function")}(this,C),(I=_.call(this)).options=R||C.OPTIONS,I.map={b:{prop:"bold",xform:new y({tag:"b",attr:"val"})},i:{prop:"italic",xform:new y({tag:"i",attr:"val"})},u:{prop:"underline",xform:new f},charset:{prop:"charset",xform:new h({tag:"charset",attr:"val"})},color:{prop:"color",xform:new g},condense:{prop:"condense",xform:new y({tag:"condense",attr:"val"})},extend:{prop:"extend",xform:new y({tag:"extend",attr:"val"})},family:{prop:"family",xform:new h({tag:"family",attr:"val"})},outline:{prop:"outline",xform:new y({tag:"outline",attr:"val"})},vertAlign:{prop:"vertAlign",xform:new u({tag:"vertAlign",attr:"val"})},scheme:{prop:"scheme",xform:new u({tag:"scheme",attr:"val"})},shadow:{prop:"shadow",xform:new y({tag:"shadow",attr:"val"})},strike:{prop:"strike",xform:new y({tag:"strike",attr:"val"})},sz:{prop:"size",xform:new h({tag:"sz",attr:"val"})}},I.map[I.options.fontNameTag]={prop:"name",xform:new u({tag:I.options.fontNameTag,attr:"val"})},I}return b=C,(w=[{key:"render",value:function(R,I){var P=this.map;R.openNode(this.options.tagName),c.each(this.map,function(N,A){P[A].xform.render(R,I[N.prop])}),R.closeNode()}},{key:"parseOpen",value:function(R){if(this.parser)return this.parser.parseOpen(R),!0;if(this.map[R.name])return this.parser=this.map[R.name].xform,this.parser.parseOpen(R);switch(R.name){case this.options.tagName:return this.model={},!0;default:return!1}}},{key:"parseText",value:function(R){this.parser&&this.parser.parseText(R)}},{key:"parseClose",value:function(R){if(this.parser&&!this.parser.parseClose(R)){var I=this.map[R];return this.parser.model&&(this.model[I.prop]=this.parser.model),this.parser=void 0,!0}switch(R){case this.options.tagName:return!1;default:return!0}}},{key:"tag",get:function(){return this.options.tagName}}])&&a(b.prototype,w),C}(e("../base-xform"));v.OPTIONS={tagName:"font",fontNameTag:"name"},n.exports=v},{"../../../utils/under-dash":25,"../base-xform":31,"../simple/boolean-xform":115,"../simple/integer-xform":117,"../simple/string-xform":118,"./color-xform":127,"./underline-xform":135}],131:[function(e,n,i){function o(v){return(o=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(m){return typeof m}:function(m){return m&&typeof Symbol=="function"&&m.constructor===Symbol&&m!==Symbol.prototype?"symbol":typeof m})(v)}function a(v,m){for(var b=0;b<m.length;b++){var w=m[b];w.enumerable=w.enumerable||!1,w.configurable=!0,"value"in w&&(w.writable=!0),Object.defineProperty(v,w.key,w)}}function s(v,m){return(s=Object.setPrototypeOf||function(b,w){return b.__proto__=w,b})(v,m)}function l(v){var m=function(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch{return!1}}();return function(){var b,w=d(v);if(m){var _=d(this).constructor;b=Reflect.construct(w,arguments,_)}else b=w.apply(this,arguments);return p(this,b)}}function p(v,m){return!m||o(m)!=="object"&&typeof m!="function"?function(b){if(b===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return b}(v):m}function d(v){return(d=Object.setPrototypeOf?Object.getPrototypeOf:function(m){return m.__proto__||Object.getPrototypeOf(m)})(v)}var g=e("../../../utils/under-dash"),y=e("../../defaultnumformats"),h=e("../base-xform"),u,f=(u={},g.each(y,function(v,m){v.f&&(u[v.f]=parseInt(m,10))}),u),c=function(v){(function(C,R){if(typeof R!="function"&&R!==null)throw new TypeError("Super expression must either be null or a function");C.prototype=Object.create(R&&R.prototype,{constructor:{value:C,writable:!0,configurable:!0}}),R&&s(C,R)})(_,v);var m,b,w=l(_);function _(C,R){var I;return function(P,N){if(!(P instanceof N))throw new TypeError("Cannot call a class as a function")}(this,_),(I=w.call(this)).id=C,I.formatCode=R,I}return m=_,(b=[{key:"render",value:function(C,R){C.leafNode("numFmt",{numFmtId:R.id,formatCode:R.formatCode})}},{key:"parseOpen",value:function(C){switch(C.name){case"numFmt":return this.model={id:parseInt(C.attributes.numFmtId,10),formatCode:C.attributes.formatCode.replace(/[\\](.)/g,"$1")},!0;default:return!1}}},{key:"parseText",value:function(){}},{key:"parseClose",value:function(){return!1}},{key:"tag",get:function(){return"numFmt"}}])&&a(m.prototype,b),_}(h);c.getDefaultFmtId=function(v){return f[v]},c.getDefaultFmtCode=function(v){return y[v]&&y[v].f},n.exports=c},{"../../../utils/under-dash":25,"../../defaultnumformats":29,"../base-xform":31}],132:[function(e,n,i){function o(f){return(o=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(c){return typeof c}:function(c){return c&&typeof Symbol=="function"&&c.constructor===Symbol&&c!==Symbol.prototype?"symbol":typeof c})(f)}function a(f,c){if(!(f instanceof c))throw new TypeError("Cannot call a class as a function")}function s(f,c){for(var v=0;v<c.length;v++){var m=c[v];m.enumerable=m.enumerable||!1,m.configurable=!0,"value"in m&&(m.writable=!0),Object.defineProperty(f,m.key,m)}}function l(f,c){return(l=Object.setPrototypeOf||function(v,m){return v.__proto__=m,v})(f,c)}function p(f){var c=function(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch{return!1}}();return function(){var v,m=g(f);if(c){var b=g(this).constructor;v=Reflect.construct(m,arguments,b)}else v=m.apply(this,arguments);return d(this,v)}}function d(f,c){return!c||o(c)!=="object"&&typeof c!="function"?function(v){if(v===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return v}(f):c}function g(f){return(g=Object.setPrototypeOf?Object.getPrototypeOf:function(c){return c.__proto__||Object.getPrototypeOf(c)})(f)}var y=e("../base-xform"),h=function(f,c){return f===void 0?c:f},u=function(f){(function(w,_){if(typeof _!="function"&&_!==null)throw new TypeError("Super expression must either be null or a function");w.prototype=Object.create(_&&_.prototype,{constructor:{value:w,writable:!0,configurable:!0}}),_&&l(w,_)})(b,f);var c,v,m=p(b);function b(){return a(this,b),m.apply(this,arguments)}return c=b,(v=[{key:"render",value:function(w,_){w.addRollback(),w.openNode("protection");var C=!1;function R(I,P){P!==void 0&&(w.addAttribute(I,P),C=!0)}R("locked",h(_.locked,!0)?void 0:"0"),R("hidden",h(_.hidden,!1)?"1":void 0),w.closeNode(),C?w.commit():w.rollback()}},{key:"parseOpen",value:function(w){var _={locked:w.attributes.locked!=="0",hidden:w.attributes.hidden==="1"},C=!_.locked||_.hidden;this.model=C?_:null}},{key:"parseText",value:function(){}},{key:"parseClose",value:function(){return!1}},{key:"tag",get:function(){return"protection"}}])&&s(c.prototype,v),b}(y);n.exports=u},{"../base-xform":31}],133:[function(e,n,i){function o(f){return(o=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(c){return typeof c}:function(c){return c&&typeof Symbol=="function"&&c.constructor===Symbol&&c!==Symbol.prototype?"symbol":typeof c})(f)}function a(f,c){for(var v=0;v<c.length;v++){var m=c[v];m.enumerable=m.enumerable||!1,m.configurable=!0,"value"in m&&(m.writable=!0),Object.defineProperty(f,m.key,m)}}function s(f,c){return(s=Object.setPrototypeOf||function(v,m){return v.__proto__=m,v})(f,c)}function l(f){var c=function(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch{return!1}}();return function(){var v,m=d(f);if(c){var b=d(this).constructor;v=Reflect.construct(m,arguments,b)}else v=m.apply(this,arguments);return p(this,v)}}function p(f,c){return!c||o(c)!=="object"&&typeof c!="function"?function(v){if(v===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return v}(f):c}function d(f){return(d=Object.setPrototypeOf?Object.getPrototypeOf:function(c){return c.__proto__||Object.getPrototypeOf(c)})(f)}var g=e("../base-xform"),y=e("./alignment-xform"),h=e("./protection-xform"),u=function(f){(function(w,_){if(typeof _!="function"&&_!==null)throw new TypeError("Super expression must either be null or a function");w.prototype=Object.create(_&&_.prototype,{constructor:{value:w,writable:!0,configurable:!0}}),_&&s(w,_)})(b,f);var c,v,m=l(b);function b(w){var _;return function(C,R){if(!(C instanceof R))throw new TypeError("Cannot call a class as a function")}(this,b),(_=m.call(this)).xfId=!(!w||!w.xfId),_.map={alignment:new y,protection:new h},_}return c=b,(v=[{key:"render",value:function(w,_){w.openNode("xf",{numFmtId:_.numFmtId||0,fontId:_.fontId||0,fillId:_.fillId||0,borderId:_.borderId||0}),this.xfId&&w.addAttribute("xfId",_.xfId||0),_.numFmtId&&w.addAttribute("applyNumberFormat","1"),_.fontId&&w.addAttribute("applyFont","1"),_.fillId&&w.addAttribute("applyFill","1"),_.borderId&&w.addAttribute("applyBorder","1"),_.alignment&&w.addAttribute("applyAlignment","1"),_.protection&&w.addAttribute("applyProtection","1"),_.alignment&&this.map.alignment.render(w,_.alignment),_.protection&&this.map.protection.render(w,_.protection),w.closeNode()}},{key:"parseOpen",value:function(w){if(this.parser)return this.parser.parseOpen(w),!0;switch(w.name){case"xf":return this.model={numFmtId:parseInt(w.attributes.numFmtId,10),fontId:parseInt(w.attributes.fontId,10),fillId:parseInt(w.attributes.fillId,10),borderId:parseInt(w.attributes.borderId,10)},this.xfId&&(this.model.xfId=parseInt(w.attributes.xfId,10)),!0;case"alignment":return this.parser=this.map.alignment,this.parser.parseOpen(w),!0;case"protection":return this.parser=this.map.protection,this.parser.parseOpen(w),!0;default:return!1}}},{key:"parseText",value:function(w){this.parser&&this.parser.parseText(w)}},{key:"parseClose",value:function(w){return this.parser?(this.parser.parseClose(w)||(this.map.protection===this.parser?this.model.protection=this.parser.model:this.model.alignment=this.parser.model,this.parser=void 0),!0):w!=="xf"}},{key:"tag",get:function(){return"xf"}}])&&a(c.prototype,v),b}(g);n.exports=u},{"../base-xform":31,"./alignment-xform":125,"./protection-xform":132}],134:[function(e,n,i){function o(A){return(o=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function($){return typeof $}:function($){return $&&typeof Symbol=="function"&&$.constructor===Symbol&&$!==Symbol.prototype?"symbol":typeof $})(A)}function a(A,$){if(!(A instanceof $))throw new TypeError("Cannot call a class as a function")}function s(A,$){for(var T=0;T<$.length;T++){var M=$[T];M.enumerable=M.enumerable||!1,M.configurable=!0,"value"in M&&(M.writable=!0),Object.defineProperty(A,M.key,M)}}function l(A,$,T){return $&&s(A.prototype,$),T&&s(A,T),A}function p(A,$){if(typeof $!="function"&&$!==null)throw new TypeError("Super expression must either be null or a function");A.prototype=Object.create($&&$.prototype,{constructor:{value:A,writable:!0,configurable:!0}}),$&&d(A,$)}function d(A,$){return(d=Object.setPrototypeOf||function(T,M){return T.__proto__=M,T})(A,$)}function g(A){var $=function(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch{return!1}}();return function(){var T,M=h(A);if($){var S=h(this).constructor;T=Reflect.construct(M,arguments,S)}else T=M.apply(this,arguments);return y(this,T)}}function y(A,$){return!$||o($)!=="object"&&typeof $!="function"?function(T){if(T===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return T}(A):$}function h(A){return(h=Object.setPrototypeOf?Object.getPrototypeOf:function($){return $.__proto__||Object.getPrototypeOf($)})(A)}var u=e("../../../doc/enums"),f=e("../../../utils/xml-stream"),c=e("../base-xform"),v=e("../static-xform"),m=e("../list-xform"),b=e("./font-xform"),w=e("./fill-xform"),_=e("./border-xform"),C=e("./numfmt-xform"),R=e("./style-xform"),I=e("./dxf-xform"),P=function(A){p(T,A);var $=g(T);function T(M){var S;return a(this,T),(S=$.call(this)).map={numFmts:new m({tag:"numFmts",count:!0,childXform:new C}),fonts:new m({tag:"fonts",count:!0,childXform:new b,$:{"x14ac:knownFonts":1}}),fills:new m({tag:"fills",count:!0,childXform:new w}),borders:new m({tag:"borders",count:!0,childXform:new _}),cellStyleXfs:new m({tag:"cellStyleXfs",count:!0,childXform:new R}),cellXfs:new m({tag:"cellXfs",count:!0,childXform:new R({xfId:!0})}),dxfs:new m({tag:"dxfs",always:!0,count:!0,childXform:new I}),numFmt:new C,font:new b,fill:new w,border:new _,style:new R({xfId:!0}),cellStyles:T.STATIC_XFORMS.cellStyles,tableStyles:T.STATIC_XFORMS.tableStyles,extLst:T.STATIC_XFORMS.extLst},M&&S.init(),S}return l(T,[{key:"initIndex",value:function(){this.index={style:{},numFmt:{},numFmtNextId:164,font:{},border:{},fill:{}}}},{key:"init",value:function(){this.model={styles:[],numFmts:[],fonts:[],borders:[],fills:[],dxfs:[]},this.initIndex(),this._addBorder({}),this._addStyle({numFmtId:0,fontId:0,fillId:0,borderId:0,xfId:0}),this._addFill({type:"pattern",pattern:"none"}),this._addFill({type:"pattern",pattern:"gray125"}),this.weakMap=new WeakMap}},{key:"render",value:function(M,S){S=S||this.model,M.openXml(f.StdDocAttributes),M.openNode("styleSheet",T.STYLESHEET_ATTRIBUTES),this.index?(S.numFmts&&S.numFmts.length&&(M.openNode("numFmts",{count:S.numFmts.length}),S.numFmts.forEach(function(E){M.writeXml(E)}),M.closeNode()),S.fonts.length||this._addFont({size:11,color:{theme:1},name:"Calibri",family:2,scheme:"minor"}),M.openNode("fonts",{count:S.fonts.length,"x14ac:knownFonts":1}),S.fonts.forEach(function(E){M.writeXml(E)}),M.closeNode(),M.openNode("fills",{count:S.fills.length}),S.fills.forEach(function(E){M.writeXml(E)}),M.closeNode(),M.openNode("borders",{count:S.borders.length}),S.borders.forEach(function(E){M.writeXml(E)}),M.closeNode(),this.map.cellStyleXfs.render(M,[{numFmtId:0,fontId:0,fillId:0,borderId:0,xfId:0}]),M.openNode("cellXfs",{count:S.styles.length}),S.styles.forEach(function(E){M.writeXml(E)}),M.closeNode()):(this.map.numFmts.render(M,S.numFmts),this.map.fonts.render(M,S.fonts),this.map.fills.render(M,S.fills),this.map.borders.render(M,S.borders),this.map.cellStyleXfs.render(M,[{numFmtId:0,fontId:0,fillId:0,borderId:0,xfId:0}]),this.map.cellXfs.render(M,S.styles)),T.STATIC_XFORMS.cellStyles.render(M),this.map.dxfs.render(M,S.dxfs),T.STATIC_XFORMS.tableStyles.render(M),T.STATIC_XFORMS.extLst.render(M),M.closeNode()}},{key:"parseOpen",value:function(M){if(this.parser)return this.parser.parseOpen(M),!0;switch(M.name){case"styleSheet":return this.initIndex(),!0;default:return this.parser=this.map[M.name],this.parser&&this.parser.parseOpen(M),!0}}},{key:"parseText",value:function(M){this.parser&&this.parser.parseText(M)}},{key:"parseClose",value:function(M){var S=this;if(this.parser)return this.parser.parseClose(M)||(this.parser=void 0),!0;switch(M){case"styleSheet":this.model={};var E=function(O,x){x.model&&x.model.length&&(S.model[O]=x.model)};if(E("numFmts",this.map.numFmts),E("fonts",this.map.fonts),E("fills",this.map.fills),E("borders",this.map.borders),E("styles",this.map.cellXfs),E("dxfs",this.map.dxfs),this.index={model:[],numFmt:[]},this.model.numFmts){var k=this.index.numFmt;this.model.numFmts.forEach(function(O){k[O.id]=O.formatCode})}return!1;default:return!0}}},{key:"addStyleModel",value:function(M,S){if(!M)return 0;if(this.model.fonts.length||this._addFont({size:11,color:{theme:1},name:"Calibri",family:2,scheme:"minor"}),this.weakMap&&this.weakMap.has(M))return this.weakMap.get(M);var E={};if(S=S||u.ValueType.Number,M.numFmt)E.numFmtId=this._addNumFmtStr(M.numFmt);else switch(S){case u.ValueType.Number:E.numFmtId=this._addNumFmtStr("General");break;case u.ValueType.Date:E.numFmtId=this._addNumFmtStr("mm-dd-yy")}M.font&&(E.fontId=this._addFont(M.font)),M.border&&(E.borderId=this._addBorder(M.border)),M.fill&&(E.fillId=this._addFill(M.fill)),M.alignment&&(E.alignment=M.alignment),M.protection&&(E.protection=M.protection);var k=this._addStyle(E);return this.weakMap&&this.weakMap.set(M,k),k}},{key:"getStyleModel",value:function(M){var S=this.model.styles[M];if(!S)return null;var E=this.index.model[M];if(E)return E;if(E=this.index.model[M]={},S.numFmtId){var k=this.index.numFmt[S.numFmtId]||C.getDefaultFmtCode(S.numFmtId);k&&(E.numFmt=k)}function O(x,j,H){if(H||H===0){var F=j[H];F&&(E[x]=F)}}return O("font",this.model.fonts,S.fontId),O("border",this.model.borders,S.borderId),O("fill",this.model.fills,S.fillId),S.alignment&&(E.alignment=S.alignment),S.protection&&(E.protection=S.protection),E}},{key:"addDxfStyle",value:function(M){return this.model.dxfs.push(M),this.model.dxfs.length-1}},{key:"getDxfStyle",value:function(M){return this.model.dxfs[M]}},{key:"_addStyle",value:function(M){var S=this.map.style.toXml(M),E=this.index.style[S];return E===void 0&&(E=this.index.style[S]=this.model.styles.length,this.model.styles.push(S)),E}},{key:"_addNumFmtStr",value:function(M){var S=C.getDefaultFmtId(M);if(S!==void 0||(S=this.index.numFmt[M])!==void 0)return S;S=this.index.numFmt[M]=164+this.model.numFmts.length;var E=this.map.numFmt.toXml({id:S,formatCode:M});return this.model.numFmts.push(E),S}},{key:"_addFont",value:function(M){var S=this.map.font.toXml(M),E=this.index.font[S];return E===void 0&&(E=this.index.font[S]=this.model.fonts.length,this.model.fonts.push(S)),E}},{key:"_addBorder",value:function(M){var S=this.map.border.toXml(M),E=this.index.border[S];return E===void 0&&(E=this.index.border[S]=this.model.borders.length,this.model.borders.push(S)),E}},{key:"_addFill",value:function(M){var S=this.map.fill.toXml(M),E=this.index.fill[S];return E===void 0&&(E=this.index.fill[S]=this.model.fills.length,this.model.fills.push(S)),E}}]),T}(c);P.STYLESHEET_ATTRIBUTES={xmlns:"http://schemas.openxmlformats.org/spreadsheetml/2006/main","xmlns:mc":"http://schemas.openxmlformats.org/markup-compatibility/2006","mc:Ignorable":"x14ac x16r2","xmlns:x14ac":"http://schemas.microsoft.com/office/spreadsheetml/2009/9/ac","xmlns:x16r2":"http://schemas.microsoft.com/office/spreadsheetml/2015/02/main"},P.STATIC_XFORMS={cellStyles:new v({tag:"cellStyles",$:{count:1},c:[{tag:"cellStyle",$:{name:"Normal",xfId:0,builtinId:0}}]}),dxfs:new v({tag:"dxfs",$:{count:0}}),tableStyles:new v({tag:"tableStyles",$:{count:0,defaultTableStyle:"TableStyleMedium2",defaultPivotStyle:"PivotStyleLight16"}}),extLst:new v({tag:"extLst",c:[{tag:"ext",$:{uri:"{EB79DEF2-80B8-43e5-95BD-54CBDDF9020C}","xmlns:x14":"http://schemas.microsoft.com/office/spreadsheetml/2009/9/main"},c:[{tag:"x14:slicerStyles",$:{defaultSlicerStyle:"SlicerStyleLight1"}}]},{tag:"ext",$:{uri:"{9260A510-F301-46a8-8635-F512D64BE5F5}","xmlns:x15":"http://schemas.microsoft.com/office/spreadsheetml/2010/11/main"},c:[{tag:"x15:timelineStyles",$:{defaultTimelineStyle:"TimeSlicerStyleLight1"}}]}]})};var N=function(A){p(T,A);var $=g(T);function T(){var M;return a(this,T),(M=$.call(this)).model={styles:[{numFmtId:0,fontId:0,fillId:0,borderId:0,xfId:0}],numFmts:[],fonts:[{size:11,color:{theme:1},name:"Calibri",family:2,scheme:"minor"}],borders:[{}],fills:[{type:"pattern",pattern:"none"},{type:"pattern",pattern:"gray125"}]},M}return l(T,[{key:"parseStream",value:function(M){return M.autodrain(),Promise.resolve()}},{key:"addStyleModel",value:function(M,S){switch(S){case u.ValueType.Date:return this.dateStyleId;default:return 0}}},{key:"getStyleModel",value:function(){return{}}},{key:"dateStyleId",get:function(){if(!this._dateStyleId){var M={numFmtId:C.getDefaultFmtId("mm-dd-yy")};this._dateStyleId=this.model.styles.length,this.model.styles.push(M)}return this._dateStyleId}}]),T}(P);P.Mock=N,n.exports=P},{"../../../doc/enums":7,"../../../utils/xml-stream":27,"../base-xform":31,"../list-xform":70,"../static-xform":119,"./border-xform":126,"./dxf-xform":128,"./fill-xform":129,"./font-xform":130,"./numfmt-xform":131,"./style-xform":133}],135:[function(e,n,i){function o(y){return(o=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(h){return typeof h}:function(h){return h&&typeof Symbol=="function"&&h.constructor===Symbol&&h!==Symbol.prototype?"symbol":typeof h})(y)}function a(y,h){for(var u=0;u<h.length;u++){var f=h[u];f.enumerable=f.enumerable||!1,f.configurable=!0,"value"in f&&(f.writable=!0),Object.defineProperty(y,f.key,f)}}function s(y,h){return(s=Object.setPrototypeOf||function(u,f){return u.__proto__=f,u})(y,h)}function l(y){var h=function(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch{return!1}}();return function(){var u,f=d(y);if(h){var c=d(this).constructor;u=Reflect.construct(f,arguments,c)}else u=f.apply(this,arguments);return p(this,u)}}function p(y,h){return!h||o(h)!=="object"&&typeof h!="function"?function(u){if(u===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return u}(y):h}function d(y){return(d=Object.setPrototypeOf?Object.getPrototypeOf:function(h){return h.__proto__||Object.getPrototypeOf(h)})(y)}var g=function(y){(function(v,m){if(typeof m!="function"&&m!==null)throw new TypeError("Super expression must either be null or a function");v.prototype=Object.create(m&&m.prototype,{constructor:{value:v,writable:!0,configurable:!0}}),m&&s(v,m)})(c,y);var h,u,f=l(c);function c(v){var m;return function(b,w){if(!(b instanceof w))throw new TypeError("Cannot call a class as a function")}(this,c),(m=f.call(this)).model=v,m}return h=c,(u=[{key:"render",value:function(v,m){if((m=m||this.model)===!0)v.leafNode("u");else{var b=c.Attributes[m];b&&v.leafNode("u",b)}}},{key:"parseOpen",value:function(v){v.name==="u"&&(this.model=v.attributes.val||!0)}},{key:"parseText",value:function(){}},{key:"parseClose",value:function(){return!1}},{key:"tag",get:function(){return"u"}}])&&a(h.prototype,u),c}(e("../base-xform"));g.Attributes={single:{},double:{val:"double"},singleAccounting:{val:"singleAccounting"},doubleAccounting:{val:"doubleAccounting"}},n.exports=g},{"../base-xform":31}],136:[function(e,n,i){function o(u){return(o=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(f){return typeof f}:function(f){return f&&typeof Symbol=="function"&&f.constructor===Symbol&&f!==Symbol.prototype?"symbol":typeof f})(u)}function a(u,f){for(var c=0;c<f.length;c++){var v=f[c];v.enumerable=v.enumerable||!1,v.configurable=!0,"value"in v&&(v.writable=!0),Object.defineProperty(u,v.key,v)}}function s(u,f){return(s=Object.setPrototypeOf||function(c,v){return c.__proto__=v,c})(u,f)}function l(u){var f=function(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch{return!1}}();return function(){var c,v=d(u);if(f){var m=d(this).constructor;c=Reflect.construct(v,arguments,m)}else c=v.apply(this,arguments);return p(this,c)}}function p(u,f){return!f||o(f)!=="object"&&typeof f!="function"?function(c){if(c===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return c}(u):f}function d(u){return(d=Object.setPrototypeOf?Object.getPrototypeOf:function(f){return f.__proto__||Object.getPrototypeOf(f)})(u)}var g=e("../base-xform"),y=e("./filter-column-xform"),h=function(u){(function(b,w){if(typeof w!="function"&&w!==null)throw new TypeError("Super expression must either be null or a function");b.prototype=Object.create(w&&w.prototype,{constructor:{value:b,writable:!0,configurable:!0}}),w&&s(b,w)})(m,u);var f,c,v=l(m);function m(){var b;return function(w,_){if(!(w instanceof _))throw new TypeError("Cannot call a class as a function")}(this,m),(b=v.call(this)).map={filterColumn:new y},b}return f=m,(c=[{key:"prepare",value:function(b){var w=this;b.columns.forEach(function(_,C){w.map.filterColumn.prepare(_,{index:C})})}},{key:"render",value:function(b,w){var _=this;return b.openNode(this.tag,{ref:w.autoFilterRef}),w.columns.forEach(function(C){_.map.filterColumn.render(b,C)}),b.closeNode(),!0}},{key:"parseOpen",value:function(b){if(this.parser)return this.parser.parseOpen(b),!0;switch(b.name){case this.tag:return this.model={autoFilterRef:b.attributes.ref,columns:[]},!0;default:if(this.parser=this.map[b.name],this.parser)return this.parseOpen(b),!0;throw new Error("Unexpected xml node in parseOpen: ".concat(JSON.stringify(b)))}}},{key:"parseText",value:function(b){this.parser&&this.parser.parseText(b)}},{key:"parseClose",value:function(b){if(this.parser)return this.parser.parseClose(b)||(this.model.columns.push(this.parser.model),this.parser=void 0),!0;switch(b){case this.tag:return!1;default:throw new Error("Unexpected xml node in parseClose: ".concat(b))}}},{key:"tag",get:function(){return"autoFilter"}}])&&a(f.prototype,c),m}(g);n.exports=h},{"../base-xform":31,"./filter-column-xform":137}],137:[function(e,n,i){function o(h){return(o=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(u){return typeof u}:function(u){return u&&typeof Symbol=="function"&&u.constructor===Symbol&&u!==Symbol.prototype?"symbol":typeof u})(h)}function a(h,u){if(!(h instanceof u))throw new TypeError("Cannot call a class as a function")}function s(h,u){for(var f=0;f<u.length;f++){var c=u[f];c.enumerable=c.enumerable||!1,c.configurable=!0,"value"in c&&(c.writable=!0),Object.defineProperty(h,c.key,c)}}function l(h,u){return(l=Object.setPrototypeOf||function(f,c){return f.__proto__=c,f})(h,u)}function p(h){var u=function(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch{return!1}}();return function(){var f,c=g(h);if(u){var v=g(this).constructor;f=Reflect.construct(c,arguments,v)}else f=c.apply(this,arguments);return d(this,f)}}function d(h,u){return!u||o(u)!=="object"&&typeof u!="function"?function(f){if(f===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return f}(h):u}function g(h){return(g=Object.setPrototypeOf?Object.getPrototypeOf:function(u){return u.__proto__||Object.getPrototypeOf(u)})(h)}var y=function(h){(function(m,b){if(typeof b!="function"&&b!==null)throw new TypeError("Super expression must either be null or a function");m.prototype=Object.create(b&&b.prototype,{constructor:{value:m,writable:!0,configurable:!0}}),b&&l(m,b)})(v,h);var u,f,c=p(v);function v(){return a(this,v),c.apply(this,arguments)}return u=v,(f=[{key:"prepare",value:function(m,b){m.colId=b.index.toString()}},{key:"render",value:function(m,b){return m.leafNode(this.tag,{colId:b.colId,hiddenButton:b.filterButton?"0":"1"}),!0}},{key:"parseOpen",value:function(m){if(m.name===this.tag){var b=m.attributes;return this.model={filterButton:b.hiddenButton==="0"},!0}return!1}},{key:"parseText",value:function(){}},{key:"parseClose",value:function(){return!1}},{key:"tag",get:function(){return"filterColumn"}}])&&s(u.prototype,f),v}(e("../base-xform"));n.exports=y},{"../base-xform":31}],138:[function(e,n,i){function o(h){return(o=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(u){return typeof u}:function(u){return u&&typeof Symbol=="function"&&u.constructor===Symbol&&u!==Symbol.prototype?"symbol":typeof u})(h)}function a(h,u){if(!(h instanceof u))throw new TypeError("Cannot call a class as a function")}function s(h,u){for(var f=0;f<u.length;f++){var c=u[f];c.enumerable=c.enumerable||!1,c.configurable=!0,"value"in c&&(c.writable=!0),Object.defineProperty(h,c.key,c)}}function l(h,u){return(l=Object.setPrototypeOf||function(f,c){return f.__proto__=c,f})(h,u)}function p(h){var u=function(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch{return!1}}();return function(){var f,c=g(h);if(u){var v=g(this).constructor;f=Reflect.construct(c,arguments,v)}else f=c.apply(this,arguments);return d(this,f)}}function d(h,u){return!u||o(u)!=="object"&&typeof u!="function"?function(f){if(f===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return f}(h):u}function g(h){return(g=Object.setPrototypeOf?Object.getPrototypeOf:function(u){return u.__proto__||Object.getPrototypeOf(u)})(h)}var y=function(h){(function(m,b){if(typeof b!="function"&&b!==null)throw new TypeError("Super expression must either be null or a function");m.prototype=Object.create(b&&b.prototype,{constructor:{value:m,writable:!0,configurable:!0}}),b&&l(m,b)})(v,h);var u,f,c=p(v);function v(){return a(this,v),c.apply(this,arguments)}return u=v,(f=[{key:"prepare",value:function(m,b){m.id=b.index+1}},{key:"render",value:function(m,b){return m.leafNode(this.tag,{id:b.id.toString(),name:b.name,totalsRowLabel:b.totalsRowLabel,totalsRowFunction:b.totalsRowFunction,dxfId:b.dxfId}),!0}},{key:"parseOpen",value:function(m){if(m.name===this.tag){var b=m.attributes;return this.model={name:b.name,totalsRowLabel:b.totalsRowLabel,totalsRowFunction:b.totalsRowFunction,dxfId:b.dxfId},!0}return!1}},{key:"parseText",value:function(){}},{key:"parseClose",value:function(){return!1}},{key:"tag",get:function(){return"tableColumn"}}])&&s(u.prototype,f),v}(e("../base-xform"));n.exports=y},{"../base-xform":31}],139:[function(e,n,i){function o(h){return(o=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(u){return typeof u}:function(u){return u&&typeof Symbol=="function"&&u.constructor===Symbol&&u!==Symbol.prototype?"symbol":typeof u})(h)}function a(h,u){if(!(h instanceof u))throw new TypeError("Cannot call a class as a function")}function s(h,u){for(var f=0;f<u.length;f++){var c=u[f];c.enumerable=c.enumerable||!1,c.configurable=!0,"value"in c&&(c.writable=!0),Object.defineProperty(h,c.key,c)}}function l(h,u){return(l=Object.setPrototypeOf||function(f,c){return f.__proto__=c,f})(h,u)}function p(h){var u=function(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch{return!1}}();return function(){var f,c=g(h);if(u){var v=g(this).constructor;f=Reflect.construct(c,arguments,v)}else f=c.apply(this,arguments);return d(this,f)}}function d(h,u){return!u||o(u)!=="object"&&typeof u!="function"?function(f){if(f===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return f}(h):u}function g(h){return(g=Object.setPrototypeOf?Object.getPrototypeOf:function(u){return u.__proto__||Object.getPrototypeOf(u)})(h)}var y=function(h){(function(m,b){if(typeof b!="function"&&b!==null)throw new TypeError("Super expression must either be null or a function");m.prototype=Object.create(b&&b.prototype,{constructor:{value:m,writable:!0,configurable:!0}}),b&&l(m,b)})(v,h);var u,f,c=p(v);function v(){return a(this,v),c.apply(this,arguments)}return u=v,(f=[{key:"render",value:function(m,b){return m.leafNode(this.tag,{name:b.theme?b.theme:void 0,showFirstColumn:b.showFirstColumn?"1":"0",showLastColumn:b.showLastColumn?"1":"0",showRowStripes:b.showRowStripes?"1":"0",showColumnStripes:b.showColumnStripes?"1":"0"}),!0}},{key:"parseOpen",value:function(m){if(m.name===this.tag){var b=m.attributes;return this.model={theme:b.name?b.name:null,showFirstColumn:b.showFirstColumn==="1",showLastColumn:b.showLastColumn==="1",showRowStripes:b.showRowStripes==="1",showColumnStripes:b.showColumnStripes==="1"},!0}return!1}},{key:"parseText",value:function(){}},{key:"parseClose",value:function(){return!1}},{key:"tag",get:function(){return"tableStyleInfo"}}])&&s(u.prototype,f),v}(e("../base-xform"));n.exports=y},{"../base-xform":31}],140:[function(e,n,i){function o(_){return(o=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(C){return typeof C}:function(C){return C&&typeof Symbol=="function"&&C.constructor===Symbol&&C!==Symbol.prototype?"symbol":typeof C})(_)}function a(_,C){var R=Object.keys(_);if(Object.getOwnPropertySymbols){var I=Object.getOwnPropertySymbols(_);C&&(I=I.filter(function(P){return Object.getOwnPropertyDescriptor(_,P).enumerable})),R.push.apply(R,I)}return R}function s(_){for(var C=1;C<arguments.length;C++){var R=arguments[C]!=null?arguments[C]:{};C%2?a(Object(R),!0).forEach(function(I){l(_,I,R[I])}):Object.getOwnPropertyDescriptors?Object.defineProperties(_,Object.getOwnPropertyDescriptors(R)):a(Object(R)).forEach(function(I){Object.defineProperty(_,I,Object.getOwnPropertyDescriptor(R,I))})}return _}function l(_,C,R){return C in _?Object.defineProperty(_,C,{value:R,enumerable:!0,configurable:!0,writable:!0}):_[C]=R,_}function p(_,C){for(var R=0;R<C.length;R++){var I=C[R];I.enumerable=I.enumerable||!1,I.configurable=!0,"value"in I&&(I.writable=!0),Object.defineProperty(_,I.key,I)}}function d(_,C){return(d=Object.setPrototypeOf||function(R,I){return R.__proto__=I,R})(_,C)}function g(_){var C=function(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch{return!1}}();return function(){var R,I=h(_);if(C){var P=h(this).constructor;R=Reflect.construct(I,arguments,P)}else R=I.apply(this,arguments);return y(this,R)}}function y(_,C){return!C||o(C)!=="object"&&typeof C!="function"?function(R){if(R===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return R}(_):C}function h(_){return(h=Object.setPrototypeOf?Object.getPrototypeOf:function(C){return C.__proto__||Object.getPrototypeOf(C)})(_)}var u=e("../../../utils/xml-stream"),f=e("../base-xform"),c=e("../list-xform"),v=e("./auto-filter-xform"),m=e("./table-column-xform"),b=e("./table-style-info-xform"),w=function(_){(function(N,A){if(typeof A!="function"&&A!==null)throw new TypeError("Super expression must either be null or a function");N.prototype=Object.create(A&&A.prototype,{constructor:{value:N,writable:!0,configurable:!0}}),A&&d(N,A)})(P,_);var C,R,I=g(P);function P(){var N;return function(A,$){if(!(A instanceof $))throw new TypeError("Cannot call a class as a function")}(this,P),(N=I.call(this)).map={autoFilter:new v,tableColumns:new c({tag:"tableColumns",count:!0,empty:!0,childXform:new m}),tableStyleInfo:new b},N}return C=P,(R=[{key:"prepare",value:function(N,A){this.map.autoFilter.prepare(N),this.map.tableColumns.prepare(N.columns,A)}},{key:"render",value:function(N,A){N.openXml(u.StdDocAttributes),N.openNode(this.tag,s(s({},P.TABLE_ATTRIBUTES),{},{id:A.id,name:A.name,displayName:A.displayName||A.name,ref:A.tableRef,totalsRowCount:A.totalsRow?"1":void 0,totalsRowShown:A.totalsRow?void 0:"1",headerRowCount:A.headerRow?"1":"0"})),this.map.autoFilter.render(N,A),this.map.tableColumns.render(N,A.columns),this.map.tableStyleInfo.render(N,A.style),N.closeNode()}},{key:"parseOpen",value:function(N){if(this.parser)return this.parser.parseOpen(N),!0;var A=N.name,$=N.attributes;switch(A){case this.tag:this.reset(),this.model={name:$.name,displayName:$.displayName||$.name,tableRef:$.ref,totalsRow:$.totalsRowCount==="1",headerRow:$.headerRowCount==="1"};break;default:this.parser=this.map[N.name],this.parser&&this.parser.parseOpen(N)}return!0}},{key:"parseText",value:function(N){this.parser&&this.parser.parseText(N)}},{key:"parseClose",value:function(N){var A=this;if(this.parser)return this.parser.parseClose(N)||(this.parser=void 0),!0;switch(N){case this.tag:return this.model.columns=this.map.tableColumns.model,this.map.autoFilter.model&&(this.model.autoFilterRef=this.map.autoFilter.model.autoFilterRef,this.map.autoFilter.model.columns.forEach(function($,T){A.model.columns[T].filterButton=$.filterButton})),this.model.style=this.map.tableStyleInfo.model,!1;default:return!0}}},{key:"reconcile",value:function(N,A){N.columns.forEach(function($){$.dxfId!==void 0&&($.style=A.styles.getDxfStyle($.dxfId))})}},{key:"tag",get:function(){return"table"}}])&&p(C.prototype,R),P}(f);w.TABLE_ATTRIBUTES={xmlns:"http://schemas.openxmlformats.org/spreadsheetml/2006/main","xmlns:mc":"http://schemas.openxmlformats.org/markup-compatibility/2006","mc:Ignorable":"xr xr3","xmlns:xr":"http://schemas.microsoft.com/office/spreadsheetml/2014/revision","xmlns:xr3":"http://schemas.microsoft.com/office/spreadsheetml/2016/revision3"},n.exports=w},{"../../../utils/xml-stream":27,"../base-xform":31,"../list-xform":70,"./auto-filter-xform":136,"./table-column-xform":138,"./table-style-info-xform":139}],141:[function(e,n,i){(function(o,a){function s(O,x,j,H,F,V,W){try{var U=O[V](W),Y=U.value}catch(K){return void j(K)}U.done?x(Y):Promise.resolve(Y).then(H,F)}function l(O){return function(){var x=this,j=arguments;return new Promise(function(H,F){var V=O.apply(x,j);function W(Y){s(V,H,F,W,U,"next",Y)}function U(Y){s(V,H,F,W,U,"throw",Y)}W(void 0)})}}function p(O,x){for(var j=0;j<x.length;j++){var H=x[j];H.enumerable=H.enumerable||!1,H.configurable=!0,"value"in H&&(H.writable=!0),Object.defineProperty(O,H.key,H)}}function d(O){var x;if(typeof Symbol!="undefined"&&(Symbol.asyncIterator&&(x=O[Symbol.asyncIterator])!=null||Symbol.iterator&&(x=O[Symbol.iterator])!=null))return x.call(O);throw new TypeError("Object is not async iterable")}var g=e("fs"),y=e("jszip"),h=e("readable-stream").PassThrough,u=e("../utils/zip-stream"),f=e("../utils/stream-buf"),c=e("../utils/utils"),v=e("../utils/xml-stream"),m=e("../utils/browser-buffer-decode").bufferToString,b=e("./xform/style/styles-xform"),w=e("./xform/core/core-xform"),_=e("./xform/strings/shared-strings-xform"),C=e("./xform/core/relationships-xform"),R=e("./xform/core/content-types-xform"),I=e("./xform/core/app-xform"),P=e("./xform/book/workbook-xform"),N=e("./xform/sheet/worksheet-xform"),A=e("./xform/drawing/drawing-xform"),$=e("./xform/table/table-xform"),T=e("./xform/comment/comments-xform"),M=e("./xform/comment/vml-notes-xform"),S=e("./xml/theme1.js");function E(O,x){return new Promise(function(j,H){g.readFile(O,x,function(F,V){F?H(F):j(V)})})}var k=function(){function O(G){(function(Z,Q){if(!(Z instanceof Q))throw new TypeError("Cannot call a class as a function")})(this,O),this.workbook=G}var x,j,H,F,V,W,U,Y,K,D,L,B,z,q,X,ee,ye,de,ge,we,be,J,te,ie,fe,se,oe;return x=O,(j=[{key:"readFile",value:(oe=l(regeneratorRuntime.mark(function G(Z,Q){var re,ne;return regeneratorRuntime.wrap(function(ue){for(;;)switch(ue.prev=ue.next){case 0:return ue.next=2,c.fs.exists(Z);case 2:if(ue.sent){ue.next=4;break}throw new Error("File not found: ".concat(Z));case 4:return re=g.createReadStream(Z),ue.prev=5,ue.next=8,this.read(re,Q);case 8:return ne=ue.sent,re.close(),ue.abrupt("return",ne);case 13:throw ue.prev=13,ue.t0=ue.catch(5),re.close(),ue.t0;case 17:case"end":return ue.stop()}},G,this,[[5,13]])})),function(G,Z){return oe.apply(this,arguments)})},{key:"parseRels",value:function(G){return new C().parseStream(G)}},{key:"parseWorkbook",value:function(G){return new P().parseStream(G)}},{key:"parseSharedStrings",value:function(G){return new _().parseStream(G)}},{key:"reconcile",value:function(G,Z){var Q=new P,re=new N(Z),ne=new A,ue=new $;Q.reconcile(G);var le={media:G.media,mediaIndex:G.mediaIndex};Object.keys(G.drawings).forEach(function(Oe){var xe=G.drawings[Oe],Ce=G.drawingRels[Oe];Ce&&(le.rels=Ce.reduce(function(Le,Ve){return Le[Ve.Id]=Ve,Le},{}),(xe.anchors||[]).forEach(function(Le){var Ve=Le.picture&&Le.picture.hyperlinks;Ve&&le.rels[Ve.rId]&&(Ve.hyperlink=le.rels[Ve.rId].Target,delete Ve.rId)}),ne.reconcile(xe,le))});var ve={styles:G.styles};Object.values(G.tables).forEach(function(Oe){ue.reconcile(Oe,ve)});var Se={styles:G.styles,sharedStrings:G.sharedStrings,media:G.media,mediaIndex:G.mediaIndex,date1904:G.properties&&G.properties.date1904,drawings:G.drawings,comments:G.comments,tables:G.tables,vmlDrawings:G.vmlDrawings};G.worksheets.forEach(function(Oe){Oe.relationships=G.worksheetRels[Oe.sheetNo],re.reconcile(Oe,Se)}),delete G.worksheetHash,delete G.worksheetRels,delete G.globalRels,delete G.sharedStrings,delete G.workbookRels,delete G.sheetDefs,delete G.styles,delete G.mediaIndex,delete G.drawings,delete G.drawingRels,delete G.vmlDrawings}},{key:"_processWorksheetEntry",value:(se=l(regeneratorRuntime.mark(function G(Z,Q,re,ne,ue){var le,ve;return regeneratorRuntime.wrap(function(Se){for(;;)switch(Se.prev=Se.next){case 0:return le=new N(ne),Se.next=3,le.parseStream(Z);case 3:(ve=Se.sent).sheetNo=re,Q.worksheetHash[ue]=ve,Q.worksheets.push(ve);case 7:case"end":return Se.stop()}},G)})),function(G,Z,Q,re,ne){return se.apply(this,arguments)})},{key:"_processCommentEntry",value:(fe=l(regeneratorRuntime.mark(function G(Z,Q,re){var ne,ue;return regeneratorRuntime.wrap(function(le){for(;;)switch(le.prev=le.next){case 0:return ne=new T,le.next=3,ne.parseStream(Z);case 3:ue=le.sent,Q.comments["../".concat(re,".xml")]=ue;case 5:case"end":return le.stop()}},G)})),function(G,Z,Q){return fe.apply(this,arguments)})},{key:"_processTableEntry",value:(ie=l(regeneratorRuntime.mark(function G(Z,Q,re){var ne,ue;return regeneratorRuntime.wrap(function(le){for(;;)switch(le.prev=le.next){case 0:return ne=new $,le.next=3,ne.parseStream(Z);case 3:ue=le.sent,Q.tables["../tables/".concat(re,".xml")]=ue;case 5:case"end":return le.stop()}},G)})),function(G,Z,Q){return ie.apply(this,arguments)})},{key:"_processWorksheetRelsEntry",value:(te=l(regeneratorRuntime.mark(function G(Z,Q,re){var ne,ue;return regeneratorRuntime.wrap(function(le){for(;;)switch(le.prev=le.next){case 0:return ne=new C,le.next=3,ne.parseStream(Z);case 3:ue=le.sent,Q.worksheetRels[re]=ue;case 5:case"end":return le.stop()}},G)})),function(G,Z,Q){return te.apply(this,arguments)})},{key:"_processMediaEntry",value:(J=l(regeneratorRuntime.mark(function G(Z,Q,re){var ne,ue,le;return regeneratorRuntime.wrap(function(ve){for(;;)switch(ve.prev=ve.next){case 0:if(!((ne=re.lastIndexOf("."))>=1)){ve.next=6;break}return ue=re.substr(ne+1),le=re.substr(0,ne),ve.next=6,new Promise(function(Se,Oe){var xe=new f;xe.on("finish",function(){Q.mediaIndex[re]=Q.media.length,Q.mediaIndex[le]=Q.media.length;var Ce={type:"image",name:le,extension:ue,buffer:xe.toBuffer()};Q.media.push(Ce),Se()}),Z.on("error",function(Ce){Oe(Ce)}),Z.pipe(xe)});case 6:case"end":return ve.stop()}},G)})),function(G,Z,Q){return J.apply(this,arguments)})},{key:"_processDrawingEntry",value:(be=l(regeneratorRuntime.mark(function G(Z,Q,re){var ne,ue;return regeneratorRuntime.wrap(function(le){for(;;)switch(le.prev=le.next){case 0:return ne=new A,le.next=3,ne.parseStream(Z);case 3:ue=le.sent,Q.drawings[re]=ue;case 5:case"end":return le.stop()}},G)})),function(G,Z,Q){return be.apply(this,arguments)})},{key:"_processDrawingRelsEntry",value:(we=l(regeneratorRuntime.mark(function G(Z,Q,re){var ne,ue;return regeneratorRuntime.wrap(function(le){for(;;)switch(le.prev=le.next){case 0:return ne=new C,le.next=3,ne.parseStream(Z);case 3:ue=le.sent,Q.drawingRels[re]=ue;case 5:case"end":return le.stop()}},G)})),function(G,Z,Q){return we.apply(this,arguments)})},{key:"_processVmlDrawingEntry",value:(ge=l(regeneratorRuntime.mark(function G(Z,Q,re){var ne,ue;return regeneratorRuntime.wrap(function(le){for(;;)switch(le.prev=le.next){case 0:return ne=new M,le.next=3,ne.parseStream(Z);case 3:ue=le.sent,Q.vmlDrawings["../drawings/".concat(re,".vml")]=ue;case 5:case"end":return le.stop()}},G)})),function(G,Z,Q){return ge.apply(this,arguments)})},{key:"_processThemeEntry",value:(de=l(regeneratorRuntime.mark(function G(Z,Q,re){return regeneratorRuntime.wrap(function(ne){for(;;)switch(ne.prev=ne.next){case 0:return ne.next=2,new Promise(function(ue,le){var ve=new f;Z.on("error",le),ve.on("error",le),ve.on("finish",function(){Q.themes[re]=ve.read().toString(),ue()}),Z.pipe(ve)});case 2:case"end":return ne.stop()}},G)})),function(G,Z,Q){return de.apply(this,arguments)})},{key:"createInputStream",value:function(){throw new Error("`XLSX#createInputStream` is deprecated. You should use `XLSX#read` instead. This method will be removed in version 5.0. Please follow upgrade instruction: https://github.com/exceljs/exceljs/blob/master/UPGRADE-4.0.md")}},{key:"read",value:(ye=l(regeneratorRuntime.mark(function G(Z,Q){var re,ne,ue,le,ve,Se,Oe,xe;return regeneratorRuntime.wrap(function(Ce){for(;;)switch(Ce.prev=Ce.next){case 0:!Z[Symbol.asyncIterator]&&Z.pipe&&(Z=Z.pipe(new h)),re=[],ne=!0,ue=!1,Ce.prev=4,ve=d(Z);case 6:return Ce.next=8,ve.next();case 8:return Se=Ce.sent,ne=Se.done,Ce.next=12,Se.value;case 12:if(Oe=Ce.sent,ne){Ce.next=19;break}xe=Oe,re.push(xe);case 16:ne=!0,Ce.next=6;break;case 19:Ce.next=25;break;case 21:Ce.prev=21,Ce.t0=Ce.catch(4),ue=!0,le=Ce.t0;case 25:if(Ce.prev=25,Ce.prev=26,ne||ve.return==null){Ce.next=30;break}return Ce.next=30,ve.return();case 30:if(Ce.prev=30,!ue){Ce.next=33;break}throw le;case 33:return Ce.finish(30);case 34:return Ce.finish(25);case 35:return Ce.abrupt("return",this.load(a.concat(re),Q));case 36:case"end":return Ce.stop()}},G,this,[[4,21,25,35],[26,,30,34]])})),function(G,Z){return ye.apply(this,arguments)})},{key:"load",value:(ee=l(regeneratorRuntime.mark(function G(Z,Q){var re,ne,ue,le,ve,Se,Oe,xe,Ce,Le,Ve,Je,ft,Ct,Ye,et;return regeneratorRuntime.wrap(function(Te){for(;;)switch(Te.prev=Te.next){case 0:return re=Q&&Q.base64?a.from(Z.toString(),"base64"):Z,ne={worksheets:[],worksheetHash:{},worksheetRels:[],themes:{},media:[],mediaIndex:{},drawings:{},drawingRels:{},comments:{},tables:{},vmlDrawings:{}},Te.next=4,y.loadAsync(re);case 4:ue=Te.sent,le=0,ve=Object.values(ue.files);case 6:if(!(le<ve.length)){Te.next=126;break}if((Se=ve[le]).dir){Te.next=123;break}if((Oe=Se.name)[0]==="/"&&(Oe=Oe.substr(1)),xe=void 0,!Oe.match(/xl\/media\//)&&!Oe.match(/xl\/theme\/([a-zA-Z0-9]+)[.]xml/)){Te.next=21;break}return xe=new h,Te.t0=xe,Te.next=17,Se.async("nodebuffer");case 17:Te.t1=Te.sent,Te.t0.write.call(Te.t0,Te.t1),Te.next=36;break;case 21:if(xe=new h({writableObjectMode:!0,readableObjectMode:!0}),Ce=void 0,!o.browser){Te.next=31;break}return Te.t2=m,Te.next=27,Se.async("nodebuffer");case 27:Te.t3=Te.sent,Ce=(0,Te.t2)(Te.t3),Te.next=34;break;case 31:return Te.next=33,Se.async("string");case 33:Ce=Te.sent;case 34:for(Le=0;Le<Ce.length;Le+=16384)xe.write(Ce.substring(Le,Le+16384));case 36:xe.end(),Te.t4=Oe,Te.next=Te.t4==="_rels/.rels"?40:Te.t4==="xl/workbook.xml"?44:Te.t4==="xl/_rels/workbook.xml.rels"?53:Te.t4==="xl/sharedStrings.xml"?57:Te.t4==="xl/styles.xml"?61:Te.t4==="docProps/app.xml"?65:Te.t4==="docProps/core.xml"?72:78;break;case 40:return Te.next=42,this.parseRels(xe);case 42:return ne.globalRels=Te.sent,Te.abrupt("break",123);case 44:return Te.next=46,this.parseWorkbook(xe);case 46:return Ve=Te.sent,ne.sheets=Ve.sheets,ne.definedNames=Ve.definedNames,ne.views=Ve.views,ne.properties=Ve.properties,ne.calcProperties=Ve.calcProperties,Te.abrupt("break",123);case 53:return Te.next=55,this.parseRels(xe);case 55:return ne.workbookRels=Te.sent,Te.abrupt("break",123);case 57:return ne.sharedStrings=new _,Te.next=60,ne.sharedStrings.parseStream(xe);case 60:return Te.abrupt("break",123);case 61:return ne.styles=new b,Te.next=64,ne.styles.parseStream(xe);case 64:return Te.abrupt("break",123);case 65:return Je=new I,Te.next=68,Je.parseStream(xe);case 68:return ft=Te.sent,ne.company=ft.company,ne.manager=ft.manager,Te.abrupt("break",123);case 72:return Ct=new w,Te.next=75,Ct.parseStream(xe);case 75:return Ye=Te.sent,Object.assign(ne,Ye),Te.abrupt("break",123);case 78:if(!(et=Oe.match(/xl\/worksheets\/sheet(\d+)[.]xml/))){Te.next=83;break}return Te.next=82,this._processWorksheetEntry(xe,ne,et[1],Q,Oe);case 82:return Te.abrupt("break",123);case 83:if(!(et=Oe.match(/xl\/worksheets\/_rels\/sheet(\d+)[.]xml.rels/))){Te.next=88;break}return Te.next=87,this._processWorksheetRelsEntry(xe,ne,et[1]);case 87:return Te.abrupt("break",123);case 88:if(!(et=Oe.match(/xl\/theme\/([a-zA-Z0-9]+)[.]xml/))){Te.next=93;break}return Te.next=92,this._processThemeEntry(xe,ne,et[1]);case 92:return Te.abrupt("break",123);case 93:if(!(et=Oe.match(/xl\/media\/([a-zA-Z0-9]+[.][a-zA-Z0-9]{3,4})$/))){Te.next=98;break}return Te.next=97,this._processMediaEntry(xe,ne,et[1]);case 97:return Te.abrupt("break",123);case 98:if(!(et=Oe.match(/xl\/drawings\/([a-zA-Z0-9]+)[.]xml/))){Te.next=103;break}return Te.next=102,this._processDrawingEntry(xe,ne,et[1]);case 102:return Te.abrupt("break",123);case 103:if(!(et=Oe.match(/xl\/(comments\d+)[.]xml/))){Te.next=108;break}return Te.next=107,this._processCommentEntry(xe,ne,et[1]);case 107:return Te.abrupt("break",123);case 108:if(!(et=Oe.match(/xl\/tables\/(table\d+)[.]xml/))){Te.next=113;break}return Te.next=112,this._processTableEntry(xe,ne,et[1]);case 112:return Te.abrupt("break",123);case 113:if(!(et=Oe.match(/xl\/drawings\/_rels\/([a-zA-Z0-9]+)[.]xml[.]rels/))){Te.next=118;break}return Te.next=117,this._processDrawingRelsEntry(xe,ne,et[1]);case 117:return Te.abrupt("break",123);case 118:if(!(et=Oe.match(/xl\/drawings\/(vmlDrawing\d+)[.]vml/))){Te.next=123;break}return Te.next=122,this._processVmlDrawingEntry(xe,ne,et[1]);case 122:return Te.abrupt("break",123);case 123:le++,Te.next=6;break;case 126:return this.reconcile(ne,Q),this.workbook.model=ne,Te.abrupt("return",this.workbook);case 129:case"end":return Te.stop()}},G,this)})),function(G,Z){return ee.apply(this,arguments)})},{key:"addMedia",value:(X=l(regeneratorRuntime.mark(function G(Z,Q){return regeneratorRuntime.wrap(function(re){for(;;)switch(re.prev=re.next){case 0:return re.next=2,Promise.all(Q.media.map(function(){var ne=l(regeneratorRuntime.mark(function ue(le){var ve,Se,Oe,xe;return regeneratorRuntime.wrap(function(Ce){for(;;)switch(Ce.prev=Ce.next){case 0:if(le.type!=="image"){Ce.next=13;break}if(ve="xl/media/".concat(le.name,".").concat(le.extension),!le.filename){Ce.next=7;break}return Ce.next=5,E(le.filename);case 5:return Se=Ce.sent,Ce.abrupt("return",Z.append(Se,{name:ve}));case 7:if(!le.buffer){Ce.next=9;break}return Ce.abrupt("return",Z.append(le.buffer,{name:ve}));case 9:if(!le.base64){Ce.next=13;break}return Oe=le.base64,xe=Oe.substring(Oe.indexOf(",")+1),Ce.abrupt("return",Z.append(xe,{name:ve,base64:!0}));case 13:throw new Error("Unsupported media");case 14:case"end":return Ce.stop()}},ue)}));return function(ue){return ne.apply(this,arguments)}}()));case 2:case"end":return re.stop()}},G)})),function(G,Z){return X.apply(this,arguments)})},{key:"addDrawings",value:function(G,Z){var Q=new A,re=new C;Z.worksheets.forEach(function(ne){var ue=ne.drawing;if(ue){Q.prepare(ue,{});var le=Q.toXml(ue);G.append(le,{name:"xl/drawings/".concat(ue.name,".xml")}),le=re.toXml(ue.rels),G.append(le,{name:"xl/drawings/_rels/".concat(ue.name,".xml.rels")})}})}},{key:"addTables",value:function(G,Z){var Q=new $;Z.worksheets.forEach(function(re){re.tables.forEach(function(ne){Q.prepare(ne,{});var ue=Q.toXml(ne);G.append(ue,{name:"xl/tables/".concat(ne.target)})})})}},{key:"addContentTypes",value:(q=l(regeneratorRuntime.mark(function G(Z,Q){var re,ne;return regeneratorRuntime.wrap(function(ue){for(;;)switch(ue.prev=ue.next){case 0:re=new R,ne=re.toXml(Q),Z.append(ne,{name:"[Content_Types].xml"});case 3:case"end":return ue.stop()}},G)})),function(G,Z){return q.apply(this,arguments)})},{key:"addApp",value:(z=l(regeneratorRuntime.mark(function G(Z,Q){var re,ne;return regeneratorRuntime.wrap(function(ue){for(;;)switch(ue.prev=ue.next){case 0:re=new I,ne=re.toXml(Q),Z.append(ne,{name:"docProps/app.xml"});case 3:case"end":return ue.stop()}},G)})),function(G,Z){return z.apply(this,arguments)})},{key:"addCore",value:(B=l(regeneratorRuntime.mark(function G(Z,Q){var re;return regeneratorRuntime.wrap(function(ne){for(;;)switch(ne.prev=ne.next){case 0:re=new w,Z.append(re.toXml(Q),{name:"docProps/core.xml"});case 2:case"end":return ne.stop()}},G)})),function(G,Z){return B.apply(this,arguments)})},{key:"addThemes",value:(L=l(regeneratorRuntime.mark(function G(Z,Q){var re;return regeneratorRuntime.wrap(function(ne){for(;;)switch(ne.prev=ne.next){case 0:re=Q.themes||{theme1:S},Object.keys(re).forEach(function(ue){var le=re[ue],ve="xl/theme/".concat(ue,".xml");Z.append(le,{name:ve})});case 2:case"end":return ne.stop()}},G)})),function(G,Z){return L.apply(this,arguments)})},{key:"addOfficeRels",value:(D=l(regeneratorRuntime.mark(function G(Z){var Q,re;return regeneratorRuntime.wrap(function(ne){for(;;)switch(ne.prev=ne.next){case 0:Q=new C,re=Q.toXml([{Id:"rId1",Type:O.RelType.OfficeDocument,Target:"xl/workbook.xml"},{Id:"rId2",Type:O.RelType.CoreProperties,Target:"docProps/core.xml"},{Id:"rId3",Type:O.RelType.ExtenderProperties,Target:"docProps/app.xml"}]),Z.append(re,{name:"_rels/.rels"});case 3:case"end":return ne.stop()}},G)})),function(G){return D.apply(this,arguments)})},{key:"addWorkbookRels",value:(K=l(regeneratorRuntime.mark(function G(Z,Q){var re,ne,ue,le;return regeneratorRuntime.wrap(function(ve){for(;;)switch(ve.prev=ve.next){case 0:re=1,ne=[{Id:"rId".concat(re++),Type:O.RelType.Styles,Target:"styles.xml"},{Id:"rId".concat(re++),Type:O.RelType.Theme,Target:"theme/theme1.xml"}],Q.sharedStrings.count&&ne.push({Id:"rId".concat(re++),Type:O.RelType.SharedStrings,Target:"sharedStrings.xml"}),Q.worksheets.forEach(function(Se){Se.rId="rId".concat(re++),ne.push({Id:Se.rId,Type:O.RelType.Worksheet,Target:"worksheets/sheet".concat(Se.id,".xml")})}),ue=new C,le=ue.toXml(ne),Z.append(le,{name:"xl/_rels/workbook.xml.rels"});case 7:case"end":return ve.stop()}},G)})),function(G,Z){return K.apply(this,arguments)})},{key:"addSharedStrings",value:(Y=l(regeneratorRuntime.mark(function G(Z,Q){return regeneratorRuntime.wrap(function(re){for(;;)switch(re.prev=re.next){case 0:Q.sharedStrings&&Q.sharedStrings.count&&Z.append(Q.sharedStrings.xml,{name:"xl/sharedStrings.xml"});case 1:case"end":return re.stop()}},G)})),function(G,Z){return Y.apply(this,arguments)})},{key:"addStyles",value:(U=l(regeneratorRuntime.mark(function G(Z,Q){var re;return regeneratorRuntime.wrap(function(ne){for(;;)switch(ne.prev=ne.next){case 0:(re=Q.styles.xml)&&Z.append(re,{name:"xl/styles.xml"});case 2:case"end":return ne.stop()}},G)})),function(G,Z){return U.apply(this,arguments)})},{key:"addWorkbook",value:(W=l(regeneratorRuntime.mark(function G(Z,Q){var re;return regeneratorRuntime.wrap(function(ne){for(;;)switch(ne.prev=ne.next){case 0:re=new P,Z.append(re.toXml(Q),{name:"xl/workbook.xml"});case 2:case"end":return ne.stop()}},G)})),function(G,Z){return W.apply(this,arguments)})},{key:"addWorksheets",value:(V=l(regeneratorRuntime.mark(function G(Z,Q){var re,ne,ue,le;return regeneratorRuntime.wrap(function(ve){for(;;)switch(ve.prev=ve.next){case 0:re=new N,ne=new C,ue=new T,le=new M,Q.worksheets.forEach(function(Se){var Oe=new v;re.render(Oe,Se),Z.append(Oe.xml,{name:"xl/worksheets/sheet".concat(Se.id,".xml")}),Se.rels&&Se.rels.length&&(Oe=new v,ne.render(Oe,Se.rels),Z.append(Oe.xml,{name:"xl/worksheets/_rels/sheet".concat(Se.id,".xml.rels")})),Se.comments.length>0&&(Oe=new v,ue.render(Oe,Se),Z.append(Oe.xml,{name:"xl/comments".concat(Se.id,".xml")}),Oe=new v,le.render(Oe,Se),Z.append(Oe.xml,{name:"xl/drawings/vmlDrawing".concat(Se.id,".vml")}))});case 5:case"end":return ve.stop()}},G)})),function(G,Z){return V.apply(this,arguments)})},{key:"_finalize",value:function(G){var Z=this;return new Promise(function(Q,re){G.on("finish",function(){Q(Z)}),G.on("error",re),G.finalize()})}},{key:"prepareModel",value:function(G,Z){G.creator=G.creator||"ExcelJS",G.lastModifiedBy=G.lastModifiedBy||"ExcelJS",G.created=G.created||new Date,G.modified=G.modified||new Date,G.useSharedStrings=Z.useSharedStrings===void 0||Z.useSharedStrings,G.useStyles=Z.useStyles===void 0||Z.useStyles,G.sharedStrings=new _,G.styles=G.useStyles?new b(!0):new b.Mock;var Q=new P,re=new N;Q.prepare(G);var ne={sharedStrings:G.sharedStrings,styles:G.styles,date1904:G.properties.date1904,drawingsCount:0,media:G.media};ne.drawings=G.drawings=[],ne.commentRefs=G.commentRefs=[];var ue=0;G.tables=[],G.worksheets.forEach(function(le){le.tables.forEach(function(ve){ue++,ve.target="table".concat(ue,".xml"),ve.id=ue,G.tables.push(ve)}),re.prepare(le,ne)})}},{key:"write",value:(F=l(regeneratorRuntime.mark(function G(Z,Q){var re,ne;return regeneratorRuntime.wrap(function(ue){for(;;)switch(ue.prev=ue.next){case 0:return Q=Q||{},re=this.workbook.model,(ne=new u.ZipWriter(Q.zip)).pipe(Z),this.prepareModel(re,Q),ue.next=7,this.addContentTypes(ne,re);case 7:return ue.next=9,this.addOfficeRels(ne,re);case 9:return ue.next=11,this.addWorkbookRels(ne,re);case 11:return ue.next=13,this.addWorksheets(ne,re);case 13:return ue.next=15,this.addSharedStrings(ne,re);case 15:return ue.next=17,this.addDrawings(ne,re);case 17:return ue.next=19,this.addTables(ne,re);case 19:return ue.next=21,Promise.all([this.addThemes(ne,re),this.addStyles(ne,re)]);case 21:return ue.next=23,this.addMedia(ne,re);case 23:return ue.next=25,Promise.all([this.addApp(ne,re),this.addCore(ne,re)]);case 25:return ue.next=27,this.addWorkbook(ne,re);case 27:return ue.abrupt("return",this._finalize(ne));case 28:case"end":return ue.stop()}},G,this)})),function(G,Z){return F.apply(this,arguments)})},{key:"writeFile",value:function(G,Z){var Q=this,re=g.createWriteStream(G);return new Promise(function(ne,ue){re.on("finish",function(){ne()}),re.on("error",function(le){ue(le)}),Q.write(re,Z).then(function(){re.end()})})}},{key:"writeBuffer",value:(H=l(regeneratorRuntime.mark(function G(Z){var Q;return regeneratorRuntime.wrap(function(re){for(;;)switch(re.prev=re.next){case 0:return Q=new f,re.next=3,this.write(Q,Z);case 3:return re.abrupt("return",Q.read());case 4:case"end":return re.stop()}},G,this)})),function(G){return H.apply(this,arguments)})}])&&p(x.prototype,j),O}();k.RelType=e("./rel-type"),n.exports=k}).call(this,e("_process"),e("buffer").Buffer)},{"../utils/browser-buffer-decode":16,"../utils/stream-buf":23,"../utils/utils":26,"../utils/xml-stream":27,"../utils/zip-stream":28,"./rel-type":30,"./xform/book/workbook-xform":37,"./xform/comment/comments-xform":39,"./xform/comment/vml-notes-xform":44,"./xform/core/app-xform":50,"./xform/core/content-types-xform":51,"./xform/core/core-xform":52,"./xform/core/relationships-xform":54,"./xform/drawing/drawing-xform":61,"./xform/sheet/worksheet-xform":114,"./xform/strings/shared-strings-xform":123,"./xform/style/styles-xform":134,"./xform/table/table-xform":140,"./xml/theme1.js":142,_process:467,buffer:216,fs:215,jszip:399,"readable-stream":491}],142:[function(e,n,i){n.exports=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme"> <a:themeElements> <a:clrScheme name="Office"> <a:dk1> <a:sysClr val="windowText" lastClr="000000"/> </a:dk1> <a:lt1> <a:sysClr val="window" lastClr="FFFFFF"/> </a:lt1> <a:dk2> <a:srgbClr val="1F497D"/> </a:dk2> <a:lt2> <a:srgbClr val="EEECE1"/> </a:lt2> <a:accent1> <a:srgbClr val="4F81BD"/> </a:accent1> <a:accent2> <a:srgbClr val="C0504D"/> </a:accent2> <a:accent3> <a:srgbClr val="9BBB59"/> </a:accent3> <a:accent4> <a:srgbClr val="8064A2"/> </a:accent4> <a:accent5> <a:srgbClr val="4BACC6"/> </a:accent5> <a:accent6> <a:srgbClr val="F79646"/> </a:accent6> <a:hlink> <a:srgbClr val="0000FF"/> </a:hlink> <a:folHlink> <a:srgbClr val="800080"/> </a:folHlink> </a:clrScheme> <a:fontScheme name="Office"> <a:majorFont> <a:latin typeface="Cambria"/> <a:ea typeface=""/> <a:cs typeface=""/> <a:font script="Jpan" typeface="\uFF2D\uFF33 \uFF30\u30B4\u30B7\u30C3\u30AF"/> <a:font script="Hang" typeface="\uB9D1\uC740 \uACE0\uB515"/> <a:font script="Hans" typeface="\u5B8B\u4F53"/> <a:font script="Hant" typeface="\u65B0\u7D30\u660E\u9AD4"/> <a:font script="Arab" typeface="Times New Roman"/> <a:font script="Hebr" typeface="Times New Roman"/> <a:font script="Thai" typeface="Tahoma"/> <a:font script="Ethi" typeface="Nyala"/> <a:font script="Beng" typeface="Vrinda"/> <a:font script="Gujr" typeface="Shruti"/> <a:font script="Khmr" typeface="MoolBoran"/> <a:font script="Knda" typeface="Tunga"/> <a:font script="Guru" typeface="Raavi"/> <a:font script="Cans" typeface="Euphemia"/> <a:font script="Cher" typeface="Plantagenet Cherokee"/> <a:font script="Yiii" typeface="Microsoft Yi Baiti"/> <a:font script="Tibt" typeface="Microsoft Himalaya"/> <a:font script="Thaa" typeface="MV Boli"/> <a:font script="Deva" typeface="Mangal"/> <a:font script="Telu" typeface="Gautami"/> <a:font script="Taml" typeface="Latha"/> <a:font script="Syrc" typeface="Estrangelo Edessa"/> <a:font script="Orya" typeface="Kalinga"/> <a:font script="Mlym" typeface="Kartika"/> <a:font script="Laoo" typeface="DokChampa"/> <a:font script="Sinh" typeface="Iskoola Pota"/> <a:font script="Mong" typeface="Mongolian Baiti"/> <a:font script="Viet" typeface="Times New Roman"/> <a:font script="Uigh" typeface="Microsoft Uighur"/> <a:font script="Geor" typeface="Sylfaen"/> </a:majorFont> <a:minorFont> <a:latin typeface="Calibri"/> <a:ea typeface=""/> <a:cs typeface=""/> <a:font script="Jpan" typeface="\uFF2D\uFF33 \uFF30\u30B4\u30B7\u30C3\u30AF"/> <a:font script="Hang" typeface="\uB9D1\uC740 \uACE0\uB515"/> <a:font script="Hans" typeface="\u5B8B\u4F53"/> <a:font script="Hant" typeface="\u65B0\u7D30\u660E\u9AD4"/> <a:font script="Arab" typeface="Arial"/> <a:font script="Hebr" typeface="Arial"/> <a:font script="Thai" typeface="Tahoma"/> <a:font script="Ethi" typeface="Nyala"/> <a:font script="Beng" typeface="Vrinda"/> <a:font script="Gujr" typeface="Shruti"/> <a:font script="Khmr" typeface="DaunPenh"/> <a:font script="Knda" typeface="Tunga"/> <a:font script="Guru" typeface="Raavi"/> <a:font script="Cans" typeface="Euphemia"/> <a:font script="Cher" typeface="Plantagenet Cherokee"/> <a:font script="Yiii" typeface="Microsoft Yi Baiti"/> <a:font script="Tibt" typeface="Microsoft Himalaya"/> <a:font script="Thaa" typeface="MV Boli"/> <a:font script="Deva" typeface="Mangal"/> <a:font script="Telu" typeface="Gautami"/> <a:font script="Taml" typeface="Latha"/> <a:font script="Syrc" typeface="Estrangelo Edessa"/> <a:font script="Orya" typeface="Kalinga"/> <a:font script="Mlym" typeface="Kartika"/> <a:font script="Laoo" typeface="DokChampa"/> <a:font script="Sinh" typeface="Iskoola Pota"/> <a:font script="Mong" typeface="Mongolian Baiti"/> <a:font script="Viet" typeface="Arial"/> <a:font script="Uigh" typeface="Microsoft Uighur"/> <a:font script="Geor" typeface="Sylfaen"/> </a:minorFont> </a:fontScheme> <a:fmtScheme name="Office"> <a:fillStyleLst> <a:solidFill> <a:schemeClr val="phClr"/> </a:solidFill> <a:gradFill rotWithShape="1"> <a:gsLst> <a:gs pos="0"> <a:schemeClr val="phClr"> <a:tint val="50000"/> <a:satMod val="300000"/> </a:schemeClr> </a:gs> <a:gs pos="35000"> <a:schemeClr val="phClr"> <a:tint val="37000"/> <a:satMod val="300000"/> </a:schemeClr> </a:gs> <a:gs pos="100000"> <a:schemeClr val="phClr"> <a:tint val="15000"/> <a:satMod val="350000"/> </a:schemeClr> </a:gs> </a:gsLst> <a:lin ang="16200000" scaled="1"/> </a:gradFill> <a:gradFill rotWithShape="1"> <a:gsLst> <a:gs pos="0"> <a:schemeClr val="phClr"> <a:tint val="100000"/> <a:shade val="100000"/> <a:satMod val="130000"/> </a:schemeClr> </a:gs> <a:gs pos="100000"> <a:schemeClr val="phClr"> <a:tint val="50000"/> <a:shade val="100000"/> <a:satMod val="350000"/> </a:schemeClr> </a:gs> </a:gsLst> <a:lin ang="16200000" scaled="0"/> </a:gradFill> </a:fillStyleLst> <a:lnStyleLst> <a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"> <a:solidFill> <a:schemeClr val="phClr"> <a:shade val="95000"/> <a:satMod val="105000"/> </a:schemeClr> </a:solidFill> <a:prstDash val="solid"/> </a:ln> <a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"> <a:solidFill> <a:schemeClr val="phClr"/> </a:solidFill> <a:prstDash val="solid"/> </a:ln> <a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"> <a:solidFill> <a:schemeClr val="phClr"/> </a:solidFill> <a:prstDash val="solid"/> </a:ln> </a:lnStyleLst> <a:effectStyleLst> <a:effectStyle> <a:effectLst> <a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"> <a:srgbClr val="000000"> <a:alpha val="38000"/> </a:srgbClr> </a:outerShdw> </a:effectLst> </a:effectStyle> <a:effectStyle> <a:effectLst> <a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"> <a:srgbClr val="000000"> <a:alpha val="35000"/> </a:srgbClr> </a:outerShdw> </a:effectLst> </a:effectStyle> <a:effectStyle> <a:effectLst> <a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"> <a:srgbClr val="000000"> <a:alpha val="35000"/> </a:srgbClr> </a:outerShdw> </a:effectLst> <a:scene3d> <a:camera prst="orthographicFront"> <a:rot lat="0" lon="0" rev="0"/> </a:camera> <a:lightRig rig="threePt" dir="t"> <a:rot lat="0" lon="0" rev="1200000"/> </a:lightRig> </a:scene3d> <a:sp3d> <a:bevelT w="63500" h="25400"/> </a:sp3d> </a:effectStyle> </a:effectStyleLst> <a:bgFillStyleLst> <a:solidFill> <a:schemeClr val="phClr"/> </a:solidFill> <a:gradFill rotWithShape="1"> <a:gsLst> <a:gs pos="0"> <a:schemeClr val="phClr"> <a:tint val="40000"/> <a:satMod val="350000"/> </a:schemeClr> </a:gs> <a:gs pos="40000"> <a:schemeClr val="phClr"> <a:tint val="45000"/> <a:shade val="99000"/> <a:satMod val="350000"/> </a:schemeClr> </a:gs> <a:gs pos="100000"> <a:schemeClr val="phClr"> <a:shade val="20000"/> <a:satMod val="255000"/> </a:schemeClr> </a:gs> </a:gsLst> <a:path path="circle"> <a:fillToRect l="50000" t="-80000" r="50000" b="180000"/> </a:path> </a:gradFill> <a:gradFill rotWithShape="1"> <a:gsLst> <a:gs pos="0"> <a:schemeClr val="phClr"> <a:tint val="80000"/> <a:satMod val="300000"/> </a:schemeClr> </a:gs> <a:gs pos="100000"> <a:schemeClr val="phClr"> <a:shade val="30000"/> <a:satMod val="200000"/> </a:schemeClr> </a:gs> </a:gsLst> <a:path path="circle"> <a:fillToRect l="50000" t="50000" r="50000" b="50000"/> </a:path> </a:gradFill> </a:bgFillStyleLst> </a:fmtScheme> </a:themeElements> <a:objectDefaults> <a:spDef> <a:spPr/> <a:bodyPr/> <a:lstStyle/> <a:style> <a:lnRef idx="1"> <a:schemeClr val="accent1"/> </a:lnRef> <a:fillRef idx="3"> <a:schemeClr val="accent1"/> </a:fillRef> <a:effectRef idx="2"> <a:schemeClr val="accent1"/> </a:effectRef> <a:fontRef idx="minor"> <a:schemeClr val="lt1"/> </a:fontRef> </a:style> </a:spDef> <a:lnDef> <a:spPr/> <a:bodyPr/> <a:lstStyle/> <a:style> <a:lnRef idx="2"> <a:schemeClr val="accent1"/> </a:lnRef> <a:fillRef idx="0"> <a:schemeClr val="accent1"/> </a:fillRef> <a:effectRef idx="1"> <a:schemeClr val="accent1"/> </a:effectRef> <a:fontRef idx="minor"> <a:schemeClr val="tx1"/> </a:fontRef> </a:style> </a:lnDef> </a:objectDefaults> <a:extraClrSchemeLst/> </a:theme>`},{}],143:[function(e,n,i){(function(o){function a(f){return(a=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(c){return typeof c}:function(c){return c&&typeof Symbol=="function"&&c.constructor===Symbol&&c!==Symbol.prototype?"symbol":typeof c})(f)}function s(f,c){for(var v=0;v<c.length;v++){var m=c[v];m.enumerable=m.enumerable||!1,m.configurable=!0,"value"in m&&(m.writable=!0),Object.defineProperty(f,m.key,m)}}function l(f,c){return(l=Object.setPrototypeOf||function(v,m){return v.__proto__=m,v})(f,c)}function p(f){var c=function(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch{return!1}}();return function(){var v,m=g(f);if(c){var b=g(this).constructor;v=Reflect.construct(m,arguments,b)}else v=m.apply(this,arguments);return d(this,v)}}function d(f,c){return!c||a(c)!=="object"&&typeof c!="function"?function(v){if(v===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return v}(f):c}function g(f){return(g=Object.setPrototypeOf?Object.getPrototypeOf:function(c){return c.__proto__||Object.getPrototypeOf(c)})(f)}Object.defineProperty(i,"__esModule",{value:!0}),i.CsvFormatterStream=void 0;var y=e("stream"),h=e("./formatter"),u=function(f){(function(w,_){if(typeof _!="function"&&_!==null)throw new TypeError("Super expression must either be null or a function");w.prototype=Object.create(_&&_.prototype,{constructor:{value:w,writable:!0,configurable:!0}}),_&&l(w,_)})(b,f);var c,v,m=p(b);function b(w){var _;return function(C,R){if(!(C instanceof R))throw new TypeError("Cannot call a class as a function")}(this,b),(_=m.call(this,{writableObjectMode:w.objectMode})).hasWrittenBOM=!1,_.formatterOptions=w,_.rowFormatter=new h.RowFormatter(w),_.hasWrittenBOM=!w.writeBOM,_}return c=b,(v=[{key:"transform",value:function(w){return this.rowFormatter.rowTransform=w,this}},{key:"_transform",value:function(w,_,C){var R=this,I=!1;try{this.hasWrittenBOM||(this.push(this.formatterOptions.BOM),this.hasWrittenBOM=!0),this.rowFormatter.format(w,function(P,N){return P?(I=!0,C(P)):(N&&N.forEach(function(A){R.push(o.from(A,"utf8"))}),I=!0,C())})}catch(P){if(I)throw P;C(P)}}},{key:"_flush",value:function(w){var _=this;this.rowFormatter.finish(function(C,R){return C?w(C):(R&&R.forEach(function(I){_.push(o.from(I,"utf8"))}),w())})}}])&&s(c.prototype,v),b}(y.Transform);i.CsvFormatterStream=u}).call(this,e("buffer").Buffer)},{"./formatter":147,buffer:216,stream:506}],144:[function(e,n,i){function o(a,s){if(!(a instanceof s))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(i,"__esModule",{value:!0}),i.FormatterOptions=void 0,i.FormatterOptions=function a(){var s,l=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};o(this,a),this.objectMode=!0,this.delimiter=",",this.rowDelimiter=`
`,this.quote='"',this.escape=this.quote,this.quoteColumns=!1,this.quoteHeaders=this.quoteColumns,this.headers=null,this.includeEndRowDelimiter=!1,this.writeBOM=!1,this.BOM="\uFEFF",this.alwaysWriteHeaders=!1,Object.assign(this,l||{}),(l==null?void 0:l.quoteHeaders)===void 0&&(this.quoteHeaders=this.quoteColumns),(l==null?void 0:l.quote)===!0?this.quote='"':(l==null?void 0:l.quote)===!1&&(this.quote=""),typeof(l==null?void 0:l.escape)!="string"&&(this.escape=this.quote),this.shouldWriteHeaders=!!this.headers&&((s=l.writeHeaders)===null||s===void 0||s),this.headers=Array.isArray(this.headers)?this.headers:null,this.escapedQuote="".concat(this.escape).concat(this.quote)}},{}],145:[function(e,n,i){function o(g,y){for(var h=0;h<y.length;h++){var u=y[h];u.enumerable=u.enumerable||!1,u.configurable=!0,"value"in u&&(u.writable=!0),Object.defineProperty(g,u.key,u)}}var a=function(g){return g&&g.__esModule?g:{default:g}};Object.defineProperty(i,"__esModule",{value:!0}),i.FieldFormatter=void 0;var s=a(e("lodash.isboolean")),l=a(e("lodash.isnil")),p=a(e("lodash.escaperegexp")),d=function(){function g(u){(function(c,v){if(!(c instanceof v))throw new TypeError("Cannot call a class as a function")})(this,g),this._headers=null,this.formatterOptions=u,u.headers!==null&&(this.headers=u.headers),this.REPLACE_REGEXP=new RegExp(u.quote,"g");var f="[".concat(u.delimiter).concat(p.default(u.rowDelimiter),`|\r|
']`);this.ESCAPE_REGEXP=new RegExp(f)}var y,h;return y=g,(h=[{key:"shouldQuote",value:function(u,f){var c=f?this.formatterOptions.quoteHeaders:this.formatterOptions.quoteColumns;return s.default(c)?c:Array.isArray(c)?c[u]:this._headers!==null&&c[this._headers[u]]}},{key:"format",value:function(u,f,c){var v="".concat(l.default(u)?"":u).replace(/\0/g,""),m=this.formatterOptions;return m.quote!==""&&v.indexOf(m.quote)!==-1?this.quoteField(v.replace(this.REPLACE_REGEXP,m.escapedQuote)):v.search(this.ESCAPE_REGEXP)!==-1||this.shouldQuote(f,c)?this.quoteField(v):v}},{key:"quoteField",value:function(u){var f=this.formatterOptions.quote;return"".concat(f).concat(u).concat(f)}},{key:"headers",set:function(u){this._headers=u}}])&&o(y.prototype,h),g}();i.FieldFormatter=d},{"lodash.escaperegexp":426,"lodash.isboolean":428,"lodash.isnil":431}],146:[function(e,n,i){function o(y,h){for(var u=0;u<h.length;u++){var f=h[u];f.enumerable=f.enumerable||!1,f.configurable=!0,"value"in f&&(f.writable=!0),Object.defineProperty(y,f.key,f)}}var a=function(y){return y&&y.__esModule?y:{default:y}};Object.defineProperty(i,"__esModule",{value:!0}),i.RowFormatter=void 0;var s=a(e("lodash.isfunction")),l=a(e("lodash.isequal")),p=e("./FieldFormatter"),d=e("../types"),g=function(){function y(c){(function(v,m){if(!(v instanceof m))throw new TypeError("Cannot call a class as a function")})(this,y),this.rowCount=0,this.formatterOptions=c,this.fieldFormatter=new p.FieldFormatter(c),this.headers=c.headers,this.shouldWriteHeaders=c.shouldWriteHeaders,this.hasWrittenHeaders=!1,this.headers!==null&&(this.fieldFormatter.headers=this.headers),c.transform&&(this.rowTransform=c.transform)}var h,u,f;return h=y,f=[{key:"isHashArray",value:function(c){return!!Array.isArray(c)&&Array.isArray(c[0])&&c[0].length===2}},{key:"gatherHeaders",value:function(c){return y.isHashArray(c)?c.map(function(v){return v[0]}):Array.isArray(c)?c:Object.keys(c)}},{key:"createTransform",value:function(c){return d.isSyncTransform(c)?function(v,m){var b=null;try{b=c(v)}catch(w){return m(w)}return m(null,b)}:function(v,m){c(v,m)}}}],(u=[{key:"format",value:function(c,v){var m=this;this.callTransformer(c,function(b,w){if(b)return v(b);if(!c)return v(null);var _=[];if(w){var C=m.checkHeaders(w),R=C.shouldFormatColumns,I=C.headers;if(m.shouldWriteHeaders&&I&&!m.hasWrittenHeaders&&(_.push(m.formatColumns(I,!0)),m.hasWrittenHeaders=!0),R){var P=m.gatherColumns(w);_.push(m.formatColumns(P,!1))}}return v(null,_)})}},{key:"finish",value:function(c){var v=[];if(this.formatterOptions.alwaysWriteHeaders&&this.rowCount===0){if(!this.headers)return c(new Error("`alwaysWriteHeaders` option is set to true but `headers` option not provided."));v.push(this.formatColumns(this.headers,!0))}return this.formatterOptions.includeEndRowDelimiter&&v.push(this.formatterOptions.rowDelimiter),c(null,v)}},{key:"checkHeaders",value:function(c){if(this.headers)return{shouldFormatColumns:!0,headers:this.headers};var v=y.gatherHeaders(c);return this.headers=v,this.fieldFormatter.headers=v,this.shouldWriteHeaders?{shouldFormatColumns:!l.default(v,c),headers:v}:{shouldFormatColumns:!0,headers:null}}},{key:"gatherColumns",value:function(c){if(this.headers===null)throw new Error("Headers is currently null");return Array.isArray(c)?y.isHashArray(c)?this.headers.map(function(v,m){var b=c[m];return b?b[1]:""}):this.headers.map(function(v,m){return c[m]}):this.headers.map(function(v){return c[v]})}},{key:"callTransformer",value:function(c,v){return this._rowTransform?this._rowTransform(c,v):v(null,c)}},{key:"formatColumns",value:function(c,v){var m=this,b=c.map(function(_,C){return m.fieldFormatter.format(_,C,v)}).join(this.formatterOptions.delimiter),w=this.rowCount;return this.rowCount+=1,w?[this.formatterOptions.rowDelimiter,b].join(""):b}},{key:"rowTransform",set:function(c){if(!s.default(c))throw new TypeError("The transform should be a function");this._rowTransform=y.createTransform(c)}}])&&o(h.prototype,u),f&&o(h,f),y}();i.RowFormatter=g},{"../types":149,"./FieldFormatter":145,"lodash.isequal":429,"lodash.isfunction":430}],147:[function(e,n,i){Object.defineProperty(i,"__esModule",{value:!0});var o=e("./RowFormatter");Object.defineProperty(i,"RowFormatter",{enumerable:!0,get:function(){return o.RowFormatter}});var a=e("./FieldFormatter");Object.defineProperty(i,"FieldFormatter",{enumerable:!0,get:function(){return a.FieldFormatter}})},{"./FieldFormatter":145,"./RowFormatter":146}],148:[function(e,n,i){(function(o){var a=Object.create?function(v,m,b,w){w===void 0&&(w=b),Object.defineProperty(v,w,{enumerable:!0,get:function(){return m[b]}})}:function(v,m,b,w){w===void 0&&(w=b),v[w]=m[b]},s=Object.create?function(v,m){Object.defineProperty(v,"default",{enumerable:!0,value:m})}:function(v,m){v.default=m},l=function(v){if(v&&v.__esModule)return v;var m={};if(v!=null)for(var b in v)b!=="default"&&Object.hasOwnProperty.call(v,b)&&a(m,v,b);return s(m,v),m},p=function(v,m){for(var b in v)b==="default"||m.hasOwnProperty(b)||a(m,v,b)};Object.defineProperty(i,"__esModule",{value:!0}),i.writeToPath=i.writeToString=i.writeToBuffer=i.writeToStream=i.write=i.format=void 0;var d=e("util"),g=e("stream"),y=l(e("fs")),h=e("./FormatterOptions"),u=e("./CsvFormatterStream");p(e("./types"),i);var f=e("./CsvFormatterStream");Object.defineProperty(i,"CsvFormatterStream",{enumerable:!0,get:function(){return f.CsvFormatterStream}});var c=e("./FormatterOptions");Object.defineProperty(i,"FormatterOptions",{enumerable:!0,get:function(){return c.FormatterOptions}}),i.format=function(v){return new u.CsvFormatterStream(new h.FormatterOptions(v))},i.write=function(v,m){var b=i.format(m),w=d.promisify(function(_,C){b.write(_,void 0,C)});return v.reduce(function(_,C){return _.then(function(){return w(C)})},Promise.resolve()).then(function(){return b.end()}).catch(function(_){b.emit("error",_)}),b},i.writeToStream=function(v,m,b){return i.write(m,b).pipe(v)},i.writeToBuffer=function(v){var m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},b=[],w=new g.Writable({write:function(_,C,R){b.push(_),R()}});return new Promise(function(_,C){w.on("error",C).on("finish",function(){return _(o.concat(b))}),i.write(v,m).pipe(w)})},i.writeToString=function(v,m){return i.writeToBuffer(v,m).then(function(b){return b.toString()})},i.writeToPath=function(v,m,b){var w=y.createWriteStream(v,{encoding:"utf8"});return i.write(m,b).pipe(w)}}).call(this,e("buffer").Buffer)},{"./CsvFormatterStream":143,"./FormatterOptions":144,"./types":149,buffer:216,fs:215,stream:506,util:525}],149:[function(e,n,i){Object.defineProperty(i,"__esModule",{value:!0}),i.isSyncTransform=void 0,i.isSyncTransform=function(o){return o.length===1}},{}],150:[function(e,n,i){(function(o){function a(m){return(a=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(b){return typeof b}:function(b){return b&&typeof Symbol=="function"&&b.constructor===Symbol&&b!==Symbol.prototype?"symbol":typeof b})(m)}function s(m,b){for(var w=0;w<b.length;w++){var _=b[w];_.enumerable=_.enumerable||!1,_.configurable=!0,"value"in _&&(_.writable=!0),Object.defineProperty(m,_.key,_)}}function l(m,b,w){return(l=typeof Reflect!="undefined"&&Reflect.get?Reflect.get:function(_,C,R){var I=function(N,A){for(;!Object.prototype.hasOwnProperty.call(N,A)&&(N=y(N))!==null;);return N}(_,C);if(I){var P=Object.getOwnPropertyDescriptor(I,C);return P.get?P.get.call(R):P.value}})(m,b,w||m)}function p(m,b){return(p=Object.setPrototypeOf||function(w,_){return w.__proto__=_,w})(m,b)}function d(m){var b=function(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch{return!1}}();return function(){var w,_=y(m);if(b){var C=y(this).constructor;w=Reflect.construct(_,arguments,C)}else w=_.apply(this,arguments);return g(this,w)}}function g(m,b){return!b||a(b)!=="object"&&typeof b!="function"?function(w){if(w===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return w}(m):b}function y(m){return(y=Object.setPrototypeOf?Object.getPrototypeOf:function(b){return b.__proto__||Object.getPrototypeOf(b)})(m)}Object.defineProperty(i,"__esModule",{value:!0}),i.CsvParserStream=void 0;var h=e("string_decoder"),u=e("stream"),f=e("./transforms"),c=e("./parser"),v=function(m){(function(R,I){if(typeof I!="function"&&I!==null)throw new TypeError("Super expression must either be null or a function");R.prototype=Object.create(I&&I.prototype,{constructor:{value:R,writable:!0,configurable:!0}}),I&&p(R,I)})(C,m);var b,w,_=d(C);function C(R){var I;return function(P,N){if(!(P instanceof N))throw new TypeError("Cannot call a class as a function")}(this,C),(I=_.call(this,{objectMode:R.objectMode})).lines="",I.rowCount=0,I.parsedRowCount=0,I.parsedLineCount=0,I.endEmitted=!1,I.headersEmitted=!1,I.parserOptions=R,I.parser=new c.Parser(R),I.headerTransformer=new f.HeaderTransformer(R),I.decoder=new h.StringDecoder(R.encoding),I.rowTransformerValidator=new f.RowTransformerValidator,I}return b=C,(w=[{key:"transform",value:function(R){return this.rowTransformerValidator.rowTransform=R,this}},{key:"validate",value:function(R){return this.rowTransformerValidator.rowValidator=R,this}},{key:"emit",value:function(R){var I;if(R==="end")return this.endEmitted||(this.endEmitted=!0,l(y(C.prototype),"emit",this).call(this,"end",this.rowCount)),!1;for(var P=arguments.length,N=new Array(P>1?P-1:0),A=1;A<P;A++)N[A-1]=arguments[A];return(I=l(y(C.prototype),"emit",this)).call.apply(I,[this,R].concat(N))}},{key:"_transform",value:function(R,I,P){if(this.hasHitRowLimit)return P();try{var N=this.lines+this.decoder.write(R),A=this.parse(N,!0);return this.processRows(A,P)}catch($){return P($)}}},{key:"_flush",value:function(R){if(this.hasHitRowLimit)return R();try{var I=this.lines+this.decoder.end(),P=this.parse(I,!1);return this.processRows(P,R)}catch(N){return R(N)}}},{key:"parse",value:function(R,I){if(!R)return[];var P=this.parser.parse(R,I),N=P.line,A=P.rows;return this.lines=N,A}},{key:"processRows",value:function(R,I){var P=this,N=R.length;(function A($){var T=function(E){return E?I(E):$%100!=0?A($+1):void o(function(){return A($+1)})};if(P.checkAndEmitHeaders(),$>=N||P.hasHitRowLimit)return I();if(P.parsedLineCount+=1,P.shouldSkipLine)return T();var M=R[$];P.rowCount+=1,P.parsedRowCount+=1;var S=P.rowCount;return P.transformRow(M,function(E,k){if(E)return P.rowCount-=1,T(E);if(!k)return T(new Error("expected transform result"));if(k.isValid){if(k.row)return P.pushRow(k.row,T)}else P.emit("data-invalid",k.row,S,k.reason);return T()})})(0)}},{key:"transformRow",value:function(R,I){var P=this;try{this.headerTransformer.transform(R,function(N,A){return N?I(N):A?A.isValid?A.row?P.shouldEmitRows?P.rowTransformerValidator.transformAndValidate(A.row,I):P.skipRow(I):(P.rowCount-=1,P.parsedRowCount-=1,I(null,{row:null,isValid:!0})):P.shouldEmitRows?I(null,{isValid:!1,row:R}):P.skipRow(I):I(new Error("Expected result from header transform"))})}catch(N){I(N)}}},{key:"checkAndEmitHeaders",value:function(){!this.headersEmitted&&this.headerTransformer.headers&&(this.headersEmitted=!0,this.emit("headers",this.headerTransformer.headers))}},{key:"skipRow",value:function(R){return this.rowCount-=1,R(null,{row:null,isValid:!0})}},{key:"pushRow",value:function(R,I){try{this.parserOptions.objectMode?this.push(R):this.push(JSON.stringify(R)),I()}catch(P){I(P)}}},{key:"hasHitRowLimit",get:function(){return this.parserOptions.limitRows&&this.rowCount>=this.parserOptions.maxRows}},{key:"shouldEmitRows",get:function(){return this.parsedRowCount>this.parserOptions.skipRows}},{key:"shouldSkipLine",get:function(){return this.parsedLineCount<=this.parserOptions.skipLines}}])&&s(b.prototype,w),C}(u.Transform);i.CsvParserStream=v}).call(this,e("timers").setImmediate)},{"./parser":162,"./transforms":165,stream:506,string_decoder:520,timers:521}],151:[function(e,n,i){var o=function(l){return l&&l.__esModule?l:{default:l}};Object.defineProperty(i,"__esModule",{value:!0}),i.ParserOptions=void 0;var a=o(e("lodash.escaperegexp")),s=o(e("lodash.isnil"));i.ParserOptions=function l(p){var d;if(function(g,y){if(!(g instanceof y))throw new TypeError("Cannot call a class as a function")}(this,l),this.objectMode=!0,this.delimiter=",",this.ignoreEmpty=!1,this.quote='"',this.escape=null,this.escapeChar=this.quote,this.comment=null,this.supportsComments=!1,this.ltrim=!1,this.rtrim=!1,this.trim=!1,this.headers=null,this.renameHeaders=!1,this.strictColumnHandling=!1,this.discardUnmappedColumns=!1,this.carriageReturn="\r",this.encoding="utf8",this.limitRows=!1,this.maxRows=0,this.skipLines=0,this.skipRows=0,Object.assign(this,p||{}),this.delimiter.length>1)throw new Error("delimiter option must be one character long");this.escapedDelimiter=a.default(this.delimiter),this.escapeChar=(d=this.escape)!==null&&d!==void 0?d:this.quote,this.supportsComments=!s.default(this.comment),this.NEXT_TOKEN_REGEXP=new RegExp("([^\\s]|\\r\\n|\\n|\\r|".concat(this.escapedDelimiter,")")),this.maxRows>0&&(this.limitRows=!0)}},{"lodash.escaperegexp":426,"lodash.isnil":431}],152:[function(e,n,i){var o=Object.create?function(f,c,v,m){m===void 0&&(m=v),Object.defineProperty(f,m,{enumerable:!0,get:function(){return c[v]}})}:function(f,c,v,m){m===void 0&&(m=v),f[m]=c[v]},a=Object.create?function(f,c){Object.defineProperty(f,"default",{enumerable:!0,value:c})}:function(f,c){f.default=c},s=function(f){if(f&&f.__esModule)return f;var c={};if(f!=null)for(var v in f)v!=="default"&&Object.hasOwnProperty.call(f,v)&&o(c,f,v);return a(c,f),c},l=function(f,c){for(var v in f)v==="default"||c.hasOwnProperty(v)||o(c,f,v)};Object.defineProperty(i,"__esModule",{value:!0}),i.parseString=i.parseFile=i.parseStream=i.parse=void 0;var p=s(e("fs")),d=e("stream"),g=e("./ParserOptions"),y=e("./CsvParserStream");l(e("./types"),i);var h=e("./CsvParserStream");Object.defineProperty(i,"CsvParserStream",{enumerable:!0,get:function(){return h.CsvParserStream}});var u=e("./ParserOptions");Object.defineProperty(i,"ParserOptions",{enumerable:!0,get:function(){return u.ParserOptions}}),i.parse=function(f){return new y.CsvParserStream(new g.ParserOptions(f))},i.parseStream=function(f,c){return f.pipe(new y.CsvParserStream(new g.ParserOptions(c)))},i.parseFile=function(f){var c=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return p.createReadStream(f).pipe(new y.CsvParserStream(new g.ParserOptions(c)))},i.parseString=function(f,c){var v=new d.Readable;return v.push(f),v.push(null),v.pipe(new y.CsvParserStream(new g.ParserOptions(c)))}},{"./CsvParserStream":150,"./ParserOptions":151,"./types":166,fs:215,stream:506}],153:[function(e,n,i){function o(g,y){for(var h=0;h<y.length;h++){var u=y[h];u.enumerable=u.enumerable||!1,u.configurable=!0,"value"in u&&(u.writable=!0),Object.defineProperty(g,u.key,u)}}Object.defineProperty(i,"__esModule",{value:!0}),i.Parser=void 0;var a=e("./Scanner"),s=e("./RowParser"),l=e("./Token"),p=/^\s*(?:''|"")?\s*(?:,\s*(?:''|"")?\s*)*$/,d=function(){function g(f){(function(c,v){if(!(c instanceof v))throw new TypeError("Cannot call a class as a function")})(this,g),this.parserOptions=f,this.rowParser=new s.RowParser(this.parserOptions)}var y,h,u;return y=g,u=[{key:"removeBOM",value:function(f){return f&&f.charCodeAt(0)===65279?f.slice(1):f}}],(h=[{key:"parse",value:function(f,c){var v=new a.Scanner({line:g.removeBOM(f),parserOptions:this.parserOptions,hasMoreData:c});return this.parserOptions.supportsComments?this.parseWithComments(v):this.parseWithoutComments(v)}},{key:"parseWithoutComments",value:function(f){for(var c=[],v=!0;v;)v=this.parseRow(f,c);return{line:f.line,rows:c}}},{key:"parseWithComments",value:function(f){for(var c=this.parserOptions,v=[],m=f.nextCharacterToken;m!==null;m=f.nextCharacterToken)if(l.Token.isTokenComment(m,c)){if(f.advancePastLine()===null)return{line:f.lineFromCursor,rows:v};if(!f.hasMoreCharacters)return{line:f.lineFromCursor,rows:v};f.truncateToCursor()}else if(!this.parseRow(f,v))break;return{line:f.line,rows:v}}},{key:"parseRow",value:function(f,c){if(!f.nextNonSpaceToken)return!1;var v=this.rowParser.parse(f);return v!==null&&(this.parserOptions.ignoreEmpty&&p.test(v.join(""))||c.push(v),!0)}}])&&o(y.prototype,h),u&&o(y,u),g}();i.Parser=d},{"./RowParser":154,"./Scanner":155,"./Token":156}],154:[function(e,n,i){function o(y,h){for(var u=0;u<h.length;u++){var f=h[u];f.enumerable=f.enumerable||!1,f.configurable=!0,"value"in f&&(f.writable=!0),Object.defineProperty(y,f.key,f)}}Object.defineProperty(i,"__esModule",{value:!0}),i.RowParser=void 0;var a=e("./column"),s=e("./Token").Token,l=s.isTokenRowDelimiter,p=s.isTokenCarriageReturn,d=s.isTokenDelimiter,g=function(){function y(f){(function(c,v){if(!(c instanceof v))throw new TypeError("Cannot call a class as a function")})(this,y),this.parserOptions=f,this.columnParser=new a.ColumnParser(f)}var h,u;return h=y,(u=[{key:"parse",value:function(f){for(var c=this.parserOptions,v=f.hasMoreData,m=f,b=[],w=this.getStartToken(m,b);w;){if(l(w))return m.advancePastToken(w),!m.hasMoreCharacters&&p(w,c)&&v?null:(m.truncateToCursor(),b);if(!this.shouldSkipColumnParse(m,w,b)){var _=this.columnParser.parse(m);if(_===null)return null;b.push(_)}w=m.nextNonSpaceToken}return v?null:(m.truncateToCursor(),b)}},{key:"getStartToken",value:function(f,c){var v=f.nextNonSpaceToken;return v!==null&&d(v,this.parserOptions)?(c.push(""),f.nextNonSpaceToken):v}},{key:"shouldSkipColumnParse",value:function(f,c,v){var m=this.parserOptions;if(d(c,m)){f.advancePastToken(c);var b=f.nextCharacterToken;if(!f.hasMoreCharacters||b!==null&&l(b)||b!==null&&d(b,m))return v.push(""),!0}return!1}}])&&o(h.prototype,u),y}();i.RowParser=g},{"./Token":156,"./column":161}],155:[function(e,n,i){function o(p,d){for(var g=0;g<d.length;g++){var y=d[g];y.enumerable=y.enumerable||!1,y.configurable=!0,"value"in y&&(y.writable=!0),Object.defineProperty(p,y.key,y)}}Object.defineProperty(i,"__esModule",{value:!0}),i.Scanner=void 0;var a=e("./Token"),s=/((?:\r\n)|\n|\r)/,l=function(){function p(y){(function(h,u){if(!(h instanceof u))throw new TypeError("Cannot call a class as a function")})(this,p),this.cursor=0,this.line=y.line,this.lineLength=this.line.length,this.parserOptions=y.parserOptions,this.hasMoreData=y.hasMoreData,this.cursor=y.cursor||0}var d,g;return d=p,(g=[{key:"advancePastLine",value:function(){var y=s.exec(this.lineFromCursor);return y?(this.cursor+=(y.index||0)+y[0].length,this):this.hasMoreData?null:(this.cursor=this.lineLength,this)}},{key:"advanceTo",value:function(y){return this.cursor=y,this}},{key:"advanceToToken",value:function(y){return this.cursor=y.startCursor,this}},{key:"advancePastToken",value:function(y){return this.cursor=y.endCursor+1,this}},{key:"truncateToCursor",value:function(){return this.line=this.lineFromCursor,this.lineLength=this.line.length,this.cursor=0,this}},{key:"hasMoreCharacters",get:function(){return this.lineLength>this.cursor}},{key:"nextNonSpaceToken",get:function(){var y=this.lineFromCursor,h=this.parserOptions.NEXT_TOKEN_REGEXP;if(y.search(h)===-1)return null;var u=h.exec(y);if(u==null)return null;var f=u[1],c=this.cursor+(u.index||0);return new a.Token({token:f,startCursor:c,endCursor:c+f.length-1})}},{key:"nextCharacterToken",get:function(){var y=this.cursor;return this.lineLength<=y?null:new a.Token({token:this.line[y],startCursor:y,endCursor:y})}},{key:"lineFromCursor",get:function(){return this.line.substr(this.cursor)}}])&&o(d.prototype,g),p}();i.Scanner=l},{"./Token":156}],156:[function(e,n,i){function o(s,l){for(var p=0;p<l.length;p++){var d=l[p];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(s,d.key,d)}}Object.defineProperty(i,"__esModule",{value:!0}),i.Token=void 0;var a=function(){function s(g){(function(y,h){if(!(y instanceof h))throw new TypeError("Cannot call a class as a function")})(this,s),this.token=g.token,this.startCursor=g.startCursor,this.endCursor=g.endCursor}var l,p,d;return l=s,d=[{key:"isTokenRowDelimiter",value:function(g){var y=g.token;return y==="\r"||y===`
`||y===`\r
`}},{key:"isTokenCarriageReturn",value:function(g,y){return g.token===y.carriageReturn}},{key:"isTokenComment",value:function(g,y){return y.supportsComments&&!!g&&g.token===y.comment}},{key:"isTokenEscapeCharacter",value:function(g,y){return g.token===y.escapeChar}},{key:"isTokenQuote",value:function(g,y){return g.token===y.quote}},{key:"isTokenDelimiter",value:function(g,y){return g.token===y.delimiter}}],(p=null)&&o(l.prototype,p),d&&o(l,d),s}();i.Token=a},{}],157:[function(e,n,i){Object.defineProperty(i,"__esModule",{value:!0}),i.ColumnFormatter=void 0,i.ColumnFormatter=function o(a){(function(s,l){if(!(s instanceof l))throw new TypeError("Cannot call a class as a function")})(this,o),a.trim?this.format=function(s){return s.trim()}:a.ltrim?this.format=function(s){return s.trimLeft()}:a.rtrim?this.format=function(s){return s.trimRight()}:this.format=function(s){return s}}},{}],158:[function(e,n,i){function o(d,g){for(var y=0;y<g.length;y++){var h=g[y];h.enumerable=h.enumerable||!1,h.configurable=!0,"value"in h&&(h.writable=!0),Object.defineProperty(d,h.key,h)}}Object.defineProperty(i,"__esModule",{value:!0}),i.ColumnParser=void 0;var a=e("./NonQuotedColumnParser"),s=e("./QuotedColumnParser"),l=e("../Token"),p=function(){function d(h){(function(u,f){if(!(u instanceof f))throw new TypeError("Cannot call a class as a function")})(this,d),this.parserOptions=h,this.quotedColumnParser=new s.QuotedColumnParser(h),this.nonQuotedColumnParser=new a.NonQuotedColumnParser(h)}var g,y;return g=d,(y=[{key:"parse",value:function(h){var u=h.nextNonSpaceToken;return u!==null&&l.Token.isTokenQuote(u,this.parserOptions)?(h.advanceToToken(u),this.quotedColumnParser.parse(h)):this.nonQuotedColumnParser.parse(h)}}])&&o(g.prototype,y),d}();i.ColumnParser=p},{"../Token":156,"./NonQuotedColumnParser":159,"./QuotedColumnParser":160}],159:[function(e,n,i){function o(g,y){for(var h=0;h<y.length;h++){var u=y[h];u.enumerable=u.enumerable||!1,u.configurable=!0,"value"in u&&(u.writable=!0),Object.defineProperty(g,u.key,u)}}Object.defineProperty(i,"__esModule",{value:!0}),i.NonQuotedColumnParser=void 0;var a=e("./ColumnFormatter"),s=e("../Token").Token,l=s.isTokenDelimiter,p=s.isTokenRowDelimiter,d=function(){function g(u){(function(f,c){if(!(f instanceof c))throw new TypeError("Cannot call a class as a function")})(this,g),this.parserOptions=u,this.columnFormatter=new a.ColumnFormatter(u)}var y,h;return y=g,(h=[{key:"parse",value:function(u){if(!u.hasMoreCharacters)return null;for(var f=this.parserOptions,c=[],v=u.nextCharacterToken;v&&!l(v,f)&&!p(v);v=u.nextCharacterToken)c.push(v.token),u.advancePastToken(v);return this.columnFormatter.format(c.join(""))}}])&&o(y.prototype,h),g}();i.NonQuotedColumnParser=d},{"../Token":156,"./ColumnFormatter":157}],160:[function(e,n,i){function o(h,u){for(var f=0;f<u.length;f++){var c=u[f];c.enumerable=c.enumerable||!1,c.configurable=!0,"value"in c&&(c.writable=!0),Object.defineProperty(h,c.key,c)}}Object.defineProperty(i,"__esModule",{value:!0}),i.QuotedColumnParser=void 0;var a=e("./ColumnFormatter"),s=e("../Token").Token,l=s.isTokenDelimiter,p=s.isTokenRowDelimiter,d=s.isTokenEscapeCharacter,g=s.isTokenQuote,y=function(){function h(c){(function(v,m){if(!(v instanceof m))throw new TypeError("Cannot call a class as a function")})(this,h),this.parserOptions=c,this.columnFormatter=new a.ColumnFormatter(c)}var u,f;return u=h,(f=[{key:"parse",value:function(c){if(!c.hasMoreCharacters)return null;var v=c.cursor,m=this.gatherDataBetweenQuotes(c),b=m.foundClosingQuote,w=m.col;if(!b){if(c.advanceTo(v),!c.hasMoreData)throw new Error("Parse Error: missing closing: '".concat(this.parserOptions.quote||"","' in line: at '").concat(c.lineFromCursor.replace(/[\r\n]/g,"\\n'"),"'"));return null}return this.checkForMalformedColumn(c),w}},{key:"gatherDataBetweenQuotes",value:function(c){for(var v=this.parserOptions,m=!1,b=!1,w=[],_=c.nextCharacterToken;!b&&_!==null;_=c.nextCharacterToken){var C=g(_,v);if(!m&&C)m=!0;else if(m)if(d(_,v)){c.advancePastToken(_);var R=c.nextCharacterToken;R!==null&&(g(R,v)||d(R,v))?(w.push(R.token),_=R):C?b=!0:w.push(_.token)}else C?b=!0:w.push(_.token);c.advancePastToken(_)}return{col:this.columnFormatter.format(w.join("")),foundClosingQuote:b}}},{key:"checkForMalformedColumn",value:function(c){var v=this.parserOptions,m=c.nextNonSpaceToken;if(m){var b=l(m,v),w=p(m);if(!b&&!w){var _=c.lineFromCursor.substr(0,10).replace(/[\r\n]/g,"\\n'");throw new Error("Parse Error: expected: '".concat(v.escapedDelimiter,"' OR new line got: '").concat(m.token,"'. at '").concat(_))}c.advanceToToken(m)}else c.hasMoreData||c.advancePastLine()}}])&&o(u.prototype,f),h}();i.QuotedColumnParser=y},{"../Token":156,"./ColumnFormatter":157}],161:[function(e,n,i){Object.defineProperty(i,"__esModule",{value:!0});var o=e("./ColumnParser");Object.defineProperty(i,"ColumnParser",{enumerable:!0,get:function(){return o.ColumnParser}});var a=e("./NonQuotedColumnParser");Object.defineProperty(i,"NonQuotedColumnParser",{enumerable:!0,get:function(){return a.NonQuotedColumnParser}});var s=e("./QuotedColumnParser");Object.defineProperty(i,"QuotedColumnParser",{enumerable:!0,get:function(){return s.QuotedColumnParser}});var l=e("./ColumnFormatter");Object.defineProperty(i,"ColumnFormatter",{enumerable:!0,get:function(){return l.ColumnFormatter}})},{"./ColumnFormatter":157,"./ColumnParser":158,"./NonQuotedColumnParser":159,"./QuotedColumnParser":160}],162:[function(e,n,i){Object.defineProperty(i,"__esModule",{value:!0});var o=e("./Parser");Object.defineProperty(i,"Parser",{enumerable:!0,get:function(){return o.Parser}});var a=e("./RowParser");Object.defineProperty(i,"RowParser",{enumerable:!0,get:function(){return a.RowParser}});var s=e("./Scanner");Object.defineProperty(i,"Scanner",{enumerable:!0,get:function(){return s.Scanner}});var l=e("./Token");Object.defineProperty(i,"Token",{enumerable:!0,get:function(){return l.Token}});var p=e("./column");Object.defineProperty(i,"ColumnParser",{enumerable:!0,get:function(){return p.ColumnParser}}),Object.defineProperty(i,"NonQuotedColumnParser",{enumerable:!0,get:function(){return p.NonQuotedColumnParser}}),Object.defineProperty(i,"QuotedColumnParser",{enumerable:!0,get:function(){return p.QuotedColumnParser}})},{"./Parser":153,"./RowParser":154,"./Scanner":155,"./Token":156,"./column":161}],163:[function(e,n,i){function o(y,h){for(var u=0;u<h.length;u++){var f=h[u];f.enumerable=f.enumerable||!1,f.configurable=!0,"value"in f&&(f.writable=!0),Object.defineProperty(y,f.key,f)}}var a=function(y){return y&&y.__esModule?y:{default:y}};Object.defineProperty(i,"__esModule",{value:!0}),i.HeaderTransformer=void 0;var s=a(e("lodash.isundefined")),l=a(e("lodash.isfunction")),p=a(e("lodash.uniq")),d=a(e("lodash.groupby")),g=function(){function y(f){(function(c,v){if(!(c instanceof v))throw new TypeError("Cannot call a class as a function")})(this,y),this.headers=null,this.receivedHeaders=!1,this.shouldUseFirstRow=!1,this.processedFirstRow=!1,this.headersLength=0,this.parserOptions=f,f.headers===!0?this.shouldUseFirstRow=!0:Array.isArray(f.headers)?this.setHeaders(f.headers):l.default(f.headers)&&(this.headersTransform=f.headers)}var h,u;return h=y,(u=[{key:"transform",value:function(f,c){return this.shouldMapRow(f)?c(null,this.processRow(f)):c(null,{row:null,isValid:!0})}},{key:"shouldMapRow",value:function(f){var c=this.parserOptions;if(!this.headersTransform&&c.renameHeaders&&!this.processedFirstRow){if(!this.receivedHeaders)throw new Error("Error renaming headers: new headers must be provided in an array");return this.processedFirstRow=!0,!1}if(!this.receivedHeaders&&Array.isArray(f)){if(this.headersTransform)this.setHeaders(this.headersTransform(f));else{if(!this.shouldUseFirstRow)return!0;this.setHeaders(f)}return!1}return!0}},{key:"processRow",value:function(f){if(!this.headers)return{row:f,isValid:!0};var c=this.parserOptions;if(!c.discardUnmappedColumns&&f.length>this.headersLength){if(!c.strictColumnHandling)throw new Error("Unexpected Error: column header mismatch expected: ".concat(this.headersLength," columns got: ").concat(f.length));return{row:f,isValid:!1,reason:"Column header mismatch expected: ".concat(this.headersLength," columns got: ").concat(f.length)}}return c.strictColumnHandling&&f.length<this.headersLength?{row:f,isValid:!1,reason:"Column header mismatch expected: ".concat(this.headersLength," columns got: ").concat(f.length)}:{row:this.mapHeaders(f),isValid:!0}}},{key:"mapHeaders",value:function(f){for(var c={},v=this.headers,m=this.headersLength,b=0;b<m;b+=1){var w=v[b];if(!s.default(w)){var _=f[b];s.default(_)?c[w]="":c[w]=_}}return c}},{key:"setHeaders",value:function(f){var c,v=f.filter(function(w){return!!w});if(p.default(v).length!==v.length){var m=d.default(v),b=Object.keys(m).filter(function(w){return m[w].length>1});throw new Error("Duplicate headers found ".concat(JSON.stringify(b)))}this.headers=f,this.receivedHeaders=!0,this.headersLength=((c=this.headers)===null||c===void 0?void 0:c.length)||0}}])&&o(h.prototype,u),y}();i.HeaderTransformer=g},{"lodash.groupby":427,"lodash.isfunction":430,"lodash.isundefined":432,"lodash.uniq":433}],164:[function(e,n,i){function o(d,g){for(var y=0;y<g.length;y++){var h=g[y];h.enumerable=h.enumerable||!1,h.configurable=!0,"value"in h&&(h.writable=!0),Object.defineProperty(d,h.key,h)}}var a=function(d){return d&&d.__esModule?d:{default:d}};Object.defineProperty(i,"__esModule",{value:!0}),i.RowTransformerValidator=void 0;var s=a(e("lodash.isfunction")),l=e("../types"),p=function(){function d(){(function(u,f){if(!(u instanceof f))throw new TypeError("Cannot call a class as a function")})(this,d),this._rowTransform=null,this._rowValidator=null}var g,y,h;return g=d,h=[{key:"createTransform",value:function(u){return l.isSyncTransform(u)?function(f,c){var v=null;try{v=u(f)}catch(m){return c(m)}return c(null,v)}:u}},{key:"createValidator",value:function(u){return l.isSyncValidate(u)?function(f,c){c(null,{row:f,isValid:u(f)})}:function(f,c){u(f,function(v,m,b){return v?c(v):c(null,m?{row:f,isValid:m,reason:b}:{row:f,isValid:!1,reason:b})})}}}],(y=[{key:"transformAndValidate",value:function(u,f){var c=this;return this.callTransformer(u,function(v,m){return v?f(v):m?c.callValidator(m,function(b,w){return b?f(b):w&&!w.isValid?f(null,{row:m,isValid:!1,reason:w.reason}):f(null,{row:m,isValid:!0})}):f(null,{row:null,isValid:!0})})}},{key:"callTransformer",value:function(u,f){return this._rowTransform?this._rowTransform(u,f):f(null,u)}},{key:"callValidator",value:function(u,f){return this._rowValidator?this._rowValidator(u,f):f(null,{row:u,isValid:!0})}},{key:"rowTransform",set:function(u){if(!s.default(u))throw new TypeError("The transform should be a function");this._rowTransform=d.createTransform(u)}},{key:"rowValidator",set:function(u){if(!s.default(u))throw new TypeError("The validate should be a function");this._rowValidator=d.createValidator(u)}}])&&o(g.prototype,y),h&&o(g,h),d}();i.RowTransformerValidator=p},{"../types":166,"lodash.isfunction":430}],165:[function(e,n,i){Object.defineProperty(i,"__esModule",{value:!0});var o=e("./RowTransformerValidator");Object.defineProperty(i,"RowTransformerValidator",{enumerable:!0,get:function(){return o.RowTransformerValidator}});var a=e("./HeaderTransformer");Object.defineProperty(i,"HeaderTransformer",{enumerable:!0,get:function(){return a.HeaderTransformer}})},{"./HeaderTransformer":163,"./RowTransformerValidator":164}],166:[function(e,n,i){Object.defineProperty(i,"__esModule",{value:!0}),i.isSyncValidate=i.isSyncTransform=void 0,i.isSyncTransform=function(o){return o.length===1},i.isSyncValidate=function(o){return o.length===1}},{}],167:[function(e,n,i){var o=i;o.bignum=e("bn.js"),o.define=e("./asn1/api").define,o.base=e("./asn1/base"),o.constants=e("./asn1/constants"),o.decoders=e("./asn1/decoders"),o.encoders=e("./asn1/encoders")},{"./asn1/api":168,"./asn1/base":170,"./asn1/constants":174,"./asn1/decoders":176,"./asn1/encoders":179,"bn.js":181}],168:[function(e,n,i){var o=e("./encoders"),a=e("./decoders"),s=e("inherits");function l(p,d){this.name=p,this.body=d,this.decoders={},this.encoders={}}i.define=function(p,d){return new l(p,d)},l.prototype._createNamed=function(p){var d=this.name;function g(y){this._initNamed(y,d)}return s(g,p),g.prototype._initNamed=function(y,h){p.call(this,y,h)},new g(this)},l.prototype._getDecoder=function(p){return p=p||"der",this.decoders.hasOwnProperty(p)||(this.decoders[p]=this._createNamed(a[p])),this.decoders[p]},l.prototype.decode=function(p,d,g){return this._getDecoder(d).decode(p,g)},l.prototype._getEncoder=function(p){return p=p||"der",this.encoders.hasOwnProperty(p)||(this.encoders[p]=this._createNamed(o[p])),this.encoders[p]},l.prototype.encode=function(p,d,g){return this._getEncoder(d).encode(p,g)}},{"./decoders":176,"./encoders":179,inherits:387}],169:[function(e,n,i){function o(g){return(o=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(y){return typeof y}:function(y){return y&&typeof Symbol=="function"&&y.constructor===Symbol&&y!==Symbol.prototype?"symbol":typeof y})(g)}var a=e("inherits"),s=e("../base/reporter").Reporter,l=e("safer-buffer").Buffer;function p(g,y){s.call(this,y),l.isBuffer(g)?(this.base=g,this.offset=0,this.length=g.length):this.error("Input not Buffer")}function d(g,y){if(Array.isArray(g))this.length=0,this.value=g.map(function(h){return d.isEncoderBuffer(h)||(h=new d(h,y)),this.length+=h.length,h},this);else if(typeof g=="number"){if(!(0<=g&&g<=255))return y.error("non-byte EncoderBuffer value");this.value=g,this.length=1}else if(typeof g=="string")this.value=g,this.length=l.byteLength(g);else{if(!l.isBuffer(g))return y.error("Unsupported type: "+o(g));this.value=g,this.length=g.length}}a(p,s),i.DecoderBuffer=p,p.isDecoderBuffer=function(g){return g instanceof p||o(g)==="object"&&l.isBuffer(g.base)&&g.constructor.name==="DecoderBuffer"&&typeof g.offset=="number"&&typeof g.length=="number"&&typeof g.save=="function"&&typeof g.restore=="function"&&typeof g.isEmpty=="function"&&typeof g.readUInt8=="function"&&typeof g.skip=="function"&&typeof g.raw=="function"},p.prototype.save=function(){return{offset:this.offset,reporter:s.prototype.save.call(this)}},p.prototype.restore=function(g){var y=new p(this.base);return y.offset=g.offset,y.length=this.offset,this.offset=g.offset,s.prototype.restore.call(this,g.reporter),y},p.prototype.isEmpty=function(){return this.offset===this.length},p.prototype.readUInt8=function(g){return this.offset+1<=this.length?this.base.readUInt8(this.offset++,!0):this.error(g||"DecoderBuffer overrun")},p.prototype.skip=function(g,y){if(!(this.offset+g<=this.length))return this.error(y||"DecoderBuffer overrun");var h=new p(this.base);return h._reporterState=this._reporterState,h.offset=this.offset,h.length=this.offset+g,this.offset+=g,h},p.prototype.raw=function(g){return this.base.slice(g?g.offset:this.offset,this.length)},i.EncoderBuffer=d,d.isEncoderBuffer=function(g){return g instanceof d||o(g)==="object"&&g.constructor.name==="EncoderBuffer"&&typeof g.length=="number"&&typeof g.join=="function"},d.prototype.join=function(g,y){return g||(g=l.alloc(this.length)),y||(y=0),this.length===0||(Array.isArray(this.value)?this.value.forEach(function(h){h.join(g,y),y+=h.length}):(typeof this.value=="number"?g[y]=this.value:typeof this.value=="string"?g.write(this.value,y):l.isBuffer(this.value)&&this.value.copy(g,y),y+=this.length)),g}},{"../base/reporter":172,inherits:387,"safer-buffer":495}],170:[function(e,n,i){var o=i;o.Reporter=e("./reporter").Reporter,o.DecoderBuffer=e("./buffer").DecoderBuffer,o.EncoderBuffer=e("./buffer").EncoderBuffer,o.Node=e("./node")},{"./buffer":169,"./node":171,"./reporter":172}],171:[function(e,n,i){function o(u){return(o=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(f){return typeof f}:function(f){return f&&typeof Symbol=="function"&&f.constructor===Symbol&&f!==Symbol.prototype?"symbol":typeof f})(u)}var a=e("../base/reporter").Reporter,s=e("../base/buffer").EncoderBuffer,l=e("../base/buffer").DecoderBuffer,p=e("minimalistic-assert"),d=["seq","seqof","set","setof","objid","bool","gentime","utctime","null_","enum","int","objDesc","bitstr","bmpstr","charstr","genstr","graphstr","ia5str","iso646str","numstr","octstr","printstr","t61str","unistr","utf8str","videostr"],g=["key","obj","use","optional","explicit","implicit","def","choice","any","contains"].concat(d);function y(u,f,c){var v={};this._baseState=v,v.name=c,v.enc=u,v.parent=f||null,v.children=null,v.tag=null,v.args=null,v.reverseArgs=null,v.choice=null,v.optional=!1,v.any=!1,v.obj=!1,v.use=null,v.useDecoder=null,v.key=null,v.default=null,v.explicit=null,v.implicit=null,v.contains=null,v.parent||(v.children=[],this._wrap())}n.exports=y;var h=["enc","parent","children","tag","args","reverseArgs","choice","optional","any","obj","use","alteredUse","key","default","explicit","implicit","contains"];y.prototype.clone=function(){var u=this._baseState,f={};h.forEach(function(v){f[v]=u[v]});var c=new this.constructor(f.parent);return c._baseState=f,c},y.prototype._wrap=function(){var u=this._baseState;g.forEach(function(f){this[f]=function(){var c=new this.constructor(this);return u.children.push(c),c[f].apply(c,arguments)}},this)},y.prototype._init=function(u){var f=this._baseState;p(f.parent===null),u.call(this),f.children=f.children.filter(function(c){return c._baseState.parent===this},this),p.equal(f.children.length,1,"Root node can have only one child")},y.prototype._useArgs=function(u){var f=this._baseState,c=u.filter(function(v){return v instanceof this.constructor},this);u=u.filter(function(v){return!(v instanceof this.constructor)},this),c.length!==0&&(p(f.children===null),f.children=c,c.forEach(function(v){v._baseState.parent=this},this)),u.length!==0&&(p(f.args===null),f.args=u,f.reverseArgs=u.map(function(v){if(o(v)!=="object"||v.constructor!==Object)return v;var m={};return Object.keys(v).forEach(function(b){b==(0|b)&&(b|=0);var w=v[b];m[w]=b}),m}))},["_peekTag","_decodeTag","_use","_decodeStr","_decodeObjid","_decodeTime","_decodeNull","_decodeInt","_decodeBool","_decodeList","_encodeComposite","_encodeStr","_encodeObjid","_encodeTime","_encodeNull","_encodeInt","_encodeBool"].forEach(function(u){y.prototype[u]=function(){var f=this._baseState;throw new Error(u+" not implemented for encoding: "+f.enc)}}),d.forEach(function(u){y.prototype[u]=function(){var f=this._baseState,c=Array.prototype.slice.call(arguments);return p(f.tag===null),f.tag=u,this._useArgs(c),this}}),y.prototype.use=function(u){p(u);var f=this._baseState;return p(f.use===null),f.use=u,this},y.prototype.optional=function(){return this._baseState.optional=!0,this},y.prototype.def=function(u){var f=this._baseState;return p(f.default===null),f.default=u,f.optional=!0,this},y.prototype.explicit=function(u){var f=this._baseState;return p(f.explicit===null&&f.implicit===null),f.explicit=u,this},y.prototype.implicit=function(u){var f=this._baseState;return p(f.explicit===null&&f.implicit===null),f.implicit=u,this},y.prototype.obj=function(){var u=this._baseState,f=Array.prototype.slice.call(arguments);return u.obj=!0,f.length!==0&&this._useArgs(f),this},y.prototype.key=function(u){var f=this._baseState;return p(f.key===null),f.key=u,this},y.prototype.any=function(){return this._baseState.any=!0,this},y.prototype.choice=function(u){var f=this._baseState;return p(f.choice===null),f.choice=u,this._useArgs(Object.keys(u).map(function(c){return u[c]})),this},y.prototype.contains=function(u){var f=this._baseState;return p(f.use===null),f.contains=u,this},y.prototype._decode=function(u,f){var c=this._baseState;if(c.parent===null)return u.wrapResult(c.children[0]._decode(u,f));var v,m=c.default,b=!0,w=null;if(c.key!==null&&(w=u.enterKey(c.key)),c.optional){var _=null;if(c.explicit!==null?_=c.explicit:c.implicit!==null?_=c.implicit:c.tag!==null&&(_=c.tag),_!==null||c.any){if(b=this._peekTag(u,_,c.any),u.isError(b))return b}else{var C=u.save();try{c.choice===null?this._decodeGeneric(c.tag,u,f):this._decodeChoice(u,f),b=!0}catch{b=!1}u.restore(C)}}if(c.obj&&b&&(v=u.enterObject()),b){if(c.explicit!==null){var R=this._decodeTag(u,c.explicit);if(u.isError(R))return R;u=R}var I=u.offset;if(c.use===null&&c.choice===null){var P;c.any&&(P=u.save());var N=this._decodeTag(u,c.implicit!==null?c.implicit:c.tag,c.any);if(u.isError(N))return N;c.any?m=u.raw(P):u=N}if(f&&f.track&&c.tag!==null&&f.track(u.path(),I,u.length,"tagged"),f&&f.track&&c.tag!==null&&f.track(u.path(),u.offset,u.length,"content"),c.any||(m=c.choice===null?this._decodeGeneric(c.tag,u,f):this._decodeChoice(u,f)),u.isError(m))return m;if(c.any||c.choice!==null||c.children===null||c.children.forEach(function($){$._decode(u,f)}),c.contains&&(c.tag==="octstr"||c.tag==="bitstr")){var A=new l(m);m=this._getUse(c.contains,u._reporterState.obj)._decode(A,f)}}return c.obj&&b&&(m=u.leaveObject(v)),c.key===null||m===null&&b!==!0?w!==null&&u.exitKey(w):u.leaveKey(w,c.key,m),m},y.prototype._decodeGeneric=function(u,f,c){var v=this._baseState;return u==="seq"||u==="set"?null:u==="seqof"||u==="setof"?this._decodeList(f,u,v.args[0],c):/str$/.test(u)?this._decodeStr(f,u,c):u==="objid"&&v.args?this._decodeObjid(f,v.args[0],v.args[1],c):u==="objid"?this._decodeObjid(f,null,null,c):u==="gentime"||u==="utctime"?this._decodeTime(f,u,c):u==="null_"?this._decodeNull(f,c):u==="bool"?this._decodeBool(f,c):u==="objDesc"?this._decodeStr(f,u,c):u==="int"||u==="enum"?this._decodeInt(f,v.args&&v.args[0],c):v.use!==null?this._getUse(v.use,f._reporterState.obj)._decode(f,c):f.error("unknown tag: "+u)},y.prototype._getUse=function(u,f){var c=this._baseState;return c.useDecoder=this._use(u,f),p(c.useDecoder._baseState.parent===null),c.useDecoder=c.useDecoder._baseState.children[0],c.implicit!==c.useDecoder._baseState.implicit&&(c.useDecoder=c.useDecoder.clone(),c.useDecoder._baseState.implicit=c.implicit),c.useDecoder},y.prototype._decodeChoice=function(u,f){var c=this._baseState,v=null,m=!1;return Object.keys(c.choice).some(function(b){var w=u.save(),_=c.choice[b];try{var C=_._decode(u,f);if(u.isError(C))return!1;v={type:b,value:C},m=!0}catch{return u.restore(w),!1}return!0},this),m?v:u.error("Choice not matched")},y.prototype._createEncoderBuffer=function(u){return new s(u,this.reporter)},y.prototype._encode=function(u,f,c){var v=this._baseState;if(v.default===null||v.default!==u){var m=this._encodeValue(u,f,c);if(m!==void 0&&!this._skipDefault(m,f,c))return m}},y.prototype._encodeValue=function(u,f,c){var v=this._baseState;if(v.parent===null)return v.children[0]._encode(u,f||new a);var m=null;if(this.reporter=f,v.optional&&u===void 0){if(v.default===null)return;u=v.default}var b=null,w=!1;if(v.any)m=this._createEncoderBuffer(u);else if(v.choice)m=this._encodeChoice(u,f);else if(v.contains)b=this._getUse(v.contains,c)._encode(u,f),w=!0;else if(v.children)b=v.children.map(function(I){if(I._baseState.tag==="null_")return I._encode(null,f,u);if(I._baseState.key===null)return f.error("Child should have a key");var P=f.enterKey(I._baseState.key);if(o(u)!=="object")return f.error("Child expected, but input is not object");var N=I._encode(u[I._baseState.key],f,u);return f.leaveKey(P),N},this).filter(function(I){return I}),b=this._createEncoderBuffer(b);else if(v.tag==="seqof"||v.tag==="setof"){if(!v.args||v.args.length!==1)return f.error("Too many args for : "+v.tag);if(!Array.isArray(u))return f.error("seqof/setof, but data is not Array");var _=this.clone();_._baseState.implicit=null,b=this._createEncoderBuffer(u.map(function(I){var P=this._baseState;return this._getUse(P.args[0],u)._encode(I,f)},_))}else v.use!==null?m=this._getUse(v.use,c)._encode(u,f):(b=this._encodePrimitive(v.tag,u),w=!0);if(!v.any&&v.choice===null){var C=v.implicit!==null?v.implicit:v.tag,R=v.implicit===null?"universal":"context";C===null?v.use===null&&f.error("Tag could be omitted only for .use()"):v.use===null&&(m=this._encodeComposite(C,w,R,b))}return v.explicit!==null&&(m=this._encodeComposite(v.explicit,!1,"context",m)),m},y.prototype._encodeChoice=function(u,f){var c=this._baseState,v=c.choice[u.type];return v||p(!1,u.type+" not found in "+JSON.stringify(Object.keys(c.choice))),v._encode(u.value,f)},y.prototype._encodePrimitive=function(u,f){var c=this._baseState;if(/str$/.test(u))return this._encodeStr(f,u);if(u==="objid"&&c.args)return this._encodeObjid(f,c.reverseArgs[0],c.args[1]);if(u==="objid")return this._encodeObjid(f,null,null);if(u==="gentime"||u==="utctime")return this._encodeTime(f,u);if(u==="null_")return this._encodeNull();if(u==="int"||u==="enum")return this._encodeInt(f,c.args&&c.reverseArgs[0]);if(u==="bool")return this._encodeBool(f);if(u==="objDesc")return this._encodeStr(f,u);throw new Error("Unsupported tag: "+u)},y.prototype._isNumstr=function(u){return/^[0-9 ]*$/.test(u)},y.prototype._isPrintstr=function(u){return/^[A-Za-z0-9 '()+,-./:=?]*$/.test(u)}},{"../base/buffer":169,"../base/reporter":172,"minimalistic-assert":437}],172:[function(e,n,i){var o=e("inherits");function a(l){this._reporterState={obj:null,path:[],options:l||{},errors:[]}}function s(l,p){this.path=l,this.rethrow(p)}i.Reporter=a,a.prototype.isError=function(l){return l instanceof s},a.prototype.save=function(){var l=this._reporterState;return{obj:l.obj,pathLen:l.path.length}},a.prototype.restore=function(l){var p=this._reporterState;p.obj=l.obj,p.path=p.path.slice(0,l.pathLen)},a.prototype.enterKey=function(l){return this._reporterState.path.push(l)},a.prototype.exitKey=function(l){var p=this._reporterState;p.path=p.path.slice(0,l-1)},a.prototype.leaveKey=function(l,p,d){var g=this._reporterState;this.exitKey(l),g.obj!==null&&(g.obj[p]=d)},a.prototype.path=function(){return this._reporterState.path.join("/")},a.prototype.enterObject=function(){var l=this._reporterState,p=l.obj;return l.obj={},p},a.prototype.leaveObject=function(l){var p=this._reporterState,d=p.obj;return p.obj=l,d},a.prototype.error=function(l){var p,d=this._reporterState,g=l instanceof s;if(p=g?l:new s(d.path.map(function(y){return"["+JSON.stringify(y)+"]"}).join(""),l.message||l,l.stack),!d.options.partial)throw p;return g||d.errors.push(p),p},a.prototype.wrapResult=function(l){var p=this._reporterState;return p.options.partial?{result:this.isError(l)?null:l,errors:p.errors}:l},o(s,Error),s.prototype.rethrow=function(l){if(this.message=l+" at: "+(this.path||"(shallow)"),Error.captureStackTrace&&Error.captureStackTrace(this,s),!this.stack)try{throw new Error(this.message)}catch(p){this.stack=p.stack}return this}},{inherits:387}],173:[function(e,n,i){function o(a){var s={};return Object.keys(a).forEach(function(l){(0|l)==l&&(l|=0);var p=a[l];s[p]=l}),s}i.tagClass={0:"universal",1:"application",2:"context",3:"private"},i.tagClassByName=o(i.tagClass),i.tag={0:"end",1:"bool",2:"int",3:"bitstr",4:"octstr",5:"null_",6:"objid",7:"objDesc",8:"external",9:"real",10:"enum",11:"embed",12:"utf8str",13:"relativeOid",16:"seq",17:"set",18:"numstr",19:"printstr",20:"t61str",21:"videostr",22:"ia5str",23:"utctime",24:"gentime",25:"graphstr",26:"iso646str",27:"genstr",28:"unistr",29:"charstr",30:"bmpstr"},i.tagByName=o(i.tag)},{}],174:[function(e,n,i){var o=i;o._reverse=function(a){var s={};return Object.keys(a).forEach(function(l){(0|l)==l&&(l|=0);var p=a[l];s[p]=l}),s},o.der=e("./der")},{"./der":173}],175:[function(e,n,i){var o=e("inherits"),a=e("bn.js"),s=e("../base/buffer").DecoderBuffer,l=e("../base/node"),p=e("../constants/der");function d(u){this.enc="der",this.name=u.name,this.entity=u,this.tree=new g,this.tree._init(u.body)}function g(u){l.call(this,"der",u)}function y(u,f){var c=u.readUInt8(f);if(u.isError(c))return c;var v=p.tagClass[c>>6],m=(32&c)==0;if((31&c)==31){var b=c;for(c=0;(128&b)==128;){if(b=u.readUInt8(f),u.isError(b))return b;c<<=7,c|=127&b}}else c&=31;return{cls:v,primitive:m,tag:c,tagStr:p.tag[c]}}function h(u,f,c){var v=u.readUInt8(c);if(u.isError(v))return v;if(!f&&v===128)return null;if((128&v)==0)return v;var m=127&v;if(m>4)return u.error("length octect is too long");v=0;for(var b=0;b<m;b++){v<<=8;var w=u.readUInt8(c);if(u.isError(w))return w;v|=w}return v}n.exports=d,d.prototype.decode=function(u,f){return s.isDecoderBuffer(u)||(u=new s(u,f)),this.tree._decode(u,f)},o(g,l),g.prototype._peekTag=function(u,f,c){if(u.isEmpty())return!1;var v=u.save(),m=y(u,'Failed to peek tag: "'+f+'"');return u.isError(m)?m:(u.restore(v),m.tag===f||m.tagStr===f||m.tagStr+"of"===f||c)},g.prototype._decodeTag=function(u,f,c){var v=y(u,'Failed to decode tag of "'+f+'"');if(u.isError(v))return v;var m=h(u,v.primitive,'Failed to get length of "'+f+'"');if(u.isError(m))return m;if(!c&&v.tag!==f&&v.tagStr!==f&&v.tagStr+"of"!==f)return u.error('Failed to match tag: "'+f+'"');if(v.primitive||m!==null)return u.skip(m,'Failed to match body of: "'+f+'"');var b=u.save(),w=this._skipUntilEnd(u,'Failed to skip indefinite length body: "'+this.tag+'"');return u.isError(w)?w:(m=u.offset-b.offset,u.restore(b),u.skip(m,'Failed to match body of: "'+f+'"'))},g.prototype._skipUntilEnd=function(u,f){for(;;){var c=y(u,f);if(u.isError(c))return c;var v=h(u,c.primitive,f);if(u.isError(v))return v;var m=void 0;if(m=c.primitive||v!==null?u.skip(v):this._skipUntilEnd(u,f),u.isError(m))return m;if(c.tagStr==="end")break}},g.prototype._decodeList=function(u,f,c,v){for(var m=[];!u.isEmpty();){var b=this._peekTag(u,"end");if(u.isError(b))return b;var w=c.decode(u,"der",v);if(u.isError(w)&&b)break;m.push(w)}return m},g.prototype._decodeStr=function(u,f){if(f==="bitstr"){var c=u.readUInt8();return u.isError(c)?c:{unused:c,data:u.raw()}}if(f==="bmpstr"){var v=u.raw();if(v.length%2==1)return u.error("Decoding of string type: bmpstr length mismatch");for(var m="",b=0;b<v.length/2;b++)m+=String.fromCharCode(v.readUInt16BE(2*b));return m}if(f==="numstr"){var w=u.raw().toString("ascii");return this._isNumstr(w)?w:u.error("Decoding of string type: numstr unsupported characters")}if(f==="octstr"||f==="objDesc")return u.raw();if(f==="printstr"){var _=u.raw().toString("ascii");return this._isPrintstr(_)?_:u.error("Decoding of string type: printstr unsupported characters")}return/str$/.test(f)?u.raw().toString():u.error("Decoding of string type: "+f+" unsupported")},g.prototype._decodeObjid=function(u,f,c){for(var v,m=[],b=0,w=0;!u.isEmpty();)b<<=7,b|=127&(w=u.readUInt8()),(128&w)==0&&(m.push(b),b=0);128&w&&m.push(b);var _=m[0]/40|0,C=m[0]%40;if(v=c?m:[_,C].concat(m.slice(1)),f){var R=f[v.join(" ")];R===void 0&&(R=f[v.join(".")]),R!==void 0&&(v=R)}return v},g.prototype._decodeTime=function(u,f){var c,v,m,b,w,_,C=u.raw().toString();if(f==="gentime")c=0|C.slice(0,4),v=0|C.slice(4,6),m=0|C.slice(6,8),b=0|C.slice(8,10),w=0|C.slice(10,12),_=0|C.slice(12,14);else{if(f!=="utctime")return u.error("Decoding "+f+" time is not supported yet");c=0|C.slice(0,2),v=0|C.slice(2,4),m=0|C.slice(4,6),b=0|C.slice(6,8),w=0|C.slice(8,10),_=0|C.slice(10,12),c=c<70?2e3+c:1900+c}return Date.UTC(c,v-1,m,b,w,_,0)},g.prototype._decodeNull=function(){return null},g.prototype._decodeBool=function(u){var f=u.readUInt8();return u.isError(f)?f:f!==0},g.prototype._decodeInt=function(u,f){var c=u.raw(),v=new a(c);return f&&(v=f[v.toString(10)]||v),v},g.prototype._use=function(u,f){return typeof u=="function"&&(u=u(f)),u._getDecoder("der").tree}},{"../base/buffer":169,"../base/node":171,"../constants/der":173,"bn.js":181,inherits:387}],176:[function(e,n,i){var o=i;o.der=e("./der"),o.pem=e("./pem")},{"./der":175,"./pem":177}],177:[function(e,n,i){var o=e("inherits"),a=e("safer-buffer").Buffer,s=e("./der");function l(p){s.call(this,p),this.enc="pem"}o(l,s),n.exports=l,l.prototype.decode=function(p,d){for(var g=p.toString().split(/[\r\n]+/g),y=d.label.toUpperCase(),h=/^-----(BEGIN|END) ([^-]+)-----$/,u=-1,f=-1,c=0;c<g.length;c++){var v=g[c].match(h);if(v!==null&&v[2]===y){if(u!==-1){if(v[1]!=="END")break;f=c;break}if(v[1]!=="BEGIN")break;u=c}}if(u===-1||f===-1)throw new Error("PEM section not found for: "+y);var m=g.slice(u+1,f).join("");m.replace(/[^a-z0-9+/=]+/gi,"");var b=a.from(m,"base64");return s.prototype.decode.call(this,b,d)}},{"./der":175,inherits:387,"safer-buffer":495}],178:[function(e,n,i){var o=e("inherits"),a=e("safer-buffer").Buffer,s=e("../base/node"),l=e("../constants/der");function p(y){this.enc="der",this.name=y.name,this.entity=y,this.tree=new d,this.tree._init(y.body)}function d(y){s.call(this,"der",y)}function g(y){return y<10?"0"+y:y}n.exports=p,p.prototype.encode=function(y,h){return this.tree._encode(y,h).join()},o(d,s),d.prototype._encodeComposite=function(y,h,u,f){var c=function(R,I,P,N){var A;if(R==="seqof"?R="seq":R==="setof"&&(R="set"),l.tagByName.hasOwnProperty(R))A=l.tagByName[R];else{if(typeof R!="number"||(0|R)!==R)return N.error("Unknown tag: "+R);A=R}return A>=31?N.error("Multi-octet tag encoding unsupported"):(I||(A|=32),A|=l.tagClassByName[P||"universal"]<<6)}(y,h,u,this.reporter);if(f.length<128){var v=a.alloc(2);return v[0]=c,v[1]=f.length,this._createEncoderBuffer([v,f])}for(var m=1,b=f.length;b>=256;b>>=8)m++;var w=a.alloc(2+m);w[0]=c,w[1]=128|m;for(var _=1+m,C=f.length;C>0;_--,C>>=8)w[_]=255&C;return this._createEncoderBuffer([w,f])},d.prototype._encodeStr=function(y,h){if(h==="bitstr")return this._createEncoderBuffer([0|y.unused,y.data]);if(h==="bmpstr"){for(var u=a.alloc(2*y.length),f=0;f<y.length;f++)u.writeUInt16BE(y.charCodeAt(f),2*f);return this._createEncoderBuffer(u)}return h==="numstr"?this._isNumstr(y)?this._createEncoderBuffer(y):this.reporter.error("Encoding of string type: numstr supports only digits and space"):h==="printstr"?this._isPrintstr(y)?this._createEncoderBuffer(y):this.reporter.error("Encoding of string type: printstr supports only latin upper and lower case letters, digits, space, apostrophe, left and rigth parenthesis, plus sign, comma, hyphen, dot, slash, colon, equal sign, question mark"):/str$/.test(h)||h==="objDesc"?this._createEncoderBuffer(y):this.reporter.error("Encoding of string type: "+h+" unsupported")},d.prototype._encodeObjid=function(y,h,u){if(typeof y=="string"){if(!h)return this.reporter.error("string objid given, but no values map found");if(!h.hasOwnProperty(y))return this.reporter.error("objid not found in values map");y=h[y].split(/[\s.]+/g);for(var f=0;f<y.length;f++)y[f]|=0}else if(Array.isArray(y)){y=y.slice();for(var c=0;c<y.length;c++)y[c]|=0}if(!Array.isArray(y))return this.reporter.error("objid() should be either array or string, got: "+JSON.stringify(y));if(!u){if(y[1]>=40)return this.reporter.error("Second objid identifier OOB");y.splice(0,2,40*y[0]+y[1])}for(var v=0,m=0;m<y.length;m++){var b=y[m];for(v++;b>=128;b>>=7)v++}for(var w=a.alloc(v),_=w.length-1,C=y.length-1;C>=0;C--){var R=y[C];for(w[_--]=127&R;(R>>=7)>0;)w[_--]=128|127&R}return this._createEncoderBuffer(w)},d.prototype._encodeTime=function(y,h){var u,f=new Date(y);return h==="gentime"?u=[g(f.getUTCFullYear()),g(f.getUTCMonth()+1),g(f.getUTCDate()),g(f.getUTCHours()),g(f.getUTCMinutes()),g(f.getUTCSeconds()),"Z"].join(""):h==="utctime"?u=[g(f.getUTCFullYear()%100),g(f.getUTCMonth()+1),g(f.getUTCDate()),g(f.getUTCHours()),g(f.getUTCMinutes()),g(f.getUTCSeconds()),"Z"].join(""):this.reporter.error("Encoding "+h+" time is not supported yet"),this._encodeStr(u,"octstr")},d.prototype._encodeNull=function(){return this._createEncoderBuffer("")},d.prototype._encodeInt=function(y,h){if(typeof y=="string"){if(!h)return this.reporter.error("String int or enum given, but no values map");if(!h.hasOwnProperty(y))return this.reporter.error("Values map doesn't contain: "+JSON.stringify(y));y=h[y]}if(typeof y!="number"&&!a.isBuffer(y)){var u=y.toArray();!y.sign&&128&u[0]&&u.unshift(0),y=a.from(u)}if(a.isBuffer(y)){var f=y.length;y.length===0&&f++;var c=a.alloc(f);return y.copy(c),y.length===0&&(c[0]=0),this._createEncoderBuffer(c)}if(y<128)return this._createEncoderBuffer(y);if(y<256)return this._createEncoderBuffer([0,y]);for(var v=1,m=y;m>=256;m>>=8)v++;for(var b=new Array(v),w=b.length-1;w>=0;w--)b[w]=255&y,y>>=8;return 128&b[0]&&b.unshift(0),this._createEncoderBuffer(a.from(b))},d.prototype._encodeBool=function(y){return this._createEncoderBuffer(y?255:0)},d.prototype._use=function(y,h){return typeof y=="function"&&(y=y(h)),y._getEncoder("der").tree},d.prototype._skipDefault=function(y,h,u){var f,c=this._baseState;if(c.default===null)return!1;var v=y.join();if(c.defaultBuffer===void 0&&(c.defaultBuffer=this._encodeValue(c.default,h,u).join()),v.length!==c.defaultBuffer.length)return!1;for(f=0;f<v.length;f++)if(v[f]!==c.defaultBuffer[f])return!1;return!0}},{"../base/node":171,"../constants/der":173,inherits:387,"safer-buffer":495}],179:[function(e,n,i){var o=i;o.der=e("./der"),o.pem=e("./pem")},{"./der":178,"./pem":180}],180:[function(e,n,i){var o=e("inherits"),a=e("./der");function s(l){a.call(this,l),this.enc="pem"}o(s,a),n.exports=s,s.prototype.encode=function(l,p){for(var d=a.prototype.encode.call(this,l).toString("base64"),g=["-----BEGIN "+p.label+"-----"],y=0;y<d.length;y+=64)g.push(d.slice(y,y+64));return g.push("-----END "+p.label+"-----"),g.join(`
`)}},{"./der":178,inherits:387}],181:[function(e,n,i){function o(a){return(o=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(s){return typeof s}:function(s){return s&&typeof Symbol=="function"&&s.constructor===Symbol&&s!==Symbol.prototype?"symbol":typeof s})(a)}(function(a,s){function l(T,M){if(!T)throw new Error(M||"Assertion failed")}function p(T,M){T.super_=M;var S=function(){};S.prototype=M.prototype,T.prototype=new S,T.prototype.constructor=T}function d(T,M,S){if(d.isBN(T))return T;this.negative=0,this.words=null,this.length=0,this.red=null,T!==null&&(M!=="le"&&M!=="be"||(S=M,M=10),this._init(T||0,M||10,S||"be"))}var g;o(a)==="object"?a.exports=d:(void 0).BN=d,d.BN=d,d.wordSize=26;try{g=e("buffer").Buffer}catch{}function y(T,M,S){for(var E=0,k=Math.min(T.length,S),O=M;O<k;O++){var x=T.charCodeAt(O)-48;E<<=4,E|=x>=49&&x<=54?x-49+10:x>=17&&x<=22?x-17+10:15&x}return E}function h(T,M,S,E){for(var k=0,O=Math.min(T.length,S),x=M;x<O;x++){var j=T.charCodeAt(x)-48;k*=E,k+=j>=49?j-49+10:j>=17?j-17+10:j}return k}d.isBN=function(T){return T instanceof d||T!==null&&o(T)==="object"&&T.constructor.wordSize===d.wordSize&&Array.isArray(T.words)},d.max=function(T,M){return T.cmp(M)>0?T:M},d.min=function(T,M){return T.cmp(M)<0?T:M},d.prototype._init=function(T,M,S){if(typeof T=="number")return this._initNumber(T,M,S);if(o(T)==="object")return this._initArray(T,M,S);M==="hex"&&(M=16),l(M===(0|M)&&M>=2&&M<=36);var E=0;(T=T.toString().replace(/\s+/g,""))[0]==="-"&&E++,M===16?this._parseHex(T,E):this._parseBase(T,M,E),T[0]==="-"&&(this.negative=1),this.strip(),S==="le"&&this._initArray(this.toArray(),M,S)},d.prototype._initNumber=function(T,M,S){T<0&&(this.negative=1,T=-T),T<67108864?(this.words=[67108863&T],this.length=1):T<4503599627370496?(this.words=[67108863&T,T/67108864&67108863],this.length=2):(l(T<9007199254740992),this.words=[67108863&T,T/67108864&67108863,1],this.length=3),S==="le"&&this._initArray(this.toArray(),M,S)},d.prototype._initArray=function(T,M,S){if(l(typeof T.length=="number"),T.length<=0)return this.words=[0],this.length=1,this;this.length=Math.ceil(T.length/3),this.words=new Array(this.length);for(var E=0;E<this.length;E++)this.words[E]=0;var k,O,x=0;if(S==="be")for(E=T.length-1,k=0;E>=0;E-=3)O=T[E]|T[E-1]<<8|T[E-2]<<16,this.words[k]|=O<<x&67108863,this.words[k+1]=O>>>26-x&67108863,(x+=24)>=26&&(x-=26,k++);else if(S==="le")for(E=0,k=0;E<T.length;E+=3)O=T[E]|T[E+1]<<8|T[E+2]<<16,this.words[k]|=O<<x&67108863,this.words[k+1]=O>>>26-x&67108863,(x+=24)>=26&&(x-=26,k++);return this.strip()},d.prototype._parseHex=function(T,M){this.length=Math.ceil((T.length-M)/6),this.words=new Array(this.length);for(var S=0;S<this.length;S++)this.words[S]=0;var E,k,O=0;for(S=T.length-6,E=0;S>=M;S-=6)k=y(T,S,S+6),this.words[E]|=k<<O&67108863,this.words[E+1]|=k>>>26-O&4194303,(O+=24)>=26&&(O-=26,E++);S+6!==M&&(k=y(T,M,S+6),this.words[E]|=k<<O&67108863,this.words[E+1]|=k>>>26-O&4194303),this.strip()},d.prototype._parseBase=function(T,M,S){this.words=[0],this.length=1;for(var E=0,k=1;k<=67108863;k*=M)E++;E--,k=k/M|0;for(var O=T.length-S,x=O%E,j=Math.min(O,O-x)+S,H=0,F=S;F<j;F+=E)H=h(T,F,F+E,M),this.imuln(k),this.words[0]+H<67108864?this.words[0]+=H:this._iaddn(H);if(x!==0){var V=1;for(H=h(T,F,T.length,M),F=0;F<x;F++)V*=M;this.imuln(V),this.words[0]+H<67108864?this.words[0]+=H:this._iaddn(H)}},d.prototype.copy=function(T){T.words=new Array(this.length);for(var M=0;M<this.length;M++)T.words[M]=this.words[M];T.length=this.length,T.negative=this.negative,T.red=this.red},d.prototype.clone=function(){var T=new d(null);return this.copy(T),T},d.prototype._expand=function(T){for(;this.length<T;)this.words[this.length++]=0;return this},d.prototype.strip=function(){for(;this.length>1&&this.words[this.length-1]===0;)this.length--;return this._normSign()},d.prototype._normSign=function(){return this.length===1&&this.words[0]===0&&(this.negative=0),this},d.prototype.inspect=function(){return(this.red?"<BN-R: ":"<BN: ")+this.toString(16)+">"};var u=["","0","00","000","0000","00000","000000","0000000","00000000","000000000","0000000000","00000000000","000000000000","0000000000000","00000000000000","000000000000000","0000000000000000","00000000000000000","000000000000000000","0000000000000000000","00000000000000000000","000000000000000000000","0000000000000000000000","00000000000000000000000","000000000000000000000000","0000000000000000000000000"],f=[0,0,25,16,12,11,10,9,8,8,7,7,7,7,6,6,6,6,6,6,6,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5],c=[0,0,33554432,43046721,16777216,48828125,60466176,40353607,16777216,43046721,1e7,19487171,35831808,62748517,7529536,11390625,16777216,24137569,34012224,47045881,64e6,4084101,5153632,6436343,7962624,9765625,11881376,14348907,17210368,20511149,243e5,28629151,33554432,39135393,45435424,52521875,60466176];function v(T,M,S){S.negative=M.negative^T.negative;var E=T.length+M.length|0;S.length=E,E=E-1|0;var k=0|T.words[0],O=0|M.words[0],x=k*O,j=67108863&x,H=x/67108864|0;S.words[0]=j;for(var F=1;F<E;F++){for(var V=H>>>26,W=67108863&H,U=Math.min(F,M.length-1),Y=Math.max(0,F-T.length+1);Y<=U;Y++){var K=F-Y|0;V+=(x=(k=0|T.words[K])*(O=0|M.words[Y])+W)/67108864|0,W=67108863&x}S.words[F]=0|W,H=0|V}return H!==0?S.words[F]=0|H:S.length--,S.strip()}d.prototype.toString=function(T,M){var S;if(M=0|M||1,(T=T||10)===16||T==="hex"){S="";for(var E=0,k=0,O=0;O<this.length;O++){var x=this.words[O],j=(16777215&(x<<E|k)).toString(16);S=(k=x>>>24-E&16777215)!=0||O!==this.length-1?u[6-j.length]+j+S:j+S,(E+=2)>=26&&(E-=26,O--)}for(k!==0&&(S=k.toString(16)+S);S.length%M!=0;)S="0"+S;return this.negative!==0&&(S="-"+S),S}if(T===(0|T)&&T>=2&&T<=36){var H=f[T],F=c[T];S="";var V=this.clone();for(V.negative=0;!V.isZero();){var W=V.modn(F).toString(T);S=(V=V.idivn(F)).isZero()?W+S:u[H-W.length]+W+S}for(this.isZero()&&(S="0"+S);S.length%M!=0;)S="0"+S;return this.negative!==0&&(S="-"+S),S}l(!1,"Base should be between 2 and 36")},d.prototype.toNumber=function(){var T=this.words[0];return this.length===2?T+=67108864*this.words[1]:this.length===3&&this.words[2]===1?T+=4503599627370496+67108864*this.words[1]:this.length>2&&l(!1,"Number can only safely store up to 53 bits"),this.negative!==0?-T:T},d.prototype.toJSON=function(){return this.toString(16)},d.prototype.toBuffer=function(T,M){return l(g!==void 0),this.toArrayLike(g,T,M)},d.prototype.toArray=function(T,M){return this.toArrayLike(Array,T,M)},d.prototype.toArrayLike=function(T,M,S){var E=this.byteLength(),k=S||Math.max(1,E);l(E<=k,"byte array longer than desired length"),l(k>0,"Requested array length <= 0"),this.strip();var O,x,j=M==="le",H=new T(k),F=this.clone();if(j){for(x=0;!F.isZero();x++)O=F.andln(255),F.iushrn(8),H[x]=O;for(;x<k;x++)H[x]=0}else{for(x=0;x<k-E;x++)H[x]=0;for(x=0;!F.isZero();x++)O=F.andln(255),F.iushrn(8),H[k-x-1]=O}return H},Math.clz32?d.prototype._countBits=function(T){return 32-Math.clz32(T)}:d.prototype._countBits=function(T){var M=T,S=0;return M>=4096&&(S+=13,M>>>=13),M>=64&&(S+=7,M>>>=7),M>=8&&(S+=4,M>>>=4),M>=2&&(S+=2,M>>>=2),S+M},d.prototype._zeroBits=function(T){if(T===0)return 26;var M=T,S=0;return(8191&M)==0&&(S+=13,M>>>=13),(127&M)==0&&(S+=7,M>>>=7),(15&M)==0&&(S+=4,M>>>=4),(3&M)==0&&(S+=2,M>>>=2),(1&M)==0&&S++,S},d.prototype.bitLength=function(){var T=this.words[this.length-1],M=this._countBits(T);return 26*(this.length-1)+M},d.prototype.zeroBits=function(){if(this.isZero())return 0;for(var T=0,M=0;M<this.length;M++){var S=this._zeroBits(this.words[M]);if(T+=S,S!==26)break}return T},d.prototype.byteLength=function(){return Math.ceil(this.bitLength()/8)},d.prototype.toTwos=function(T){return this.negative!==0?this.abs().inotn(T).iaddn(1):this.clone()},d.prototype.fromTwos=function(T){return this.testn(T-1)?this.notn(T).iaddn(1).ineg():this.clone()},d.prototype.isNeg=function(){return this.negative!==0},d.prototype.neg=function(){return this.clone().ineg()},d.prototype.ineg=function(){return this.isZero()||(this.negative^=1),this},d.prototype.iuor=function(T){for(;this.length<T.length;)this.words[this.length++]=0;for(var M=0;M<T.length;M++)this.words[M]=this.words[M]|T.words[M];return this.strip()},d.prototype.ior=function(T){return l((this.negative|T.negative)==0),this.iuor(T)},d.prototype.or=function(T){return this.length>T.length?this.clone().ior(T):T.clone().ior(this)},d.prototype.uor=function(T){return this.length>T.length?this.clone().iuor(T):T.clone().iuor(this)},d.prototype.iuand=function(T){var M;M=this.length>T.length?T:this;for(var S=0;S<M.length;S++)this.words[S]=this.words[S]&T.words[S];return this.length=M.length,this.strip()},d.prototype.iand=function(T){return l((this.negative|T.negative)==0),this.iuand(T)},d.prototype.and=function(T){return this.length>T.length?this.clone().iand(T):T.clone().iand(this)},d.prototype.uand=function(T){return this.length>T.length?this.clone().iuand(T):T.clone().iuand(this)},d.prototype.iuxor=function(T){var M,S;this.length>T.length?(M=this,S=T):(M=T,S=this);for(var E=0;E<S.length;E++)this.words[E]=M.words[E]^S.words[E];if(this!==M)for(;E<M.length;E++)this.words[E]=M.words[E];return this.length=M.length,this.strip()},d.prototype.ixor=function(T){return l((this.negative|T.negative)==0),this.iuxor(T)},d.prototype.xor=function(T){return this.length>T.length?this.clone().ixor(T):T.clone().ixor(this)},d.prototype.uxor=function(T){return this.length>T.length?this.clone().iuxor(T):T.clone().iuxor(this)},d.prototype.inotn=function(T){l(typeof T=="number"&&T>=0);var M=0|Math.ceil(T/26),S=T%26;this._expand(M),S>0&&M--;for(var E=0;E<M;E++)this.words[E]=67108863&~this.words[E];return S>0&&(this.words[E]=~this.words[E]&67108863>>26-S),this.strip()},d.prototype.notn=function(T){return this.clone().inotn(T)},d.prototype.setn=function(T,M){l(typeof T=="number"&&T>=0);var S=T/26|0,E=T%26;return this._expand(S+1),this.words[S]=M?this.words[S]|1<<E:this.words[S]&~(1<<E),this.strip()},d.prototype.iadd=function(T){var M,S,E;if(this.negative!==0&&T.negative===0)return this.negative=0,M=this.isub(T),this.negative^=1,this._normSign();if(this.negative===0&&T.negative!==0)return T.negative=0,M=this.isub(T),T.negative=1,M._normSign();this.length>T.length?(S=this,E=T):(S=T,E=this);for(var k=0,O=0;O<E.length;O++)M=(0|S.words[O])+(0|E.words[O])+k,this.words[O]=67108863&M,k=M>>>26;for(;k!==0&&O<S.length;O++)M=(0|S.words[O])+k,this.words[O]=67108863&M,k=M>>>26;if(this.length=S.length,k!==0)this.words[this.length]=k,this.length++;else if(S!==this)for(;O<S.length;O++)this.words[O]=S.words[O];return this},d.prototype.add=function(T){var M;return T.negative!==0&&this.negative===0?(T.negative=0,M=this.sub(T),T.negative^=1,M):T.negative===0&&this.negative!==0?(this.negative=0,M=T.sub(this),this.negative=1,M):this.length>T.length?this.clone().iadd(T):T.clone().iadd(this)},d.prototype.isub=function(T){if(T.negative!==0){T.negative=0;var M=this.iadd(T);return T.negative=1,M._normSign()}if(this.negative!==0)return this.negative=0,this.iadd(T),this.negative=1,this._normSign();var S,E,k=this.cmp(T);if(k===0)return this.negative=0,this.length=1,this.words[0]=0,this;k>0?(S=this,E=T):(S=T,E=this);for(var O=0,x=0;x<E.length;x++)O=(M=(0|S.words[x])-(0|E.words[x])+O)>>26,this.words[x]=67108863&M;for(;O!==0&&x<S.length;x++)O=(M=(0|S.words[x])+O)>>26,this.words[x]=67108863&M;if(O===0&&x<S.length&&S!==this)for(;x<S.length;x++)this.words[x]=S.words[x];return this.length=Math.max(this.length,x),S!==this&&(this.negative=1),this.strip()},d.prototype.sub=function(T){return this.clone().isub(T)};var m=function(T,M,S){var E,k,O,x=T.words,j=M.words,H=S.words,F=0,V=0|x[0],W=8191&V,U=V>>>13,Y=0|x[1],K=8191&Y,D=Y>>>13,L=0|x[2],B=8191&L,z=L>>>13,q=0|x[3],X=8191&q,ee=q>>>13,ye=0|x[4],de=8191&ye,ge=ye>>>13,we=0|x[5],be=8191&we,J=we>>>13,te=0|x[6],ie=8191&te,fe=te>>>13,se=0|x[7],oe=8191&se,G=se>>>13,Z=0|x[8],Q=8191&Z,re=Z>>>13,ne=0|x[9],ue=8191&ne,le=ne>>>13,ve=0|j[0],Se=8191&ve,Oe=ve>>>13,xe=0|j[1],Ce=8191&xe,Le=xe>>>13,Ve=0|j[2],Je=8191&Ve,ft=Ve>>>13,Ct=0|j[3],Ye=8191&Ct,et=Ct>>>13,Te=0|j[4],We=8191&Te,rt=Te>>>13,Rt=0|j[5],ut=8191&Rt,$t=Rt>>>13,Et=0|j[6],nt=8191&Et,Ft=Et>>>13,pe=0|j[7],me=8191&pe,Me=pe>>>13,He=0|j[8],Ae=8191&He,ce=He>>>13,Ee=0|j[9],Re=8191&Ee,Ge=Ee>>>13;S.negative=T.negative^M.negative,S.length=19;var Xe=(F+(E=Math.imul(W,Se))|0)+((8191&(k=(k=Math.imul(W,Oe))+Math.imul(U,Se)|0))<<13)|0;F=((O=Math.imul(U,Oe))+(k>>>13)|0)+(Xe>>>26)|0,Xe&=67108863,E=Math.imul(K,Se),k=(k=Math.imul(K,Oe))+Math.imul(D,Se)|0,O=Math.imul(D,Oe);var qe=(F+(E=E+Math.imul(W,Ce)|0)|0)+((8191&(k=(k=k+Math.imul(W,Le)|0)+Math.imul(U,Ce)|0))<<13)|0;F=((O=O+Math.imul(U,Le)|0)+(k>>>13)|0)+(qe>>>26)|0,qe&=67108863,E=Math.imul(B,Se),k=(k=Math.imul(B,Oe))+Math.imul(z,Se)|0,O=Math.imul(z,Oe),E=E+Math.imul(K,Ce)|0,k=(k=k+Math.imul(K,Le)|0)+Math.imul(D,Ce)|0,O=O+Math.imul(D,Le)|0;var kt=(F+(E=E+Math.imul(W,Je)|0)|0)+((8191&(k=(k=k+Math.imul(W,ft)|0)+Math.imul(U,Je)|0))<<13)|0;F=((O=O+Math.imul(U,ft)|0)+(k>>>13)|0)+(kt>>>26)|0,kt&=67108863,E=Math.imul(X,Se),k=(k=Math.imul(X,Oe))+Math.imul(ee,Se)|0,O=Math.imul(ee,Oe),E=E+Math.imul(B,Ce)|0,k=(k=k+Math.imul(B,Le)|0)+Math.imul(z,Ce)|0,O=O+Math.imul(z,Le)|0,E=E+Math.imul(K,Je)|0,k=(k=k+Math.imul(K,ft)|0)+Math.imul(D,Je)|0,O=O+Math.imul(D,ft)|0;var Ht=(F+(E=E+Math.imul(W,Ye)|0)|0)+((8191&(k=(k=k+Math.imul(W,et)|0)+Math.imul(U,Ye)|0))<<13)|0;F=((O=O+Math.imul(U,et)|0)+(k>>>13)|0)+(Ht>>>26)|0,Ht&=67108863,E=Math.imul(de,Se),k=(k=Math.imul(de,Oe))+Math.imul(ge,Se)|0,O=Math.imul(ge,Oe),E=E+Math.imul(X,Ce)|0,k=(k=k+Math.imul(X,Le)|0)+Math.imul(ee,Ce)|0,O=O+Math.imul(ee,Le)|0,E=E+Math.imul(B,Je)|0,k=(k=k+Math.imul(B,ft)|0)+Math.imul(z,Je)|0,O=O+Math.imul(z,ft)|0,E=E+Math.imul(K,Ye)|0,k=(k=k+Math.imul(K,et)|0)+Math.imul(D,Ye)|0,O=O+Math.imul(D,et)|0;var jt=(F+(E=E+Math.imul(W,We)|0)|0)+((8191&(k=(k=k+Math.imul(W,rt)|0)+Math.imul(U,We)|0))<<13)|0;F=((O=O+Math.imul(U,rt)|0)+(k>>>13)|0)+(jt>>>26)|0,jt&=67108863,E=Math.imul(be,Se),k=(k=Math.imul(be,Oe))+Math.imul(J,Se)|0,O=Math.imul(J,Oe),E=E+Math.imul(de,Ce)|0,k=(k=k+Math.imul(de,Le)|0)+Math.imul(ge,Ce)|0,O=O+Math.imul(ge,Le)|0,E=E+Math.imul(X,Je)|0,k=(k=k+Math.imul(X,ft)|0)+Math.imul(ee,Je)|0,O=O+Math.imul(ee,ft)|0,E=E+Math.imul(B,Ye)|0,k=(k=k+Math.imul(B,et)|0)+Math.imul(z,Ye)|0,O=O+Math.imul(z,et)|0,E=E+Math.imul(K,We)|0,k=(k=k+Math.imul(K,rt)|0)+Math.imul(D,We)|0,O=O+Math.imul(D,rt)|0;var dr=(F+(E=E+Math.imul(W,ut)|0)|0)+((8191&(k=(k=k+Math.imul(W,$t)|0)+Math.imul(U,ut)|0))<<13)|0;F=((O=O+Math.imul(U,$t)|0)+(k>>>13)|0)+(dr>>>26)|0,dr&=67108863,E=Math.imul(ie,Se),k=(k=Math.imul(ie,Oe))+Math.imul(fe,Se)|0,O=Math.imul(fe,Oe),E=E+Math.imul(be,Ce)|0,k=(k=k+Math.imul(be,Le)|0)+Math.imul(J,Ce)|0,O=O+Math.imul(J,Le)|0,E=E+Math.imul(de,Je)|0,k=(k=k+Math.imul(de,ft)|0)+Math.imul(ge,Je)|0,O=O+Math.imul(ge,ft)|0,E=E+Math.imul(X,Ye)|0,k=(k=k+Math.imul(X,et)|0)+Math.imul(ee,Ye)|0,O=O+Math.imul(ee,et)|0,E=E+Math.imul(B,We)|0,k=(k=k+Math.imul(B,rt)|0)+Math.imul(z,We)|0,O=O+Math.imul(z,rt)|0,E=E+Math.imul(K,ut)|0,k=(k=k+Math.imul(K,$t)|0)+Math.imul(D,ut)|0,O=O+Math.imul(D,$t)|0;var vr=(F+(E=E+Math.imul(W,nt)|0)|0)+((8191&(k=(k=k+Math.imul(W,Ft)|0)+Math.imul(U,nt)|0))<<13)|0;F=((O=O+Math.imul(U,Ft)|0)+(k>>>13)|0)+(vr>>>26)|0,vr&=67108863,E=Math.imul(oe,Se),k=(k=Math.imul(oe,Oe))+Math.imul(G,Se)|0,O=Math.imul(G,Oe),E=E+Math.imul(ie,Ce)|0,k=(k=k+Math.imul(ie,Le)|0)+Math.imul(fe,Ce)|0,O=O+Math.imul(fe,Le)|0,E=E+Math.imul(be,Je)|0,k=(k=k+Math.imul(be,ft)|0)+Math.imul(J,Je)|0,O=O+Math.imul(J,ft)|0,E=E+Math.imul(de,Ye)|0,k=(k=k+Math.imul(de,et)|0)+Math.imul(ge,Ye)|0,O=O+Math.imul(ge,et)|0,E=E+Math.imul(X,We)|0,k=(k=k+Math.imul(X,rt)|0)+Math.imul(ee,We)|0,O=O+Math.imul(ee,rt)|0,E=E+Math.imul(B,ut)|0,k=(k=k+Math.imul(B,$t)|0)+Math.imul(z,ut)|0,O=O+Math.imul(z,$t)|0,E=E+Math.imul(K,nt)|0,k=(k=k+Math.imul(K,Ft)|0)+Math.imul(D,nt)|0,O=O+Math.imul(D,Ft)|0;var Ur=(F+(E=E+Math.imul(W,me)|0)|0)+((8191&(k=(k=k+Math.imul(W,Me)|0)+Math.imul(U,me)|0))<<13)|0;F=((O=O+Math.imul(U,Me)|0)+(k>>>13)|0)+(Ur>>>26)|0,Ur&=67108863,E=Math.imul(Q,Se),k=(k=Math.imul(Q,Oe))+Math.imul(re,Se)|0,O=Math.imul(re,Oe),E=E+Math.imul(oe,Ce)|0,k=(k=k+Math.imul(oe,Le)|0)+Math.imul(G,Ce)|0,O=O+Math.imul(G,Le)|0,E=E+Math.imul(ie,Je)|0,k=(k=k+Math.imul(ie,ft)|0)+Math.imul(fe,Je)|0,O=O+Math.imul(fe,ft)|0,E=E+Math.imul(be,Ye)|0,k=(k=k+Math.imul(be,et)|0)+Math.imul(J,Ye)|0,O=O+Math.imul(J,et)|0,E=E+Math.imul(de,We)|0,k=(k=k+Math.imul(de,rt)|0)+Math.imul(ge,We)|0,O=O+Math.imul(ge,rt)|0,E=E+Math.imul(X,ut)|0,k=(k=k+Math.imul(X,$t)|0)+Math.imul(ee,ut)|0,O=O+Math.imul(ee,$t)|0,E=E+Math.imul(B,nt)|0,k=(k=k+Math.imul(B,Ft)|0)+Math.imul(z,nt)|0,O=O+Math.imul(z,Ft)|0,E=E+Math.imul(K,me)|0,k=(k=k+Math.imul(K,Me)|0)+Math.imul(D,me)|0,O=O+Math.imul(D,Me)|0;var ae=(F+(E=E+Math.imul(W,Ae)|0)|0)+((8191&(k=(k=k+Math.imul(W,ce)|0)+Math.imul(U,Ae)|0))<<13)|0;F=((O=O+Math.imul(U,ce)|0)+(k>>>13)|0)+(ae>>>26)|0,ae&=67108863,E=Math.imul(ue,Se),k=(k=Math.imul(ue,Oe))+Math.imul(le,Se)|0,O=Math.imul(le,Oe),E=E+Math.imul(Q,Ce)|0,k=(k=k+Math.imul(Q,Le)|0)+Math.imul(re,Ce)|0,O=O+Math.imul(re,Le)|0,E=E+Math.imul(oe,Je)|0,k=(k=k+Math.imul(oe,ft)|0)+Math.imul(G,Je)|0,O=O+Math.imul(G,ft)|0,E=E+Math.imul(ie,Ye)|0,k=(k=k+Math.imul(ie,et)|0)+Math.imul(fe,Ye)|0,O=O+Math.imul(fe,et)|0,E=E+Math.imul(be,We)|0,k=(k=k+Math.imul(be,rt)|0)+Math.imul(J,We)|0,O=O+Math.imul(J,rt)|0,E=E+Math.imul(de,ut)|0,k=(k=k+Math.imul(de,$t)|0)+Math.imul(ge,ut)|0,O=O+Math.imul(ge,$t)|0,E=E+Math.imul(X,nt)|0,k=(k=k+Math.imul(X,Ft)|0)+Math.imul(ee,nt)|0,O=O+Math.imul(ee,Ft)|0,E=E+Math.imul(B,me)|0,k=(k=k+Math.imul(B,Me)|0)+Math.imul(z,me)|0,O=O+Math.imul(z,Me)|0,E=E+Math.imul(K,Ae)|0,k=(k=k+Math.imul(K,ce)|0)+Math.imul(D,Ae)|0,O=O+Math.imul(D,ce)|0;var _e=(F+(E=E+Math.imul(W,Re)|0)|0)+((8191&(k=(k=k+Math.imul(W,Ge)|0)+Math.imul(U,Re)|0))<<13)|0;F=((O=O+Math.imul(U,Ge)|0)+(k>>>13)|0)+(_e>>>26)|0,_e&=67108863,E=Math.imul(ue,Ce),k=(k=Math.imul(ue,Le))+Math.imul(le,Ce)|0,O=Math.imul(le,Le),E=E+Math.imul(Q,Je)|0,k=(k=k+Math.imul(Q,ft)|0)+Math.imul(re,Je)|0,O=O+Math.imul(re,ft)|0,E=E+Math.imul(oe,Ye)|0,k=(k=k+Math.imul(oe,et)|0)+Math.imul(G,Ye)|0,O=O+Math.imul(G,et)|0,E=E+Math.imul(ie,We)|0,k=(k=k+Math.imul(ie,rt)|0)+Math.imul(fe,We)|0,O=O+Math.imul(fe,rt)|0,E=E+Math.imul(be,ut)|0,k=(k=k+Math.imul(be,$t)|0)+Math.imul(J,ut)|0,O=O+Math.imul(J,$t)|0,E=E+Math.imul(de,nt)|0,k=(k=k+Math.imul(de,Ft)|0)+Math.imul(ge,nt)|0,O=O+Math.imul(ge,Ft)|0,E=E+Math.imul(X,me)|0,k=(k=k+Math.imul(X,Me)|0)+Math.imul(ee,me)|0,O=O+Math.imul(ee,Me)|0,E=E+Math.imul(B,Ae)|0,k=(k=k+Math.imul(B,ce)|0)+Math.imul(z,Ae)|0,O=O+Math.imul(z,ce)|0;var Pe=(F+(E=E+Math.imul(K,Re)|0)|0)+((8191&(k=(k=k+Math.imul(K,Ge)|0)+Math.imul(D,Re)|0))<<13)|0;F=((O=O+Math.imul(D,Ge)|0)+(k>>>13)|0)+(Pe>>>26)|0,Pe&=67108863,E=Math.imul(ue,Je),k=(k=Math.imul(ue,ft))+Math.imul(le,Je)|0,O=Math.imul(le,ft),E=E+Math.imul(Q,Ye)|0,k=(k=k+Math.imul(Q,et)|0)+Math.imul(re,Ye)|0,O=O+Math.imul(re,et)|0,E=E+Math.imul(oe,We)|0,k=(k=k+Math.imul(oe,rt)|0)+Math.imul(G,We)|0,O=O+Math.imul(G,rt)|0,E=E+Math.imul(ie,ut)|0,k=(k=k+Math.imul(ie,$t)|0)+Math.imul(fe,ut)|0,O=O+Math.imul(fe,$t)|0,E=E+Math.imul(be,nt)|0,k=(k=k+Math.imul(be,Ft)|0)+Math.imul(J,nt)|0,O=O+Math.imul(J,Ft)|0,E=E+Math.imul(de,me)|0,k=(k=k+Math.imul(de,Me)|0)+Math.imul(ge,me)|0,O=O+Math.imul(ge,Me)|0,E=E+Math.imul(X,Ae)|0,k=(k=k+Math.imul(X,ce)|0)+Math.imul(ee,Ae)|0,O=O+Math.imul(ee,ce)|0;var Ne=(F+(E=E+Math.imul(B,Re)|0)|0)+((8191&(k=(k=k+Math.imul(B,Ge)|0)+Math.imul(z,Re)|0))<<13)|0;F=((O=O+Math.imul(z,Ge)|0)+(k>>>13)|0)+(Ne>>>26)|0,Ne&=67108863,E=Math.imul(ue,Ye),k=(k=Math.imul(ue,et))+Math.imul(le,Ye)|0,O=Math.imul(le,et),E=E+Math.imul(Q,We)|0,k=(k=k+Math.imul(Q,rt)|0)+Math.imul(re,We)|0,O=O+Math.imul(re,rt)|0,E=E+Math.imul(oe,ut)|0,k=(k=k+Math.imul(oe,$t)|0)+Math.imul(G,ut)|0,O=O+Math.imul(G,$t)|0,E=E+Math.imul(ie,nt)|0,k=(k=k+Math.imul(ie,Ft)|0)+Math.imul(fe,nt)|0,O=O+Math.imul(fe,Ft)|0,E=E+Math.imul(be,me)|0,k=(k=k+Math.imul(be,Me)|0)+Math.imul(J,me)|0,O=O+Math.imul(J,Me)|0,E=E+Math.imul(de,Ae)|0,k=(k=k+Math.imul(de,ce)|0)+Math.imul(ge,Ae)|0,O=O+Math.imul(ge,ce)|0;var tt=(F+(E=E+Math.imul(X,Re)|0)|0)+((8191&(k=(k=k+Math.imul(X,Ge)|0)+Math.imul(ee,Re)|0))<<13)|0;F=((O=O+Math.imul(ee,Ge)|0)+(k>>>13)|0)+(tt>>>26)|0,tt&=67108863,E=Math.imul(ue,We),k=(k=Math.imul(ue,rt))+Math.imul(le,We)|0,O=Math.imul(le,rt),E=E+Math.imul(Q,ut)|0,k=(k=k+Math.imul(Q,$t)|0)+Math.imul(re,ut)|0,O=O+Math.imul(re,$t)|0,E=E+Math.imul(oe,nt)|0,k=(k=k+Math.imul(oe,Ft)|0)+Math.imul(G,nt)|0,O=O+Math.imul(G,Ft)|0,E=E+Math.imul(ie,me)|0,k=(k=k+Math.imul(ie,Me)|0)+Math.imul(fe,me)|0,O=O+Math.imul(fe,Me)|0,E=E+Math.imul(be,Ae)|0,k=(k=k+Math.imul(be,ce)|0)+Math.imul(J,Ae)|0,O=O+Math.imul(J,ce)|0;var je=(F+(E=E+Math.imul(de,Re)|0)|0)+((8191&(k=(k=k+Math.imul(de,Ge)|0)+Math.imul(ge,Re)|0))<<13)|0;F=((O=O+Math.imul(ge,Ge)|0)+(k>>>13)|0)+(je>>>26)|0,je&=67108863,E=Math.imul(ue,ut),k=(k=Math.imul(ue,$t))+Math.imul(le,ut)|0,O=Math.imul(le,$t),E=E+Math.imul(Q,nt)|0,k=(k=k+Math.imul(Q,Ft)|0)+Math.imul(re,nt)|0,O=O+Math.imul(re,Ft)|0,E=E+Math.imul(oe,me)|0,k=(k=k+Math.imul(oe,Me)|0)+Math.imul(G,me)|0,O=O+Math.imul(G,Me)|0,E=E+Math.imul(ie,Ae)|0,k=(k=k+Math.imul(ie,ce)|0)+Math.imul(fe,Ae)|0,O=O+Math.imul(fe,ce)|0;var Fe=(F+(E=E+Math.imul(be,Re)|0)|0)+((8191&(k=(k=k+Math.imul(be,Ge)|0)+Math.imul(J,Re)|0))<<13)|0;F=((O=O+Math.imul(J,Ge)|0)+(k>>>13)|0)+(Fe>>>26)|0,Fe&=67108863,E=Math.imul(ue,nt),k=(k=Math.imul(ue,Ft))+Math.imul(le,nt)|0,O=Math.imul(le,Ft),E=E+Math.imul(Q,me)|0,k=(k=k+Math.imul(Q,Me)|0)+Math.imul(re,me)|0,O=O+Math.imul(re,Me)|0,E=E+Math.imul(oe,Ae)|0,k=(k=k+Math.imul(oe,ce)|0)+Math.imul(G,Ae)|0,O=O+Math.imul(G,ce)|0;var _t=(F+(E=E+Math.imul(ie,Re)|0)|0)+((8191&(k=(k=k+Math.imul(ie,Ge)|0)+Math.imul(fe,Re)|0))<<13)|0;F=((O=O+Math.imul(fe,Ge)|0)+(k>>>13)|0)+(_t>>>26)|0,_t&=67108863,E=Math.imul(ue,me),k=(k=Math.imul(ue,Me))+Math.imul(le,me)|0,O=Math.imul(le,Me),E=E+Math.imul(Q,Ae)|0,k=(k=k+Math.imul(Q,ce)|0)+Math.imul(re,Ae)|0,O=O+Math.imul(re,ce)|0;var gt=(F+(E=E+Math.imul(oe,Re)|0)|0)+((8191&(k=(k=k+Math.imul(oe,Ge)|0)+Math.imul(G,Re)|0))<<13)|0;F=((O=O+Math.imul(G,Ge)|0)+(k>>>13)|0)+(gt>>>26)|0,gt&=67108863,E=Math.imul(ue,Ae),k=(k=Math.imul(ue,ce))+Math.imul(le,Ae)|0,O=Math.imul(le,ce);var mt=(F+(E=E+Math.imul(Q,Re)|0)|0)+((8191&(k=(k=k+Math.imul(Q,Ge)|0)+Math.imul(re,Re)|0))<<13)|0;F=((O=O+Math.imul(re,Ge)|0)+(k>>>13)|0)+(mt>>>26)|0,mt&=67108863;var st=(F+(E=Math.imul(ue,Re))|0)+((8191&(k=(k=Math.imul(ue,Ge))+Math.imul(le,Re)|0))<<13)|0;return F=((O=Math.imul(le,Ge))+(k>>>13)|0)+(st>>>26)|0,st&=67108863,H[0]=Xe,H[1]=qe,H[2]=kt,H[3]=Ht,H[4]=jt,H[5]=dr,H[6]=vr,H[7]=Ur,H[8]=ae,H[9]=_e,H[10]=Pe,H[11]=Ne,H[12]=tt,H[13]=je,H[14]=Fe,H[15]=_t,H[16]=gt,H[17]=mt,H[18]=st,F!==0&&(H[19]=F,S.length++),S};function b(T,M,S){return new w().mulp(T,M,S)}function w(T,M){this.x=T,this.y=M}Math.imul||(m=v),d.prototype.mulTo=function(T,M){var S=this.length+T.length;return this.length===10&&T.length===10?m(this,T,M):S<63?v(this,T,M):S<1024?function(E,k,O){O.negative=k.negative^E.negative,O.length=E.length+k.length;for(var x=0,j=0,H=0;H<O.length-1;H++){var F=j;j=0;for(var V=67108863&x,W=Math.min(H,k.length-1),U=Math.max(0,H-E.length+1);U<=W;U++){var Y=H-U,K=(0|E.words[Y])*(0|k.words[U]),D=67108863&K;V=67108863&(D=D+V|0),j+=(F=(F=F+(K/67108864|0)|0)+(D>>>26)|0)>>>26,F&=67108863}O.words[H]=V,x=F,F=j}return x!==0?O.words[H]=x:O.length--,O.strip()}(this,T,M):b(this,T,M)},w.prototype.makeRBT=function(T){for(var M=new Array(T),S=d.prototype._countBits(T)-1,E=0;E<T;E++)M[E]=this.revBin(E,S,T);return M},w.prototype.revBin=function(T,M,S){if(T===0||T===S-1)return T;for(var E=0,k=0;k<M;k++)E|=(1&T)<<M-k-1,T>>=1;return E},w.prototype.permute=function(T,M,S,E,k,O){for(var x=0;x<O;x++)E[x]=M[T[x]],k[x]=S[T[x]]},w.prototype.transform=function(T,M,S,E,k,O){this.permute(O,T,M,S,E,k);for(var x=1;x<k;x<<=1)for(var j=x<<1,H=Math.cos(2*Math.PI/j),F=Math.sin(2*Math.PI/j),V=0;V<k;V+=j)for(var W=H,U=F,Y=0;Y<x;Y++){var K=S[V+Y],D=E[V+Y],L=S[V+Y+x],B=E[V+Y+x],z=W*L-U*B;B=W*B+U*L,L=z,S[V+Y]=K+L,E[V+Y]=D+B,S[V+Y+x]=K-L,E[V+Y+x]=D-B,Y!==j&&(z=H*W-F*U,U=H*U+F*W,W=z)}},w.prototype.guessLen13b=function(T,M){var S=1|Math.max(M,T),E=1&S,k=0;for(S=S/2|0;S;S>>>=1)k++;return 1<<k+1+E},w.prototype.conjugate=function(T,M,S){if(!(S<=1))for(var E=0;E<S/2;E++){var k=T[E];T[E]=T[S-E-1],T[S-E-1]=k,k=M[E],M[E]=-M[S-E-1],M[S-E-1]=-k}},w.prototype.normalize13b=function(T,M){for(var S=0,E=0;E<M/2;E++){var k=8192*Math.round(T[2*E+1]/M)+Math.round(T[2*E]/M)+S;T[E]=67108863&k,S=k<67108864?0:k/67108864|0}return T},w.prototype.convert13b=function(T,M,S,E){for(var k=0,O=0;O<M;O++)k+=0|T[O],S[2*O]=8191&k,k>>>=13,S[2*O+1]=8191&k,k>>>=13;for(O=2*M;O<E;++O)S[O]=0;l(k===0),l((-8192&k)==0)},w.prototype.stub=function(T){for(var M=new Array(T),S=0;S<T;S++)M[S]=0;return M},w.prototype.mulp=function(T,M,S){var E=2*this.guessLen13b(T.length,M.length),k=this.makeRBT(E),O=this.stub(E),x=new Array(E),j=new Array(E),H=new Array(E),F=new Array(E),V=new Array(E),W=new Array(E),U=S.words;U.length=E,this.convert13b(T.words,T.length,x,E),this.convert13b(M.words,M.length,F,E),this.transform(x,O,j,H,E,k),this.transform(F,O,V,W,E,k);for(var Y=0;Y<E;Y++){var K=j[Y]*V[Y]-H[Y]*W[Y];H[Y]=j[Y]*W[Y]+H[Y]*V[Y],j[Y]=K}return this.conjugate(j,H,E),this.transform(j,H,U,O,E,k),this.conjugate(U,O,E),this.normalize13b(U,E),S.negative=T.negative^M.negative,S.length=T.length+M.length,S.strip()},d.prototype.mul=function(T){var M=new d(null);return M.words=new Array(this.length+T.length),this.mulTo(T,M)},d.prototype.mulf=function(T){var M=new d(null);return M.words=new Array(this.length+T.length),b(this,T,M)},d.prototype.imul=function(T){return this.clone().mulTo(T,this)},d.prototype.imuln=function(T){l(typeof T=="number"),l(T<67108864);for(var M=0,S=0;S<this.length;S++){var E=(0|this.words[S])*T,k=(67108863&E)+(67108863&M);M>>=26,M+=E/67108864|0,M+=k>>>26,this.words[S]=67108863&k}return M!==0&&(this.words[S]=M,this.length++),this},d.prototype.muln=function(T){return this.clone().imuln(T)},d.prototype.sqr=function(){return this.mul(this)},d.prototype.isqr=function(){return this.imul(this.clone())},d.prototype.pow=function(T){var M=function(O){for(var x=new Array(O.bitLength()),j=0;j<x.length;j++){var H=j/26|0,F=j%26;x[j]=(O.words[H]&1<<F)>>>F}return x}(T);if(M.length===0)return new d(1);for(var S=this,E=0;E<M.length&&M[E]===0;E++,S=S.sqr());if(++E<M.length)for(var k=S.sqr();E<M.length;E++,k=k.sqr())M[E]!==0&&(S=S.mul(k));return S},d.prototype.iushln=function(T){l(typeof T=="number"&&T>=0);var M,S=T%26,E=(T-S)/26,k=67108863>>>26-S<<26-S;if(S!==0){var O=0;for(M=0;M<this.length;M++){var x=this.words[M]&k,j=(0|this.words[M])-x<<S;this.words[M]=j|O,O=x>>>26-S}O&&(this.words[M]=O,this.length++)}if(E!==0){for(M=this.length-1;M>=0;M--)this.words[M+E]=this.words[M];for(M=0;M<E;M++)this.words[M]=0;this.length+=E}return this.strip()},d.prototype.ishln=function(T){return l(this.negative===0),this.iushln(T)},d.prototype.iushrn=function(T,M,S){var E;l(typeof T=="number"&&T>=0),E=M?(M-M%26)/26:0;var k=T%26,O=Math.min((T-k)/26,this.length),x=67108863^67108863>>>k<<k,j=S;if(E-=O,E=Math.max(0,E),j){for(var H=0;H<O;H++)j.words[H]=this.words[H];j.length=O}if(O!==0)if(this.length>O)for(this.length-=O,H=0;H<this.length;H++)this.words[H]=this.words[H+O];else this.words[0]=0,this.length=1;var F=0;for(H=this.length-1;H>=0&&(F!==0||H>=E);H--){var V=0|this.words[H];this.words[H]=F<<26-k|V>>>k,F=V&x}return j&&F!==0&&(j.words[j.length++]=F),this.length===0&&(this.words[0]=0,this.length=1),this.strip()},d.prototype.ishrn=function(T,M,S){return l(this.negative===0),this.iushrn(T,M,S)},d.prototype.shln=function(T){return this.clone().ishln(T)},d.prototype.ushln=function(T){return this.clone().iushln(T)},d.prototype.shrn=function(T){return this.clone().ishrn(T)},d.prototype.ushrn=function(T){return this.clone().iushrn(T)},d.prototype.testn=function(T){l(typeof T=="number"&&T>=0);var M=T%26,S=(T-M)/26,E=1<<M;return!(this.length<=S)&&!!(this.words[S]&E)},d.prototype.imaskn=function(T){l(typeof T=="number"&&T>=0);var M=T%26,S=(T-M)/26;if(l(this.negative===0,"imaskn works only with positive numbers"),this.length<=S)return this;if(M!==0&&S++,this.length=Math.min(S,this.length),M!==0){var E=67108863^67108863>>>M<<M;this.words[this.length-1]&=E}return this.strip()},d.prototype.maskn=function(T){return this.clone().imaskn(T)},d.prototype.iaddn=function(T){return l(typeof T=="number"),l(T<67108864),T<0?this.isubn(-T):this.negative!==0?this.length===1&&(0|this.words[0])<T?(this.words[0]=T-(0|this.words[0]),this.negative=0,this):(this.negative=0,this.isubn(T),this.negative=1,this):this._iaddn(T)},d.prototype._iaddn=function(T){this.words[0]+=T;for(var M=0;M<this.length&&this.words[M]>=67108864;M++)this.words[M]-=67108864,M===this.length-1?this.words[M+1]=1:this.words[M+1]++;return this.length=Math.max(this.length,M+1),this},d.prototype.isubn=function(T){if(l(typeof T=="number"),l(T<67108864),T<0)return this.iaddn(-T);if(this.negative!==0)return this.negative=0,this.iaddn(T),this.negative=1,this;if(this.words[0]-=T,this.length===1&&this.words[0]<0)this.words[0]=-this.words[0],this.negative=1;else for(var M=0;M<this.length&&this.words[M]<0;M++)this.words[M]+=67108864,this.words[M+1]-=1;return this.strip()},d.prototype.addn=function(T){return this.clone().iaddn(T)},d.prototype.subn=function(T){return this.clone().isubn(T)},d.prototype.iabs=function(){return this.negative=0,this},d.prototype.abs=function(){return this.clone().iabs()},d.prototype._ishlnsubmul=function(T,M,S){var E,k,O=T.length+S;this._expand(O);var x=0;for(E=0;E<T.length;E++){k=(0|this.words[E+S])+x;var j=(0|T.words[E])*M;x=((k-=67108863&j)>>26)-(j/67108864|0),this.words[E+S]=67108863&k}for(;E<this.length-S;E++)x=(k=(0|this.words[E+S])+x)>>26,this.words[E+S]=67108863&k;if(x===0)return this.strip();for(l(x===-1),x=0,E=0;E<this.length;E++)x=(k=-(0|this.words[E])+x)>>26,this.words[E]=67108863&k;return this.negative=1,this.strip()},d.prototype._wordDiv=function(T,M){var S=(this.length,T.length),E=this.clone(),k=T,O=0|k.words[k.length-1];(S=26-this._countBits(O))!=0&&(k=k.ushln(S),E.iushln(S),O=0|k.words[k.length-1]);var x,j=E.length-k.length;if(M!=="mod"){(x=new d(null)).length=j+1,x.words=new Array(x.length);for(var H=0;H<x.length;H++)x.words[H]=0}var F=E.clone()._ishlnsubmul(k,1,j);F.negative===0&&(E=F,x&&(x.words[j]=1));for(var V=j-1;V>=0;V--){var W=67108864*(0|E.words[k.length+V])+(0|E.words[k.length+V-1]);for(W=Math.min(W/O|0,67108863),E._ishlnsubmul(k,W,V);E.negative!==0;)W--,E.negative=0,E._ishlnsubmul(k,1,V),E.isZero()||(E.negative^=1);x&&(x.words[V]=W)}return x&&x.strip(),E.strip(),M!=="div"&&S!==0&&E.iushrn(S),{div:x||null,mod:E}},d.prototype.divmod=function(T,M,S){return l(!T.isZero()),this.isZero()?{div:new d(0),mod:new d(0)}:this.negative!==0&&T.negative===0?(O=this.neg().divmod(T,M),M!=="mod"&&(E=O.div.neg()),M!=="div"&&(k=O.mod.neg(),S&&k.negative!==0&&k.iadd(T)),{div:E,mod:k}):this.negative===0&&T.negative!==0?(O=this.divmod(T.neg(),M),M!=="mod"&&(E=O.div.neg()),{div:E,mod:O.mod}):(this.negative&T.negative)!=0?(O=this.neg().divmod(T.neg(),M),M!=="div"&&(k=O.mod.neg(),S&&k.negative!==0&&k.isub(T)),{div:O.div,mod:k}):T.length>this.length||this.cmp(T)<0?{div:new d(0),mod:this}:T.length===1?M==="div"?{div:this.divn(T.words[0]),mod:null}:M==="mod"?{div:null,mod:new d(this.modn(T.words[0]))}:{div:this.divn(T.words[0]),mod:new d(this.modn(T.words[0]))}:this._wordDiv(T,M);var E,k,O},d.prototype.div=function(T){return this.divmod(T,"div",!1).div},d.prototype.mod=function(T){return this.divmod(T,"mod",!1).mod},d.prototype.umod=function(T){return this.divmod(T,"mod",!0).mod},d.prototype.divRound=function(T){var M=this.divmod(T);if(M.mod.isZero())return M.div;var S=M.div.negative!==0?M.mod.isub(T):M.mod,E=T.ushrn(1),k=T.andln(1),O=S.cmp(E);return O<0||k===1&&O===0?M.div:M.div.negative!==0?M.div.isubn(1):M.div.iaddn(1)},d.prototype.modn=function(T){l(T<=67108863);for(var M=(1<<26)%T,S=0,E=this.length-1;E>=0;E--)S=(M*S+(0|this.words[E]))%T;return S},d.prototype.idivn=function(T){l(T<=67108863);for(var M=0,S=this.length-1;S>=0;S--){var E=(0|this.words[S])+67108864*M;this.words[S]=E/T|0,M=E%T}return this.strip()},d.prototype.divn=function(T){return this.clone().idivn(T)},d.prototype.egcd=function(T){l(T.negative===0),l(!T.isZero());var M=this,S=T.clone();M=M.negative!==0?M.umod(T):M.clone();for(var E=new d(1),k=new d(0),O=new d(0),x=new d(1),j=0;M.isEven()&&S.isEven();)M.iushrn(1),S.iushrn(1),++j;for(var H=S.clone(),F=M.clone();!M.isZero();){for(var V=0,W=1;(M.words[0]&W)==0&&V<26;++V,W<<=1);if(V>0)for(M.iushrn(V);V-- >0;)(E.isOdd()||k.isOdd())&&(E.iadd(H),k.isub(F)),E.iushrn(1),k.iushrn(1);for(var U=0,Y=1;(S.words[0]&Y)==0&&U<26;++U,Y<<=1);if(U>0)for(S.iushrn(U);U-- >0;)(O.isOdd()||x.isOdd())&&(O.iadd(H),x.isub(F)),O.iushrn(1),x.iushrn(1);M.cmp(S)>=0?(M.isub(S),E.isub(O),k.isub(x)):(S.isub(M),O.isub(E),x.isub(k))}return{a:O,b:x,gcd:S.iushln(j)}},d.prototype._invmp=function(T){l(T.negative===0),l(!T.isZero());var M=this,S=T.clone();M=M.negative!==0?M.umod(T):M.clone();for(var E,k=new d(1),O=new d(0),x=S.clone();M.cmpn(1)>0&&S.cmpn(1)>0;){for(var j=0,H=1;(M.words[0]&H)==0&&j<26;++j,H<<=1);if(j>0)for(M.iushrn(j);j-- >0;)k.isOdd()&&k.iadd(x),k.iushrn(1);for(var F=0,V=1;(S.words[0]&V)==0&&F<26;++F,V<<=1);if(F>0)for(S.iushrn(F);F-- >0;)O.isOdd()&&O.iadd(x),O.iushrn(1);M.cmp(S)>=0?(M.isub(S),k.isub(O)):(S.isub(M),O.isub(k))}return(E=M.cmpn(1)===0?k:O).cmpn(0)<0&&E.iadd(T),E},d.prototype.gcd=function(T){if(this.isZero())return T.abs();if(T.isZero())return this.abs();var M=this.clone(),S=T.clone();M.negative=0,S.negative=0;for(var E=0;M.isEven()&&S.isEven();E++)M.iushrn(1),S.iushrn(1);for(;;){for(;M.isEven();)M.iushrn(1);for(;S.isEven();)S.iushrn(1);var k=M.cmp(S);if(k<0){var O=M;M=S,S=O}else if(k===0||S.cmpn(1)===0)break;M.isub(S)}return S.iushln(E)},d.prototype.invm=function(T){return this.egcd(T).a.umod(T)},d.prototype.isEven=function(){return(1&this.words[0])==0},d.prototype.isOdd=function(){return(1&this.words[0])==1},d.prototype.andln=function(T){return this.words[0]&T},d.prototype.bincn=function(T){l(typeof T=="number");var M=T%26,S=(T-M)/26,E=1<<M;if(this.length<=S)return this._expand(S+1),this.words[S]|=E,this;for(var k=E,O=S;k!==0&&O<this.length;O++){var x=0|this.words[O];k=(x+=k)>>>26,x&=67108863,this.words[O]=x}return k!==0&&(this.words[O]=k,this.length++),this},d.prototype.isZero=function(){return this.length===1&&this.words[0]===0},d.prototype.cmpn=function(T){var M,S=T<0;if(this.negative!==0&&!S)return-1;if(this.negative===0&&S)return 1;if(this.strip(),this.length>1)M=1;else{S&&(T=-T),l(T<=67108863,"Number is too big");var E=0|this.words[0];M=E===T?0:E<T?-1:1}return this.negative!==0?0|-M:M},d.prototype.cmp=function(T){if(this.negative!==0&&T.negative===0)return-1;if(this.negative===0&&T.negative!==0)return 1;var M=this.ucmp(T);return this.negative!==0?0|-M:M},d.prototype.ucmp=function(T){if(this.length>T.length)return 1;if(this.length<T.length)return-1;for(var M=0,S=this.length-1;S>=0;S--){var E=0|this.words[S],k=0|T.words[S];if(E!==k){E<k?M=-1:E>k&&(M=1);break}}return M},d.prototype.gtn=function(T){return this.cmpn(T)===1},d.prototype.gt=function(T){return this.cmp(T)===1},d.prototype.gten=function(T){return this.cmpn(T)>=0},d.prototype.gte=function(T){return this.cmp(T)>=0},d.prototype.ltn=function(T){return this.cmpn(T)===-1},d.prototype.lt=function(T){return this.cmp(T)===-1},d.prototype.lten=function(T){return this.cmpn(T)<=0},d.prototype.lte=function(T){return this.cmp(T)<=0},d.prototype.eqn=function(T){return this.cmpn(T)===0},d.prototype.eq=function(T){return this.cmp(T)===0},d.red=function(T){return new A(T)},d.prototype.toRed=function(T){return l(!this.red,"Already a number in reduction context"),l(this.negative===0,"red works only with positives"),T.convertTo(this)._forceRed(T)},d.prototype.fromRed=function(){return l(this.red,"fromRed works only with numbers in reduction context"),this.red.convertFrom(this)},d.prototype._forceRed=function(T){return this.red=T,this},d.prototype.forceRed=function(T){return l(!this.red,"Already a number in reduction context"),this._forceRed(T)},d.prototype.redAdd=function(T){return l(this.red,"redAdd works only with red numbers"),this.red.add(this,T)},d.prototype.redIAdd=function(T){return l(this.red,"redIAdd works only with red numbers"),this.red.iadd(this,T)},d.prototype.redSub=function(T){return l(this.red,"redSub works only with red numbers"),this.red.sub(this,T)},d.prototype.redISub=function(T){return l(this.red,"redISub works only with red numbers"),this.red.isub(this,T)},d.prototype.redShl=function(T){return l(this.red,"redShl works only with red numbers"),this.red.shl(this,T)},d.prototype.redMul=function(T){return l(this.red,"redMul works only with red numbers"),this.red._verify2(this,T),this.red.mul(this,T)},d.prototype.redIMul=function(T){return l(this.red,"redMul works only with red numbers"),this.red._verify2(this,T),this.red.imul(this,T)},d.prototype.redSqr=function(){return l(this.red,"redSqr works only with red numbers"),this.red._verify1(this),this.red.sqr(this)},d.prototype.redISqr=function(){return l(this.red,"redISqr works only with red numbers"),this.red._verify1(this),this.red.isqr(this)},d.prototype.redSqrt=function(){return l(this.red,"redSqrt works only with red numbers"),this.red._verify1(this),this.red.sqrt(this)},d.prototype.redInvm=function(){return l(this.red,"redInvm works only with red numbers"),this.red._verify1(this),this.red.invm(this)},d.prototype.redNeg=function(){return l(this.red,"redNeg works only with red numbers"),this.red._verify1(this),this.red.neg(this)},d.prototype.redPow=function(T){return l(this.red&&!T.red,"redPow(normalNum)"),this.red._verify1(this),this.red.pow(this,T)};var _={k256:null,p224:null,p192:null,p25519:null};function C(T,M){this.name=T,this.p=new d(M,16),this.n=this.p.bitLength(),this.k=new d(1).iushln(this.n).isub(this.p),this.tmp=this._tmp()}function R(){C.call(this,"k256","ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe fffffc2f")}function I(){C.call(this,"p224","ffffffff ffffffff ffffffff ffffffff 00000000 00000000 00000001")}function P(){C.call(this,"p192","ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff")}function N(){C.call(this,"25519","7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed")}function A(T){if(typeof T=="string"){var M=d._prime(T);this.m=M.p,this.prime=M}else l(T.gtn(1),"modulus must be greater than 1"),this.m=T,this.prime=null}function $(T){A.call(this,T),this.shift=this.m.bitLength(),this.shift%26!=0&&(this.shift+=26-this.shift%26),this.r=new d(1).iushln(this.shift),this.r2=this.imod(this.r.sqr()),this.rinv=this.r._invmp(this.m),this.minv=this.rinv.mul(this.r).isubn(1).div(this.m),this.minv=this.minv.umod(this.r),this.minv=this.r.sub(this.minv)}C.prototype._tmp=function(){var T=new d(null);return T.words=new Array(Math.ceil(this.n/13)),T},C.prototype.ireduce=function(T){var M,S=T;do this.split(S,this.tmp),M=(S=(S=this.imulK(S)).iadd(this.tmp)).bitLength();while(M>this.n);var E=M<this.n?-1:S.ucmp(this.p);return E===0?(S.words[0]=0,S.length=1):E>0?S.isub(this.p):S.strip!==void 0?S.strip():S._strip(),S},C.prototype.split=function(T,M){T.iushrn(this.n,0,M)},C.prototype.imulK=function(T){return T.imul(this.k)},p(R,C),R.prototype.split=function(T,M){for(var S=Math.min(T.length,9),E=0;E<S;E++)M.words[E]=T.words[E];if(M.length=S,T.length<=9)return T.words[0]=0,void(T.length=1);var k=T.words[9];for(M.words[M.length++]=4194303&k,E=10;E<T.length;E++){var O=0|T.words[E];T.words[E-10]=(4194303&O)<<4|k>>>22,k=O}k>>>=22,T.words[E-10]=k,k===0&&T.length>10?T.length-=10:T.length-=9},R.prototype.imulK=function(T){T.words[T.length]=0,T.words[T.length+1]=0,T.length+=2;for(var M=0,S=0;S<T.length;S++){var E=0|T.words[S];M+=977*E,T.words[S]=67108863&M,M=64*E+(M/67108864|0)}return T.words[T.length-1]===0&&(T.length--,T.words[T.length-1]===0&&T.length--),T},p(I,C),p(P,C),p(N,C),N.prototype.imulK=function(T){for(var M=0,S=0;S<T.length;S++){var E=19*(0|T.words[S])+M,k=67108863&E;E>>>=26,T.words[S]=k,M=E}return M!==0&&(T.words[T.length++]=M),T},d._prime=function(T){if(_[T])return _[T];var M;if(T==="k256")M=new R;else if(T==="p224")M=new I;else if(T==="p192")M=new P;else{if(T!=="p25519")throw new Error("Unknown prime "+T);M=new N}return _[T]=M,M},A.prototype._verify1=function(T){l(T.negative===0,"red works only with positives"),l(T.red,"red works only with red numbers")},A.prototype._verify2=function(T,M){l((T.negative|M.negative)==0,"red works only with positives"),l(T.red&&T.red===M.red,"red works only with red numbers")},A.prototype.imod=function(T){return this.prime?this.prime.ireduce(T)._forceRed(this):T.umod(this.m)._forceRed(this)},A.prototype.neg=function(T){return T.isZero()?T.clone():this.m.sub(T)._forceRed(this)},A.prototype.add=function(T,M){this._verify2(T,M);var S=T.add(M);return S.cmp(this.m)>=0&&S.isub(this.m),S._forceRed(this)},A.prototype.iadd=function(T,M){this._verify2(T,M);var S=T.iadd(M);return S.cmp(this.m)>=0&&S.isub(this.m),S},A.prototype.sub=function(T,M){this._verify2(T,M);var S=T.sub(M);return S.cmpn(0)<0&&S.iadd(this.m),S._forceRed(this)},A.prototype.isub=function(T,M){this._verify2(T,M);var S=T.isub(M);return S.cmpn(0)<0&&S.iadd(this.m),S},A.prototype.shl=function(T,M){return this._verify1(T),this.imod(T.ushln(M))},A.prototype.imul=function(T,M){return this._verify2(T,M),this.imod(T.imul(M))},A.prototype.mul=function(T,M){return this._verify2(T,M),this.imod(T.mul(M))},A.prototype.isqr=function(T){return this.imul(T,T.clone())},A.prototype.sqr=function(T){return this.mul(T,T)},A.prototype.sqrt=function(T){if(T.isZero())return T.clone();var M=this.m.andln(3);if(l(M%2==1),M===3){var S=this.m.add(new d(1)).iushrn(2);return this.pow(T,S)}for(var E=this.m.subn(1),k=0;!E.isZero()&&E.andln(1)===0;)k++,E.iushrn(1);l(!E.isZero());var O=new d(1).toRed(this),x=O.redNeg(),j=this.m.subn(1).iushrn(1),H=this.m.bitLength();for(H=new d(2*H*H).toRed(this);this.pow(H,j).cmp(x)!==0;)H.redIAdd(x);for(var F=this.pow(H,E),V=this.pow(T,E.addn(1).iushrn(1)),W=this.pow(T,E),U=k;W.cmp(O)!==0;){for(var Y=W,K=0;Y.cmp(O)!==0;K++)Y=Y.redSqr();l(K<U);var D=this.pow(F,new d(1).iushln(U-K-1));V=V.redMul(D),F=D.redSqr(),W=W.redMul(F),U=K}return V},A.prototype.invm=function(T){var M=T._invmp(this.m);return M.negative!==0?(M.negative=0,this.imod(M).redNeg()):this.imod(M)},A.prototype.pow=function(T,M){if(M.isZero())return new d(1).toRed(this);if(M.cmpn(1)===0)return T.clone();var S=new Array(16);S[0]=new d(1).toRed(this),S[1]=T;for(var E=2;E<S.length;E++)S[E]=this.mul(S[E-1],T);var k=S[0],O=0,x=0,j=M.bitLength()%26;for(j===0&&(j=26),E=M.length-1;E>=0;E--){for(var H=M.words[E],F=j-1;F>=0;F--){var V=H>>F&1;k!==S[0]&&(k=this.sqr(k)),V!==0||O!==0?(O<<=1,O|=V,(++x==4||E===0&&F===0)&&(k=this.mul(k,S[O]),x=0,O=0)):x=0}j=26}return k},A.prototype.convertTo=function(T){var M=T.umod(this.m);return M===T?M.clone():M},A.prototype.convertFrom=function(T){var M=T.clone();return M.red=null,M},d.mont=function(T){return new $(T)},p($,A),$.prototype.convertTo=function(T){return this.imod(T.ushln(this.shift))},$.prototype.convertFrom=function(T){var M=this.imod(T.mul(this.rinv));return M.red=null,M},$.prototype.imul=function(T,M){if(T.isZero()||M.isZero())return T.words[0]=0,T.length=1,T;var S=T.imul(M),E=S.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),k=S.isub(E).iushrn(this.shift),O=k;return k.cmp(this.m)>=0?O=k.isub(this.m):k.cmpn(0)<0&&(O=k.iadd(this.m)),O._forceRed(this)},$.prototype.mul=function(T,M){if(T.isZero()||M.isZero())return new d(0)._forceRed(this);var S=T.mul(M),E=S.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),k=S.isub(E).iushrn(this.shift),O=k;return k.cmp(this.m)>=0?O=k.isub(this.m):k.cmpn(0)<0&&(O=k.iadd(this.m)),O._forceRed(this)},$.prototype.invm=function(T){return this.imod(T._invmp(this.m).mul(this.r2))._forceRed(this)}})(n===void 0||n)},{buffer:185}],182:[function(e,n,i){i.byteLength=function(h){var u=g(h),f=u[0],c=u[1];return 3*(f+c)/4-c},i.toByteArray=function(h){var u,f,c=g(h),v=c[0],m=c[1],b=new s(function(C,R,I){return 3*(R+I)/4-I}(0,v,m)),w=0,_=m>0?v-4:v;for(f=0;f<_;f+=4)u=a[h.charCodeAt(f)]<<18|a[h.charCodeAt(f+1)]<<12|a[h.charCodeAt(f+2)]<<6|a[h.charCodeAt(f+3)],b[w++]=u>>16&255,b[w++]=u>>8&255,b[w++]=255&u;return m===2&&(u=a[h.charCodeAt(f)]<<2|a[h.charCodeAt(f+1)]>>4,b[w++]=255&u),m===1&&(u=a[h.charCodeAt(f)]<<10|a[h.charCodeAt(f+1)]<<4|a[h.charCodeAt(f+2)]>>2,b[w++]=u>>8&255,b[w++]=255&u),b},i.fromByteArray=function(h){for(var u,f=h.length,c=f%3,v=[],m=0,b=f-c;m<b;m+=16383)v.push(y(h,m,m+16383>b?b:m+16383));return c===1?(u=h[f-1],v.push(o[u>>2]+o[u<<4&63]+"==")):c===2&&(u=(h[f-2]<<8)+h[f-1],v.push(o[u>>10]+o[u>>4&63]+o[u<<2&63]+"=")),v.join("")};for(var o=[],a=[],s=typeof Uint8Array!="undefined"?Uint8Array:Array,l="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",p=0,d=l.length;p<d;++p)o[p]=l[p],a[l.charCodeAt(p)]=p;function g(h){var u=h.length;if(u%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var f=h.indexOf("=");return f===-1&&(f=u),[f,f===u?0:4-f%4]}function y(h,u,f){for(var c,v,m=[],b=u;b<f;b+=3)c=(h[b]<<16&16711680)+(h[b+1]<<8&65280)+(255&h[b+2]),m.push(o[(v=c)>>18&63]+o[v>>12&63]+o[v>>6&63]+o[63&v]);return m.join("")}a["-".charCodeAt(0)]=62,a["_".charCodeAt(0)]=63},{}],183:[function(e,n,i){function o(a){return(o=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(s){return typeof s}:function(s){return s&&typeof Symbol=="function"&&s.constructor===Symbol&&s!==Symbol.prototype?"symbol":typeof s})(a)}(function(a,s){function l(S,E){if(!S)throw new Error(E||"Assertion failed")}function p(S,E){S.super_=E;var k=function(){};k.prototype=E.prototype,S.prototype=new k,S.prototype.constructor=S}function d(S,E,k){if(d.isBN(S))return S;this.negative=0,this.words=null,this.length=0,this.red=null,S!==null&&(E!=="le"&&E!=="be"||(k=E,E=10),this._init(S||0,E||10,k||"be"))}var g;o(a)==="object"?a.exports=d:(void 0).BN=d,d.BN=d,d.wordSize=26;try{g=e("buffer").Buffer}catch{}function y(S,E,k){for(var O=0,x=Math.min(S.length,k),j=0,H=E;H<x;H++){var F,V=S.charCodeAt(H)-48;O<<=4,O|=F=V>=49&&V<=54?V-49+10:V>=17&&V<=22?V-17+10:V,j|=F}return l(!(240&j),"Invalid character in "+S),O}function h(S,E,k,O){for(var x=0,j=0,H=Math.min(S.length,k),F=E;F<H;F++){var V=S.charCodeAt(F)-48;x*=O,j=V>=49?V-49+10:V>=17?V-17+10:V,l(V>=0&&j<O,"Invalid character"),x+=j}return x}function u(S,E){S.words=E.words,S.length=E.length,S.negative=E.negative,S.red=E.red}if(d.isBN=function(S){return S instanceof d||S!==null&&o(S)==="object"&&S.constructor.wordSize===d.wordSize&&Array.isArray(S.words)},d.max=function(S,E){return S.cmp(E)>0?S:E},d.min=function(S,E){return S.cmp(E)<0?S:E},d.prototype._init=function(S,E,k){if(typeof S=="number")return this._initNumber(S,E,k);if(o(S)==="object")return this._initArray(S,E,k);E==="hex"&&(E=16),l(E===(0|E)&&E>=2&&E<=36);var O=0;(S=S.toString().replace(/\s+/g,""))[0]==="-"&&O++,E===16?this._parseHex(S,O):this._parseBase(S,E,O),S[0]==="-"&&(this.negative=1),this._strip(),k==="le"&&this._initArray(this.toArray(),E,k)},d.prototype._initNumber=function(S,E,k){S<0&&(this.negative=1,S=-S),S<67108864?(this.words=[67108863&S],this.length=1):S<4503599627370496?(this.words=[67108863&S,S/67108864&67108863],this.length=2):(l(S<9007199254740992),this.words=[67108863&S,S/67108864&67108863,1],this.length=3),k==="le"&&this._initArray(this.toArray(),E,k)},d.prototype._initArray=function(S,E,k){if(l(typeof S.length=="number"),S.length<=0)return this.words=[0],this.length=1,this;this.length=Math.ceil(S.length/3),this.words=new Array(this.length);for(var O=0;O<this.length;O++)this.words[O]=0;var x,j,H=0;if(k==="be")for(O=S.length-1,x=0;O>=0;O-=3)j=S[O]|S[O-1]<<8|S[O-2]<<16,this.words[x]|=j<<H&67108863,this.words[x+1]=j>>>26-H&67108863,(H+=24)>=26&&(H-=26,x++);else if(k==="le")for(O=0,x=0;O<S.length;O+=3)j=S[O]|S[O+1]<<8|S[O+2]<<16,this.words[x]|=j<<H&67108863,this.words[x+1]=j>>>26-H&67108863,(H+=24)>=26&&(H-=26,x++);return this._strip()},d.prototype._parseHex=function(S,E){this.length=Math.ceil((S.length-E)/6),this.words=new Array(this.length);for(var k=0;k<this.length;k++)this.words[k]=0;var O,x,j=0;for(k=S.length-6,O=0;k>=E;k-=6)x=y(S,k,k+6),this.words[O]|=x<<j&67108863,this.words[O+1]|=x>>>26-j&4194303,(j+=24)>=26&&(j-=26,O++);k+6!==E&&(x=y(S,E,k+6),this.words[O]|=x<<j&67108863,this.words[O+1]|=x>>>26-j&4194303),this._strip()},d.prototype._parseBase=function(S,E,k){this.words=[0],this.length=1;for(var O=0,x=1;x<=67108863;x*=E)O++;O--,x=x/E|0;for(var j=S.length-k,H=j%O,F=Math.min(j,j-H)+k,V=0,W=k;W<F;W+=O)V=h(S,W,W+O,E),this.imuln(x),this.words[0]+V<67108864?this.words[0]+=V:this._iaddn(V);if(H!==0){var U=1;for(V=h(S,W,S.length,E),W=0;W<H;W++)U*=E;this.imuln(U),this.words[0]+V<67108864?this.words[0]+=V:this._iaddn(V)}},d.prototype.copy=function(S){S.words=new Array(this.length);for(var E=0;E<this.length;E++)S.words[E]=this.words[E];S.length=this.length,S.negative=this.negative,S.red=this.red},d.prototype._move=function(S){u(S,this)},d.prototype.clone=function(){var S=new d(null);return this.copy(S),S},d.prototype._expand=function(S){for(;this.length<S;)this.words[this.length++]=0;return this},d.prototype._strip=function(){for(;this.length>1&&this.words[this.length-1]===0;)this.length--;return this._normSign()},d.prototype._normSign=function(){return this.length===1&&this.words[0]===0&&(this.negative=0),this},typeof Symbol!="undefined"&&typeof Symbol.for=="function")try{d.prototype[Symbol.for("nodejs.util.inspect.custom")]=f}catch{d.prototype.inspect=f}else d.prototype.inspect=f;function f(){return(this.red?"<BN-R: ":"<BN: ")+this.toString(16)+">"}var c=["","0","00","000","0000","00000","000000","0000000","00000000","000000000","0000000000","00000000000","000000000000","0000000000000","00000000000000","000000000000000","0000000000000000","00000000000000000","000000000000000000","0000000000000000000","00000000000000000000","000000000000000000000","0000000000000000000000","00000000000000000000000","000000000000000000000000","0000000000000000000000000"],v=[0,0,25,16,12,11,10,9,8,8,7,7,7,7,6,6,6,6,6,6,6,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5],m=[0,0,33554432,43046721,16777216,48828125,60466176,40353607,16777216,43046721,1e7,19487171,35831808,62748517,7529536,11390625,16777216,24137569,34012224,47045881,64e6,4084101,5153632,6436343,7962624,9765625,11881376,14348907,17210368,20511149,243e5,28629151,33554432,39135393,45435424,52521875,60466176];d.prototype.toString=function(S,E){var k;if(E=0|E||1,(S=S||10)===16||S==="hex"){k="";for(var O=0,x=0,j=0;j<this.length;j++){var H=this.words[j],F=(16777215&(H<<O|x)).toString(16);k=(x=H>>>24-O&16777215)!=0||j!==this.length-1?c[6-F.length]+F+k:F+k,(O+=2)>=26&&(O-=26,j--)}for(x!==0&&(k=x.toString(16)+k);k.length%E!=0;)k="0"+k;return this.negative!==0&&(k="-"+k),k}if(S===(0|S)&&S>=2&&S<=36){var V=v[S],W=m[S];k="";var U=this.clone();for(U.negative=0;!U.isZero();){var Y=U.modrn(W).toString(S);k=(U=U.idivn(W)).isZero()?Y+k:c[V-Y.length]+Y+k}for(this.isZero()&&(k="0"+k);k.length%E!=0;)k="0"+k;return this.negative!==0&&(k="-"+k),k}l(!1,"Base should be between 2 and 36")},d.prototype.toNumber=function(){var S=this.words[0];return this.length===2?S+=67108864*this.words[1]:this.length===3&&this.words[2]===1?S+=4503599627370496+67108864*this.words[1]:this.length>2&&l(!1,"Number can only safely store up to 53 bits"),this.negative!==0?-S:S},d.prototype.toJSON=function(){return this.toString(16,2)},g&&(d.prototype.toBuffer=function(S,E){return this.toArrayLike(g,S,E)}),d.prototype.toArray=function(S,E){return this.toArrayLike(Array,S,E)};function b(S,E,k){k.negative=E.negative^S.negative;var O=S.length+E.length|0;k.length=O,O=O-1|0;var x=0|S.words[0],j=0|E.words[0],H=x*j,F=67108863&H,V=H/67108864|0;k.words[0]=F;for(var W=1;W<O;W++){for(var U=V>>>26,Y=67108863&V,K=Math.min(W,E.length-1),D=Math.max(0,W-S.length+1);D<=K;D++){var L=W-D|0;U+=(H=(x=0|S.words[L])*(j=0|E.words[D])+Y)/67108864|0,Y=67108863&H}k.words[W]=0|Y,V=0|U}return V!==0?k.words[W]=0|V:k.length--,k._strip()}d.prototype.toArrayLike=function(S,E,k){this._strip();var O=this.byteLength(),x=k||Math.max(1,O);l(O<=x,"byte array longer than desired length"),l(x>0,"Requested array length <= 0");var j=function(H,F){return H.allocUnsafe?H.allocUnsafe(F):new H(F)}(S,x);return this["_toArrayLike"+(E==="le"?"LE":"BE")](j,O),j},d.prototype._toArrayLikeLE=function(S,E){for(var k=0,O=0,x=0,j=0;x<this.length;x++){var H=this.words[x]<<j|O;S[k++]=255&H,k<S.length&&(S[k++]=H>>8&255),k<S.length&&(S[k++]=H>>16&255),j===6?(k<S.length&&(S[k++]=H>>24&255),O=0,j=0):(O=H>>>24,j+=2)}if(k<S.length)for(S[k++]=O;k<S.length;)S[k++]=0},d.prototype._toArrayLikeBE=function(S,E){for(var k=S.length-1,O=0,x=0,j=0;x<this.length;x++){var H=this.words[x]<<j|O;S[k--]=255&H,k>=0&&(S[k--]=H>>8&255),k>=0&&(S[k--]=H>>16&255),j===6?(k>=0&&(S[k--]=H>>24&255),O=0,j=0):(O=H>>>24,j+=2)}if(k>=0)for(S[k--]=O;k>=0;)S[k--]=0},Math.clz32?d.prototype._countBits=function(S){return 32-Math.clz32(S)}:d.prototype._countBits=function(S){var E=S,k=0;return E>=4096&&(k+=13,E>>>=13),E>=64&&(k+=7,E>>>=7),E>=8&&(k+=4,E>>>=4),E>=2&&(k+=2,E>>>=2),k+E},d.prototype._zeroBits=function(S){if(S===0)return 26;var E=S,k=0;return(8191&E)==0&&(k+=13,E>>>=13),(127&E)==0&&(k+=7,E>>>=7),(15&E)==0&&(k+=4,E>>>=4),(3&E)==0&&(k+=2,E>>>=2),(1&E)==0&&k++,k},d.prototype.bitLength=function(){var S=this.words[this.length-1],E=this._countBits(S);return 26*(this.length-1)+E},d.prototype.zeroBits=function(){if(this.isZero())return 0;for(var S=0,E=0;E<this.length;E++){var k=this._zeroBits(this.words[E]);if(S+=k,k!==26)break}return S},d.prototype.byteLength=function(){return Math.ceil(this.bitLength()/8)},d.prototype.toTwos=function(S){return this.negative!==0?this.abs().inotn(S).iaddn(1):this.clone()},d.prototype.fromTwos=function(S){return this.testn(S-1)?this.notn(S).iaddn(1).ineg():this.clone()},d.prototype.isNeg=function(){return this.negative!==0},d.prototype.neg=function(){return this.clone().ineg()},d.prototype.ineg=function(){return this.isZero()||(this.negative^=1),this},d.prototype.iuor=function(S){for(;this.length<S.length;)this.words[this.length++]=0;for(var E=0;E<S.length;E++)this.words[E]=this.words[E]|S.words[E];return this._strip()},d.prototype.ior=function(S){return l((this.negative|S.negative)==0),this.iuor(S)},d.prototype.or=function(S){return this.length>S.length?this.clone().ior(S):S.clone().ior(this)},d.prototype.uor=function(S){return this.length>S.length?this.clone().iuor(S):S.clone().iuor(this)},d.prototype.iuand=function(S){var E;E=this.length>S.length?S:this;for(var k=0;k<E.length;k++)this.words[k]=this.words[k]&S.words[k];return this.length=E.length,this._strip()},d.prototype.iand=function(S){return l((this.negative|S.negative)==0),this.iuand(S)},d.prototype.and=function(S){return this.length>S.length?this.clone().iand(S):S.clone().iand(this)},d.prototype.uand=function(S){return this.length>S.length?this.clone().iuand(S):S.clone().iuand(this)},d.prototype.iuxor=function(S){var E,k;this.length>S.length?(E=this,k=S):(E=S,k=this);for(var O=0;O<k.length;O++)this.words[O]=E.words[O]^k.words[O];if(this!==E)for(;O<E.length;O++)this.words[O]=E.words[O];return this.length=E.length,this._strip()},d.prototype.ixor=function(S){return l((this.negative|S.negative)==0),this.iuxor(S)},d.prototype.xor=function(S){return this.length>S.length?this.clone().ixor(S):S.clone().ixor(this)},d.prototype.uxor=function(S){return this.length>S.length?this.clone().iuxor(S):S.clone().iuxor(this)},d.prototype.inotn=function(S){l(typeof S=="number"&&S>=0);var E=0|Math.ceil(S/26),k=S%26;this._expand(E),k>0&&E--;for(var O=0;O<E;O++)this.words[O]=67108863&~this.words[O];return k>0&&(this.words[O]=~this.words[O]&67108863>>26-k),this._strip()},d.prototype.notn=function(S){return this.clone().inotn(S)},d.prototype.setn=function(S,E){l(typeof S=="number"&&S>=0);var k=S/26|0,O=S%26;return this._expand(k+1),this.words[k]=E?this.words[k]|1<<O:this.words[k]&~(1<<O),this._strip()},d.prototype.iadd=function(S){var E,k,O;if(this.negative!==0&&S.negative===0)return this.negative=0,E=this.isub(S),this.negative^=1,this._normSign();if(this.negative===0&&S.negative!==0)return S.negative=0,E=this.isub(S),S.negative=1,E._normSign();this.length>S.length?(k=this,O=S):(k=S,O=this);for(var x=0,j=0;j<O.length;j++)E=(0|k.words[j])+(0|O.words[j])+x,this.words[j]=67108863&E,x=E>>>26;for(;x!==0&&j<k.length;j++)E=(0|k.words[j])+x,this.words[j]=67108863&E,x=E>>>26;if(this.length=k.length,x!==0)this.words[this.length]=x,this.length++;else if(k!==this)for(;j<k.length;j++)this.words[j]=k.words[j];return this},d.prototype.add=function(S){var E;return S.negative!==0&&this.negative===0?(S.negative=0,E=this.sub(S),S.negative^=1,E):S.negative===0&&this.negative!==0?(this.negative=0,E=S.sub(this),this.negative=1,E):this.length>S.length?this.clone().iadd(S):S.clone().iadd(this)},d.prototype.isub=function(S){if(S.negative!==0){S.negative=0;var E=this.iadd(S);return S.negative=1,E._normSign()}if(this.negative!==0)return this.negative=0,this.iadd(S),this.negative=1,this._normSign();var k,O,x=this.cmp(S);if(x===0)return this.negative=0,this.length=1,this.words[0]=0,this;x>0?(k=this,O=S):(k=S,O=this);for(var j=0,H=0;H<O.length;H++)j=(E=(0|k.words[H])-(0|O.words[H])+j)>>26,this.words[H]=67108863&E;for(;j!==0&&H<k.length;H++)j=(E=(0|k.words[H])+j)>>26,this.words[H]=67108863&E;if(j===0&&H<k.length&&k!==this)for(;H<k.length;H++)this.words[H]=k.words[H];return this.length=Math.max(this.length,H),k!==this&&(this.negative=1),this._strip()},d.prototype.sub=function(S){return this.clone().isub(S)};var w=function(S,E,k){var O,x,j,H=S.words,F=E.words,V=k.words,W=0,U=0|H[0],Y=8191&U,K=U>>>13,D=0|H[1],L=8191&D,B=D>>>13,z=0|H[2],q=8191&z,X=z>>>13,ee=0|H[3],ye=8191&ee,de=ee>>>13,ge=0|H[4],we=8191&ge,be=ge>>>13,J=0|H[5],te=8191&J,ie=J>>>13,fe=0|H[6],se=8191&fe,oe=fe>>>13,G=0|H[7],Z=8191&G,Q=G>>>13,re=0|H[8],ne=8191&re,ue=re>>>13,le=0|H[9],ve=8191&le,Se=le>>>13,Oe=0|F[0],xe=8191&Oe,Ce=Oe>>>13,Le=0|F[1],Ve=8191&Le,Je=Le>>>13,ft=0|F[2],Ct=8191&ft,Ye=ft>>>13,et=0|F[3],Te=8191&et,We=et>>>13,rt=0|F[4],Rt=8191&rt,ut=rt>>>13,$t=0|F[5],Et=8191&$t,nt=$t>>>13,Ft=0|F[6],pe=8191&Ft,me=Ft>>>13,Me=0|F[7],He=8191&Me,Ae=Me>>>13,ce=0|F[8],Ee=8191&ce,Re=ce>>>13,Ge=0|F[9],Xe=8191&Ge,qe=Ge>>>13;k.negative=S.negative^E.negative,k.length=19;var kt=(W+(O=Math.imul(Y,xe))|0)+((8191&(x=(x=Math.imul(Y,Ce))+Math.imul(K,xe)|0))<<13)|0;W=((j=Math.imul(K,Ce))+(x>>>13)|0)+(kt>>>26)|0,kt&=67108863,O=Math.imul(L,xe),x=(x=Math.imul(L,Ce))+Math.imul(B,xe)|0,j=Math.imul(B,Ce);var Ht=(W+(O=O+Math.imul(Y,Ve)|0)|0)+((8191&(x=(x=x+Math.imul(Y,Je)|0)+Math.imul(K,Ve)|0))<<13)|0;W=((j=j+Math.imul(K,Je)|0)+(x>>>13)|0)+(Ht>>>26)|0,Ht&=67108863,O=Math.imul(q,xe),x=(x=Math.imul(q,Ce))+Math.imul(X,xe)|0,j=Math.imul(X,Ce),O=O+Math.imul(L,Ve)|0,x=(x=x+Math.imul(L,Je)|0)+Math.imul(B,Ve)|0,j=j+Math.imul(B,Je)|0;var jt=(W+(O=O+Math.imul(Y,Ct)|0)|0)+((8191&(x=(x=x+Math.imul(Y,Ye)|0)+Math.imul(K,Ct)|0))<<13)|0;W=((j=j+Math.imul(K,Ye)|0)+(x>>>13)|0)+(jt>>>26)|0,jt&=67108863,O=Math.imul(ye,xe),x=(x=Math.imul(ye,Ce))+Math.imul(de,xe)|0,j=Math.imul(de,Ce),O=O+Math.imul(q,Ve)|0,x=(x=x+Math.imul(q,Je)|0)+Math.imul(X,Ve)|0,j=j+Math.imul(X,Je)|0,O=O+Math.imul(L,Ct)|0,x=(x=x+Math.imul(L,Ye)|0)+Math.imul(B,Ct)|0,j=j+Math.imul(B,Ye)|0;var dr=(W+(O=O+Math.imul(Y,Te)|0)|0)+((8191&(x=(x=x+Math.imul(Y,We)|0)+Math.imul(K,Te)|0))<<13)|0;W=((j=j+Math.imul(K,We)|0)+(x>>>13)|0)+(dr>>>26)|0,dr&=67108863,O=Math.imul(we,xe),x=(x=Math.imul(we,Ce))+Math.imul(be,xe)|0,j=Math.imul(be,Ce),O=O+Math.imul(ye,Ve)|0,x=(x=x+Math.imul(ye,Je)|0)+Math.imul(de,Ve)|0,j=j+Math.imul(de,Je)|0,O=O+Math.imul(q,Ct)|0,x=(x=x+Math.imul(q,Ye)|0)+Math.imul(X,Ct)|0,j=j+Math.imul(X,Ye)|0,O=O+Math.imul(L,Te)|0,x=(x=x+Math.imul(L,We)|0)+Math.imul(B,Te)|0,j=j+Math.imul(B,We)|0;var vr=(W+(O=O+Math.imul(Y,Rt)|0)|0)+((8191&(x=(x=x+Math.imul(Y,ut)|0)+Math.imul(K,Rt)|0))<<13)|0;W=((j=j+Math.imul(K,ut)|0)+(x>>>13)|0)+(vr>>>26)|0,vr&=67108863,O=Math.imul(te,xe),x=(x=Math.imul(te,Ce))+Math.imul(ie,xe)|0,j=Math.imul(ie,Ce),O=O+Math.imul(we,Ve)|0,x=(x=x+Math.imul(we,Je)|0)+Math.imul(be,Ve)|0,j=j+Math.imul(be,Je)|0,O=O+Math.imul(ye,Ct)|0,x=(x=x+Math.imul(ye,Ye)|0)+Math.imul(de,Ct)|0,j=j+Math.imul(de,Ye)|0,O=O+Math.imul(q,Te)|0,x=(x=x+Math.imul(q,We)|0)+Math.imul(X,Te)|0,j=j+Math.imul(X,We)|0,O=O+Math.imul(L,Rt)|0,x=(x=x+Math.imul(L,ut)|0)+Math.imul(B,Rt)|0,j=j+Math.imul(B,ut)|0;var Ur=(W+(O=O+Math.imul(Y,Et)|0)|0)+((8191&(x=(x=x+Math.imul(Y,nt)|0)+Math.imul(K,Et)|0))<<13)|0;W=((j=j+Math.imul(K,nt)|0)+(x>>>13)|0)+(Ur>>>26)|0,Ur&=67108863,O=Math.imul(se,xe),x=(x=Math.imul(se,Ce))+Math.imul(oe,xe)|0,j=Math.imul(oe,Ce),O=O+Math.imul(te,Ve)|0,x=(x=x+Math.imul(te,Je)|0)+Math.imul(ie,Ve)|0,j=j+Math.imul(ie,Je)|0,O=O+Math.imul(we,Ct)|0,x=(x=x+Math.imul(we,Ye)|0)+Math.imul(be,Ct)|0,j=j+Math.imul(be,Ye)|0,O=O+Math.imul(ye,Te)|0,x=(x=x+Math.imul(ye,We)|0)+Math.imul(de,Te)|0,j=j+Math.imul(de,We)|0,O=O+Math.imul(q,Rt)|0,x=(x=x+Math.imul(q,ut)|0)+Math.imul(X,Rt)|0,j=j+Math.imul(X,ut)|0,O=O+Math.imul(L,Et)|0,x=(x=x+Math.imul(L,nt)|0)+Math.imul(B,Et)|0,j=j+Math.imul(B,nt)|0;var ae=(W+(O=O+Math.imul(Y,pe)|0)|0)+((8191&(x=(x=x+Math.imul(Y,me)|0)+Math.imul(K,pe)|0))<<13)|0;W=((j=j+Math.imul(K,me)|0)+(x>>>13)|0)+(ae>>>26)|0,ae&=67108863,O=Math.imul(Z,xe),x=(x=Math.imul(Z,Ce))+Math.imul(Q,xe)|0,j=Math.imul(Q,Ce),O=O+Math.imul(se,Ve)|0,x=(x=x+Math.imul(se,Je)|0)+Math.imul(oe,Ve)|0,j=j+Math.imul(oe,Je)|0,O=O+Math.imul(te,Ct)|0,x=(x=x+Math.imul(te,Ye)|0)+Math.imul(ie,Ct)|0,j=j+Math.imul(ie,Ye)|0,O=O+Math.imul(we,Te)|0,x=(x=x+Math.imul(we,We)|0)+Math.imul(be,Te)|0,j=j+Math.imul(be,We)|0,O=O+Math.imul(ye,Rt)|0,x=(x=x+Math.imul(ye,ut)|0)+Math.imul(de,Rt)|0,j=j+Math.imul(de,ut)|0,O=O+Math.imul(q,Et)|0,x=(x=x+Math.imul(q,nt)|0)+Math.imul(X,Et)|0,j=j+Math.imul(X,nt)|0,O=O+Math.imul(L,pe)|0,x=(x=x+Math.imul(L,me)|0)+Math.imul(B,pe)|0,j=j+Math.imul(B,me)|0;var _e=(W+(O=O+Math.imul(Y,He)|0)|0)+((8191&(x=(x=x+Math.imul(Y,Ae)|0)+Math.imul(K,He)|0))<<13)|0;W=((j=j+Math.imul(K,Ae)|0)+(x>>>13)|0)+(_e>>>26)|0,_e&=67108863,O=Math.imul(ne,xe),x=(x=Math.imul(ne,Ce))+Math.imul(ue,xe)|0,j=Math.imul(ue,Ce),O=O+Math.imul(Z,Ve)|0,x=(x=x+Math.imul(Z,Je)|0)+Math.imul(Q,Ve)|0,j=j+Math.imul(Q,Je)|0,O=O+Math.imul(se,Ct)|0,x=(x=x+Math.imul(se,Ye)|0)+Math.imul(oe,Ct)|0,j=j+Math.imul(oe,Ye)|0,O=O+Math.imul(te,Te)|0,x=(x=x+Math.imul(te,We)|0)+Math.imul(ie,Te)|0,j=j+Math.imul(ie,We)|0,O=O+Math.imul(we,Rt)|0,x=(x=x+Math.imul(we,ut)|0)+Math.imul(be,Rt)|0,j=j+Math.imul(be,ut)|0,O=O+Math.imul(ye,Et)|0,x=(x=x+Math.imul(ye,nt)|0)+Math.imul(de,Et)|0,j=j+Math.imul(de,nt)|0,O=O+Math.imul(q,pe)|0,x=(x=x+Math.imul(q,me)|0)+Math.imul(X,pe)|0,j=j+Math.imul(X,me)|0,O=O+Math.imul(L,He)|0,x=(x=x+Math.imul(L,Ae)|0)+Math.imul(B,He)|0,j=j+Math.imul(B,Ae)|0;var Pe=(W+(O=O+Math.imul(Y,Ee)|0)|0)+((8191&(x=(x=x+Math.imul(Y,Re)|0)+Math.imul(K,Ee)|0))<<13)|0;W=((j=j+Math.imul(K,Re)|0)+(x>>>13)|0)+(Pe>>>26)|0,Pe&=67108863,O=Math.imul(ve,xe),x=(x=Math.imul(ve,Ce))+Math.imul(Se,xe)|0,j=Math.imul(Se,Ce),O=O+Math.imul(ne,Ve)|0,x=(x=x+Math.imul(ne,Je)|0)+Math.imul(ue,Ve)|0,j=j+Math.imul(ue,Je)|0,O=O+Math.imul(Z,Ct)|0,x=(x=x+Math.imul(Z,Ye)|0)+Math.imul(Q,Ct)|0,j=j+Math.imul(Q,Ye)|0,O=O+Math.imul(se,Te)|0,x=(x=x+Math.imul(se,We)|0)+Math.imul(oe,Te)|0,j=j+Math.imul(oe,We)|0,O=O+Math.imul(te,Rt)|0,x=(x=x+Math.imul(te,ut)|0)+Math.imul(ie,Rt)|0,j=j+Math.imul(ie,ut)|0,O=O+Math.imul(we,Et)|0,x=(x=x+Math.imul(we,nt)|0)+Math.imul(be,Et)|0,j=j+Math.imul(be,nt)|0,O=O+Math.imul(ye,pe)|0,x=(x=x+Math.imul(ye,me)|0)+Math.imul(de,pe)|0,j=j+Math.imul(de,me)|0,O=O+Math.imul(q,He)|0,x=(x=x+Math.imul(q,Ae)|0)+Math.imul(X,He)|0,j=j+Math.imul(X,Ae)|0,O=O+Math.imul(L,Ee)|0,x=(x=x+Math.imul(L,Re)|0)+Math.imul(B,Ee)|0,j=j+Math.imul(B,Re)|0;var Ne=(W+(O=O+Math.imul(Y,Xe)|0)|0)+((8191&(x=(x=x+Math.imul(Y,qe)|0)+Math.imul(K,Xe)|0))<<13)|0;W=((j=j+Math.imul(K,qe)|0)+(x>>>13)|0)+(Ne>>>26)|0,Ne&=67108863,O=Math.imul(ve,Ve),x=(x=Math.imul(ve,Je))+Math.imul(Se,Ve)|0,j=Math.imul(Se,Je),O=O+Math.imul(ne,Ct)|0,x=(x=x+Math.imul(ne,Ye)|0)+Math.imul(ue,Ct)|0,j=j+Math.imul(ue,Ye)|0,O=O+Math.imul(Z,Te)|0,x=(x=x+Math.imul(Z,We)|0)+Math.imul(Q,Te)|0,j=j+Math.imul(Q,We)|0,O=O+Math.imul(se,Rt)|0,x=(x=x+Math.imul(se,ut)|0)+Math.imul(oe,Rt)|0,j=j+Math.imul(oe,ut)|0,O=O+Math.imul(te,Et)|0,x=(x=x+Math.imul(te,nt)|0)+Math.imul(ie,Et)|0,j=j+Math.imul(ie,nt)|0,O=O+Math.imul(we,pe)|0,x=(x=x+Math.imul(we,me)|0)+Math.imul(be,pe)|0,j=j+Math.imul(be,me)|0,O=O+Math.imul(ye,He)|0,x=(x=x+Math.imul(ye,Ae)|0)+Math.imul(de,He)|0,j=j+Math.imul(de,Ae)|0,O=O+Math.imul(q,Ee)|0,x=(x=x+Math.imul(q,Re)|0)+Math.imul(X,Ee)|0,j=j+Math.imul(X,Re)|0;var tt=(W+(O=O+Math.imul(L,Xe)|0)|0)+((8191&(x=(x=x+Math.imul(L,qe)|0)+Math.imul(B,Xe)|0))<<13)|0;W=((j=j+Math.imul(B,qe)|0)+(x>>>13)|0)+(tt>>>26)|0,tt&=67108863,O=Math.imul(ve,Ct),x=(x=Math.imul(ve,Ye))+Math.imul(Se,Ct)|0,j=Math.imul(Se,Ye),O=O+Math.imul(ne,Te)|0,x=(x=x+Math.imul(ne,We)|0)+Math.imul(ue,Te)|0,j=j+Math.imul(ue,We)|0,O=O+Math.imul(Z,Rt)|0,x=(x=x+Math.imul(Z,ut)|0)+Math.imul(Q,Rt)|0,j=j+Math.imul(Q,ut)|0,O=O+Math.imul(se,Et)|0,x=(x=x+Math.imul(se,nt)|0)+Math.imul(oe,Et)|0,j=j+Math.imul(oe,nt)|0,O=O+Math.imul(te,pe)|0,x=(x=x+Math.imul(te,me)|0)+Math.imul(ie,pe)|0,j=j+Math.imul(ie,me)|0,O=O+Math.imul(we,He)|0,x=(x=x+Math.imul(we,Ae)|0)+Math.imul(be,He)|0,j=j+Math.imul(be,Ae)|0,O=O+Math.imul(ye,Ee)|0,x=(x=x+Math.imul(ye,Re)|0)+Math.imul(de,Ee)|0,j=j+Math.imul(de,Re)|0;var je=(W+(O=O+Math.imul(q,Xe)|0)|0)+((8191&(x=(x=x+Math.imul(q,qe)|0)+Math.imul(X,Xe)|0))<<13)|0;W=((j=j+Math.imul(X,qe)|0)+(x>>>13)|0)+(je>>>26)|0,je&=67108863,O=Math.imul(ve,Te),x=(x=Math.imul(ve,We))+Math.imul(Se,Te)|0,j=Math.imul(Se,We),O=O+Math.imul(ne,Rt)|0,x=(x=x+Math.imul(ne,ut)|0)+Math.imul(ue,Rt)|0,j=j+Math.imul(ue,ut)|0,O=O+Math.imul(Z,Et)|0,x=(x=x+Math.imul(Z,nt)|0)+Math.imul(Q,Et)|0,j=j+Math.imul(Q,nt)|0,O=O+Math.imul(se,pe)|0,x=(x=x+Math.imul(se,me)|0)+Math.imul(oe,pe)|0,j=j+Math.imul(oe,me)|0,O=O+Math.imul(te,He)|0,x=(x=x+Math.imul(te,Ae)|0)+Math.imul(ie,He)|0,j=j+Math.imul(ie,Ae)|0,O=O+Math.imul(we,Ee)|0,x=(x=x+Math.imul(we,Re)|0)+Math.imul(be,Ee)|0,j=j+Math.imul(be,Re)|0;var Fe=(W+(O=O+Math.imul(ye,Xe)|0)|0)+((8191&(x=(x=x+Math.imul(ye,qe)|0)+Math.imul(de,Xe)|0))<<13)|0;W=((j=j+Math.imul(de,qe)|0)+(x>>>13)|0)+(Fe>>>26)|0,Fe&=67108863,O=Math.imul(ve,Rt),x=(x=Math.imul(ve,ut))+Math.imul(Se,Rt)|0,j=Math.imul(Se,ut),O=O+Math.imul(ne,Et)|0,x=(x=x+Math.imul(ne,nt)|0)+Math.imul(ue,Et)|0,j=j+Math.imul(ue,nt)|0,O=O+Math.imul(Z,pe)|0,x=(x=x+Math.imul(Z,me)|0)+Math.imul(Q,pe)|0,j=j+Math.imul(Q,me)|0,O=O+Math.imul(se,He)|0,x=(x=x+Math.imul(se,Ae)|0)+Math.imul(oe,He)|0,j=j+Math.imul(oe,Ae)|0,O=O+Math.imul(te,Ee)|0,x=(x=x+Math.imul(te,Re)|0)+Math.imul(ie,Ee)|0,j=j+Math.imul(ie,Re)|0;var _t=(W+(O=O+Math.imul(we,Xe)|0)|0)+((8191&(x=(x=x+Math.imul(we,qe)|0)+Math.imul(be,Xe)|0))<<13)|0;W=((j=j+Math.imul(be,qe)|0)+(x>>>13)|0)+(_t>>>26)|0,_t&=67108863,O=Math.imul(ve,Et),x=(x=Math.imul(ve,nt))+Math.imul(Se,Et)|0,j=Math.imul(Se,nt),O=O+Math.imul(ne,pe)|0,x=(x=x+Math.imul(ne,me)|0)+Math.imul(ue,pe)|0,j=j+Math.imul(ue,me)|0,O=O+Math.imul(Z,He)|0,x=(x=x+Math.imul(Z,Ae)|0)+Math.imul(Q,He)|0,j=j+Math.imul(Q,Ae)|0,O=O+Math.imul(se,Ee)|0,x=(x=x+Math.imul(se,Re)|0)+Math.imul(oe,Ee)|0,j=j+Math.imul(oe,Re)|0;var gt=(W+(O=O+Math.imul(te,Xe)|0)|0)+((8191&(x=(x=x+Math.imul(te,qe)|0)+Math.imul(ie,Xe)|0))<<13)|0;W=((j=j+Math.imul(ie,qe)|0)+(x>>>13)|0)+(gt>>>26)|0,gt&=67108863,O=Math.imul(ve,pe),x=(x=Math.imul(ve,me))+Math.imul(Se,pe)|0,j=Math.imul(Se,me),O=O+Math.imul(ne,He)|0,x=(x=x+Math.imul(ne,Ae)|0)+Math.imul(ue,He)|0,j=j+Math.imul(ue,Ae)|0,O=O+Math.imul(Z,Ee)|0,x=(x=x+Math.imul(Z,Re)|0)+Math.imul(Q,Ee)|0,j=j+Math.imul(Q,Re)|0;var mt=(W+(O=O+Math.imul(se,Xe)|0)|0)+((8191&(x=(x=x+Math.imul(se,qe)|0)+Math.imul(oe,Xe)|0))<<13)|0;W=((j=j+Math.imul(oe,qe)|0)+(x>>>13)|0)+(mt>>>26)|0,mt&=67108863,O=Math.imul(ve,He),x=(x=Math.imul(ve,Ae))+Math.imul(Se,He)|0,j=Math.imul(Se,Ae),O=O+Math.imul(ne,Ee)|0,x=(x=x+Math.imul(ne,Re)|0)+Math.imul(ue,Ee)|0,j=j+Math.imul(ue,Re)|0;var st=(W+(O=O+Math.imul(Z,Xe)|0)|0)+((8191&(x=(x=x+Math.imul(Z,qe)|0)+Math.imul(Q,Xe)|0))<<13)|0;W=((j=j+Math.imul(Q,qe)|0)+(x>>>13)|0)+(st>>>26)|0,st&=67108863,O=Math.imul(ve,Ee),x=(x=Math.imul(ve,Re))+Math.imul(Se,Ee)|0,j=Math.imul(Se,Re);var zt=(W+(O=O+Math.imul(ne,Xe)|0)|0)+((8191&(x=(x=x+Math.imul(ne,qe)|0)+Math.imul(ue,Xe)|0))<<13)|0;W=((j=j+Math.imul(ue,qe)|0)+(x>>>13)|0)+(zt>>>26)|0,zt&=67108863;var Xt=(W+(O=Math.imul(ve,Xe))|0)+((8191&(x=(x=Math.imul(ve,qe))+Math.imul(Se,Xe)|0))<<13)|0;return W=((j=Math.imul(Se,qe))+(x>>>13)|0)+(Xt>>>26)|0,Xt&=67108863,V[0]=kt,V[1]=Ht,V[2]=jt,V[3]=dr,V[4]=vr,V[5]=Ur,V[6]=ae,V[7]=_e,V[8]=Pe,V[9]=Ne,V[10]=tt,V[11]=je,V[12]=Fe,V[13]=_t,V[14]=gt,V[15]=mt,V[16]=st,V[17]=zt,V[18]=Xt,W!==0&&(V[19]=W,k.length++),k};function _(S,E,k){k.negative=E.negative^S.negative,k.length=S.length+E.length;for(var O=0,x=0,j=0;j<k.length-1;j++){var H=x;x=0;for(var F=67108863&O,V=Math.min(j,E.length-1),W=Math.max(0,j-S.length+1);W<=V;W++){var U=j-W,Y=(0|S.words[U])*(0|E.words[W]),K=67108863&Y;F=67108863&(K=K+F|0),x+=(H=(H=H+(Y/67108864|0)|0)+(K>>>26)|0)>>>26,H&=67108863}k.words[j]=F,O=H,H=x}return O!==0?k.words[j]=O:k.length--,k._strip()}function C(S,E,k){return _(S,E,k)}Math.imul||(w=b),d.prototype.mulTo=function(S,E){var k=this.length+S.length;return this.length===10&&S.length===10?w(this,S,E):k<63?b(this,S,E):k<1024?_(this,S,E):C(this,S,E)},d.prototype.mul=function(S){var E=new d(null);return E.words=new Array(this.length+S.length),this.mulTo(S,E)},d.prototype.mulf=function(S){var E=new d(null);return E.words=new Array(this.length+S.length),C(this,S,E)},d.prototype.imul=function(S){return this.clone().mulTo(S,this)},d.prototype.imuln=function(S){var E=S<0;E&&(S=-S),l(typeof S=="number"),l(S<67108864);for(var k=0,O=0;O<this.length;O++){var x=(0|this.words[O])*S,j=(67108863&x)+(67108863&k);k>>=26,k+=x/67108864|0,k+=j>>>26,this.words[O]=67108863&j}return k!==0&&(this.words[O]=k,this.length++),E?this.ineg():this},d.prototype.muln=function(S){return this.clone().imuln(S)},d.prototype.sqr=function(){return this.mul(this)},d.prototype.isqr=function(){return this.imul(this.clone())},d.prototype.pow=function(S){var E=function(j){for(var H=new Array(j.bitLength()),F=0;F<H.length;F++){var V=F/26|0,W=F%26;H[F]=j.words[V]>>>W&1}return H}(S);if(E.length===0)return new d(1);for(var k=this,O=0;O<E.length&&E[O]===0;O++,k=k.sqr());if(++O<E.length)for(var x=k.sqr();O<E.length;O++,x=x.sqr())E[O]!==0&&(k=k.mul(x));return k},d.prototype.iushln=function(S){l(typeof S=="number"&&S>=0);var E,k=S%26,O=(S-k)/26,x=67108863>>>26-k<<26-k;if(k!==0){var j=0;for(E=0;E<this.length;E++){var H=this.words[E]&x,F=(0|this.words[E])-H<<k;this.words[E]=F|j,j=H>>>26-k}j&&(this.words[E]=j,this.length++)}if(O!==0){for(E=this.length-1;E>=0;E--)this.words[E+O]=this.words[E];for(E=0;E<O;E++)this.words[E]=0;this.length+=O}return this._strip()},d.prototype.ishln=function(S){return l(this.negative===0),this.iushln(S)},d.prototype.iushrn=function(S,E,k){var O;l(typeof S=="number"&&S>=0),O=E?(E-E%26)/26:0;var x=S%26,j=Math.min((S-x)/26,this.length),H=67108863^67108863>>>x<<x,F=k;if(O-=j,O=Math.max(0,O),F){for(var V=0;V<j;V++)F.words[V]=this.words[V];F.length=j}if(j!==0)if(this.length>j)for(this.length-=j,V=0;V<this.length;V++)this.words[V]=this.words[V+j];else this.words[0]=0,this.length=1;var W=0;for(V=this.length-1;V>=0&&(W!==0||V>=O);V--){var U=0|this.words[V];this.words[V]=W<<26-x|U>>>x,W=U&H}return F&&W!==0&&(F.words[F.length++]=W),this.length===0&&(this.words[0]=0,this.length=1),this._strip()},d.prototype.ishrn=function(S,E,k){return l(this.negative===0),this.iushrn(S,E,k)},d.prototype.shln=function(S){return this.clone().ishln(S)},d.prototype.ushln=function(S){return this.clone().iushln(S)},d.prototype.shrn=function(S){return this.clone().ishrn(S)},d.prototype.ushrn=function(S){return this.clone().iushrn(S)},d.prototype.testn=function(S){l(typeof S=="number"&&S>=0);var E=S%26,k=(S-E)/26,O=1<<E;return!(this.length<=k)&&!!(this.words[k]&O)},d.prototype.imaskn=function(S){l(typeof S=="number"&&S>=0);var E=S%26,k=(S-E)/26;if(l(this.negative===0,"imaskn works only with positive numbers"),this.length<=k)return this;if(E!==0&&k++,this.length=Math.min(k,this.length),E!==0){var O=67108863^67108863>>>E<<E;this.words[this.length-1]&=O}return this._strip()},d.prototype.maskn=function(S){return this.clone().imaskn(S)},d.prototype.iaddn=function(S){return l(typeof S=="number"),l(S<67108864),S<0?this.isubn(-S):this.negative!==0?this.length===1&&(0|this.words[0])<=S?(this.words[0]=S-(0|this.words[0]),this.negative=0,this):(this.negative=0,this.isubn(S),this.negative=1,this):this._iaddn(S)},d.prototype._iaddn=function(S){this.words[0]+=S;for(var E=0;E<this.length&&this.words[E]>=67108864;E++)this.words[E]-=67108864,E===this.length-1?this.words[E+1]=1:this.words[E+1]++;return this.length=Math.max(this.length,E+1),this},d.prototype.isubn=function(S){if(l(typeof S=="number"),l(S<67108864),S<0)return this.iaddn(-S);if(this.negative!==0)return this.negative=0,this.iaddn(S),this.negative=1,this;if(this.words[0]-=S,this.length===1&&this.words[0]<0)this.words[0]=-this.words[0],this.negative=1;else for(var E=0;E<this.length&&this.words[E]<0;E++)this.words[E]+=67108864,this.words[E+1]-=1;return this._strip()},d.prototype.addn=function(S){return this.clone().iaddn(S)},d.prototype.subn=function(S){return this.clone().isubn(S)},d.prototype.iabs=function(){return this.negative=0,this},d.prototype.abs=function(){return this.clone().iabs()},d.prototype._ishlnsubmul=function(S,E,k){var O,x,j=S.length+k;this._expand(j);var H=0;for(O=0;O<S.length;O++){x=(0|this.words[O+k])+H;var F=(0|S.words[O])*E;H=((x-=67108863&F)>>26)-(F/67108864|0),this.words[O+k]=67108863&x}for(;O<this.length-k;O++)H=(x=(0|this.words[O+k])+H)>>26,this.words[O+k]=67108863&x;if(H===0)return this._strip();for(l(H===-1),H=0,O=0;O<this.length;O++)H=(x=-(0|this.words[O])+H)>>26,this.words[O]=67108863&x;return this.negative=1,this._strip()},d.prototype._wordDiv=function(S,E){var k=(this.length,S.length),O=this.clone(),x=S,j=0|x.words[x.length-1];(k=26-this._countBits(j))!=0&&(x=x.ushln(k),O.iushln(k),j=0|x.words[x.length-1]);var H,F=O.length-x.length;if(E!=="mod"){(H=new d(null)).length=F+1,H.words=new Array(H.length);for(var V=0;V<H.length;V++)H.words[V]=0}var W=O.clone()._ishlnsubmul(x,1,F);W.negative===0&&(O=W,H&&(H.words[F]=1));for(var U=F-1;U>=0;U--){var Y=67108864*(0|O.words[x.length+U])+(0|O.words[x.length+U-1]);for(Y=Math.min(Y/j|0,67108863),O._ishlnsubmul(x,Y,U);O.negative!==0;)Y--,O.negative=0,O._ishlnsubmul(x,1,U),O.isZero()||(O.negative^=1);H&&(H.words[U]=Y)}return H&&H._strip(),O._strip(),E!=="div"&&k!==0&&O.iushrn(k),{div:H||null,mod:O}},d.prototype.divmod=function(S,E,k){return l(!S.isZero()),this.isZero()?{div:new d(0),mod:new d(0)}:this.negative!==0&&S.negative===0?(j=this.neg().divmod(S,E),E!=="mod"&&(O=j.div.neg()),E!=="div"&&(x=j.mod.neg(),k&&x.negative!==0&&x.iadd(S)),{div:O,mod:x}):this.negative===0&&S.negative!==0?(j=this.divmod(S.neg(),E),E!=="mod"&&(O=j.div.neg()),{div:O,mod:j.mod}):(this.negative&S.negative)!=0?(j=this.neg().divmod(S.neg(),E),E!=="div"&&(x=j.mod.neg(),k&&x.negative!==0&&x.isub(S)),{div:j.div,mod:x}):S.length>this.length||this.cmp(S)<0?{div:new d(0),mod:this}:S.length===1?E==="div"?{div:this.divn(S.words[0]),mod:null}:E==="mod"?{div:null,mod:new d(this.modrn(S.words[0]))}:{div:this.divn(S.words[0]),mod:new d(this.modrn(S.words[0]))}:this._wordDiv(S,E);var O,x,j},d.prototype.div=function(S){return this.divmod(S,"div",!1).div},d.prototype.mod=function(S){return this.divmod(S,"mod",!1).mod},d.prototype.umod=function(S){return this.divmod(S,"mod",!0).mod},d.prototype.divRound=function(S){var E=this.divmod(S);if(E.mod.isZero())return E.div;var k=E.div.negative!==0?E.mod.isub(S):E.mod,O=S.ushrn(1),x=S.andln(1),j=k.cmp(O);return j<0||x===1&&j===0?E.div:E.div.negative!==0?E.div.isubn(1):E.div.iaddn(1)},d.prototype.modrn=function(S){var E=S<0;E&&(S=-S),l(S<=67108863);for(var k=(1<<26)%S,O=0,x=this.length-1;x>=0;x--)O=(k*O+(0|this.words[x]))%S;return E?-O:O},d.prototype.modn=function(S){return this.modrn(S)},d.prototype.idivn=function(S){var E=S<0;E&&(S=-S),l(S<=67108863);for(var k=0,O=this.length-1;O>=0;O--){var x=(0|this.words[O])+67108864*k;this.words[O]=x/S|0,k=x%S}return this._strip(),E?this.ineg():this},d.prototype.divn=function(S){return this.clone().idivn(S)},d.prototype.egcd=function(S){l(S.negative===0),l(!S.isZero());var E=this,k=S.clone();E=E.negative!==0?E.umod(S):E.clone();for(var O=new d(1),x=new d(0),j=new d(0),H=new d(1),F=0;E.isEven()&&k.isEven();)E.iushrn(1),k.iushrn(1),++F;for(var V=k.clone(),W=E.clone();!E.isZero();){for(var U=0,Y=1;(E.words[0]&Y)==0&&U<26;++U,Y<<=1);if(U>0)for(E.iushrn(U);U-- >0;)(O.isOdd()||x.isOdd())&&(O.iadd(V),x.isub(W)),O.iushrn(1),x.iushrn(1);for(var K=0,D=1;(k.words[0]&D)==0&&K<26;++K,D<<=1);if(K>0)for(k.iushrn(K);K-- >0;)(j.isOdd()||H.isOdd())&&(j.iadd(V),H.isub(W)),j.iushrn(1),H.iushrn(1);E.cmp(k)>=0?(E.isub(k),O.isub(j),x.isub(H)):(k.isub(E),j.isub(O),H.isub(x))}return{a:j,b:H,gcd:k.iushln(F)}},d.prototype._invmp=function(S){l(S.negative===0),l(!S.isZero());var E=this,k=S.clone();E=E.negative!==0?E.umod(S):E.clone();for(var O,x=new d(1),j=new d(0),H=k.clone();E.cmpn(1)>0&&k.cmpn(1)>0;){for(var F=0,V=1;(E.words[0]&V)==0&&F<26;++F,V<<=1);if(F>0)for(E.iushrn(F);F-- >0;)x.isOdd()&&x.iadd(H),x.iushrn(1);for(var W=0,U=1;(k.words[0]&U)==0&&W<26;++W,U<<=1);if(W>0)for(k.iushrn(W);W-- >0;)j.isOdd()&&j.iadd(H),j.iushrn(1);E.cmp(k)>=0?(E.isub(k),x.isub(j)):(k.isub(E),j.isub(x))}return(O=E.cmpn(1)===0?x:j).cmpn(0)<0&&O.iadd(S),O},d.prototype.gcd=function(S){if(this.isZero())return S.abs();if(S.isZero())return this.abs();var E=this.clone(),k=S.clone();E.negative=0,k.negative=0;for(var O=0;E.isEven()&&k.isEven();O++)E.iushrn(1),k.iushrn(1);for(;;){for(;E.isEven();)E.iushrn(1);for(;k.isEven();)k.iushrn(1);var x=E.cmp(k);if(x<0){var j=E;E=k,k=j}else if(x===0||k.cmpn(1)===0)break;E.isub(k)}return k.iushln(O)},d.prototype.invm=function(S){return this.egcd(S).a.umod(S)},d.prototype.isEven=function(){return(1&this.words[0])==0},d.prototype.isOdd=function(){return(1&this.words[0])==1},d.prototype.andln=function(S){return this.words[0]&S},d.prototype.bincn=function(S){l(typeof S=="number");var E=S%26,k=(S-E)/26,O=1<<E;if(this.length<=k)return this._expand(k+1),this.words[k]|=O,this;for(var x=O,j=k;x!==0&&j<this.length;j++){var H=0|this.words[j];x=(H+=x)>>>26,H&=67108863,this.words[j]=H}return x!==0&&(this.words[j]=x,this.length++),this},d.prototype.isZero=function(){return this.length===1&&this.words[0]===0},d.prototype.cmpn=function(S){var E,k=S<0;if(this.negative!==0&&!k)return-1;if(this.negative===0&&k)return 1;if(this._strip(),this.length>1)E=1;else{k&&(S=-S),l(S<=67108863,"Number is too big");var O=0|this.words[0];E=O===S?0:O<S?-1:1}return this.negative!==0?0|-E:E},d.prototype.cmp=function(S){if(this.negative!==0&&S.negative===0)return-1;if(this.negative===0&&S.negative!==0)return 1;var E=this.ucmp(S);return this.negative!==0?0|-E:E},d.prototype.ucmp=function(S){if(this.length>S.length)return 1;if(this.length<S.length)return-1;for(var E=0,k=this.length-1;k>=0;k--){var O=0|this.words[k],x=0|S.words[k];if(O!==x){O<x?E=-1:O>x&&(E=1);break}}return E},d.prototype.gtn=function(S){return this.cmpn(S)===1},d.prototype.gt=function(S){return this.cmp(S)===1},d.prototype.gten=function(S){return this.cmpn(S)>=0},d.prototype.gte=function(S){return this.cmp(S)>=0},d.prototype.ltn=function(S){return this.cmpn(S)===-1},d.prototype.lt=function(S){return this.cmp(S)===-1},d.prototype.lten=function(S){return this.cmpn(S)<=0},d.prototype.lte=function(S){return this.cmp(S)<=0},d.prototype.eqn=function(S){return this.cmpn(S)===0},d.prototype.eq=function(S){return this.cmp(S)===0},d.red=function(S){return new T(S)},d.prototype.toRed=function(S){return l(!this.red,"Already a number in reduction context"),l(this.negative===0,"red works only with positives"),S.convertTo(this)._forceRed(S)},d.prototype.fromRed=function(){return l(this.red,"fromRed works only with numbers in reduction context"),this.red.convertFrom(this)},d.prototype._forceRed=function(S){return this.red=S,this},d.prototype.forceRed=function(S){return l(!this.red,"Already a number in reduction context"),this._forceRed(S)},d.prototype.redAdd=function(S){return l(this.red,"redAdd works only with red numbers"),this.red.add(this,S)},d.prototype.redIAdd=function(S){return l(this.red,"redIAdd works only with red numbers"),this.red.iadd(this,S)},d.prototype.redSub=function(S){return l(this.red,"redSub works only with red numbers"),this.red.sub(this,S)},d.prototype.redISub=function(S){return l(this.red,"redISub works only with red numbers"),this.red.isub(this,S)},d.prototype.redShl=function(S){return l(this.red,"redShl works only with red numbers"),this.red.shl(this,S)},d.prototype.redMul=function(S){return l(this.red,"redMul works only with red numbers"),this.red._verify2(this,S),this.red.mul(this,S)},d.prototype.redIMul=function(S){return l(this.red,"redMul works only with red numbers"),this.red._verify2(this,S),this.red.imul(this,S)},d.prototype.redSqr=function(){return l(this.red,"redSqr works only with red numbers"),this.red._verify1(this),this.red.sqr(this)},d.prototype.redISqr=function(){return l(this.red,"redISqr works only with red numbers"),this.red._verify1(this),this.red.isqr(this)},d.prototype.redSqrt=function(){return l(this.red,"redSqrt works only with red numbers"),this.red._verify1(this),this.red.sqrt(this)},d.prototype.redInvm=function(){return l(this.red,"redInvm works only with red numbers"),this.red._verify1(this),this.red.invm(this)},d.prototype.redNeg=function(){return l(this.red,"redNeg works only with red numbers"),this.red._verify1(this),this.red.neg(this)},d.prototype.redPow=function(S){return l(this.red&&!S.red,"redPow(normalNum)"),this.red._verify1(this),this.red.pow(this,S)};var R={k256:null,p224:null,p192:null,p25519:null};function I(S,E){this.name=S,this.p=new d(E,16),this.n=this.p.bitLength(),this.k=new d(1).iushln(this.n).isub(this.p),this.tmp=this._tmp()}function P(){I.call(this,"k256","ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe fffffc2f")}function N(){I.call(this,"p224","ffffffff ffffffff ffffffff ffffffff 00000000 00000000 00000001")}function A(){I.call(this,"p192","ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff")}function $(){I.call(this,"25519","7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed")}function T(S){if(typeof S=="string"){var E=d._prime(S);this.m=E.p,this.prime=E}else l(S.gtn(1),"modulus must be greater than 1"),this.m=S,this.prime=null}function M(S){T.call(this,S),this.shift=this.m.bitLength(),this.shift%26!=0&&(this.shift+=26-this.shift%26),this.r=new d(1).iushln(this.shift),this.r2=this.imod(this.r.sqr()),this.rinv=this.r._invmp(this.m),this.minv=this.rinv.mul(this.r).isubn(1).div(this.m),this.minv=this.minv.umod(this.r),this.minv=this.r.sub(this.minv)}I.prototype._tmp=function(){var S=new d(null);return S.words=new Array(Math.ceil(this.n/13)),S},I.prototype.ireduce=function(S){var E,k=S;do this.split(k,this.tmp),E=(k=(k=this.imulK(k)).iadd(this.tmp)).bitLength();while(E>this.n);var O=E<this.n?-1:k.ucmp(this.p);return O===0?(k.words[0]=0,k.length=1):O>0?k.isub(this.p):k.strip!==void 0?k.strip():k._strip(),k},I.prototype.split=function(S,E){S.iushrn(this.n,0,E)},I.prototype.imulK=function(S){return S.imul(this.k)},p(P,I),P.prototype.split=function(S,E){for(var k=Math.min(S.length,9),O=0;O<k;O++)E.words[O]=S.words[O];if(E.length=k,S.length<=9)return S.words[0]=0,void(S.length=1);var x=S.words[9];for(E.words[E.length++]=4194303&x,O=10;O<S.length;O++){var j=0|S.words[O];S.words[O-10]=(4194303&j)<<4|x>>>22,x=j}x>>>=22,S.words[O-10]=x,x===0&&S.length>10?S.length-=10:S.length-=9},P.prototype.imulK=function(S){S.words[S.length]=0,S.words[S.length+1]=0,S.length+=2;for(var E=0,k=0;k<S.length;k++){var O=0|S.words[k];E+=977*O,S.words[k]=67108863&E,E=64*O+(E/67108864|0)}return S.words[S.length-1]===0&&(S.length--,S.words[S.length-1]===0&&S.length--),S},p(N,I),p(A,I),p($,I),$.prototype.imulK=function(S){for(var E=0,k=0;k<S.length;k++){var O=19*(0|S.words[k])+E,x=67108863&O;O>>>=26,S.words[k]=x,E=O}return E!==0&&(S.words[S.length++]=E),S},d._prime=function(S){if(R[S])return R[S];var E;if(S==="k256")E=new P;else if(S==="p224")E=new N;else if(S==="p192")E=new A;else{if(S!=="p25519")throw new Error("Unknown prime "+S);E=new $}return R[S]=E,E},T.prototype._verify1=function(S){l(S.negative===0,"red works only with positives"),l(S.red,"red works only with red numbers")},T.prototype._verify2=function(S,E){l((S.negative|E.negative)==0,"red works only with positives"),l(S.red&&S.red===E.red,"red works only with red numbers")},T.prototype.imod=function(S){return this.prime?this.prime.ireduce(S)._forceRed(this):(u(S,S.umod(this.m)._forceRed(this)),S)},T.prototype.neg=function(S){return S.isZero()?S.clone():this.m.sub(S)._forceRed(this)},T.prototype.add=function(S,E){this._verify2(S,E);var k=S.add(E);return k.cmp(this.m)>=0&&k.isub(this.m),k._forceRed(this)},T.prototype.iadd=function(S,E){this._verify2(S,E);var k=S.iadd(E);return k.cmp(this.m)>=0&&k.isub(this.m),k},T.prototype.sub=function(S,E){this._verify2(S,E);var k=S.sub(E);return k.cmpn(0)<0&&k.iadd(this.m),k._forceRed(this)},T.prototype.isub=function(S,E){this._verify2(S,E);var k=S.isub(E);return k.cmpn(0)<0&&k.iadd(this.m),k},T.prototype.shl=function(S,E){return this._verify1(S),this.imod(S.ushln(E))},T.prototype.imul=function(S,E){return this._verify2(S,E),this.imod(S.imul(E))},T.prototype.mul=function(S,E){return this._verify2(S,E),this.imod(S.mul(E))},T.prototype.isqr=function(S){return this.imul(S,S.clone())},T.prototype.sqr=function(S){return this.mul(S,S)},T.prototype.sqrt=function(S){if(S.isZero())return S.clone();var E=this.m.andln(3);if(l(E%2==1),E===3){var k=this.m.add(new d(1)).iushrn(2);return this.pow(S,k)}for(var O=this.m.subn(1),x=0;!O.isZero()&&O.andln(1)===0;)x++,O.iushrn(1);l(!O.isZero());var j=new d(1).toRed(this),H=j.redNeg(),F=this.m.subn(1).iushrn(1),V=this.m.bitLength();for(V=new d(2*V*V).toRed(this);this.pow(V,F).cmp(H)!==0;)V.redIAdd(H);for(var W=this.pow(V,O),U=this.pow(S,O.addn(1).iushrn(1)),Y=this.pow(S,O),K=x;Y.cmp(j)!==0;){for(var D=Y,L=0;D.cmp(j)!==0;L++)D=D.redSqr();l(L<K);var B=this.pow(W,new d(1).iushln(K-L-1));U=U.redMul(B),W=B.redSqr(),Y=Y.redMul(W),K=L}return U},T.prototype.invm=function(S){var E=S._invmp(this.m);return E.negative!==0?(E.negative=0,this.imod(E).redNeg()):this.imod(E)},T.prototype.pow=function(S,E){if(E.isZero())return new d(1).toRed(this);if(E.cmpn(1)===0)return S.clone();var k=new Array(16);k[0]=new d(1).toRed(this),k[1]=S;for(var O=2;O<k.length;O++)k[O]=this.mul(k[O-1],S);var x=k[0],j=0,H=0,F=E.bitLength()%26;for(F===0&&(F=26),O=E.length-1;O>=0;O--){for(var V=E.words[O],W=F-1;W>=0;W--){var U=V>>W&1;x!==k[0]&&(x=this.sqr(x)),U!==0||j!==0?(j<<=1,j|=U,(++H==4||O===0&&W===0)&&(x=this.mul(x,k[j]),H=0,j=0)):H=0}F=26}return x},T.prototype.convertTo=function(S){var E=S.umod(this.m);return E===S?E.clone():E},T.prototype.convertFrom=function(S){var E=S.clone();return E.red=null,E},d.mont=function(S){return new M(S)},p(M,T),M.prototype.convertTo=function(S){return this.imod(S.ushln(this.shift))},M.prototype.convertFrom=function(S){var E=this.imod(S.mul(this.rinv));return E.red=null,E},M.prototype.imul=function(S,E){if(S.isZero()||E.isZero())return S.words[0]=0,S.length=1,S;var k=S.imul(E),O=k.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),x=k.isub(O).iushrn(this.shift),j=x;return x.cmp(this.m)>=0?j=x.isub(this.m):x.cmpn(0)<0&&(j=x.iadd(this.m)),j._forceRed(this)},M.prototype.mul=function(S,E){if(S.isZero()||E.isZero())return new d(0)._forceRed(this);var k=S.mul(E),O=k.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),x=k.isub(O).iushrn(this.shift),j=x;return x.cmp(this.m)>=0?j=x.isub(this.m):x.cmpn(0)<0&&(j=x.iadd(this.m)),j._forceRed(this)},M.prototype.invm=function(S){return this.imod(S._invmp(this.m).mul(this.r2))._forceRed(this)}})(n===void 0||n)},{buffer:185}],184:[function(e,n,i){function o(p){return(o=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(d){return typeof d}:function(d){return d&&typeof Symbol=="function"&&d.constructor===Symbol&&d!==Symbol.prototype?"symbol":typeof d})(p)}var a;function s(p){this.rand=p}if(n.exports=function(p){return a||(a=new s(null)),a.generate(p)},n.exports.Rand=s,s.prototype.generate=function(p){return this._rand(p)},s.prototype._rand=function(p){if(this.rand.getBytes)return this.rand.getBytes(p);for(var d=new Uint8Array(p),g=0;g<d.length;g++)d[g]=this.rand.getByte();return d},(typeof self=="undefined"?"undefined":o(self))==="object")self.crypto&&self.crypto.getRandomValues?s.prototype._rand=function(p){var d=new Uint8Array(p);return self.crypto.getRandomValues(d),d}:self.msCrypto&&self.msCrypto.getRandomValues?s.prototype._rand=function(p){var d=new Uint8Array(p);return self.msCrypto.getRandomValues(d),d}:(typeof window=="undefined"?"undefined":o(window))==="object"&&(s.prototype._rand=function(){throw new Error("Not implemented yet")});else try{var l=e("crypto");if(typeof l.randomBytes!="function")throw new Error("Not supported");s.prototype._rand=function(p){return l.randomBytes(p)}}catch{}},{crypto:185}],185:[function(e,n,i){},{}],186:[function(e,n,i){var o=e("safe-buffer").Buffer;function a(y){o.isBuffer(y)||(y=o.from(y));for(var h=y.length/4|0,u=new Array(h),f=0;f<h;f++)u[f]=y.readUInt32BE(4*f);return u}function s(y){for(;0<y.length;y++)y[0]=0}function l(y,h,u,f,c){for(var v,m,b,w,_=u[0],C=u[1],R=u[2],I=u[3],P=y[0]^h[0],N=y[1]^h[1],A=y[2]^h[2],$=y[3]^h[3],T=4,M=1;M<c;M++)v=_[P>>>24]^C[N>>>16&255]^R[A>>>8&255]^I[255&$]^h[T++],m=_[N>>>24]^C[A>>>16&255]^R[$>>>8&255]^I[255&P]^h[T++],b=_[A>>>24]^C[$>>>16&255]^R[P>>>8&255]^I[255&N]^h[T++],w=_[$>>>24]^C[P>>>16&255]^R[N>>>8&255]^I[255&A]^h[T++],P=v,N=m,A=b,$=w;return v=(f[P>>>24]<<24|f[N>>>16&255]<<16|f[A>>>8&255]<<8|f[255&$])^h[T++],m=(f[N>>>24]<<24|f[A>>>16&255]<<16|f[$>>>8&255]<<8|f[255&P])^h[T++],b=(f[A>>>24]<<24|f[$>>>16&255]<<16|f[P>>>8&255]<<8|f[255&N])^h[T++],w=(f[$>>>24]<<24|f[P>>>16&255]<<16|f[N>>>8&255]<<8|f[255&A])^h[T++],[v>>>=0,m>>>=0,b>>>=0,w>>>=0]}var p=[0,1,2,4,8,16,32,64,128,27,54],d=function(){for(var y=new Array(256),h=0;h<256;h++)y[h]=h<128?h<<1:h<<1^283;for(var u=[],f=[],c=[[],[],[],[]],v=[[],[],[],[]],m=0,b=0,w=0;w<256;++w){var _=b^b<<1^b<<2^b<<3^b<<4;_=_>>>8^255&_^99,u[m]=_,f[_]=m;var C=y[m],R=y[C],I=y[R],P=257*y[_]^16843008*_;c[0][m]=P<<24|P>>>8,c[1][m]=P<<16|P>>>16,c[2][m]=P<<8|P>>>24,c[3][m]=P,P=16843009*I^65537*R^257*C^16843008*m,v[0][_]=P<<24|P>>>8,v[1][_]=P<<16|P>>>16,v[2][_]=P<<8|P>>>24,v[3][_]=P,m===0?m=b=1:(m=C^y[y[y[I^C]]],b^=y[y[b]])}return{SBOX:u,INV_SBOX:f,SUB_MIX:c,INV_SUB_MIX:v}}();function g(y){this._key=a(y),this._reset()}g.blockSize=16,g.keySize=32,g.prototype.blockSize=g.blockSize,g.prototype.keySize=g.keySize,g.prototype._reset=function(){for(var y=this._key,h=y.length,u=h+6,f=4*(u+1),c=[],v=0;v<h;v++)c[v]=y[v];for(v=h;v<f;v++){var m=c[v-1];v%h==0?(m=m<<8|m>>>24,m=d.SBOX[m>>>24]<<24|d.SBOX[m>>>16&255]<<16|d.SBOX[m>>>8&255]<<8|d.SBOX[255&m],m^=p[v/h|0]<<24):h>6&&v%h==4&&(m=d.SBOX[m>>>24]<<24|d.SBOX[m>>>16&255]<<16|d.SBOX[m>>>8&255]<<8|d.SBOX[255&m]),c[v]=c[v-h]^m}for(var b=[],w=0;w<f;w++){var _=f-w,C=c[_-(w%4?0:4)];b[w]=w<4||_<=4?C:d.INV_SUB_MIX[0][d.SBOX[C>>>24]]^d.INV_SUB_MIX[1][d.SBOX[C>>>16&255]]^d.INV_SUB_MIX[2][d.SBOX[C>>>8&255]]^d.INV_SUB_MIX[3][d.SBOX[255&C]]}this._nRounds=u,this._keySchedule=c,this._invKeySchedule=b},g.prototype.encryptBlockRaw=function(y){return l(y=a(y),this._keySchedule,d.SUB_MIX,d.SBOX,this._nRounds)},g.prototype.encryptBlock=function(y){var h=this.encryptBlockRaw(y),u=o.allocUnsafe(16);return u.writeUInt32BE(h[0],0),u.writeUInt32BE(h[1],4),u.writeUInt32BE(h[2],8),u.writeUInt32BE(h[3],12),u},g.prototype.decryptBlock=function(y){var h=(y=a(y))[1];y[1]=y[3],y[3]=h;var u=l(y,this._invKeySchedule,d.INV_SUB_MIX,d.INV_SBOX,this._nRounds),f=o.allocUnsafe(16);return f.writeUInt32BE(u[0],0),f.writeUInt32BE(u[3],4),f.writeUInt32BE(u[2],8),f.writeUInt32BE(u[1],12),f},g.prototype.scrub=function(){s(this._keySchedule),s(this._invKeySchedule),s(this._key)},n.exports.AES=g},{"safe-buffer":494}],187:[function(e,n,i){var o=e("./aes"),a=e("safe-buffer").Buffer,s=e("cipher-base"),l=e("inherits"),p=e("./ghash"),d=e("buffer-xor"),g=e("./incr32");function y(h,u,f,c){s.call(this);var v=a.alloc(4,0);this._cipher=new o.AES(u);var m=this._cipher.encryptBlock(v);this._ghash=new p(m),f=function(b,w,_){if(w.length===12)return b._finID=a.concat([w,a.from([0,0,0,1])]),a.concat([w,a.from([0,0,0,2])]);var C=new p(_),R=w.length,I=R%16;C.update(w),I&&(I=16-I,C.update(a.alloc(I,0))),C.update(a.alloc(8,0));var P=8*R,N=a.alloc(8);N.writeUIntBE(P,0,8),C.update(N),b._finID=C.state;var A=a.from(b._finID);return g(A),A}(this,f,m),this._prev=a.from(f),this._cache=a.allocUnsafe(0),this._secCache=a.allocUnsafe(0),this._decrypt=c,this._alen=0,this._len=0,this._mode=h,this._authTag=null,this._called=!1}l(y,s),y.prototype._update=function(h){if(!this._called&&this._alen){var u=16-this._alen%16;u<16&&(u=a.alloc(u,0),this._ghash.update(u))}this._called=!0;var f=this._mode.encrypt(this,h);return this._decrypt?this._ghash.update(h):this._ghash.update(f),this._len+=h.length,f},y.prototype._final=function(){if(this._decrypt&&!this._authTag)throw new Error("Unsupported state or unable to authenticate data");var h=d(this._ghash.final(8*this._alen,8*this._len),this._cipher.encryptBlock(this._finID));if(this._decrypt&&function(u,f){var c=0;u.length!==f.length&&c++;for(var v=Math.min(u.length,f.length),m=0;m<v;++m)c+=u[m]^f[m];return c}(h,this._authTag))throw new Error("Unsupported state or unable to authenticate data");this._authTag=h,this._cipher.scrub()},y.prototype.getAuthTag=function(){if(this._decrypt||!a.isBuffer(this._authTag))throw new Error("Attempting to get auth tag in unsupported state");return this._authTag},y.prototype.setAuthTag=function(h){if(!this._decrypt)throw new Error("Attempting to set auth tag in unsupported state");this._authTag=h},y.prototype.setAAD=function(h){if(this._called)throw new Error("Attempting to set AAD in unsupported state");this._ghash.update(h),this._alen+=h.length},n.exports=y},{"./aes":186,"./ghash":191,"./incr32":192,"buffer-xor":217,"cipher-base":218,inherits:387,"safe-buffer":494}],188:[function(e,n,i){var o=e("./encrypter"),a=e("./decrypter"),s=e("./modes/list.json");i.createCipher=i.Cipher=o.createCipher,i.createCipheriv=i.Cipheriv=o.createCipheriv,i.createDecipher=i.Decipher=a.createDecipher,i.createDecipheriv=i.Decipheriv=a.createDecipheriv,i.listCiphers=i.getCiphers=function(){return Object.keys(s)}},{"./decrypter":189,"./encrypter":190,"./modes/list.json":200}],189:[function(e,n,i){var o=e("./authCipher"),a=e("safe-buffer").Buffer,s=e("./modes"),l=e("./streamCipher"),p=e("cipher-base"),d=e("./aes"),g=e("evp_bytestokey");function y(f,c,v){p.call(this),this._cache=new h,this._last=void 0,this._cipher=new d.AES(c),this._prev=a.from(v),this._mode=f,this._autopadding=!0}function h(){this.cache=a.allocUnsafe(0)}function u(f,c,v){var m=s[f.toLowerCase()];if(!m)throw new TypeError("invalid suite type");if(typeof v=="string"&&(v=a.from(v)),m.mode!=="GCM"&&v.length!==m.iv)throw new TypeError("invalid iv length "+v.length);if(typeof c=="string"&&(c=a.from(c)),c.length!==m.key/8)throw new TypeError("invalid key length "+c.length);return m.type==="stream"?new l(m.module,c,v,!0):m.type==="auth"?new o(m.module,c,v,!0):new y(m.module,c,v)}e("inherits")(y,p),y.prototype._update=function(f){var c,v;this._cache.add(f);for(var m=[];c=this._cache.get(this._autopadding);)v=this._mode.decrypt(this,c),m.push(v);return a.concat(m)},y.prototype._final=function(){var f=this._cache.flush();if(this._autopadding)return function(c){var v=c[15];if(v<1||v>16)throw new Error("unable to decrypt data");for(var m=-1;++m<v;)if(c[m+(16-v)]!==v)throw new Error("unable to decrypt data");if(v!==16)return c.slice(0,16-v)}(this._mode.decrypt(this,f));if(f)throw new Error("data not multiple of block length")},y.prototype.setAutoPadding=function(f){return this._autopadding=!!f,this},h.prototype.add=function(f){this.cache=a.concat([this.cache,f])},h.prototype.get=function(f){var c;if(f){if(this.cache.length>16)return c=this.cache.slice(0,16),this.cache=this.cache.slice(16),c}else if(this.cache.length>=16)return c=this.cache.slice(0,16),this.cache=this.cache.slice(16),c;return null},h.prototype.flush=function(){if(this.cache.length)return this.cache},i.createDecipher=function(f,c){var v=s[f.toLowerCase()];if(!v)throw new TypeError("invalid suite type");var m=g(c,!1,v.key,v.iv);return u(f,m.key,m.iv)},i.createDecipheriv=u},{"./aes":186,"./authCipher":187,"./modes":199,"./streamCipher":202,"cipher-base":218,evp_bytestokey:368,inherits:387,"safe-buffer":494}],190:[function(e,n,i){var o=e("./modes"),a=e("./authCipher"),s=e("safe-buffer").Buffer,l=e("./streamCipher"),p=e("cipher-base"),d=e("./aes"),g=e("evp_bytestokey");function y(c,v,m){p.call(this),this._cache=new u,this._cipher=new d.AES(v),this._prev=s.from(m),this._mode=c,this._autopadding=!0}e("inherits")(y,p),y.prototype._update=function(c){var v,m;this._cache.add(c);for(var b=[];v=this._cache.get();)m=this._mode.encrypt(this,v),b.push(m);return s.concat(b)};var h=s.alloc(16,16);function u(){this.cache=s.allocUnsafe(0)}function f(c,v,m){var b=o[c.toLowerCase()];if(!b)throw new TypeError("invalid suite type");if(typeof v=="string"&&(v=s.from(v)),v.length!==b.key/8)throw new TypeError("invalid key length "+v.length);if(typeof m=="string"&&(m=s.from(m)),b.mode!=="GCM"&&m.length!==b.iv)throw new TypeError("invalid iv length "+m.length);return b.type==="stream"?new l(b.module,v,m):b.type==="auth"?new a(b.module,v,m):new y(b.module,v,m)}y.prototype._final=function(){var c=this._cache.flush();if(this._autopadding)return c=this._mode.encrypt(this,c),this._cipher.scrub(),c;if(!c.equals(h))throw this._cipher.scrub(),new Error("data not multiple of block length")},y.prototype.setAutoPadding=function(c){return this._autopadding=!!c,this},u.prototype.add=function(c){this.cache=s.concat([this.cache,c])},u.prototype.get=function(){if(this.cache.length>15){var c=this.cache.slice(0,16);return this.cache=this.cache.slice(16),c}return null},u.prototype.flush=function(){for(var c=16-this.cache.length,v=s.allocUnsafe(c),m=-1;++m<c;)v.writeUInt8(c,m);return s.concat([this.cache,v])},i.createCipheriv=f,i.createCipher=function(c,v){var m=o[c.toLowerCase()];if(!m)throw new TypeError("invalid suite type");var b=g(v,!1,m.key,m.iv);return f(c,b.key,b.iv)}},{"./aes":186,"./authCipher":187,"./modes":199,"./streamCipher":202,"cipher-base":218,evp_bytestokey:368,inherits:387,"safe-buffer":494}],191:[function(e,n,i){var o=e("safe-buffer").Buffer,a=o.alloc(16,0);function s(p){var d=o.allocUnsafe(16);return d.writeUInt32BE(p[0]>>>0,0),d.writeUInt32BE(p[1]>>>0,4),d.writeUInt32BE(p[2]>>>0,8),d.writeUInt32BE(p[3]>>>0,12),d}function l(p){this.h=p,this.state=o.alloc(16,0),this.cache=o.allocUnsafe(0)}l.prototype.ghash=function(p){for(var d=-1;++d<p.length;)this.state[d]^=p[d];this._multiply()},l.prototype._multiply=function(){for(var p,d,g,y=[(p=this.h).readUInt32BE(0),p.readUInt32BE(4),p.readUInt32BE(8),p.readUInt32BE(12)],h=[0,0,0,0],u=-1;++u<128;){for((this.state[~~(u/8)]&1<<7-u%8)!=0&&(h[0]^=y[0],h[1]^=y[1],h[2]^=y[2],h[3]^=y[3]),g=(1&y[3])!=0,d=3;d>0;d--)y[d]=y[d]>>>1|(1&y[d-1])<<31;y[0]=y[0]>>>1,g&&(y[0]=y[0]^225<<24)}this.state=s(h)},l.prototype.update=function(p){var d;for(this.cache=o.concat([this.cache,p]);this.cache.length>=16;)d=this.cache.slice(0,16),this.cache=this.cache.slice(16),this.ghash(d)},l.prototype.final=function(p,d){return this.cache.length&&this.ghash(o.concat([this.cache,a],16)),this.ghash(s([0,p,0,d])),this.state},n.exports=l},{"safe-buffer":494}],192:[function(e,n,i){n.exports=function(o){for(var a,s=o.length;s--;){if((a=o.readUInt8(s))!==255){a++,o.writeUInt8(a,s);break}o.writeUInt8(0,s)}}},{}],193:[function(e,n,i){var o=e("buffer-xor");i.encrypt=function(a,s){var l=o(s,a._prev);return a._prev=a._cipher.encryptBlock(l),a._prev},i.decrypt=function(a,s){var l=a._prev;a._prev=s;var p=a._cipher.decryptBlock(s);return o(p,l)}},{"buffer-xor":217}],194:[function(e,n,i){var o=e("safe-buffer").Buffer,a=e("buffer-xor");function s(l,p,d){var g=p.length,y=a(p,l._cache);return l._cache=l._cache.slice(g),l._prev=o.concat([l._prev,d?p:y]),y}i.encrypt=function(l,p,d){for(var g,y=o.allocUnsafe(0);p.length;){if(l._cache.length===0&&(l._cache=l._cipher.encryptBlock(l._prev),l._prev=o.allocUnsafe(0)),!(l._cache.length<=p.length)){y=o.concat([y,s(l,p,d)]);break}g=l._cache.length,y=o.concat([y,s(l,p.slice(0,g),d)]),p=p.slice(g)}return y}},{"buffer-xor":217,"safe-buffer":494}],195:[function(e,n,i){var o=e("safe-buffer").Buffer;function a(l,p,d){for(var g,y,h=-1,u=0;++h<8;)g=p&1<<7-h?128:0,u+=(128&(y=l._cipher.encryptBlock(l._prev)[0]^g))>>h%8,l._prev=s(l._prev,d?g:y);return u}function s(l,p){var d=l.length,g=-1,y=o.allocUnsafe(l.length);for(l=o.concat([l,o.from([p])]);++g<d;)y[g]=l[g]<<1|l[g+1]>>7;return y}i.encrypt=function(l,p,d){for(var g=p.length,y=o.allocUnsafe(g),h=-1;++h<g;)y[h]=a(l,p[h],d);return y}},{"safe-buffer":494}],196:[function(e,n,i){var o=e("safe-buffer").Buffer;function a(s,l,p){var d=s._cipher.encryptBlock(s._prev)[0]^l;return s._prev=o.concat([s._prev.slice(1),o.from([p?l:d])]),d}i.encrypt=function(s,l,p){for(var d=l.length,g=o.allocUnsafe(d),y=-1;++y<d;)g[y]=a(s,l[y],p);return g}},{"safe-buffer":494}],197:[function(e,n,i){var o=e("buffer-xor"),a=e("safe-buffer").Buffer,s=e("../incr32");function l(p){var d=p._cipher.encryptBlockRaw(p._prev);return s(p._prev),d}i.encrypt=function(p,d){var g=Math.ceil(d.length/16),y=p._cache.length;p._cache=a.concat([p._cache,a.allocUnsafe(16*g)]);for(var h=0;h<g;h++){var u=l(p),f=y+16*h;p._cache.writeUInt32BE(u[0],f+0),p._cache.writeUInt32BE(u[1],f+4),p._cache.writeUInt32BE(u[2],f+8),p._cache.writeUInt32BE(u[3],f+12)}var c=p._cache.slice(0,d.length);return p._cache=p._cache.slice(d.length),o(d,c)}},{"../incr32":192,"buffer-xor":217,"safe-buffer":494}],198:[function(e,n,i){i.encrypt=function(o,a){return o._cipher.encryptBlock(a)},i.decrypt=function(o,a){return o._cipher.decryptBlock(a)}},{}],199:[function(e,n,i){var o={ECB:e("./ecb"),CBC:e("./cbc"),CFB:e("./cfb"),CFB8:e("./cfb8"),CFB1:e("./cfb1"),OFB:e("./ofb"),CTR:e("./ctr"),GCM:e("./ctr")},a=e("./list.json");for(var s in a)a[s].module=o[a[s].mode];n.exports=a},{"./cbc":193,"./cfb":194,"./cfb1":195,"./cfb8":196,"./ctr":197,"./ecb":198,"./list.json":200,"./ofb":201}],200:[function(e,n,i){n.exports={"aes-128-ecb":{cipher:"AES",key:128,iv:0,mode:"ECB",type:"block"},"aes-192-ecb":{cipher:"AES",key:192,iv:0,mode:"ECB",type:"block"},"aes-256-ecb":{cipher:"AES",key:256,iv:0,mode:"ECB",type:"block"},"aes-128-cbc":{cipher:"AES",key:128,iv:16,mode:"CBC",type:"block"},"aes-192-cbc":{cipher:"AES",key:192,iv:16,mode:"CBC",type:"block"},"aes-256-cbc":{cipher:"AES",key:256,iv:16,mode:"CBC",type:"block"},aes128:{cipher:"AES",key:128,iv:16,mode:"CBC",type:"block"},aes192:{cipher:"AES",key:192,iv:16,mode:"CBC",type:"block"},aes256:{cipher:"AES",key:256,iv:16,mode:"CBC",type:"block"},"aes-128-cfb":{cipher:"AES",key:128,iv:16,mode:"CFB",type:"stream"},"aes-192-cfb":{cipher:"AES",key:192,iv:16,mode:"CFB",type:"stream"},"aes-256-cfb":{cipher:"AES",key:256,iv:16,mode:"CFB",type:"stream"},"aes-128-cfb8":{cipher:"AES",key:128,iv:16,mode:"CFB8",type:"stream"},"aes-192-cfb8":{cipher:"AES",key:192,iv:16,mode:"CFB8",type:"stream"},"aes-256-cfb8":{cipher:"AES",key:256,iv:16,mode:"CFB8",type:"stream"},"aes-128-cfb1":{cipher:"AES",key:128,iv:16,mode:"CFB1",type:"stream"},"aes-192-cfb1":{cipher:"AES",key:192,iv:16,mode:"CFB1",type:"stream"},"aes-256-cfb1":{cipher:"AES",key:256,iv:16,mode:"CFB1",type:"stream"},"aes-128-ofb":{cipher:"AES",key:128,iv:16,mode:"OFB",type:"stream"},"aes-192-ofb":{cipher:"AES",key:192,iv:16,mode:"OFB",type:"stream"},"aes-256-ofb":{cipher:"AES",key:256,iv:16,mode:"OFB",type:"stream"},"aes-128-ctr":{cipher:"AES",key:128,iv:16,mode:"CTR",type:"stream"},"aes-192-ctr":{cipher:"AES",key:192,iv:16,mode:"CTR",type:"stream"},"aes-256-ctr":{cipher:"AES",key:256,iv:16,mode:"CTR",type:"stream"},"aes-128-gcm":{cipher:"AES",key:128,iv:12,mode:"GCM",type:"auth"},"aes-192-gcm":{cipher:"AES",key:192,iv:12,mode:"GCM",type:"auth"},"aes-256-gcm":{cipher:"AES",key:256,iv:12,mode:"GCM",type:"auth"}}},{}],201:[function(e,n,i){(function(o){var a=e("buffer-xor");function s(l){return l._prev=l._cipher.encryptBlock(l._prev),l._prev}i.encrypt=function(l,p){for(;l._cache.length<p.length;)l._cache=o.concat([l._cache,s(l)]);var d=l._cache.slice(0,p.length);return l._cache=l._cache.slice(p.length),a(p,d)}}).call(this,e("buffer").Buffer)},{buffer:216,"buffer-xor":217}],202:[function(e,n,i){var o=e("./aes"),a=e("safe-buffer").Buffer,s=e("cipher-base");function l(p,d,g,y){s.call(this),this._cipher=new o.AES(d),this._prev=a.from(g),this._cache=a.allocUnsafe(0),this._secCache=a.allocUnsafe(0),this._decrypt=y,this._mode=p}e("inherits")(l,s),l.prototype._update=function(p){return this._mode.encrypt(this,p,this._decrypt)},l.prototype._final=function(){this._cipher.scrub()},n.exports=l},{"./aes":186,"cipher-base":218,inherits:387,"safe-buffer":494}],203:[function(e,n,i){var o=e("browserify-des"),a=e("browserify-aes/browser"),s=e("browserify-aes/modes"),l=e("browserify-des/modes"),p=e("evp_bytestokey");function d(y,h,u){if(y=y.toLowerCase(),s[y])return a.createCipheriv(y,h,u);if(l[y])return new o({key:h,iv:u,mode:y});throw new TypeError("invalid suite type")}function g(y,h,u){if(y=y.toLowerCase(),s[y])return a.createDecipheriv(y,h,u);if(l[y])return new o({key:h,iv:u,mode:y,decrypt:!0});throw new TypeError("invalid suite type")}i.createCipher=i.Cipher=function(y,h){var u,f;if(y=y.toLowerCase(),s[y])u=s[y].key,f=s[y].iv;else{if(!l[y])throw new TypeError("invalid suite type");u=8*l[y].key,f=l[y].iv}var c=p(h,!1,u,f);return d(y,c.key,c.iv)},i.createCipheriv=i.Cipheriv=d,i.createDecipher=i.Decipher=function(y,h){var u,f;if(y=y.toLowerCase(),s[y])u=s[y].key,f=s[y].iv;else{if(!l[y])throw new TypeError("invalid suite type");u=8*l[y].key,f=l[y].iv}var c=p(h,!1,u,f);return g(y,c.key,c.iv)},i.createDecipheriv=i.Decipheriv=g,i.listCiphers=i.getCiphers=function(){return Object.keys(l).concat(a.getCiphers())}},{"browserify-aes/browser":188,"browserify-aes/modes":199,"browserify-des":204,"browserify-des/modes":205,evp_bytestokey:368}],204:[function(e,n,i){var o=e("cipher-base"),a=e("des.js"),s=e("inherits"),l=e("safe-buffer").Buffer,p={"des-ede3-cbc":a.CBC.instantiate(a.EDE),"des-ede3":a.EDE,"des-ede-cbc":a.CBC.instantiate(a.EDE),"des-ede":a.EDE,"des-cbc":a.CBC.instantiate(a.DES),"des-ecb":a.DES};function d(g){o.call(this);var y,h=g.mode.toLowerCase(),u=p[h];y=g.decrypt?"decrypt":"encrypt";var f=g.key;l.isBuffer(f)||(f=l.from(f)),h!=="des-ede"&&h!=="des-ede-cbc"||(f=l.concat([f,f.slice(0,8)]));var c=g.iv;l.isBuffer(c)||(c=l.from(c)),this._des=u.create({key:f,iv:c,type:y})}p.des=p["des-cbc"],p.des3=p["des-ede3-cbc"],n.exports=d,s(d,o),d.prototype._update=function(g){return l.from(this._des.update(g))},d.prototype._final=function(){return l.from(this._des.final())}},{"cipher-base":218,"des.js":339,inherits:387,"safe-buffer":494}],205:[function(e,n,i){i["des-ecb"]={key:8,iv:0},i["des-cbc"]=i.des={key:8,iv:8},i["des-ede3-cbc"]=i.des3={key:24,iv:8},i["des-ede3"]={key:24,iv:0},i["des-ede-cbc"]={key:16,iv:8},i["des-ede"]={key:16,iv:0}},{}],206:[function(e,n,i){(function(o){var a=e("bn.js"),s=e("randombytes");function l(d,g){var y=function(R){var I=p(R);return{blinder:I.toRed(a.mont(R.modulus)).redPow(new a(R.publicExponent)).fromRed(),unblinder:I.invm(R.modulus)}}(g),h=g.modulus.byteLength(),u=(a.mont(g.modulus),new a(d).mul(y.blinder).umod(g.modulus)),f=u.toRed(a.mont(g.prime1)),c=u.toRed(a.mont(g.prime2)),v=g.coefficient,m=g.prime1,b=g.prime2,w=f.redPow(g.exponent1),_=c.redPow(g.exponent2);w=w.fromRed(),_=_.fromRed();var C=w.isub(_).imul(v).umod(m);return C.imul(b),_.iadd(C),new o(_.imul(y.unblinder).umod(g.modulus).toArray(!1,h))}function p(d){for(var g=d.modulus.byteLength(),y=new a(s(g));y.cmp(d.modulus)>=0||!y.umod(d.prime1)||!y.umod(d.prime2);)y=new a(s(g));return y}n.exports=l,l.getr=p}).call(this,e("buffer").Buffer)},{"bn.js":207,buffer:216,randombytes:475}],207:[function(e,n,i){arguments[4][181][0].apply(i,arguments)},{buffer:185,dup:181}],208:[function(e,n,i){n.exports=e("./browser/algorithms.json")},{"./browser/algorithms.json":209}],209:[function(e,n,i){n.exports={sha224WithRSAEncryption:{sign:"rsa",hash:"sha224",id:"302d300d06096086480165030402040500041c"},"RSA-SHA224":{sign:"ecdsa/rsa",hash:"sha224",id:"302d300d06096086480165030402040500041c"},sha256WithRSAEncryption:{sign:"rsa",hash:"sha256",id:"3031300d060960864801650304020105000420"},"RSA-SHA256":{sign:"ecdsa/rsa",hash:"sha256",id:"3031300d060960864801650304020105000420"},sha384WithRSAEncryption:{sign:"rsa",hash:"sha384",id:"3041300d060960864801650304020205000430"},"RSA-SHA384":{sign:"ecdsa/rsa",hash:"sha384",id:"3041300d060960864801650304020205000430"},sha512WithRSAEncryption:{sign:"rsa",hash:"sha512",id:"3051300d060960864801650304020305000440"},"RSA-SHA512":{sign:"ecdsa/rsa",hash:"sha512",id:"3051300d060960864801650304020305000440"},"RSA-SHA1":{sign:"rsa",hash:"sha1",id:"3021300906052b0e03021a05000414"},"ecdsa-with-SHA1":{sign:"ecdsa",hash:"sha1",id:""},sha256:{sign:"ecdsa",hash:"sha256",id:""},sha224:{sign:"ecdsa",hash:"sha224",id:""},sha384:{sign:"ecdsa",hash:"sha384",id:""},sha512:{sign:"ecdsa",hash:"sha512",id:""},"DSA-SHA":{sign:"dsa",hash:"sha1",id:""},"DSA-SHA1":{sign:"dsa",hash:"sha1",id:""},DSA:{sign:"dsa",hash:"sha1",id:""},"DSA-WITH-SHA224":{sign:"dsa",hash:"sha224",id:""},"DSA-SHA224":{sign:"dsa",hash:"sha224",id:""},"DSA-WITH-SHA256":{sign:"dsa",hash:"sha256",id:""},"DSA-SHA256":{sign:"dsa",hash:"sha256",id:""},"DSA-WITH-SHA384":{sign:"dsa",hash:"sha384",id:""},"DSA-SHA384":{sign:"dsa",hash:"sha384",id:""},"DSA-WITH-SHA512":{sign:"dsa",hash:"sha512",id:""},"DSA-SHA512":{sign:"dsa",hash:"sha512",id:""},"DSA-RIPEMD160":{sign:"dsa",hash:"rmd160",id:""},ripemd160WithRSA:{sign:"rsa",hash:"rmd160",id:"3021300906052b2403020105000414"},"RSA-RIPEMD160":{sign:"rsa",hash:"rmd160",id:"3021300906052b2403020105000414"},md5WithRSAEncryption:{sign:"rsa",hash:"md5",id:"3020300c06082a864886f70d020505000410"},"RSA-MD5":{sign:"rsa",hash:"md5",id:"3020300c06082a864886f70d020505000410"}}},{}],210:[function(e,n,i){n.exports={"1.3.132.0.10":"secp256k1","1.3.132.0.33":"p224","1.2.840.10045.3.1.1":"p192","1.2.840.10045.3.1.7":"p256","1.3.132.0.34":"p384","1.3.132.0.35":"p521"}},{}],211:[function(e,n,i){var o=e("safe-buffer").Buffer,a=e("create-hash"),s=e("readable-stream"),l=e("inherits"),p=e("./sign"),d=e("./verify"),g=e("./algorithms.json");function y(c){s.Writable.call(this);var v=g[c];if(!v)throw new Error("Unknown message digest");this._hashType=v.hash,this._hash=a(v.hash),this._tag=v.id,this._signType=v.sign}function h(c){s.Writable.call(this);var v=g[c];if(!v)throw new Error("Unknown message digest");this._hash=a(v.hash),this._tag=v.id,this._signType=v.sign}function u(c){return new y(c)}function f(c){return new h(c)}Object.keys(g).forEach(function(c){g[c].id=o.from(g[c].id,"hex"),g[c.toLowerCase()]=g[c]}),l(y,s.Writable),y.prototype._write=function(c,v,m){this._hash.update(c),m()},y.prototype.update=function(c,v){return typeof c=="string"&&(c=o.from(c,v)),this._hash.update(c),this},y.prototype.sign=function(c,v){this.end();var m=this._hash.digest(),b=p(m,c,this._hashType,this._signType,this._tag);return v?b.toString(v):b},l(h,s.Writable),h.prototype._write=function(c,v,m){this._hash.update(c),m()},h.prototype.update=function(c,v){return typeof c=="string"&&(c=o.from(c,v)),this._hash.update(c),this},h.prototype.verify=function(c,v,m){typeof v=="string"&&(v=o.from(v,m)),this.end();var b=this._hash.digest();return d(v,b,c,this._signType,this._tag)},n.exports={Sign:u,Verify:f,createSign:u,createVerify:f}},{"./algorithms.json":209,"./sign":212,"./verify":213,"create-hash":331,inherits:387,"readable-stream":491,"safe-buffer":214}],212:[function(e,n,i){var o=e("safe-buffer").Buffer,a=e("create-hmac"),s=e("browserify-rsa"),l=e("elliptic").ec,p=e("bn.js"),d=e("parse-asn1"),g=e("./curves.json");function y(c,v,m,b){if((c=o.from(c.toArray())).length<v.byteLength()){var w=o.alloc(v.byteLength()-c.length);c=o.concat([w,c])}var _=m.length,C=function(P,N){P=(P=h(P,N)).mod(N);var A=o.from(P.toArray());if(A.length<N.byteLength()){var $=o.alloc(N.byteLength()-A.length);A=o.concat([$,A])}return A}(m,v),R=o.alloc(_);R.fill(1);var I=o.alloc(_);return I=a(b,I).update(R).update(o.from([0])).update(c).update(C).digest(),R=a(b,I).update(R).digest(),{k:I=a(b,I).update(R).update(o.from([1])).update(c).update(C).digest(),v:R=a(b,I).update(R).digest()}}function h(c,v){var m=new p(c),b=(c.length<<3)-v.bitLength();return b>0&&m.ishrn(b),m}function u(c,v,m){var b,w;do{for(b=o.alloc(0);8*b.length<c.bitLength();)v.v=a(m,v.k).update(v.v).digest(),b=o.concat([b,v.v]);w=h(b,c),v.k=a(m,v.k).update(v.v).update(o.from([0])).digest(),v.v=a(m,v.k).update(v.v).digest()}while(w.cmp(c)!==-1);return w}function f(c,v,m,b){return c.toRed(p.mont(m)).redPow(v).fromRed().mod(b)}n.exports=function(c,v,m,b,w){var _=d(v);if(_.curve){if(b!=="ecdsa"&&b!=="ecdsa/rsa")throw new Error("wrong private key type");return function(P,N){var A=g[N.curve.join(".")];if(!A)throw new Error("unknown curve "+N.curve.join("."));var $=new l(A).keyFromPrivate(N.privateKey).sign(P);return o.from($.toDER())}(c,_)}if(_.type==="dsa"){if(b!=="dsa")throw new Error("wrong private key type");return function(P,N,A){for(var $,T=N.params.priv_key,M=N.params.p,S=N.params.q,E=N.params.g,k=new p(0),O=h(P,S).mod(S),x=!1,j=y(T,S,P,A);x===!1;)$=u(S,j,A),k=f(E,$,M,S),(x=$.invm(S).imul(O.add(T.mul(k))).mod(S)).cmpn(0)===0&&(x=!1,k=new p(0));return function(H,F){H=H.toArray(),F=F.toArray(),128&H[0]&&(H=[0].concat(H)),128&F[0]&&(F=[0].concat(F));var V=[48,H.length+F.length+4,2,H.length];return V=V.concat(H,[2,F.length],F),o.from(V)}(k,x)}(c,_,m)}if(b!=="rsa"&&b!=="ecdsa/rsa")throw new Error("wrong private key type");c=o.concat([w,c]);for(var C=_.modulus.byteLength(),R=[0,1];c.length+R.length+1<C;)R.push(255);R.push(0);for(var I=-1;++I<c.length;)R.push(c[I]);return s(R,_)},n.exports.getKey=y,n.exports.makeKey=u},{"./curves.json":210,"bn.js":183,"browserify-rsa":206,"create-hmac":333,elliptic:350,"parse-asn1":459,"safe-buffer":214}],213:[function(e,n,i){var o=e("safe-buffer").Buffer,a=e("bn.js"),s=e("elliptic").ec,l=e("parse-asn1"),p=e("./curves.json");function d(g,y){if(g.cmpn(0)<=0)throw new Error("invalid sig");if(g.cmp(y)>=y)throw new Error("invalid sig")}n.exports=function(g,y,h,u,f){var c=l(h);if(c.type==="ec"){if(u!=="ecdsa"&&u!=="ecdsa/rsa")throw new Error("wrong public key type");return function(R,I,P){var N=p[P.data.algorithm.curve.join(".")];if(!N)throw new Error("unknown curve "+P.data.algorithm.curve.join("."));var A=new s(N),$=P.data.subjectPrivateKey.data;return A.verify(I,R,$)}(g,y,c)}if(c.type==="dsa"){if(u!=="dsa")throw new Error("wrong public key type");return function(R,I,P){var N=P.data.p,A=P.data.q,$=P.data.g,T=P.data.pub_key,M=l.signature.decode(R,"der"),S=M.s,E=M.r;d(S,A),d(E,A);var k=a.mont(N),O=S.invm(A);return $.toRed(k).redPow(new a(I).mul(O).mod(A)).fromRed().mul(T.toRed(k).redPow(E.mul(O).mod(A)).fromRed()).mod(N).mod(A).cmp(E)===0}(g,y,c)}if(u!=="rsa"&&u!=="ecdsa/rsa")throw new Error("wrong public key type");y=o.concat([f,y]);for(var v=c.modulus.byteLength(),m=[1],b=0;y.length+m.length+2<v;)m.push(255),b++;m.push(0);for(var w=-1;++w<y.length;)m.push(y[w]);m=o.from(m);var _=a.mont(c.modulus);g=(g=new a(g).toRed(_)).redPow(new a(c.publicExponent)),g=o.from(g.fromRed().toArray());var C=b<8?1:0;for(v=Math.min(g.length,m.length),g.length!==m.length&&(C=1),w=-1;++w<v;)C|=g[w]^m[w];return C===0}},{"./curves.json":210,"bn.js":183,elliptic:350,"parse-asn1":459,"safe-buffer":214}],214:[function(e,n,i){/*! safe-buffer. MIT License. Feross Aboukhadijeh <https://feross.org/opensource> */var o=e("buffer"),a=o.Buffer;function s(p,d){for(var g in p)d[g]=p[g]}function l(p,d,g){return a(p,d,g)}a.from&&a.alloc&&a.allocUnsafe&&a.allocUnsafeSlow?n.exports=o:(s(o,i),i.Buffer=l),l.prototype=Object.create(a.prototype),s(a,l),l.from=function(p,d,g){if(typeof p=="number")throw new TypeError("Argument must not be a number");return a(p,d,g)},l.alloc=function(p,d,g){if(typeof p!="number")throw new TypeError("Argument must be a number");var y=a(p);return d!==void 0?typeof g=="string"?y.fill(d,g):y.fill(d):y.fill(0),y},l.allocUnsafe=function(p){if(typeof p!="number")throw new TypeError("Argument must be a number");return a(p)},l.allocUnsafeSlow=function(p){if(typeof p!="number")throw new TypeError("Argument must be a number");return o.SlowBuffer(p)}},{buffer:216}],215:[function(e,n,i){arguments[4][185][0].apply(i,arguments)},{dup:185}],216:[function(e,n,i){(function(o){function a(D){return(a=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(L){return typeof L}:function(L){return L&&typeof Symbol=="function"&&L.constructor===Symbol&&L!==Symbol.prototype?"symbol":typeof L})(D)}var s=e("base64-js"),l=e("ieee754");i.Buffer=o,i.SlowBuffer=function(D){return+D!=D&&(D=0),o.alloc(+D)},i.INSPECT_MAX_BYTES=50;function p(D){if(D>2147483647)throw new RangeError('The value "'+D+'" is invalid for option "size"');var L=new Uint8Array(D);return L.__proto__=o.prototype,L}function o(D,L,B){if(typeof D=="number"){if(typeof L=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return y(D)}return d(D,L,B)}function d(D,L,B){if(typeof D=="string")return function(X,ee){if(typeof ee=="string"&&ee!==""||(ee="utf8"),!o.isEncoding(ee))throw new TypeError("Unknown encoding: "+ee);var ye=0|f(X,ee),de=p(ye),ge=de.write(X,ee);return ge!==ye&&(de=de.slice(0,ge)),de}(D,L);if(ArrayBuffer.isView(D))return h(D);if(D==null)throw TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+a(D));if(Y(D,ArrayBuffer)||D&&Y(D.buffer,ArrayBuffer))return function(X,ee,ye){if(ee<0||X.byteLength<ee)throw new RangeError('"offset" is outside of buffer bounds');if(X.byteLength<ee+(ye||0))throw new RangeError('"length" is outside of buffer bounds');var de;return de=ee===void 0&&ye===void 0?new Uint8Array(X):ye===void 0?new Uint8Array(X,ee):new Uint8Array(X,ee,ye),de.__proto__=o.prototype,de}(D,L,B);if(typeof D=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');var z=D.valueOf&&D.valueOf();if(z!=null&&z!==D)return o.from(z,L,B);var q=function(X){if(o.isBuffer(X)){var ee=0|u(X.length),ye=p(ee);return ye.length===0||X.copy(ye,0,0,ee),ye}if(X.length!==void 0)return typeof X.length!="number"||K(X.length)?p(0):h(X);if(X.type==="Buffer"&&Array.isArray(X.data))return h(X.data)}(D);if(q)return q;if(typeof Symbol!="undefined"&&Symbol.toPrimitive!=null&&typeof D[Symbol.toPrimitive]=="function")return o.from(D[Symbol.toPrimitive]("string"),L,B);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+a(D))}function g(D){if(typeof D!="number")throw new TypeError('"size" argument must be of type number');if(D<0)throw new RangeError('The value "'+D+'" is invalid for option "size"')}function y(D){return g(D),p(D<0?0:0|u(D))}function h(D){for(var L=D.length<0?0:0|u(D.length),B=p(L),z=0;z<L;z+=1)B[z]=255&D[z];return B}function u(D){if(D>=2147483647)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+2147483647 .toString(16)+" bytes");return 0|D}function f(D,L){if(o.isBuffer(D))return D.length;if(ArrayBuffer.isView(D)||Y(D,ArrayBuffer))return D.byteLength;if(typeof D!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+a(D));var B=D.length,z=arguments.length>2&&arguments[2]===!0;if(!z&&B===0)return 0;for(var q=!1;;)switch(L){case"ascii":case"latin1":case"binary":return B;case"utf8":case"utf-8":return V(D).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*B;case"hex":return B>>>1;case"base64":return W(D).length;default:if(q)return z?-1:V(D).length;L=(""+L).toLowerCase(),q=!0}}function c(D,L,B){var z=!1;if((L===void 0||L<0)&&(L=0),L>this.length||((B===void 0||B>this.length)&&(B=this.length),B<=0)||(B>>>=0)<=(L>>>=0))return"";for(D||(D="utf8");;)switch(D){case"hex":return M(this,L,B);case"utf8":case"utf-8":return A(this,L,B);case"ascii":return $(this,L,B);case"latin1":case"binary":return T(this,L,B);case"base64":return N(this,L,B);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return S(this,L,B);default:if(z)throw new TypeError("Unknown encoding: "+D);D=(D+"").toLowerCase(),z=!0}}function v(D,L,B){var z=D[L];D[L]=D[B],D[B]=z}function m(D,L,B,z,q){if(D.length===0)return-1;if(typeof B=="string"?(z=B,B=0):B>2147483647?B=2147483647:B<-2147483648&&(B=-2147483648),K(B=+B)&&(B=q?0:D.length-1),B<0&&(B=D.length+B),B>=D.length){if(q)return-1;B=D.length-1}else if(B<0){if(!q)return-1;B=0}if(typeof L=="string"&&(L=o.from(L,z)),o.isBuffer(L))return L.length===0?-1:b(D,L,B,z,q);if(typeof L=="number")return L&=255,typeof Uint8Array.prototype.indexOf=="function"?q?Uint8Array.prototype.indexOf.call(D,L,B):Uint8Array.prototype.lastIndexOf.call(D,L,B):b(D,[L],B,z,q);throw new TypeError("val must be string, number or Buffer")}function b(D,L,B,z,q){var X,ee=1,ye=D.length,de=L.length;if(z!==void 0&&((z=String(z).toLowerCase())==="ucs2"||z==="ucs-2"||z==="utf16le"||z==="utf-16le")){if(D.length<2||L.length<2)return-1;ee=2,ye/=2,de/=2,B/=2}function ge(te,ie){return ee===1?te[ie]:te.readUInt16BE(ie*ee)}if(q){var we=-1;for(X=B;X<ye;X++)if(ge(D,X)===ge(L,we===-1?0:X-we)){if(we===-1&&(we=X),X-we+1===de)return we*ee}else we!==-1&&(X-=X-we),we=-1}else for(B+de>ye&&(B=ye-de),X=B;X>=0;X--){for(var be=!0,J=0;J<de;J++)if(ge(D,X+J)!==ge(L,J)){be=!1;break}if(be)return X}return-1}function w(D,L,B,z){B=Number(B)||0;var q=D.length-B;z?(z=Number(z))>q&&(z=q):z=q;var X=L.length;z>X/2&&(z=X/2);for(var ee=0;ee<z;++ee){var ye=parseInt(L.substr(2*ee,2),16);if(K(ye))return ee;D[B+ee]=ye}return ee}function _(D,L,B,z){return U(V(L,D.length-B),D,B,z)}function C(D,L,B,z){return U(function(q){for(var X=[],ee=0;ee<q.length;++ee)X.push(255&q.charCodeAt(ee));return X}(L),D,B,z)}function R(D,L,B,z){return C(D,L,B,z)}function I(D,L,B,z){return U(W(L),D,B,z)}function P(D,L,B,z){return U(function(q,X){for(var ee,ye,de,ge=[],we=0;we<q.length&&!((X-=2)<0);++we)ee=q.charCodeAt(we),ye=ee>>8,de=ee%256,ge.push(de),ge.push(ye);return ge}(L,D.length-B),D,B,z)}function N(D,L,B){return L===0&&B===D.length?s.fromByteArray(D):s.fromByteArray(D.slice(L,B))}function A(D,L,B){B=Math.min(D.length,B);for(var z=[],q=L;q<B;){var X,ee,ye,de,ge=D[q],we=null,be=ge>239?4:ge>223?3:ge>191?2:1;if(q+be<=B)switch(be){case 1:ge<128&&(we=ge);break;case 2:(192&(X=D[q+1]))==128&&(de=(31&ge)<<6|63&X)>127&&(we=de);break;case 3:X=D[q+1],ee=D[q+2],(192&X)==128&&(192&ee)==128&&(de=(15&ge)<<12|(63&X)<<6|63&ee)>2047&&(de<55296||de>57343)&&(we=de);break;case 4:X=D[q+1],ee=D[q+2],ye=D[q+3],(192&X)==128&&(192&ee)==128&&(192&ye)==128&&(de=(15&ge)<<18|(63&X)<<12|(63&ee)<<6|63&ye)>65535&&de<1114112&&(we=de)}we===null?(we=65533,be=1):we>65535&&(we-=65536,z.push(we>>>10&1023|55296),we=56320|1023&we),z.push(we),q+=be}return function(J){var te=J.length;if(te<=4096)return String.fromCharCode.apply(String,J);for(var ie="",fe=0;fe<te;)ie+=String.fromCharCode.apply(String,J.slice(fe,fe+=4096));return ie}(z)}i.kMaxLength=2147483647,o.TYPED_ARRAY_SUPPORT=function(){try{var D=new Uint8Array(1);return D.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},D.foo()===42}catch{return!1}}(),o.TYPED_ARRAY_SUPPORT||typeof console=="undefined"||typeof console.error!="function"||console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),Object.defineProperty(o.prototype,"parent",{enumerable:!0,get:function(){if(o.isBuffer(this))return this.buffer}}),Object.defineProperty(o.prototype,"offset",{enumerable:!0,get:function(){if(o.isBuffer(this))return this.byteOffset}}),typeof Symbol!="undefined"&&Symbol.species!=null&&o[Symbol.species]===o&&Object.defineProperty(o,Symbol.species,{value:null,configurable:!0,enumerable:!1,writable:!1}),o.poolSize=8192,o.from=function(D,L,B){return d(D,L,B)},o.prototype.__proto__=Uint8Array.prototype,o.__proto__=Uint8Array,o.alloc=function(D,L,B){return function(z,q,X){return g(z),z<=0?p(z):q!==void 0?typeof X=="string"?p(z).fill(q,X):p(z).fill(q):p(z)}(D,L,B)},o.allocUnsafe=function(D){return y(D)},o.allocUnsafeSlow=function(D){return y(D)},o.isBuffer=function(D){return D!=null&&D._isBuffer===!0&&D!==o.prototype},o.compare=function(D,L){if(Y(D,Uint8Array)&&(D=o.from(D,D.offset,D.byteLength)),Y(L,Uint8Array)&&(L=o.from(L,L.offset,L.byteLength)),!o.isBuffer(D)||!o.isBuffer(L))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(D===L)return 0;for(var B=D.length,z=L.length,q=0,X=Math.min(B,z);q<X;++q)if(D[q]!==L[q]){B=D[q],z=L[q];break}return B<z?-1:z<B?1:0},o.isEncoding=function(D){switch(String(D).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},o.concat=function(D,L){if(!Array.isArray(D))throw new TypeError('"list" argument must be an Array of Buffers');if(D.length===0)return o.alloc(0);var B;if(L===void 0)for(L=0,B=0;B<D.length;++B)L+=D[B].length;var z=o.allocUnsafe(L),q=0;for(B=0;B<D.length;++B){var X=D[B];if(Y(X,Uint8Array)&&(X=o.from(X)),!o.isBuffer(X))throw new TypeError('"list" argument must be an Array of Buffers');X.copy(z,q),q+=X.length}return z},o.byteLength=f,o.prototype._isBuffer=!0,o.prototype.swap16=function(){var D=this.length;if(D%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var L=0;L<D;L+=2)v(this,L,L+1);return this},o.prototype.swap32=function(){var D=this.length;if(D%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var L=0;L<D;L+=4)v(this,L,L+3),v(this,L+1,L+2);return this},o.prototype.swap64=function(){var D=this.length;if(D%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var L=0;L<D;L+=8)v(this,L,L+7),v(this,L+1,L+6),v(this,L+2,L+5),v(this,L+3,L+4);return this},o.prototype.toString=function(){var D=this.length;return D===0?"":arguments.length===0?A(this,0,D):c.apply(this,arguments)},o.prototype.toLocaleString=o.prototype.toString,o.prototype.equals=function(D){if(!o.isBuffer(D))throw new TypeError("Argument must be a Buffer");return this===D||o.compare(this,D)===0},o.prototype.inspect=function(){var D="",L=i.INSPECT_MAX_BYTES;return D=this.toString("hex",0,L).replace(/(.{2})/g,"$1 ").trim(),this.length>L&&(D+=" ... "),"<Buffer "+D+">"},o.prototype.compare=function(D,L,B,z,q){if(Y(D,Uint8Array)&&(D=o.from(D,D.offset,D.byteLength)),!o.isBuffer(D))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+a(D));if(L===void 0&&(L=0),B===void 0&&(B=D?D.length:0),z===void 0&&(z=0),q===void 0&&(q=this.length),L<0||B>D.length||z<0||q>this.length)throw new RangeError("out of range index");if(z>=q&&L>=B)return 0;if(z>=q)return-1;if(L>=B)return 1;if(this===D)return 0;for(var X=(q>>>=0)-(z>>>=0),ee=(B>>>=0)-(L>>>=0),ye=Math.min(X,ee),de=this.slice(z,q),ge=D.slice(L,B),we=0;we<ye;++we)if(de[we]!==ge[we]){X=de[we],ee=ge[we];break}return X<ee?-1:ee<X?1:0},o.prototype.includes=function(D,L,B){return this.indexOf(D,L,B)!==-1},o.prototype.indexOf=function(D,L,B){return m(this,D,L,B,!0)},o.prototype.lastIndexOf=function(D,L,B){return m(this,D,L,B,!1)},o.prototype.write=function(D,L,B,z){if(L===void 0)z="utf8",B=this.length,L=0;else if(B===void 0&&typeof L=="string")z=L,B=this.length,L=0;else{if(!isFinite(L))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");L>>>=0,isFinite(B)?(B>>>=0,z===void 0&&(z="utf8")):(z=B,B=void 0)}var q=this.length-L;if((B===void 0||B>q)&&(B=q),D.length>0&&(B<0||L<0)||L>this.length)throw new RangeError("Attempt to write outside buffer bounds");z||(z="utf8");for(var X=!1;;)switch(z){case"hex":return w(this,D,L,B);case"utf8":case"utf-8":return _(this,D,L,B);case"ascii":return C(this,D,L,B);case"latin1":case"binary":return R(this,D,L,B);case"base64":return I(this,D,L,B);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return P(this,D,L,B);default:if(X)throw new TypeError("Unknown encoding: "+z);z=(""+z).toLowerCase(),X=!0}},o.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function $(D,L,B){var z="";B=Math.min(D.length,B);for(var q=L;q<B;++q)z+=String.fromCharCode(127&D[q]);return z}function T(D,L,B){var z="";B=Math.min(D.length,B);for(var q=L;q<B;++q)z+=String.fromCharCode(D[q]);return z}function M(D,L,B){var z=D.length;(!L||L<0)&&(L=0),(!B||B<0||B>z)&&(B=z);for(var q="",X=L;X<B;++X)q+=F(D[X]);return q}function S(D,L,B){for(var z=D.slice(L,B),q="",X=0;X<z.length;X+=2)q+=String.fromCharCode(z[X]+256*z[X+1]);return q}function E(D,L,B){if(D%1!=0||D<0)throw new RangeError("offset is not uint");if(D+L>B)throw new RangeError("Trying to access beyond buffer length")}function k(D,L,B,z,q,X){if(!o.isBuffer(D))throw new TypeError('"buffer" argument must be a Buffer instance');if(L>q||L<X)throw new RangeError('"value" argument is out of bounds');if(B+z>D.length)throw new RangeError("Index out of range")}function O(D,L,B,z,q,X){if(B+z>D.length)throw new RangeError("Index out of range");if(B<0)throw new RangeError("Index out of range")}function x(D,L,B,z,q){return L=+L,B>>>=0,q||O(D,0,B,4),l.write(D,L,B,z,23,4),B+4}function j(D,L,B,z,q){return L=+L,B>>>=0,q||O(D,0,B,8),l.write(D,L,B,z,52,8),B+8}o.prototype.slice=function(D,L){var B=this.length;(D=~~D)<0?(D+=B)<0&&(D=0):D>B&&(D=B),(L=L===void 0?B:~~L)<0?(L+=B)<0&&(L=0):L>B&&(L=B),L<D&&(L=D);var z=this.subarray(D,L);return z.__proto__=o.prototype,z},o.prototype.readUIntLE=function(D,L,B){D>>>=0,L>>>=0,B||E(D,L,this.length);for(var z=this[D],q=1,X=0;++X<L&&(q*=256);)z+=this[D+X]*q;return z},o.prototype.readUIntBE=function(D,L,B){D>>>=0,L>>>=0,B||E(D,L,this.length);for(var z=this[D+--L],q=1;L>0&&(q*=256);)z+=this[D+--L]*q;return z},o.prototype.readUInt8=function(D,L){return D>>>=0,L||E(D,1,this.length),this[D]},o.prototype.readUInt16LE=function(D,L){return D>>>=0,L||E(D,2,this.length),this[D]|this[D+1]<<8},o.prototype.readUInt16BE=function(D,L){return D>>>=0,L||E(D,2,this.length),this[D]<<8|this[D+1]},o.prototype.readUInt32LE=function(D,L){return D>>>=0,L||E(D,4,this.length),(this[D]|this[D+1]<<8|this[D+2]<<16)+16777216*this[D+3]},o.prototype.readUInt32BE=function(D,L){return D>>>=0,L||E(D,4,this.length),16777216*this[D]+(this[D+1]<<16|this[D+2]<<8|this[D+3])},o.prototype.readIntLE=function(D,L,B){D>>>=0,L>>>=0,B||E(D,L,this.length);for(var z=this[D],q=1,X=0;++X<L&&(q*=256);)z+=this[D+X]*q;return z>=(q*=128)&&(z-=Math.pow(2,8*L)),z},o.prototype.readIntBE=function(D,L,B){D>>>=0,L>>>=0,B||E(D,L,this.length);for(var z=L,q=1,X=this[D+--z];z>0&&(q*=256);)X+=this[D+--z]*q;return X>=(q*=128)&&(X-=Math.pow(2,8*L)),X},o.prototype.readInt8=function(D,L){return D>>>=0,L||E(D,1,this.length),128&this[D]?-1*(255-this[D]+1):this[D]},o.prototype.readInt16LE=function(D,L){D>>>=0,L||E(D,2,this.length);var B=this[D]|this[D+1]<<8;return 32768&B?4294901760|B:B},o.prototype.readInt16BE=function(D,L){D>>>=0,L||E(D,2,this.length);var B=this[D+1]|this[D]<<8;return 32768&B?4294901760|B:B},o.prototype.readInt32LE=function(D,L){return D>>>=0,L||E(D,4,this.length),this[D]|this[D+1]<<8|this[D+2]<<16|this[D+3]<<24},o.prototype.readInt32BE=function(D,L){return D>>>=0,L||E(D,4,this.length),this[D]<<24|this[D+1]<<16|this[D+2]<<8|this[D+3]},o.prototype.readFloatLE=function(D,L){return D>>>=0,L||E(D,4,this.length),l.read(this,D,!0,23,4)},o.prototype.readFloatBE=function(D,L){return D>>>=0,L||E(D,4,this.length),l.read(this,D,!1,23,4)},o.prototype.readDoubleLE=function(D,L){return D>>>=0,L||E(D,8,this.length),l.read(this,D,!0,52,8)},o.prototype.readDoubleBE=function(D,L){return D>>>=0,L||E(D,8,this.length),l.read(this,D,!1,52,8)},o.prototype.writeUIntLE=function(D,L,B,z){D=+D,L>>>=0,B>>>=0,z||k(this,D,L,B,Math.pow(2,8*B)-1,0);var q=1,X=0;for(this[L]=255&D;++X<B&&(q*=256);)this[L+X]=D/q&255;return L+B},o.prototype.writeUIntBE=function(D,L,B,z){D=+D,L>>>=0,B>>>=0,z||k(this,D,L,B,Math.pow(2,8*B)-1,0);var q=B-1,X=1;for(this[L+q]=255&D;--q>=0&&(X*=256);)this[L+q]=D/X&255;return L+B},o.prototype.writeUInt8=function(D,L,B){return D=+D,L>>>=0,B||k(this,D,L,1,255,0),this[L]=255&D,L+1},o.prototype.writeUInt16LE=function(D,L,B){return D=+D,L>>>=0,B||k(this,D,L,2,65535,0),this[L]=255&D,this[L+1]=D>>>8,L+2},o.prototype.writeUInt16BE=function(D,L,B){return D=+D,L>>>=0,B||k(this,D,L,2,65535,0),this[L]=D>>>8,this[L+1]=255&D,L+2},o.prototype.writeUInt32LE=function(D,L,B){return D=+D,L>>>=0,B||k(this,D,L,4,4294967295,0),this[L+3]=D>>>24,this[L+2]=D>>>16,this[L+1]=D>>>8,this[L]=255&D,L+4},o.prototype.writeUInt32BE=function(D,L,B){return D=+D,L>>>=0,B||k(this,D,L,4,4294967295,0),this[L]=D>>>24,this[L+1]=D>>>16,this[L+2]=D>>>8,this[L+3]=255&D,L+4},o.prototype.writeIntLE=function(D,L,B,z){if(D=+D,L>>>=0,!z){var q=Math.pow(2,8*B-1);k(this,D,L,B,q-1,-q)}var X=0,ee=1,ye=0;for(this[L]=255&D;++X<B&&(ee*=256);)D<0&&ye===0&&this[L+X-1]!==0&&(ye=1),this[L+X]=(D/ee>>0)-ye&255;return L+B},o.prototype.writeIntBE=function(D,L,B,z){if(D=+D,L>>>=0,!z){var q=Math.pow(2,8*B-1);k(this,D,L,B,q-1,-q)}var X=B-1,ee=1,ye=0;for(this[L+X]=255&D;--X>=0&&(ee*=256);)D<0&&ye===0&&this[L+X+1]!==0&&(ye=1),this[L+X]=(D/ee>>0)-ye&255;return L+B},o.prototype.writeInt8=function(D,L,B){return D=+D,L>>>=0,B||k(this,D,L,1,127,-128),D<0&&(D=255+D+1),this[L]=255&D,L+1},o.prototype.writeInt16LE=function(D,L,B){return D=+D,L>>>=0,B||k(this,D,L,2,32767,-32768),this[L]=255&D,this[L+1]=D>>>8,L+2},o.prototype.writeInt16BE=function(D,L,B){return D=+D,L>>>=0,B||k(this,D,L,2,32767,-32768),this[L]=D>>>8,this[L+1]=255&D,L+2},o.prototype.writeInt32LE=function(D,L,B){return D=+D,L>>>=0,B||k(this,D,L,4,2147483647,-2147483648),this[L]=255&D,this[L+1]=D>>>8,this[L+2]=D>>>16,this[L+3]=D>>>24,L+4},o.prototype.writeInt32BE=function(D,L,B){return D=+D,L>>>=0,B||k(this,D,L,4,2147483647,-2147483648),D<0&&(D=4294967295+D+1),this[L]=D>>>24,this[L+1]=D>>>16,this[L+2]=D>>>8,this[L+3]=255&D,L+4},o.prototype.writeFloatLE=function(D,L,B){return x(this,D,L,!0,B)},o.prototype.writeFloatBE=function(D,L,B){return x(this,D,L,!1,B)},o.prototype.writeDoubleLE=function(D,L,B){return j(this,D,L,!0,B)},o.prototype.writeDoubleBE=function(D,L,B){return j(this,D,L,!1,B)},o.prototype.copy=function(D,L,B,z){if(!o.isBuffer(D))throw new TypeError("argument should be a Buffer");if(B||(B=0),z||z===0||(z=this.length),L>=D.length&&(L=D.length),L||(L=0),z>0&&z<B&&(z=B),z===B||D.length===0||this.length===0)return 0;if(L<0)throw new RangeError("targetStart out of bounds");if(B<0||B>=this.length)throw new RangeError("Index out of range");if(z<0)throw new RangeError("sourceEnd out of bounds");z>this.length&&(z=this.length),D.length-L<z-B&&(z=D.length-L+B);var q=z-B;if(this===D&&typeof Uint8Array.prototype.copyWithin=="function")this.copyWithin(L,B,z);else if(this===D&&B<L&&L<z)for(var X=q-1;X>=0;--X)D[X+L]=this[X+B];else Uint8Array.prototype.set.call(D,this.subarray(B,z),L);return q},o.prototype.fill=function(D,L,B,z){if(typeof D=="string"){if(typeof L=="string"?(z=L,L=0,B=this.length):typeof B=="string"&&(z=B,B=this.length),z!==void 0&&typeof z!="string")throw new TypeError("encoding must be a string");if(typeof z=="string"&&!o.isEncoding(z))throw new TypeError("Unknown encoding: "+z);if(D.length===1){var q=D.charCodeAt(0);(z==="utf8"&&q<128||z==="latin1")&&(D=q)}}else typeof D=="number"&&(D&=255);if(L<0||this.length<L||this.length<B)throw new RangeError("Out of range index");if(B<=L)return this;var X;if(L>>>=0,B=B===void 0?this.length:B>>>0,D||(D=0),typeof D=="number")for(X=L;X<B;++X)this[X]=D;else{var ee=o.isBuffer(D)?D:o.from(D,z),ye=ee.length;if(ye===0)throw new TypeError('The value "'+D+'" is invalid for argument "value"');for(X=0;X<B-L;++X)this[X+L]=ee[X%ye]}return this};var H=/[^+/0-9A-Za-z-_]/g;function F(D){return D<16?"0"+D.toString(16):D.toString(16)}function V(D,L){var B;L=L||1/0;for(var z=D.length,q=null,X=[],ee=0;ee<z;++ee){if((B=D.charCodeAt(ee))>55295&&B<57344){if(!q){if(B>56319){(L-=3)>-1&&X.push(239,191,189);continue}if(ee+1===z){(L-=3)>-1&&X.push(239,191,189);continue}q=B;continue}if(B<56320){(L-=3)>-1&&X.push(239,191,189),q=B;continue}B=65536+(q-55296<<10|B-56320)}else q&&(L-=3)>-1&&X.push(239,191,189);if(q=null,B<128){if((L-=1)<0)break;X.push(B)}else if(B<2048){if((L-=2)<0)break;X.push(B>>6|192,63&B|128)}else if(B<65536){if((L-=3)<0)break;X.push(B>>12|224,B>>6&63|128,63&B|128)}else{if(!(B<1114112))throw new Error("Invalid code point");if((L-=4)<0)break;X.push(B>>18|240,B>>12&63|128,B>>6&63|128,63&B|128)}}return X}function W(D){return s.toByteArray(function(L){if((L=(L=L.split("=")[0]).trim().replace(H,"")).length<2)return"";for(;L.length%4!=0;)L+="=";return L}(D))}function U(D,L,B,z){for(var q=0;q<z&&!(q+B>=L.length||q>=D.length);++q)L[q+B]=D[q];return q}function Y(D,L){return D instanceof L||D!=null&&D.constructor!=null&&D.constructor.name!=null&&D.constructor.name===L.name}function K(D){return D!=D}}).call(this,e("buffer").Buffer)},{"base64-js":182,buffer:216,ieee754:385}],217:[function(e,n,i){(function(o){n.exports=function(a,s){for(var l=Math.min(a.length,s.length),p=new o(l),d=0;d<l;++d)p[d]=a[d]^s[d];return p}}).call(this,e("buffer").Buffer)},{buffer:216}],218:[function(e,n,i){var o=e("safe-buffer").Buffer,a=e("stream").Transform,s=e("string_decoder").StringDecoder;function l(p){a.call(this),this.hashMode=typeof p=="string",this.hashMode?this[p]=this._finalOrDigest:this.final=this._finalOrDigest,this._final&&(this.__final=this._final,this._final=null),this._decoder=null,this._encoding=null}e("inherits")(l,a),l.prototype.update=function(p,d,g){typeof p=="string"&&(p=o.from(p,d));var y=this._update(p);return this.hashMode?this:(g&&(y=this._toString(y,g)),y)},l.prototype.setAutoPadding=function(){},l.prototype.getAuthTag=function(){throw new Error("trying to get auth tag in unsupported state")},l.prototype.setAuthTag=function(){throw new Error("trying to set auth tag in unsupported state")},l.prototype.setAAD=function(){throw new Error("trying to set aad in unsupported state")},l.prototype._transform=function(p,d,g){var y;try{this.hashMode?this._update(p):this.push(this._update(p))}catch(h){y=h}finally{g(y)}},l.prototype._flush=function(p){var d;try{this.push(this.__final())}catch(g){d=g}p(d)},l.prototype._finalOrDigest=function(p){var d=this.__final()||o.alloc(0);return p&&(d=this._toString(d,p,!0)),d},l.prototype._toString=function(p,d,g){if(this._decoder||(this._decoder=new s(d),this._encoding=d),this._encoding!==d)throw new Error("can't switch encodings");var y=this._decoder.write(p);return g&&(y+=this._decoder.end()),y},n.exports=l},{inherits:387,"safe-buffer":494,stream:506,string_decoder:520}],219:[function(e,n,i){n.exports=function(o){if(typeof o!="function")throw TypeError(String(o)+" is not a function");return o}},{}],220:[function(e,n,i){var o=e("../internals/is-object");n.exports=function(a){if(!o(a)&&a!==null)throw TypeError("Can't set "+String(a)+" as a prototype");return a}},{"../internals/is-object":263}],221:[function(e,n,i){var o=e("../internals/well-known-symbol"),a=e("../internals/object-create"),s=e("../internals/object-define-property"),l=o("unscopables"),p=Array.prototype;p[l]==null&&s.f(p,l,{configurable:!0,value:a(null)}),n.exports=function(d){p[l][d]=!0}},{"../internals/object-create":276,"../internals/object-define-property":278,"../internals/well-known-symbol":314}],222:[function(e,n,i){n.exports=function(o,a,s){if(!(o instanceof a))throw TypeError("Incorrect "+(s?s+" ":"")+"invocation");return o}},{}],223:[function(e,n,i){var o=e("../internals/is-object");n.exports=function(a){if(!o(a))throw TypeError(String(a)+" is not an object");return a}},{"../internals/is-object":263}],224:[function(e,n,i){var o=e("../internals/to-indexed-object"),a=e("../internals/to-length"),s=e("../internals/to-absolute-index"),l=function(p){return function(d,g,y){var h,u=o(d),f=a(u.length),c=s(y,f);if(p&&g!=g){for(;f>c;)if((h=u[c++])!=h)return!0}else for(;f>c;c++)if((p||c in u)&&u[c]===g)return p||c||0;return!p&&-1}};n.exports={includes:l(!0),indexOf:l(!1)}},{"../internals/to-absolute-index":304,"../internals/to-indexed-object":305,"../internals/to-length":307}],225:[function(e,n,i){var o=e("../internals/function-bind-context"),a=e("../internals/indexed-object"),s=e("../internals/to-object"),l=e("../internals/to-length"),p=e("../internals/array-species-create"),d=[].push,g=function(y){var h=y==1,u=y==2,f=y==3,c=y==4,v=y==6,m=y==5||v;return function(b,w,_,C){for(var R,I,P=s(b),N=a(P),A=o(w,_,3),$=l(N.length),T=0,M=C||p,S=h?M(b,$):u?M(b,0):void 0;$>T;T++)if((m||T in N)&&(I=A(R=N[T],T,P),y)){if(h)S[T]=I;else if(I)switch(y){case 3:return!0;case 5:return R;case 6:return T;case 2:d.call(S,R)}else if(c)return!1}return v?-1:f||c?c:S}};n.exports={forEach:g(0),map:g(1),filter:g(2),some:g(3),every:g(4),find:g(5),findIndex:g(6)}},{"../internals/array-species-create":227,"../internals/function-bind-context":248,"../internals/indexed-object":257,"../internals/to-length":307,"../internals/to-object":308}],226:[function(e,n,i){var o=e("../internals/descriptors"),a=e("../internals/fails"),s=e("../internals/has"),l=Object.defineProperty,p={},d=function(g){throw g};n.exports=function(g,y){if(s(p,g))return p[g];y||(y={});var h=[][g],u=!!s(y,"ACCESSORS")&&y.ACCESSORS,f=s(y,0)?y[0]:d,c=s(y,1)?y[1]:void 0;return p[g]=!!h&&!a(function(){if(u&&!o)return!0;var v={length:-1};u?l(v,1,{enumerable:!0,get:d}):v[1]=1,h.call(v,f,c)})}},{"../internals/descriptors":240,"../internals/fails":247,"../internals/has":252}],227:[function(e,n,i){var o=e("../internals/is-object"),a=e("../internals/is-array"),s=e("../internals/well-known-symbol")("species");n.exports=function(l,p){var d;return a(l)&&(typeof(d=l.constructor)!="function"||d!==Array&&!a(d.prototype)?o(d)&&(d=d[s])===null&&(d=void 0):d=void 0),new(d===void 0?Array:d)(p===0?0:p)}},{"../internals/is-array":261,"../internals/is-object":263,"../internals/well-known-symbol":314}],228:[function(e,n,i){var o=e("../internals/an-object");n.exports=function(a,s,l,p){try{return p?s(o(l)[0],l[1]):s(l)}catch(g){var d=a.return;throw d!==void 0&&o(d.call(a)),g}}},{"../internals/an-object":223}],229:[function(e,n,i){var o=e("../internals/well-known-symbol")("iterator"),a=!1;try{var s=0,l={next:function(){return{done:!!s++}},return:function(){a=!0}};l[o]=function(){return this},Array.from(l,function(){throw 2})}catch{}n.exports=function(p,d){if(!d&&!a)return!1;var g=!1;try{var y={};y[o]=function(){return{next:function(){return{done:g=!0}}}},p(y)}catch{}return g}},{"../internals/well-known-symbol":314}],230:[function(e,n,i){var o={}.toString;n.exports=function(a){return o.call(a).slice(8,-1)}},{}],231:[function(e,n,i){var o=e("../internals/to-string-tag-support"),a=e("../internals/classof-raw"),s=e("../internals/well-known-symbol")("toStringTag"),l=a(function(){return arguments}())=="Arguments";n.exports=o?a:function(p){var d,g,y;return p===void 0?"Undefined":p===null?"Null":typeof(g=function(h,u){try{return h[u]}catch{}}(d=Object(p),s))=="string"?g:l?a(d):(y=a(d))=="Object"&&typeof d.callee=="function"?"Arguments":y}},{"../internals/classof-raw":230,"../internals/to-string-tag-support":310,"../internals/well-known-symbol":314}],232:[function(e,n,i){var o=e("../internals/has"),a=e("../internals/own-keys"),s=e("../internals/object-get-own-property-descriptor"),l=e("../internals/object-define-property");n.exports=function(p,d){for(var g=a(d),y=l.f,h=s.f,u=0;u<g.length;u++){var f=g[u];o(p,f)||y(p,f,h(d,f))}}},{"../internals/has":252,"../internals/object-define-property":278,"../internals/object-get-own-property-descriptor":279,"../internals/own-keys":289}],233:[function(e,n,i){var o=e("../internals/well-known-symbol")("match");n.exports=function(a){var s=/./;try{"/./"[a](s)}catch{try{return s[o]=!1,"/./"[a](s)}catch{}}return!1}},{"../internals/well-known-symbol":314}],234:[function(e,n,i){var o=e("../internals/fails");n.exports=!o(function(){function a(){}return a.prototype.constructor=null,Object.getPrototypeOf(new a)!==a.prototype})},{"../internals/fails":247}],235:[function(e,n,i){var o=e("../internals/iterators-core").IteratorPrototype,a=e("../internals/object-create"),s=e("../internals/create-property-descriptor"),l=e("../internals/set-to-string-tag"),p=e("../internals/iterators"),d=function(){return this};n.exports=function(g,y,h){var u=y+" Iterator";return g.prototype=a(o,{next:s(1,h)}),l(g,u,!1,!0),p[u]=d,g}},{"../internals/create-property-descriptor":237,"../internals/iterators":268,"../internals/iterators-core":267,"../internals/object-create":276,"../internals/set-to-string-tag":298}],236:[function(e,n,i){var o=e("../internals/descriptors"),a=e("../internals/object-define-property"),s=e("../internals/create-property-descriptor");n.exports=o?function(l,p,d){return a.f(l,p,s(1,d))}:function(l,p,d){return l[p]=d,l}},{"../internals/create-property-descriptor":237,"../internals/descriptors":240,"../internals/object-define-property":278}],237:[function(e,n,i){n.exports=function(o,a){return{enumerable:!(1&o),configurable:!(2&o),writable:!(4&o),value:a}}},{}],238:[function(e,n,i){var o=e("../internals/export"),a=e("../internals/create-iterator-constructor"),s=e("../internals/object-get-prototype-of"),l=e("../internals/object-set-prototype-of"),p=e("../internals/set-to-string-tag"),d=e("../internals/create-non-enumerable-property"),g=e("../internals/redefine"),y=e("../internals/well-known-symbol"),h=e("../internals/is-pure"),u=e("../internals/iterators"),f=e("../internals/iterators-core"),c=f.IteratorPrototype,v=f.BUGGY_SAFARI_ITERATORS,m=y("iterator"),b=function(){return this};n.exports=function(w,_,C,R,I,P,N){a(C,_,R);var A,$,T,M=function(H){if(H===I&&x)return x;if(!v&&H in k)return k[H];switch(H){case"keys":case"values":case"entries":return function(){return new C(this,H)}}return function(){return new C(this)}},S=_+" Iterator",E=!1,k=w.prototype,O=k[m]||k["@@iterator"]||I&&k[I],x=!v&&O||M(I),j=_=="Array"&&k.entries||O;if(j&&(A=s(j.call(new w)),c!==Object.prototype&&A.next&&(h||s(A)===c||(l?l(A,c):typeof A[m]!="function"&&d(A,m,b)),p(A,S,!0,!0),h&&(u[S]=b))),I=="values"&&O&&O.name!=="values"&&(E=!0,x=function(){return O.call(this)}),h&&!N||k[m]===x||d(k,m,x),u[_]=x,I)if($={values:M("values"),keys:P?x:M("keys"),entries:M("entries")},N)for(T in $)(v||E||!(T in k))&&g(k,T,$[T]);else o({target:_,proto:!0,forced:v||E},$);return $}},{"../internals/create-iterator-constructor":235,"../internals/create-non-enumerable-property":236,"../internals/export":246,"../internals/is-pure":264,"../internals/iterators":268,"../internals/iterators-core":267,"../internals/object-get-prototype-of":283,"../internals/object-set-prototype-of":287,"../internals/redefine":294,"../internals/set-to-string-tag":298,"../internals/well-known-symbol":314}],239:[function(e,n,i){var o=e("../internals/path"),a=e("../internals/has"),s=e("../internals/well-known-symbol-wrapped"),l=e("../internals/object-define-property").f;n.exports=function(p){var d=o.Symbol||(o.Symbol={});a(d,p)||l(d,p,{value:s.f(p)})}},{"../internals/has":252,"../internals/object-define-property":278,"../internals/path":290,"../internals/well-known-symbol-wrapped":313}],240:[function(e,n,i){var o=e("../internals/fails");n.exports=!o(function(){return Object.defineProperty({},1,{get:function(){return 7}})[1]!=7})},{"../internals/fails":247}],241:[function(e,n,i){var o=e("../internals/global"),a=e("../internals/is-object"),s=o.document,l=a(s)&&a(s.createElement);n.exports=function(p){return l?s.createElement(p):{}}},{"../internals/global":251,"../internals/is-object":263}],242:[function(e,n,i){var o=e("../internals/engine-user-agent");n.exports=/(iphone|ipod|ipad).*applewebkit/i.test(o)},{"../internals/engine-user-agent":243}],243:[function(e,n,i){var o=e("../internals/get-built-in");n.exports=o("navigator","userAgent")||""},{"../internals/get-built-in":249}],244:[function(e,n,i){var o,a,s=e("../internals/global"),l=e("../internals/engine-user-agent"),p=s.process,d=p&&p.versions,g=d&&d.v8;g?a=(o=g.split("."))[0]+o[1]:l&&(!(o=l.match(/Edge\/(\d+)/))||o[1]>=74)&&(o=l.match(/Chrome\/(\d+)/))&&(a=o[1]),n.exports=a&&+a},{"../internals/engine-user-agent":243,"../internals/global":251}],245:[function(e,n,i){n.exports=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"]},{}],246:[function(e,n,i){var o=e("../internals/global"),a=e("../internals/object-get-own-property-descriptor").f,s=e("../internals/create-non-enumerable-property"),l=e("../internals/redefine"),p=e("../internals/set-global"),d=e("../internals/copy-constructor-properties"),g=e("../internals/is-forced");n.exports=function(y,h){var u,f,c,v,m,b=y.target,w=y.global,_=y.stat;if(u=w?o:_?o[b]||p(b,{}):(o[b]||{}).prototype)for(f in h){if(v=h[f],c=y.noTargetGet?(m=a(u,f))&&m.value:u[f],!g(w?f:b+(_?".":"#")+f,y.forced)&&c!==void 0){if(typeof v==typeof c)continue;d(v,c)}(y.sham||c&&c.sham)&&s(v,"sham",!0),l(u,f,v,y)}}},{"../internals/copy-constructor-properties":232,"../internals/create-non-enumerable-property":236,"../internals/global":251,"../internals/is-forced":262,"../internals/object-get-own-property-descriptor":279,"../internals/redefine":294,"../internals/set-global":296}],247:[function(e,n,i){n.exports=function(o){try{return!!o()}catch{return!0}}},{}],248:[function(e,n,i){var o=e("../internals/a-function");n.exports=function(a,s,l){if(o(a),s===void 0)return a;switch(l){case 0:return function(){return a.call(s)};case 1:return function(p){return a.call(s,p)};case 2:return function(p,d){return a.call(s,p,d)};case 3:return function(p,d,g){return a.call(s,p,d,g)}}return function(){return a.apply(s,arguments)}}},{"../internals/a-function":219}],249:[function(e,n,i){var o=e("../internals/path"),a=e("../internals/global"),s=function(l){return typeof l=="function"?l:void 0};n.exports=function(l,p){return arguments.length<2?s(o[l])||s(a[l]):o[l]&&o[l][p]||a[l]&&a[l][p]}},{"../internals/global":251,"../internals/path":290}],250:[function(e,n,i){var o=e("../internals/classof"),a=e("../internals/iterators"),s=e("../internals/well-known-symbol")("iterator");n.exports=function(l){if(l!=null)return l[s]||l["@@iterator"]||a[o(l)]}},{"../internals/classof":231,"../internals/iterators":268,"../internals/well-known-symbol":314}],251:[function(e,n,i){(function(o){var a=function(s){return s&&s.Math==Math&&s};n.exports=a(typeof globalThis=="object"&&globalThis)||a(typeof window=="object"&&window)||a(typeof self=="object"&&self)||a(typeof o=="object"&&o)||Function("return this")()}).call(this,typeof At!="undefined"?At:typeof self!="undefined"?self:typeof window!="undefined"?window:{})},{}],252:[function(e,n,i){var o={}.hasOwnProperty;n.exports=function(a,s){return o.call(a,s)}},{}],253:[function(e,n,i){n.exports={}},{}],254:[function(e,n,i){var o=e("../internals/global");n.exports=function(a,s){var l=o.console;l&&l.error&&(arguments.length===1?l.error(a):l.error(a,s))}},{"../internals/global":251}],255:[function(e,n,i){var o=e("../internals/get-built-in");n.exports=o("document","documentElement")},{"../internals/get-built-in":249}],256:[function(e,n,i){var o=e("../internals/descriptors"),a=e("../internals/fails"),s=e("../internals/document-create-element");n.exports=!o&&!a(function(){return Object.defineProperty(s("div"),"a",{get:function(){return 7}}).a!=7})},{"../internals/descriptors":240,"../internals/document-create-element":241,"../internals/fails":247}],257:[function(e,n,i){var o=e("../internals/fails"),a=e("../internals/classof-raw"),s="".split;n.exports=o(function(){return!Object("z").propertyIsEnumerable(0)})?function(l){return a(l)=="String"?s.call(l,""):Object(l)}:Object},{"../internals/classof-raw":230,"../internals/fails":247}],258:[function(e,n,i){var o=e("../internals/shared-store"),a=Function.toString;typeof o.inspectSource!="function"&&(o.inspectSource=function(s){return a.call(s)}),n.exports=o.inspectSource},{"../internals/shared-store":300}],259:[function(e,n,i){var o,a,s,l=e("../internals/native-weak-map"),p=e("../internals/global"),d=e("../internals/is-object"),g=e("../internals/create-non-enumerable-property"),y=e("../internals/has"),h=e("../internals/shared-key"),u=e("../internals/hidden-keys"),f=p.WeakMap;if(l){var c=new f,v=c.get,m=c.has,b=c.set;o=function(_,C){return b.call(c,_,C),C},a=function(_){return v.call(c,_)||{}},s=function(_){return m.call(c,_)}}else{var w=h("state");u[w]=!0,o=function(_,C){return g(_,w,C),C},a=function(_){return y(_,w)?_[w]:{}},s=function(_){return y(_,w)}}n.exports={set:o,get:a,has:s,enforce:function(_){return s(_)?a(_):o(_,{})},getterFor:function(_){return function(C){var R;if(!d(C)||(R=a(C)).type!==_)throw TypeError("Incompatible receiver, "+_+" required");return R}}}},{"../internals/create-non-enumerable-property":236,"../internals/global":251,"../internals/has":252,"../internals/hidden-keys":253,"../internals/is-object":263,"../internals/native-weak-map":272,"../internals/shared-key":299}],260:[function(e,n,i){var o=e("../internals/well-known-symbol"),a=e("../internals/iterators"),s=o("iterator"),l=Array.prototype;n.exports=function(p){return p!==void 0&&(a.Array===p||l[s]===p)}},{"../internals/iterators":268,"../internals/well-known-symbol":314}],261:[function(e,n,i){var o=e("../internals/classof-raw");n.exports=Array.isArray||function(a){return o(a)=="Array"}},{"../internals/classof-raw":230}],262:[function(e,n,i){var o=e("../internals/fails"),a=/#|\.prototype\./,s=function(y,h){var u=p[l(y)];return u==g||u!=d&&(typeof h=="function"?o(h):!!h)},l=s.normalize=function(y){return String(y).replace(a,".").toLowerCase()},p=s.data={},d=s.NATIVE="N",g=s.POLYFILL="P";n.exports=s},{"../internals/fails":247}],263:[function(e,n,i){n.exports=function(o){return typeof o=="object"?o!==null:typeof o=="function"}},{}],264:[function(e,n,i){n.exports=!1},{}],265:[function(e,n,i){var o=e("../internals/is-object"),a=e("../internals/classof-raw"),s=e("../internals/well-known-symbol")("match");n.exports=function(l){var p;return o(l)&&((p=l[s])!==void 0?!!p:a(l)=="RegExp")}},{"../internals/classof-raw":230,"../internals/is-object":263,"../internals/well-known-symbol":314}],266:[function(e,n,i){var o=e("../internals/an-object"),a=e("../internals/is-array-iterator-method"),s=e("../internals/to-length"),l=e("../internals/function-bind-context"),p=e("../internals/get-iterator-method"),d=e("../internals/call-with-safe-iteration-closing"),g=function(y,h){this.stopped=y,this.result=h};(n.exports=function(y,h,u,f,c){var v,m,b,w,_,C,R,I=l(h,u,f?2:1);if(c)v=y;else{if(typeof(m=p(y))!="function")throw TypeError("Target is not iterable");if(a(m)){for(b=0,w=s(y.length);w>b;b++)if((_=f?I(o(R=y[b])[0],R[1]):I(y[b]))&&_ instanceof g)return _;return new g(!1)}v=m.call(y)}for(C=v.next;!(R=C.call(v)).done;)if(typeof(_=d(v,I,R.value,f))=="object"&&_&&_ instanceof g)return _;return new g(!1)}).stop=function(y){return new g(!0,y)}},{"../internals/an-object":223,"../internals/call-with-safe-iteration-closing":228,"../internals/function-bind-context":248,"../internals/get-iterator-method":250,"../internals/is-array-iterator-method":260,"../internals/to-length":307}],267:[function(e,n,i){var o,a,s,l=e("../internals/object-get-prototype-of"),p=e("../internals/create-non-enumerable-property"),d=e("../internals/has"),g=e("../internals/well-known-symbol"),y=e("../internals/is-pure"),h=g("iterator"),u=!1;[].keys&&("next"in(s=[].keys())?(a=l(l(s)))!==Object.prototype&&(o=a):u=!0),o==null&&(o={}),y||d(o,h)||p(o,h,function(){return this}),n.exports={IteratorPrototype:o,BUGGY_SAFARI_ITERATORS:u}},{"../internals/create-non-enumerable-property":236,"../internals/has":252,"../internals/is-pure":264,"../internals/object-get-prototype-of":283,"../internals/well-known-symbol":314}],268:[function(e,n,i){arguments[4][253][0].apply(i,arguments)},{dup:253}],269:[function(e,n,i){var o,a,s,l,p,d,g,y,h=e("../internals/global"),u=e("../internals/object-get-own-property-descriptor").f,f=e("../internals/classof-raw"),c=e("../internals/task").set,v=e("../internals/engine-is-ios"),m=h.MutationObserver||h.WebKitMutationObserver,b=h.process,w=h.Promise,_=f(b)=="process",C=u(h,"queueMicrotask"),R=C&&C.value;R||(o=function(){var I,P;for(_&&(I=b.domain)&&I.exit();a;){P=a.fn,a=a.next;try{P()}catch(N){throw a?l():s=void 0,N}}s=void 0,I&&I.enter()},_?l=function(){b.nextTick(o)}:m&&!v?(p=!0,d=document.createTextNode(""),new m(o).observe(d,{characterData:!0}),l=function(){d.data=p=!p}):w&&w.resolve?(g=w.resolve(void 0),y=g.then,l=function(){y.call(g,o)}):l=function(){c.call(h,o)}),n.exports=R||function(I){var P={fn:I,next:void 0};s&&(s.next=P),a||(a=P,l()),s=P}},{"../internals/classof-raw":230,"../internals/engine-is-ios":242,"../internals/global":251,"../internals/object-get-own-property-descriptor":279,"../internals/task":303}],270:[function(e,n,i){var o=e("../internals/global");n.exports=o.Promise},{"../internals/global":251}],271:[function(e,n,i){var o=e("../internals/fails");n.exports=!!Object.getOwnPropertySymbols&&!o(function(){return!String(Symbol())})},{"../internals/fails":247}],272:[function(e,n,i){var o=e("../internals/global"),a=e("../internals/inspect-source"),s=o.WeakMap;n.exports=typeof s=="function"&&/native code/.test(a(s))},{"../internals/global":251,"../internals/inspect-source":258}],273:[function(e,n,i){var o=e("../internals/a-function"),a=function(s){var l,p;this.promise=new s(function(d,g){if(l!==void 0||p!==void 0)throw TypeError("Bad Promise constructor");l=d,p=g}),this.resolve=o(l),this.reject=o(p)};n.exports.f=function(s){return new a(s)}},{"../internals/a-function":219}],274:[function(e,n,i){var o=e("../internals/is-regexp");n.exports=function(a){if(o(a))throw TypeError("The method doesn't accept regular expressions");return a}},{"../internals/is-regexp":265}],275:[function(e,n,i){var o=e("../internals/descriptors"),a=e("../internals/fails"),s=e("../internals/object-keys"),l=e("../internals/object-get-own-property-symbols"),p=e("../internals/object-property-is-enumerable"),d=e("../internals/to-object"),g=e("../internals/indexed-object"),y=Object.assign,h=Object.defineProperty;n.exports=!y||a(function(){if(o&&y({b:1},y(h({},"a",{enumerable:!0,get:function(){h(this,"b",{value:3,enumerable:!1})}}),{b:2})).b!==1)return!0;var u={},f={},c=Symbol();return u[c]=7,"abcdefghijklmnopqrst".split("").forEach(function(v){f[v]=v}),y({},u)[c]!=7||s(y({},f)).join("")!="abcdefghijklmnopqrst"})?function(u,f){for(var c=d(u),v=arguments.length,m=1,b=l.f,w=p.f;v>m;)for(var _,C=g(arguments[m++]),R=b?s(C).concat(b(C)):s(C),I=R.length,P=0;I>P;)_=R[P++],o&&!w.call(C,_)||(c[_]=C[_]);return c}:y},{"../internals/descriptors":240,"../internals/fails":247,"../internals/indexed-object":257,"../internals/object-get-own-property-symbols":282,"../internals/object-keys":285,"../internals/object-property-is-enumerable":286,"../internals/to-object":308}],276:[function(e,n,i){var o,a=e("../internals/an-object"),s=e("../internals/object-define-properties"),l=e("../internals/enum-bug-keys"),p=e("../internals/hidden-keys"),d=e("../internals/html"),g=e("../internals/document-create-element"),y=e("../internals/shared-key"),h=y("IE_PROTO"),u=function(){},f=function(v){return"<script>"+v+"<\/script>"},c=function(){try{o=document.domain&&new ActiveXObject("htmlfile")}catch{}var v,m;c=o?function(w){w.write(f("")),w.close();var _=w.parentWindow.Object;return w=null,_}(o):((m=g("iframe")).style.display="none",d.appendChild(m),m.src=String("javascript:"),(v=m.contentWindow.document).open(),v.write(f("document.F=Object")),v.close(),v.F);for(var b=l.length;b--;)delete c.prototype[l[b]];return c()};p[h]=!0,n.exports=Object.create||function(v,m){var b;return v!==null?(u.prototype=a(v),b=new u,u.prototype=null,b[h]=v):b=c(),m===void 0?b:s(b,m)}},{"../internals/an-object":223,"../internals/document-create-element":241,"../internals/enum-bug-keys":245,"../internals/hidden-keys":253,"../internals/html":255,"../internals/object-define-properties":277,"../internals/shared-key":299}],277:[function(e,n,i){var o=e("../internals/descriptors"),a=e("../internals/object-define-property"),s=e("../internals/an-object"),l=e("../internals/object-keys");n.exports=o?Object.defineProperties:function(p,d){s(p);for(var g,y=l(d),h=y.length,u=0;h>u;)a.f(p,g=y[u++],d[g]);return p}},{"../internals/an-object":223,"../internals/descriptors":240,"../internals/object-define-property":278,"../internals/object-keys":285}],278:[function(e,n,i){var o=e("../internals/descriptors"),a=e("../internals/ie8-dom-define"),s=e("../internals/an-object"),l=e("../internals/to-primitive"),p=Object.defineProperty;i.f=o?p:function(d,g,y){if(s(d),g=l(g,!0),s(y),a)try{return p(d,g,y)}catch{}if("get"in y||"set"in y)throw TypeError("Accessors not supported");return"value"in y&&(d[g]=y.value),d}},{"../internals/an-object":223,"../internals/descriptors":240,"../internals/ie8-dom-define":256,"../internals/to-primitive":309}],279:[function(e,n,i){var o=e("../internals/descriptors"),a=e("../internals/object-property-is-enumerable"),s=e("../internals/create-property-descriptor"),l=e("../internals/to-indexed-object"),p=e("../internals/to-primitive"),d=e("../internals/has"),g=e("../internals/ie8-dom-define"),y=Object.getOwnPropertyDescriptor;i.f=o?y:function(h,u){if(h=l(h),u=p(u,!0),g)try{return y(h,u)}catch{}if(d(h,u))return s(!a.f.call(h,u),h[u])}},{"../internals/create-property-descriptor":237,"../internals/descriptors":240,"../internals/has":252,"../internals/ie8-dom-define":256,"../internals/object-property-is-enumerable":286,"../internals/to-indexed-object":305,"../internals/to-primitive":309}],280:[function(e,n,i){var o=e("../internals/to-indexed-object"),a=e("../internals/object-get-own-property-names").f,s={}.toString,l=typeof window=="object"&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[];n.exports.f=function(p){return l&&s.call(p)=="[object Window]"?function(d){try{return a(d)}catch{return l.slice()}}(p):a(o(p))}},{"../internals/object-get-own-property-names":281,"../internals/to-indexed-object":305}],281:[function(e,n,i){var o=e("../internals/object-keys-internal"),a=e("../internals/enum-bug-keys").concat("length","prototype");i.f=Object.getOwnPropertyNames||function(s){return o(s,a)}},{"../internals/enum-bug-keys":245,"../internals/object-keys-internal":284}],282:[function(e,n,i){i.f=Object.getOwnPropertySymbols},{}],283:[function(e,n,i){var o=e("../internals/has"),a=e("../internals/to-object"),s=e("../internals/shared-key"),l=e("../internals/correct-prototype-getter"),p=s("IE_PROTO"),d=Object.prototype;n.exports=l?Object.getPrototypeOf:function(g){return g=a(g),o(g,p)?g[p]:typeof g.constructor=="function"&&g instanceof g.constructor?g.constructor.prototype:g instanceof Object?d:null}},{"../internals/correct-prototype-getter":234,"../internals/has":252,"../internals/shared-key":299,"../internals/to-object":308}],284:[function(e,n,i){var o=e("../internals/has"),a=e("../internals/to-indexed-object"),s=e("../internals/array-includes").indexOf,l=e("../internals/hidden-keys");n.exports=function(p,d){var g,y=a(p),h=0,u=[];for(g in y)!o(l,g)&&o(y,g)&&u.push(g);for(;d.length>h;)o(y,g=d[h++])&&(~s(u,g)||u.push(g));return u}},{"../internals/array-includes":224,"../internals/has":252,"../internals/hidden-keys":253,"../internals/to-indexed-object":305}],285:[function(e,n,i){var o=e("../internals/object-keys-internal"),a=e("../internals/enum-bug-keys");n.exports=Object.keys||function(s){return o(s,a)}},{"../internals/enum-bug-keys":245,"../internals/object-keys-internal":284}],286:[function(e,n,i){var o={}.propertyIsEnumerable,a=Object.getOwnPropertyDescriptor,s=a&&!o.call({1:2},1);i.f=s?function(l){var p=a(this,l);return!!p&&p.enumerable}:o},{}],287:[function(e,n,i){var o=e("../internals/an-object"),a=e("../internals/a-possible-prototype");n.exports=Object.setPrototypeOf||("__proto__"in{}?function(){var s,l=!1,p={};try{(s=Object.getOwnPropertyDescriptor(Object.prototype,"__proto__").set).call(p,[]),l=p instanceof Array}catch{}return function(d,g){return o(d),a(g),l?s.call(d,g):d.__proto__=g,d}}():void 0)},{"../internals/a-possible-prototype":220,"../internals/an-object":223}],288:[function(e,n,i){var o=e("../internals/descriptors"),a=e("../internals/object-keys"),s=e("../internals/to-indexed-object"),l=e("../internals/object-property-is-enumerable").f,p=function(d){return function(g){for(var y,h=s(g),u=a(h),f=u.length,c=0,v=[];f>c;)y=u[c++],o&&!l.call(h,y)||v.push(d?[y,h[y]]:h[y]);return v}};n.exports={entries:p(!0),values:p(!1)}},{"../internals/descriptors":240,"../internals/object-keys":285,"../internals/object-property-is-enumerable":286,"../internals/to-indexed-object":305}],289:[function(e,n,i){var o=e("../internals/get-built-in"),a=e("../internals/object-get-own-property-names"),s=e("../internals/object-get-own-property-symbols"),l=e("../internals/an-object");n.exports=o("Reflect","ownKeys")||function(p){var d=a.f(l(p)),g=s.f;return g?d.concat(g(p)):d}},{"../internals/an-object":223,"../internals/get-built-in":249,"../internals/object-get-own-property-names":281,"../internals/object-get-own-property-symbols":282}],290:[function(e,n,i){var o=e("../internals/global");n.exports=o},{"../internals/global":251}],291:[function(e,n,i){n.exports=function(o){try{return{error:!1,value:o()}}catch(a){return{error:!0,value:a}}}},{}],292:[function(e,n,i){var o=e("../internals/an-object"),a=e("../internals/is-object"),s=e("../internals/new-promise-capability");n.exports=function(l,p){if(o(l),a(p)&&p.constructor===l)return p;var d=s.f(l);return(0,d.resolve)(p),d.promise}},{"../internals/an-object":223,"../internals/is-object":263,"../internals/new-promise-capability":273}],293:[function(e,n,i){var o=e("../internals/redefine");n.exports=function(a,s,l){for(var p in s)o(a,p,s[p],l);return a}},{"../internals/redefine":294}],294:[function(e,n,i){var o=e("../internals/global"),a=e("../internals/create-non-enumerable-property"),s=e("../internals/has"),l=e("../internals/set-global"),p=e("../internals/inspect-source"),d=e("../internals/internal-state"),g=d.get,y=d.enforce,h=String(String).split("String");(n.exports=function(u,f,c,v){var m=!!v&&!!v.unsafe,b=!!v&&!!v.enumerable,w=!!v&&!!v.noTargetGet;typeof c=="function"&&(typeof f!="string"||s(c,"name")||a(c,"name",f),y(c).source=h.join(typeof f=="string"?f:"")),u!==o?(m?!w&&u[f]&&(b=!0):delete u[f],b?u[f]=c:a(u,f,c)):b?u[f]=c:l(f,c)})(Function.prototype,"toString",function(){return typeof this=="function"&&g(this).source||p(this)})},{"../internals/create-non-enumerable-property":236,"../internals/global":251,"../internals/has":252,"../internals/inspect-source":258,"../internals/internal-state":259,"../internals/set-global":296}],295:[function(e,n,i){n.exports=function(o){if(o==null)throw TypeError("Can't call method on "+o);return o}},{}],296:[function(e,n,i){var o=e("../internals/global"),a=e("../internals/create-non-enumerable-property");n.exports=function(s,l){try{a(o,s,l)}catch{o[s]=l}return l}},{"../internals/create-non-enumerable-property":236,"../internals/global":251}],297:[function(e,n,i){var o=e("../internals/get-built-in"),a=e("../internals/object-define-property"),s=e("../internals/well-known-symbol"),l=e("../internals/descriptors"),p=s("species");n.exports=function(d){var g=o(d),y=a.f;l&&g&&!g[p]&&y(g,p,{configurable:!0,get:function(){return this}})}},{"../internals/descriptors":240,"../internals/get-built-in":249,"../internals/object-define-property":278,"../internals/well-known-symbol":314}],298:[function(e,n,i){var o=e("../internals/object-define-property").f,a=e("../internals/has"),s=e("../internals/well-known-symbol")("toStringTag");n.exports=function(l,p,d){l&&!a(l=d?l:l.prototype,s)&&o(l,s,{configurable:!0,value:p})}},{"../internals/has":252,"../internals/object-define-property":278,"../internals/well-known-symbol":314}],299:[function(e,n,i){var o=e("../internals/shared"),a=e("../internals/uid"),s=o("keys");n.exports=function(l){return s[l]||(s[l]=a(l))}},{"../internals/shared":301,"../internals/uid":311}],300:[function(e,n,i){var o=e("../internals/global"),a=e("../internals/set-global"),s=o["__core-js_shared__"]||a("__core-js_shared__",{});n.exports=s},{"../internals/global":251,"../internals/set-global":296}],301:[function(e,n,i){var o=e("../internals/is-pure"),a=e("../internals/shared-store");(n.exports=function(s,l){return a[s]||(a[s]=l!==void 0?l:{})})("versions",[]).push({version:"3.6.5",mode:o?"pure":"global",copyright:"\xA9 2020 Denis Pushkarev (zloirock.ru)"})},{"../internals/is-pure":264,"../internals/shared-store":300}],302:[function(e,n,i){var o=e("../internals/an-object"),a=e("../internals/a-function"),s=e("../internals/well-known-symbol")("species");n.exports=function(l,p){var d,g=o(l).constructor;return g===void 0||(d=o(g)[s])==null?p:a(d)}},{"../internals/a-function":219,"../internals/an-object":223,"../internals/well-known-symbol":314}],303:[function(e,n,i){var o,a,s,l=e("../internals/global"),p=e("../internals/fails"),d=e("../internals/classof-raw"),g=e("../internals/function-bind-context"),y=e("../internals/html"),h=e("../internals/document-create-element"),u=e("../internals/engine-is-ios"),f=l.location,c=l.setImmediate,v=l.clearImmediate,m=l.process,b=l.MessageChannel,w=l.Dispatch,_=0,C={},R=function(A){if(C.hasOwnProperty(A)){var $=C[A];delete C[A],$()}},I=function(A){return function(){R(A)}},P=function(A){R(A.data)},N=function(A){l.postMessage(A+"",f.protocol+"//"+f.host)};c&&v||(c=function(A){for(var $=[],T=1;arguments.length>T;)$.push(arguments[T++]);return C[++_]=function(){(typeof A=="function"?A:Function(A)).apply(void 0,$)},o(_),_},v=function(A){delete C[A]},d(m)=="process"?o=function(A){m.nextTick(I(A))}:w&&w.now?o=function(A){w.now(I(A))}:b&&!u?(s=(a=new b).port2,a.port1.onmessage=P,o=g(s.postMessage,s,1)):!l.addEventListener||typeof postMessage!="function"||l.importScripts||p(N)||f.protocol==="file:"?o="onreadystatechange"in h("script")?function(A){y.appendChild(h("script")).onreadystatechange=function(){y.removeChild(this),R(A)}}:function(A){setTimeout(I(A),0)}:(o=N,l.addEventListener("message",P,!1))),n.exports={set:c,clear:v}},{"../internals/classof-raw":230,"../internals/document-create-element":241,"../internals/engine-is-ios":242,"../internals/fails":247,"../internals/function-bind-context":248,"../internals/global":251,"../internals/html":255}],304:[function(e,n,i){var o=e("../internals/to-integer"),a=Math.max,s=Math.min;n.exports=function(l,p){var d=o(l);return d<0?a(d+p,0):s(d,p)}},{"../internals/to-integer":306}],305:[function(e,n,i){var o=e("../internals/indexed-object"),a=e("../internals/require-object-coercible");n.exports=function(s){return o(a(s))}},{"../internals/indexed-object":257,"../internals/require-object-coercible":295}],306:[function(e,n,i){var o=Math.ceil,a=Math.floor;n.exports=function(s){return isNaN(s=+s)?0:(s>0?a:o)(s)}},{}],307:[function(e,n,i){var o=e("../internals/to-integer"),a=Math.min;n.exports=function(s){return s>0?a(o(s),9007199254740991):0}},{"../internals/to-integer":306}],308:[function(e,n,i){var o=e("../internals/require-object-coercible");n.exports=function(a){return Object(o(a))}},{"../internals/require-object-coercible":295}],309:[function(e,n,i){var o=e("../internals/is-object");n.exports=function(a,s){if(!o(a))return a;var l,p;if(s&&typeof(l=a.toString)=="function"&&!o(p=l.call(a))||typeof(l=a.valueOf)=="function"&&!o(p=l.call(a))||!s&&typeof(l=a.toString)=="function"&&!o(p=l.call(a)))return p;throw TypeError("Can't convert object to primitive value")}},{"../internals/is-object":263}],310:[function(e,n,i){var o={};o[e("../internals/well-known-symbol")("toStringTag")]="z",n.exports=String(o)==="[object z]"},{"../internals/well-known-symbol":314}],311:[function(e,n,i){var o=0,a=Math.random();n.exports=function(s){return"Symbol("+String(s===void 0?"":s)+")_"+(++o+a).toString(36)}},{}],312:[function(e,n,i){var o=e("../internals/native-symbol");n.exports=o&&!Symbol.sham&&typeof Symbol.iterator=="symbol"},{"../internals/native-symbol":271}],313:[function(e,n,i){var o=e("../internals/well-known-symbol");i.f=o},{"../internals/well-known-symbol":314}],314:[function(e,n,i){var o=e("../internals/global"),a=e("../internals/shared"),s=e("../internals/has"),l=e("../internals/uid"),p=e("../internals/native-symbol"),d=e("../internals/use-symbol-as-uid"),g=a("wks"),y=o.Symbol,h=d?y:y&&y.withoutSetter||l;n.exports=function(u){return s(g,u)||(p&&s(y,u)?g[u]=y[u]:g[u]=h("Symbol."+u)),g[u]}},{"../internals/global":251,"../internals/has":252,"../internals/native-symbol":271,"../internals/shared":301,"../internals/uid":311,"../internals/use-symbol-as-uid":312}],315:[function(e,n,i){var o=e("../internals/export"),a=e("../internals/array-iteration").findIndex,s=e("../internals/add-to-unscopables"),l=e("../internals/array-method-uses-to-length"),p=!0,d=l("findIndex");"findIndex"in[]&&Array(1).findIndex(function(){p=!1}),o({target:"Array",proto:!0,forced:p||!d},{findIndex:function(g){return a(this,g,arguments.length>1?arguments[1]:void 0)}}),s("findIndex")},{"../internals/add-to-unscopables":221,"../internals/array-iteration":225,"../internals/array-method-uses-to-length":226,"../internals/export":246}],316:[function(e,n,i){var o=e("../internals/export"),a=e("../internals/array-iteration").find,s=e("../internals/add-to-unscopables"),l=e("../internals/array-method-uses-to-length"),p=!0,d=l("find");"find"in[]&&Array(1).find(function(){p=!1}),o({target:"Array",proto:!0,forced:p||!d},{find:function(g){return a(this,g,arguments.length>1?arguments[1]:void 0)}}),s("find")},{"../internals/add-to-unscopables":221,"../internals/array-iteration":225,"../internals/array-method-uses-to-length":226,"../internals/export":246}],317:[function(e,n,i){var o=e("../internals/export"),a=e("../internals/array-includes").includes,s=e("../internals/add-to-unscopables");o({target:"Array",proto:!0,forced:!e("../internals/array-method-uses-to-length")("indexOf",{ACCESSORS:!0,1:0})},{includes:function(l){return a(this,l,arguments.length>1?arguments[1]:void 0)}}),s("includes")},{"../internals/add-to-unscopables":221,"../internals/array-includes":224,"../internals/array-method-uses-to-length":226,"../internals/export":246}],318:[function(e,n,i){var o=e("../internals/to-indexed-object"),a=e("../internals/add-to-unscopables"),s=e("../internals/iterators"),l=e("../internals/internal-state"),p=e("../internals/define-iterator"),d=l.set,g=l.getterFor("Array Iterator");n.exports=p(Array,"Array",function(y,h){d(this,{type:"Array Iterator",target:o(y),index:0,kind:h})},function(){var y=g(this),h=y.target,u=y.kind,f=y.index++;return!h||f>=h.length?(y.target=void 0,{value:void 0,done:!0}):u=="keys"?{value:f,done:!1}:u=="values"?{value:h[f],done:!1}:{value:[f,h[f]],done:!1}},"values"),s.Arguments=s.Array,a("keys"),a("values"),a("entries")},{"../internals/add-to-unscopables":221,"../internals/define-iterator":238,"../internals/internal-state":259,"../internals/iterators":268,"../internals/to-indexed-object":305}],319:[function(e,n,i){e("../internals/export")({target:"Number",stat:!0},{isNaN:function(o){return o!=o}})},{"../internals/export":246}],320:[function(e,n,i){var o=e("../internals/export"),a=e("../internals/object-assign");o({target:"Object",stat:!0,forced:Object.assign!==a},{assign:a})},{"../internals/export":246,"../internals/object-assign":275}],321:[function(e,n,i){var o=e("../internals/export"),a=e("../internals/to-object"),s=e("../internals/object-keys");o({target:"Object",stat:!0,forced:e("../internals/fails")(function(){s(1)})},{keys:function(l){return s(a(l))}})},{"../internals/export":246,"../internals/fails":247,"../internals/object-keys":285,"../internals/to-object":308}],322:[function(e,n,i){var o=e("../internals/export"),a=e("../internals/object-to-array").values;o({target:"Object",stat:!0},{values:function(s){return a(s)}})},{"../internals/export":246,"../internals/object-to-array":288}],323:[function(e,n,i){var o,a,s,l,p=e("../internals/export"),d=e("../internals/is-pure"),g=e("../internals/global"),y=e("../internals/get-built-in"),h=e("../internals/native-promise-constructor"),u=e("../internals/redefine"),f=e("../internals/redefine-all"),c=e("../internals/set-to-string-tag"),v=e("../internals/set-species"),m=e("../internals/is-object"),b=e("../internals/a-function"),w=e("../internals/an-instance"),_=e("../internals/classof-raw"),C=e("../internals/inspect-source"),R=e("../internals/iterate"),I=e("../internals/check-correctness-of-iteration"),P=e("../internals/species-constructor"),N=e("../internals/task").set,A=e("../internals/microtask"),$=e("../internals/promise-resolve"),T=e("../internals/host-report-errors"),M=e("../internals/new-promise-capability"),S=e("../internals/perform"),E=e("../internals/internal-state"),k=e("../internals/is-forced"),O=e("../internals/well-known-symbol"),x=e("../internals/engine-v8-version"),j=O("species"),H="Promise",F=E.get,V=E.set,W=E.getterFor(H),U=h,Y=g.TypeError,K=g.document,D=g.process,L=y("fetch"),B=M.f,z=B,q=_(D)=="process",X=!!(K&&K.createEvent&&g.dispatchEvent),ee=k(H,function(){if(C(U)===String(U)&&(x===66||!q&&typeof PromiseRejectionEvent!="function")||d&&!U.prototype.finally)return!0;if(x>=51&&/native code/.test(U))return!1;var oe=U.resolve(1),G=function(Z){Z(function(){},function(){})};return(oe.constructor={})[j]=G,!(oe.then(function(){})instanceof G)}),ye=ee||!I(function(oe){U.all(oe).catch(function(){})}),de=function(oe){var G;return!(!m(oe)||typeof(G=oe.then)!="function")&&G},ge=function(oe,G,Z){if(!G.notified){G.notified=!0;var Q=G.reactions;A(function(){for(var re=G.value,ne=G.state==1,ue=0;Q.length>ue;){var le,ve,Se,Oe=Q[ue++],xe=ne?Oe.ok:Oe.fail,Ce=Oe.resolve,Le=Oe.reject,Ve=Oe.domain;try{xe?(ne||(G.rejection===2&&te(oe,G),G.rejection=1),xe===!0?le=re:(Ve&&Ve.enter(),le=xe(re),Ve&&(Ve.exit(),Se=!0)),le===Oe.promise?Le(Y("Promise-chain cycle")):(ve=de(le))?ve.call(le,Ce,Le):Ce(le)):Le(re)}catch(Je){Ve&&!Se&&Ve.exit(),Le(Je)}}G.reactions=[],G.notified=!1,Z&&!G.rejection&&be(oe,G)})}},we=function(oe,G,Z){var Q,re;X?((Q=K.createEvent("Event")).promise=G,Q.reason=Z,Q.initEvent(oe,!1,!0),g.dispatchEvent(Q)):Q={promise:G,reason:Z},(re=g["on"+oe])?re(Q):oe==="unhandledrejection"&&T("Unhandled promise rejection",Z)},be=function(oe,G){N.call(g,function(){var Z,Q=G.value;if(J(G)&&(Z=S(function(){q?D.emit("unhandledRejection",Q,oe):we("unhandledrejection",oe,Q)}),G.rejection=q||J(G)?2:1,Z.error))throw Z.value})},J=function(oe){return oe.rejection!==1&&!oe.parent},te=function(oe,G){N.call(g,function(){q?D.emit("rejectionHandled",oe):we("rejectionhandled",oe,G.value)})},ie=function(oe,G,Z,Q){return function(re){oe(G,Z,re,Q)}},fe=function(oe,G,Z,Q){G.done||(G.done=!0,Q&&(G=Q),G.value=Z,G.state=2,ge(oe,G,!0))},se=function(oe,G,Z,Q){if(!G.done){G.done=!0,Q&&(G=Q);try{if(oe===Z)throw Y("Promise can't be resolved itself");var re=de(Z);re?A(function(){var ne={done:!1};try{re.call(Z,ie(se,oe,ne,G),ie(fe,oe,ne,G))}catch(ue){fe(oe,ne,ue,G)}}):(G.value=Z,G.state=1,ge(oe,G,!1))}catch(ne){fe(oe,{done:!1},ne,G)}}};ee&&(U=function(oe){w(this,U,H),b(oe),o.call(this);var G=F(this);try{oe(ie(se,this,G),ie(fe,this,G))}catch(Z){fe(this,G,Z)}},(o=function(oe){V(this,{type:H,done:!1,notified:!1,parent:!1,reactions:[],rejection:!1,state:0,value:void 0})}).prototype=f(U.prototype,{then:function(oe,G){var Z=W(this),Q=B(P(this,U));return Q.ok=typeof oe!="function"||oe,Q.fail=typeof G=="function"&&G,Q.domain=q?D.domain:void 0,Z.parent=!0,Z.reactions.push(Q),Z.state!=0&&ge(this,Z,!1),Q.promise},catch:function(oe){return this.then(void 0,oe)}}),a=function(){var oe=new o,G=F(oe);this.promise=oe,this.resolve=ie(se,oe,G),this.reject=ie(fe,oe,G)},M.f=B=function(oe){return oe===U||oe===s?new a(oe):z(oe)},d||typeof h!="function"||(l=h.prototype.then,u(h.prototype,"then",function(oe,G){var Z=this;return new U(function(Q,re){l.call(Z,Q,re)}).then(oe,G)},{unsafe:!0}),typeof L=="function"&&p({global:!0,enumerable:!0,forced:!0},{fetch:function(oe){return $(U,L.apply(g,arguments))}}))),p({global:!0,wrap:!0,forced:ee},{Promise:U}),c(U,H,!1,!0),v(H),s=y(H),p({target:H,stat:!0,forced:ee},{reject:function(oe){var G=B(this);return G.reject.call(void 0,oe),G.promise}}),p({target:H,stat:!0,forced:d||ee},{resolve:function(oe){return $(d&&this===s?U:this,oe)}}),p({target:H,stat:!0,forced:ye},{all:function(oe){var G=this,Z=B(G),Q=Z.resolve,re=Z.reject,ne=S(function(){var ue=b(G.resolve),le=[],ve=0,Se=1;R(oe,function(Oe){var xe=ve++,Ce=!1;le.push(void 0),Se++,ue.call(G,Oe).then(function(Le){Ce||(Ce=!0,le[xe]=Le,--Se||Q(le))},re)}),--Se||Q(le)});return ne.error&&re(ne.value),Z.promise},race:function(oe){var G=this,Z=B(G),Q=Z.reject,re=S(function(){var ne=b(G.resolve);R(oe,function(ue){ne.call(G,ue).then(Z.resolve,Q)})});return re.error&&Q(re.value),Z.promise}})},{"../internals/a-function":219,"../internals/an-instance":222,"../internals/check-correctness-of-iteration":229,"../internals/classof-raw":230,"../internals/engine-v8-version":244,"../internals/export":246,"../internals/get-built-in":249,"../internals/global":251,"../internals/host-report-errors":254,"../internals/inspect-source":258,"../internals/internal-state":259,"../internals/is-forced":262,"../internals/is-object":263,"../internals/is-pure":264,"../internals/iterate":266,"../internals/microtask":269,"../internals/native-promise-constructor":270,"../internals/new-promise-capability":273,"../internals/perform":291,"../internals/promise-resolve":292,"../internals/redefine":294,"../internals/redefine-all":293,"../internals/set-species":297,"../internals/set-to-string-tag":298,"../internals/species-constructor":302,"../internals/task":303,"../internals/well-known-symbol":314}],324:[function(e,n,i){var o=e("../internals/export"),a=e("../internals/to-absolute-index"),s=String.fromCharCode,l=String.fromCodePoint;o({target:"String",stat:!0,forced:!!l&&l.length!=1},{fromCodePoint:function(p){for(var d,g=[],y=arguments.length,h=0;y>h;){if(d=+arguments[h++],a(d,1114111)!==d)throw RangeError(d+" is not a valid code point");g.push(d<65536?s(d):s(55296+((d-=65536)>>10),d%1024+56320))}return g.join("")}})},{"../internals/export":246,"../internals/to-absolute-index":304}],325:[function(e,n,i){var o=e("../internals/export"),a=e("../internals/not-a-regexp"),s=e("../internals/require-object-coercible");o({target:"String",proto:!0,forced:!e("../internals/correct-is-regexp-logic")("includes")},{includes:function(l){return!!~String(s(this)).indexOf(a(l),arguments.length>1?arguments[1]:void 0)}})},{"../internals/correct-is-regexp-logic":233,"../internals/export":246,"../internals/not-a-regexp":274,"../internals/require-object-coercible":295}],326:[function(e,n,i){e("../internals/define-well-known-symbol")("asyncIterator")},{"../internals/define-well-known-symbol":239}],327:[function(e,n,i){var o=e("../internals/export"),a=e("../internals/global"),s=e("../internals/get-built-in"),l=e("../internals/is-pure"),p=e("../internals/descriptors"),d=e("../internals/native-symbol"),g=e("../internals/use-symbol-as-uid"),y=e("../internals/fails"),h=e("../internals/has"),u=e("../internals/is-array"),f=e("../internals/is-object"),c=e("../internals/an-object"),v=e("../internals/to-object"),m=e("../internals/to-indexed-object"),b=e("../internals/to-primitive"),w=e("../internals/create-property-descriptor"),_=e("../internals/object-create"),C=e("../internals/object-keys"),R=e("../internals/object-get-own-property-names"),I=e("../internals/object-get-own-property-names-external"),P=e("../internals/object-get-own-property-symbols"),N=e("../internals/object-get-own-property-descriptor"),A=e("../internals/object-define-property"),$=e("../internals/object-property-is-enumerable"),T=e("../internals/create-non-enumerable-property"),M=e("../internals/redefine"),S=e("../internals/shared"),E=e("../internals/shared-key"),k=e("../internals/hidden-keys"),O=e("../internals/uid"),x=e("../internals/well-known-symbol"),j=e("../internals/well-known-symbol-wrapped"),H=e("../internals/define-well-known-symbol"),F=e("../internals/set-to-string-tag"),V=e("../internals/internal-state"),W=e("../internals/array-iteration").forEach,U=E("hidden"),Y=x("toPrimitive"),K=V.set,D=V.getterFor("Symbol"),L=Object.prototype,B=a.Symbol,z=s("JSON","stringify"),q=N.f,X=A.f,ee=I.f,ye=$.f,de=S("symbols"),ge=S("op-symbols"),we=S("string-to-symbol-registry"),be=S("symbol-to-string-registry"),J=S("wks"),te=a.QObject,ie=!te||!te.prototype||!te.prototype.findChild,fe=p&&y(function(){return _(X({},"a",{get:function(){return X(this,"a",{value:7}).a}})).a!=7})?function(le,ve,Se){var Oe=q(L,ve);Oe&&delete L[ve],X(le,ve,Se),Oe&&le!==L&&X(L,ve,Oe)}:X,se=function(le,ve){var Se=de[le]=_(B.prototype);return K(Se,{type:"Symbol",tag:le,description:ve}),p||(Se.description=ve),Se},oe=g?function(le){return typeof le=="symbol"}:function(le){return Object(le)instanceof B},G=function(le,ve,Se){le===L&&G(ge,ve,Se),c(le);var Oe=b(ve,!0);return c(Se),h(de,Oe)?(Se.enumerable?(h(le,U)&&le[U][Oe]&&(le[U][Oe]=!1),Se=_(Se,{enumerable:w(0,!1)})):(h(le,U)||X(le,U,w(1,{})),le[U][Oe]=!0),fe(le,Oe,Se)):X(le,Oe,Se)},Z=function(le,ve){c(le);var Se=m(ve),Oe=C(Se).concat(ue(Se));return W(Oe,function(xe){p&&!Q.call(Se,xe)||G(le,xe,Se[xe])}),le},Q=function(le){var ve=b(le,!0),Se=ye.call(this,ve);return!(this===L&&h(de,ve)&&!h(ge,ve))&&(!(Se||!h(this,ve)||!h(de,ve)||h(this,U)&&this[U][ve])||Se)},re=function(le,ve){var Se=m(le),Oe=b(ve,!0);if(Se!==L||!h(de,Oe)||h(ge,Oe)){var xe=q(Se,Oe);return!xe||!h(de,Oe)||h(Se,U)&&Se[U][Oe]||(xe.enumerable=!0),xe}},ne=function(le){var ve=ee(m(le)),Se=[];return W(ve,function(Oe){h(de,Oe)||h(k,Oe)||Se.push(Oe)}),Se},ue=function(le){var ve=le===L,Se=ee(ve?ge:m(le)),Oe=[];return W(Se,function(xe){!h(de,xe)||ve&&!h(L,xe)||Oe.push(de[xe])}),Oe};d||(M((B=function(){if(this instanceof B)throw TypeError("Symbol is not a constructor");var le=arguments.length&&arguments[0]!==void 0?String(arguments[0]):void 0,ve=O(le),Se=function(Oe){this===L&&Se.call(ge,Oe),h(this,U)&&h(this[U],ve)&&(this[U][ve]=!1),fe(this,ve,w(1,Oe))};return p&&ie&&fe(L,ve,{configurable:!0,set:Se}),se(ve,le)}).prototype,"toString",function(){return D(this).tag}),M(B,"withoutSetter",function(le){return se(O(le),le)}),$.f=Q,A.f=G,N.f=re,R.f=I.f=ne,P.f=ue,j.f=function(le){return se(x(le),le)},p&&(X(B.prototype,"description",{configurable:!0,get:function(){return D(this).description}}),l||M(L,"propertyIsEnumerable",Q,{unsafe:!0}))),o({global:!0,wrap:!0,forced:!d,sham:!d},{Symbol:B}),W(C(J),function(le){H(le)}),o({target:"Symbol",stat:!0,forced:!d},{for:function(le){var ve=String(le);if(h(we,ve))return we[ve];var Se=B(ve);return we[ve]=Se,be[Se]=ve,Se},keyFor:function(le){if(!oe(le))throw TypeError(le+" is not a symbol");if(h(be,le))return be[le]},useSetter:function(){ie=!0},useSimple:function(){ie=!1}}),o({target:"Object",stat:!0,forced:!d,sham:!p},{create:function(le,ve){return ve===void 0?_(le):Z(_(le),ve)},defineProperty:G,defineProperties:Z,getOwnPropertyDescriptor:re}),o({target:"Object",stat:!0,forced:!d},{getOwnPropertyNames:ne,getOwnPropertySymbols:ue}),o({target:"Object",stat:!0,forced:y(function(){P.f(1)})},{getOwnPropertySymbols:function(le){return P.f(v(le))}}),z&&o({target:"JSON",stat:!0,forced:!d||y(function(){var le=B();return z([le])!="[null]"||z({a:le})!="{}"||z(Object(le))!="{}"})},{stringify:function(le,ve,Se){for(var Oe,xe=[le],Ce=1;arguments.length>Ce;)xe.push(arguments[Ce++]);if(Oe=ve,(f(ve)||le!==void 0)&&!oe(le))return u(ve)||(ve=function(Le,Ve){if(typeof Oe=="function"&&(Ve=Oe.call(this,Le,Ve)),!oe(Ve))return Ve}),xe[1]=ve,z.apply(null,xe)}}),B.prototype[Y]||T(B.prototype,Y,B.prototype.valueOf),F(B,"Symbol"),k[U]=!0},{"../internals/an-object":223,"../internals/array-iteration":225,"../internals/create-non-enumerable-property":236,"../internals/create-property-descriptor":237,"../internals/define-well-known-symbol":239,"../internals/descriptors":240,"../internals/export":246,"../internals/fails":247,"../internals/get-built-in":249,"../internals/global":251,"../internals/has":252,"../internals/hidden-keys":253,"../internals/internal-state":259,"../internals/is-array":261,"../internals/is-object":263,"../internals/is-pure":264,"../internals/native-symbol":271,"../internals/object-create":276,"../internals/object-define-property":278,"../internals/object-get-own-property-descriptor":279,"../internals/object-get-own-property-names":281,"../internals/object-get-own-property-names-external":280,"../internals/object-get-own-property-symbols":282,"../internals/object-keys":285,"../internals/object-property-is-enumerable":286,"../internals/redefine":294,"../internals/set-to-string-tag":298,"../internals/shared":301,"../internals/shared-key":299,"../internals/to-indexed-object":305,"../internals/to-object":308,"../internals/to-primitive":309,"../internals/uid":311,"../internals/use-symbol-as-uid":312,"../internals/well-known-symbol":314,"../internals/well-known-symbol-wrapped":313}],328:[function(e,n,i){(function(o){function a(l){return(a=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(p){return typeof p}:function(p){return p&&typeof Symbol=="function"&&p.constructor===Symbol&&p!==Symbol.prototype?"symbol":typeof p})(l)}function s(l){return Object.prototype.toString.call(l)}i.isArray=function(l){return Array.isArray?Array.isArray(l):s(l)==="[object Array]"},i.isBoolean=function(l){return typeof l=="boolean"},i.isNull=function(l){return l===null},i.isNullOrUndefined=function(l){return l==null},i.isNumber=function(l){return typeof l=="number"},i.isString=function(l){return typeof l=="string"},i.isSymbol=function(l){return a(l)==="symbol"},i.isUndefined=function(l){return l===void 0},i.isRegExp=function(l){return s(l)==="[object RegExp]"},i.isObject=function(l){return a(l)==="object"&&l!==null},i.isDate=function(l){return s(l)==="[object Date]"},i.isError=function(l){return s(l)==="[object Error]"||l instanceof Error},i.isFunction=function(l){return typeof l=="function"},i.isPrimitive=function(l){return l===null||typeof l=="boolean"||typeof l=="number"||typeof l=="string"||a(l)==="symbol"||l===void 0},i.isBuffer=o.isBuffer}).call(this,{isBuffer:e("../../is-buffer/index.js")})},{"../../is-buffer/index.js":388}],329:[function(e,n,i){(function(o){var a=e("elliptic"),s=e("bn.js");n.exports=function(g){return new p(g)};var l={secp256k1:{name:"secp256k1",byteLength:32},secp224r1:{name:"p224",byteLength:28},prime256v1:{name:"p256",byteLength:32},prime192v1:{name:"p192",byteLength:24},ed25519:{name:"ed25519",byteLength:32},secp384r1:{name:"p384",byteLength:48},secp521r1:{name:"p521",byteLength:66}};function p(g){this.curveType=l[g],this.curveType||(this.curveType={name:g}),this.curve=new a.ec(this.curveType.name),this.keys=void 0}function d(g,y,h){Array.isArray(g)||(g=g.toArray());var u=new o(g);if(h&&u.length<h){var f=new o(h-u.length);f.fill(0),u=o.concat([f,u])}return y?u.toString(y):u}l.p224=l.secp224r1,l.p256=l.secp256r1=l.prime256v1,l.p192=l.secp192r1=l.prime192v1,l.p384=l.secp384r1,l.p521=l.secp521r1,p.prototype.generateKeys=function(g,y){return this.keys=this.curve.genKeyPair(),this.getPublicKey(g,y)},p.prototype.computeSecret=function(g,y,h){return y=y||"utf8",o.isBuffer(g)||(g=new o(g,y)),d(this.curve.keyFromPublic(g).getPublic().mul(this.keys.getPrivate()).getX(),h,this.curveType.byteLength)},p.prototype.getPublicKey=function(g,y){var h=this.keys.getPublic(y==="compressed",!0);return y==="hybrid"&&(h[h.length-1]%2?h[0]=7:h[0]=6),d(h,g)},p.prototype.getPrivateKey=function(g){return d(this.keys.getPrivate(),g)},p.prototype.setPublicKey=function(g,y){return y=y||"utf8",o.isBuffer(g)||(g=new o(g,y)),this.keys._importPublic(g),this},p.prototype.setPrivateKey=function(g,y){y=y||"utf8",o.isBuffer(g)||(g=new o(g,y));var h=new s(g);return h=h.toString(16),this.keys=this.curve.genKeyPair(),this.keys._importPrivate(h),this}}).call(this,e("buffer").Buffer)},{"bn.js":330,buffer:216,elliptic:350}],330:[function(e,n,i){arguments[4][181][0].apply(i,arguments)},{buffer:185,dup:181}],331:[function(e,n,i){var o=e("inherits"),a=e("md5.js"),s=e("ripemd160"),l=e("sha.js"),p=e("cipher-base");function d(g){p.call(this,"digest"),this._hash=g}o(d,p),d.prototype._update=function(g){this._hash.update(g)},d.prototype._final=function(){return this._hash.digest()},n.exports=function(g){return(g=g.toLowerCase())==="md5"?new a:g==="rmd160"||g==="ripemd160"?new s:new d(l(g))}},{"cipher-base":218,inherits:387,"md5.js":434,ripemd160:493,"sha.js":499}],332:[function(e,n,i){var o=e("md5.js");n.exports=function(a){return new o().update(a).digest()}},{"md5.js":434}],333:[function(e,n,i){var o=e("inherits"),a=e("./legacy"),s=e("cipher-base"),l=e("safe-buffer").Buffer,p=e("create-hash/md5"),d=e("ripemd160"),g=e("sha.js"),y=l.alloc(128);function h(u,f){s.call(this,"digest"),typeof f=="string"&&(f=l.from(f));var c=u==="sha512"||u==="sha384"?128:64;this._alg=u,this._key=f,f.length>c?f=(u==="rmd160"?new d:g(u)).update(f).digest():f.length<c&&(f=l.concat([f,y],c));for(var v=this._ipad=l.allocUnsafe(c),m=this._opad=l.allocUnsafe(c),b=0;b<c;b++)v[b]=54^f[b],m[b]=92^f[b];this._hash=u==="rmd160"?new d:g(u),this._hash.update(v)}o(h,s),h.prototype._update=function(u){this._hash.update(u)},h.prototype._final=function(){var u=this._hash.digest();return(this._alg==="rmd160"?new d:g(this._alg)).update(this._opad).update(u).digest()},n.exports=function(u,f){return(u=u.toLowerCase())==="rmd160"||u==="ripemd160"?new h("rmd160",f):u==="md5"?new a(p,f):new h(u,f)}},{"./legacy":334,"cipher-base":218,"create-hash/md5":332,inherits:387,ripemd160:493,"safe-buffer":494,"sha.js":499}],334:[function(e,n,i){var o=e("inherits"),a=e("safe-buffer").Buffer,s=e("cipher-base"),l=a.alloc(128);function p(d,g){s.call(this,"digest"),typeof g=="string"&&(g=a.from(g)),this._alg=d,this._key=g,g.length>64?g=d(g):g.length<64&&(g=a.concat([g,l],64));for(var y=this._ipad=a.allocUnsafe(64),h=this._opad=a.allocUnsafe(64),u=0;u<64;u++)y[u]=54^g[u],h[u]=92^g[u];this._hash=[y]}o(p,s),p.prototype._update=function(d){this._hash.push(d)},p.prototype._final=function(){var d=this._alg(a.concat(this._hash));return this._alg(a.concat([this._opad,d]))},n.exports=p},{"cipher-base":218,inherits:387,"safe-buffer":494}],335:[function(e,n,i){i.randomBytes=i.rng=i.pseudoRandomBytes=i.prng=e("randombytes"),i.createHash=i.Hash=e("create-hash"),i.createHmac=i.Hmac=e("create-hmac");var o=e("browserify-sign/algos"),a=Object.keys(o),s=["sha1","sha224","sha256","sha384","sha512","md5","rmd160"].concat(a);i.getHashes=function(){return s};var l=e("pbkdf2");i.pbkdf2=l.pbkdf2,i.pbkdf2Sync=l.pbkdf2Sync;var p=e("browserify-cipher");i.Cipher=p.Cipher,i.createCipher=p.createCipher,i.Cipheriv=p.Cipheriv,i.createCipheriv=p.createCipheriv,i.Decipher=p.Decipher,i.createDecipher=p.createDecipher,i.Decipheriv=p.Decipheriv,i.createDecipheriv=p.createDecipheriv,i.getCiphers=p.getCiphers,i.listCiphers=p.listCiphers;var d=e("diffie-hellman");i.DiffieHellmanGroup=d.DiffieHellmanGroup,i.createDiffieHellmanGroup=d.createDiffieHellmanGroup,i.getDiffieHellman=d.getDiffieHellman,i.createDiffieHellman=d.createDiffieHellman,i.DiffieHellman=d.DiffieHellman;var g=e("browserify-sign");i.createSign=g.createSign,i.Sign=g.Sign,i.createVerify=g.createVerify,i.Verify=g.Verify,i.createECDH=e("create-ecdh");var y=e("public-encrypt");i.publicEncrypt=y.publicEncrypt,i.privateEncrypt=y.privateEncrypt,i.publicDecrypt=y.publicDecrypt,i.privateDecrypt=y.privateDecrypt;var h=e("randomfill");i.randomFill=h.randomFill,i.randomFillSync=h.randomFillSync,i.createCredentials=function(){throw new Error(["sorry, createCredentials is not implemented yet","we accept pull requests","https://github.com/crypto-browserify/crypto-browserify"].join(`
`))},i.constants={DH_CHECK_P_NOT_SAFE_PRIME:2,DH_CHECK_P_NOT_PRIME:1,DH_UNABLE_TO_CHECK_GENERATOR:4,DH_NOT_SUITABLE_GENERATOR:8,NPN_ENABLED:1,ALPN_ENABLED:1,RSA_PKCS1_PADDING:1,RSA_SSLV23_PADDING:2,RSA_NO_PADDING:3,RSA_PKCS1_OAEP_PADDING:4,RSA_X931_PADDING:5,RSA_PKCS1_PSS_PADDING:6,POINT_CONVERSION_COMPRESSED:2,POINT_CONVERSION_UNCOMPRESSED:4,POINT_CONVERSION_HYBRID:6}},{"browserify-cipher":203,"browserify-sign":211,"browserify-sign/algos":208,"create-ecdh":329,"create-hash":331,"create-hmac":333,"diffie-hellman":345,pbkdf2:460,"public-encrypt":468,randombytes:475,randomfill:476}],336:[function(e,n,i){function o(a){return(o=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(s){return typeof s}:function(s){return s&&typeof Symbol=="function"&&s.constructor===Symbol&&s!==Symbol.prototype?"symbol":typeof s})(a)}(function(a,s){(i===void 0?"undefined":o(i))=="object"&&n!==void 0?n.exports=s():(void 0).dayjs=s()})(0,function(){var a="millisecond",s="second",l="minute",p="hour",d="day",g="week",y="month",h="quarter",u="year",f="date",c=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[^0-9]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?.?(\d+)?$/,v=/\[([^\]]+)]|Y{2,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,m=function(T,M,S){var E=String(T);return!E||E.length>=M?T:""+Array(M+1-E.length).join(S)+T},b={s:m,z:function(T){var M=-T.utcOffset(),S=Math.abs(M),E=Math.floor(S/60),k=S%60;return(M<=0?"+":"-")+m(E,2,"0")+":"+m(k,2,"0")},m:function T(M,S){if(M.date()<S.date())return-T(S,M);var E=12*(S.year()-M.year())+(S.month()-M.month()),k=M.add(E,y),O=S-k<0,x=M.add(E+(O?-1:1),y);return+(-(E+(S-k)/(O?k-x:x-k))||0)},a:function(T){return T<0?Math.ceil(T)||0:Math.floor(T)},p:function(T){return{M:y,y:u,w:g,d,D:f,h:p,m:l,s,ms:a,Q:h}[T]||String(T||"").toLowerCase().replace(/s$/,"")},u:function(T){return T===void 0}},w={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_")},_="en",C={};C[_]=w;var R=function(T){return T instanceof A},I=function(T,M,S){var E;if(!T)return _;if(typeof T=="string")C[T]&&(E=T),M&&(C[T]=M,E=T);else{var k=T.name;C[k]=T,E=k}return!S&&E&&(_=E),E||!S&&_},P=function(T,M){if(R(T))return T.clone();var S=o(M)=="object"?M:{};return S.date=T,S.args=arguments,new A(S)},N=b;N.l=I,N.i=R,N.w=function(T,M){return P(T,{locale:M.$L,utc:M.$u,$offset:M.$offset})};var A=function(){function T(S){this.$L=this.$L||I(S.locale,null,!0),this.parse(S)}var M=T.prototype;return M.parse=function(S){this.$d=function(E){var k=E.date,O=E.utc;if(k===null)return new Date(NaN);if(N.u(k))return new Date;if(k instanceof Date)return new Date(k);if(typeof k=="string"&&!/Z$/i.test(k)){var x=k.match(c);if(x){var j=x[2]-1||0,H=(x[7]||"0").substring(0,3);return O?new Date(Date.UTC(x[1],j,x[3]||1,x[4]||0,x[5]||0,x[6]||0,H)):new Date(x[1],j,x[3]||1,x[4]||0,x[5]||0,x[6]||0,H)}}return new Date(k)}(S),this.init()},M.init=function(){var S=this.$d;this.$y=S.getFullYear(),this.$M=S.getMonth(),this.$D=S.getDate(),this.$W=S.getDay(),this.$H=S.getHours(),this.$m=S.getMinutes(),this.$s=S.getSeconds(),this.$ms=S.getMilliseconds()},M.$utils=function(){return N},M.isValid=function(){return this.$d.toString()!=="Invalid Date"},M.isSame=function(S,E){var k=P(S);return this.startOf(E)<=k&&k<=this.endOf(E)},M.isAfter=function(S,E){return P(S)<this.startOf(E)},M.isBefore=function(S,E){return this.endOf(E)<P(S)},M.$g=function(S,E,k){return N.u(S)?this[E]:this.set(k,S)},M.unix=function(){return Math.floor(this.valueOf()/1e3)},M.valueOf=function(){return this.$d.getTime()},M.startOf=function(S,E){var k=this,O=!!N.u(E)||E,x=N.p(S),j=function(D,L){var B=N.w(k.$u?Date.UTC(k.$y,L,D):new Date(k.$y,L,D),k);return O?B:B.endOf(d)},H=function(D,L){return N.w(k.toDate()[D].apply(k.toDate("s"),(O?[0,0,0,0]:[23,59,59,999]).slice(L)),k)},F=this.$W,V=this.$M,W=this.$D,U="set"+(this.$u?"UTC":"");switch(x){case u:return O?j(1,0):j(31,11);case y:return O?j(1,V):j(0,V+1);case g:var Y=this.$locale().weekStart||0,K=(F<Y?F+7:F)-Y;return j(O?W-K:W+(6-K),V);case d:case f:return H(U+"Hours",0);case p:return H(U+"Minutes",1);case l:return H(U+"Seconds",2);case s:return H(U+"Milliseconds",3);default:return this.clone()}},M.endOf=function(S){return this.startOf(S,!1)},M.$set=function(S,E){var k,O=N.p(S),x="set"+(this.$u?"UTC":""),j=(k={},k[d]=x+"Date",k[f]=x+"Date",k[y]=x+"Month",k[u]=x+"FullYear",k[p]=x+"Hours",k[l]=x+"Minutes",k[s]=x+"Seconds",k[a]=x+"Milliseconds",k)[O],H=O===d?this.$D+(E-this.$W):E;if(O===y||O===u){var F=this.clone().set(f,1);F.$d[j](H),F.init(),this.$d=F.set(f,Math.min(this.$D,F.daysInMonth())).$d}else j&&this.$d[j](H);return this.init(),this},M.set=function(S,E){return this.clone().$set(S,E)},M.get=function(S){return this[N.p(S)]()},M.add=function(S,E){var k,O=this;S=Number(S);var x=N.p(E),j=function(V){var W=P(O);return N.w(W.date(W.date()+Math.round(V*S)),O)};if(x===y)return this.set(y,this.$M+S);if(x===u)return this.set(u,this.$y+S);if(x===d)return j(1);if(x===g)return j(7);var H=(k={},k[l]=6e4,k[p]=36e5,k[s]=1e3,k)[x]||1,F=this.$d.getTime()+S*H;return N.w(F,this)},M.subtract=function(S,E){return this.add(-1*S,E)},M.format=function(S){var E=this;if(!this.isValid())return"Invalid Date";var k=S||"YYYY-MM-DDTHH:mm:ssZ",O=N.z(this),x=this.$locale(),j=this.$H,H=this.$m,F=this.$M,V=x.weekdays,W=x.months,U=function(L,B,z,q){return L&&(L[B]||L(E,k))||z[B].substr(0,q)},Y=function(L){return N.s(j%12||12,L,"0")},K=x.meridiem||function(L,B,z){var q=L<12?"AM":"PM";return z?q.toLowerCase():q},D={YY:String(this.$y).slice(-2),YYYY:this.$y,M:F+1,MM:N.s(F+1,2,"0"),MMM:U(x.monthsShort,F,W,3),MMMM:U(W,F),D:this.$D,DD:N.s(this.$D,2,"0"),d:String(this.$W),dd:U(x.weekdaysMin,this.$W,V,2),ddd:U(x.weekdaysShort,this.$W,V,3),dddd:V[this.$W],H:String(j),HH:N.s(j,2,"0"),h:Y(1),hh:Y(2),a:K(j,H,!0),A:K(j,H,!1),m:String(H),mm:N.s(H,2,"0"),s:String(this.$s),ss:N.s(this.$s,2,"0"),SSS:N.s(this.$ms,3,"0"),Z:O};return k.replace(v,function(L,B){return B||D[L]||O.replace(":","")})},M.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},M.diff=function(S,E,k){var O,x=N.p(E),j=P(S),H=6e4*(j.utcOffset()-this.utcOffset()),F=this-j,V=N.m(this,j);return V=(O={},O[u]=V/12,O[y]=V,O[h]=V/3,O[g]=(F-H)/6048e5,O[d]=(F-H)/864e5,O[p]=F/36e5,O[l]=F/6e4,O[s]=F/1e3,O)[x]||F,k?V:N.a(V)},M.daysInMonth=function(){return this.endOf(y).$D},M.$locale=function(){return C[this.$L]},M.locale=function(S,E){if(!S)return this.$L;var k=this.clone(),O=I(S,E,!0);return O&&(k.$L=O),k},M.clone=function(){return N.w(this.$d,this)},M.toDate=function(){return new Date(this.valueOf())},M.toJSON=function(){return this.isValid()?this.toISOString():null},M.toISOString=function(){return this.$d.toISOString()},M.toString=function(){return this.$d.toUTCString()},T}(),$=A.prototype;return P.prototype=$,[["$ms",a],["$s",s],["$m",l],["$H",p],["$W",d],["$M",y],["$y",u],["$D",f]].forEach(function(T){$[T[1]]=function(M){return this.$g(M,T[0],T[1])}}),P.extend=function(T,M){return T(M,A,P),P},P.locale=I,P.isDayjs=R,P.unix=function(T){return P(1e3*T)},P.en=C[_],P.Ls=C,P})},{}],337:[function(e,n,i){function o(a){return(o=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(s){return typeof s}:function(s){return s&&typeof Symbol=="function"&&s.constructor===Symbol&&s!==Symbol.prototype?"symbol":typeof s})(a)}(function(a,s){(i===void 0?"undefined":o(i))=="object"&&n!==void 0?n.exports=s():(void 0).dayjs_plugin_customParseFormat=s()})(0,function(){var a,s=/(\[[^[]*\])|([-:/.()\s]+)|(A|a|YYYY|YY?|MM?M?M?|Do|DD?|hh?|HH?|mm?|ss?|S{1,3}|z|ZZ?)/g,l=/\d\d/,p=/\d\d?/,d=/\d*[^\s\d-:/()]+/,g=function(c){return function(v){this[c]=+v}},y=[/[+-]\d\d:?\d\d/,function(c){var v,m;(this.zone||(this.zone={})).offset=(m=60*(v=c.match(/([+-]|\d\d)/g))[1]+ +v[2])==0?0:v[0]==="+"?-m:m}],h=function(c){var v=a[c];return v&&(v.indexOf?v:v.s.concat(v.f))},u={A:[/[AP]M/,function(c){this.afternoon=c==="PM"}],a:[/[ap]m/,function(c){this.afternoon=c==="pm"}],S:[/\d/,function(c){this.milliseconds=100*+c}],SS:[l,function(c){this.milliseconds=10*+c}],SSS:[/\d{3}/,function(c){this.milliseconds=+c}],s:[p,g("seconds")],ss:[p,g("seconds")],m:[p,g("minutes")],mm:[p,g("minutes")],H:[p,g("hours")],h:[p,g("hours")],HH:[p,g("hours")],hh:[p,g("hours")],D:[p,g("day")],DD:[l,g("day")],Do:[d,function(c){var v=a.ordinal,m=c.match(/\d+/);if(this.day=m[0],v)for(var b=1;b<=31;b+=1)v(b).replace(/\[|\]/g,"")===c&&(this.day=b)}],M:[p,g("month")],MM:[l,g("month")],MMM:[d,function(c){var v=h("months"),m=(h("monthsShort")||v.map(function(b){return b.substr(0,3)})).indexOf(c)+1;if(m<1)throw new Error;this.month=m%12||m}],MMMM:[d,function(c){var v=h("months").indexOf(c)+1;if(v<1)throw new Error;this.month=v%12||v}],Y:[/[+-]?\d+/,g("year")],YY:[l,function(c){c=+c,this.year=c+(c>68?1900:2e3)}],YYYY:[/\d{4}/,g("year")],Z:y,ZZ:y},f=function(c,v,m){try{var b=function(j){for(var H=j.match(s),F=H.length,V=0;V<F;V+=1){var W=H[V],U=u[W],Y=U&&U[0],K=U&&U[1];H[V]=K?{regex:Y,parser:K}:W.replace(/^\[|\]$/g,"")}return function(D){for(var L={},B=0,z=0;B<F;B+=1){var q=H[B];if(typeof q=="string")z+=q.length;else{var X=q.regex,ee=q.parser,ye=D.substr(z),de=X.exec(ye)[0];ee.call(L,de),D=D.replace(de,"")}}return function(ge){var we=ge.afternoon;if(we!==void 0){var be=ge.hours;we?be<12&&(ge.hours+=12):be===12&&(ge.hours=0),delete ge.afternoon}}(L),L}}(v)(c),w=b.year,_=b.month,C=b.day,R=b.hours,I=b.minutes,P=b.seconds,N=b.milliseconds,A=b.zone,$=new Date,T=C||(w||_?1:$.getDate()),M=w||$.getFullYear(),S=0;w&&!_||(S=_>0?_-1:$.getMonth());var E=R||0,k=I||0,O=P||0,x=N||0;return A?new Date(Date.UTC(M,S,T,E,k,O,x+60*A.offset*1e3)):m?new Date(Date.UTC(M,S,T,E,k,O,x)):new Date(M,S,T,E,k,O,x)}catch{return new Date("")}};return function(c,v,m){var b=v.prototype,w=b.parse;b.parse=function(_){var C=_.date,R=_.utc,I=_.args;this.$u=R;var P=I[1];if(typeof P=="string"){var N=I[2]===!0,A=I[3]===!0,$=N||A,T=I[2];A&&(T=I[2]),N||(a=T?m.Ls[T]:this.$locale()),this.$d=f(C,P,R),this.init(),T&&T!==!0&&(this.$L=this.locale(T).$L),$&&C!==this.format(P)&&(this.$d=new Date(""))}else if(P instanceof Array)for(var M=P.length,S=1;S<=M;S+=1){I[1]=P[S-1];var E=m.apply(this,I);if(E.isValid()){this.$d=E.$d,this.$L=E.$L,this.init();break}S===M&&(this.$d=new Date(""))}else w.call(this,_)}}})},{}],338:[function(e,n,i){function o(s){return(o=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(l){return typeof l}:function(l){return l&&typeof Symbol=="function"&&l.constructor===Symbol&&l!==Symbol.prototype?"symbol":typeof l})(s)}var a;a=function(){return function(s,l,p){var d=new Date().getTimezoneOffset(),g=l.prototype;p.utc=function(m){return new l({date:m,utc:!0,args:arguments})},g.utc=function(){return p(this.toDate(),{locale:this.$L,utc:!0})},g.local=function(){return p(this.toDate(),{locale:this.$L,utc:!1})};var y=g.parse;g.parse=function(m){m.utc&&(this.$u=!0),this.$utils().u(m.$offset)||(this.$offset=m.$offset),y.call(this,m)};var h=g.init;g.init=function(){if(this.$u){var m=this.$d;this.$y=m.getUTCFullYear(),this.$M=m.getUTCMonth(),this.$D=m.getUTCDate(),this.$W=m.getUTCDay(),this.$H=m.getUTCHours(),this.$m=m.getUTCMinutes(),this.$s=m.getUTCSeconds(),this.$ms=m.getUTCMilliseconds()}else h.call(this)};var u=g.utcOffset;g.utcOffset=function(m,b){var w=this.$utils().u;if(w(m))return this.$u?0:w(this.$offset)?u.call(this):this.$offset;var _=Math.abs(m)<=16?60*m:m,C=this;return b?(C.$offset=_,C.$u=m===0,C):(m!==0?(C=this.local().add(_+d,"minute")).$offset=_:C=this.utc(),C)};var f=g.format;g.format=function(m){var b=m||(this.$u?"YYYY-MM-DDTHH:mm:ss[Z]":"");return f.call(this,b)},g.valueOf=function(){var m=this.$utils().u(this.$offset)?0:this.$offset+d;return this.$d.valueOf()-6e4*m},g.isUTC=function(){return!!this.$u},g.toISOString=function(){return this.toDate().toISOString()},g.toString=function(){return this.toDate().toUTCString()};var c=g.toDate;g.toDate=function(m){return m==="s"&&this.$offset?p(this.format("YYYY-MM-DD HH:mm:ss:SSS")).toDate():c.call(this)};var v=g.diff;g.diff=function(m,b,w){var _=this.local(),C=p(m).local();return v.call(_,C,b,w)}}},(i===void 0?"undefined":o(i))=="object"&&n!==void 0?n.exports=a():(void 0).dayjs_plugin_utc=a()},{}],339:[function(e,n,i){i.utils=e("./des/utils"),i.Cipher=e("./des/cipher"),i.DES=e("./des/des"),i.CBC=e("./des/cbc"),i.EDE=e("./des/ede")},{"./des/cbc":340,"./des/cipher":341,"./des/des":342,"./des/ede":343,"./des/utils":344}],340:[function(e,n,i){var o=e("minimalistic-assert"),a=e("inherits"),s={};function l(p){o.equal(p.length,8,"Invalid IV length"),this.iv=new Array(8);for(var d=0;d<this.iv.length;d++)this.iv[d]=p[d]}i.instantiate=function(p){function d(u){p.call(this,u),this._cbcInit()}a(d,p);for(var g=Object.keys(s),y=0;y<g.length;y++){var h=g[y];d.prototype[h]=s[h]}return d.create=function(u){return new d(u)},d},s._cbcInit=function(){var p=new l(this.options.iv);this._cbcState=p},s._update=function(p,d,g,y){var h=this._cbcState,u=this.constructor.super_.prototype,f=h.iv;if(this.type==="encrypt"){for(var c=0;c<this.blockSize;c++)f[c]^=p[d+c];for(u._update.call(this,f,0,g,y),c=0;c<this.blockSize;c++)f[c]=g[y+c]}else{for(u._update.call(this,p,d,g,y),c=0;c<this.blockSize;c++)g[y+c]^=f[c];for(c=0;c<this.blockSize;c++)f[c]=p[d+c]}}},{inherits:387,"minimalistic-assert":437}],341:[function(e,n,i){var o=e("minimalistic-assert");function a(s){this.options=s,this.type=this.options.type,this.blockSize=8,this._init(),this.buffer=new Array(this.blockSize),this.bufferOff=0}n.exports=a,a.prototype._init=function(){},a.prototype.update=function(s){return s.length===0?[]:this.type==="decrypt"?this._updateDecrypt(s):this._updateEncrypt(s)},a.prototype._buffer=function(s,l){for(var p=Math.min(this.buffer.length-this.bufferOff,s.length-l),d=0;d<p;d++)this.buffer[this.bufferOff+d]=s[l+d];return this.bufferOff+=p,p},a.prototype._flushBuffer=function(s,l){return this._update(this.buffer,0,s,l),this.bufferOff=0,this.blockSize},a.prototype._updateEncrypt=function(s){var l=0,p=0,d=(this.bufferOff+s.length)/this.blockSize|0,g=new Array(d*this.blockSize);this.bufferOff!==0&&(l+=this._buffer(s,l),this.bufferOff===this.buffer.length&&(p+=this._flushBuffer(g,p)));for(var y=s.length-(s.length-l)%this.blockSize;l<y;l+=this.blockSize)this._update(s,l,g,p),p+=this.blockSize;for(;l<s.length;l++,this.bufferOff++)this.buffer[this.bufferOff]=s[l];return g},a.prototype._updateDecrypt=function(s){for(var l=0,p=0,d=Math.ceil((this.bufferOff+s.length)/this.blockSize)-1,g=new Array(d*this.blockSize);d>0;d--)l+=this._buffer(s,l),p+=this._flushBuffer(g,p);return l+=this._buffer(s,l),g},a.prototype.final=function(s){var l,p;return s&&(l=this.update(s)),p=this.type==="encrypt"?this._finalEncrypt():this._finalDecrypt(),l?l.concat(p):p},a.prototype._pad=function(s,l){if(l===0)return!1;for(;l<s.length;)s[l++]=0;return!0},a.prototype._finalEncrypt=function(){if(!this._pad(this.buffer,this.bufferOff))return[];var s=new Array(this.blockSize);return this._update(this.buffer,0,s,0),s},a.prototype._unpad=function(s){return s},a.prototype._finalDecrypt=function(){o.equal(this.bufferOff,this.blockSize,"Not enough data to decrypt");var s=new Array(this.blockSize);return this._flushBuffer(s,0),this._unpad(s)}},{"minimalistic-assert":437}],342:[function(e,n,i){var o=e("minimalistic-assert"),a=e("inherits"),s=e("./utils"),l=e("./cipher");function p(){this.tmp=new Array(2),this.keys=null}function d(y){l.call(this,y);var h=new p;this._desState=h,this.deriveKeys(h,y.key)}a(d,l),n.exports=d,d.create=function(y){return new d(y)};var g=[1,1,2,2,2,2,2,2,1,2,2,2,2,2,2,1];d.prototype.deriveKeys=function(y,h){y.keys=new Array(32),o.equal(h.length,this.blockSize,"Invalid key length");var u=s.readUInt32BE(h,0),f=s.readUInt32BE(h,4);s.pc1(u,f,y.tmp,0),u=y.tmp[0],f=y.tmp[1];for(var c=0;c<y.keys.length;c+=2){var v=g[c>>>1];u=s.r28shl(u,v),f=s.r28shl(f,v),s.pc2(u,f,y.keys,c)}},d.prototype._update=function(y,h,u,f){var c=this._desState,v=s.readUInt32BE(y,h),m=s.readUInt32BE(y,h+4);s.ip(v,m,c.tmp,0),v=c.tmp[0],m=c.tmp[1],this.type==="encrypt"?this._encrypt(c,v,m,c.tmp,0):this._decrypt(c,v,m,c.tmp,0),v=c.tmp[0],m=c.tmp[1],s.writeUInt32BE(u,v,f),s.writeUInt32BE(u,m,f+4)},d.prototype._pad=function(y,h){for(var u=y.length-h,f=h;f<y.length;f++)y[f]=u;return!0},d.prototype._unpad=function(y){for(var h=y[y.length-1],u=y.length-h;u<y.length;u++)o.equal(y[u],h);return y.slice(0,y.length-h)},d.prototype._encrypt=function(y,h,u,f,c){for(var v=h,m=u,b=0;b<y.keys.length;b+=2){var w=y.keys[b],_=y.keys[b+1];s.expand(m,y.tmp,0),w^=y.tmp[0],_^=y.tmp[1];var C=s.substitute(w,_),R=m;m=(v^s.permute(C))>>>0,v=R}s.rip(m,v,f,c)},d.prototype._decrypt=function(y,h,u,f,c){for(var v=u,m=h,b=y.keys.length-2;b>=0;b-=2){var w=y.keys[b],_=y.keys[b+1];s.expand(v,y.tmp,0),w^=y.tmp[0],_^=y.tmp[1];var C=s.substitute(w,_),R=v;v=(m^s.permute(C))>>>0,m=R}s.rip(v,m,f,c)}},{"./cipher":341,"./utils":344,inherits:387,"minimalistic-assert":437}],343:[function(e,n,i){var o=e("minimalistic-assert"),a=e("inherits"),s=e("./cipher"),l=e("./des");function p(g,y){o.equal(y.length,24,"Invalid key length");var h=y.slice(0,8),u=y.slice(8,16),f=y.slice(16,24);this.ciphers=g==="encrypt"?[l.create({type:"encrypt",key:h}),l.create({type:"decrypt",key:u}),l.create({type:"encrypt",key:f})]:[l.create({type:"decrypt",key:f}),l.create({type:"encrypt",key:u}),l.create({type:"decrypt",key:h})]}function d(g){s.call(this,g);var y=new p(this.type,this.options.key);this._edeState=y}a(d,s),n.exports=d,d.create=function(g){return new d(g)},d.prototype._update=function(g,y,h,u){var f=this._edeState;f.ciphers[0]._update(g,y,h,u),f.ciphers[1]._update(h,u,h,u),f.ciphers[2]._update(h,u,h,u)},d.prototype._pad=l.prototype._pad,d.prototype._unpad=l.prototype._unpad},{"./cipher":341,"./des":342,inherits:387,"minimalistic-assert":437}],344:[function(e,n,i){i.readUInt32BE=function(l,p){return(l[0+p]<<24|l[1+p]<<16|l[2+p]<<8|l[3+p])>>>0},i.writeUInt32BE=function(l,p,d){l[0+d]=p>>>24,l[1+d]=p>>>16&255,l[2+d]=p>>>8&255,l[3+d]=255&p},i.ip=function(l,p,d,g){for(var y=0,h=0,u=6;u>=0;u-=2){for(var f=0;f<=24;f+=8)y<<=1,y|=p>>>f+u&1;for(f=0;f<=24;f+=8)y<<=1,y|=l>>>f+u&1}for(u=6;u>=0;u-=2){for(f=1;f<=25;f+=8)h<<=1,h|=p>>>f+u&1;for(f=1;f<=25;f+=8)h<<=1,h|=l>>>f+u&1}d[g+0]=y>>>0,d[g+1]=h>>>0},i.rip=function(l,p,d,g){for(var y=0,h=0,u=0;u<4;u++)for(var f=24;f>=0;f-=8)y<<=1,y|=p>>>f+u&1,y<<=1,y|=l>>>f+u&1;for(u=4;u<8;u++)for(f=24;f>=0;f-=8)h<<=1,h|=p>>>f+u&1,h<<=1,h|=l>>>f+u&1;d[g+0]=y>>>0,d[g+1]=h>>>0},i.pc1=function(l,p,d,g){for(var y=0,h=0,u=7;u>=5;u--){for(var f=0;f<=24;f+=8)y<<=1,y|=p>>f+u&1;for(f=0;f<=24;f+=8)y<<=1,y|=l>>f+u&1}for(f=0;f<=24;f+=8)y<<=1,y|=p>>f+u&1;for(u=1;u<=3;u++){for(f=0;f<=24;f+=8)h<<=1,h|=p>>f+u&1;for(f=0;f<=24;f+=8)h<<=1,h|=l>>f+u&1}for(f=0;f<=24;f+=8)h<<=1,h|=l>>f+u&1;d[g+0]=y>>>0,d[g+1]=h>>>0},i.r28shl=function(l,p){return l<<p&268435455|l>>>28-p};var o=[14,11,17,4,27,23,25,0,13,22,7,18,5,9,16,24,2,20,12,21,1,8,15,26,15,4,25,19,9,1,26,16,5,11,23,8,12,7,17,0,22,3,10,14,6,20,27,24];i.pc2=function(l,p,d,g){for(var y=0,h=0,u=o.length>>>1,f=0;f<u;f++)y<<=1,y|=l>>>o[f]&1;for(f=u;f<o.length;f++)h<<=1,h|=p>>>o[f]&1;d[g+0]=y>>>0,d[g+1]=h>>>0},i.expand=function(l,p,d){var g=0,y=0;g=(1&l)<<5|l>>>27;for(var h=23;h>=15;h-=4)g<<=6,g|=l>>>h&63;for(h=11;h>=3;h-=4)y|=l>>>h&63,y<<=6;y|=(31&l)<<1|l>>>31,p[d+0]=g>>>0,p[d+1]=y>>>0};var a=[14,0,4,15,13,7,1,4,2,14,15,2,11,13,8,1,3,10,10,6,6,12,12,11,5,9,9,5,0,3,7,8,4,15,1,12,14,8,8,2,13,4,6,9,2,1,11,7,15,5,12,11,9,3,7,14,3,10,10,0,5,6,0,13,15,3,1,13,8,4,14,7,6,15,11,2,3,8,4,14,9,12,7,0,2,1,13,10,12,6,0,9,5,11,10,5,0,13,14,8,7,10,11,1,10,3,4,15,13,4,1,2,5,11,8,6,12,7,6,12,9,0,3,5,2,14,15,9,10,13,0,7,9,0,14,9,6,3,3,4,15,6,5,10,1,2,13,8,12,5,7,14,11,12,4,11,2,15,8,1,13,1,6,10,4,13,9,0,8,6,15,9,3,8,0,7,11,4,1,15,2,14,12,3,5,11,10,5,14,2,7,12,7,13,13,8,14,11,3,5,0,6,6,15,9,0,10,3,1,4,2,7,8,2,5,12,11,1,12,10,4,14,15,9,10,3,6,15,9,0,0,6,12,10,11,1,7,13,13,8,15,9,1,4,3,5,14,11,5,12,2,7,8,2,4,14,2,14,12,11,4,2,1,12,7,4,10,7,11,13,6,1,8,5,5,0,3,15,15,10,13,3,0,9,14,8,9,6,4,11,2,8,1,12,11,7,10,1,13,14,7,2,8,13,15,6,9,15,12,0,5,9,6,10,3,4,0,5,14,3,12,10,1,15,10,4,15,2,9,7,2,12,6,9,8,5,0,6,13,1,3,13,4,14,14,0,7,11,5,3,11,8,9,4,14,3,15,2,5,12,2,9,8,5,12,15,3,10,7,11,0,14,4,1,10,7,1,6,13,0,11,8,6,13,4,13,11,0,2,11,14,7,15,4,0,9,8,1,13,10,3,14,12,3,9,5,7,12,5,2,10,15,6,8,1,6,1,6,4,11,11,13,13,8,12,1,3,4,7,10,14,7,10,9,15,5,6,0,8,15,0,14,5,2,9,3,2,12,13,1,2,15,8,13,4,8,6,10,15,3,11,7,1,4,10,12,9,5,3,6,14,11,5,0,0,14,12,9,7,2,7,2,11,1,4,14,1,7,9,4,12,10,14,8,2,13,0,15,6,12,10,9,13,0,15,3,3,5,5,6,8,11];i.substitute=function(l,p){for(var d=0,g=0;g<4;g++)d<<=4,d|=a[64*g+(l>>>18-6*g&63)];for(g=0;g<4;g++)d<<=4,d|=a[256+64*g+(p>>>18-6*g&63)];return d>>>0};var s=[16,25,12,11,3,20,4,15,31,17,9,6,27,14,1,22,30,24,8,18,0,5,29,23,13,19,2,26,10,21,28,7];i.permute=function(l){for(var p=0,d=0;d<s.length;d++)p<<=1,p|=l>>>s[d]&1;return p>>>0},i.padSplit=function(l,p,d){for(var g=l.toString(2);g.length<p;)g="0"+g;for(var y=[],h=0;h<p;h+=d)y.push(g.slice(h,h+d));return y.join(" ")}},{}],345:[function(e,n,i){(function(o){var a=e("./lib/generatePrime"),s=e("./lib/primes.json"),l=e("./lib/dh"),p={binary:!0,hex:!0,base64:!0};i.DiffieHellmanGroup=i.createDiffieHellmanGroup=i.getDiffieHellman=function(d){var g=new o(s[d].prime,"hex"),y=new o(s[d].gen,"hex");return new l(g,y)},i.createDiffieHellman=i.DiffieHellman=function d(g,y,h,u){return o.isBuffer(y)||p[y]===void 0?d(g,"binary",y,h):(y=y||"binary",u=u||"binary",h=h||new o([2]),o.isBuffer(h)||(h=new o(h,u)),typeof g=="number"?new l(a(g,h),h,!0):(o.isBuffer(g)||(g=new o(g,y)),new l(g,h,!0)))}}).call(this,e("buffer").Buffer)},{"./lib/dh":346,"./lib/generatePrime":347,"./lib/primes.json":348,buffer:216}],346:[function(e,n,i){(function(o){var a=e("bn.js"),s=new(e("miller-rabin")),l=new a(24),p=new a(11),d=new a(10),g=new a(3),y=new a(7),h=e("./generatePrime"),u=e("randombytes");function f(w,_){return _=_||"utf8",o.isBuffer(w)||(w=new o(w,_)),this._pub=new a(w),this}function c(w,_){return _=_||"utf8",o.isBuffer(w)||(w=new o(w,_)),this._priv=new a(w),this}n.exports=m;var v={};function m(w,_,C){this.setGenerator(_),this.__prime=new a(w),this._prime=a.mont(this.__prime),this._primeLen=w.length,this._pub=void 0,this._priv=void 0,this._primeCode=void 0,C?(this.setPublicKey=f,this.setPrivateKey=c):this._primeCode=8}function b(w,_){var C=new o(w.toArray());return _?C.toString(_):C}Object.defineProperty(m.prototype,"verifyError",{enumerable:!0,get:function(){return typeof this._primeCode!="number"&&(this._primeCode=function(w,_){var C=_.toString("hex"),R=[C,w.toString(16)].join("_");if(R in v)return v[R];var I,P=0;if(w.isEven()||!h.simpleSieve||!h.fermatTest(w)||!s.test(w))return P+=1,P+=C==="02"||C==="05"?8:4,v[R]=P,P;switch(s.test(w.shrn(1))||(P+=2),C){case"02":w.mod(l).cmp(p)&&(P+=8);break;case"05":(I=w.mod(d)).cmp(g)&&I.cmp(y)&&(P+=8);break;default:P+=4}return v[R]=P,P}(this.__prime,this.__gen)),this._primeCode}}),m.prototype.generateKeys=function(){return this._priv||(this._priv=new a(u(this._primeLen))),this._pub=this._gen.toRed(this._prime).redPow(this._priv).fromRed(),this.getPublicKey()},m.prototype.computeSecret=function(w){var _=(w=(w=new a(w)).toRed(this._prime)).redPow(this._priv).fromRed(),C=new o(_.toArray()),R=this.getPrime();if(C.length<R.length){var I=new o(R.length-C.length);I.fill(0),C=o.concat([I,C])}return C},m.prototype.getPublicKey=function(w){return b(this._pub,w)},m.prototype.getPrivateKey=function(w){return b(this._priv,w)},m.prototype.getPrime=function(w){return b(this.__prime,w)},m.prototype.getGenerator=function(w){return b(this._gen,w)},m.prototype.setGenerator=function(w,_){return _=_||"utf8",o.isBuffer(w)||(w=new o(w,_)),this.__gen=w,this._gen=new a(w),this}}).call(this,e("buffer").Buffer)},{"./generatePrime":347,"bn.js":349,buffer:216,"miller-rabin":435,randombytes:475}],347:[function(e,n,i){var o=e("randombytes");n.exports=w,w.simpleSieve=m,w.fermatTest=b;var a=e("bn.js"),s=new a(24),l=new(e("miller-rabin")),p=new a(1),d=new a(2),g=new a(5),y=(new a(16),new a(8),new a(10)),h=new a(3),u=(new a(7),new a(11)),f=new a(4),c=(new a(12),null);function v(){if(c!==null)return c;var _=[];_[0]=2;for(var C=1,R=3;R<1048576;R+=2){for(var I=Math.ceil(Math.sqrt(R)),P=0;P<C&&_[P]<=I&&R%_[P]!=0;P++);C!==P&&_[P]<=I||(_[C++]=R)}return c=_,_}function m(_){for(var C=v(),R=0;R<C.length;R++)if(_.modn(C[R])===0)return _.cmpn(C[R])===0;return!0}function b(_){var C=a.mont(_);return d.toRed(C).redPow(_.subn(1)).fromRed().cmpn(1)===0}function w(_,C){if(_<16)return new a(C===2||C===5?[140,123]:[140,39]);var R,I;for(C=new a(C);;){for(R=new a(o(Math.ceil(_/8)));R.bitLength()>_;)R.ishrn(1);if(R.isEven()&&R.iadd(p),R.testn(1)||R.iadd(d),C.cmp(d)){if(!C.cmp(g))for(;R.mod(y).cmp(h);)R.iadd(f)}else for(;R.mod(s).cmp(u);)R.iadd(f);if(m(I=R.shrn(1))&&m(R)&&b(I)&&b(R)&&l.test(I)&&l.test(R))return R}}},{"bn.js":349,"miller-rabin":435,randombytes:475}],348:[function(e,n,i){n.exports={modp1:{gen:"02",prime:"ffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b139b22514a08798e3404ddef9519b3cd3a431b302b0a6df25f14374fe1356d6d51c245e485b576625e7ec6f44c42e9a63a3620ffffffffffffffff"},modp2:{gen:"02",prime:"ffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b139b22514a08798e3404ddef9519b3cd3a431b302b0a6df25f14374fe1356d6d51c245e485b576625e7ec6f44c42e9a637ed6b0bff5cb6f406b7edee386bfb5a899fa5ae9f24117c4b1fe649286651ece65381ffffffffffffffff"},modp5:{gen:"02",prime:"ffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b139b22514a08798e3404ddef9519b3cd3a431b302b0a6df25f14374fe1356d6d51c245e485b576625e7ec6f44c42e9a637ed6b0bff5cb6f406b7edee386bfb5a899fa5ae9f24117c4b1fe649286651ece45b3dc2007cb8a163bf0598da48361c55d39a69163fa8fd24cf5f83655d23dca3ad961c62f356208552bb9ed529077096966d670c354e4abc9804f1746c08ca237327ffffffffffffffff"},modp14:{gen:"02",prime:"ffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b139b22514a08798e3404ddef9519b3cd3a431b302b0a6df25f14374fe1356d6d51c245e485b576625e7ec6f44c42e9a637ed6b0bff5cb6f406b7edee386bfb5a899fa5ae9f24117c4b1fe649286651ece45b3dc2007cb8a163bf0598da48361c55d39a69163fa8fd24cf5f83655d23dca3ad961c62f356208552bb9ed529077096966d670c354e4abc9804f1746c08ca18217c32905e462e36ce3be39e772c180e86039b2783a2ec07a28fb5c55df06f4c52c9de2bcbf6955817183995497cea956ae515d2261898fa051015728e5a8aacaa68ffffffffffffffff"},modp15:{gen:"02",prime:"ffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b139b22514a08798e3404ddef9519b3cd3a431b302b0a6df25f14374fe1356d6d51c245e485b576625e7ec6f44c42e9a637ed6b0bff5cb6f406b7edee386bfb5a899fa5ae9f24117c4b1fe649286651ece45b3dc2007cb8a163bf0598da48361c55d39a69163fa8fd24cf5f83655d23dca3ad961c62f356208552bb9ed529077096966d670c354e4abc9804f1746c08ca18217c32905e462e36ce3be39e772c180e86039b2783a2ec07a28fb5c55df06f4c52c9de2bcbf6955817183995497cea956ae515d2261898fa051015728e5a8aaac42dad33170d04507a33a85521abdf1cba64ecfb850458dbef0a8aea71575d060c7db3970f85a6e1e4c7abf5ae8cdb0933d71e8c94e04a25619dcee3d2261ad2ee6bf12ffa06d98a0864d87602733ec86a64521f2b18177b200cbbe117577a615d6c770988c0bad946e208e24fa074e5ab3143db5bfce0fd108e4b82d120a93ad2caffffffffffffffff"},modp16:{gen:"02",prime:"ffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b139b22514a08798e3404ddef9519b3cd3a431b302b0a6df25f14374fe1356d6d51c245e485b576625e7ec6f44c42e9a637ed6b0bff5cb6f406b7edee386bfb5a899fa5ae9f24117c4b1fe649286651ece45b3dc2007cb8a163bf0598da48361c55d39a69163fa8fd24cf5f83655d23dca3ad961c62f356208552bb9ed529077096966d670c354e4abc9804f1746c08ca18217c32905e462e36ce3be39e772c180e86039b2783a2ec07a28fb5c55df06f4c52c9de2bcbf6955817183995497cea956ae515d2261898fa051015728e5a8aaac42dad33170d04507a33a85521abdf1cba64ecfb850458dbef0a8aea71575d060c7db3970f85a6e1e4c7abf5ae8cdb0933d71e8c94e04a25619dcee3d2261ad2ee6bf12ffa06d98a0864d87602733ec86a64521f2b18177b200cbbe117577a615d6c770988c0bad946e208e24fa074e5ab3143db5bfce0fd108e4b82d120a92108011a723c12a787e6d788719a10bdba5b2699c327186af4e23c1a946834b6150bda2583e9ca2ad44ce8dbbbc2db04de8ef92e8efc141fbecaa6287c59474e6bc05d99b2964fa090c3a2233ba186515be7ed1f612970cee2d7afb81bdd762170481cd0069127d5b05aa993b4ea988d8fddc186ffb7dc90a6c08f4df435c934063199ffffffffffffffff"},modp17:{gen:"02",prime:"ffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b139b22514a08798e3404ddef9519b3cd3a431b302b0a6df25f14374fe1356d6d51c245e485b576625e7ec6f44c42e9a637ed6b0bff5cb6f406b7edee386bfb5a899fa5ae9f24117c4b1fe649286651ece45b3dc2007cb8a163bf0598da48361c55d39a69163fa8fd24cf5f83655d23dca3ad961c62f356208552bb9ed529077096966d670c354e4abc9804f1746c08ca18217c32905e462e36ce3be39e772c180e86039b2783a2ec07a28fb5c55df06f4c52c9de2bcbf6955817183995497cea956ae515d2261898fa051015728e5a8aaac42dad33170d04507a33a85521abdf1cba64ecfb850458dbef0a8aea71575d060c7db3970f85a6e1e4c7abf5ae8cdb0933d71e8c94e04a25619dcee3d2261ad2ee6bf12ffa06d98a0864d87602733ec86a64521f2b18177b200cbbe117577a615d6c770988c0bad946e208e24fa074e5ab3143db5bfce0fd108e4b82d120a92108011a723c12a787e6d788719a10bdba5b2699c327186af4e23c1a946834b6150bda2583e9ca2ad44ce8dbbbc2db04de8ef92e8efc141fbecaa6287c59474e6bc05d99b2964fa090c3a2233ba186515be7ed1f612970cee2d7afb81bdd762170481cd0069127d5b05aa993b4ea988d8fddc186ffb7dc90a6c08f4df435c93402849236c3fab4d27c7026c1d4dcb2602646dec9751e763dba37bdf8ff9406ad9e530ee5db382f413001aeb06a53ed9027d831179727b0865a8918da3edbebcf9b14ed44ce6cbaced4bb1bdb7f1447e6cc254b332051512bd7af426fb8f401378cd2bf5983ca01c64b92ecf032ea15d1721d03f482d7ce6e74fef6d55e702f46980c82b5a84031900b1c9e59e7c97fbec7e8f323a97a7e36cc88be0f1d45b7ff585ac54bd407b22b4154aacc8f6d7ebf48e1d814cc5ed20f8037e0a79715eef29be32806a1d58bb7c5da76f550aa3d8a1fbff0eb19ccb1a313d55cda56c9ec2ef29632387fe8d76e3c0468043e8f663f4860ee12bf2d5b0b7474d6e694f91e6dcc4024ffffffffffffffff"},modp18:{gen:"02",prime:"ffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b139b22514a08798e3404ddef9519b3cd3a431b302b0a6df25f14374fe1356d6d51c245e485b576625e7ec6f44c42e9a637ed6b0bff5cb6f406b7edee386bfb5a899fa5ae9f24117c4b1fe649286651ece45b3dc2007cb8a163bf0598da48361c55d39a69163fa8fd24cf5f83655d23dca3ad961c62f356208552bb9ed529077096966d670c354e4abc9804f1746c08ca18217c32905e462e36ce3be39e772c180e86039b2783a2ec07a28fb5c55df06f4c52c9de2bcbf6955817183995497cea956ae515d2261898fa051015728e5a8aaac42dad33170d04507a33a85521abdf1cba64ecfb850458dbef0a8aea71575d060c7db3970f85a6e1e4c7abf5ae8cdb0933d71e8c94e04a25619dcee3d2261ad2ee6bf12ffa06d98a0864d87602733ec86a64521f2b18177b200cbbe117577a615d6c770988c0bad946e208e24fa074e5ab3143db5bfce0fd108e4b82d120a92108011a723c12a787e6d788719a10bdba5b2699c327186af4e23c1a946834b6150bda2583e9ca2ad44ce8dbbbc2db04de8ef92e8efc141fbecaa6287c59474e6bc05d99b2964fa090c3a2233ba186515be7ed1f612970cee2d7afb81bdd762170481cd0069127d5b05aa993b4ea988d8fddc186ffb7dc90a6c08f4df435c93402849236c3fab4d27c7026c1d4dcb2602646dec9751e763dba37bdf8ff9406ad9e530ee5db382f413001aeb06a53ed9027d831179727b0865a8918da3edbebcf9b14ed44ce6cbaced4bb1bdb7f1447e6cc254b332051512bd7af426fb8f401378cd2bf5983ca01c64b92ecf032ea15d1721d03f482d7ce6e74fef6d55e702f46980c82b5a84031900b1c9e59e7c97fbec7e8f323a97a7e36cc88be0f1d45b7ff585ac54bd407b22b4154aacc8f6d7ebf48e1d814cc5ed20f8037e0a79715eef29be32806a1d58bb7c5da76f550aa3d8a1fbff0eb19ccb1a313d55cda56c9ec2ef29632387fe8d76e3c0468043e8f663f4860ee12bf2d5b0b7474d6e694f91e6dbe115974a3926f12fee5e438777cb6a932df8cd8bec4d073b931ba3bc832b68d9dd300741fa7bf8afc47ed2576f6936ba424663aab639c5ae4f5683423b4742bf1c978238f16cbe39d652de3fdb8befc848ad922222e04a4037c0713eb57a81a23f0c73473fc646cea306b4bcbc8862f8385ddfa9d4b7fa2c087e879683303ed5bdd3a062b3cf5b3a278a66d2a13f83f44f82ddf310ee074ab6a364597e899a0255dc164f31cc50846851df9ab48195ded7ea1b1d510bd7ee74d73faf36bc31ecfa268359046f4eb879f924009438b481c6cd7889a002ed5ee382bc9190da6fc026e479558e4475677e9aa9e3050e2765694dfc81f56e880b96e7160c980dd98edd3dfffffffffffffffff"}}},{}],349:[function(e,n,i){arguments[4][181][0].apply(i,arguments)},{buffer:185,dup:181}],350:[function(e,n,i){var o=i;o.version=e("../package.json").version,o.utils=e("./elliptic/utils"),o.rand=e("brorand"),o.curve=e("./elliptic/curve"),o.curves=e("./elliptic/curves"),o.ec=e("./elliptic/ec"),o.eddsa=e("./elliptic/eddsa")},{"../package.json":366,"./elliptic/curve":353,"./elliptic/curves":356,"./elliptic/ec":357,"./elliptic/eddsa":360,"./elliptic/utils":364,brorand:184}],351:[function(e,n,i){var o=e("bn.js"),a=e("../utils"),s=a.getNAF,l=a.getJSF,p=a.assert;function d(y,h){this.type=y,this.p=new o(h.p,16),this.red=h.prime?o.red(h.prime):o.mont(this.p),this.zero=new o(0).toRed(this.red),this.one=new o(1).toRed(this.red),this.two=new o(2).toRed(this.red),this.n=h.n&&new o(h.n,16),this.g=h.g&&this.pointFromJSON(h.g,h.gRed),this._wnafT1=new Array(4),this._wnafT2=new Array(4),this._wnafT3=new Array(4),this._wnafT4=new Array(4),this._bitLength=this.n?this.n.bitLength():0;var u=this.n&&this.p.div(this.n);!u||u.cmpn(100)>0?this.redN=null:(this._maxwellTrick=!0,this.redN=this.n.toRed(this.red))}function g(y,h){this.curve=y,this.type=h,this.precomputed=null}n.exports=d,d.prototype.point=function(){throw new Error("Not implemented")},d.prototype.validate=function(){throw new Error("Not implemented")},d.prototype._fixedNafMul=function(y,h){p(y.precomputed);var u=y._getDoubles(),f=s(h,1,this._bitLength),c=(1<<u.step+1)-(u.step%2==0?2:1);c/=3;for(var v=[],m=0;m<f.length;m+=u.step){var b=0;for(h=m+u.step-1;h>=m;h--)b=(b<<1)+f[h];v.push(b)}for(var w=this.jpoint(null,null,null),_=this.jpoint(null,null,null),C=c;C>0;C--){for(m=0;m<v.length;m++)(b=v[m])===C?_=_.mixedAdd(u.points[m]):b===-C&&(_=_.mixedAdd(u.points[m].neg()));w=w.add(_)}return w.toP()},d.prototype._wnafMul=function(y,h){var u=4,f=y._getNAFPoints(u);u=f.wnd;for(var c=f.points,v=s(h,u,this._bitLength),m=this.jpoint(null,null,null),b=v.length-1;b>=0;b--){for(h=0;b>=0&&v[b]===0;b--)h++;if(b>=0&&h++,m=m.dblp(h),b<0)break;var w=v[b];p(w!==0),m=y.type==="affine"?w>0?m.mixedAdd(c[w-1>>1]):m.mixedAdd(c[-w-1>>1].neg()):w>0?m.add(c[w-1>>1]):m.add(c[-w-1>>1].neg())}return y.type==="affine"?m.toP():m},d.prototype._wnafMulAdd=function(y,h,u,f,c){for(var v=this._wnafT1,m=this._wnafT2,b=this._wnafT3,w=0,_=0;_<f;_++){var C=(x=h[_])._getNAFPoints(y);v[_]=C.wnd,m[_]=C.points}for(_=f-1;_>=1;_-=2){var R=_-1,I=_;if(v[R]===1&&v[I]===1){var P=[h[R],null,null,h[I]];h[R].y.cmp(h[I].y)===0?(P[1]=h[R].add(h[I]),P[2]=h[R].toJ().mixedAdd(h[I].neg())):h[R].y.cmp(h[I].y.redNeg())===0?(P[1]=h[R].toJ().mixedAdd(h[I]),P[2]=h[R].add(h[I].neg())):(P[1]=h[R].toJ().mixedAdd(h[I]),P[2]=h[R].toJ().mixedAdd(h[I].neg()));var N=[-3,-1,-5,-7,0,7,5,1,3],A=l(u[R],u[I]);w=Math.max(A[0].length,w),b[R]=new Array(w),b[I]=new Array(w);for(var $=0;$<w;$++){var T=0|A[0][$],M=0|A[1][$];b[R][$]=N[3*(T+1)+(M+1)],b[I][$]=0,m[R]=P}}else b[R]=s(u[R],v[R],this._bitLength),b[I]=s(u[I],v[I],this._bitLength),w=Math.max(b[R].length,w),w=Math.max(b[I].length,w)}var S=this.jpoint(null,null,null),E=this._wnafT4;for(_=w;_>=0;_--){for(var k=0;_>=0;){var O=!0;for($=0;$<f;$++)E[$]=0|b[$][_],E[$]!==0&&(O=!1);if(!O)break;k++,_--}if(_>=0&&k++,S=S.dblp(k),_<0)break;for($=0;$<f;$++){var x,j=E[$];j!==0&&(j>0?x=m[$][j-1>>1]:j<0&&(x=m[$][-j-1>>1].neg()),S=x.type==="affine"?S.mixedAdd(x):S.add(x))}}for(_=0;_<f;_++)m[_]=null;return c?S:S.toP()},d.BasePoint=g,g.prototype.eq=function(){throw new Error("Not implemented")},g.prototype.validate=function(){return this.curve.validate(this)},d.prototype.decodePoint=function(y,h){y=a.toArray(y,h);var u=this.p.byteLength();if((y[0]===4||y[0]===6||y[0]===7)&&y.length-1==2*u)return y[0]===6?p(y[y.length-1]%2==0):y[0]===7&&p(y[y.length-1]%2==1),this.point(y.slice(1,1+u),y.slice(1+u,1+2*u));if((y[0]===2||y[0]===3)&&y.length-1===u)return this.pointFromX(y.slice(1,1+u),y[0]===3);throw new Error("Unknown point format")},g.prototype.encodeCompressed=function(y){return this.encode(y,!0)},g.prototype._encode=function(y){var h=this.curve.p.byteLength(),u=this.getX().toArray("be",h);return y?[this.getY().isEven()?2:3].concat(u):[4].concat(u,this.getY().toArray("be",h))},g.prototype.encode=function(y,h){return a.encode(this._encode(h),y)},g.prototype.precompute=function(y){if(this.precomputed)return this;var h={doubles:null,naf:null,beta:null};return h.naf=this._getNAFPoints(8),h.doubles=this._getDoubles(4,y),h.beta=this._getBeta(),this.precomputed=h,this},g.prototype._hasDoubles=function(y){if(!this.precomputed)return!1;var h=this.precomputed.doubles;return!!h&&h.points.length>=Math.ceil((y.bitLength()+1)/h.step)},g.prototype._getDoubles=function(y,h){if(this.precomputed&&this.precomputed.doubles)return this.precomputed.doubles;for(var u=[this],f=this,c=0;c<h;c+=y){for(var v=0;v<y;v++)f=f.dbl();u.push(f)}return{step:y,points:u}},g.prototype._getNAFPoints=function(y){if(this.precomputed&&this.precomputed.naf)return this.precomputed.naf;for(var h=[this],u=(1<<y)-1,f=u===1?null:this.dbl(),c=1;c<u;c++)h[c]=h[c-1].add(f);return{wnd:y,points:h}},g.prototype._getBeta=function(){return null},g.prototype.dblp=function(y){for(var h=this,u=0;u<y;u++)h=h.dbl();return h}},{"../utils":364,"bn.js":365}],352:[function(e,n,i){var o=e("../utils"),a=e("bn.js"),s=e("inherits"),l=e("./base"),p=o.assert;function d(y){this.twisted=(0|y.a)!=1,this.mOneA=this.twisted&&(0|y.a)==-1,this.extended=this.mOneA,l.call(this,"edwards",y),this.a=new a(y.a,16).umod(this.red.m),this.a=this.a.toRed(this.red),this.c=new a(y.c,16).toRed(this.red),this.c2=this.c.redSqr(),this.d=new a(y.d,16).toRed(this.red),this.dd=this.d.redAdd(this.d),p(!this.twisted||this.c.fromRed().cmpn(1)===0),this.oneC=(0|y.c)==1}function g(y,h,u,f,c){l.BasePoint.call(this,y,"projective"),h===null&&u===null&&f===null?(this.x=this.curve.zero,this.y=this.curve.one,this.z=this.curve.one,this.t=this.curve.zero,this.zOne=!0):(this.x=new a(h,16),this.y=new a(u,16),this.z=f?new a(f,16):this.curve.one,this.t=c&&new a(c,16),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.y.red||(this.y=this.y.toRed(this.curve.red)),this.z.red||(this.z=this.z.toRed(this.curve.red)),this.t&&!this.t.red&&(this.t=this.t.toRed(this.curve.red)),this.zOne=this.z===this.curve.one,this.curve.extended&&!this.t&&(this.t=this.x.redMul(this.y),this.zOne||(this.t=this.t.redMul(this.z.redInvm()))))}s(d,l),n.exports=d,d.prototype._mulA=function(y){return this.mOneA?y.redNeg():this.a.redMul(y)},d.prototype._mulC=function(y){return this.oneC?y:this.c.redMul(y)},d.prototype.jpoint=function(y,h,u,f){return this.point(y,h,u,f)},d.prototype.pointFromX=function(y,h){(y=new a(y,16)).red||(y=y.toRed(this.red));var u=y.redSqr(),f=this.c2.redSub(this.a.redMul(u)),c=this.one.redSub(this.c2.redMul(this.d).redMul(u)),v=f.redMul(c.redInvm()),m=v.redSqrt();if(m.redSqr().redSub(v).cmp(this.zero)!==0)throw new Error("invalid point");var b=m.fromRed().isOdd();return(h&&!b||!h&&b)&&(m=m.redNeg()),this.point(y,m)},d.prototype.pointFromY=function(y,h){(y=new a(y,16)).red||(y=y.toRed(this.red));var u=y.redSqr(),f=u.redSub(this.c2),c=u.redMul(this.d).redMul(this.c2).redSub(this.a),v=f.redMul(c.redInvm());if(v.cmp(this.zero)===0){if(h)throw new Error("invalid point");return this.point(this.zero,y)}var m=v.redSqrt();if(m.redSqr().redSub(v).cmp(this.zero)!==0)throw new Error("invalid point");return m.fromRed().isOdd()!==h&&(m=m.redNeg()),this.point(m,y)},d.prototype.validate=function(y){if(y.isInfinity())return!0;y.normalize();var h=y.x.redSqr(),u=y.y.redSqr(),f=h.redMul(this.a).redAdd(u),c=this.c2.redMul(this.one.redAdd(this.d.redMul(h).redMul(u)));return f.cmp(c)===0},s(g,l.BasePoint),d.prototype.pointFromJSON=function(y){return g.fromJSON(this,y)},d.prototype.point=function(y,h,u,f){return new g(this,y,h,u,f)},g.fromJSON=function(y,h){return new g(y,h[0],h[1],h[2])},g.prototype.inspect=function(){return this.isInfinity()?"<EC Point Infinity>":"<EC Point x: "+this.x.fromRed().toString(16,2)+" y: "+this.y.fromRed().toString(16,2)+" z: "+this.z.fromRed().toString(16,2)+">"},g.prototype.isInfinity=function(){return this.x.cmpn(0)===0&&(this.y.cmp(this.z)===0||this.zOne&&this.y.cmp(this.curve.c)===0)},g.prototype._extDbl=function(){var y=this.x.redSqr(),h=this.y.redSqr(),u=this.z.redSqr();u=u.redIAdd(u);var f=this.curve._mulA(y),c=this.x.redAdd(this.y).redSqr().redISub(y).redISub(h),v=f.redAdd(h),m=v.redSub(u),b=f.redSub(h),w=c.redMul(m),_=v.redMul(b),C=c.redMul(b),R=m.redMul(v);return this.curve.point(w,_,R,C)},g.prototype._projDbl=function(){var y,h,u,f=this.x.redAdd(this.y).redSqr(),c=this.x.redSqr(),v=this.y.redSqr();if(this.curve.twisted){var m=(_=this.curve._mulA(c)).redAdd(v);if(this.zOne)y=f.redSub(c).redSub(v).redMul(m.redSub(this.curve.two)),h=m.redMul(_.redSub(v)),u=m.redSqr().redSub(m).redSub(m);else{var b=this.z.redSqr(),w=m.redSub(b).redISub(b);y=f.redSub(c).redISub(v).redMul(w),h=m.redMul(_.redSub(v)),u=m.redMul(w)}}else{var _=c.redAdd(v);b=this.curve._mulC(this.z).redSqr(),w=_.redSub(b).redSub(b),y=this.curve._mulC(f.redISub(_)).redMul(w),h=this.curve._mulC(_).redMul(c.redISub(v)),u=_.redMul(w)}return this.curve.point(y,h,u)},g.prototype.dbl=function(){return this.isInfinity()?this:this.curve.extended?this._extDbl():this._projDbl()},g.prototype._extAdd=function(y){var h=this.y.redSub(this.x).redMul(y.y.redSub(y.x)),u=this.y.redAdd(this.x).redMul(y.y.redAdd(y.x)),f=this.t.redMul(this.curve.dd).redMul(y.t),c=this.z.redMul(y.z.redAdd(y.z)),v=u.redSub(h),m=c.redSub(f),b=c.redAdd(f),w=u.redAdd(h),_=v.redMul(m),C=b.redMul(w),R=v.redMul(w),I=m.redMul(b);return this.curve.point(_,C,I,R)},g.prototype._projAdd=function(y){var h,u,f=this.z.redMul(y.z),c=f.redSqr(),v=this.x.redMul(y.x),m=this.y.redMul(y.y),b=this.curve.d.redMul(v).redMul(m),w=c.redSub(b),_=c.redAdd(b),C=this.x.redAdd(this.y).redMul(y.x.redAdd(y.y)).redISub(v).redISub(m),R=f.redMul(w).redMul(C);return this.curve.twisted?(h=f.redMul(_).redMul(m.redSub(this.curve._mulA(v))),u=w.redMul(_)):(h=f.redMul(_).redMul(m.redSub(v)),u=this.curve._mulC(w).redMul(_)),this.curve.point(R,h,u)},g.prototype.add=function(y){return this.isInfinity()?y:y.isInfinity()?this:this.curve.extended?this._extAdd(y):this._projAdd(y)},g.prototype.mul=function(y){return this._hasDoubles(y)?this.curve._fixedNafMul(this,y):this.curve._wnafMul(this,y)},g.prototype.mulAdd=function(y,h,u){return this.curve._wnafMulAdd(1,[this,h],[y,u],2,!1)},g.prototype.jmulAdd=function(y,h,u){return this.curve._wnafMulAdd(1,[this,h],[y,u],2,!0)},g.prototype.normalize=function(){if(this.zOne)return this;var y=this.z.redInvm();return this.x=this.x.redMul(y),this.y=this.y.redMul(y),this.t&&(this.t=this.t.redMul(y)),this.z=this.curve.one,this.zOne=!0,this},g.prototype.neg=function(){return this.curve.point(this.x.redNeg(),this.y,this.z,this.t&&this.t.redNeg())},g.prototype.getX=function(){return this.normalize(),this.x.fromRed()},g.prototype.getY=function(){return this.normalize(),this.y.fromRed()},g.prototype.eq=function(y){return this===y||this.getX().cmp(y.getX())===0&&this.getY().cmp(y.getY())===0},g.prototype.eqXToP=function(y){var h=y.toRed(this.curve.red).redMul(this.z);if(this.x.cmp(h)===0)return!0;for(var u=y.clone(),f=this.curve.redN.redMul(this.z);;){if(u.iadd(this.curve.n),u.cmp(this.curve.p)>=0)return!1;if(h.redIAdd(f),this.x.cmp(h)===0)return!0}},g.prototype.toP=g.prototype.normalize,g.prototype.mixedAdd=g.prototype.add},{"../utils":364,"./base":351,"bn.js":365,inherits:387}],353:[function(e,n,i){var o=i;o.base=e("./base"),o.short=e("./short"),o.mont=e("./mont"),o.edwards=e("./edwards")},{"./base":351,"./edwards":352,"./mont":354,"./short":355}],354:[function(e,n,i){var o=e("bn.js"),a=e("inherits"),s=e("./base"),l=e("../utils");function p(g){s.call(this,"mont",g),this.a=new o(g.a,16).toRed(this.red),this.b=new o(g.b,16).toRed(this.red),this.i4=new o(4).toRed(this.red).redInvm(),this.two=new o(2).toRed(this.red),this.a24=this.i4.redMul(this.a.redAdd(this.two))}function d(g,y,h){s.BasePoint.call(this,g,"projective"),y===null&&h===null?(this.x=this.curve.one,this.z=this.curve.zero):(this.x=new o(y,16),this.z=new o(h,16),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.z.red||(this.z=this.z.toRed(this.curve.red)))}a(p,s),n.exports=p,p.prototype.validate=function(g){var y=g.normalize().x,h=y.redSqr(),u=h.redMul(y).redAdd(h.redMul(this.a)).redAdd(y);return u.redSqrt().redSqr().cmp(u)===0},a(d,s.BasePoint),p.prototype.decodePoint=function(g,y){return this.point(l.toArray(g,y),1)},p.prototype.point=function(g,y){return new d(this,g,y)},p.prototype.pointFromJSON=function(g){return d.fromJSON(this,g)},d.prototype.precompute=function(){},d.prototype._encode=function(){return this.getX().toArray("be",this.curve.p.byteLength())},d.fromJSON=function(g,y){return new d(g,y[0],y[1]||g.one)},d.prototype.inspect=function(){return this.isInfinity()?"<EC Point Infinity>":"<EC Point x: "+this.x.fromRed().toString(16,2)+" z: "+this.z.fromRed().toString(16,2)+">"},d.prototype.isInfinity=function(){return this.z.cmpn(0)===0},d.prototype.dbl=function(){var g=this.x.redAdd(this.z).redSqr(),y=this.x.redSub(this.z).redSqr(),h=g.redSub(y),u=g.redMul(y),f=h.redMul(y.redAdd(this.curve.a24.redMul(h)));return this.curve.point(u,f)},d.prototype.add=function(){throw new Error("Not supported on Montgomery curve")},d.prototype.diffAdd=function(g,y){var h=this.x.redAdd(this.z),u=this.x.redSub(this.z),f=g.x.redAdd(g.z),c=g.x.redSub(g.z).redMul(h),v=f.redMul(u),m=y.z.redMul(c.redAdd(v).redSqr()),b=y.x.redMul(c.redISub(v).redSqr());return this.curve.point(m,b)},d.prototype.mul=function(g){for(var y=g.clone(),h=this,u=this.curve.point(null,null),f=[];y.cmpn(0)!==0;y.iushrn(1))f.push(y.andln(1));for(var c=f.length-1;c>=0;c--)f[c]===0?(h=h.diffAdd(u,this),u=u.dbl()):(u=h.diffAdd(u,this),h=h.dbl());return u},d.prototype.mulAdd=function(){throw new Error("Not supported on Montgomery curve")},d.prototype.jumlAdd=function(){throw new Error("Not supported on Montgomery curve")},d.prototype.eq=function(g){return this.getX().cmp(g.getX())===0},d.prototype.normalize=function(){return this.x=this.x.redMul(this.z.redInvm()),this.z=this.curve.one,this},d.prototype.getX=function(){return this.normalize(),this.x.fromRed()}},{"../utils":364,"./base":351,"bn.js":365,inherits:387}],355:[function(e,n,i){var o=e("../utils"),a=e("bn.js"),s=e("inherits"),l=e("./base"),p=o.assert;function d(h){l.call(this,"short",h),this.a=new a(h.a,16).toRed(this.red),this.b=new a(h.b,16).toRed(this.red),this.tinv=this.two.redInvm(),this.zeroA=this.a.fromRed().cmpn(0)===0,this.threeA=this.a.fromRed().sub(this.p).cmpn(-3)===0,this.endo=this._getEndomorphism(h),this._endoWnafT1=new Array(4),this._endoWnafT2=new Array(4)}function g(h,u,f,c){l.BasePoint.call(this,h,"affine"),u===null&&f===null?(this.x=null,this.y=null,this.inf=!0):(this.x=new a(u,16),this.y=new a(f,16),c&&(this.x.forceRed(this.curve.red),this.y.forceRed(this.curve.red)),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.y.red||(this.y=this.y.toRed(this.curve.red)),this.inf=!1)}function y(h,u,f,c){l.BasePoint.call(this,h,"jacobian"),u===null&&f===null&&c===null?(this.x=this.curve.one,this.y=this.curve.one,this.z=new a(0)):(this.x=new a(u,16),this.y=new a(f,16),this.z=new a(c,16)),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.y.red||(this.y=this.y.toRed(this.curve.red)),this.z.red||(this.z=this.z.toRed(this.curve.red)),this.zOne=this.z===this.curve.one}s(d,l),n.exports=d,d.prototype._getEndomorphism=function(h){if(this.zeroA&&this.g&&this.n&&this.p.modn(3)===1){var u,f;if(h.beta)u=new a(h.beta,16).toRed(this.red);else{var c=this._getEndoRoots(this.p);u=(u=c[0].cmp(c[1])<0?c[0]:c[1]).toRed(this.red)}if(h.lambda)f=new a(h.lambda,16);else{var v=this._getEndoRoots(this.n);this.g.mul(v[0]).x.cmp(this.g.x.redMul(u))===0?f=v[0]:(f=v[1],p(this.g.mul(f).x.cmp(this.g.x.redMul(u))===0))}return{beta:u,lambda:f,basis:h.basis?h.basis.map(function(m){return{a:new a(m.a,16),b:new a(m.b,16)}}):this._getEndoBasis(f)}}},d.prototype._getEndoRoots=function(h){var u=h===this.p?this.red:a.mont(h),f=new a(2).toRed(u).redInvm(),c=f.redNeg(),v=new a(3).toRed(u).redNeg().redSqrt().redMul(f);return[c.redAdd(v).fromRed(),c.redSub(v).fromRed()]},d.prototype._getEndoBasis=function(h){for(var u,f,c,v,m,b,w,_,C,R=this.n.ushrn(Math.floor(this.n.bitLength()/2)),I=h,P=this.n.clone(),N=new a(1),A=new a(0),$=new a(0),T=new a(1),M=0;I.cmpn(0)!==0;){var S=P.div(I);_=P.sub(S.mul(I)),C=$.sub(S.mul(N));var E=T.sub(S.mul(A));if(!c&&_.cmp(R)<0)u=w.neg(),f=N,c=_.neg(),v=C;else if(c&&++M==2)break;w=_,P=I,I=_,$=N,N=C,T=A,A=E}m=_.neg(),b=C;var k=c.sqr().add(v.sqr());return m.sqr().add(b.sqr()).cmp(k)>=0&&(m=u,b=f),c.negative&&(c=c.neg(),v=v.neg()),m.negative&&(m=m.neg(),b=b.neg()),[{a:c,b:v},{a:m,b}]},d.prototype._endoSplit=function(h){var u=this.endo.basis,f=u[0],c=u[1],v=c.b.mul(h).divRound(this.n),m=f.b.neg().mul(h).divRound(this.n),b=v.mul(f.a),w=m.mul(c.a),_=v.mul(f.b),C=m.mul(c.b);return{k1:h.sub(b).sub(w),k2:_.add(C).neg()}},d.prototype.pointFromX=function(h,u){(h=new a(h,16)).red||(h=h.toRed(this.red));var f=h.redSqr().redMul(h).redIAdd(h.redMul(this.a)).redIAdd(this.b),c=f.redSqrt();if(c.redSqr().redSub(f).cmp(this.zero)!==0)throw new Error("invalid point");var v=c.fromRed().isOdd();return(u&&!v||!u&&v)&&(c=c.redNeg()),this.point(h,c)},d.prototype.validate=function(h){if(h.inf)return!0;var u=h.x,f=h.y,c=this.a.redMul(u),v=u.redSqr().redMul(u).redIAdd(c).redIAdd(this.b);return f.redSqr().redISub(v).cmpn(0)===0},d.prototype._endoWnafMulAdd=function(h,u,f){for(var c=this._endoWnafT1,v=this._endoWnafT2,m=0;m<h.length;m++){var b=this._endoSplit(u[m]),w=h[m],_=w._getBeta();b.k1.negative&&(b.k1.ineg(),w=w.neg(!0)),b.k2.negative&&(b.k2.ineg(),_=_.neg(!0)),c[2*m]=w,c[2*m+1]=_,v[2*m]=b.k1,v[2*m+1]=b.k2}for(var C=this._wnafMulAdd(1,c,v,2*m,f),R=0;R<2*m;R++)c[R]=null,v[R]=null;return C},s(g,l.BasePoint),d.prototype.point=function(h,u,f){return new g(this,h,u,f)},d.prototype.pointFromJSON=function(h,u){return g.fromJSON(this,h,u)},g.prototype._getBeta=function(){if(this.curve.endo){var h=this.precomputed;if(h&&h.beta)return h.beta;var u=this.curve.point(this.x.redMul(this.curve.endo.beta),this.y);if(h){var f=this.curve,c=function(v){return f.point(v.x.redMul(f.endo.beta),v.y)};h.beta=u,u.precomputed={beta:null,naf:h.naf&&{wnd:h.naf.wnd,points:h.naf.points.map(c)},doubles:h.doubles&&{step:h.doubles.step,points:h.doubles.points.map(c)}}}return u}},g.prototype.toJSON=function(){return this.precomputed?[this.x,this.y,this.precomputed&&{doubles:this.precomputed.doubles&&{step:this.precomputed.doubles.step,points:this.precomputed.doubles.points.slice(1)},naf:this.precomputed.naf&&{wnd:this.precomputed.naf.wnd,points:this.precomputed.naf.points.slice(1)}}]:[this.x,this.y]},g.fromJSON=function(h,u,f){typeof u=="string"&&(u=JSON.parse(u));var c=h.point(u[0],u[1],f);if(!u[2])return c;function v(b){return h.point(b[0],b[1],f)}var m=u[2];return c.precomputed={beta:null,doubles:m.doubles&&{step:m.doubles.step,points:[c].concat(m.doubles.points.map(v))},naf:m.naf&&{wnd:m.naf.wnd,points:[c].concat(m.naf.points.map(v))}},c},g.prototype.inspect=function(){return this.isInfinity()?"<EC Point Infinity>":"<EC Point x: "+this.x.fromRed().toString(16,2)+" y: "+this.y.fromRed().toString(16,2)+">"},g.prototype.isInfinity=function(){return this.inf},g.prototype.add=function(h){if(this.inf)return h;if(h.inf)return this;if(this.eq(h))return this.dbl();if(this.neg().eq(h))return this.curve.point(null,null);if(this.x.cmp(h.x)===0)return this.curve.point(null,null);var u=this.y.redSub(h.y);u.cmpn(0)!==0&&(u=u.redMul(this.x.redSub(h.x).redInvm()));var f=u.redSqr().redISub(this.x).redISub(h.x),c=u.redMul(this.x.redSub(f)).redISub(this.y);return this.curve.point(f,c)},g.prototype.dbl=function(){if(this.inf)return this;var h=this.y.redAdd(this.y);if(h.cmpn(0)===0)return this.curve.point(null,null);var u=this.curve.a,f=this.x.redSqr(),c=h.redInvm(),v=f.redAdd(f).redIAdd(f).redIAdd(u).redMul(c),m=v.redSqr().redISub(this.x.redAdd(this.x)),b=v.redMul(this.x.redSub(m)).redISub(this.y);return this.curve.point(m,b)},g.prototype.getX=function(){return this.x.fromRed()},g.prototype.getY=function(){return this.y.fromRed()},g.prototype.mul=function(h){return h=new a(h,16),this.isInfinity()?this:this._hasDoubles(h)?this.curve._fixedNafMul(this,h):this.curve.endo?this.curve._endoWnafMulAdd([this],[h]):this.curve._wnafMul(this,h)},g.prototype.mulAdd=function(h,u,f){var c=[this,u],v=[h,f];return this.curve.endo?this.curve._endoWnafMulAdd(c,v):this.curve._wnafMulAdd(1,c,v,2)},g.prototype.jmulAdd=function(h,u,f){var c=[this,u],v=[h,f];return this.curve.endo?this.curve._endoWnafMulAdd(c,v,!0):this.curve._wnafMulAdd(1,c,v,2,!0)},g.prototype.eq=function(h){return this===h||this.inf===h.inf&&(this.inf||this.x.cmp(h.x)===0&&this.y.cmp(h.y)===0)},g.prototype.neg=function(h){if(this.inf)return this;var u=this.curve.point(this.x,this.y.redNeg());if(h&&this.precomputed){var f=this.precomputed,c=function(v){return v.neg()};u.precomputed={naf:f.naf&&{wnd:f.naf.wnd,points:f.naf.points.map(c)},doubles:f.doubles&&{step:f.doubles.step,points:f.doubles.points.map(c)}}}return u},g.prototype.toJ=function(){return this.inf?this.curve.jpoint(null,null,null):this.curve.jpoint(this.x,this.y,this.curve.one)},s(y,l.BasePoint),d.prototype.jpoint=function(h,u,f){return new y(this,h,u,f)},y.prototype.toP=function(){if(this.isInfinity())return this.curve.point(null,null);var h=this.z.redInvm(),u=h.redSqr(),f=this.x.redMul(u),c=this.y.redMul(u).redMul(h);return this.curve.point(f,c)},y.prototype.neg=function(){return this.curve.jpoint(this.x,this.y.redNeg(),this.z)},y.prototype.add=function(h){if(this.isInfinity())return h;if(h.isInfinity())return this;var u=h.z.redSqr(),f=this.z.redSqr(),c=this.x.redMul(u),v=h.x.redMul(f),m=this.y.redMul(u.redMul(h.z)),b=h.y.redMul(f.redMul(this.z)),w=c.redSub(v),_=m.redSub(b);if(w.cmpn(0)===0)return _.cmpn(0)!==0?this.curve.jpoint(null,null,null):this.dbl();var C=w.redSqr(),R=C.redMul(w),I=c.redMul(C),P=_.redSqr().redIAdd(R).redISub(I).redISub(I),N=_.redMul(I.redISub(P)).redISub(m.redMul(R)),A=this.z.redMul(h.z).redMul(w);return this.curve.jpoint(P,N,A)},y.prototype.mixedAdd=function(h){if(this.isInfinity())return h.toJ();if(h.isInfinity())return this;var u=this.z.redSqr(),f=this.x,c=h.x.redMul(u),v=this.y,m=h.y.redMul(u).redMul(this.z),b=f.redSub(c),w=v.redSub(m);if(b.cmpn(0)===0)return w.cmpn(0)!==0?this.curve.jpoint(null,null,null):this.dbl();var _=b.redSqr(),C=_.redMul(b),R=f.redMul(_),I=w.redSqr().redIAdd(C).redISub(R).redISub(R),P=w.redMul(R.redISub(I)).redISub(v.redMul(C)),N=this.z.redMul(b);return this.curve.jpoint(I,P,N)},y.prototype.dblp=function(h){if(h===0)return this;if(this.isInfinity())return this;if(!h)return this.dbl();if(this.curve.zeroA||this.curve.threeA){for(var u=this,f=0;f<h;f++)u=u.dbl();return u}var c=this.curve.a,v=this.curve.tinv,m=this.x,b=this.y,w=this.z,_=w.redSqr().redSqr(),C=b.redAdd(b);for(f=0;f<h;f++){var R=m.redSqr(),I=C.redSqr(),P=I.redSqr(),N=R.redAdd(R).redIAdd(R).redIAdd(c.redMul(_)),A=m.redMul(I),$=N.redSqr().redISub(A.redAdd(A)),T=A.redISub($),M=N.redMul(T);M=M.redIAdd(M).redISub(P);var S=C.redMul(w);f+1<h&&(_=_.redMul(P)),m=$,w=S,C=M}return this.curve.jpoint(m,C.redMul(v),w)},y.prototype.dbl=function(){return this.isInfinity()?this:this.curve.zeroA?this._zeroDbl():this.curve.threeA?this._threeDbl():this._dbl()},y.prototype._zeroDbl=function(){var h,u,f;if(this.zOne){var c=this.x.redSqr(),v=this.y.redSqr(),m=v.redSqr(),b=this.x.redAdd(v).redSqr().redISub(c).redISub(m);b=b.redIAdd(b);var w=c.redAdd(c).redIAdd(c),_=w.redSqr().redISub(b).redISub(b),C=m.redIAdd(m);C=(C=C.redIAdd(C)).redIAdd(C),h=_,u=w.redMul(b.redISub(_)).redISub(C),f=this.y.redAdd(this.y)}else{var R=this.x.redSqr(),I=this.y.redSqr(),P=I.redSqr(),N=this.x.redAdd(I).redSqr().redISub(R).redISub(P);N=N.redIAdd(N);var A=R.redAdd(R).redIAdd(R),$=A.redSqr(),T=P.redIAdd(P);T=(T=T.redIAdd(T)).redIAdd(T),h=$.redISub(N).redISub(N),u=A.redMul(N.redISub(h)).redISub(T),f=(f=this.y.redMul(this.z)).redIAdd(f)}return this.curve.jpoint(h,u,f)},y.prototype._threeDbl=function(){var h,u,f;if(this.zOne){var c=this.x.redSqr(),v=this.y.redSqr(),m=v.redSqr(),b=this.x.redAdd(v).redSqr().redISub(c).redISub(m);b=b.redIAdd(b);var w=c.redAdd(c).redIAdd(c).redIAdd(this.curve.a),_=w.redSqr().redISub(b).redISub(b);h=_;var C=m.redIAdd(m);C=(C=C.redIAdd(C)).redIAdd(C),u=w.redMul(b.redISub(_)).redISub(C),f=this.y.redAdd(this.y)}else{var R=this.z.redSqr(),I=this.y.redSqr(),P=this.x.redMul(I),N=this.x.redSub(R).redMul(this.x.redAdd(R));N=N.redAdd(N).redIAdd(N);var A=P.redIAdd(P),$=(A=A.redIAdd(A)).redAdd(A);h=N.redSqr().redISub($),f=this.y.redAdd(this.z).redSqr().redISub(I).redISub(R);var T=I.redSqr();T=(T=(T=T.redIAdd(T)).redIAdd(T)).redIAdd(T),u=N.redMul(A.redISub(h)).redISub(T)}return this.curve.jpoint(h,u,f)},y.prototype._dbl=function(){var h=this.curve.a,u=this.x,f=this.y,c=this.z,v=c.redSqr().redSqr(),m=u.redSqr(),b=f.redSqr(),w=m.redAdd(m).redIAdd(m).redIAdd(h.redMul(v)),_=u.redAdd(u),C=(_=_.redIAdd(_)).redMul(b),R=w.redSqr().redISub(C.redAdd(C)),I=C.redISub(R),P=b.redSqr();P=(P=(P=P.redIAdd(P)).redIAdd(P)).redIAdd(P);var N=w.redMul(I).redISub(P),A=f.redAdd(f).redMul(c);return this.curve.jpoint(R,N,A)},y.prototype.trpl=function(){if(!this.curve.zeroA)return this.dbl().add(this);var h=this.x.redSqr(),u=this.y.redSqr(),f=this.z.redSqr(),c=u.redSqr(),v=h.redAdd(h).redIAdd(h),m=v.redSqr(),b=this.x.redAdd(u).redSqr().redISub(h).redISub(c),w=(b=(b=(b=b.redIAdd(b)).redAdd(b).redIAdd(b)).redISub(m)).redSqr(),_=c.redIAdd(c);_=(_=(_=_.redIAdd(_)).redIAdd(_)).redIAdd(_);var C=v.redIAdd(b).redSqr().redISub(m).redISub(w).redISub(_),R=u.redMul(C);R=(R=R.redIAdd(R)).redIAdd(R);var I=this.x.redMul(w).redISub(R);I=(I=I.redIAdd(I)).redIAdd(I);var P=this.y.redMul(C.redMul(_.redISub(C)).redISub(b.redMul(w)));P=(P=(P=P.redIAdd(P)).redIAdd(P)).redIAdd(P);var N=this.z.redAdd(b).redSqr().redISub(f).redISub(w);return this.curve.jpoint(I,P,N)},y.prototype.mul=function(h,u){return h=new a(h,u),this.curve._wnafMul(this,h)},y.prototype.eq=function(h){if(h.type==="affine")return this.eq(h.toJ());if(this===h)return!0;var u=this.z.redSqr(),f=h.z.redSqr();if(this.x.redMul(f).redISub(h.x.redMul(u)).cmpn(0)!==0)return!1;var c=u.redMul(this.z),v=f.redMul(h.z);return this.y.redMul(v).redISub(h.y.redMul(c)).cmpn(0)===0},y.prototype.eqXToP=function(h){var u=this.z.redSqr(),f=h.toRed(this.curve.red).redMul(u);if(this.x.cmp(f)===0)return!0;for(var c=h.clone(),v=this.curve.redN.redMul(u);;){if(c.iadd(this.curve.n),c.cmp(this.curve.p)>=0)return!1;if(f.redIAdd(v),this.x.cmp(f)===0)return!0}},y.prototype.inspect=function(){return this.isInfinity()?"<EC JPoint Infinity>":"<EC JPoint x: "+this.x.toString(16,2)+" y: "+this.y.toString(16,2)+" z: "+this.z.toString(16,2)+">"},y.prototype.isInfinity=function(){return this.z.cmpn(0)===0}},{"../utils":364,"./base":351,"bn.js":365,inherits:387}],356:[function(e,n,i){var o,a=i,s=e("hash.js"),l=e("./curve"),p=e("./utils").assert;function d(y){y.type==="short"?this.curve=new l.short(y):y.type==="edwards"?this.curve=new l.edwards(y):this.curve=new l.mont(y),this.g=this.curve.g,this.n=this.curve.n,this.hash=y.hash,p(this.g.validate(),"Invalid curve"),p(this.g.mul(this.n).isInfinity(),"Invalid curve, G*N != O")}function g(y,h){Object.defineProperty(a,y,{configurable:!0,enumerable:!0,get:function(){var u=new d(h);return Object.defineProperty(a,y,{configurable:!0,enumerable:!0,value:u}),u}})}a.PresetCurve=d,g("p192",{type:"short",prime:"p192",p:"ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff",a:"ffffffff ffffffff ffffffff fffffffe ffffffff fffffffc",b:"64210519 e59c80e7 0fa7e9ab 72243049 feb8deec c146b9b1",n:"ffffffff ffffffff ffffffff 99def836 146bc9b1 b4d22831",hash:s.sha256,gRed:!1,g:["188da80e b03090f6 7cbf20eb 43a18800 f4ff0afd 82ff1012","07192b95 ffc8da78 631011ed 6b24cdd5 73f977a1 1e794811"]}),g("p224",{type:"short",prime:"p224",p:"ffffffff ffffffff ffffffff ffffffff 00000000 00000000 00000001",a:"ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff fffffffe",b:"b4050a85 0c04b3ab f5413256 5044b0b7 d7bfd8ba 270b3943 2355ffb4",n:"ffffffff ffffffff ffffffff ffff16a2 e0b8f03e 13dd2945 5c5c2a3d",hash:s.sha256,gRed:!1,g:["b70e0cbd 6bb4bf7f 321390b9 4a03c1d3 56c21122 343280d6 115c1d21","bd376388 b5f723fb 4c22dfe6 cd4375a0 5a074764 44d58199 85007e34"]}),g("p256",{type:"short",prime:null,p:"ffffffff 00000001 00000000 00000000 00000000 ffffffff ffffffff ffffffff",a:"ffffffff 00000001 00000000 00000000 00000000 ffffffff ffffffff fffffffc",b:"5ac635d8 aa3a93e7 b3ebbd55 769886bc 651d06b0 cc53b0f6 3bce3c3e 27d2604b",n:"ffffffff 00000000 ffffffff ffffffff bce6faad a7179e84 f3b9cac2 fc632551",hash:s.sha256,gRed:!1,g:["6b17d1f2 e12c4247 f8bce6e5 63a440f2 77037d81 2deb33a0 f4a13945 d898c296","4fe342e2 fe1a7f9b 8ee7eb4a 7c0f9e16 2bce3357 6b315ece cbb64068 37bf51f5"]}),g("p384",{type:"short",prime:null,p:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe ffffffff 00000000 00000000 ffffffff",a:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe ffffffff 00000000 00000000 fffffffc",b:"b3312fa7 e23ee7e4 988e056b e3f82d19 181d9c6e fe814112 0314088f 5013875a c656398d 8a2ed19d 2a85c8ed d3ec2aef",n:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff c7634d81 f4372ddf 581a0db2 48b0a77a ecec196a ccc52973",hash:s.sha384,gRed:!1,g:["aa87ca22 be8b0537 8eb1c71e f320ad74 6e1d3b62 8ba79b98 59f741e0 82542a38 5502f25d bf55296c 3a545e38 72760ab7","3617de4a 96262c6f 5d9e98bf 9292dc29 f8f41dbd 289a147c e9da3113 b5f0b8c0 0a60b1ce 1d7e819d 7a431d7c 90ea0e5f"]}),g("p521",{type:"short",prime:null,p:"000001ff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff",a:"000001ff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffc",b:"00000051 953eb961 8e1c9a1f 929a21a0 b68540ee a2da725b 99b315f3 b8b48991 8ef109e1 56193951 ec7e937b 1652c0bd 3bb1bf07 3573df88 3d2c34f1 ef451fd4 6b503f00",n:"000001ff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffa 51868783 bf2f966b 7fcc0148 f709a5d0 3bb5c9b8 899c47ae bb6fb71e 91386409",hash:s.sha512,gRed:!1,g:["000000c6 858e06b7 0404e9cd 9e3ecb66 2395b442 9c648139 053fb521 f828af60 6b4d3dba a14b5e77 efe75928 fe1dc127 a2ffa8de 3348b3c1 856a429b f97e7e31 c2e5bd66","00000118 39296a78 9a3bc004 5c8a5fb4 2c7d1bd9 98f54449 579b4468 17afbd17 273e662c 97ee7299 5ef42640 c550b901 3fad0761 353c7086 a272c240 88be9476 9fd16650"]}),g("curve25519",{type:"mont",prime:"p25519",p:"7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed",a:"76d06",b:"1",n:"1000000000000000 0000000000000000 14def9dea2f79cd6 5812631a5cf5d3ed",hash:s.sha256,gRed:!1,g:["9"]}),g("ed25519",{type:"edwards",prime:"p25519",p:"7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed",a:"-1",c:"1",d:"52036cee2b6ffe73 8cc740797779e898 00700a4d4141d8ab 75eb4dca135978a3",n:"1000000000000000 0000000000000000 14def9dea2f79cd6 5812631a5cf5d3ed",hash:s.sha256,gRed:!1,g:["216936d3cd6e53fec0a4e231fdd6dc5c692cc7609525a7b2c9562d608f25d51a","6666666666666666666666666666666666666666666666666666666666666658"]});try{o=e("./precomputed/secp256k1")}catch{o=void 0}g("secp256k1",{type:"short",prime:"k256",p:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe fffffc2f",a:"0",b:"7",n:"ffffffff ffffffff ffffffff fffffffe baaedce6 af48a03b bfd25e8c d0364141",h:"1",hash:s.sha256,beta:"7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee",lambda:"5363ad4cc05c30e0a5261c028812645a122e22ea20816678df02967c1b23bd72",basis:[{a:"3086d221a7d46bcde86c90e49284eb15",b:"-e4437ed6010e88286f547fa90abfe4c3"},{a:"114ca50f7a8e2f3f657c1108d9d44cfd8",b:"3086d221a7d46bcde86c90e49284eb15"}],gRed:!1,g:["79be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798","483ada7726a3c4655da4fbfc0e1108a8fd17b448a68554199c47d08ffb10d4b8",o]})},{"./curve":353,"./precomputed/secp256k1":363,"./utils":364,"hash.js":372}],357:[function(e,n,i){function o(f){return(o=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(c){return typeof c}:function(c){return c&&typeof Symbol=="function"&&c.constructor===Symbol&&c!==Symbol.prototype?"symbol":typeof c})(f)}var a=e("bn.js"),s=e("hmac-drbg"),l=e("../utils"),p=e("../curves"),d=e("brorand"),g=l.assert,y=e("./key"),h=e("./signature");function u(f){if(!(this instanceof u))return new u(f);typeof f=="string"&&(g(p.hasOwnProperty(f),"Unknown curve "+f),f=p[f]),f instanceof p.PresetCurve&&(f={curve:f}),this.curve=f.curve.curve,this.n=this.curve.n,this.nh=this.n.ushrn(1),this.g=this.curve.g,this.g=f.curve.g,this.g.precompute(f.curve.n.bitLength()+1),this.hash=f.hash||f.curve.hash}n.exports=u,u.prototype.keyPair=function(f){return new y(this,f)},u.prototype.keyFromPrivate=function(f,c){return y.fromPrivate(this,f,c)},u.prototype.keyFromPublic=function(f,c){return y.fromPublic(this,f,c)},u.prototype.genKeyPair=function(f){f||(f={});for(var c=new s({hash:this.hash,pers:f.pers,persEnc:f.persEnc||"utf8",entropy:f.entropy||d(this.hash.hmacStrength),entropyEnc:f.entropy&&f.entropyEnc||"utf8",nonce:this.n.toArray()}),v=this.n.byteLength(),m=this.n.sub(new a(2));;){var b=new a(c.generate(v));if(!(b.cmp(m)>0))return b.iaddn(1),this.keyFromPrivate(b)}},u.prototype._truncateToN=function(f,c){var v=8*f.byteLength()-this.n.bitLength();return v>0&&(f=f.ushrn(v)),!c&&f.cmp(this.n)>=0?f.sub(this.n):f},u.prototype.sign=function(f,c,v,m){o(v)==="object"&&(m=v,v=null),m||(m={}),c=this.keyFromPrivate(c,v),f=this._truncateToN(new a(f,16));for(var b=this.n.byteLength(),w=c.getPrivate().toArray("be",b),_=f.toArray("be",b),C=new s({hash:this.hash,entropy:w,nonce:_,pers:m.pers,persEnc:m.persEnc||"utf8"}),R=this.n.sub(new a(1)),I=0;;I++){var P=m.k?m.k(I):new a(C.generate(this.n.byteLength()));if(!((P=this._truncateToN(P,!0)).cmpn(1)<=0||P.cmp(R)>=0)){var N=this.g.mul(P);if(!N.isInfinity()){var A=N.getX(),$=A.umod(this.n);if($.cmpn(0)!==0){var T=P.invm(this.n).mul($.mul(c.getPrivate()).iadd(f));if((T=T.umod(this.n)).cmpn(0)!==0){var M=(N.getY().isOdd()?1:0)|(A.cmp($)!==0?2:0);return m.canonical&&T.cmp(this.nh)>0&&(T=this.n.sub(T),M^=1),new h({r:$,s:T,recoveryParam:M})}}}}}},u.prototype.verify=function(f,c,v,m){f=this._truncateToN(new a(f,16)),v=this.keyFromPublic(v,m);var b=(c=new h(c,"hex")).r,w=c.s;if(b.cmpn(1)<0||b.cmp(this.n)>=0||w.cmpn(1)<0||w.cmp(this.n)>=0)return!1;var _,C=w.invm(this.n),R=C.mul(f).umod(this.n),I=C.mul(b).umod(this.n);return this.curve._maxwellTrick?!(_=this.g.jmulAdd(R,v.getPublic(),I)).isInfinity()&&_.eqXToP(b):!(_=this.g.mulAdd(R,v.getPublic(),I)).isInfinity()&&_.getX().umod(this.n).cmp(b)===0},u.prototype.recoverPubKey=function(f,c,v,m){g((3&v)===v,"The recovery param is more than two bits"),c=new h(c,m);var b=this.n,w=new a(f),_=c.r,C=c.s,R=1&v,I=v>>1;if(_.cmp(this.curve.p.umod(this.curve.n))>=0&&I)throw new Error("Unable to find sencond key candinate");_=I?this.curve.pointFromX(_.add(this.curve.n),R):this.curve.pointFromX(_,R);var P=c.r.invm(b),N=b.sub(w).mul(P).umod(b),A=C.mul(P).umod(b);return this.g.mulAdd(N,_,A)},u.prototype.getKeyRecoveryParam=function(f,c,v,m){if((c=new h(c,m)).recoveryParam!==null)return c.recoveryParam;for(var b=0;b<4;b++){var w;try{w=this.recoverPubKey(f,c,b)}catch{continue}if(w.eq(v))return b}throw new Error("Unable to find valid recovery factor")}},{"../curves":356,"../utils":364,"./key":358,"./signature":359,"bn.js":365,brorand:184,"hmac-drbg":384}],358:[function(e,n,i){var o=e("bn.js"),a=e("../utils").assert;function s(l,p){this.ec=l,this.priv=null,this.pub=null,p.priv&&this._importPrivate(p.priv,p.privEnc),p.pub&&this._importPublic(p.pub,p.pubEnc)}n.exports=s,s.fromPublic=function(l,p,d){return p instanceof s?p:new s(l,{pub:p,pubEnc:d})},s.fromPrivate=function(l,p,d){return p instanceof s?p:new s(l,{priv:p,privEnc:d})},s.prototype.validate=function(){var l=this.getPublic();return l.isInfinity()?{result:!1,reason:"Invalid public key"}:l.validate()?l.mul(this.ec.curve.n).isInfinity()?{result:!0,reason:null}:{result:!1,reason:"Public key * N != O"}:{result:!1,reason:"Public key is not a point"}},s.prototype.getPublic=function(l,p){return typeof l=="string"&&(p=l,l=null),this.pub||(this.pub=this.ec.g.mul(this.priv)),p?this.pub.encode(p,l):this.pub},s.prototype.getPrivate=function(l){return l==="hex"?this.priv.toString(16,2):this.priv},s.prototype._importPrivate=function(l,p){this.priv=new o(l,p||16),this.priv=this.priv.umod(this.ec.curve.n)},s.prototype._importPublic=function(l,p){if(l.x||l.y)return this.ec.curve.type==="mont"?a(l.x,"Need x coordinate"):this.ec.curve.type!=="short"&&this.ec.curve.type!=="edwards"||a(l.x&&l.y,"Need both x and y coordinate"),void(this.pub=this.ec.curve.point(l.x,l.y));this.pub=this.ec.curve.decodePoint(l,p)},s.prototype.derive=function(l){return l.mul(this.priv).getX()},s.prototype.sign=function(l,p,d){return this.ec.sign(l,this,p,d)},s.prototype.verify=function(l,p){return this.ec.verify(l,p,this)},s.prototype.inspect=function(){return"<Key priv: "+(this.priv&&this.priv.toString(16,2))+" pub: "+(this.pub&&this.pub.inspect())+" >"}},{"../utils":364,"bn.js":365}],359:[function(e,n,i){var o=e("bn.js"),a=e("../utils"),s=a.assert;function l(h,u){if(h instanceof l)return h;this._importDER(h,u)||(s(h.r&&h.s,"Signature without r or s"),this.r=new o(h.r,16),this.s=new o(h.s,16),h.recoveryParam===void 0?this.recoveryParam=null:this.recoveryParam=h.recoveryParam)}function p(){this.place=0}function d(h,u){var f=h[u.place++];if(!(128&f))return f;var c=15&f;if(c===0||c>4)return!1;for(var v=0,m=0,b=u.place;m<c;m++,b++)v<<=8,v|=h[b],v>>>=0;return!(v<=127)&&(u.place=b,v)}function g(h){for(var u=0,f=h.length-1;!h[u]&&!(128&h[u+1])&&u<f;)u++;return u===0?h:h.slice(u)}function y(h,u){if(u<128)h.push(u);else{var f=1+(Math.log(u)/Math.LN2>>>3);for(h.push(128|f);--f;)h.push(u>>>(f<<3)&255);h.push(u)}}n.exports=l,l.prototype._importDER=function(h,u){h=a.toArray(h,u);var f=new p;if(h[f.place++]!==48)return!1;var c=d(h,f);if(c===!1||c+f.place!==h.length||h[f.place++]!==2)return!1;var v=d(h,f);if(v===!1)return!1;var m=h.slice(f.place,v+f.place);if(f.place+=v,h[f.place++]!==2)return!1;var b=d(h,f);if(b===!1||h.length!==b+f.place)return!1;var w=h.slice(f.place,b+f.place);if(m[0]===0){if(!(128&m[1]))return!1;m=m.slice(1)}if(w[0]===0){if(!(128&w[1]))return!1;w=w.slice(1)}return this.r=new o(m),this.s=new o(w),this.recoveryParam=null,!0},l.prototype.toDER=function(h){var u=this.r.toArray(),f=this.s.toArray();for(128&u[0]&&(u=[0].concat(u)),128&f[0]&&(f=[0].concat(f)),u=g(u),f=g(f);!(f[0]||128&f[1]);)f=f.slice(1);var c=[2];y(c,u.length),(c=c.concat(u)).push(2),y(c,f.length);var v=c.concat(f),m=[48];return y(m,v.length),m=m.concat(v),a.encode(m,h)}},{"../utils":364,"bn.js":365}],360:[function(e,n,i){var o=e("hash.js"),a=e("../curves"),s=e("../utils"),l=s.assert,p=s.parseBytes,d=e("./key"),g=e("./signature");function y(h){if(l(h==="ed25519","only tested with ed25519 so far"),!(this instanceof y))return new y(h);h=a[h].curve,this.curve=h,this.g=h.g,this.g.precompute(h.n.bitLength()+1),this.pointClass=h.point().constructor,this.encodingLength=Math.ceil(h.n.bitLength()/8),this.hash=o.sha512}n.exports=y,y.prototype.sign=function(h,u){h=p(h);var f=this.keyFromSecret(u),c=this.hashInt(f.messagePrefix(),h),v=this.g.mul(c),m=this.encodePoint(v),b=this.hashInt(m,f.pubBytes(),h).mul(f.priv()),w=c.add(b).umod(this.curve.n);return this.makeSignature({R:v,S:w,Rencoded:m})},y.prototype.verify=function(h,u,f){h=p(h),u=this.makeSignature(u);var c=this.keyFromPublic(f),v=this.hashInt(u.Rencoded(),c.pubBytes(),h),m=this.g.mul(u.S());return u.R().add(c.pub().mul(v)).eq(m)},y.prototype.hashInt=function(){for(var h=this.hash(),u=0;u<arguments.length;u++)h.update(arguments[u]);return s.intFromLE(h.digest()).umod(this.curve.n)},y.prototype.keyFromPublic=function(h){return d.fromPublic(this,h)},y.prototype.keyFromSecret=function(h){return d.fromSecret(this,h)},y.prototype.makeSignature=function(h){return h instanceof g?h:new g(this,h)},y.prototype.encodePoint=function(h){var u=h.getY().toArray("le",this.encodingLength);return u[this.encodingLength-1]|=h.getX().isOdd()?128:0,u},y.prototype.decodePoint=function(h){var u=(h=s.parseBytes(h)).length-1,f=h.slice(0,u).concat(-129&h[u]),c=(128&h[u])!=0,v=s.intFromLE(f);return this.curve.pointFromY(v,c)},y.prototype.encodeInt=function(h){return h.toArray("le",this.encodingLength)},y.prototype.decodeInt=function(h){return s.intFromLE(h)},y.prototype.isPoint=function(h){return h instanceof this.pointClass}},{"../curves":356,"../utils":364,"./key":361,"./signature":362,"hash.js":372}],361:[function(e,n,i){var o=e("../utils"),a=o.assert,s=o.parseBytes,l=o.cachedProperty;function p(d,g){this.eddsa=d,this._secret=s(g.secret),d.isPoint(g.pub)?this._pub=g.pub:this._pubBytes=s(g.pub)}p.fromPublic=function(d,g){return g instanceof p?g:new p(d,{pub:g})},p.fromSecret=function(d,g){return g instanceof p?g:new p(d,{secret:g})},p.prototype.secret=function(){return this._secret},l(p,"pubBytes",function(){return this.eddsa.encodePoint(this.pub())}),l(p,"pub",function(){return this._pubBytes?this.eddsa.decodePoint(this._pubBytes):this.eddsa.g.mul(this.priv())}),l(p,"privBytes",function(){var d=this.eddsa,g=this.hash(),y=d.encodingLength-1,h=g.slice(0,d.encodingLength);return h[0]&=248,h[y]&=127,h[y]|=64,h}),l(p,"priv",function(){return this.eddsa.decodeInt(this.privBytes())}),l(p,"hash",function(){return this.eddsa.hash().update(this.secret()).digest()}),l(p,"messagePrefix",function(){return this.hash().slice(this.eddsa.encodingLength)}),p.prototype.sign=function(d){return a(this._secret,"KeyPair can only verify"),this.eddsa.sign(d,this)},p.prototype.verify=function(d,g){return this.eddsa.verify(d,g,this)},p.prototype.getSecret=function(d){return a(this._secret,"KeyPair is public only"),o.encode(this.secret(),d)},p.prototype.getPublic=function(d){return o.encode(this.pubBytes(),d)},n.exports=p},{"../utils":364}],362:[function(e,n,i){function o(y){return(o=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(h){return typeof h}:function(h){return h&&typeof Symbol=="function"&&h.constructor===Symbol&&h!==Symbol.prototype?"symbol":typeof h})(y)}var a=e("bn.js"),s=e("../utils"),l=s.assert,p=s.cachedProperty,d=s.parseBytes;function g(y,h){this.eddsa=y,o(h)!=="object"&&(h=d(h)),Array.isArray(h)&&(h={R:h.slice(0,y.encodingLength),S:h.slice(y.encodingLength)}),l(h.R&&h.S,"Signature without R or S"),y.isPoint(h.R)&&(this._R=h.R),h.S instanceof a&&(this._S=h.S),this._Rencoded=Array.isArray(h.R)?h.R:h.Rencoded,this._Sencoded=Array.isArray(h.S)?h.S:h.Sencoded}p(g,"S",function(){return this.eddsa.decodeInt(this.Sencoded())}),p(g,"R",function(){return this.eddsa.decodePoint(this.Rencoded())}),p(g,"Rencoded",function(){return this.eddsa.encodePoint(this.R())}),p(g,"Sencoded",function(){return this.eddsa.encodeInt(this.S())}),g.prototype.toBytes=function(){return this.Rencoded().concat(this.Sencoded())},g.prototype.toHex=function(){return s.encode(this.toBytes(),"hex").toUpperCase()},n.exports=g},{"../utils":364,"bn.js":365}],363:[function(e,n,i){n.exports={doubles:{step:4,points:[["e60fce93b59e9ec53011aabc21c23e97b2a31369b87a5ae9c44ee89e2a6dec0a","f7e3507399e595929db99f34f57937101296891e44d23f0be1f32cce69616821"],["8282263212c609d9ea2a6e3e172de238d8c39cabd5ac1ca10646e23fd5f51508","11f8a8098557dfe45e8256e830b60ace62d613ac2f7b17bed31b6eaff6e26caf"],["175e159f728b865a72f99cc6c6fc846de0b93833fd2222ed73fce5b551e5b739","d3506e0d9e3c79eba4ef97a51ff71f5eacb5955add24345c6efa6ffee9fed695"],["363d90d447b00c9c99ceac05b6262ee053441c7e55552ffe526bad8f83ff4640","4e273adfc732221953b445397f3363145b9a89008199ecb62003c7f3bee9de9"],["8b4b5f165df3c2be8c6244b5b745638843e4a781a15bcd1b69f79a55dffdf80c","4aad0a6f68d308b4b3fbd7813ab0da04f9e336546162ee56b3eff0c65fd4fd36"],["723cbaa6e5db996d6bf771c00bd548c7b700dbffa6c0e77bcb6115925232fcda","96e867b5595cc498a921137488824d6e2660a0653779494801dc069d9eb39f5f"],["eebfa4d493bebf98ba5feec812c2d3b50947961237a919839a533eca0e7dd7fa","5d9a8ca3970ef0f269ee7edaf178089d9ae4cdc3a711f712ddfd4fdae1de8999"],["100f44da696e71672791d0a09b7bde459f1215a29b3c03bfefd7835b39a48db0","cdd9e13192a00b772ec8f3300c090666b7ff4a18ff5195ac0fbd5cd62bc65a09"],["e1031be262c7ed1b1dc9227a4a04c017a77f8d4464f3b3852c8acde6e534fd2d","9d7061928940405e6bb6a4176597535af292dd419e1ced79a44f18f29456a00d"],["feea6cae46d55b530ac2839f143bd7ec5cf8b266a41d6af52d5e688d9094696d","e57c6b6c97dce1bab06e4e12bf3ecd5c981c8957cc41442d3155debf18090088"],["da67a91d91049cdcb367be4be6ffca3cfeed657d808583de33fa978bc1ec6cb1","9bacaa35481642bc41f463f7ec9780e5dec7adc508f740a17e9ea8e27a68be1d"],["53904faa0b334cdda6e000935ef22151ec08d0f7bb11069f57545ccc1a37b7c0","5bc087d0bc80106d88c9eccac20d3c1c13999981e14434699dcb096b022771c8"],["8e7bcd0bd35983a7719cca7764ca906779b53a043a9b8bcaeff959f43ad86047","10b7770b2a3da4b3940310420ca9514579e88e2e47fd68b3ea10047e8460372a"],["385eed34c1cdff21e6d0818689b81bde71a7f4f18397e6690a841e1599c43862","283bebc3e8ea23f56701de19e9ebf4576b304eec2086dc8cc0458fe5542e5453"],["6f9d9b803ecf191637c73a4413dfa180fddf84a5947fbc9c606ed86c3fac3a7","7c80c68e603059ba69b8e2a30e45c4d47ea4dd2f5c281002d86890603a842160"],["3322d401243c4e2582a2147c104d6ecbf774d163db0f5e5313b7e0e742d0e6bd","56e70797e9664ef5bfb019bc4ddaf9b72805f63ea2873af624f3a2e96c28b2a0"],["85672c7d2de0b7da2bd1770d89665868741b3f9af7643397721d74d28134ab83","7c481b9b5b43b2eb6374049bfa62c2e5e77f17fcc5298f44c8e3094f790313a6"],["948bf809b1988a46b06c9f1919413b10f9226c60f668832ffd959af60c82a0a","53a562856dcb6646dc6b74c5d1c3418c6d4dff08c97cd2bed4cb7f88d8c8e589"],["6260ce7f461801c34f067ce0f02873a8f1b0e44dfc69752accecd819f38fd8e8","bc2da82b6fa5b571a7f09049776a1ef7ecd292238051c198c1a84e95b2b4ae17"],["e5037de0afc1d8d43d8348414bbf4103043ec8f575bfdc432953cc8d2037fa2d","4571534baa94d3b5f9f98d09fb990bddbd5f5b03ec481f10e0e5dc841d755bda"],["e06372b0f4a207adf5ea905e8f1771b4e7e8dbd1c6a6c5b725866a0ae4fce725","7a908974bce18cfe12a27bb2ad5a488cd7484a7787104870b27034f94eee31dd"],["213c7a715cd5d45358d0bbf9dc0ce02204b10bdde2a3f58540ad6908d0559754","4b6dad0b5ae462507013ad06245ba190bb4850f5f36a7eeddff2c27534b458f2"],["4e7c272a7af4b34e8dbb9352a5419a87e2838c70adc62cddf0cc3a3b08fbd53c","17749c766c9d0b18e16fd09f6def681b530b9614bff7dd33e0b3941817dcaae6"],["fea74e3dbe778b1b10f238ad61686aa5c76e3db2be43057632427e2840fb27b6","6e0568db9b0b13297cf674deccb6af93126b596b973f7b77701d3db7f23cb96f"],["76e64113f677cf0e10a2570d599968d31544e179b760432952c02a4417bdde39","c90ddf8dee4e95cf577066d70681f0d35e2a33d2b56d2032b4b1752d1901ac01"],["c738c56b03b2abe1e8281baa743f8f9a8f7cc643df26cbee3ab150242bcbb891","893fb578951ad2537f718f2eacbfbbbb82314eef7880cfe917e735d9699a84c3"],["d895626548b65b81e264c7637c972877d1d72e5f3a925014372e9f6588f6c14b","febfaa38f2bc7eae728ec60818c340eb03428d632bb067e179363ed75d7d991f"],["b8da94032a957518eb0f6433571e8761ceffc73693e84edd49150a564f676e03","2804dfa44805a1e4d7c99cc9762808b092cc584d95ff3b511488e4e74efdf6e7"],["e80fea14441fb33a7d8adab9475d7fab2019effb5156a792f1a11778e3c0df5d","eed1de7f638e00771e89768ca3ca94472d155e80af322ea9fcb4291b6ac9ec78"],["a301697bdfcd704313ba48e51d567543f2a182031efd6915ddc07bbcc4e16070","7370f91cfb67e4f5081809fa25d40f9b1735dbf7c0a11a130c0d1a041e177ea1"],["90ad85b389d6b936463f9d0512678de208cc330b11307fffab7ac63e3fb04ed4","e507a3620a38261affdcbd9427222b839aefabe1582894d991d4d48cb6ef150"],["8f68b9d2f63b5f339239c1ad981f162ee88c5678723ea3351b7b444c9ec4c0da","662a9f2dba063986de1d90c2b6be215dbbea2cfe95510bfdf23cbf79501fff82"],["e4f3fb0176af85d65ff99ff9198c36091f48e86503681e3e6686fd5053231e11","1e63633ad0ef4f1c1661a6d0ea02b7286cc7e74ec951d1c9822c38576feb73bc"],["8c00fa9b18ebf331eb961537a45a4266c7034f2f0d4e1d0716fb6eae20eae29e","efa47267fea521a1a9dc343a3736c974c2fadafa81e36c54e7d2a4c66702414b"],["e7a26ce69dd4829f3e10cec0a9e98ed3143d084f308b92c0997fddfc60cb3e41","2a758e300fa7984b471b006a1aafbb18d0a6b2c0420e83e20e8a9421cf2cfd51"],["b6459e0ee3662ec8d23540c223bcbdc571cbcb967d79424f3cf29eb3de6b80ef","67c876d06f3e06de1dadf16e5661db3c4b3ae6d48e35b2ff30bf0b61a71ba45"],["d68a80c8280bb840793234aa118f06231d6f1fc67e73c5a5deda0f5b496943e8","db8ba9fff4b586d00c4b1f9177b0e28b5b0e7b8f7845295a294c84266b133120"],["324aed7df65c804252dc0270907a30b09612aeb973449cea4095980fc28d3d5d","648a365774b61f2ff130c0c35aec1f4f19213b0c7e332843967224af96ab7c84"],["4df9c14919cde61f6d51dfdbe5fee5dceec4143ba8d1ca888e8bd373fd054c96","35ec51092d8728050974c23a1d85d4b5d506cdc288490192ebac06cad10d5d"],["9c3919a84a474870faed8a9c1cc66021523489054d7f0308cbfc99c8ac1f98cd","ddb84f0f4a4ddd57584f044bf260e641905326f76c64c8e6be7e5e03d4fc599d"],["6057170b1dd12fdf8de05f281d8e06bb91e1493a8b91d4cc5a21382120a959e5","9a1af0b26a6a4807add9a2daf71df262465152bc3ee24c65e899be932385a2a8"],["a576df8e23a08411421439a4518da31880cef0fba7d4df12b1a6973eecb94266","40a6bf20e76640b2c92b97afe58cd82c432e10a7f514d9f3ee8be11ae1b28ec8"],["7778a78c28dec3e30a05fe9629de8c38bb30d1f5cf9a3a208f763889be58ad71","34626d9ab5a5b22ff7098e12f2ff580087b38411ff24ac563b513fc1fd9f43ac"],["928955ee637a84463729fd30e7afd2ed5f96274e5ad7e5cb09eda9c06d903ac","c25621003d3f42a827b78a13093a95eeac3d26efa8a8d83fc5180e935bcd091f"],["85d0fef3ec6db109399064f3a0e3b2855645b4a907ad354527aae75163d82751","1f03648413a38c0be29d496e582cf5663e8751e96877331582c237a24eb1f962"],["ff2b0dce97eece97c1c9b6041798b85dfdfb6d8882da20308f5404824526087e","493d13fef524ba188af4c4dc54d07936c7b7ed6fb90e2ceb2c951e01f0c29907"],["827fbbe4b1e880ea9ed2b2e6301b212b57f1ee148cd6dd28780e5e2cf856e241","c60f9c923c727b0b71bef2c67d1d12687ff7a63186903166d605b68baec293ec"],["eaa649f21f51bdbae7be4ae34ce6e5217a58fdce7f47f9aa7f3b58fa2120e2b3","be3279ed5bbbb03ac69a80f89879aa5a01a6b965f13f7e59d47a5305ba5ad93d"],["e4a42d43c5cf169d9391df6decf42ee541b6d8f0c9a137401e23632dda34d24f","4d9f92e716d1c73526fc99ccfb8ad34ce886eedfa8d8e4f13a7f7131deba9414"],["1ec80fef360cbdd954160fadab352b6b92b53576a88fea4947173b9d4300bf19","aeefe93756b5340d2f3a4958a7abbf5e0146e77f6295a07b671cdc1cc107cefd"],["146a778c04670c2f91b00af4680dfa8bce3490717d58ba889ddb5928366642be","b318e0ec3354028add669827f9d4b2870aaa971d2f7e5ed1d0b297483d83efd0"],["fa50c0f61d22e5f07e3acebb1aa07b128d0012209a28b9776d76a8793180eef9","6b84c6922397eba9b72cd2872281a68a5e683293a57a213b38cd8d7d3f4f2811"],["da1d61d0ca721a11b1a5bf6b7d88e8421a288ab5d5bba5220e53d32b5f067ec2","8157f55a7c99306c79c0766161c91e2966a73899d279b48a655fba0f1ad836f1"],["a8e282ff0c9706907215ff98e8fd416615311de0446f1e062a73b0610d064e13","7f97355b8db81c09abfb7f3c5b2515888b679a3e50dd6bd6cef7c73111f4cc0c"],["174a53b9c9a285872d39e56e6913cab15d59b1fa512508c022f382de8319497c","ccc9dc37abfc9c1657b4155f2c47f9e6646b3a1d8cb9854383da13ac079afa73"],["959396981943785c3d3e57edf5018cdbe039e730e4918b3d884fdff09475b7ba","2e7e552888c331dd8ba0386a4b9cd6849c653f64c8709385e9b8abf87524f2fd"],["d2a63a50ae401e56d645a1153b109a8fcca0a43d561fba2dbb51340c9d82b151","e82d86fb6443fcb7565aee58b2948220a70f750af484ca52d4142174dcf89405"],["64587e2335471eb890ee7896d7cfdc866bacbdbd3839317b3436f9b45617e073","d99fcdd5bf6902e2ae96dd6447c299a185b90a39133aeab358299e5e9faf6589"],["8481bde0e4e4d885b3a546d3e549de042f0aa6cea250e7fd358d6c86dd45e458","38ee7b8cba5404dd84a25bf39cecb2ca900a79c42b262e556d64b1b59779057e"],["13464a57a78102aa62b6979ae817f4637ffcfed3c4b1ce30bcd6303f6caf666b","69be159004614580ef7e433453ccb0ca48f300a81d0942e13f495a907f6ecc27"],["bc4a9df5b713fe2e9aef430bcc1dc97a0cd9ccede2f28588cada3a0d2d83f366","d3a81ca6e785c06383937adf4b798caa6e8a9fbfa547b16d758d666581f33c1"],["8c28a97bf8298bc0d23d8c749452a32e694b65e30a9472a3954ab30fe5324caa","40a30463a3305193378fedf31f7cc0eb7ae784f0451cb9459e71dc73cbef9482"],["8ea9666139527a8c1dd94ce4f071fd23c8b350c5a4bb33748c4ba111faccae0","620efabbc8ee2782e24e7c0cfb95c5d735b783be9cf0f8e955af34a30e62b945"],["dd3625faef5ba06074669716bbd3788d89bdde815959968092f76cc4eb9a9787","7a188fa3520e30d461da2501045731ca941461982883395937f68d00c644a573"],["f710d79d9eb962297e4f6232b40e8f7feb2bc63814614d692c12de752408221e","ea98e67232d3b3295d3b535532115ccac8612c721851617526ae47a9c77bfc82"]]},naf:{wnd:7,points:[["f9308a019258c31049344f85f89d5229b531c845836f99b08601f113bce036f9","388f7b0f632de8140fe337e62a37f3566500a99934c2231b6cb9fd7584b8e672"],["2f8bde4d1a07209355b4a7250a5c5128e88b84bddc619ab7cba8d569b240efe4","d8ac222636e5e3d6d4dba9dda6c9c426f788271bab0d6840dca87d3aa6ac62d6"],["5cbdf0646e5db4eaa398f365f2ea7a0e3d419b7e0330e39ce92bddedcac4f9bc","6aebca40ba255960a3178d6d861a54dba813d0b813fde7b5a5082628087264da"],["acd484e2f0c7f65309ad178a9f559abde09796974c57e714c35f110dfc27ccbe","cc338921b0a7d9fd64380971763b61e9add888a4375f8e0f05cc262ac64f9c37"],["774ae7f858a9411e5ef4246b70c65aac5649980be5c17891bbec17895da008cb","d984a032eb6b5e190243dd56d7b7b365372db1e2dff9d6a8301d74c9c953c61b"],["f28773c2d975288bc7d1d205c3748651b075fbc6610e58cddeeddf8f19405aa8","ab0902e8d880a89758212eb65cdaf473a1a06da521fa91f29b5cb52db03ed81"],["d7924d4f7d43ea965a465ae3095ff41131e5946f3c85f79e44adbcf8e27e080e","581e2872a86c72a683842ec228cc6defea40af2bd896d3a5c504dc9ff6a26b58"],["defdea4cdb677750a420fee807eacf21eb9898ae79b9768766e4faa04a2d4a34","4211ab0694635168e997b0ead2a93daeced1f4a04a95c0f6cfb199f69e56eb77"],["2b4ea0a797a443d293ef5cff444f4979f06acfebd7e86d277475656138385b6c","85e89bc037945d93b343083b5a1c86131a01f60c50269763b570c854e5c09b7a"],["352bbf4a4cdd12564f93fa332ce333301d9ad40271f8107181340aef25be59d5","321eb4075348f534d59c18259dda3e1f4a1b3b2e71b1039c67bd3d8bcf81998c"],["2fa2104d6b38d11b0230010559879124e42ab8dfeff5ff29dc9cdadd4ecacc3f","2de1068295dd865b64569335bd5dd80181d70ecfc882648423ba76b532b7d67"],["9248279b09b4d68dab21a9b066edda83263c3d84e09572e269ca0cd7f5453714","73016f7bf234aade5d1aa71bdea2b1ff3fc0de2a887912ffe54a32ce97cb3402"],["daed4f2be3a8bf278e70132fb0beb7522f570e144bf615c07e996d443dee8729","a69dce4a7d6c98e8d4a1aca87ef8d7003f83c230f3afa726ab40e52290be1c55"],["c44d12c7065d812e8acf28d7cbb19f9011ecd9e9fdf281b0e6a3b5e87d22e7db","2119a460ce326cdc76c45926c982fdac0e106e861edf61c5a039063f0e0e6482"],["6a245bf6dc698504c89a20cfded60853152b695336c28063b61c65cbd269e6b4","e022cf42c2bd4a708b3f5126f16a24ad8b33ba48d0423b6efd5e6348100d8a82"],["1697ffa6fd9de627c077e3d2fe541084ce13300b0bec1146f95ae57f0d0bd6a5","b9c398f186806f5d27561506e4557433a2cf15009e498ae7adee9d63d01b2396"],["605bdb019981718b986d0f07e834cb0d9deb8360ffb7f61df982345ef27a7479","2972d2de4f8d20681a78d93ec96fe23c26bfae84fb14db43b01e1e9056b8c49"],["62d14dab4150bf497402fdc45a215e10dcb01c354959b10cfe31c7e9d87ff33d","80fc06bd8cc5b01098088a1950eed0db01aa132967ab472235f5642483b25eaf"],["80c60ad0040f27dade5b4b06c408e56b2c50e9f56b9b8b425e555c2f86308b6f","1c38303f1cc5c30f26e66bad7fe72f70a65eed4cbe7024eb1aa01f56430bd57a"],["7a9375ad6167ad54aa74c6348cc54d344cc5dc9487d847049d5eabb0fa03c8fb","d0e3fa9eca8726909559e0d79269046bdc59ea10c70ce2b02d499ec224dc7f7"],["d528ecd9b696b54c907a9ed045447a79bb408ec39b68df504bb51f459bc3ffc9","eecf41253136e5f99966f21881fd656ebc4345405c520dbc063465b521409933"],["49370a4b5f43412ea25f514e8ecdad05266115e4a7ecb1387231808f8b45963","758f3f41afd6ed428b3081b0512fd62a54c3f3afbb5b6764b653052a12949c9a"],["77f230936ee88cbbd73df930d64702ef881d811e0e1498e2f1c13eb1fc345d74","958ef42a7886b6400a08266e9ba1b37896c95330d97077cbbe8eb3c7671c60d6"],["f2dac991cc4ce4b9ea44887e5c7c0bce58c80074ab9d4dbaeb28531b7739f530","e0dedc9b3b2f8dad4da1f32dec2531df9eb5fbeb0598e4fd1a117dba703a3c37"],["463b3d9f662621fb1b4be8fbbe2520125a216cdfc9dae3debcba4850c690d45b","5ed430d78c296c3543114306dd8622d7c622e27c970a1de31cb377b01af7307e"],["f16f804244e46e2a09232d4aff3b59976b98fac14328a2d1a32496b49998f247","cedabd9b82203f7e13d206fcdf4e33d92a6c53c26e5cce26d6579962c4e31df6"],["caf754272dc84563b0352b7a14311af55d245315ace27c65369e15f7151d41d1","cb474660ef35f5f2a41b643fa5e460575f4fa9b7962232a5c32f908318a04476"],["2600ca4b282cb986f85d0f1709979d8b44a09c07cb86d7c124497bc86f082120","4119b88753c15bd6a693b03fcddbb45d5ac6be74ab5f0ef44b0be9475a7e4b40"],["7635ca72d7e8432c338ec53cd12220bc01c48685e24f7dc8c602a7746998e435","91b649609489d613d1d5e590f78e6d74ecfc061d57048bad9e76f302c5b9c61"],["754e3239f325570cdbbf4a87deee8a66b7f2b33479d468fbc1a50743bf56cc18","673fb86e5bda30fb3cd0ed304ea49a023ee33d0197a695d0c5d98093c536683"],["e3e6bd1071a1e96aff57859c82d570f0330800661d1c952f9fe2694691d9b9e8","59c9e0bba394e76f40c0aa58379a3cb6a5a2283993e90c4167002af4920e37f5"],["186b483d056a033826ae73d88f732985c4ccb1f32ba35f4b4cc47fdcf04aa6eb","3b952d32c67cf77e2e17446e204180ab21fb8090895138b4a4a797f86e80888b"],["df9d70a6b9876ce544c98561f4be4f725442e6d2b737d9c91a8321724ce0963f","55eb2dafd84d6ccd5f862b785dc39d4ab157222720ef9da217b8c45cf2ba2417"],["5edd5cc23c51e87a497ca815d5dce0f8ab52554f849ed8995de64c5f34ce7143","efae9c8dbc14130661e8cec030c89ad0c13c66c0d17a2905cdc706ab7399a868"],["290798c2b6476830da12fe02287e9e777aa3fba1c355b17a722d362f84614fba","e38da76dcd440621988d00bcf79af25d5b29c094db2a23146d003afd41943e7a"],["af3c423a95d9f5b3054754efa150ac39cd29552fe360257362dfdecef4053b45","f98a3fd831eb2b749a93b0e6f35cfb40c8cd5aa667a15581bc2feded498fd9c6"],["766dbb24d134e745cccaa28c99bf274906bb66b26dcf98df8d2fed50d884249a","744b1152eacbe5e38dcc887980da38b897584a65fa06cedd2c924f97cbac5996"],["59dbf46f8c94759ba21277c33784f41645f7b44f6c596a58ce92e666191abe3e","c534ad44175fbc300f4ea6ce648309a042ce739a7919798cd85e216c4a307f6e"],["f13ada95103c4537305e691e74e9a4a8dd647e711a95e73cb62dc6018cfd87b8","e13817b44ee14de663bf4bc808341f326949e21a6a75c2570778419bdaf5733d"],["7754b4fa0e8aced06d4167a2c59cca4cda1869c06ebadfb6488550015a88522c","30e93e864e669d82224b967c3020b8fa8d1e4e350b6cbcc537a48b57841163a2"],["948dcadf5990e048aa3874d46abef9d701858f95de8041d2a6828c99e2262519","e491a42537f6e597d5d28a3224b1bc25df9154efbd2ef1d2cbba2cae5347d57e"],["7962414450c76c1689c7b48f8202ec37fb224cf5ac0bfa1570328a8a3d7c77ab","100b610ec4ffb4760d5c1fc133ef6f6b12507a051f04ac5760afa5b29db83437"],["3514087834964b54b15b160644d915485a16977225b8847bb0dd085137ec47ca","ef0afbb2056205448e1652c48e8127fc6039e77c15c2378b7e7d15a0de293311"],["d3cc30ad6b483e4bc79ce2c9dd8bc54993e947eb8df787b442943d3f7b527eaf","8b378a22d827278d89c5e9be8f9508ae3c2ad46290358630afb34db04eede0a4"],["1624d84780732860ce1c78fcbfefe08b2b29823db913f6493975ba0ff4847610","68651cf9b6da903e0914448c6cd9d4ca896878f5282be4c8cc06e2a404078575"],["733ce80da955a8a26902c95633e62a985192474b5af207da6df7b4fd5fc61cd4","f5435a2bd2badf7d485a4d8b8db9fcce3e1ef8e0201e4578c54673bc1dc5ea1d"],["15d9441254945064cf1a1c33bbd3b49f8966c5092171e699ef258dfab81c045c","d56eb30b69463e7234f5137b73b84177434800bacebfc685fc37bbe9efe4070d"],["a1d0fcf2ec9de675b612136e5ce70d271c21417c9d2b8aaaac138599d0717940","edd77f50bcb5a3cab2e90737309667f2641462a54070f3d519212d39c197a629"],["e22fbe15c0af8ccc5780c0735f84dbe9a790badee8245c06c7ca37331cb36980","a855babad5cd60c88b430a69f53a1a7a38289154964799be43d06d77d31da06"],["311091dd9860e8e20ee13473c1155f5f69635e394704eaa74009452246cfa9b3","66db656f87d1f04fffd1f04788c06830871ec5a64feee685bd80f0b1286d8374"],["34c1fd04d301be89b31c0442d3e6ac24883928b45a9340781867d4232ec2dbdf","9414685e97b1b5954bd46f730174136d57f1ceeb487443dc5321857ba73abee"],["f219ea5d6b54701c1c14de5b557eb42a8d13f3abbcd08affcc2a5e6b049b8d63","4cb95957e83d40b0f73af4544cccf6b1f4b08d3c07b27fb8d8c2962a400766d1"],["d7b8740f74a8fbaab1f683db8f45de26543a5490bca627087236912469a0b448","fa77968128d9c92ee1010f337ad4717eff15db5ed3c049b3411e0315eaa4593b"],["32d31c222f8f6f0ef86f7c98d3a3335ead5bcd32abdd94289fe4d3091aa824bf","5f3032f5892156e39ccd3d7915b9e1da2e6dac9e6f26e961118d14b8462e1661"],["7461f371914ab32671045a155d9831ea8793d77cd59592c4340f86cbc18347b5","8ec0ba238b96bec0cbdddcae0aa442542eee1ff50c986ea6b39847b3cc092ff6"],["ee079adb1df1860074356a25aa38206a6d716b2c3e67453d287698bad7b2b2d6","8dc2412aafe3be5c4c5f37e0ecc5f9f6a446989af04c4e25ebaac479ec1c8c1e"],["16ec93e447ec83f0467b18302ee620f7e65de331874c9dc72bfd8616ba9da6b5","5e4631150e62fb40d0e8c2a7ca5804a39d58186a50e497139626778e25b0674d"],["eaa5f980c245f6f038978290afa70b6bd8855897f98b6aa485b96065d537bd99","f65f5d3e292c2e0819a528391c994624d784869d7e6ea67fb18041024edc07dc"],["78c9407544ac132692ee1910a02439958ae04877151342ea96c4b6b35a49f51","f3e0319169eb9b85d5404795539a5e68fa1fbd583c064d2462b675f194a3ddb4"],["494f4be219a1a77016dcd838431aea0001cdc8ae7a6fc688726578d9702857a5","42242a969283a5f339ba7f075e36ba2af925ce30d767ed6e55f4b031880d562c"],["a598a8030da6d86c6bc7f2f5144ea549d28211ea58faa70ebf4c1e665c1fe9b5","204b5d6f84822c307e4b4a7140737aec23fc63b65b35f86a10026dbd2d864e6b"],["c41916365abb2b5d09192f5f2dbeafec208f020f12570a184dbadc3e58595997","4f14351d0087efa49d245b328984989d5caf9450f34bfc0ed16e96b58fa9913"],["841d6063a586fa475a724604da03bc5b92a2e0d2e0a36acfe4c73a5514742881","73867f59c0659e81904f9a1c7543698e62562d6744c169ce7a36de01a8d6154"],["5e95bb399a6971d376026947f89bde2f282b33810928be4ded112ac4d70e20d5","39f23f366809085beebfc71181313775a99c9aed7d8ba38b161384c746012865"],["36e4641a53948fd476c39f8a99fd974e5ec07564b5315d8bf99471bca0ef2f66","d2424b1b1abe4eb8164227b085c9aa9456ea13493fd563e06fd51cf5694c78fc"],["336581ea7bfbbb290c191a2f507a41cf5643842170e914faeab27c2c579f726","ead12168595fe1be99252129b6e56b3391f7ab1410cd1e0ef3dcdcabd2fda224"],["8ab89816dadfd6b6a1f2634fcf00ec8403781025ed6890c4849742706bd43ede","6fdcef09f2f6d0a044e654aef624136f503d459c3e89845858a47a9129cdd24e"],["1e33f1a746c9c5778133344d9299fcaa20b0938e8acff2544bb40284b8c5fb94","60660257dd11b3aa9c8ed618d24edff2306d320f1d03010e33a7d2057f3b3b6"],["85b7c1dcb3cec1b7ee7f30ded79dd20a0ed1f4cc18cbcfcfa410361fd8f08f31","3d98a9cdd026dd43f39048f25a8847f4fcafad1895d7a633c6fed3c35e999511"],["29df9fbd8d9e46509275f4b125d6d45d7fbe9a3b878a7af872a2800661ac5f51","b4c4fe99c775a606e2d8862179139ffda61dc861c019e55cd2876eb2a27d84b"],["a0b1cae06b0a847a3fea6e671aaf8adfdfe58ca2f768105c8082b2e449fce252","ae434102edde0958ec4b19d917a6a28e6b72da1834aff0e650f049503a296cf2"],["4e8ceafb9b3e9a136dc7ff67e840295b499dfb3b2133e4ba113f2e4c0e121e5","cf2174118c8b6d7a4b48f6d534ce5c79422c086a63460502b827ce62a326683c"],["d24a44e047e19b6f5afb81c7ca2f69080a5076689a010919f42725c2b789a33b","6fb8d5591b466f8fc63db50f1c0f1c69013f996887b8244d2cdec417afea8fa3"],["ea01606a7a6c9cdd249fdfcfacb99584001edd28abbab77b5104e98e8e3b35d4","322af4908c7312b0cfbfe369f7a7b3cdb7d4494bc2823700cfd652188a3ea98d"],["af8addbf2b661c8a6c6328655eb96651252007d8c5ea31be4ad196de8ce2131f","6749e67c029b85f52a034eafd096836b2520818680e26ac8f3dfbcdb71749700"],["e3ae1974566ca06cc516d47e0fb165a674a3dabcfca15e722f0e3450f45889","2aeabe7e4531510116217f07bf4d07300de97e4874f81f533420a72eeb0bd6a4"],["591ee355313d99721cf6993ffed1e3e301993ff3ed258802075ea8ced397e246","b0ea558a113c30bea60fc4775460c7901ff0b053d25ca2bdeee98f1a4be5d196"],["11396d55fda54c49f19aa97318d8da61fa8584e47b084945077cf03255b52984","998c74a8cd45ac01289d5833a7beb4744ff536b01b257be4c5767bea93ea57a4"],["3c5d2a1ba39c5a1790000738c9e0c40b8dcdfd5468754b6405540157e017aa7a","b2284279995a34e2f9d4de7396fc18b80f9b8b9fdd270f6661f79ca4c81bd257"],["cc8704b8a60a0defa3a99a7299f2e9c3fbc395afb04ac078425ef8a1793cc030","bdd46039feed17881d1e0862db347f8cf395b74fc4bcdc4e940b74e3ac1f1b13"],["c533e4f7ea8555aacd9777ac5cad29b97dd4defccc53ee7ea204119b2889b197","6f0a256bc5efdf429a2fb6242f1a43a2d9b925bb4a4b3a26bb8e0f45eb596096"],["c14f8f2ccb27d6f109f6d08d03cc96a69ba8c34eec07bbcf566d48e33da6593","c359d6923bb398f7fd4473e16fe1c28475b740dd098075e6c0e8649113dc3a38"],["a6cbc3046bc6a450bac24789fa17115a4c9739ed75f8f21ce441f72e0b90e6ef","21ae7f4680e889bb130619e2c0f95a360ceb573c70603139862afd617fa9b9f"],["347d6d9a02c48927ebfb86c1359b1caf130a3c0267d11ce6344b39f99d43cc38","60ea7f61a353524d1c987f6ecec92f086d565ab687870cb12689ff1e31c74448"],["da6545d2181db8d983f7dcb375ef5866d47c67b1bf31c8cf855ef7437b72656a","49b96715ab6878a79e78f07ce5680c5d6673051b4935bd897fea824b77dc208a"],["c40747cc9d012cb1a13b8148309c6de7ec25d6945d657146b9d5994b8feb1111","5ca560753be2a12fc6de6caf2cb489565db936156b9514e1bb5e83037e0fa2d4"],["4e42c8ec82c99798ccf3a610be870e78338c7f713348bd34c8203ef4037f3502","7571d74ee5e0fb92a7a8b33a07783341a5492144cc54bcc40a94473693606437"],["3775ab7089bc6af823aba2e1af70b236d251cadb0c86743287522a1b3b0dedea","be52d107bcfa09d8bcb9736a828cfa7fac8db17bf7a76a2c42ad961409018cf7"],["cee31cbf7e34ec379d94fb814d3d775ad954595d1314ba8846959e3e82f74e26","8fd64a14c06b589c26b947ae2bcf6bfa0149ef0be14ed4d80f448a01c43b1c6d"],["b4f9eaea09b6917619f6ea6a4eb5464efddb58fd45b1ebefcdc1a01d08b47986","39e5c9925b5a54b07433a4f18c61726f8bb131c012ca542eb24a8ac07200682a"],["d4263dfc3d2df923a0179a48966d30ce84e2515afc3dccc1b77907792ebcc60e","62dfaf07a0f78feb30e30d6295853ce189e127760ad6cf7fae164e122a208d54"],["48457524820fa65a4f8d35eb6930857c0032acc0a4a2de422233eeda897612c4","25a748ab367979d98733c38a1fa1c2e7dc6cc07db2d60a9ae7a76aaa49bd0f77"],["dfeeef1881101f2cb11644f3a2afdfc2045e19919152923f367a1767c11cceda","ecfb7056cf1de042f9420bab396793c0c390bde74b4bbdff16a83ae09a9a7517"],["6d7ef6b17543f8373c573f44e1f389835d89bcbc6062ced36c82df83b8fae859","cd450ec335438986dfefa10c57fea9bcc521a0959b2d80bbf74b190dca712d10"],["e75605d59102a5a2684500d3b991f2e3f3c88b93225547035af25af66e04541f","f5c54754a8f71ee540b9b48728473e314f729ac5308b06938360990e2bfad125"],["eb98660f4c4dfaa06a2be453d5020bc99a0c2e60abe388457dd43fefb1ed620c","6cb9a8876d9cb8520609af3add26cd20a0a7cd8a9411131ce85f44100099223e"],["13e87b027d8514d35939f2e6892b19922154596941888336dc3563e3b8dba942","fef5a3c68059a6dec5d624114bf1e91aac2b9da568d6abeb2570d55646b8adf1"],["ee163026e9fd6fe017c38f06a5be6fc125424b371ce2708e7bf4491691e5764a","1acb250f255dd61c43d94ccc670d0f58f49ae3fa15b96623e5430da0ad6c62b2"],["b268f5ef9ad51e4d78de3a750c2dc89b1e626d43505867999932e5db33af3d80","5f310d4b3c99b9ebb19f77d41c1dee018cf0d34fd4191614003e945a1216e423"],["ff07f3118a9df035e9fad85eb6c7bfe42b02f01ca99ceea3bf7ffdba93c4750d","438136d603e858a3a5c440c38eccbaddc1d2942114e2eddd4740d098ced1f0d8"],["8d8b9855c7c052a34146fd20ffb658bea4b9f69e0d825ebec16e8c3ce2b526a1","cdb559eedc2d79f926baf44fb84ea4d44bcf50fee51d7ceb30e2e7f463036758"],["52db0b5384dfbf05bfa9d472d7ae26dfe4b851ceca91b1eba54263180da32b63","c3b997d050ee5d423ebaf66a6db9f57b3180c902875679de924b69d84a7b375"],["e62f9490d3d51da6395efd24e80919cc7d0f29c3f3fa48c6fff543becbd43352","6d89ad7ba4876b0b22c2ca280c682862f342c8591f1daf5170e07bfd9ccafa7d"],["7f30ea2476b399b4957509c88f77d0191afa2ff5cb7b14fd6d8e7d65aaab1193","ca5ef7d4b231c94c3b15389a5f6311e9daff7bb67b103e9880ef4bff637acaec"],["5098ff1e1d9f14fb46a210fada6c903fef0fb7b4a1dd1d9ac60a0361800b7a00","9731141d81fc8f8084d37c6e7542006b3ee1b40d60dfe5362a5b132fd17ddc0"],["32b78c7de9ee512a72895be6b9cbefa6e2f3c4ccce445c96b9f2c81e2778ad58","ee1849f513df71e32efc3896ee28260c73bb80547ae2275ba497237794c8753c"],["e2cb74fddc8e9fbcd076eef2a7c72b0ce37d50f08269dfc074b581550547a4f7","d3aa2ed71c9dd2247a62df062736eb0baddea9e36122d2be8641abcb005cc4a4"],["8438447566d4d7bedadc299496ab357426009a35f235cb141be0d99cd10ae3a8","c4e1020916980a4da5d01ac5e6ad330734ef0d7906631c4f2390426b2edd791f"],["4162d488b89402039b584c6fc6c308870587d9c46f660b878ab65c82c711d67e","67163e903236289f776f22c25fb8a3afc1732f2b84b4e95dbda47ae5a0852649"],["3fad3fa84caf0f34f0f89bfd2dcf54fc175d767aec3e50684f3ba4a4bf5f683d","cd1bc7cb6cc407bb2f0ca647c718a730cf71872e7d0d2a53fa20efcdfe61826"],["674f2600a3007a00568c1a7ce05d0816c1fb84bf1370798f1c69532faeb1a86b","299d21f9413f33b3edf43b257004580b70db57da0b182259e09eecc69e0d38a5"],["d32f4da54ade74abb81b815ad1fb3b263d82d6c692714bcff87d29bd5ee9f08f","f9429e738b8e53b968e99016c059707782e14f4535359d582fc416910b3eea87"],["30e4e670435385556e593657135845d36fbb6931f72b08cb1ed954f1e3ce3ff6","462f9bce619898638499350113bbc9b10a878d35da70740dc695a559eb88db7b"],["be2062003c51cc3004682904330e4dee7f3dcd10b01e580bf1971b04d4cad297","62188bc49d61e5428573d48a74e1c655b1c61090905682a0d5558ed72dccb9bc"],["93144423ace3451ed29e0fb9ac2af211cb6e84a601df5993c419859fff5df04a","7c10dfb164c3425f5c71a3f9d7992038f1065224f72bb9d1d902a6d13037b47c"],["b015f8044f5fcbdcf21ca26d6c34fb8197829205c7b7d2a7cb66418c157b112c","ab8c1e086d04e813744a655b2df8d5f83b3cdc6faa3088c1d3aea1454e3a1d5f"],["d5e9e1da649d97d89e4868117a465a3a4f8a18de57a140d36b3f2af341a21b52","4cb04437f391ed73111a13cc1d4dd0db1693465c2240480d8955e8592f27447a"],["d3ae41047dd7ca065dbf8ed77b992439983005cd72e16d6f996a5316d36966bb","bd1aeb21ad22ebb22a10f0303417c6d964f8cdd7df0aca614b10dc14d125ac46"],["463e2763d885f958fc66cdd22800f0a487197d0a82e377b49f80af87c897b065","bfefacdb0e5d0fd7df3a311a94de062b26b80c61fbc97508b79992671ef7ca7f"],["7985fdfd127c0567c6f53ec1bb63ec3158e597c40bfe747c83cddfc910641917","603c12daf3d9862ef2b25fe1de289aed24ed291e0ec6708703a5bd567f32ed03"],["74a1ad6b5f76e39db2dd249410eac7f99e74c59cb83d2d0ed5ff1543da7703e9","cc6157ef18c9c63cd6193d83631bbea0093e0968942e8c33d5737fd790e0db08"],["30682a50703375f602d416664ba19b7fc9bab42c72747463a71d0896b22f6da3","553e04f6b018b4fa6c8f39e7f311d3176290d0e0f19ca73f17714d9977a22ff8"],["9e2158f0d7c0d5f26c3791efefa79597654e7a2b2464f52b1ee6c1347769ef57","712fcdd1b9053f09003a3481fa7762e9ffd7c8ef35a38509e2fbf2629008373"],["176e26989a43c9cfeba4029c202538c28172e566e3c4fce7322857f3be327d66","ed8cc9d04b29eb877d270b4878dc43c19aefd31f4eee09ee7b47834c1fa4b1c3"],["75d46efea3771e6e68abb89a13ad747ecf1892393dfc4f1b7004788c50374da8","9852390a99507679fd0b86fd2b39a868d7efc22151346e1a3ca4726586a6bed8"],["809a20c67d64900ffb698c4c825f6d5f2310fb0451c869345b7319f645605721","9e994980d9917e22b76b061927fa04143d096ccc54963e6a5ebfa5f3f8e286c1"],["1b38903a43f7f114ed4500b4eac7083fdefece1cf29c63528d563446f972c180","4036edc931a60ae889353f77fd53de4a2708b26b6f5da72ad3394119daf408f9"]]}}},{}],364:[function(e,n,i){var o=i,a=e("bn.js"),s=e("minimalistic-assert"),l=e("minimalistic-crypto-utils");o.assert=s,o.toArray=l.toArray,o.zero2=l.zero2,o.toHex=l.toHex,o.encode=l.encode,o.getNAF=function(p,d,g){var y=new Array(Math.max(p.bitLength(),g)+1);y.fill(0);for(var h=1<<d+1,u=p.clone(),f=0;f<y.length;f++){var c,v=u.andln(h-1);u.isOdd()?(c=v>(h>>1)-1?(h>>1)-v:v,u.isubn(c)):c=0,y[f]=c,u.iushrn(1)}return y},o.getJSF=function(p,d){var g=[[],[]];p=p.clone(),d=d.clone();for(var y=0,h=0;p.cmpn(-y)>0||d.cmpn(-h)>0;){var u,f,c,v=p.andln(3)+y&3,m=d.andln(3)+h&3;v===3&&(v=-1),m===3&&(m=-1),(1&v)==0?u=0:u=(c=p.andln(7)+y&7)!=3&&c!==5||m!==2?v:-v,g[0].push(u),(1&m)==0?f=0:f=(c=d.andln(7)+h&7)!=3&&c!==5||v!==2?m:-m,g[1].push(f),2*y===u+1&&(y=1-y),2*h===f+1&&(h=1-h),p.iushrn(1),d.iushrn(1)}return g},o.cachedProperty=function(p,d,g){var y="_"+d;p.prototype[d]=function(){return this[y]!==void 0?this[y]:this[y]=g.call(this)}},o.parseBytes=function(p){return typeof p=="string"?o.toArray(p,"hex"):p},o.intFromLE=function(p){return new a(p,"hex","le")}},{"bn.js":365,"minimalistic-assert":437,"minimalistic-crypto-utils":438}],365:[function(e,n,i){arguments[4][181][0].apply(i,arguments)},{buffer:185,dup:181}],366:[function(e,n,i){n.exports={_from:"elliptic@^6.5.3",_id:"elliptic@6.5.3",_inBundle:!1,_integrity:"sha512-IMqzv5wNQf+E6aHeIqATs0tOLeOTwj1QKbRcS3jBbYkl5oLAserA8yJTT7/VyHUYG91PRmPyeQDObKLPpeS4dw==",_location:"/elliptic",_phantomChildren:{},_requested:{type:"range",registry:!0,raw:"elliptic@^6.5.3",name:"elliptic",escapedName:"elliptic",rawSpec:"^6.5.3",saveSpec:null,fetchSpec:"^6.5.3"},_requiredBy:["/browserify-sign","/create-ecdh"],_resolved:"https://registry.npmjs.org/elliptic/-/elliptic-6.5.3.tgz",_shasum:"cb59eb2efdaf73a0bd78ccd7015a62ad6e0f93d6",_spec:"elliptic@^6.5.3",_where:"/mnt/d/dev/git/exceljs/node_modules/browserify-sign",author:{name:"Fedor Indutny",email:"fedor@indutny.com"},bugs:{url:"https://github.com/indutny/elliptic/issues"},bundleDependencies:!1,dependencies:{"bn.js":"^4.4.0",brorand:"^1.0.1","hash.js":"^1.0.0","hmac-drbg":"^1.0.0",inherits:"^2.0.1","minimalistic-assert":"^1.0.0","minimalistic-crypto-utils":"^1.0.0"},deprecated:!1,description:"EC cryptography",devDependencies:{brfs:"^1.4.3",coveralls:"^3.0.8",grunt:"^1.0.4","grunt-browserify":"^5.0.0","grunt-cli":"^1.2.0","grunt-contrib-connect":"^1.0.0","grunt-contrib-copy":"^1.0.0","grunt-contrib-uglify":"^1.0.1","grunt-mocha-istanbul":"^3.0.1","grunt-saucelabs":"^9.0.1",istanbul:"^0.4.2",jscs:"^3.0.7",jshint:"^2.10.3",mocha:"^6.2.2"},files:["lib"],homepage:"https://github.com/indutny/elliptic",keywords:["EC","Elliptic","curve","Cryptography"],license:"MIT",main:"lib/elliptic.js",name:"elliptic",repository:{type:"git",url:"git+ssh://git@github.com/indutny/elliptic.git"},scripts:{jscs:"jscs benchmarks/*.js lib/*.js lib/**/*.js lib/**/**/*.js test/index.js",jshint:"jscs benchmarks/*.js lib/*.js lib/**/*.js lib/**/**/*.js test/index.js",lint:"npm run jscs && npm run jshint",test:"npm run lint && npm run unit",unit:"istanbul test _mocha --reporter=spec test/index.js",version:"grunt dist && git add dist/"},version:"6.5.3"}},{}],367:[function(e,n,i){function o(P){return(o=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(N){return typeof N}:function(N){return N&&typeof Symbol=="function"&&N.constructor===Symbol&&N!==Symbol.prototype?"symbol":typeof N})(P)}var a=Object.create||function(P){var N=function(){};return N.prototype=P,new N},s=Object.keys||function(P){var N=[];for(var A in P)Object.prototype.hasOwnProperty.call(P,A)&&N.push(A);return A},l=Function.prototype.bind||function(P){var N=this;return function(){return N.apply(P,arguments)}};function p(){this._events&&Object.prototype.hasOwnProperty.call(this,"_events")||(this._events=a(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0}n.exports=p,p.EventEmitter=p,p.prototype._events=void 0,p.prototype._maxListeners=void 0;var d,g=10;try{var y={};Object.defineProperty&&Object.defineProperty(y,"x",{value:0}),d=y.x===0}catch{d=!1}function h(P){return P._maxListeners===void 0?p.defaultMaxListeners:P._maxListeners}function u(P,N,A){if(N)P.call(A);else for(var $=P.length,T=I(P,$),M=0;M<$;++M)T[M].call(A)}function f(P,N,A,$){if(N)P.call(A,$);else for(var T=P.length,M=I(P,T),S=0;S<T;++S)M[S].call(A,$)}function c(P,N,A,$,T){if(N)P.call(A,$,T);else for(var M=P.length,S=I(P,M),E=0;E<M;++E)S[E].call(A,$,T)}function v(P,N,A,$,T,M){if(N)P.call(A,$,T,M);else for(var S=P.length,E=I(P,S),k=0;k<S;++k)E[k].call(A,$,T,M)}function m(P,N,A,$){if(N)P.apply(A,$);else for(var T=P.length,M=I(P,T),S=0;S<T;++S)M[S].apply(A,$)}function b(P,N,A,$){var T,M,S;if(typeof A!="function")throw new TypeError('"listener" argument must be a function');if((M=P._events)?(M.newListener&&(P.emit("newListener",N,A.listener?A.listener:A),M=P._events),S=M[N]):(M=P._events=a(null),P._eventsCount=0),S){if(typeof S=="function"?S=M[N]=$?[A,S]:[S,A]:$?S.unshift(A):S.push(A),!S.warned&&(T=h(P))&&T>0&&S.length>T){S.warned=!0;var E=new Error("Possible EventEmitter memory leak detected. "+S.length+' "'+String(N)+'" listeners added. Use emitter.setMaxListeners() to increase limit.');E.name="MaxListenersExceededWarning",E.emitter=P,E.type=N,E.count=S.length,(typeof console=="undefined"?"undefined":o(console))==="object"&&console.warn&&console.warn("%s: %s",E.name,E.message)}}else S=M[N]=A,++P._eventsCount;return P}function w(){if(!this.fired)switch(this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length){case 0:return this.listener.call(this.target);case 1:return this.listener.call(this.target,arguments[0]);case 2:return this.listener.call(this.target,arguments[0],arguments[1]);case 3:return this.listener.call(this.target,arguments[0],arguments[1],arguments[2]);default:for(var P=new Array(arguments.length),N=0;N<P.length;++N)P[N]=arguments[N];this.listener.apply(this.target,P)}}function _(P,N,A){var $={fired:!1,wrapFn:void 0,target:P,type:N,listener:A},T=l.call(w,$);return T.listener=A,$.wrapFn=T,T}function C(P,N,A){var $=P._events;if(!$)return[];var T=$[N];return T?typeof T=="function"?A?[T.listener||T]:[T]:A?function(M){for(var S=new Array(M.length),E=0;E<S.length;++E)S[E]=M[E].listener||M[E];return S}(T):I(T,T.length):[]}function R(P){var N=this._events;if(N){var A=N[P];if(typeof A=="function")return 1;if(A)return A.length}return 0}function I(P,N){for(var A=new Array(N),$=0;$<N;++$)A[$]=P[$];return A}d?Object.defineProperty(p,"defaultMaxListeners",{enumerable:!0,get:function(){return g},set:function(P){if(typeof P!="number"||P<0||P!=P)throw new TypeError('"defaultMaxListeners" must be a positive number');g=P}}):p.defaultMaxListeners=g,p.prototype.setMaxListeners=function(P){if(typeof P!="number"||P<0||isNaN(P))throw new TypeError('"n" argument must be a positive number');return this._maxListeners=P,this},p.prototype.getMaxListeners=function(){return h(this)},p.prototype.emit=function(P){var N,A,$,T,M,S,E=P==="error";if(S=this._events)E=E&&S.error==null;else if(!E)return!1;if(E){if(arguments.length>1&&(N=arguments[1]),N instanceof Error)throw N;var k=new Error('Unhandled "error" event. ('+N+")");throw k.context=N,k}if(!(A=S[P]))return!1;var O=typeof A=="function";switch($=arguments.length){case 1:u(A,O,this);break;case 2:f(A,O,this,arguments[1]);break;case 3:c(A,O,this,arguments[1],arguments[2]);break;case 4:v(A,O,this,arguments[1],arguments[2],arguments[3]);break;default:for(T=new Array($-1),M=1;M<$;M++)T[M-1]=arguments[M];m(A,O,this,T)}return!0},p.prototype.addListener=function(P,N){return b(this,P,N,!1)},p.prototype.on=p.prototype.addListener,p.prototype.prependListener=function(P,N){return b(this,P,N,!0)},p.prototype.once=function(P,N){if(typeof N!="function")throw new TypeError('"listener" argument must be a function');return this.on(P,_(this,P,N)),this},p.prototype.prependOnceListener=function(P,N){if(typeof N!="function")throw new TypeError('"listener" argument must be a function');return this.prependListener(P,_(this,P,N)),this},p.prototype.removeListener=function(P,N){var A,$,T,M,S;if(typeof N!="function")throw new TypeError('"listener" argument must be a function');if(!($=this._events))return this;if(!(A=$[P]))return this;if(A===N||A.listener===N)--this._eventsCount==0?this._events=a(null):(delete $[P],$.removeListener&&this.emit("removeListener",P,A.listener||N));else if(typeof A!="function"){for(T=-1,M=A.length-1;M>=0;M--)if(A[M]===N||A[M].listener===N){S=A[M].listener,T=M;break}if(T<0)return this;T===0?A.shift():function(E,k){for(var O=k,x=O+1,j=E.length;x<j;O+=1,x+=1)E[O]=E[x];E.pop()}(A,T),A.length===1&&($[P]=A[0]),$.removeListener&&this.emit("removeListener",P,S||N)}return this},p.prototype.removeAllListeners=function(P){var N,A,$;if(!(A=this._events))return this;if(!A.removeListener)return arguments.length===0?(this._events=a(null),this._eventsCount=0):A[P]&&(--this._eventsCount==0?this._events=a(null):delete A[P]),this;if(arguments.length===0){var T,M=s(A);for($=0;$<M.length;++$)(T=M[$])!=="removeListener"&&this.removeAllListeners(T);return this.removeAllListeners("removeListener"),this._events=a(null),this._eventsCount=0,this}if(typeof(N=A[P])=="function")this.removeListener(P,N);else if(N)for($=N.length-1;$>=0;$--)this.removeListener(P,N[$]);return this},p.prototype.listeners=function(P){return C(this,P,!0)},p.prototype.rawListeners=function(P){return C(this,P,!1)},p.listenerCount=function(P,N){return typeof P.listenerCount=="function"?P.listenerCount(N):R.call(P,N)},p.prototype.listenerCount=R,p.prototype.eventNames=function(){return this._eventsCount>0?Reflect.ownKeys(this._events):[]}},{}],368:[function(e,n,i){var o=e("safe-buffer").Buffer,a=e("md5.js");n.exports=function(s,l,p,d){if(o.isBuffer(s)||(s=o.from(s,"binary")),l&&(o.isBuffer(l)||(l=o.from(l,"binary")),l.length!==8))throw new RangeError("salt should be Buffer with 8 byte length");for(var g=p/8,y=o.alloc(g),h=o.alloc(d||0),u=o.alloc(0);g>0||d>0;){var f=new a;f.update(u),f.update(s),l&&f.update(l),u=f.digest();var c=0;if(g>0){var v=y.length-g;c=Math.min(g,u.length),u.copy(y,v,0,c),g-=c}if(c<u.length&&d>0){var m=h.length-d,b=Math.min(d,u.length-c);u.copy(h,m,c,c+b),d-=b}}return u.fill(0),{key:y,iv:h}}},{"md5.js":434,"safe-buffer":494}],369:[function(e,n,i){Object.defineProperty(i,"__esModule",{value:!0});var o=e("@fast-csv/format");Object.defineProperty(i,"format",{enumerable:!0,get:function(){return o.format}}),Object.defineProperty(i,"write",{enumerable:!0,get:function(){return o.write}}),Object.defineProperty(i,"writeToStream",{enumerable:!0,get:function(){return o.writeToStream}}),Object.defineProperty(i,"writeToBuffer",{enumerable:!0,get:function(){return o.writeToBuffer}}),Object.defineProperty(i,"writeToString",{enumerable:!0,get:function(){return o.writeToString}}),Object.defineProperty(i,"writeToPath",{enumerable:!0,get:function(){return o.writeToPath}}),Object.defineProperty(i,"CsvFormatterStream",{enumerable:!0,get:function(){return o.CsvFormatterStream}}),Object.defineProperty(i,"FormatterOptions",{enumerable:!0,get:function(){return o.FormatterOptions}});var a=e("@fast-csv/parse");Object.defineProperty(i,"parse",{enumerable:!0,get:function(){return a.parse}}),Object.defineProperty(i,"parseString",{enumerable:!0,get:function(){return a.parseString}}),Object.defineProperty(i,"parseStream",{enumerable:!0,get:function(){return a.parseStream}}),Object.defineProperty(i,"parseFile",{enumerable:!0,get:function(){return a.parseFile}}),Object.defineProperty(i,"ParserOptions",{enumerable:!0,get:function(){return a.ParserOptions}}),Object.defineProperty(i,"CsvParserStream",{enumerable:!0,get:function(){return a.CsvParserStream}})},{"@fast-csv/format":148,"@fast-csv/parse":152}],370:[function(e,n,i){var o=e("safe-buffer").Buffer,a=e("readable-stream").Transform;function s(l){a.call(this),this._block=o.allocUnsafe(l),this._blockSize=l,this._blockOffset=0,this._length=[0,0,0,0],this._finalized=!1}e("inherits")(s,a),s.prototype._transform=function(l,p,d){var g=null;try{this.update(l,p)}catch(y){g=y}d(g)},s.prototype._flush=function(l){var p=null;try{this.push(this.digest())}catch(d){p=d}l(p)},s.prototype.update=function(l,p){if(function(f,c){if(!o.isBuffer(f)&&typeof f!="string")throw new TypeError(c+" must be a string or a buffer")}(l,"Data"),this._finalized)throw new Error("Digest already called");o.isBuffer(l)||(l=o.from(l,p));for(var d=this._block,g=0;this._blockOffset+l.length-g>=this._blockSize;){for(var y=this._blockOffset;y<this._blockSize;)d[y++]=l[g++];this._update(),this._blockOffset=0}for(;g<l.length;)d[this._blockOffset++]=l[g++];for(var h=0,u=8*l.length;u>0;++h)this._length[h]+=u,(u=this._length[h]/4294967296|0)>0&&(this._length[h]-=4294967296*u);return this},s.prototype._update=function(){throw new Error("_update is not implemented")},s.prototype.digest=function(l){if(this._finalized)throw new Error("Digest already called");this._finalized=!0;var p=this._digest();l!==void 0&&(p=p.toString(l)),this._block.fill(0),this._blockOffset=0;for(var d=0;d<4;++d)this._length[d]=0;return p},s.prototype._digest=function(){throw new Error("_digest is not implemented")},n.exports=s},{inherits:387,"readable-stream":491,"safe-buffer":371}],371:[function(e,n,i){arguments[4][214][0].apply(i,arguments)},{buffer:216,dup:214}],372:[function(e,n,i){var o=i;o.utils=e("./hash/utils"),o.common=e("./hash/common"),o.sha=e("./hash/sha"),o.ripemd=e("./hash/ripemd"),o.hmac=e("./hash/hmac"),o.sha1=o.sha.sha1,o.sha256=o.sha.sha256,o.sha224=o.sha.sha224,o.sha384=o.sha.sha384,o.sha512=o.sha.sha512,o.ripemd160=o.ripemd.ripemd160},{"./hash/common":373,"./hash/hmac":374,"./hash/ripemd":375,"./hash/sha":376,"./hash/utils":383}],373:[function(e,n,i){var o=e("./utils"),a=e("minimalistic-assert");function s(){this.pending=null,this.pendingTotal=0,this.blockSize=this.constructor.blockSize,this.outSize=this.constructor.outSize,this.hmacStrength=this.constructor.hmacStrength,this.padLength=this.constructor.padLength/8,this.endian="big",this._delta8=this.blockSize/8,this._delta32=this.blockSize/32}i.BlockHash=s,s.prototype.update=function(l,p){if(l=o.toArray(l,p),this.pending?this.pending=this.pending.concat(l):this.pending=l,this.pendingTotal+=l.length,this.pending.length>=this._delta8){var d=(l=this.pending).length%this._delta8;this.pending=l.slice(l.length-d,l.length),this.pending.length===0&&(this.pending=null),l=o.join32(l,0,l.length-d,this.endian);for(var g=0;g<l.length;g+=this._delta32)this._update(l,g,g+this._delta32)}return this},s.prototype.digest=function(l){return this.update(this._pad()),a(this.pending===null),this._digest(l)},s.prototype._pad=function(){var l=this.pendingTotal,p=this._delta8,d=p-(l+this.padLength)%p,g=new Array(d+this.padLength);g[0]=128;for(var y=1;y<d;y++)g[y]=0;if(l<<=3,this.endian==="big"){for(var h=8;h<this.padLength;h++)g[y++]=0;g[y++]=0,g[y++]=0,g[y++]=0,g[y++]=0,g[y++]=l>>>24&255,g[y++]=l>>>16&255,g[y++]=l>>>8&255,g[y++]=255&l}else for(g[y++]=255&l,g[y++]=l>>>8&255,g[y++]=l>>>16&255,g[y++]=l>>>24&255,g[y++]=0,g[y++]=0,g[y++]=0,g[y++]=0,h=8;h<this.padLength;h++)g[y++]=0;return g}},{"./utils":383,"minimalistic-assert":437}],374:[function(e,n,i){var o=e("./utils"),a=e("minimalistic-assert");function s(l,p,d){if(!(this instanceof s))return new s(l,p,d);this.Hash=l,this.blockSize=l.blockSize/8,this.outSize=l.outSize/8,this.inner=null,this.outer=null,this._init(o.toArray(p,d))}n.exports=s,s.prototype._init=function(l){l.length>this.blockSize&&(l=new this.Hash().update(l).digest()),a(l.length<=this.blockSize);for(var p=l.length;p<this.blockSize;p++)l.push(0);for(p=0;p<l.length;p++)l[p]^=54;for(this.inner=new this.Hash().update(l),p=0;p<l.length;p++)l[p]^=106;this.outer=new this.Hash().update(l)},s.prototype.update=function(l,p){return this.inner.update(l,p),this},s.prototype.digest=function(l){return this.outer.update(this.inner.digest()),this.outer.digest(l)}},{"./utils":383,"minimalistic-assert":437}],375:[function(e,n,i){var o=e("./utils"),a=e("./common"),s=o.rotl32,l=o.sum32,p=o.sum32_3,d=o.sum32_4,g=a.BlockHash;function y(){if(!(this instanceof y))return new y;g.call(this),this.h=[1732584193,4023233417,2562383102,271733878,3285377520],this.endian="little"}function h(w,_,C,R){return w<=15?_^C^R:w<=31?_&C|~_&R:w<=47?(_|~C)^R:w<=63?_&R|C&~R:_^(C|~R)}function u(w){return w<=15?0:w<=31?1518500249:w<=47?1859775393:w<=63?2400959708:2840853838}function f(w){return w<=15?1352829926:w<=31?1548603684:w<=47?1836072691:w<=63?2053994217:0}o.inherits(y,g),i.ripemd160=y,y.blockSize=512,y.outSize=160,y.hmacStrength=192,y.padLength=64,y.prototype._update=function(w,_){for(var C=this.h[0],R=this.h[1],I=this.h[2],P=this.h[3],N=this.h[4],A=C,$=R,T=I,M=P,S=N,E=0;E<80;E++){var k=l(s(d(C,h(E,R,I,P),w[c[E]+_],u(E)),m[E]),N);C=N,N=P,P=s(I,10),I=R,R=k,k=l(s(d(A,h(79-E,$,T,M),w[v[E]+_],f(E)),b[E]),S),A=S,S=M,M=s(T,10),T=$,$=k}k=p(this.h[1],I,M),this.h[1]=p(this.h[2],P,S),this.h[2]=p(this.h[3],N,A),this.h[3]=p(this.h[4],C,$),this.h[4]=p(this.h[0],R,T),this.h[0]=k},y.prototype._digest=function(w){return w==="hex"?o.toHex32(this.h,"little"):o.split32(this.h,"little")};var c=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8,3,10,14,4,9,15,8,1,2,7,0,6,13,11,5,12,1,9,11,10,0,8,12,4,13,3,7,15,14,5,6,2,4,0,5,9,7,12,2,10,14,1,3,8,11,6,15,13],v=[5,14,7,0,9,2,11,4,13,6,15,8,1,10,3,12,6,11,3,7,0,13,5,10,14,15,8,12,4,9,1,2,15,5,1,3,7,14,6,9,11,8,12,2,10,0,4,13,8,6,4,1,3,11,15,0,5,12,2,13,9,7,10,14,12,15,10,4,1,5,8,7,6,2,13,14,0,3,9,11],m=[11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8,7,6,8,13,11,9,7,15,7,12,15,9,11,7,13,12,11,13,6,7,14,9,13,15,14,8,13,6,5,12,7,5,11,12,14,15,14,15,9,8,9,14,5,6,8,6,5,12,9,15,5,11,6,8,13,12,5,12,13,14,11,8,5,6],b=[8,9,9,11,13,15,15,5,7,7,8,11,14,14,12,6,9,13,15,7,12,8,9,11,7,7,12,7,6,15,13,11,9,7,15,11,8,6,6,14,12,13,5,14,13,13,7,5,15,5,8,11,14,14,6,14,6,9,12,9,12,5,15,8,8,5,12,9,12,5,14,6,8,13,6,5,15,13,11,11]},{"./common":373,"./utils":383}],376:[function(e,n,i){i.sha1=e("./sha/1"),i.sha224=e("./sha/224"),i.sha256=e("./sha/256"),i.sha384=e("./sha/384"),i.sha512=e("./sha/512")},{"./sha/1":377,"./sha/224":378,"./sha/256":379,"./sha/384":380,"./sha/512":381}],377:[function(e,n,i){var o=e("../utils"),a=e("../common"),s=e("./common"),l=o.rotl32,p=o.sum32,d=o.sum32_5,g=s.ft_1,y=a.BlockHash,h=[1518500249,1859775393,2400959708,3395469782];function u(){if(!(this instanceof u))return new u;y.call(this),this.h=[1732584193,4023233417,2562383102,271733878,3285377520],this.W=new Array(80)}o.inherits(u,y),n.exports=u,u.blockSize=512,u.outSize=160,u.hmacStrength=80,u.padLength=64,u.prototype._update=function(f,c){for(var v=this.W,m=0;m<16;m++)v[m]=f[c+m];for(;m<v.length;m++)v[m]=l(v[m-3]^v[m-8]^v[m-14]^v[m-16],1);var b=this.h[0],w=this.h[1],_=this.h[2],C=this.h[3],R=this.h[4];for(m=0;m<v.length;m++){var I=~~(m/20),P=d(l(b,5),g(I,w,_,C),R,v[m],h[I]);R=C,C=_,_=l(w,30),w=b,b=P}this.h[0]=p(this.h[0],b),this.h[1]=p(this.h[1],w),this.h[2]=p(this.h[2],_),this.h[3]=p(this.h[3],C),this.h[4]=p(this.h[4],R)},u.prototype._digest=function(f){return f==="hex"?o.toHex32(this.h,"big"):o.split32(this.h,"big")}},{"../common":373,"../utils":383,"./common":382}],378:[function(e,n,i){var o=e("../utils"),a=e("./256");function s(){if(!(this instanceof s))return new s;a.call(this),this.h=[3238371032,914150663,812702999,4144912697,4290775857,1750603025,1694076839,3204075428]}o.inherits(s,a),n.exports=s,s.blockSize=512,s.outSize=224,s.hmacStrength=192,s.padLength=64,s.prototype._digest=function(l){return l==="hex"?o.toHex32(this.h.slice(0,7),"big"):o.split32(this.h.slice(0,7),"big")}},{"../utils":383,"./256":379}],379:[function(e,n,i){var o=e("../utils"),a=e("../common"),s=e("./common"),l=e("minimalistic-assert"),p=o.sum32,d=o.sum32_4,g=o.sum32_5,y=s.ch32,h=s.maj32,u=s.s0_256,f=s.s1_256,c=s.g0_256,v=s.g1_256,m=a.BlockHash,b=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298];function w(){if(!(this instanceof w))return new w;m.call(this),this.h=[1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225],this.k=b,this.W=new Array(64)}o.inherits(w,m),n.exports=w,w.blockSize=512,w.outSize=256,w.hmacStrength=192,w.padLength=64,w.prototype._update=function(_,C){for(var R=this.W,I=0;I<16;I++)R[I]=_[C+I];for(;I<R.length;I++)R[I]=d(v(R[I-2]),R[I-7],c(R[I-15]),R[I-16]);var P=this.h[0],N=this.h[1],A=this.h[2],$=this.h[3],T=this.h[4],M=this.h[5],S=this.h[6],E=this.h[7];for(l(this.k.length===R.length),I=0;I<R.length;I++){var k=g(E,f(T),y(T,M,S),this.k[I],R[I]),O=p(u(P),h(P,N,A));E=S,S=M,M=T,T=p($,k),$=A,A=N,N=P,P=p(k,O)}this.h[0]=p(this.h[0],P),this.h[1]=p(this.h[1],N),this.h[2]=p(this.h[2],A),this.h[3]=p(this.h[3],$),this.h[4]=p(this.h[4],T),this.h[5]=p(this.h[5],M),this.h[6]=p(this.h[6],S),this.h[7]=p(this.h[7],E)},w.prototype._digest=function(_){return _==="hex"?o.toHex32(this.h,"big"):o.split32(this.h,"big")}},{"../common":373,"../utils":383,"./common":382,"minimalistic-assert":437}],380:[function(e,n,i){var o=e("../utils"),a=e("./512");function s(){if(!(this instanceof s))return new s;a.call(this),this.h=[3418070365,3238371032,1654270250,914150663,2438529370,812702999,355462360,4144912697,1731405415,4290775857,2394180231,1750603025,3675008525,1694076839,1203062813,3204075428]}o.inherits(s,a),n.exports=s,s.blockSize=1024,s.outSize=384,s.hmacStrength=192,s.padLength=128,s.prototype._digest=function(l){return l==="hex"?o.toHex32(this.h.slice(0,12),"big"):o.split32(this.h.slice(0,12),"big")}},{"../utils":383,"./512":381}],381:[function(e,n,i){var o=e("../utils"),a=e("../common"),s=e("minimalistic-assert"),l=o.rotr64_hi,p=o.rotr64_lo,d=o.shr64_hi,g=o.shr64_lo,y=o.sum64,h=o.sum64_hi,u=o.sum64_lo,f=o.sum64_4_hi,c=o.sum64_4_lo,v=o.sum64_5_hi,m=o.sum64_5_lo,b=a.BlockHash,w=[1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591];function _(){if(!(this instanceof _))return new _;b.call(this),this.h=[1779033703,4089235720,3144134277,2227873595,1013904242,4271175723,2773480762,1595750129,1359893119,2917565137,2600822924,725511199,528734635,4215389547,1541459225,327033209],this.k=w,this.W=new Array(160)}function C(O,x,j,H,F){var V=O&j^~O&F;return V<0&&(V+=4294967296),V}function R(O,x,j,H,F,V){var W=x&H^~x&V;return W<0&&(W+=4294967296),W}function I(O,x,j,H,F){var V=O&j^O&F^j&F;return V<0&&(V+=4294967296),V}function P(O,x,j,H,F,V){var W=x&H^x&V^H&V;return W<0&&(W+=4294967296),W}function N(O,x){var j=l(O,x,28)^l(x,O,2)^l(x,O,7);return j<0&&(j+=4294967296),j}function A(O,x){var j=p(O,x,28)^p(x,O,2)^p(x,O,7);return j<0&&(j+=4294967296),j}function $(O,x){var j=l(O,x,14)^l(O,x,18)^l(x,O,9);return j<0&&(j+=4294967296),j}function T(O,x){var j=p(O,x,14)^p(O,x,18)^p(x,O,9);return j<0&&(j+=4294967296),j}function M(O,x){var j=l(O,x,1)^l(O,x,8)^d(O,x,7);return j<0&&(j+=4294967296),j}function S(O,x){var j=p(O,x,1)^p(O,x,8)^g(O,x,7);return j<0&&(j+=4294967296),j}function E(O,x){var j=l(O,x,19)^l(x,O,29)^d(O,x,6);return j<0&&(j+=4294967296),j}function k(O,x){var j=p(O,x,19)^p(x,O,29)^g(O,x,6);return j<0&&(j+=4294967296),j}o.inherits(_,b),n.exports=_,_.blockSize=1024,_.outSize=512,_.hmacStrength=192,_.padLength=128,_.prototype._prepareBlock=function(O,x){for(var j=this.W,H=0;H<32;H++)j[H]=O[x+H];for(;H<j.length;H+=2){var F=E(j[H-4],j[H-3]),V=k(j[H-4],j[H-3]),W=j[H-14],U=j[H-13],Y=M(j[H-30],j[H-29]),K=S(j[H-30],j[H-29]),D=j[H-32],L=j[H-31];j[H]=f(F,V,W,U,Y,K,D,L),j[H+1]=c(F,V,W,U,Y,K,D,L)}},_.prototype._update=function(O,x){this._prepareBlock(O,x);var j=this.W,H=this.h[0],F=this.h[1],V=this.h[2],W=this.h[3],U=this.h[4],Y=this.h[5],K=this.h[6],D=this.h[7],L=this.h[8],B=this.h[9],z=this.h[10],q=this.h[11],X=this.h[12],ee=this.h[13],ye=this.h[14],de=this.h[15];s(this.k.length===j.length);for(var ge=0;ge<j.length;ge+=2){var we=ye,be=de,J=$(L,B),te=T(L,B),ie=C(L,B,z,q,X),fe=R(L,B,z,q,X,ee),se=this.k[ge],oe=this.k[ge+1],G=j[ge],Z=j[ge+1],Q=v(we,be,J,te,ie,fe,se,oe,G,Z),re=m(we,be,J,te,ie,fe,se,oe,G,Z);we=N(H,F),be=A(H,F),J=I(H,F,V,W,U),te=P(H,F,V,W,U,Y);var ne=h(we,be,J,te),ue=u(we,be,J,te);ye=X,de=ee,X=z,ee=q,z=L,q=B,L=h(K,D,Q,re),B=u(D,D,Q,re),K=U,D=Y,U=V,Y=W,V=H,W=F,H=h(Q,re,ne,ue),F=u(Q,re,ne,ue)}y(this.h,0,H,F),y(this.h,2,V,W),y(this.h,4,U,Y),y(this.h,6,K,D),y(this.h,8,L,B),y(this.h,10,z,q),y(this.h,12,X,ee),y(this.h,14,ye,de)},_.prototype._digest=function(O){return O==="hex"?o.toHex32(this.h,"big"):o.split32(this.h,"big")}},{"../common":373,"../utils":383,"minimalistic-assert":437}],382:[function(e,n,i){var o=e("../utils").rotr32;function a(p,d,g){return p&d^~p&g}function s(p,d,g){return p&d^p&g^d&g}function l(p,d,g){return p^d^g}i.ft_1=function(p,d,g,y){return p===0?a(d,g,y):p===1||p===3?l(d,g,y):p===2?s(d,g,y):void 0},i.ch32=a,i.maj32=s,i.p32=l,i.s0_256=function(p){return o(p,2)^o(p,13)^o(p,22)},i.s1_256=function(p){return o(p,6)^o(p,11)^o(p,25)},i.g0_256=function(p){return o(p,7)^o(p,18)^p>>>3},i.g1_256=function(p){return o(p,17)^o(p,19)^p>>>10}},{"../utils":383}],383:[function(e,n,i){var o=e("minimalistic-assert"),a=e("inherits");function s(g,y){return(64512&g.charCodeAt(y))==55296&&!(y<0||y+1>=g.length)&&(64512&g.charCodeAt(y+1))==56320}function l(g){return(g>>>24|g>>>8&65280|g<<8&16711680|(255&g)<<24)>>>0}function p(g){return g.length===1?"0"+g:g}function d(g){return g.length===7?"0"+g:g.length===6?"00"+g:g.length===5?"000"+g:g.length===4?"0000"+g:g.length===3?"00000"+g:g.length===2?"000000"+g:g.length===1?"0000000"+g:g}i.inherits=a,i.toArray=function(g,y){if(Array.isArray(g))return g.slice();if(!g)return[];var h=[];if(typeof g=="string")if(y){if(y==="hex")for((g=g.replace(/[^a-z0-9]+/gi,"")).length%2!=0&&(g="0"+g),f=0;f<g.length;f+=2)h.push(parseInt(g[f]+g[f+1],16))}else for(var u=0,f=0;f<g.length;f++){var c=g.charCodeAt(f);c<128?h[u++]=c:c<2048?(h[u++]=c>>6|192,h[u++]=63&c|128):s(g,f)?(c=65536+((1023&c)<<10)+(1023&g.charCodeAt(++f)),h[u++]=c>>18|240,h[u++]=c>>12&63|128,h[u++]=c>>6&63|128,h[u++]=63&c|128):(h[u++]=c>>12|224,h[u++]=c>>6&63|128,h[u++]=63&c|128)}else for(f=0;f<g.length;f++)h[f]=0|g[f];return h},i.toHex=function(g){for(var y="",h=0;h<g.length;h++)y+=p(g[h].toString(16));return y},i.htonl=l,i.toHex32=function(g,y){for(var h="",u=0;u<g.length;u++){var f=g[u];y==="little"&&(f=l(f)),h+=d(f.toString(16))}return h},i.zero2=p,i.zero8=d,i.join32=function(g,y,h,u){var f=h-y;o(f%4==0);for(var c=new Array(f/4),v=0,m=y;v<c.length;v++,m+=4){var b;b=u==="big"?g[m]<<24|g[m+1]<<16|g[m+2]<<8|g[m+3]:g[m+3]<<24|g[m+2]<<16|g[m+1]<<8|g[m],c[v]=b>>>0}return c},i.split32=function(g,y){for(var h=new Array(4*g.length),u=0,f=0;u<g.length;u++,f+=4){var c=g[u];y==="big"?(h[f]=c>>>24,h[f+1]=c>>>16&255,h[f+2]=c>>>8&255,h[f+3]=255&c):(h[f+3]=c>>>24,h[f+2]=c>>>16&255,h[f+1]=c>>>8&255,h[f]=255&c)}return h},i.rotr32=function(g,y){return g>>>y|g<<32-y},i.rotl32=function(g,y){return g<<y|g>>>32-y},i.sum32=function(g,y){return g+y>>>0},i.sum32_3=function(g,y,h){return g+y+h>>>0},i.sum32_4=function(g,y,h,u){return g+y+h+u>>>0},i.sum32_5=function(g,y,h,u,f){return g+y+h+u+f>>>0},i.sum64=function(g,y,h,u){var f=g[y],c=u+g[y+1]>>>0,v=(c<u?1:0)+h+f;g[y]=v>>>0,g[y+1]=c},i.sum64_hi=function(g,y,h,u){return(y+u>>>0<y?1:0)+g+h>>>0},i.sum64_lo=function(g,y,h,u){return y+u>>>0},i.sum64_4_hi=function(g,y,h,u,f,c,v,m){var b=0,w=y;return b+=(w=w+u>>>0)<y?1:0,b+=(w=w+c>>>0)<c?1:0,g+h+f+v+(b+=(w=w+m>>>0)<m?1:0)>>>0},i.sum64_4_lo=function(g,y,h,u,f,c,v,m){return y+u+c+m>>>0},i.sum64_5_hi=function(g,y,h,u,f,c,v,m,b,w){var _=0,C=y;return _+=(C=C+u>>>0)<y?1:0,_+=(C=C+c>>>0)<c?1:0,_+=(C=C+m>>>0)<m?1:0,g+h+f+v+b+(_+=(C=C+w>>>0)<w?1:0)>>>0},i.sum64_5_lo=function(g,y,h,u,f,c,v,m,b,w){return y+u+c+m+w>>>0},i.rotr64_hi=function(g,y,h){return(y<<32-h|g>>>h)>>>0},i.rotr64_lo=function(g,y,h){return(g<<32-h|y>>>h)>>>0},i.shr64_hi=function(g,y,h){return g>>>h},i.shr64_lo=function(g,y,h){return(g<<32-h|y>>>h)>>>0}},{inherits:387,"minimalistic-assert":437}],384:[function(e,n,i){var o=e("hash.js"),a=e("minimalistic-crypto-utils"),s=e("minimalistic-assert");function l(p){if(!(this instanceof l))return new l(p);this.hash=p.hash,this.predResist=!!p.predResist,this.outLen=this.hash.outSize,this.minEntropy=p.minEntropy||this.hash.hmacStrength,this._reseed=null,this.reseedInterval=null,this.K=null,this.V=null;var d=a.toArray(p.entropy,p.entropyEnc||"hex"),g=a.toArray(p.nonce,p.nonceEnc||"hex"),y=a.toArray(p.pers,p.persEnc||"hex");s(d.length>=this.minEntropy/8,"Not enough entropy. Minimum is: "+this.minEntropy+" bits"),this._init(d,g,y)}n.exports=l,l.prototype._init=function(p,d,g){var y=p.concat(d).concat(g);this.K=new Array(this.outLen/8),this.V=new Array(this.outLen/8);for(var h=0;h<this.V.length;h++)this.K[h]=0,this.V[h]=1;this._update(y),this._reseed=1,this.reseedInterval=281474976710656},l.prototype._hmac=function(){return new o.hmac(this.hash,this.K)},l.prototype._update=function(p){var d=this._hmac().update(this.V).update([0]);p&&(d=d.update(p)),this.K=d.digest(),this.V=this._hmac().update(this.V).digest(),p&&(this.K=this._hmac().update(this.V).update([1]).update(p).digest(),this.V=this._hmac().update(this.V).digest())},l.prototype.reseed=function(p,d,g,y){typeof d!="string"&&(y=g,g=d,d=null),p=a.toArray(p,d),g=a.toArray(g,y),s(p.length>=this.minEntropy/8,"Not enough entropy. Minimum is: "+this.minEntropy+" bits"),this._update(p.concat(g||[])),this._reseed=1},l.prototype.generate=function(p,d,g,y){if(this._reseed>this.reseedInterval)throw new Error("Reseed is required");typeof d!="string"&&(y=g,g=d,d=null),g&&(g=a.toArray(g,y||"hex"),this._update(g));for(var h=[];h.length<p;)this.V=this._hmac().update(this.V).digest(),h=h.concat(this.V);var u=h.slice(0,p);return this._update(g),this._reseed++,a.encode(u,d)}},{"hash.js":372,"minimalistic-assert":437,"minimalistic-crypto-utils":438}],385:[function(e,n,i){i.read=function(o,a,s,l,p){var d,g,y=8*p-l-1,h=(1<<y)-1,u=h>>1,f=-7,c=s?p-1:0,v=s?-1:1,m=o[a+c];for(c+=v,d=m&(1<<-f)-1,m>>=-f,f+=y;f>0;d=256*d+o[a+c],c+=v,f-=8);for(g=d&(1<<-f)-1,d>>=-f,f+=l;f>0;g=256*g+o[a+c],c+=v,f-=8);if(d===0)d=1-u;else{if(d===h)return g?NaN:1/0*(m?-1:1);g+=Math.pow(2,l),d-=u}return(m?-1:1)*g*Math.pow(2,d-l)},i.write=function(o,a,s,l,p,d){var g,y,h,u=8*d-p-1,f=(1<<u)-1,c=f>>1,v=p===23?Math.pow(2,-24)-Math.pow(2,-77):0,m=l?0:d-1,b=l?1:-1,w=a<0||a===0&&1/a<0?1:0;for(a=Math.abs(a),isNaN(a)||a===1/0?(y=isNaN(a)?1:0,g=f):(g=Math.floor(Math.log(a)/Math.LN2),a*(h=Math.pow(2,-g))<1&&(g--,h*=2),(a+=g+c>=1?v/h:v*Math.pow(2,1-c))*h>=2&&(g++,h/=2),g+c>=f?(y=0,g=f):g+c>=1?(y=(a*h-1)*Math.pow(2,p),g+=c):(y=a*Math.pow(2,c-1)*Math.pow(2,p),g=0));p>=8;o[s+m]=255&y,m+=b,y/=256,p-=8);for(g=g<<p|y,u+=p;u>0;o[s+m]=255&g,m+=b,g/=256,u-=8);o[s+m-b]|=128*w}},{}],386:[function(e,n,i){(function(o){var a,s,l=o.MutationObserver||o.WebKitMutationObserver;if(l){var p=0,d=new l(u),g=o.document.createTextNode("");d.observe(g,{characterData:!0}),a=function(){g.data=p=++p%2}}else if(o.setImmediate||o.MessageChannel===void 0)a="document"in o&&"onreadystatechange"in o.document.createElement("script")?function(){var f=o.document.createElement("script");f.onreadystatechange=function(){u(),f.onreadystatechange=null,f.parentNode.removeChild(f),f=null},o.document.documentElement.appendChild(f)}:function(){setTimeout(u,0)};else{var y=new o.MessageChannel;y.port1.onmessage=u,a=function(){y.port2.postMessage(0)}}var h=[];function u(){var f,c;s=!0;for(var v=h.length;v;){for(c=h,h=[],f=-1;++f<v;)c[f]();v=h.length}s=!1}n.exports=function(f){h.push(f)!==1||s||a()}}).call(this,typeof At!="undefined"?At:typeof self!="undefined"?self:typeof window!="undefined"?window:{})},{}],387:[function(e,n,i){typeof Object.create=="function"?n.exports=function(o,a){a&&(o.super_=a,o.prototype=Object.create(a.prototype,{constructor:{value:o,enumerable:!1,writable:!0,configurable:!0}}))}:n.exports=function(o,a){if(a){o.super_=a;var s=function(){};s.prototype=a.prototype,o.prototype=new s,o.prototype.constructor=o}}},{}],388:[function(e,n,i){/*!
* Determine if an object is a Buffer
*
* @author   Feross Aboukhadijeh <https://feross.org>
* @license  MIT
*/function o(a){return!!a.constructor&&typeof a.constructor.isBuffer=="function"&&a.constructor.isBuffer(a)}n.exports=function(a){return a!=null&&(o(a)||function(s){return typeof s.readFloatLE=="function"&&typeof s.slice=="function"&&o(s.slice(0,0))}(a)||!!a._isBuffer)}},{}],389:[function(e,n,i){var o={}.toString;n.exports=Array.isArray||function(a){return o.call(a)=="[object Array]"}},{}],390:[function(e,n,i){var o=e("./utils"),a=e("./support"),s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";i.encode=function(l){for(var p,d,g,y,h,u,f,c=[],v=0,m=l.length,b=m,w=o.getTypeOf(l)!=="string";v<l.length;)b=m-v,w?(p=l[v++],d=v<m?l[v++]:0,g=v<m?l[v++]:0):(p=l.charCodeAt(v++),d=v<m?l.charCodeAt(v++):0,g=v<m?l.charCodeAt(v++):0),y=p>>2,h=(3&p)<<4|d>>4,u=b>1?(15&d)<<2|g>>6:64,f=b>2?63&g:64,c.push(s.charAt(y)+s.charAt(h)+s.charAt(u)+s.charAt(f));return c.join("")},i.decode=function(l){var p,d,g,y,h,u,f=0,c=0;if(l.substr(0,"data:".length)==="data:")throw new Error("Invalid base64 input, it looks like a data url.");var v,m=3*(l=l.replace(/[^A-Za-z0-9\+\/\=]/g,"")).length/4;if(l.charAt(l.length-1)===s.charAt(64)&&m--,l.charAt(l.length-2)===s.charAt(64)&&m--,m%1!=0)throw new Error("Invalid base64 input, bad content length.");for(v=a.uint8array?new Uint8Array(0|m):new Array(0|m);f<l.length;)p=s.indexOf(l.charAt(f++))<<2|(y=s.indexOf(l.charAt(f++)))>>4,d=(15&y)<<4|(h=s.indexOf(l.charAt(f++)))>>2,g=(3&h)<<6|(u=s.indexOf(l.charAt(f++))),v[c++]=p,h!==64&&(v[c++]=d),u!==64&&(v[c++]=g);return v}},{"./support":419,"./utils":421}],391:[function(e,n,i){var o=e("./external"),a=e("./stream/DataWorker"),s=e("./stream/DataLengthProbe"),l=e("./stream/Crc32Probe");s=e("./stream/DataLengthProbe");function p(d,g,y,h,u){this.compressedSize=d,this.uncompressedSize=g,this.crc32=y,this.compression=h,this.compressedContent=u}p.prototype={getContentWorker:function(){var d=new a(o.Promise.resolve(this.compressedContent)).pipe(this.compression.uncompressWorker()).pipe(new s("data_length")),g=this;return d.on("end",function(){if(this.streamInfo.data_length!==g.uncompressedSize)throw new Error("Bug : uncompressed data size mismatch")}),d},getCompressedWorker:function(){return new a(o.Promise.resolve(this.compressedContent)).withStreamInfo("compressedSize",this.compressedSize).withStreamInfo("uncompressedSize",this.uncompressedSize).withStreamInfo("crc32",this.crc32).withStreamInfo("compression",this.compression)}},p.createWorkerFrom=function(d,g,y){return d.pipe(new l).pipe(new s("uncompressedSize")).pipe(g.compressWorker(y)).pipe(new s("compressedSize")).withStreamInfo("compression",g)},n.exports=p},{"./external":395,"./stream/Crc32Probe":414,"./stream/DataLengthProbe":415,"./stream/DataWorker":416}],392:[function(e,n,i){var o=e("./stream/GenericWorker");i.STORE={magic:"\0\0",compressWorker:function(a){return new o("STORE compression")},uncompressWorker:function(){return new o("STORE decompression")}},i.DEFLATE=e("./flate")},{"./flate":396,"./stream/GenericWorker":417}],393:[function(e,n,i){var o=e("./utils"),a=function(){for(var s,l=[],p=0;p<256;p++){s=p;for(var d=0;d<8;d++)s=1&s?3988292384^s>>>1:s>>>1;l[p]=s}return l}();n.exports=function(s,l){return s!==void 0&&s.length?o.getTypeOf(s)!=="string"?function(p,d,g,y){var h=a,u=y+g;p^=-1;for(var f=y;f<u;f++)p=p>>>8^h[255&(p^d[f])];return-1^p}(0|l,s,s.length,0):function(p,d,g,y){var h=a,u=y+g;p^=-1;for(var f=y;f<u;f++)p=p>>>8^h[255&(p^d.charCodeAt(f))];return-1^p}(0|l,s,s.length,0):0}},{"./utils":421}],394:[function(e,n,i){i.base64=!1,i.binary=!1,i.dir=!1,i.createFolders=!0,i.date=null,i.compression=null,i.compressionOptions=null,i.comment=null,i.unixPermissions=null,i.dosPermissions=null},{}],395:[function(e,n,i){var o=null;o=typeof Promise!="undefined"?Promise:e("lie"),n.exports={Promise:o}},{lie:425}],396:[function(e,n,i){var o=typeof Uint8Array!="undefined"&&typeof Uint16Array!="undefined"&&typeof Uint32Array!="undefined",a=e("pako"),s=e("./utils"),l=e("./stream/GenericWorker"),p=o?"uint8array":"array";function d(g,y){l.call(this,"FlateWorker/"+g),this._pako=null,this._pakoAction=g,this._pakoOptions=y,this.meta={}}i.magic="\b\0",s.inherits(d,l),d.prototype.processChunk=function(g){this.meta=g.meta,this._pako===null&&this._createPako(),this._pako.push(s.transformTo(p,g.data),!1)},d.prototype.flush=function(){l.prototype.flush.call(this),this._pako===null&&this._createPako(),this._pako.push([],!0)},d.prototype.cleanUp=function(){l.prototype.cleanUp.call(this),this._pako=null},d.prototype._createPako=function(){this._pako=new a[this._pakoAction]({raw:!0,level:this._pakoOptions.level||-1});var g=this;this._pako.onData=function(y){g.push({data:y,meta:g.meta})}},i.compressWorker=function(g){return new d("Deflate",g)},i.uncompressWorker=function(){return new d("Inflate",{})}},{"./stream/GenericWorker":417,"./utils":421,pako:439}],397:[function(e,n,i){var o=e("../utils"),a=e("../stream/GenericWorker"),s=e("../utf8"),l=e("../crc32"),p=e("../signature"),d=function(u,f){var c,v="";for(c=0;c<f;c++)v+=String.fromCharCode(255&u),u>>>=8;return v},g=function(u,f,c,v,m,b){var w,_,C=u.file,R=u.compression,I=b!==s.utf8encode,P=o.transformTo("string",b(C.name)),N=o.transformTo("string",s.utf8encode(C.name)),A=C.comment,$=o.transformTo("string",b(A)),T=o.transformTo("string",s.utf8encode(A)),M=N.length!==C.name.length,S=T.length!==A.length,E="",k="",O="",x=C.dir,j=C.date,H={crc32:0,compressedSize:0,uncompressedSize:0};f&&!c||(H.crc32=u.crc32,H.compressedSize=u.compressedSize,H.uncompressedSize=u.uncompressedSize);var F=0;f&&(F|=8),I||!M&&!S||(F|=2048);var V,W,U,Y=0,K=0;x&&(Y|=16),m==="UNIX"?(K=798,Y|=(V=C.unixPermissions,W=x,U=V,V||(U=W?16893:33204),(65535&U)<<16)):(K=20,Y|=63&(C.dosPermissions||0)),w=j.getUTCHours(),w<<=6,w|=j.getUTCMinutes(),w<<=5,w|=j.getUTCSeconds()/2,_=j.getUTCFullYear()-1980,_<<=4,_|=j.getUTCMonth()+1,_<<=5,_|=j.getUTCDate(),M&&(k=d(1,1)+d(l(P),4)+N,E+="up"+d(k.length,2)+k),S&&(O=d(1,1)+d(l($),4)+T,E+="uc"+d(O.length,2)+O);var D="";return D+=`
\0`,D+=d(F,2),D+=R.magic,D+=d(w,2),D+=d(_,2),D+=d(H.crc32,4),D+=d(H.compressedSize,4),D+=d(H.uncompressedSize,4),D+=d(P.length,2),D+=d(E.length,2),{fileRecord:p.LOCAL_FILE_HEADER+D+P+E,dirRecord:p.CENTRAL_FILE_HEADER+d(K,2)+D+d($.length,2)+"\0\0\0\0"+d(Y,4)+d(v,4)+P+E+$}},y=function(u){return p.DATA_DESCRIPTOR+d(u.crc32,4)+d(u.compressedSize,4)+d(u.uncompressedSize,4)};function h(u,f,c,v){a.call(this,"ZipFileWorker"),this.bytesWritten=0,this.zipComment=f,this.zipPlatform=c,this.encodeFileName=v,this.streamFiles=u,this.accumulate=!1,this.contentBuffer=[],this.dirRecords=[],this.currentSourceOffset=0,this.entriesCount=0,this.currentFile=null,this._sources=[]}o.inherits(h,a),h.prototype.push=function(u){var f=u.meta.percent||0,c=this.entriesCount,v=this._sources.length;this.accumulate?this.contentBuffer.push(u):(this.bytesWritten+=u.data.length,a.prototype.push.call(this,{data:u.data,meta:{currentFile:this.currentFile,percent:c?(f+100*(c-v-1))/c:100}}))},h.prototype.openedSource=function(u){this.currentSourceOffset=this.bytesWritten,this.currentFile=u.file.name;var f=this.streamFiles&&!u.file.dir;if(f){var c=g(u,f,!1,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);this.push({data:c.fileRecord,meta:{percent:0}})}else this.accumulate=!0},h.prototype.closedSource=function(u){this.accumulate=!1;var f=this.streamFiles&&!u.file.dir,c=g(u,f,!0,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);if(this.dirRecords.push(c.dirRecord),f)this.push({data:y(u),meta:{percent:100}});else for(this.push({data:c.fileRecord,meta:{percent:0}});this.contentBuffer.length;)this.push(this.contentBuffer.shift());this.currentFile=null},h.prototype.flush=function(){for(var u=this.bytesWritten,f=0;f<this.dirRecords.length;f++)this.push({data:this.dirRecords[f],meta:{percent:100}});var c=this.bytesWritten-u,v=function(m,b,w,_,C){var R=o.transformTo("string",C(_));return p.CENTRAL_DIRECTORY_END+"\0\0\0\0"+d(m,2)+d(m,2)+d(b,4)+d(w,4)+d(R.length,2)+R}(this.dirRecords.length,c,u,this.zipComment,this.encodeFileName);this.push({data:v,meta:{percent:100}})},h.prototype.prepareNextSource=function(){this.previous=this._sources.shift(),this.openedSource(this.previous.streamInfo),this.isPaused?this.previous.pause():this.previous.resume()},h.prototype.registerPrevious=function(u){this._sources.push(u);var f=this;return u.on("data",function(c){f.processChunk(c)}),u.on("end",function(){f.closedSource(f.previous.streamInfo),f._sources.length?f.prepareNextSource():f.end()}),u.on("error",function(c){f.error(c)}),this},h.prototype.resume=function(){return!!a.prototype.resume.call(this)&&(!this.previous&&this._sources.length?(this.prepareNextSource(),!0):this.previous||this._sources.length||this.generatedError?void 0:(this.end(),!0))},h.prototype.error=function(u){var f=this._sources;if(!a.prototype.error.call(this,u))return!1;for(var c=0;c<f.length;c++)try{f[c].error(u)}catch{}return!0},h.prototype.lock=function(){a.prototype.lock.call(this);for(var u=this._sources,f=0;f<u.length;f++)u[f].lock()},n.exports=h},{"../crc32":393,"../signature":412,"../stream/GenericWorker":417,"../utf8":420,"../utils":421}],398:[function(e,n,i){var o=e("../compressions"),a=e("./ZipFileWorker");i.generateWorker=function(s,l,p){var d=new a(l.streamFiles,p,l.platform,l.encodeFileName),g=0;try{s.forEach(function(y,h){g++;var u=function(m,b){var w=m||b,_=o[w];if(!_)throw new Error(w+" is not a valid compression method !");return _}(h.options.compression,l.compression),f=h.options.compressionOptions||l.compressionOptions||{},c=h.dir,v=h.date;h._compressWorker(u,f).withStreamInfo("file",{name:y,dir:c,date:v,comment:h.comment||"",unixPermissions:h.unixPermissions,dosPermissions:h.dosPermissions}).pipe(d)}),d.entriesCount=g}catch(y){d.error(y)}return d}},{"../compressions":392,"./ZipFileWorker":397}],399:[function(e,n,i){function o(){if(!(this instanceof o))return new o;if(arguments.length)throw new Error("The constructor with parameters has been removed in JSZip 3.0, please check the upgrade guide.");this.files={},this.comment=null,this.root="",this.clone=function(){var a=new o;for(var s in this)typeof this[s]!="function"&&(a[s]=this[s]);return a}}o.prototype=e("./object"),o.prototype.loadAsync=e("./load"),o.support=e("./support"),o.defaults=e("./defaults"),o.version="3.5.0",o.loadAsync=function(a,s){return new o().loadAsync(a,s)},o.external=e("./external"),n.exports=o},{"./defaults":394,"./external":395,"./load":400,"./object":404,"./support":419}],400:[function(e,n,i){var o=e("./utils"),a=e("./external"),s=e("./utf8"),l=(o=e("./utils"),e("./zipEntries")),p=e("./stream/Crc32Probe"),d=e("./nodejsUtils");function g(y){return new a.Promise(function(h,u){var f=y.decompressed.getContentWorker().pipe(new p);f.on("error",function(c){u(c)}).on("end",function(){f.streamInfo.crc32!==y.decompressed.crc32?u(new Error("Corrupted zip : CRC32 mismatch")):h()}).resume()})}n.exports=function(y,h){var u=this;return h=o.extend(h||{},{base64:!1,checkCRC32:!1,optimizedBinaryString:!1,createFolders:!1,decodeFileName:s.utf8decode}),d.isNode&&d.isStream(y)?a.Promise.reject(new Error("JSZip can't accept a stream when loading a zip file.")):o.prepareContent("the loaded zip file",y,!0,h.optimizedBinaryString,h.base64).then(function(f){var c=new l(h);return c.load(f),c}).then(function(f){var c=[a.Promise.resolve(f)],v=f.files;if(h.checkCRC32)for(var m=0;m<v.length;m++)c.push(g(v[m]));return a.Promise.all(c)}).then(function(f){for(var c=f.shift(),v=c.files,m=0;m<v.length;m++){var b=v[m];u.file(b.fileNameStr,b.decompressed,{binary:!0,optimizedBinaryString:!0,date:b.date,dir:b.dir,comment:b.fileCommentStr.length?b.fileCommentStr:null,unixPermissions:b.unixPermissions,dosPermissions:b.dosPermissions,createFolders:h.createFolders})}return c.zipComment.length&&(u.comment=c.zipComment),u})}},{"./external":395,"./nodejsUtils":403,"./stream/Crc32Probe":414,"./utf8":420,"./utils":421,"./zipEntries":422}],401:[function(e,n,i){var o=e("../utils"),a=e("../stream/GenericWorker");function s(l,p){a.call(this,"Nodejs stream input adapter for "+l),this._upstreamEnded=!1,this._bindStream(p)}o.inherits(s,a),s.prototype._bindStream=function(l){var p=this;this._stream=l,l.pause(),l.on("data",function(d){p.push({data:d,meta:{percent:0}})}).on("error",function(d){p.isPaused?this.generatedError=d:p.error(d)}).on("end",function(){p.isPaused?p._upstreamEnded=!0:p.end()})},s.prototype.pause=function(){return!!a.prototype.pause.call(this)&&(this._stream.pause(),!0)},s.prototype.resume=function(){return!!a.prototype.resume.call(this)&&(this._upstreamEnded?this.end():this._stream.resume(),!0)},n.exports=s},{"../stream/GenericWorker":417,"../utils":421}],402:[function(e,n,i){var o=e("readable-stream").Readable;function a(s,l,p){o.call(this,l),this._helper=s;var d=this;s.on("data",function(g,y){d.push(g)||d._helper.pause(),p&&p(y)}).on("error",function(g){d.emit("error",g)}).on("end",function(){d.push(null)})}e("../utils").inherits(a,o),a.prototype._read=function(){this._helper.resume()},n.exports=a},{"../utils":421,"readable-stream":405}],403:[function(e,n,i){(function(o){n.exports={isNode:o!==void 0,newBufferFrom:function(a,s){if(o.from&&o.from!==Uint8Array.from)return o.from(a,s);if(typeof a=="number")throw new Error('The "data" argument must not be a number');return new o(a,s)},allocBuffer:function(a){if(o.alloc)return o.alloc(a);var s=new o(a);return s.fill(0),s},isBuffer:function(a){return o.isBuffer(a)},isStream:function(a){return a&&typeof a.on=="function"&&typeof a.pause=="function"&&typeof a.resume=="function"}}}).call(this,e("buffer").Buffer)},{buffer:216}],404:[function(e,n,i){var o=e("./utf8"),a=e("./utils"),s=e("./stream/GenericWorker"),l=e("./stream/StreamHelper"),p=e("./defaults"),d=e("./compressedObject"),g=e("./zipObject"),y=e("./generate"),h=e("./nodejsUtils"),u=e("./nodejs/NodejsStreamInputAdapter"),f=function(_,C,R){var I,P=a.getTypeOf(C),N=a.extend(R||{},p);N.date=N.date||new Date,N.compression!==null&&(N.compression=N.compression.toUpperCase()),typeof N.unixPermissions=="string"&&(N.unixPermissions=parseInt(N.unixPermissions,8)),N.unixPermissions&&16384&N.unixPermissions&&(N.dir=!0),N.dosPermissions&&16&N.dosPermissions&&(N.dir=!0),N.dir&&(_=v(_)),N.createFolders&&(I=c(_))&&m.call(this,I,!0);var A=P==="string"&&N.binary===!1&&N.base64===!1;R&&R.binary!==void 0||(N.binary=!A),(C instanceof d&&C.uncompressedSize===0||N.dir||!C||C.length===0)&&(N.base64=!1,N.binary=!0,C="",N.compression="STORE",P="string");var $=null;$=C instanceof d||C instanceof s?C:h.isNode&&h.isStream(C)?new u(_,C):a.prepareContent(_,C,N.binary,N.optimizedBinaryString,N.base64);var T=new g(_,$,N);this.files[_]=T},c=function(_){_.slice(-1)==="/"&&(_=_.substring(0,_.length-1));var C=_.lastIndexOf("/");return C>0?_.substring(0,C):""},v=function(_){return _.slice(-1)!=="/"&&(_+="/"),_},m=function(_,C){return C=C!==void 0?C:p.createFolders,_=v(_),this.files[_]||f.call(this,_,null,{dir:!0,createFolders:C}),this.files[_]};function b(_){return Object.prototype.toString.call(_)==="[object RegExp]"}var w={load:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},forEach:function(_){var C,R,I;for(C in this.files)this.files.hasOwnProperty(C)&&(I=this.files[C],(R=C.slice(this.root.length,C.length))&&C.slice(0,this.root.length)===this.root&&_(R,I))},filter:function(_){var C=[];return this.forEach(function(R,I){_(R,I)&&C.push(I)}),C},file:function(_,C,R){if(arguments.length===1){if(b(_)){var I=_;return this.filter(function(N,A){return!A.dir&&I.test(N)})}var P=this.files[this.root+_];return P&&!P.dir?P:null}return _=this.root+_,f.call(this,_,C,R),this},folder:function(_){if(!_)return this;if(b(_))return this.filter(function(P,N){return N.dir&&_.test(P)});var C=this.root+_,R=m.call(this,C),I=this.clone();return I.root=R.name,I},remove:function(_){_=this.root+_;var C=this.files[_];if(C||(_.slice(-1)!=="/"&&(_+="/"),C=this.files[_]),C&&!C.dir)delete this.files[_];else for(var R=this.filter(function(P,N){return N.name.slice(0,_.length)===_}),I=0;I<R.length;I++)delete this.files[R[I].name];return this},generate:function(_){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},generateInternalStream:function(_){var C,R={};try{if((R=a.extend(_||{},{streamFiles:!1,compression:"STORE",compressionOptions:null,type:"",platform:"DOS",comment:null,mimeType:"application/zip",encodeFileName:o.utf8encode})).type=R.type.toLowerCase(),R.compression=R.compression.toUpperCase(),R.type==="binarystring"&&(R.type="string"),!R.type)throw new Error("No output type specified.");a.checkSupport(R.type),R.platform!=="darwin"&&R.platform!=="freebsd"&&R.platform!=="linux"&&R.platform!=="sunos"||(R.platform="UNIX"),R.platform==="win32"&&(R.platform="DOS");var I=R.comment||this.comment||"";C=y.generateWorker(this,R,I)}catch(P){(C=new s("error")).error(P)}return new l(C,R.type||"string",R.mimeType)},generateAsync:function(_,C){return this.generateInternalStream(_).accumulate(C)},generateNodeStream:function(_,C){return(_=_||{}).type||(_.type="nodebuffer"),this.generateInternalStream(_).toNodejsStream(C)}};n.exports=w},{"./compressedObject":391,"./defaults":394,"./generate":398,"./nodejs/NodejsStreamInputAdapter":401,"./nodejsUtils":403,"./stream/GenericWorker":417,"./stream/StreamHelper":418,"./utf8":420,"./utils":421,"./zipObject":424}],405:[function(e,n,i){n.exports=e("stream")},{stream:506}],406:[function(e,n,i){var o=e("./DataReader");function a(s){o.call(this,s);for(var l=0;l<this.data.length;l++)s[l]=255&s[l]}e("../utils").inherits(a,o),a.prototype.byteAt=function(s){return this.data[this.zero+s]},a.prototype.lastIndexOfSignature=function(s){for(var l=s.charCodeAt(0),p=s.charCodeAt(1),d=s.charCodeAt(2),g=s.charCodeAt(3),y=this.length-4;y>=0;--y)if(this.data[y]===l&&this.data[y+1]===p&&this.data[y+2]===d&&this.data[y+3]===g)return y-this.zero;return-1},a.prototype.readAndCheckSignature=function(s){var l=s.charCodeAt(0),p=s.charCodeAt(1),d=s.charCodeAt(2),g=s.charCodeAt(3),y=this.readData(4);return l===y[0]&&p===y[1]&&d===y[2]&&g===y[3]},a.prototype.readData=function(s){if(this.checkOffset(s),s===0)return[];var l=this.data.slice(this.zero+this.index,this.zero+this.index+s);return this.index+=s,l},n.exports=a},{"../utils":421,"./DataReader":407}],407:[function(e,n,i){var o=e("../utils");function a(s){this.data=s,this.length=s.length,this.index=0,this.zero=0}a.prototype={checkOffset:function(s){this.checkIndex(this.index+s)},checkIndex:function(s){if(this.length<this.zero+s||s<0)throw new Error("End of data reached (data length = "+this.length+", asked index = "+s+"). Corrupted zip ?")},setIndex:function(s){this.checkIndex(s),this.index=s},skip:function(s){this.setIndex(this.index+s)},byteAt:function(s){},readInt:function(s){var l,p=0;for(this.checkOffset(s),l=this.index+s-1;l>=this.index;l--)p=(p<<8)+this.byteAt(l);return this.index+=s,p},readString:function(s){return o.transformTo("string",this.readData(s))},readData:function(s){},lastIndexOfSignature:function(s){},readAndCheckSignature:function(s){},readDate:function(){var s=this.readInt(4);return new Date(Date.UTC(1980+(s>>25&127),(s>>21&15)-1,s>>16&31,s>>11&31,s>>5&63,(31&s)<<1))}},n.exports=a},{"../utils":421}],408:[function(e,n,i){var o=e("./Uint8ArrayReader");function a(s){o.call(this,s)}e("../utils").inherits(a,o),a.prototype.readData=function(s){this.checkOffset(s);var l=this.data.slice(this.zero+this.index,this.zero+this.index+s);return this.index+=s,l},n.exports=a},{"../utils":421,"./Uint8ArrayReader":410}],409:[function(e,n,i){var o=e("./DataReader");function a(s){o.call(this,s)}e("../utils").inherits(a,o),a.prototype.byteAt=function(s){return this.data.charCodeAt(this.zero+s)},a.prototype.lastIndexOfSignature=function(s){return this.data.lastIndexOf(s)-this.zero},a.prototype.readAndCheckSignature=function(s){return s===this.readData(4)},a.prototype.readData=function(s){this.checkOffset(s);var l=this.data.slice(this.zero+this.index,this.zero+this.index+s);return this.index+=s,l},n.exports=a},{"../utils":421,"./DataReader":407}],410:[function(e,n,i){var o=e("./ArrayReader");function a(s){o.call(this,s)}e("../utils").inherits(a,o),a.prototype.readData=function(s){if(this.checkOffset(s),s===0)return new Uint8Array(0);var l=this.data.subarray(this.zero+this.index,this.zero+this.index+s);return this.index+=s,l},n.exports=a},{"../utils":421,"./ArrayReader":406}],411:[function(e,n,i){var o=e("../utils"),a=e("../support"),s=e("./ArrayReader"),l=e("./StringReader"),p=e("./NodeBufferReader"),d=e("./Uint8ArrayReader");n.exports=function(g){var y=o.getTypeOf(g);return o.checkSupport(y),y!=="string"||a.uint8array?y==="nodebuffer"?new p(g):a.uint8array?new d(o.transformTo("uint8array",g)):new s(o.transformTo("array",g)):new l(g)}},{"../support":419,"../utils":421,"./ArrayReader":406,"./NodeBufferReader":408,"./StringReader":409,"./Uint8ArrayReader":410}],412:[function(e,n,i){i.LOCAL_FILE_HEADER="PK",i.CENTRAL_FILE_HEADER="PK",i.CENTRAL_DIRECTORY_END="PK",i.ZIP64_CENTRAL_DIRECTORY_LOCATOR="PK\x07",i.ZIP64_CENTRAL_DIRECTORY_END="PK",i.DATA_DESCRIPTOR="PK\x07\b"},{}],413:[function(e,n,i){var o=e("./GenericWorker"),a=e("../utils");function s(l){o.call(this,"ConvertWorker to "+l),this.destType=l}a.inherits(s,o),s.prototype.processChunk=function(l){this.push({data:a.transformTo(this.destType,l.data),meta:l.meta})},n.exports=s},{"../utils":421,"./GenericWorker":417}],414:[function(e,n,i){var o=e("./GenericWorker"),a=e("../crc32");function s(){o.call(this,"Crc32Probe"),this.withStreamInfo("crc32",0)}e("../utils").inherits(s,o),s.prototype.processChunk=function(l){this.streamInfo.crc32=a(l.data,this.streamInfo.crc32||0),this.push(l)},n.exports=s},{"../crc32":393,"../utils":421,"./GenericWorker":417}],415:[function(e,n,i){var o=e("../utils"),a=e("./GenericWorker");function s(l){a.call(this,"DataLengthProbe for "+l),this.propName=l,this.withStreamInfo(l,0)}o.inherits(s,a),s.prototype.processChunk=function(l){if(l){var p=this.streamInfo[this.propName]||0;this.streamInfo[this.propName]=p+l.data.length}a.prototype.processChunk.call(this,l)},n.exports=s},{"../utils":421,"./GenericWorker":417}],416:[function(e,n,i){var o=e("../utils"),a=e("./GenericWorker");function s(l){a.call(this,"DataWorker");var p=this;this.dataIsReady=!1,this.index=0,this.max=0,this.data=null,this.type="",this._tickScheduled=!1,l.then(function(d){p.dataIsReady=!0,p.data=d,p.max=d&&d.length||0,p.type=o.getTypeOf(d),p.isPaused||p._tickAndRepeat()},function(d){p.error(d)})}o.inherits(s,a),s.prototype.cleanUp=function(){a.prototype.cleanUp.call(this),this.data=null},s.prototype.resume=function(){return!!a.prototype.resume.call(this)&&(!this._tickScheduled&&this.dataIsReady&&(this._tickScheduled=!0,o.delay(this._tickAndRepeat,[],this)),!0)},s.prototype._tickAndRepeat=function(){this._tickScheduled=!1,this.isPaused||this.isFinished||(this._tick(),this.isFinished||(o.delay(this._tickAndRepeat,[],this),this._tickScheduled=!0))},s.prototype._tick=function(){if(this.isPaused||this.isFinished)return!1;var l=null,p=Math.min(this.max,this.index+16384);if(this.index>=this.max)return this.end();switch(this.type){case"string":l=this.data.substring(this.index,p);break;case"uint8array":l=this.data.subarray(this.index,p);break;case"array":case"nodebuffer":l=this.data.slice(this.index,p)}return this.index=p,this.push({data:l,meta:{percent:this.max?this.index/this.max*100:0}})},n.exports=s},{"../utils":421,"./GenericWorker":417}],417:[function(e,n,i){function o(a){this.name=a||"default",this.streamInfo={},this.generatedError=null,this.extraStreamInfo={},this.isPaused=!0,this.isFinished=!1,this.isLocked=!1,this._listeners={data:[],end:[],error:[]},this.previous=null}o.prototype={push:function(a){this.emit("data",a)},end:function(){if(this.isFinished)return!1;this.flush();try{this.emit("end"),this.cleanUp(),this.isFinished=!0}catch(a){this.emit("error",a)}return!0},error:function(a){return!this.isFinished&&(this.isPaused?this.generatedError=a:(this.isFinished=!0,this.emit("error",a),this.previous&&this.previous.error(a),this.cleanUp()),!0)},on:function(a,s){return this._listeners[a].push(s),this},cleanUp:function(){this.streamInfo=this.generatedError=this.extraStreamInfo=null,this._listeners=[]},emit:function(a,s){if(this._listeners[a])for(var l=0;l<this._listeners[a].length;l++)this._listeners[a][l].call(this,s)},pipe:function(a){return a.registerPrevious(this)},registerPrevious:function(a){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.streamInfo=a.streamInfo,this.mergeStreamInfo(),this.previous=a;var s=this;return a.on("data",function(l){s.processChunk(l)}),a.on("end",function(){s.end()}),a.on("error",function(l){s.error(l)}),this},pause:function(){return!this.isPaused&&!this.isFinished&&(this.isPaused=!0,this.previous&&this.previous.pause(),!0)},resume:function(){if(!this.isPaused||this.isFinished)return!1;this.isPaused=!1;var a=!1;return this.generatedError&&(this.error(this.generatedError),a=!0),this.previous&&this.previous.resume(),!a},flush:function(){},processChunk:function(a){this.push(a)},withStreamInfo:function(a,s){return this.extraStreamInfo[a]=s,this.mergeStreamInfo(),this},mergeStreamInfo:function(){for(var a in this.extraStreamInfo)this.extraStreamInfo.hasOwnProperty(a)&&(this.streamInfo[a]=this.extraStreamInfo[a])},lock:function(){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.isLocked=!0,this.previous&&this.previous.lock()},toString:function(){var a="Worker "+this.name;return this.previous?this.previous+" -> "+a:a}},n.exports=o},{}],418:[function(e,n,i){(function(o){var a=e("../utils"),s=e("./ConvertWorker"),l=e("./GenericWorker"),p=e("../base64"),d=e("../support"),g=e("../external"),y=null;if(d.nodestream)try{y=e("../nodejs/NodejsStreamOutputAdapter")}catch{}function h(f,c){return new g.Promise(function(v,m){var b=[],w=f._internalType,_=f._outputType,C=f._mimeType;f.on("data",function(R,I){b.push(R),c&&c(I)}).on("error",function(R){b=[],m(R)}).on("end",function(){try{var R=function(I,P,N){switch(I){case"blob":return a.newBlob(a.transformTo("arraybuffer",P),N);case"base64":return p.encode(P);default:return a.transformTo(I,P)}}(_,function(I,P){var N,A=0,$=null,T=0;for(N=0;N<P.length;N++)T+=P[N].length;switch(I){case"string":return P.join("");case"array":return Array.prototype.concat.apply([],P);case"uint8array":for($=new Uint8Array(T),N=0;N<P.length;N++)$.set(P[N],A),A+=P[N].length;return $;case"nodebuffer":return o.concat(P);default:throw new Error("concat : unsupported type '"+I+"'")}}(w,b),C);v(R)}catch(I){m(I)}b=[]}).resume()})}function u(f,c,v){var m=c;switch(c){case"blob":case"arraybuffer":m="uint8array";break;case"base64":m="string"}try{this._internalType=m,this._outputType=c,this._mimeType=v,a.checkSupport(m),this._worker=f.pipe(new s(m)),f.lock()}catch(b){this._worker=new l("error"),this._worker.error(b)}}u.prototype={accumulate:function(f){return h(this,f)},on:function(f,c){var v=this;return f==="data"?this._worker.on(f,function(m){c.call(v,m.data,m.meta)}):this._worker.on(f,function(){a.delay(c,arguments,v)}),this},resume:function(){return a.delay(this._worker.resume,[],this._worker),this},pause:function(){return this._worker.pause(),this},toNodejsStream:function(f){if(a.checkSupport("nodestream"),this._outputType!=="nodebuffer")throw new Error(this._outputType+" is not supported by this method");return new y(this,{objectMode:this._outputType!=="nodebuffer"},f)}},n.exports=u}).call(this,e("buffer").Buffer)},{"../base64":390,"../external":395,"../nodejs/NodejsStreamOutputAdapter":402,"../support":419,"../utils":421,"./ConvertWorker":413,"./GenericWorker":417,buffer:216}],419:[function(e,n,i){(function(o){if(i.base64=!0,i.array=!0,i.string=!0,i.arraybuffer=typeof ArrayBuffer!="undefined"&&typeof Uint8Array!="undefined",i.nodebuffer=o!==void 0,i.uint8array=typeof Uint8Array!="undefined",typeof ArrayBuffer=="undefined")i.blob=!1;else{var a=new ArrayBuffer(0);try{i.blob=new Blob([a],{type:"application/zip"}).size===0}catch{try{var s=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);s.append(a),i.blob=s.getBlob("application/zip").size===0}catch{i.blob=!1}}}try{i.nodestream=!!e("readable-stream").Readable}catch{i.nodestream=!1}}).call(this,e("buffer").Buffer)},{buffer:216,"readable-stream":405}],420:[function(e,n,i){for(var o=e("./utils"),a=e("./support"),s=e("./nodejsUtils"),l=e("./stream/GenericWorker"),p=new Array(256),d=0;d<256;d++)p[d]=d>=252?6:d>=248?5:d>=240?4:d>=224?3:d>=192?2:1;p[254]=p[254]=1;function g(){l.call(this,"utf-8 decode"),this.leftOver=null}function y(){l.call(this,"utf-8 encode")}i.utf8encode=function(h){return a.nodebuffer?s.newBufferFrom(h,"utf-8"):function(u){var f,c,v,m,b,w=u.length,_=0;for(m=0;m<w;m++)(64512&(c=u.charCodeAt(m)))==55296&&m+1<w&&(64512&(v=u.charCodeAt(m+1)))==56320&&(c=65536+(c-55296<<10)+(v-56320),m++),_+=c<128?1:c<2048?2:c<65536?3:4;for(f=a.uint8array?new Uint8Array(_):new Array(_),b=0,m=0;b<_;m++)(64512&(c=u.charCodeAt(m)))==55296&&m+1<w&&(64512&(v=u.charCodeAt(m+1)))==56320&&(c=65536+(c-55296<<10)+(v-56320),m++),c<128?f[b++]=c:c<2048?(f[b++]=192|c>>>6,f[b++]=128|63&c):c<65536?(f[b++]=224|c>>>12,f[b++]=128|c>>>6&63,f[b++]=128|63&c):(f[b++]=240|c>>>18,f[b++]=128|c>>>12&63,f[b++]=128|c>>>6&63,f[b++]=128|63&c);return f}(h)},i.utf8decode=function(h){return a.nodebuffer?o.transformTo("nodebuffer",h).toString("utf-8"):function(u){var f,c,v,m,b=u.length,w=new Array(2*b);for(c=0,f=0;f<b;)if((v=u[f++])<128)w[c++]=v;else if((m=p[v])>4)w[c++]=65533,f+=m-1;else{for(v&=m===2?31:m===3?15:7;m>1&&f<b;)v=v<<6|63&u[f++],m--;m>1?w[c++]=65533:v<65536?w[c++]=v:(v-=65536,w[c++]=55296|v>>10&1023,w[c++]=56320|1023&v)}return w.length!==c&&(w.subarray?w=w.subarray(0,c):w.length=c),o.applyFromCharCode(w)}(h=o.transformTo(a.uint8array?"uint8array":"array",h))},o.inherits(g,l),g.prototype.processChunk=function(h){var u=o.transformTo(a.uint8array?"uint8array":"array",h.data);if(this.leftOver&&this.leftOver.length){if(a.uint8array){var f=u;(u=new Uint8Array(f.length+this.leftOver.length)).set(this.leftOver,0),u.set(f,this.leftOver.length)}else u=this.leftOver.concat(u);this.leftOver=null}var c=function(m,b){var w;for((b=b||m.length)>m.length&&(b=m.length),w=b-1;w>=0&&(192&m[w])==128;)w--;return w<0||w===0?b:w+p[m[w]]>b?w:b}(u),v=u;c!==u.length&&(a.uint8array?(v=u.subarray(0,c),this.leftOver=u.subarray(c,u.length)):(v=u.slice(0,c),this.leftOver=u.slice(c,u.length))),this.push({data:i.utf8decode(v),meta:h.meta})},g.prototype.flush=function(){this.leftOver&&this.leftOver.length&&(this.push({data:i.utf8decode(this.leftOver),meta:{}}),this.leftOver=null)},i.Utf8DecodeWorker=g,o.inherits(y,l),y.prototype.processChunk=function(h){this.push({data:i.utf8encode(h.data),meta:h.meta})},i.Utf8EncodeWorker=y},{"./nodejsUtils":403,"./stream/GenericWorker":417,"./support":419,"./utils":421}],421:[function(e,n,i){var o=e("./support"),a=e("./base64"),s=e("./nodejsUtils"),l=e("set-immediate-shim"),p=e("./external");function d(c){return c}function g(c,v){for(var m=0;m<c.length;++m)v[m]=255&c.charCodeAt(m);return v}i.newBlob=function(c,v){i.checkSupport("blob");try{return new Blob([c],{type:v})}catch{try{var m=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);return m.append(c),m.getBlob(v)}catch{throw new Error("Bug : can't construct the Blob.")}}};var y={stringifyByChunk:function(c,v,m){var b=[],w=0,_=c.length;if(_<=m)return String.fromCharCode.apply(null,c);for(;w<_;)v==="array"||v==="nodebuffer"?b.push(String.fromCharCode.apply(null,c.slice(w,Math.min(w+m,_)))):b.push(String.fromCharCode.apply(null,c.subarray(w,Math.min(w+m,_)))),w+=m;return b.join("")},stringifyByChar:function(c){for(var v="",m=0;m<c.length;m++)v+=String.fromCharCode(c[m]);return v},applyCanBeUsed:{uint8array:function(){try{return o.uint8array&&String.fromCharCode.apply(null,new Uint8Array(1)).length===1}catch{return!1}}(),nodebuffer:function(){try{return o.nodebuffer&&String.fromCharCode.apply(null,s.allocBuffer(1)).length===1}catch{return!1}}()}};function h(c){var v=65536,m=i.getTypeOf(c),b=!0;if(m==="uint8array"?b=y.applyCanBeUsed.uint8array:m==="nodebuffer"&&(b=y.applyCanBeUsed.nodebuffer),b)for(;v>1;)try{return y.stringifyByChunk(c,m,v)}catch{v=Math.floor(v/2)}return y.stringifyByChar(c)}function u(c,v){for(var m=0;m<c.length;m++)v[m]=c[m];return v}i.applyFromCharCode=h;var f={};f.string={string:d,array:function(c){return g(c,new Array(c.length))},arraybuffer:function(c){return f.string.uint8array(c).buffer},uint8array:function(c){return g(c,new Uint8Array(c.length))},nodebuffer:function(c){return g(c,s.allocBuffer(c.length))}},f.array={string:h,array:d,arraybuffer:function(c){return new Uint8Array(c).buffer},uint8array:function(c){return new Uint8Array(c)},nodebuffer:function(c){return s.newBufferFrom(c)}},f.arraybuffer={string:function(c){return h(new Uint8Array(c))},array:function(c){return u(new Uint8Array(c),new Array(c.byteLength))},arraybuffer:d,uint8array:function(c){return new Uint8Array(c)},nodebuffer:function(c){return s.newBufferFrom(new Uint8Array(c))}},f.uint8array={string:h,array:function(c){return u(c,new Array(c.length))},arraybuffer:function(c){return c.buffer},uint8array:d,nodebuffer:function(c){return s.newBufferFrom(c)}},f.nodebuffer={string:h,array:function(c){return u(c,new Array(c.length))},arraybuffer:function(c){return f.nodebuffer.uint8array(c).buffer},uint8array:function(c){return u(c,new Uint8Array(c.length))},nodebuffer:d},i.transformTo=function(c,v){if(v||(v=""),!c)return v;i.checkSupport(c);var m=i.getTypeOf(v);return f[m][c](v)},i.getTypeOf=function(c){return typeof c=="string"?"string":Object.prototype.toString.call(c)==="[object Array]"?"array":o.nodebuffer&&s.isBuffer(c)?"nodebuffer":o.uint8array&&c instanceof Uint8Array?"uint8array":o.arraybuffer&&c instanceof ArrayBuffer?"arraybuffer":void 0},i.checkSupport=function(c){if(!o[c.toLowerCase()])throw new Error(c+" is not supported by this platform")},i.MAX_VALUE_16BITS=65535,i.MAX_VALUE_32BITS=-1,i.pretty=function(c){var v,m,b="";for(m=0;m<(c||"").length;m++)b+="\\x"+((v=c.charCodeAt(m))<16?"0":"")+v.toString(16).toUpperCase();return b},i.delay=function(c,v,m){l(function(){c.apply(m||null,v||[])})},i.inherits=function(c,v){var m=function(){};m.prototype=v.prototype,c.prototype=new m},i.extend=function(){var c,v,m={};for(c=0;c<arguments.length;c++)for(v in arguments[c])arguments[c].hasOwnProperty(v)&&m[v]===void 0&&(m[v]=arguments[c][v]);return m},i.prepareContent=function(c,v,m,b,w){return p.Promise.resolve(v).then(function(_){return o.blob&&(_ instanceof Blob||["[object File]","[object Blob]"].indexOf(Object.prototype.toString.call(_))!==-1)&&typeof FileReader!="undefined"?new p.Promise(function(C,R){var I=new FileReader;I.onload=function(P){C(P.target.result)},I.onerror=function(P){R(P.target.error)},I.readAsArrayBuffer(_)}):_}).then(function(_){var C,R=i.getTypeOf(_);return R?(R==="arraybuffer"?_=i.transformTo("uint8array",_):R==="string"&&(w?_=a.decode(_):m&&b!==!0&&(_=g(C=_,o.uint8array?new Uint8Array(C.length):new Array(C.length)))),_):p.Promise.reject(new Error("Can't read the data of '"+c+"'. Is it in a supported JavaScript type (String, Blob, ArrayBuffer, etc) ?"))})}},{"./base64":390,"./external":395,"./nodejsUtils":403,"./support":419,"set-immediate-shim":497}],422:[function(e,n,i){var o=e("./reader/readerFor"),a=e("./utils"),s=e("./signature"),l=e("./zipEntry"),p=(e("./utf8"),e("./support"));function d(g){this.files=[],this.loadOptions=g}d.prototype={checkSignature:function(g){if(!this.reader.readAndCheckSignature(g)){this.reader.index-=4;var y=this.reader.readString(4);throw new Error("Corrupted zip or bug: unexpected signature ("+a.pretty(y)+", expected "+a.pretty(g)+")")}},isSignature:function(g,y){var h=this.reader.index;this.reader.setIndex(g);var u=this.reader.readString(4)===y;return this.reader.setIndex(h),u},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2),this.diskWithCentralDirStart=this.reader.readInt(2),this.centralDirRecordsOnThisDisk=this.reader.readInt(2),this.centralDirRecords=this.reader.readInt(2),this.centralDirSize=this.reader.readInt(4),this.centralDirOffset=this.reader.readInt(4),this.zipCommentLength=this.reader.readInt(2);var g=this.reader.readData(this.zipCommentLength),y=p.uint8array?"uint8array":"array",h=a.transformTo(y,g);this.zipComment=this.loadOptions.decodeFileName(h)},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=this.reader.readInt(8),this.reader.skip(4),this.diskNumber=this.reader.readInt(4),this.diskWithCentralDirStart=this.reader.readInt(4),this.centralDirRecordsOnThisDisk=this.reader.readInt(8),this.centralDirRecords=this.reader.readInt(8),this.centralDirSize=this.reader.readInt(8),this.centralDirOffset=this.reader.readInt(8),this.zip64ExtensibleData={};for(var g,y,h,u=this.zip64EndOfCentralSize-44;0<u;)g=this.reader.readInt(2),y=this.reader.readInt(4),h=this.reader.readData(y),this.zip64ExtensibleData[g]={id:g,length:y,value:h}},readBlockZip64EndOfCentralLocator:function(){if(this.diskWithZip64CentralDirStart=this.reader.readInt(4),this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8),this.disksCount=this.reader.readInt(4),this.disksCount>1)throw new Error("Multi-volumes zip are not supported")},readLocalFiles:function(){var g,y;for(g=0;g<this.files.length;g++)y=this.files[g],this.reader.setIndex(y.localHeaderOffset),this.checkSignature(s.LOCAL_FILE_HEADER),y.readLocalPart(this.reader),y.handleUTF8(),y.processAttributes()},readCentralDir:function(){var g;for(this.reader.setIndex(this.centralDirOffset);this.reader.readAndCheckSignature(s.CENTRAL_FILE_HEADER);)(g=new l({zip64:this.zip64},this.loadOptions)).readCentralPart(this.reader),this.files.push(g);if(this.centralDirRecords!==this.files.length&&this.centralDirRecords!==0&&this.files.length===0)throw new Error("Corrupted zip or bug: expected "+this.centralDirRecords+" records in central dir, got "+this.files.length)},readEndOfCentral:function(){var g=this.reader.lastIndexOfSignature(s.CENTRAL_DIRECTORY_END);if(g<0)throw this.isSignature(0,s.LOCAL_FILE_HEADER)?new Error("Corrupted zip: can't find end of central directory"):new Error("Can't find end of central directory : is this a zip file ? If it is, see https://stuk.github.io/jszip/documentation/howto/read_zip.html");this.reader.setIndex(g);var y=g;if(this.checkSignature(s.CENTRAL_DIRECTORY_END),this.readBlockEndOfCentral(),this.diskNumber===a.MAX_VALUE_16BITS||this.diskWithCentralDirStart===a.MAX_VALUE_16BITS||this.centralDirRecordsOnThisDisk===a.MAX_VALUE_16BITS||this.centralDirRecords===a.MAX_VALUE_16BITS||this.centralDirSize===a.MAX_VALUE_32BITS||this.centralDirOffset===a.MAX_VALUE_32BITS){if(this.zip64=!0,(g=this.reader.lastIndexOfSignature(s.ZIP64_CENTRAL_DIRECTORY_LOCATOR))<0)throw new Error("Corrupted zip: can't find the ZIP64 end of central directory locator");if(this.reader.setIndex(g),this.checkSignature(s.ZIP64_CENTRAL_DIRECTORY_LOCATOR),this.readBlockZip64EndOfCentralLocator(),!this.isSignature(this.relativeOffsetEndOfZip64CentralDir,s.ZIP64_CENTRAL_DIRECTORY_END)&&(this.relativeOffsetEndOfZip64CentralDir=this.reader.lastIndexOfSignature(s.ZIP64_CENTRAL_DIRECTORY_END),this.relativeOffsetEndOfZip64CentralDir<0))throw new Error("Corrupted zip: can't find the ZIP64 end of central directory");this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir),this.checkSignature(s.ZIP64_CENTRAL_DIRECTORY_END),this.readBlockZip64EndOfCentral()}var h=this.centralDirOffset+this.centralDirSize;this.zip64&&(h+=20,h+=12+this.zip64EndOfCentralSize);var u=y-h;if(u>0)this.isSignature(y,s.CENTRAL_FILE_HEADER)||(this.reader.zero=u);else if(u<0)throw new Error("Corrupted zip: missing "+Math.abs(u)+" bytes.")},prepareReader:function(g){this.reader=o(g)},load:function(g){this.prepareReader(g),this.readEndOfCentral(),this.readCentralDir(),this.readLocalFiles()}},n.exports=d},{"./reader/readerFor":411,"./signature":412,"./support":419,"./utf8":420,"./utils":421,"./zipEntry":423}],423:[function(e,n,i){var o=e("./reader/readerFor"),a=e("./utils"),s=e("./compressedObject"),l=e("./crc32"),p=e("./utf8"),d=e("./compressions"),g=e("./support");function y(h,u){this.options=h,this.loadOptions=u}y.prototype={isEncrypted:function(){return(1&this.bitFlag)==1},useUTF8:function(){return(2048&this.bitFlag)==2048},readLocalPart:function(h){var u,f;if(h.skip(22),this.fileNameLength=h.readInt(2),f=h.readInt(2),this.fileName=h.readData(this.fileNameLength),h.skip(f),this.compressedSize===-1||this.uncompressedSize===-1)throw new Error("Bug or corrupted zip : didn't get enough information from the central directory (compressedSize === -1 || uncompressedSize === -1)");if((u=function(c){for(var v in d)if(d.hasOwnProperty(v)&&d[v].magic===c)return d[v];return null}(this.compressionMethod))===null)throw new Error("Corrupted zip : compression "+a.pretty(this.compressionMethod)+" unknown (inner file : "+a.transformTo("string",this.fileName)+")");this.decompressed=new s(this.compressedSize,this.uncompressedSize,this.crc32,u,h.readData(this.compressedSize))},readCentralPart:function(h){this.versionMadeBy=h.readInt(2),h.skip(2),this.bitFlag=h.readInt(2),this.compressionMethod=h.readString(2),this.date=h.readDate(),this.crc32=h.readInt(4),this.compressedSize=h.readInt(4),this.uncompressedSize=h.readInt(4);var u=h.readInt(2);if(this.extraFieldsLength=h.readInt(2),this.fileCommentLength=h.readInt(2),this.diskNumberStart=h.readInt(2),this.internalFileAttributes=h.readInt(2),this.externalFileAttributes=h.readInt(4),this.localHeaderOffset=h.readInt(4),this.isEncrypted())throw new Error("Encrypted zip are not supported");h.skip(u),this.readExtraFields(h),this.parseZIP64ExtraField(h),this.fileComment=h.readData(this.fileCommentLength)},processAttributes:function(){this.unixPermissions=null,this.dosPermissions=null;var h=this.versionMadeBy>>8;this.dir=!!(16&this.externalFileAttributes),h===0&&(this.dosPermissions=63&this.externalFileAttributes),h===3&&(this.unixPermissions=this.externalFileAttributes>>16&65535),this.dir||this.fileNameStr.slice(-1)!=="/"||(this.dir=!0)},parseZIP64ExtraField:function(h){if(this.extraFields[1]){var u=o(this.extraFields[1].value);this.uncompressedSize===a.MAX_VALUE_32BITS&&(this.uncompressedSize=u.readInt(8)),this.compressedSize===a.MAX_VALUE_32BITS&&(this.compressedSize=u.readInt(8)),this.localHeaderOffset===a.MAX_VALUE_32BITS&&(this.localHeaderOffset=u.readInt(8)),this.diskNumberStart===a.MAX_VALUE_32BITS&&(this.diskNumberStart=u.readInt(4))}},readExtraFields:function(h){var u,f,c,v=h.index+this.extraFieldsLength;for(this.extraFields||(this.extraFields={});h.index+4<v;)u=h.readInt(2),f=h.readInt(2),c=h.readData(f),this.extraFields[u]={id:u,length:f,value:c};h.setIndex(v)},handleUTF8:function(){var h=g.uint8array?"uint8array":"array";if(this.useUTF8())this.fileNameStr=p.utf8decode(this.fileName),this.fileCommentStr=p.utf8decode(this.fileComment);else{var u=this.findExtraFieldUnicodePath();if(u!==null)this.fileNameStr=u;else{var f=a.transformTo(h,this.fileName);this.fileNameStr=this.loadOptions.decodeFileName(f)}var c=this.findExtraFieldUnicodeComment();if(c!==null)this.fileCommentStr=c;else{var v=a.transformTo(h,this.fileComment);this.fileCommentStr=this.loadOptions.decodeFileName(v)}}},findExtraFieldUnicodePath:function(){var h=this.extraFields[28789];if(h){var u=o(h.value);return u.readInt(1)!==1||l(this.fileName)!==u.readInt(4)?null:p.utf8decode(u.readData(h.length-5))}return null},findExtraFieldUnicodeComment:function(){var h=this.extraFields[25461];if(h){var u=o(h.value);return u.readInt(1)!==1||l(this.fileComment)!==u.readInt(4)?null:p.utf8decode(u.readData(h.length-5))}return null}},n.exports=y},{"./compressedObject":391,"./compressions":392,"./crc32":393,"./reader/readerFor":411,"./support":419,"./utf8":420,"./utils":421}],424:[function(e,n,i){var o=e("./stream/StreamHelper"),a=e("./stream/DataWorker"),s=e("./utf8"),l=e("./compressedObject"),p=e("./stream/GenericWorker"),d=function(u,f,c){this.name=u,this.dir=c.dir,this.date=c.date,this.comment=c.comment,this.unixPermissions=c.unixPermissions,this.dosPermissions=c.dosPermissions,this._data=f,this._dataBinary=c.binary,this.options={compression:c.compression,compressionOptions:c.compressionOptions}};d.prototype={internalStream:function(u){var f=null,c="string";try{if(!u)throw new Error("No output type specified.");var v=(c=u.toLowerCase())==="string"||c==="text";c!=="binarystring"&&c!=="text"||(c="string"),f=this._decompressWorker();var m=!this._dataBinary;m&&!v&&(f=f.pipe(new s.Utf8EncodeWorker)),!m&&v&&(f=f.pipe(new s.Utf8DecodeWorker))}catch(b){(f=new p("error")).error(b)}return new o(f,c,"")},async:function(u,f){return this.internalStream(u).accumulate(f)},nodeStream:function(u,f){return this.internalStream(u||"nodebuffer").toNodejsStream(f)},_compressWorker:function(u,f){if(this._data instanceof l&&this._data.compression.magic===u.magic)return this._data.getCompressedWorker();var c=this._decompressWorker();return this._dataBinary||(c=c.pipe(new s.Utf8EncodeWorker)),l.createWorkerFrom(c,u,f)},_decompressWorker:function(){return this._data instanceof l?this._data.getContentWorker():this._data instanceof p?this._data:new a(this._data)}};for(var g=["asText","asBinary","asNodeBuffer","asUint8Array","asArrayBuffer"],y=function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},h=0;h<g.length;h++)d.prototype[g[h]]=y;n.exports=d},{"./compressedObject":391,"./stream/DataWorker":416,"./stream/GenericWorker":417,"./stream/StreamHelper":418,"./utf8":420}],425:[function(e,n,i){function o(m){return(o=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(b){return typeof b}:function(b){return b&&typeof Symbol=="function"&&b.constructor===Symbol&&b!==Symbol.prototype?"symbol":typeof b})(m)}var a=e("immediate");function s(){}var l={},p=["REJECTED"],d=["FULFILLED"],g=["PENDING"];function y(m){if(typeof m!="function")throw new TypeError("resolver must be a function");this.state=g,this.queue=[],this.outcome=void 0,m!==s&&c(this,m)}function h(m,b,w){this.promise=m,typeof b=="function"&&(this.onFulfilled=b,this.callFulfilled=this.otherCallFulfilled),typeof w=="function"&&(this.onRejected=w,this.callRejected=this.otherCallRejected)}function u(m,b,w){a(function(){var _;try{_=b(w)}catch(C){return l.reject(m,C)}_===m?l.reject(m,new TypeError("Cannot resolve promise with itself")):l.resolve(m,_)})}function f(m){var b=m&&m.then;if(m&&(o(m)==="object"||typeof m=="function")&&typeof b=="function")return function(){b.apply(m,arguments)}}function c(m,b){var w=!1;function _(I){w||(w=!0,l.reject(m,I))}function C(I){w||(w=!0,l.resolve(m,I))}var R=v(function(){b(C,_)});R.status==="error"&&_(R.value)}function v(m,b){var w={};try{w.value=m(b),w.status="success"}catch(_){w.status="error",w.value=_}return w}n.exports=y,y.prototype.finally=function(m){if(typeof m!="function")return this;var b=this.constructor;return this.then(function(w){return b.resolve(m()).then(function(){return w})},function(w){return b.resolve(m()).then(function(){throw w})})},y.prototype.catch=function(m){return this.then(null,m)},y.prototype.then=function(m,b){if(typeof m!="function"&&this.state===d||typeof b!="function"&&this.state===p)return this;var w=new this.constructor(s);return this.state!==g?u(w,this.state===d?m:b,this.outcome):this.queue.push(new h(w,m,b)),w},h.prototype.callFulfilled=function(m){l.resolve(this.promise,m)},h.prototype.otherCallFulfilled=function(m){u(this.promise,this.onFulfilled,m)},h.prototype.callRejected=function(m){l.reject(this.promise,m)},h.prototype.otherCallRejected=function(m){u(this.promise,this.onRejected,m)},l.resolve=function(m,b){var w=v(f,b);if(w.status==="error")return l.reject(m,w.value);var _=w.value;if(_)c(m,_);else{m.state=d,m.outcome=b;for(var C=-1,R=m.queue.length;++C<R;)m.queue[C].callFulfilled(b)}return m},l.reject=function(m,b){m.state=p,m.outcome=b;for(var w=-1,_=m.queue.length;++w<_;)m.queue[w].callRejected(b);return m},y.resolve=function(m){return m instanceof this?m:l.resolve(new this(s),m)},y.reject=function(m){var b=new this(s);return l.reject(b,m)},y.all=function(m){var b=this;if(Object.prototype.toString.call(m)!=="[object Array]")return this.reject(new TypeError("must be an array"));var w=m.length,_=!1;if(!w)return this.resolve([]);for(var C=new Array(w),R=0,I=-1,P=new this(s);++I<w;)N(m[I],I);return P;function N(A,$){b.resolve(A).then(function(T){C[$]=T,++R!==w||_||(_=!0,l.resolve(P,C))},function(T){_||(_=!0,l.reject(P,T))})}},y.race=function(m){var b=this;if(Object.prototype.toString.call(m)!=="[object Array]")return this.reject(new TypeError("must be an array"));var w=m.length,_=!1;if(!w)return this.resolve([]);for(var C=-1,R=new this(s);++C<w;)I=m[C],b.resolve(I).then(function(P){_||(_=!0,l.resolve(R,P))},function(P){_||(_=!0,l.reject(R,P))});var I;return R}},{immediate:386}],426:[function(e,n,i){(function(o){function a(v){return(a=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(m){return typeof m}:function(m){return m&&typeof Symbol=="function"&&m.constructor===Symbol&&m!==Symbol.prototype?"symbol":typeof m})(v)}var s=/[\\^$.*+?()[\]{}|]/g,l=RegExp(s.source),p=(o===void 0?"undefined":a(o))=="object"&&o&&o.Object===Object&&o,d=(typeof self=="undefined"?"undefined":a(self))=="object"&&self&&self.Object===Object&&self,g=p||d||Function("return this")(),y=Object.prototype.toString,h=g.Symbol,u=h?h.prototype:void 0,f=u?u.toString:void 0;function c(v){if(typeof v=="string")return v;if(function(b){return a(b)=="symbol"||function(w){return!!w&&a(w)=="object"}(b)&&y.call(b)=="[object Symbol]"}(v))return f?f.call(v):"";var m=v+"";return m=="0"&&1/v==-1/0?"-0":m}n.exports=function(v){var m;return(v=(m=v)==null?"":c(m))&&l.test(v)?v.replace(s,"\\$&"):v}}).call(this,typeof At!="undefined"?At:typeof self!="undefined"?self:typeof window!="undefined"?window:{})},{}],427:[function(e,n,i){(function(o){function a(ae){return(a=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(_e){return typeof _e}:function(_e){return _e&&typeof Symbol=="function"&&_e.constructor===Symbol&&_e!==Symbol.prototype?"symbol":typeof _e})(ae)}var s="[object Arguments]",l="[object Map]",p="[object Object]",d="[object Set]",g=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,y=/^\w*$/,h=/^\./,u=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,f=/\\(\\)?/g,c=/^\[object .+?Constructor\]$/,v=/^(?:0|[1-9]\d*)$/,m={};m["[object Float32Array]"]=m["[object Float64Array]"]=m["[object Int8Array]"]=m["[object Int16Array]"]=m["[object Int32Array]"]=m["[object Uint8Array]"]=m["[object Uint8ClampedArray]"]=m["[object Uint16Array]"]=m["[object Uint32Array]"]=!0,m[s]=m["[object Array]"]=m["[object ArrayBuffer]"]=m["[object Boolean]"]=m["[object DataView]"]=m["[object Date]"]=m["[object Error]"]=m["[object Function]"]=m[l]=m["[object Number]"]=m[p]=m["[object RegExp]"]=m[d]=m["[object String]"]=m["[object WeakMap]"]=!1;var b=(o===void 0?"undefined":a(o))=="object"&&o&&o.Object===Object&&o,w=(typeof self=="undefined"?"undefined":a(self))=="object"&&self&&self.Object===Object&&self,_=b||w||Function("return this")(),C=(i===void 0?"undefined":a(i))=="object"&&i&&!i.nodeType&&i,R=C&&(n===void 0?"undefined":a(n))=="object"&&n&&!n.nodeType&&n,I=R&&R.exports===C&&b.process,P=function(){try{return I&&I.binding("util")}catch{}}(),N=P&&P.isTypedArray;function A(ae,_e,Pe,Ne){for(var tt=-1,je=ae?ae.length:0;++tt<je;){var Fe=ae[tt];_e(Ne,Fe,Pe(Fe),ae)}return Ne}function $(ae,_e){for(var Pe=-1,Ne=ae?ae.length:0;++Pe<Ne;)if(_e(ae[Pe],Pe,ae))return!0;return!1}function T(ae){var _e=!1;if(ae!=null&&typeof ae.toString!="function")try{_e=!!(ae+"")}catch{}return _e}function M(ae){var _e=-1,Pe=Array(ae.size);return ae.forEach(function(Ne,tt){Pe[++_e]=[tt,Ne]}),Pe}function S(ae){var _e=-1,Pe=Array(ae.size);return ae.forEach(function(Ne){Pe[++_e]=Ne}),Pe}var E,k,O,x=Array.prototype,j=Function.prototype,H=Object.prototype,F=_["__core-js_shared__"],V=(E=/[^.]+$/.exec(F&&F.keys&&F.keys.IE_PROTO||""))?"Symbol(src)_1."+E:"",W=j.toString,U=H.hasOwnProperty,Y=H.toString,K=RegExp("^"+W.call(U).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),D=_.Symbol,L=_.Uint8Array,B=H.propertyIsEnumerable,z=x.splice,q=(k=Object.keys,O=Object,function(ae){return k(O(ae))}),X=rt(_,"DataView"),ee=rt(_,"Map"),ye=rt(_,"Promise"),de=rt(_,"Set"),ge=rt(_,"WeakMap"),we=rt(Object,"create"),be=me(X),J=me(ee),te=me(ye),ie=me(de),fe=me(ge),se=D?D.prototype:void 0,oe=se?se.valueOf:void 0,G=se?se.toString:void 0;function Z(ae){var _e=-1,Pe=ae?ae.length:0;for(this.clear();++_e<Pe;){var Ne=ae[_e];this.set(Ne[0],Ne[1])}}function Q(ae){var _e=-1,Pe=ae?ae.length:0;for(this.clear();++_e<Pe;){var Ne=ae[_e];this.set(Ne[0],Ne[1])}}function re(ae){var _e=-1,Pe=ae?ae.length:0;for(this.clear();++_e<Pe;){var Ne=ae[_e];this.set(Ne[0],Ne[1])}}function ne(ae){var _e=-1,Pe=ae?ae.length:0;for(this.__data__=new re;++_e<Pe;)this.add(ae[_e])}function ue(ae){this.__data__=new Q(ae)}function le(ae,_e){var Pe=Re(ae)||Ee(ae)?function(Fe,_t){for(var gt=-1,mt=Array(Fe);++gt<Fe;)mt[gt]=_t(gt);return mt}(ae.length,String):[],Ne=Pe.length,tt=!!Ne;for(var je in ae)!_e&&!U.call(ae,je)||tt&&(je=="length"||ut(je,Ne))||Pe.push(je);return Pe}function ve(ae,_e){for(var Pe=ae.length;Pe--;)if(ce(ae[Pe][0],_e))return Pe;return-1}function Se(ae,_e,Pe,Ne){return xe(ae,function(tt,je,Fe){_e(Ne,tt,Pe(tt),Fe)}),Ne}Z.prototype.clear=function(){this.__data__=we?we(null):{}},Z.prototype.delete=function(ae){return this.has(ae)&&delete this.__data__[ae]},Z.prototype.get=function(ae){var _e=this.__data__;if(we){var Pe=_e[ae];return Pe==="__lodash_hash_undefined__"?void 0:Pe}return U.call(_e,ae)?_e[ae]:void 0},Z.prototype.has=function(ae){var _e=this.__data__;return we?_e[ae]!==void 0:U.call(_e,ae)},Z.prototype.set=function(ae,_e){return this.__data__[ae]=we&&_e===void 0?"__lodash_hash_undefined__":_e,this},Q.prototype.clear=function(){this.__data__=[]},Q.prototype.delete=function(ae){var _e=this.__data__,Pe=ve(_e,ae);return!(Pe<0)&&(Pe==_e.length-1?_e.pop():z.call(_e,Pe,1),!0)},Q.prototype.get=function(ae){var _e=this.__data__,Pe=ve(_e,ae);return Pe<0?void 0:_e[Pe][1]},Q.prototype.has=function(ae){return ve(this.__data__,ae)>-1},Q.prototype.set=function(ae,_e){var Pe=this.__data__,Ne=ve(Pe,ae);return Ne<0?Pe.push([ae,_e]):Pe[Ne][1]=_e,this},re.prototype.clear=function(){this.__data__={hash:new Z,map:new(ee||Q),string:new Z}},re.prototype.delete=function(ae){return We(this,ae).delete(ae)},re.prototype.get=function(ae){return We(this,ae).get(ae)},re.prototype.has=function(ae){return We(this,ae).has(ae)},re.prototype.set=function(ae,_e){return We(this,ae).set(ae,_e),this},ne.prototype.add=ne.prototype.push=function(ae){return this.__data__.set(ae,"__lodash_hash_undefined__"),this},ne.prototype.has=function(ae){return this.__data__.has(ae)},ue.prototype.clear=function(){this.__data__=new Q},ue.prototype.delete=function(ae){return this.__data__.delete(ae)},ue.prototype.get=function(ae){return this.__data__.get(ae)},ue.prototype.has=function(ae){return this.__data__.has(ae)},ue.prototype.set=function(ae,_e){var Pe=this.__data__;if(Pe instanceof Q){var Ne=Pe.__data__;if(!ee||Ne.length<199)return Ne.push([ae,_e]),this;Pe=this.__data__=new re(Ne)}return Pe.set(ae,_e),this};var Oe,xe=(Oe=function(ae,_e){return ae&&Ce(ae,_e,vr)},function(ae,_e){if(ae==null)return ae;if(!Ge(ae))return Oe(ae,_e);for(var Pe=ae.length,Ne=-1,tt=Object(ae);++Ne<Pe&&_e(tt[Ne],Ne,tt)!==!1;);return ae}),Ce=function(ae){return function(_e,Pe,Ne){for(var tt=-1,je=Object(_e),Fe=Ne(_e),_t=Fe.length;_t--;){var gt=Fe[ae?_t:++tt];if(Pe(je[gt],gt,je)===!1)break}return _e}}();function Le(ae,_e){for(var Pe=0,Ne=(_e=$t(_e,ae)?[_e]:et(_e)).length;ae!=null&&Pe<Ne;)ae=ae[pe(_e[Pe++])];return Pe&&Pe==Ne?ae:void 0}function Ve(ae,_e){return ae!=null&&_e in Object(ae)}function Je(ae,_e,Pe,Ne,tt){return ae===_e||(ae==null||_e==null||!kt(ae)&&!Ht(_e)?ae!=ae&&_e!=_e:function(je,Fe,_t,gt,mt,st){var zt=Re(je),Xt=Re(Fe),Bt="[object Array]",nr="[object Array]";zt||(Bt=(Bt=Rt(je))==s?p:Bt),Xt||(nr=(nr=Rt(Fe))==s?p:nr);var Cr=Bt==p&&!T(je),Fr=nr==p&&!T(Fe),Mn=Bt==nr;if(Mn&&!Cr)return st||(st=new ue),zt||dr(je)?Te(je,Fe,_t,gt,mt,st):function(Vt,It,so,na,dc,on,pi){switch(so){case"[object DataView]":if(Vt.byteLength!=It.byteLength||Vt.byteOffset!=It.byteOffset)return!1;Vt=Vt.buffer,It=It.buffer;case"[object ArrayBuffer]":return!(Vt.byteLength!=It.byteLength||!na(new L(Vt),new L(It)));case"[object Boolean]":case"[object Date]":case"[object Number]":return ce(+Vt,+It);case"[object Error]":return Vt.name==It.name&&Vt.message==It.message;case"[object RegExp]":case"[object String]":return Vt==It+"";case l:var uo=M;case d:var il=2&on;if(uo||(uo=S),Vt.size!=It.size&&!il)return!1;var pc=pi.get(Vt);if(pc)return pc==It;on|=1,pi.set(Vt,It);var Ss=Te(uo(Vt),uo(It),na,dc,on,pi);return pi.delete(Vt),Ss;case"[object Symbol]":if(oe)return oe.call(Vt)==oe.call(It)}return!1}(je,Fe,Bt,_t,gt,mt,st);if(!(2&mt)){var zn=Cr&&U.call(je,"__wrapped__"),bs=Fr&&U.call(Fe,"__wrapped__");if(zn||bs){var ws=zn?je.value():je,_s=bs?Fe.value():Fe;return st||(st=new ue),_t(ws,_s,gt,mt,st)}}return Mn?(st||(st=new ue),function(Vt,It,so,na,dc,on){var pi=2&dc,uo=vr(Vt),il=uo.length,pc=vr(It).length;if(il!=pc&&!pi)return!1;for(var Ss=il;Ss--;){var lo=uo[Ss];if(!(pi?lo in It:U.call(It,lo)))return!1}var Gk=on.get(Vt);if(Gk&&on.get(It))return Gk==It;var yc=!0;on.set(Vt,It),on.set(It,Vt);for(var av=pi;++Ss<il;){lo=uo[Ss];var mc=Vt[lo],vc=It[lo];if(na)var Kk=pi?na(vc,mc,lo,It,Vt,on):na(mc,vc,lo,Vt,It,on);if(!(Kk===void 0?mc===vc||so(mc,vc,na,dc,on):Kk)){yc=!1;break}av||(av=lo=="constructor")}if(yc&&!av){var gc=Vt.constructor,bc=It.constructor;gc==bc||!("constructor"in Vt)||!("constructor"in It)||typeof gc=="function"&&gc instanceof gc&&typeof bc=="function"&&bc instanceof bc||(yc=!1)}return on.delete(Vt),on.delete(It),yc}(je,Fe,_t,gt,mt,st)):!1}(ae,_e,Je,Pe,Ne,tt))}function ft(ae){return!(!kt(ae)||function(_e){return!!V&&V in _e}(ae))&&(Xe(ae)||T(ae)?K:c).test(me(ae))}function Ct(ae){return typeof ae=="function"?ae:ae==null?Ur:a(ae)=="object"?Re(ae)?function(Ne,tt){return $t(Ne)&&Et(tt)?nt(pe(Ne),tt):function(je){var Fe=function(_t,gt,mt){var st=_t==null?void 0:Le(_t,gt);return st===void 0?mt:st}(je,Ne);return Fe===void 0&&Fe===tt?function(_t,gt){return _t!=null&&function(mt,st,zt){st=$t(st,mt)?[st]:et(st);for(var Xt,Bt=-1,nr=st.length;++Bt<nr;){var Cr=pe(st[Bt]);if(!(Xt=mt!=null&&zt(mt,Cr)))break;mt=mt[Cr]}return Xt||!!(nr=mt?mt.length:0)&&qe(nr)&&ut(Cr,nr)&&(Re(mt)||Ee(mt))}(_t,gt,Ve)}(je,Ne):Je(tt,Fe,void 0,3)}}(ae[0],ae[1]):function(Ne){var tt=function(je){for(var Fe=vr(je),_t=Fe.length;_t--;){var gt=Fe[_t],mt=je[gt];Fe[_t]=[gt,mt,Et(mt)]}return Fe}(Ne);return tt.length==1&&tt[0][2]?nt(tt[0][0],tt[0][1]):function(je){return je===Ne||function(Fe,_t,gt,mt){var st=gt.length,zt=st,Xt=!mt;if(Fe==null)return!zt;for(Fe=Object(Fe);st--;){var Bt=gt[st];if(Xt&&Bt[2]?Bt[1]!==Fe[Bt[0]]:!(Bt[0]in Fe))return!1}for(;++st<zt;){var nr=(Bt=gt[st])[0],Cr=Fe[nr],Fr=Bt[1];if(Xt&&Bt[2]){if(Cr===void 0&&!(nr in Fe))return!1}else{var Mn=new ue;if(mt)var zn=mt(Cr,Fr,nr,Fe,_t,Mn);if(!(zn===void 0?Je(Fr,Cr,mt,3,Mn):zn))return!1}}return!0}(je,Ne,tt)}}(ae):$t(_e=ae)?(Pe=pe(_e),function(Ne){return Ne==null?void 0:Ne[Pe]}):function(Ne){return function(tt){return Le(tt,Ne)}}(_e);var _e,Pe}function Ye(ae){if(Pe=(_e=ae)&&_e.constructor,Ne=typeof Pe=="function"&&Pe.prototype||H,_e!==Ne)return q(ae);var _e,Pe,Ne,tt=[];for(var je in Object(ae))U.call(ae,je)&&je!="constructor"&&tt.push(je);return tt}function et(ae){return Re(ae)?ae:Ft(ae)}function Te(ae,_e,Pe,Ne,tt,je){var Fe=2&tt,_t=ae.length,gt=_e.length;if(_t!=gt&&!(Fe&&gt>_t))return!1;var mt=je.get(ae);if(mt&&je.get(_e))return mt==_e;var st=-1,zt=!0,Xt=1&tt?new ne:void 0;for(je.set(ae,_e),je.set(_e,ae);++st<_t;){var Bt=ae[st],nr=_e[st];if(Ne)var Cr=Fe?Ne(nr,Bt,st,_e,ae,je):Ne(Bt,nr,st,ae,_e,je);if(Cr!==void 0){if(Cr)continue;zt=!1;break}if(Xt){if(!$(_e,function(Fr,Mn){if(!Xt.has(Mn)&&(Bt===Fr||Pe(Bt,Fr,Ne,tt,je)))return Xt.add(Mn)})){zt=!1;break}}else if(Bt!==nr&&!Pe(Bt,nr,Ne,tt,je)){zt=!1;break}}return je.delete(ae),je.delete(_e),zt}function We(ae,_e){var Pe,Ne,tt=ae.__data__;return((Ne=a(Pe=_e))=="string"||Ne=="number"||Ne=="symbol"||Ne=="boolean"?Pe!=="__proto__":Pe===null)?tt[typeof _e=="string"?"string":"hash"]:tt.map}function rt(ae,_e){var Pe=function(Ne,tt){return Ne==null?void 0:Ne[tt]}(ae,_e);return ft(Pe)?Pe:void 0}var Rt=function(ae){return Y.call(ae)};function ut(ae,_e){return!!(_e=_e==null?9007199254740991:_e)&&(typeof ae=="number"||v.test(ae))&&ae>-1&&ae%1==0&&ae<_e}function $t(ae,_e){if(Re(ae))return!1;var Pe=a(ae);return!(Pe!="number"&&Pe!="symbol"&&Pe!="boolean"&&ae!=null&&!jt(ae))||y.test(ae)||!g.test(ae)||_e!=null&&ae in Object(_e)}function Et(ae){return ae==ae&&!kt(ae)}function nt(ae,_e){return function(Pe){return Pe!=null&&Pe[ae]===_e&&(_e!==void 0||ae in Object(Pe))}}(X&&Rt(new X(new ArrayBuffer(1)))!="[object DataView]"||ee&&Rt(new ee)!=l||ye&&Rt(ye.resolve())!="[object Promise]"||de&&Rt(new de)!=d||ge&&Rt(new ge)!="[object WeakMap]")&&(Rt=function(ae){var _e=Y.call(ae),Pe=_e==p?ae.constructor:void 0,Ne=Pe?me(Pe):void 0;if(Ne)switch(Ne){case be:return"[object DataView]";case J:return l;case te:return"[object Promise]";case ie:return d;case fe:return"[object WeakMap]"}return _e});var Ft=Ae(function(ae){var _e;ae=(_e=ae)==null?"":function(Ne){if(typeof Ne=="string")return Ne;if(jt(Ne))return G?G.call(Ne):"";var tt=Ne+"";return tt=="0"&&1/Ne==-1/0?"-0":tt}(_e);var Pe=[];return h.test(ae)&&Pe.push(""),ae.replace(u,function(Ne,tt,je,Fe){Pe.push(je?Fe.replace(f,"$1"):tt||Ne)}),Pe});function pe(ae){if(typeof ae=="string"||jt(ae))return ae;var _e=ae+"";return _e=="0"&&1/ae==-1/0?"-0":_e}function me(ae){if(ae!=null){try{return W.call(ae)}catch{}try{return ae+""}catch{}}return""}var Me,He=(Me=function(ae,_e,Pe){U.call(ae,Pe)?ae[Pe].push(_e):ae[Pe]=[_e]},function(ae,_e){var Pe=Re(ae)?A:Se,Ne={};return Pe(ae,Me,Ct(_e),Ne)});function Ae(ae,_e){if(typeof ae!="function"||_e&&typeof _e!="function")throw new TypeError("Expected a function");var Pe=function Ne(){var tt=arguments,je=_e?_e.apply(this,tt):tt[0],Fe=Ne.cache;if(Fe.has(je))return Fe.get(je);var _t=ae.apply(this,tt);return Ne.cache=Fe.set(je,_t),_t};return Pe.cache=new(Ae.Cache||re),Pe}function ce(ae,_e){return ae===_e||ae!=ae&&_e!=_e}function Ee(ae){return function(_e){return Ht(_e)&&Ge(_e)}(ae)&&U.call(ae,"callee")&&(!B.call(ae,"callee")||Y.call(ae)==s)}Ae.Cache=re;var Re=Array.isArray;function Ge(ae){return ae!=null&&qe(ae.length)&&!Xe(ae)}function Xe(ae){var _e=kt(ae)?Y.call(ae):"";return _e=="[object Function]"||_e=="[object GeneratorFunction]"}function qe(ae){return typeof ae=="number"&&ae>-1&&ae%1==0&&ae<=9007199254740991}function kt(ae){var _e=a(ae);return!!ae&&(_e=="object"||_e=="function")}function Ht(ae){return!!ae&&a(ae)=="object"}function jt(ae){return a(ae)=="symbol"||Ht(ae)&&Y.call(ae)=="[object Symbol]"}var dr=N?function(ae){return function(_e){return ae(_e)}}(N):function(ae){return Ht(ae)&&qe(ae.length)&&!!m[Y.call(ae)]};function vr(ae){return Ge(ae)?le(ae):Ye(ae)}function Ur(ae){return ae}n.exports=He}).call(this,typeof At!="undefined"?At:typeof self!="undefined"?self:typeof window!="undefined"?window:{})},{}],428:[function(e,n,i){function o(s){return(o=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(l){return typeof l}:function(l){return l&&typeof Symbol=="function"&&l.constructor===Symbol&&l!==Symbol.prototype?"symbol":typeof l})(s)}var a=Object.prototype.toString;n.exports=function(s){return s===!0||s===!1||function(l){return!!l&&o(l)=="object"}(s)&&a.call(s)=="[object Boolean]"}},{}],429:[function(e,n,i){(function(o){function a(pe){return(a=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(me){return typeof me}:function(me){return me&&typeof Symbol=="function"&&me.constructor===Symbol&&me!==Symbol.prototype?"symbol":typeof me})(pe)}var s="[object Arguments]",l="[object Map]",p="[object Object]",d="[object Set]",g=/^\[object .+?Constructor\]$/,y=/^(?:0|[1-9]\d*)$/,h={};h["[object Float32Array]"]=h["[object Float64Array]"]=h["[object Int8Array]"]=h["[object Int16Array]"]=h["[object Int32Array]"]=h["[object Uint8Array]"]=h["[object Uint8ClampedArray]"]=h["[object Uint16Array]"]=h["[object Uint32Array]"]=!0,h[s]=h["[object Array]"]=h["[object ArrayBuffer]"]=h["[object Boolean]"]=h["[object DataView]"]=h["[object Date]"]=h["[object Error]"]=h["[object Function]"]=h[l]=h["[object Number]"]=h[p]=h["[object RegExp]"]=h[d]=h["[object String]"]=h["[object WeakMap]"]=!1;var u=(o===void 0?"undefined":a(o))=="object"&&o&&o.Object===Object&&o,f=(typeof self=="undefined"?"undefined":a(self))=="object"&&self&&self.Object===Object&&self,c=u||f||Function("return this")(),v=(i===void 0?"undefined":a(i))=="object"&&i&&!i.nodeType&&i,m=v&&(n===void 0?"undefined":a(n))=="object"&&n&&!n.nodeType&&n,b=m&&m.exports===v,w=b&&u.process,_=function(){try{return w&&w.binding&&w.binding("util")}catch{}}(),C=_&&_.isTypedArray;function R(pe,me){for(var Me=-1,He=pe==null?0:pe.length;++Me<He;)if(me(pe[Me],Me,pe))return!0;return!1}function I(pe){var me=-1,Me=Array(pe.size);return pe.forEach(function(He,Ae){Me[++me]=[Ae,He]}),Me}function P(pe){var me=-1,Me=Array(pe.size);return pe.forEach(function(He){Me[++me]=He}),Me}var N,A,$,T=Array.prototype,M=Function.prototype,S=Object.prototype,E=c["__core-js_shared__"],k=M.toString,O=S.hasOwnProperty,x=(N=/[^.]+$/.exec(E&&E.keys&&E.keys.IE_PROTO||""))?"Symbol(src)_1."+N:"",j=S.toString,H=RegExp("^"+k.call(O).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),F=b?c.Buffer:void 0,V=c.Symbol,W=c.Uint8Array,U=S.propertyIsEnumerable,Y=T.splice,K=V?V.toStringTag:void 0,D=Object.getOwnPropertySymbols,L=F?F.isBuffer:void 0,B=(A=Object.keys,$=Object,function(pe){return A($(pe))}),z=Ve(c,"DataView"),q=Ve(c,"Map"),X=Ve(c,"Promise"),ee=Ve(c,"Set"),ye=Ve(c,"WeakMap"),de=Ve(Object,"create"),ge=Ye(z),we=Ye(q),be=Ye(X),J=Ye(ee),te=Ye(ye),ie=V?V.prototype:void 0,fe=ie?ie.valueOf:void 0;function se(pe){var me=-1,Me=pe==null?0:pe.length;for(this.clear();++me<Me;){var He=pe[me];this.set(He[0],He[1])}}function oe(pe){var me=-1,Me=pe==null?0:pe.length;for(this.clear();++me<Me;){var He=pe[me];this.set(He[0],He[1])}}function G(pe){var me=-1,Me=pe==null?0:pe.length;for(this.clear();++me<Me;){var He=pe[me];this.set(He[0],He[1])}}function Z(pe){var me=-1,Me=pe==null?0:pe.length;for(this.__data__=new G;++me<Me;)this.add(pe[me])}function Q(pe){var me=this.__data__=new oe(pe);this.size=me.size}function re(pe,me){var Me=We(pe),He=!Me&&Te(pe),Ae=!Me&&!He&&rt(pe),ce=!Me&&!He&&!Ae&&nt(pe),Ee=Me||He||Ae||ce,Re=Ee?function(qe,kt){for(var Ht=-1,jt=Array(qe);++Ht<qe;)jt[Ht]=kt(Ht);return jt}(pe.length,String):[],Ge=Re.length;for(var Xe in pe)!me&&!O.call(pe,Xe)||Ee&&(Xe=="length"||Ae&&(Xe=="offset"||Xe=="parent")||ce&&(Xe=="buffer"||Xe=="byteLength"||Xe=="byteOffset")||Ct(Xe,Ge))||Re.push(Xe);return Re}function ne(pe,me){for(var Me=pe.length;Me--;)if(et(pe[Me][0],me))return Me;return-1}function ue(pe){return pe==null?pe===void 0?"[object Undefined]":"[object Null]":K&&K in Object(pe)?function(me){var Me=O.call(me,K),He=me[K];try{me[K]=void 0;var Ae=!0}catch{}var ce=j.call(me);return Ae&&(Me?me[K]=He:delete me[K]),ce}(pe):function(me){return j.call(me)}(pe)}function le(pe){return Et(pe)&&ue(pe)==s}function ve(pe,me,Me,He,Ae){return pe===me||(pe==null||me==null||!Et(pe)&&!Et(me)?pe!=pe&&me!=me:function(ce,Ee,Re,Ge,Xe,qe){var kt=We(ce),Ht=We(Ee),jt=kt?"[object Array]":ft(ce),dr=Ht?"[object Array]":ft(Ee),vr=(jt=jt==s?p:jt)==p,Ur=(dr=dr==s?p:dr)==p,ae=jt==dr;if(ae&&rt(ce)){if(!rt(Ee))return!1;kt=!0,vr=!1}if(ae&&!vr)return qe||(qe=new Q),kt||nt(ce)?xe(ce,Ee,Re,Ge,Xe,qe):function(je,Fe,_t,gt,mt,st,zt){switch(_t){case"[object DataView]":if(je.byteLength!=Fe.byteLength||je.byteOffset!=Fe.byteOffset)return!1;je=je.buffer,Fe=Fe.buffer;case"[object ArrayBuffer]":return!(je.byteLength!=Fe.byteLength||!st(new W(je),new W(Fe)));case"[object Boolean]":case"[object Date]":case"[object Number]":return et(+je,+Fe);case"[object Error]":return je.name==Fe.name&&je.message==Fe.message;case"[object RegExp]":case"[object String]":return je==Fe+"";case l:var Xt=I;case d:var Bt=1&gt;if(Xt||(Xt=P),je.size!=Fe.size&&!Bt)return!1;var nr=zt.get(je);if(nr)return nr==Fe;gt|=2,zt.set(je,Fe);var Cr=xe(Xt(je),Xt(Fe),gt,mt,st,zt);return zt.delete(je),Cr;case"[object Symbol]":if(fe)return fe.call(je)==fe.call(Fe)}return!1}(ce,Ee,jt,Re,Ge,Xe,qe);if(!(1&Re)){var _e=vr&&O.call(ce,"__wrapped__"),Pe=Ur&&O.call(Ee,"__wrapped__");if(_e||Pe){var Ne=_e?ce.value():ce,tt=Pe?Ee.value():Ee;return qe||(qe=new Q),Xe(Ne,tt,Re,Ge,qe)}}return ae?(qe||(qe=new Q),function(je,Fe,_t,gt,mt,st){var zt=1&_t,Xt=Ce(je),Bt=Xt.length,nr=Ce(Fe).length;if(Bt!=nr&&!zt)return!1;for(var Cr=Bt;Cr--;){var Fr=Xt[Cr];if(!(zt?Fr in Fe:O.call(Fe,Fr)))return!1}var Mn=st.get(je);if(Mn&&st.get(Fe))return Mn==Fe;var zn=!0;st.set(je,Fe),st.set(Fe,je);for(var bs=zt;++Cr<Bt;){Fr=Xt[Cr];var ws=je[Fr],_s=Fe[Fr];if(gt)var Vt=zt?gt(_s,ws,Fr,Fe,je,st):gt(ws,_s,Fr,je,Fe,st);if(!(Vt===void 0?ws===_s||mt(ws,_s,_t,gt,st):Vt)){zn=!1;break}bs||(bs=Fr=="constructor")}if(zn&&!bs){var It=je.constructor,so=Fe.constructor;It==so||!("constructor"in je)||!("constructor"in Fe)||typeof It=="function"&&It instanceof It&&typeof so=="function"&&so instanceof so||(zn=!1)}return st.delete(je),st.delete(Fe),zn}(ce,Ee,Re,Ge,Xe,qe)):!1}(pe,me,Me,He,ve,Ae))}function Se(pe){return!(!$t(pe)||function(me){return!!x&&x in me}(pe))&&(Rt(pe)?H:g).test(Ye(pe))}function Oe(pe){if(Me=(me=pe)&&me.constructor,He=typeof Me=="function"&&Me.prototype||S,me!==He)return B(pe);var me,Me,He,Ae=[];for(var ce in Object(pe))O.call(pe,ce)&&ce!="constructor"&&Ae.push(ce);return Ae}function xe(pe,me,Me,He,Ae,ce){var Ee=1&Me,Re=pe.length,Ge=me.length;if(Re!=Ge&&!(Ee&&Ge>Re))return!1;var Xe=ce.get(pe);if(Xe&&ce.get(me))return Xe==me;var qe=-1,kt=!0,Ht=2&Me?new Z:void 0;for(ce.set(pe,me),ce.set(me,pe);++qe<Re;){var jt=pe[qe],dr=me[qe];if(He)var vr=Ee?He(dr,jt,qe,me,pe,ce):He(jt,dr,qe,pe,me,ce);if(vr!==void 0){if(vr)continue;kt=!1;break}if(Ht){if(!R(me,function(Ur,ae){if(_e=ae,!Ht.has(_e)&&(jt===Ur||Ae(jt,Ur,Me,He,ce)))return Ht.push(ae);var _e})){kt=!1;break}}else if(jt!==dr&&!Ae(jt,dr,Me,He,ce)){kt=!1;break}}return ce.delete(pe),ce.delete(me),kt}function Ce(pe){return function(me,Me,He){var Ae=Me(me);return We(me)?Ae:function(ce,Ee){for(var Re=-1,Ge=Ee.length,Xe=ce.length;++Re<Ge;)ce[Xe+Re]=Ee[Re];return ce}(Ae,He(me))}(pe,Ft,Je)}function Le(pe,me){var Me,He,Ae=pe.__data__;return((He=a(Me=me))=="string"||He=="number"||He=="symbol"||He=="boolean"?Me!=="__proto__":Me===null)?Ae[typeof me=="string"?"string":"hash"]:Ae.map}function Ve(pe,me){var Me=function(He,Ae){return He==null?void 0:He[Ae]}(pe,me);return Se(Me)?Me:void 0}se.prototype.clear=function(){this.__data__=de?de(null):{},this.size=0},se.prototype.delete=function(pe){var me=this.has(pe)&&delete this.__data__[pe];return this.size-=me?1:0,me},se.prototype.get=function(pe){var me=this.__data__;if(de){var Me=me[pe];return Me==="__lodash_hash_undefined__"?void 0:Me}return O.call(me,pe)?me[pe]:void 0},se.prototype.has=function(pe){var me=this.__data__;return de?me[pe]!==void 0:O.call(me,pe)},se.prototype.set=function(pe,me){var Me=this.__data__;return this.size+=this.has(pe)?0:1,Me[pe]=de&&me===void 0?"__lodash_hash_undefined__":me,this},oe.prototype.clear=function(){this.__data__=[],this.size=0},oe.prototype.delete=function(pe){var me=this.__data__,Me=ne(me,pe);return!(Me<0)&&(Me==me.length-1?me.pop():Y.call(me,Me,1),--this.size,!0)},oe.prototype.get=function(pe){var me=this.__data__,Me=ne(me,pe);return Me<0?void 0:me[Me][1]},oe.prototype.has=function(pe){return ne(this.__data__,pe)>-1},oe.prototype.set=function(pe,me){var Me=this.__data__,He=ne(Me,pe);return He<0?(++this.size,Me.push([pe,me])):Me[He][1]=me,this},G.prototype.clear=function(){this.size=0,this.__data__={hash:new se,map:new(q||oe),string:new se}},G.prototype.delete=function(pe){var me=Le(this,pe).delete(pe);return this.size-=me?1:0,me},G.prototype.get=function(pe){return Le(this,pe).get(pe)},G.prototype.has=function(pe){return Le(this,pe).has(pe)},G.prototype.set=function(pe,me){var Me=Le(this,pe),He=Me.size;return Me.set(pe,me),this.size+=Me.size==He?0:1,this},Z.prototype.add=Z.prototype.push=function(pe){return this.__data__.set(pe,"__lodash_hash_undefined__"),this},Z.prototype.has=function(pe){return this.__data__.has(pe)},Q.prototype.clear=function(){this.__data__=new oe,this.size=0},Q.prototype.delete=function(pe){var me=this.__data__,Me=me.delete(pe);return this.size=me.size,Me},Q.prototype.get=function(pe){return this.__data__.get(pe)},Q.prototype.has=function(pe){return this.__data__.has(pe)},Q.prototype.set=function(pe,me){var Me=this.__data__;if(Me instanceof oe){var He=Me.__data__;if(!q||He.length<199)return He.push([pe,me]),this.size=++Me.size,this;Me=this.__data__=new G(He)}return Me.set(pe,me),this.size=Me.size,this};var Je=D?function(pe){return pe==null?[]:(pe=Object(pe),function(me,Me){for(var He=-1,Ae=me==null?0:me.length,ce=0,Ee=[];++He<Ae;){var Re=me[He];Me(Re,He,me)&&(Ee[ce++]=Re)}return Ee}(D(pe),function(me){return U.call(pe,me)}))}:function(){return[]},ft=ue;function Ct(pe,me){return!!(me=me==null?9007199254740991:me)&&(typeof pe=="number"||y.test(pe))&&pe>-1&&pe%1==0&&pe<me}function Ye(pe){if(pe!=null){try{return k.call(pe)}catch{}try{return pe+""}catch{}}return""}function et(pe,me){return pe===me||pe!=pe&&me!=me}(z&&ft(new z(new ArrayBuffer(1)))!="[object DataView]"||q&&ft(new q)!=l||X&&ft(X.resolve())!="[object Promise]"||ee&&ft(new ee)!=d||ye&&ft(new ye)!="[object WeakMap]")&&(ft=function(pe){var me=ue(pe),Me=me==p?pe.constructor:void 0,He=Me?Ye(Me):"";if(He)switch(He){case ge:return"[object DataView]";case we:return l;case be:return"[object Promise]";case J:return d;case te:return"[object WeakMap]"}return me});var Te=le(function(){return arguments}())?le:function(pe){return Et(pe)&&O.call(pe,"callee")&&!U.call(pe,"callee")},We=Array.isArray,rt=L||function(){return!1};function Rt(pe){if(!$t(pe))return!1;var me=ue(pe);return me=="[object Function]"||me=="[object GeneratorFunction]"||me=="[object AsyncFunction]"||me=="[object Proxy]"}function ut(pe){return typeof pe=="number"&&pe>-1&&pe%1==0&&pe<=9007199254740991}function $t(pe){var me=a(pe);return pe!=null&&(me=="object"||me=="function")}function Et(pe){return pe!=null&&a(pe)=="object"}var nt=C?function(pe){return function(me){return pe(me)}}(C):function(pe){return Et(pe)&&ut(pe.length)&&!!h[ue(pe)]};function Ft(pe){return(me=pe)!=null&&ut(me.length)&&!Rt(me)?re(pe):Oe(pe);var me}n.exports=function(pe,me){return ve(pe,me)}}).call(this,typeof At!="undefined"?At:typeof self!="undefined"?self:typeof window!="undefined"?window:{})},{}],430:[function(e,n,i){(function(o){function a(c){return(a=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(v){return typeof v}:function(v){return v&&typeof Symbol=="function"&&v.constructor===Symbol&&v!==Symbol.prototype?"symbol":typeof v})(c)}var s=(o===void 0?"undefined":a(o))=="object"&&o&&o.Object===Object&&o,l=(typeof self=="undefined"?"undefined":a(self))=="object"&&self&&self.Object===Object&&self,p=s||l||Function("return this")(),d=Object.prototype,g=d.hasOwnProperty,y=d.toString,h=p.Symbol,u=h?h.toStringTag:void 0;function f(c){return c==null?c===void 0?"[object Undefined]":"[object Null]":u&&u in Object(c)?function(v){var m=g.call(v,u),b=v[u];try{v[u]=void 0;var w=!0}catch{}var _=y.call(v);return w&&(m?v[u]=b:delete v[u]),_}(c):function(v){return y.call(v)}(c)}n.exports=function(c){if(!function(m){var b=a(m);return m!=null&&(b=="object"||b=="function")}(c))return!1;var v=f(c);return v=="[object Function]"||v=="[object GeneratorFunction]"||v=="[object AsyncFunction]"||v=="[object Proxy]"}}).call(this,typeof At!="undefined"?At:typeof self!="undefined"?self:typeof window!="undefined"?window:{})},{}],431:[function(e,n,i){n.exports=function(o){return o==null}},{}],432:[function(e,n,i){n.exports=function(o){return o===void 0}},{}],433:[function(e,n,i){(function(o){function a(W){return(a=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(U){return typeof U}:function(U){return U&&typeof Symbol=="function"&&U.constructor===Symbol&&U!==Symbol.prototype?"symbol":typeof U})(W)}var s=/^\[object .+?Constructor\]$/,l=(o===void 0?"undefined":a(o))=="object"&&o&&o.Object===Object&&o,p=(typeof self=="undefined"?"undefined":a(self))=="object"&&self&&self.Object===Object&&self,d=l||p||Function("return this")();function g(W,U){return!!(W?W.length:0)&&function(Y,K,D){if(K!=K)return function(z,q,X,ee){for(var ye=z.length,de=X+(ee?1:-1);ee?de--:++de<ye;)if(q(z[de],de,z))return de;return-1}(Y,h,D);for(var L=D-1,B=Y.length;++L<B;)if(Y[L]===K)return L;return-1}(W,U,0)>-1}function y(W,U,Y){for(var K=-1,D=W?W.length:0;++K<D;)if(Y(U,W[K]))return!0;return!1}function h(W){return W!=W}function u(W,U){return W.has(U)}function f(W){var U=-1,Y=Array(W.size);return W.forEach(function(K){Y[++U]=K}),Y}var c,v=Array.prototype,m=Function.prototype,b=Object.prototype,w=d["__core-js_shared__"],_=(c=/[^.]+$/.exec(w&&w.keys&&w.keys.IE_PROTO||""))?"Symbol(src)_1."+c:"",C=m.toString,R=b.hasOwnProperty,I=b.toString,P=RegExp("^"+C.call(R).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),N=v.splice,A=F(d,"Map"),$=F(d,"Set"),T=F(Object,"create");function M(W){var U=-1,Y=W?W.length:0;for(this.clear();++U<Y;){var K=W[U];this.set(K[0],K[1])}}function S(W){var U=-1,Y=W?W.length:0;for(this.clear();++U<Y;){var K=W[U];this.set(K[0],K[1])}}function E(W){var U=-1,Y=W?W.length:0;for(this.clear();++U<Y;){var K=W[U];this.set(K[0],K[1])}}function k(W){var U=-1,Y=W?W.length:0;for(this.__data__=new E;++U<Y;)this.add(W[U])}function O(W,U){for(var Y,K,D=W.length;D--;)if((Y=W[D][0])===(K=U)||Y!=Y&&K!=K)return D;return-1}function x(W){return!(!V(W)||(U=W,_&&_ in U))&&(function(Y){var K=V(Y)?I.call(Y):"";return K=="[object Function]"||K=="[object GeneratorFunction]"}(W)||function(Y){var K=!1;if(Y!=null&&typeof Y.toString!="function")try{K=!!(Y+"")}catch{}return K}(W)?P:s).test(function(Y){if(Y!=null){try{return C.call(Y)}catch{}try{return Y+""}catch{}}return""}(W));var U}M.prototype.clear=function(){this.__data__=T?T(null):{}},M.prototype.delete=function(W){return this.has(W)&&delete this.__data__[W]},M.prototype.get=function(W){var U=this.__data__;if(T){var Y=U[W];return Y==="__lodash_hash_undefined__"?void 0:Y}return R.call(U,W)?U[W]:void 0},M.prototype.has=function(W){var U=this.__data__;return T?U[W]!==void 0:R.call(U,W)},M.prototype.set=function(W,U){return this.__data__[W]=T&&U===void 0?"__lodash_hash_undefined__":U,this},S.prototype.clear=function(){this.__data__=[]},S.prototype.delete=function(W){var U=this.__data__,Y=O(U,W);return!(Y<0)&&(Y==U.length-1?U.pop():N.call(U,Y,1),!0)},S.prototype.get=function(W){var U=this.__data__,Y=O(U,W);return Y<0?void 0:U[Y][1]},S.prototype.has=function(W){return O(this.__data__,W)>-1},S.prototype.set=function(W,U){var Y=this.__data__,K=O(Y,W);return K<0?Y.push([W,U]):Y[K][1]=U,this},E.prototype.clear=function(){this.__data__={hash:new M,map:new(A||S),string:new M}},E.prototype.delete=function(W){return H(this,W).delete(W)},E.prototype.get=function(W){return H(this,W).get(W)},E.prototype.has=function(W){return H(this,W).has(W)},E.prototype.set=function(W,U){return H(this,W).set(W,U),this},k.prototype.add=k.prototype.push=function(W){return this.__data__.set(W,"__lodash_hash_undefined__"),this},k.prototype.has=function(W){return this.__data__.has(W)};var j=$&&1/f(new $([,-0]))[1]==1/0?function(W){return new $(W)}:function(){};function H(W,U){var Y,K,D=W.__data__;return((K=a(Y=U))=="string"||K=="number"||K=="symbol"||K=="boolean"?Y!=="__proto__":Y===null)?D[typeof U=="string"?"string":"hash"]:D.map}function F(W,U){var Y=function(K,D){return K==null?void 0:K[D]}(W,U);return x(Y)?Y:void 0}function V(W){var U=a(W);return!!W&&(U=="object"||U=="function")}n.exports=function(W){return W&&W.length?function(U,Y,K){var D=-1,L=g,B=U.length,z=!0,q=[],X=q;if(K)z=!1,L=y;else if(B>=200){var ee=Y?null:j(U);if(ee)return f(ee);z=!1,L=u,X=new k}else X=Y?[]:q;e:for(;++D<B;){var ye=U[D],de=Y?Y(ye):ye;if(ye=K||ye!==0?ye:0,z&&de==de){for(var ge=X.length;ge--;)if(X[ge]===de)continue e;Y&&X.push(de),q.push(ye)}else L(X,de,K)||(X!==q&&X.push(de),q.push(ye))}return q}(W):[]}}).call(this,typeof At!="undefined"?At:typeof self!="undefined"?self:typeof window!="undefined"?window:{})},{}],434:[function(e,n,i){var o=e("inherits"),a=e("hash-base"),s=e("safe-buffer").Buffer,l=new Array(16);function p(){a.call(this,64),this._a=1732584193,this._b=4023233417,this._c=2562383102,this._d=271733878}function d(f,c){return f<<c|f>>>32-c}function g(f,c,v,m,b,w,_){return d(f+(c&v|~c&m)+b+w|0,_)+c|0}function y(f,c,v,m,b,w,_){return d(f+(c&m|v&~m)+b+w|0,_)+c|0}function h(f,c,v,m,b,w,_){return d(f+(c^v^m)+b+w|0,_)+c|0}function u(f,c,v,m,b,w,_){return d(f+(v^(c|~m))+b+w|0,_)+c|0}o(p,a),p.prototype._update=function(){for(var f=l,c=0;c<16;++c)f[c]=this._block.readInt32LE(4*c);var v=this._a,m=this._b,b=this._c,w=this._d;v=g(v,m,b,w,f[0],3614090360,7),w=g(w,v,m,b,f[1],3905402710,12),b=g(b,w,v,m,f[2],606105819,17),m=g(m,b,w,v,f[3],3250441966,22),v=g(v,m,b,w,f[4],4118548399,7),w=g(w,v,m,b,f[5],1200080426,12),b=g(b,w,v,m,f[6],2821735955,17),m=g(m,b,w,v,f[7],4249261313,22),v=g(v,m,b,w,f[8],1770035416,7),w=g(w,v,m,b,f[9],2336552879,12),b=g(b,w,v,m,f[10],4294925233,17),m=g(m,b,w,v,f[11],2304563134,22),v=g(v,m,b,w,f[12],1804603682,7),w=g(w,v,m,b,f[13],4254626195,12),b=g(b,w,v,m,f[14],2792965006,17),v=y(v,m=g(m,b,w,v,f[15],1236535329,22),b,w,f[1],4129170786,5),w=y(w,v,m,b,f[6],3225465664,9),b=y(b,w,v,m,f[11],643717713,14),m=y(m,b,w,v,f[0],3921069994,20),v=y(v,m,b,w,f[5],3593408605,5),w=y(w,v,m,b,f[10],38016083,9),b=y(b,w,v,m,f[15],3634488961,14),m=y(m,b,w,v,f[4],3889429448,20),v=y(v,m,b,w,f[9],568446438,5),w=y(w,v,m,b,f[14],3275163606,9),b=y(b,w,v,m,f[3],4107603335,14),m=y(m,b,w,v,f[8],1163531501,20),v=y(v,m,b,w,f[13],2850285829,5),w=y(w,v,m,b,f[2],4243563512,9),b=y(b,w,v,m,f[7],1735328473,14),v=h(v,m=y(m,b,w,v,f[12],2368359562,20),b,w,f[5],4294588738,4),w=h(w,v,m,b,f[8],2272392833,11),b=h(b,w,v,m,f[11],1839030562,16),m=h(m,b,w,v,f[14],4259657740,23),v=h(v,m,b,w,f[1],2763975236,4),w=h(w,v,m,b,f[4],1272893353,11),b=h(b,w,v,m,f[7],4139469664,16),m=h(m,b,w,v,f[10],3200236656,23),v=h(v,m,b,w,f[13],681279174,4),w=h(w,v,m,b,f[0],3936430074,11),b=h(b,w,v,m,f[3],3572445317,16),m=h(m,b,w,v,f[6],76029189,23),v=h(v,m,b,w,f[9],3654602809,4),w=h(w,v,m,b,f[12],3873151461,11),b=h(b,w,v,m,f[15],530742520,16),v=u(v,m=h(m,b,w,v,f[2],3299628645,23),b,w,f[0],4096336452,6),w=u(w,v,m,b,f[7],1126891415,10),b=u(b,w,v,m,f[14],2878612391,15),m=u(m,b,w,v,f[5],4237533241,21),v=u(v,m,b,w,f[12],1700485571,6),w=u(w,v,m,b,f[3],2399980690,10),b=u(b,w,v,m,f[10],4293915773,15),m=u(m,b,w,v,f[1],2240044497,21),v=u(v,m,b,w,f[8],1873313359,6),w=u(w,v,m,b,f[15],4264355552,10),b=u(b,w,v,m,f[6],2734768916,15),m=u(m,b,w,v,f[13],1309151649,21),v=u(v,m,b,w,f[4],4149444226,6),w=u(w,v,m,b,f[11],3174756917,10),b=u(b,w,v,m,f[2],718787259,15),m=u(m,b,w,v,f[9],3951481745,21),this._a=this._a+v|0,this._b=this._b+m|0,this._c=this._c+b|0,this._d=this._d+w|0},p.prototype._digest=function(){this._block[this._blockOffset++]=128,this._blockOffset>56&&(this._block.fill(0,this._blockOffset,64),this._update(),this._blockOffset=0),this._block.fill(0,this._blockOffset,56),this._block.writeUInt32LE(this._length[0],56),this._block.writeUInt32LE(this._length[1],60),this._update();var f=s.allocUnsafe(16);return f.writeInt32LE(this._a,0),f.writeInt32LE(this._b,4),f.writeInt32LE(this._c,8),f.writeInt32LE(this._d,12),f},n.exports=p},{"hash-base":370,inherits:387,"safe-buffer":494}],435:[function(e,n,i){var o=e("bn.js"),a=e("brorand");function s(l){this.rand=l||new a.Rand}n.exports=s,s.create=function(l){return new s(l)},s.prototype._randbelow=function(l){var p=l.bitLength(),d=Math.ceil(p/8);do var g=new o(this.rand.generate(d));while(g.cmp(l)>=0);return g},s.prototype._randrange=function(l,p){var d=p.sub(l);return l.add(this._randbelow(d))},s.prototype.test=function(l,p,d){var g=l.bitLength(),y=o.mont(l),h=new o(1).toRed(y);p||(p=Math.max(1,g/48|0));for(var u=l.subn(1),f=0;!u.testn(f);f++);for(var c=l.shrn(f),v=u.toRed(y);p>0;p--){var m=this._randrange(new o(2),u);d&&d(m);var b=m.toRed(y).redPow(c);if(b.cmp(h)!==0&&b.cmp(v)!==0){for(var w=1;w<f;w++){if((b=b.redSqr()).cmp(h)===0)return!1;if(b.cmp(v)===0)break}if(w===f)return!1}}return!0},s.prototype.getDivisor=function(l,p){var d=l.bitLength(),g=o.mont(l),y=new o(1).toRed(g);p||(p=Math.max(1,d/48|0));for(var h=l.subn(1),u=0;!h.testn(u);u++);for(var f=l.shrn(u),c=h.toRed(g);p>0;p--){var v=this._randrange(new o(2),h),m=l.gcd(v);if(m.cmpn(1)!==0)return m;var b=v.toRed(g).redPow(f);if(b.cmp(y)!==0&&b.cmp(c)!==0){for(var w=1;w<u;w++){if((b=b.redSqr()).cmp(y)===0)return b.fromRed().subn(1).gcd(l);if(b.cmp(c)===0)break}if(w===u)return(b=b.redSqr()).fromRed().subn(1).gcd(l)}}return!1}},{"bn.js":436,brorand:184}],436:[function(e,n,i){arguments[4][181][0].apply(i,arguments)},{buffer:185,dup:181}],437:[function(e,n,i){function o(a,s){if(!a)throw new Error(s||"Assertion failed")}n.exports=o,o.equal=function(a,s,l){if(a!=s)throw new Error(l||"Assertion failed: "+a+" != "+s)}},{}],438:[function(e,n,i){var o=i;function a(l){return l.length===1?"0"+l:l}function s(l){for(var p="",d=0;d<l.length;d++)p+=a(l[d].toString(16));return p}o.toArray=function(l,p){if(Array.isArray(l))return l.slice();if(!l)return[];var d=[];if(typeof l!="string"){for(var g=0;g<l.length;g++)d[g]=0|l[g];return d}if(p==="hex")for((l=l.replace(/[^a-z0-9]+/gi,"")).length%2!=0&&(l="0"+l),g=0;g<l.length;g+=2)d.push(parseInt(l[g]+l[g+1],16));else for(g=0;g<l.length;g++){var y=l.charCodeAt(g),h=y>>8,u=255&y;h?d.push(h,u):d.push(u)}return d},o.zero2=a,o.toHex=s,o.encode=function(l,p){return p==="hex"?s(l):l}},{}],439:[function(e,n,i){var o={};(0,e("./lib/utils/common").assign)(o,e("./lib/deflate"),e("./lib/inflate"),e("./lib/zlib/constants")),n.exports=o},{"./lib/deflate":440,"./lib/inflate":441,"./lib/utils/common":442,"./lib/zlib/constants":445}],440:[function(e,n,i){var o=e("./zlib/deflate"),a=e("./utils/common"),s=e("./utils/strings"),l=e("./zlib/messages"),p=e("./zlib/zstream"),d=Object.prototype.toString;function g(h){if(!(this instanceof g))return new g(h);this.options=a.assign({level:-1,method:8,chunkSize:16384,windowBits:15,memLevel:8,strategy:0,to:""},h||{});var u=this.options;u.raw&&u.windowBits>0?u.windowBits=-u.windowBits:u.gzip&&u.windowBits>0&&u.windowBits<16&&(u.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new p,this.strm.avail_out=0;var f=o.deflateInit2(this.strm,u.level,u.method,u.windowBits,u.memLevel,u.strategy);if(f!==0)throw new Error(l[f]);if(u.header&&o.deflateSetHeader(this.strm,u.header),u.dictionary){var c;if(c=typeof u.dictionary=="string"?s.string2buf(u.dictionary):d.call(u.dictionary)==="[object ArrayBuffer]"?new Uint8Array(u.dictionary):u.dictionary,(f=o.deflateSetDictionary(this.strm,c))!==0)throw new Error(l[f]);this._dict_set=!0}}function y(h,u){var f=new g(u);if(f.push(h,!0),f.err)throw f.msg||l[f.err];return f.result}g.prototype.push=function(h,u){var f,c,v=this.strm,m=this.options.chunkSize;if(this.ended)return!1;c=u===~~u?u:u===!0?4:0,typeof h=="string"?v.input=s.string2buf(h):d.call(h)==="[object ArrayBuffer]"?v.input=new Uint8Array(h):v.input=h,v.next_in=0,v.avail_in=v.input.length;do{if(v.avail_out===0&&(v.output=new a.Buf8(m),v.next_out=0,v.avail_out=m),(f=o.deflate(v,c))!==1&&f!==0)return this.onEnd(f),this.ended=!0,!1;v.avail_out!==0&&(v.avail_in!==0||c!==4&&c!==2)||(this.options.to==="string"?this.onData(s.buf2binstring(a.shrinkBuf(v.output,v.next_out))):this.onData(a.shrinkBuf(v.output,v.next_out)))}while((v.avail_in>0||v.avail_out===0)&&f!==1);return c===4?(f=o.deflateEnd(this.strm),this.onEnd(f),this.ended=!0,f===0):c!==2||(this.onEnd(0),v.avail_out=0,!0)},g.prototype.onData=function(h){this.chunks.push(h)},g.prototype.onEnd=function(h){h===0&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=a.flattenChunks(this.chunks)),this.chunks=[],this.err=h,this.msg=this.strm.msg},i.Deflate=g,i.deflate=y,i.deflateRaw=function(h,u){return(u=u||{}).raw=!0,y(h,u)},i.gzip=function(h,u){return(u=u||{}).gzip=!0,y(h,u)}},{"./utils/common":442,"./utils/strings":443,"./zlib/deflate":447,"./zlib/messages":452,"./zlib/zstream":454}],441:[function(e,n,i){var o=e("./zlib/inflate"),a=e("./utils/common"),s=e("./utils/strings"),l=e("./zlib/constants"),p=e("./zlib/messages"),d=e("./zlib/zstream"),g=e("./zlib/gzheader"),y=Object.prototype.toString;function h(f){if(!(this instanceof h))return new h(f);this.options=a.assign({chunkSize:16384,windowBits:0,to:""},f||{});var c=this.options;c.raw&&c.windowBits>=0&&c.windowBits<16&&(c.windowBits=-c.windowBits,c.windowBits===0&&(c.windowBits=-15)),!(c.windowBits>=0&&c.windowBits<16)||f&&f.windowBits||(c.windowBits+=32),c.windowBits>15&&c.windowBits<48&&(15&c.windowBits)==0&&(c.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new d,this.strm.avail_out=0;var v=o.inflateInit2(this.strm,c.windowBits);if(v!==l.Z_OK)throw new Error(p[v]);if(this.header=new g,o.inflateGetHeader(this.strm,this.header),c.dictionary&&(typeof c.dictionary=="string"?c.dictionary=s.string2buf(c.dictionary):y.call(c.dictionary)==="[object ArrayBuffer]"&&(c.dictionary=new Uint8Array(c.dictionary)),c.raw&&(v=o.inflateSetDictionary(this.strm,c.dictionary))!==l.Z_OK))throw new Error(p[v])}function u(f,c){var v=new h(c);if(v.push(f,!0),v.err)throw v.msg||p[v.err];return v.result}h.prototype.push=function(f,c){var v,m,b,w,_,C=this.strm,R=this.options.chunkSize,I=this.options.dictionary,P=!1;if(this.ended)return!1;m=c===~~c?c:c===!0?l.Z_FINISH:l.Z_NO_FLUSH,typeof f=="string"?C.input=s.binstring2buf(f):y.call(f)==="[object ArrayBuffer]"?C.input=new Uint8Array(f):C.input=f,C.next_in=0,C.avail_in=C.input.length;do{if(C.avail_out===0&&(C.output=new a.Buf8(R),C.next_out=0,C.avail_out=R),(v=o.inflate(C,l.Z_NO_FLUSH))===l.Z_NEED_DICT&&I&&(v=o.inflateSetDictionary(this.strm,I)),v===l.Z_BUF_ERROR&&P===!0&&(v=l.Z_OK,P=!1),v!==l.Z_STREAM_END&&v!==l.Z_OK)return this.onEnd(v),this.ended=!0,!1;C.next_out&&(C.avail_out!==0&&v!==l.Z_STREAM_END&&(C.avail_in!==0||m!==l.Z_FINISH&&m!==l.Z_SYNC_FLUSH)||(this.options.to==="string"?(b=s.utf8border(C.output,C.next_out),w=C.next_out-b,_=s.buf2string(C.output,b),C.next_out=w,C.avail_out=R-w,w&&a.arraySet(C.output,C.output,b,w,0),this.onData(_)):this.onData(a.shrinkBuf(C.output,C.next_out)))),C.avail_in===0&&C.avail_out===0&&(P=!0)}while((C.avail_in>0||C.avail_out===0)&&v!==l.Z_STREAM_END);return v===l.Z_STREAM_END&&(m=l.Z_FINISH),m===l.Z_FINISH?(v=o.inflateEnd(this.strm),this.onEnd(v),this.ended=!0,v===l.Z_OK):m!==l.Z_SYNC_FLUSH||(this.onEnd(l.Z_OK),C.avail_out=0,!0)},h.prototype.onData=function(f){this.chunks.push(f)},h.prototype.onEnd=function(f){f===l.Z_OK&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=a.flattenChunks(this.chunks)),this.chunks=[],this.err=f,this.msg=this.strm.msg},i.Inflate=h,i.inflate=u,i.inflateRaw=function(f,c){return(c=c||{}).raw=!0,u(f,c)},i.ungzip=u},{"./utils/common":442,"./utils/strings":443,"./zlib/constants":445,"./zlib/gzheader":448,"./zlib/inflate":450,"./zlib/messages":452,"./zlib/zstream":454}],442:[function(e,n,i){function o(d){return(o=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(g){return typeof g}:function(g){return g&&typeof Symbol=="function"&&g.constructor===Symbol&&g!==Symbol.prototype?"symbol":typeof g})(d)}var a=typeof Uint8Array!="undefined"&&typeof Uint16Array!="undefined"&&typeof Int32Array!="undefined";function s(d,g){return Object.prototype.hasOwnProperty.call(d,g)}i.assign=function(d){for(var g=Array.prototype.slice.call(arguments,1);g.length;){var y=g.shift();if(y){if(o(y)!=="object")throw new TypeError(y+"must be non-object");for(var h in y)s(y,h)&&(d[h]=y[h])}}return d},i.shrinkBuf=function(d,g){return d.length===g?d:d.subarray?d.subarray(0,g):(d.length=g,d)};var l={arraySet:function(d,g,y,h,u){if(g.subarray&&d.subarray)d.set(g.subarray(y,y+h),u);else for(var f=0;f<h;f++)d[u+f]=g[y+f]},flattenChunks:function(d){var g,y,h,u,f,c;for(h=0,g=0,y=d.length;g<y;g++)h+=d[g].length;for(c=new Uint8Array(h),u=0,g=0,y=d.length;g<y;g++)f=d[g],c.set(f,u),u+=f.length;return c}},p={arraySet:function(d,g,y,h,u){for(var f=0;f<h;f++)d[u+f]=g[y+f]},flattenChunks:function(d){return[].concat.apply([],d)}};i.setTyped=function(d){d?(i.Buf8=Uint8Array,i.Buf16=Uint16Array,i.Buf32=Int32Array,i.assign(i,l)):(i.Buf8=Array,i.Buf16=Array,i.Buf32=Array,i.assign(i,p))},i.setTyped(a)},{}],443:[function(e,n,i){var o=e("./common"),a=!0,s=!0;try{String.fromCharCode.apply(null,[0])}catch{a=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{s=!1}for(var l=new o.Buf8(256),p=0;p<256;p++)l[p]=p>=252?6:p>=248?5:p>=240?4:p>=224?3:p>=192?2:1;function d(g,y){if(y<65534&&(g.subarray&&s||!g.subarray&&a))return String.fromCharCode.apply(null,o.shrinkBuf(g,y));for(var h="",u=0;u<y;u++)h+=String.fromCharCode(g[u]);return h}l[254]=l[254]=1,i.string2buf=function(g){var y,h,u,f,c,v=g.length,m=0;for(f=0;f<v;f++)(64512&(h=g.charCodeAt(f)))==55296&&f+1<v&&(64512&(u=g.charCodeAt(f+1)))==56320&&(h=65536+(h-55296<<10)+(u-56320),f++),m+=h<128?1:h<2048?2:h<65536?3:4;for(y=new o.Buf8(m),c=0,f=0;c<m;f++)(64512&(h=g.charCodeAt(f)))==55296&&f+1<v&&(64512&(u=g.charCodeAt(f+1)))==56320&&(h=65536+(h-55296<<10)+(u-56320),f++),h<128?y[c++]=h:h<2048?(y[c++]=192|h>>>6,y[c++]=128|63&h):h<65536?(y[c++]=224|h>>>12,y[c++]=128|h>>>6&63,y[c++]=128|63&h):(y[c++]=240|h>>>18,y[c++]=128|h>>>12&63,y[c++]=128|h>>>6&63,y[c++]=128|63&h);return y},i.buf2binstring=function(g){return d(g,g.length)},i.binstring2buf=function(g){for(var y=new o.Buf8(g.length),h=0,u=y.length;h<u;h++)y[h]=g.charCodeAt(h);return y},i.buf2string=function(g,y){var h,u,f,c,v=y||g.length,m=new Array(2*v);for(u=0,h=0;h<v;)if((f=g[h++])<128)m[u++]=f;else if((c=l[f])>4)m[u++]=65533,h+=c-1;else{for(f&=c===2?31:c===3?15:7;c>1&&h<v;)f=f<<6|63&g[h++],c--;c>1?m[u++]=65533:f<65536?m[u++]=f:(f-=65536,m[u++]=55296|f>>10&1023,m[u++]=56320|1023&f)}return d(m,u)},i.utf8border=function(g,y){var h;for((y=y||g.length)>g.length&&(y=g.length),h=y-1;h>=0&&(192&g[h])==128;)h--;return h<0||h===0?y:h+l[g[h]]>y?h:y}},{"./common":442}],444:[function(e,n,i){n.exports=function(o,a,s,l){for(var p=65535&o|0,d=o>>>16&65535|0,g=0;s!==0;){s-=g=s>2e3?2e3:s;do d=d+(p=p+a[l++]|0)|0;while(--g);p%=65521,d%=65521}return p|d<<16|0}},{}],445:[function(e,n,i){n.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],446:[function(e,n,i){var o=function(){for(var a,s=[],l=0;l<256;l++){a=l;for(var p=0;p<8;p++)a=1&a?3988292384^a>>>1:a>>>1;s[l]=a}return s}();n.exports=function(a,s,l,p){var d=o,g=p+l;a^=-1;for(var y=p;y<g;y++)a=a>>>8^d[255&(a^s[y])];return-1^a}},{}],447:[function(e,n,i){var o,a=e("../utils/common"),s=e("./trees"),l=e("./adler32"),p=e("./crc32"),d=e("./messages");function g(A,$){return A.msg=d[$],$}function y(A){return(A<<1)-(A>4?9:0)}function h(A){for(var $=A.length;--$>=0;)A[$]=0}function u(A){var $=A.state,T=$.pending;T>A.avail_out&&(T=A.avail_out),T!==0&&(a.arraySet(A.output,$.pending_buf,$.pending_out,T,A.next_out),A.next_out+=T,$.pending_out+=T,A.total_out+=T,A.avail_out-=T,$.pending-=T,$.pending===0&&($.pending_out=0))}function f(A,$){s._tr_flush_block(A,A.block_start>=0?A.block_start:-1,A.strstart-A.block_start,$),A.block_start=A.strstart,u(A.strm)}function c(A,$){A.pending_buf[A.pending++]=$}function v(A,$){A.pending_buf[A.pending++]=$>>>8&255,A.pending_buf[A.pending++]=255&$}function m(A,$){var T,M,S=A.max_chain_length,E=A.strstart,k=A.prev_length,O=A.nice_match,x=A.strstart>A.w_size-262?A.strstart-(A.w_size-262):0,j=A.window,H=A.w_mask,F=A.prev,V=A.strstart+258,W=j[E+k-1],U=j[E+k];A.prev_length>=A.good_match&&(S>>=2),O>A.lookahead&&(O=A.lookahead);do if(j[(T=$)+k]===U&&j[T+k-1]===W&&j[T]===j[E]&&j[++T]===j[E+1]){E+=2,T++;do;while(j[++E]===j[++T]&&j[++E]===j[++T]&&j[++E]===j[++T]&&j[++E]===j[++T]&&j[++E]===j[++T]&&j[++E]===j[++T]&&j[++E]===j[++T]&&j[++E]===j[++T]&&E<V);if(M=258-(V-E),E=V-258,M>k){if(A.match_start=$,k=M,M>=O)break;W=j[E+k-1],U=j[E+k]}}while(($=F[$&H])>x&&--S!=0);return k<=A.lookahead?k:A.lookahead}function b(A){var $,T,M,S,E,k,O,x,j,H,F=A.w_size;do{if(S=A.window_size-A.lookahead-A.strstart,A.strstart>=F+(F-262)){a.arraySet(A.window,A.window,F,F,0),A.match_start-=F,A.strstart-=F,A.block_start-=F,$=T=A.hash_size;do M=A.head[--$],A.head[$]=M>=F?M-F:0;while(--T);$=T=F;do M=A.prev[--$],A.prev[$]=M>=F?M-F:0;while(--T);S+=F}if(A.strm.avail_in===0)break;if(k=A.strm,O=A.window,x=A.strstart+A.lookahead,j=S,H=void 0,(H=k.avail_in)>j&&(H=j),T=H===0?0:(k.avail_in-=H,a.arraySet(O,k.input,k.next_in,H,x),k.state.wrap===1?k.adler=l(k.adler,O,H,x):k.state.wrap===2&&(k.adler=p(k.adler,O,H,x)),k.next_in+=H,k.total_in+=H,H),A.lookahead+=T,A.lookahead+A.insert>=3)for(E=A.strstart-A.insert,A.ins_h=A.window[E],A.ins_h=(A.ins_h<<A.hash_shift^A.window[E+1])&A.hash_mask;A.insert&&(A.ins_h=(A.ins_h<<A.hash_shift^A.window[E+3-1])&A.hash_mask,A.prev[E&A.w_mask]=A.head[A.ins_h],A.head[A.ins_h]=E,E++,A.insert--,!(A.lookahead+A.insert<3)););}while(A.lookahead<262&&A.strm.avail_in!==0)}function w(A,$){for(var T,M;;){if(A.lookahead<262){if(b(A),A.lookahead<262&&$===0)return 1;if(A.lookahead===0)break}if(T=0,A.lookahead>=3&&(A.ins_h=(A.ins_h<<A.hash_shift^A.window[A.strstart+3-1])&A.hash_mask,T=A.prev[A.strstart&A.w_mask]=A.head[A.ins_h],A.head[A.ins_h]=A.strstart),T!==0&&A.strstart-T<=A.w_size-262&&(A.match_length=m(A,T)),A.match_length>=3)if(M=s._tr_tally(A,A.strstart-A.match_start,A.match_length-3),A.lookahead-=A.match_length,A.match_length<=A.max_lazy_match&&A.lookahead>=3){A.match_length--;do A.strstart++,A.ins_h=(A.ins_h<<A.hash_shift^A.window[A.strstart+3-1])&A.hash_mask,T=A.prev[A.strstart&A.w_mask]=A.head[A.ins_h],A.head[A.ins_h]=A.strstart;while(--A.match_length!=0);A.strstart++}else A.strstart+=A.match_length,A.match_length=0,A.ins_h=A.window[A.strstart],A.ins_h=(A.ins_h<<A.hash_shift^A.window[A.strstart+1])&A.hash_mask;else M=s._tr_tally(A,0,A.window[A.strstart]),A.lookahead--,A.strstart++;if(M&&(f(A,!1),A.strm.avail_out===0))return 1}return A.insert=A.strstart<2?A.strstart:2,$===4?(f(A,!0),A.strm.avail_out===0?3:4):A.last_lit&&(f(A,!1),A.strm.avail_out===0)?1:2}function _(A,$){for(var T,M,S;;){if(A.lookahead<262){if(b(A),A.lookahead<262&&$===0)return 1;if(A.lookahead===0)break}if(T=0,A.lookahead>=3&&(A.ins_h=(A.ins_h<<A.hash_shift^A.window[A.strstart+3-1])&A.hash_mask,T=A.prev[A.strstart&A.w_mask]=A.head[A.ins_h],A.head[A.ins_h]=A.strstart),A.prev_length=A.match_length,A.prev_match=A.match_start,A.match_length=2,T!==0&&A.prev_length<A.max_lazy_match&&A.strstart-T<=A.w_size-262&&(A.match_length=m(A,T),A.match_length<=5&&(A.strategy===1||A.match_length===3&&A.strstart-A.match_start>4096)&&(A.match_length=2)),A.prev_length>=3&&A.match_length<=A.prev_length){S=A.strstart+A.lookahead-3,M=s._tr_tally(A,A.strstart-1-A.prev_match,A.prev_length-3),A.lookahead-=A.prev_length-1,A.prev_length-=2;do++A.strstart<=S&&(A.ins_h=(A.ins_h<<A.hash_shift^A.window[A.strstart+3-1])&A.hash_mask,T=A.prev[A.strstart&A.w_mask]=A.head[A.ins_h],A.head[A.ins_h]=A.strstart);while(--A.prev_length!=0);if(A.match_available=0,A.match_length=2,A.strstart++,M&&(f(A,!1),A.strm.avail_out===0))return 1}else if(A.match_available){if((M=s._tr_tally(A,0,A.window[A.strstart-1]))&&f(A,!1),A.strstart++,A.lookahead--,A.strm.avail_out===0)return 1}else A.match_available=1,A.strstart++,A.lookahead--}return A.match_available&&(M=s._tr_tally(A,0,A.window[A.strstart-1]),A.match_available=0),A.insert=A.strstart<2?A.strstart:2,$===4?(f(A,!0),A.strm.avail_out===0?3:4):A.last_lit&&(f(A,!1),A.strm.avail_out===0)?1:2}function C(A,$,T,M,S){this.good_length=A,this.max_lazy=$,this.nice_length=T,this.max_chain=M,this.func=S}function R(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=8,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new a.Buf16(1146),this.dyn_dtree=new a.Buf16(122),this.bl_tree=new a.Buf16(78),h(this.dyn_ltree),h(this.dyn_dtree),h(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new a.Buf16(16),this.heap=new a.Buf16(573),h(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new a.Buf16(573),h(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function I(A){var $;return A&&A.state?(A.total_in=A.total_out=0,A.data_type=2,($=A.state).pending=0,$.pending_out=0,$.wrap<0&&($.wrap=-$.wrap),$.status=$.wrap?42:113,A.adler=$.wrap===2?0:1,$.last_flush=0,s._tr_init($),0):g(A,-2)}function P(A){var $,T=I(A);return T===0&&(($=A.state).window_size=2*$.w_size,h($.head),$.max_lazy_match=o[$.level].max_lazy,$.good_match=o[$.level].good_length,$.nice_match=o[$.level].nice_length,$.max_chain_length=o[$.level].max_chain,$.strstart=0,$.block_start=0,$.lookahead=0,$.insert=0,$.match_length=$.prev_length=2,$.match_available=0,$.ins_h=0),T}function N(A,$,T,M,S,E){if(!A)return-2;var k=1;if($===-1&&($=6),M<0?(k=0,M=-M):M>15&&(k=2,M-=16),S<1||S>9||T!==8||M<8||M>15||$<0||$>9||E<0||E>4)return g(A,-2);M===8&&(M=9);var O=new R;return A.state=O,O.strm=A,O.wrap=k,O.gzhead=null,O.w_bits=M,O.w_size=1<<O.w_bits,O.w_mask=O.w_size-1,O.hash_bits=S+7,O.hash_size=1<<O.hash_bits,O.hash_mask=O.hash_size-1,O.hash_shift=~~((O.hash_bits+3-1)/3),O.window=new a.Buf8(2*O.w_size),O.head=new a.Buf16(O.hash_size),O.prev=new a.Buf16(O.w_size),O.lit_bufsize=1<<S+6,O.pending_buf_size=4*O.lit_bufsize,O.pending_buf=new a.Buf8(O.pending_buf_size),O.d_buf=1*O.lit_bufsize,O.l_buf=3*O.lit_bufsize,O.level=$,O.strategy=E,O.method=T,P(A)}o=[new C(0,0,0,0,function(A,$){var T=65535;for(T>A.pending_buf_size-5&&(T=A.pending_buf_size-5);;){if(A.lookahead<=1){if(b(A),A.lookahead===0&&$===0)return 1;if(A.lookahead===0)break}A.strstart+=A.lookahead,A.lookahead=0;var M=A.block_start+T;if((A.strstart===0||A.strstart>=M)&&(A.lookahead=A.strstart-M,A.strstart=M,f(A,!1),A.strm.avail_out===0)||A.strstart-A.block_start>=A.w_size-262&&(f(A,!1),A.strm.avail_out===0))return 1}return A.insert=0,$===4?(f(A,!0),A.strm.avail_out===0?3:4):(A.strstart>A.block_start&&(f(A,!1),A.strm.avail_out),1)}),new C(4,4,8,4,w),new C(4,5,16,8,w),new C(4,6,32,32,w),new C(4,4,16,16,_),new C(8,16,32,32,_),new C(8,16,128,128,_),new C(8,32,128,256,_),new C(32,128,258,1024,_),new C(32,258,258,4096,_)],i.deflateInit=function(A,$){return N(A,$,8,15,8,0)},i.deflateInit2=N,i.deflateReset=P,i.deflateResetKeep=I,i.deflateSetHeader=function(A,$){return A&&A.state?A.state.wrap!==2?-2:(A.state.gzhead=$,0):-2},i.deflate=function(A,$){var T,M,S,E;if(!A||!A.state||$>5||$<0)return A?g(A,-2):-2;if(M=A.state,!A.output||!A.input&&A.avail_in!==0||M.status===666&&$!==4)return g(A,A.avail_out===0?-5:-2);if(M.strm=A,T=M.last_flush,M.last_flush=$,M.status===42)if(M.wrap===2)A.adler=0,c(M,31),c(M,139),c(M,8),M.gzhead?(c(M,(M.gzhead.text?1:0)+(M.gzhead.hcrc?2:0)+(M.gzhead.extra?4:0)+(M.gzhead.name?8:0)+(M.gzhead.comment?16:0)),c(M,255&M.gzhead.time),c(M,M.gzhead.time>>8&255),c(M,M.gzhead.time>>16&255),c(M,M.gzhead.time>>24&255),c(M,M.level===9?2:M.strategy>=2||M.level<2?4:0),c(M,255&M.gzhead.os),M.gzhead.extra&&M.gzhead.extra.length&&(c(M,255&M.gzhead.extra.length),c(M,M.gzhead.extra.length>>8&255)),M.gzhead.hcrc&&(A.adler=p(A.adler,M.pending_buf,M.pending,0)),M.gzindex=0,M.status=69):(c(M,0),c(M,0),c(M,0),c(M,0),c(M,0),c(M,M.level===9?2:M.strategy>=2||M.level<2?4:0),c(M,3),M.status=113);else{var k=8+(M.w_bits-8<<4)<<8;k|=(M.strategy>=2||M.level<2?0:M.level<6?1:M.level===6?2:3)<<6,M.strstart!==0&&(k|=32),k+=31-k%31,M.status=113,v(M,k),M.strstart!==0&&(v(M,A.adler>>>16),v(M,65535&A.adler)),A.adler=1}if(M.status===69)if(M.gzhead.extra){for(S=M.pending;M.gzindex<(65535&M.gzhead.extra.length)&&(M.pending!==M.pending_buf_size||(M.gzhead.hcrc&&M.pending>S&&(A.adler=p(A.adler,M.pending_buf,M.pending-S,S)),u(A),S=M.pending,M.pending!==M.pending_buf_size));)c(M,255&M.gzhead.extra[M.gzindex]),M.gzindex++;M.gzhead.hcrc&&M.pending>S&&(A.adler=p(A.adler,M.pending_buf,M.pending-S,S)),M.gzindex===M.gzhead.extra.length&&(M.gzindex=0,M.status=73)}else M.status=73;if(M.status===73)if(M.gzhead.name){S=M.pending;do{if(M.pending===M.pending_buf_size&&(M.gzhead.hcrc&&M.pending>S&&(A.adler=p(A.adler,M.pending_buf,M.pending-S,S)),u(A),S=M.pending,M.pending===M.pending_buf_size)){E=1;break}E=M.gzindex<M.gzhead.name.length?255&M.gzhead.name.charCodeAt(M.gzindex++):0,c(M,E)}while(E!==0);M.gzhead.hcrc&&M.pending>S&&(A.adler=p(A.adler,M.pending_buf,M.pending-S,S)),E===0&&(M.gzindex=0,M.status=91)}else M.status=91;if(M.status===91)if(M.gzhead.comment){S=M.pending;do{if(M.pending===M.pending_buf_size&&(M.gzhead.hcrc&&M.pending>S&&(A.adler=p(A.adler,M.pending_buf,M.pending-S,S)),u(A),S=M.pending,M.pending===M.pending_buf_size)){E=1;break}E=M.gzindex<M.gzhead.comment.length?255&M.gzhead.comment.charCodeAt(M.gzindex++):0,c(M,E)}while(E!==0);M.gzhead.hcrc&&M.pending>S&&(A.adler=p(A.adler,M.pending_buf,M.pending-S,S)),E===0&&(M.status=103)}else M.status=103;if(M.status===103&&(M.gzhead.hcrc?(M.pending+2>M.pending_buf_size&&u(A),M.pending+2<=M.pending_buf_size&&(c(M,255&A.adler),c(M,A.adler>>8&255),A.adler=0,M.status=113)):M.status=113),M.pending!==0){if(u(A),A.avail_out===0)return M.last_flush=-1,0}else if(A.avail_in===0&&y($)<=y(T)&&$!==4)return g(A,-5);if(M.status===666&&A.avail_in!==0)return g(A,-5);if(A.avail_in!==0||M.lookahead!==0||$!==0&&M.status!==666){var O=M.strategy===2?function(x,j){for(var H;;){if(x.lookahead===0&&(b(x),x.lookahead===0)){if(j===0)return 1;break}if(x.match_length=0,H=s._tr_tally(x,0,x.window[x.strstart]),x.lookahead--,x.strstart++,H&&(f(x,!1),x.strm.avail_out===0))return 1}return x.insert=0,j===4?(f(x,!0),x.strm.avail_out===0?3:4):x.last_lit&&(f(x,!1),x.strm.avail_out===0)?1:2}(M,$):M.strategy===3?function(x,j){for(var H,F,V,W,U=x.window;;){if(x.lookahead<=258){if(b(x),x.lookahead<=258&&j===0)return 1;if(x.lookahead===0)break}if(x.match_length=0,x.lookahead>=3&&x.strstart>0&&(F=U[V=x.strstart-1])===U[++V]&&F===U[++V]&&F===U[++V]){W=x.strstart+258;do;while(F===U[++V]&&F===U[++V]&&F===U[++V]&&F===U[++V]&&F===U[++V]&&F===U[++V]&&F===U[++V]&&F===U[++V]&&V<W);x.match_length=258-(W-V),x.match_length>x.lookahead&&(x.match_length=x.lookahead)}if(x.match_length>=3?(H=s._tr_tally(x,1,x.match_length-3),x.lookahead-=x.match_length,x.strstart+=x.match_length,x.match_length=0):(H=s._tr_tally(x,0,x.window[x.strstart]),x.lookahead--,x.strstart++),H&&(f(x,!1),x.strm.avail_out===0))return 1}return x.insert=0,j===4?(f(x,!0),x.strm.avail_out===0?3:4):x.last_lit&&(f(x,!1),x.strm.avail_out===0)?1:2}(M,$):o[M.level].func(M,$);if(O!==3&&O!==4||(M.status=666),O===1||O===3)return A.avail_out===0&&(M.last_flush=-1),0;if(O===2&&($===1?s._tr_align(M):$!==5&&(s._tr_stored_block(M,0,0,!1),$===3&&(h(M.head),M.lookahead===0&&(M.strstart=0,M.block_start=0,M.insert=0))),u(A),A.avail_out===0))return M.last_flush=-1,0}return $!==4?0:M.wrap<=0?1:(M.wrap===2?(c(M,255&A.adler),c(M,A.adler>>8&255),c(M,A.adler>>16&255),c(M,A.adler>>24&255),c(M,255&A.total_in),c(M,A.total_in>>8&255),c(M,A.total_in>>16&255),c(M,A.total_in>>24&255)):(v(M,A.adler>>>16),v(M,65535&A.adler)),u(A),M.wrap>0&&(M.wrap=-M.wrap),M.pending!==0?0:1)},i.deflateEnd=function(A){var $;return A&&A.state?($=A.state.status)!==42&&$!==69&&$!==73&&$!==91&&$!==103&&$!==113&&$!==666?g(A,-2):(A.state=null,$===113?g(A,-3):0):-2},i.deflateSetDictionary=function(A,$){var T,M,S,E,k,O,x,j,H=$.length;if(!A||!A.state||(E=(T=A.state).wrap)===2||E===1&&T.status!==42||T.lookahead)return-2;for(E===1&&(A.adler=l(A.adler,$,H,0)),T.wrap=0,H>=T.w_size&&(E===0&&(h(T.head),T.strstart=0,T.block_start=0,T.insert=0),j=new a.Buf8(T.w_size),a.arraySet(j,$,H-T.w_size,T.w_size,0),$=j,H=T.w_size),k=A.avail_in,O=A.next_in,x=A.input,A.avail_in=H,A.next_in=0,A.input=$,b(T);T.lookahead>=3;){M=T.strstart,S=T.lookahead-2;do T.ins_h=(T.ins_h<<T.hash_shift^T.window[M+3-1])&T.hash_mask,T.prev[M&T.w_mask]=T.head[T.ins_h],T.head[T.ins_h]=M,M++;while(--S);T.strstart=M,T.lookahead=2,b(T)}return T.strstart+=T.lookahead,T.block_start=T.strstart,T.insert=T.lookahead,T.lookahead=0,T.match_length=T.prev_length=2,T.match_available=0,A.next_in=O,A.input=x,A.avail_in=k,T.wrap=E,0},i.deflateInfo="pako deflate (from Nodeca project)"},{"../utils/common":442,"./adler32":444,"./crc32":446,"./messages":452,"./trees":453}],448:[function(e,n,i){n.exports=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}},{}],449:[function(e,n,i){n.exports=function(o,a){var s,l,p,d,g,y,h,u,f,c,v,m,b,w,_,C,R,I,P,N,A,$,T,M,S;s=o.state,l=o.next_in,M=o.input,p=l+(o.avail_in-5),d=o.next_out,S=o.output,g=d-(a-o.avail_out),y=d+(o.avail_out-257),h=s.dmax,u=s.wsize,f=s.whave,c=s.wnext,v=s.window,m=s.hold,b=s.bits,w=s.lencode,_=s.distcode,C=(1<<s.lenbits)-1,R=(1<<s.distbits)-1;e:do{b<15&&(m+=M[l++]<<b,b+=8,m+=M[l++]<<b,b+=8),I=w[m&C];t:for(;;){if(m>>>=P=I>>>24,b-=P,(P=I>>>16&255)==0)S[d++]=65535&I;else{if(!(16&P)){if((64&P)==0){I=w[(65535&I)+(m&(1<<P)-1)];continue t}if(32&P){s.mode=12;break e}o.msg="invalid literal/length code",s.mode=30;break e}N=65535&I,(P&=15)&&(b<P&&(m+=M[l++]<<b,b+=8),N+=m&(1<<P)-1,m>>>=P,b-=P),b<15&&(m+=M[l++]<<b,b+=8,m+=M[l++]<<b,b+=8),I=_[m&R];r:for(;;){if(m>>>=P=I>>>24,b-=P,!(16&(P=I>>>16&255))){if((64&P)==0){I=_[(65535&I)+(m&(1<<P)-1)];continue r}o.msg="invalid distance code",s.mode=30;break e}if(A=65535&I,b<(P&=15)&&(m+=M[l++]<<b,(b+=8)<P&&(m+=M[l++]<<b,b+=8)),(A+=m&(1<<P)-1)>h){o.msg="invalid distance too far back",s.mode=30;break e}if(m>>>=P,b-=P,A>(P=d-g)){if((P=A-P)>f&&s.sane){o.msg="invalid distance too far back",s.mode=30;break e}if($=0,T=v,c===0){if($+=u-P,P<N){N-=P;do S[d++]=v[$++];while(--P);$=d-A,T=S}}else if(c<P){if($+=u+c-P,(P-=c)<N){N-=P;do S[d++]=v[$++];while(--P);if($=0,c<N){N-=P=c;do S[d++]=v[$++];while(--P);$=d-A,T=S}}}else if($+=c-P,P<N){N-=P;do S[d++]=v[$++];while(--P);$=d-A,T=S}for(;N>2;)S[d++]=T[$++],S[d++]=T[$++],S[d++]=T[$++],N-=3;N&&(S[d++]=T[$++],N>1&&(S[d++]=T[$++]))}else{$=d-A;do S[d++]=S[$++],S[d++]=S[$++],S[d++]=S[$++],N-=3;while(N>2);N&&(S[d++]=S[$++],N>1&&(S[d++]=S[$++]))}break}}break}}while(l<p&&d<y);l-=N=b>>3,m&=(1<<(b-=N<<3))-1,o.next_in=l,o.next_out=d,o.avail_in=l<p?p-l+5:5-(l-p),o.avail_out=d<y?y-d+257:257-(d-y),s.hold=m,s.bits=b}},{}],450:[function(e,n,i){var o=e("../utils/common"),a=e("./adler32"),s=e("./crc32"),l=e("./inffast"),p=e("./inftrees");function d(_){return(_>>>24&255)+(_>>>8&65280)+((65280&_)<<8)+((255&_)<<24)}function g(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new o.Buf16(320),this.work=new o.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function y(_){var C;return _&&_.state?(C=_.state,_.total_in=_.total_out=C.total=0,_.msg="",C.wrap&&(_.adler=1&C.wrap),C.mode=1,C.last=0,C.havedict=0,C.dmax=32768,C.head=null,C.hold=0,C.bits=0,C.lencode=C.lendyn=new o.Buf32(852),C.distcode=C.distdyn=new o.Buf32(592),C.sane=1,C.back=-1,0):-2}function h(_){var C;return _&&_.state?((C=_.state).wsize=0,C.whave=0,C.wnext=0,y(_)):-2}function u(_,C){var R,I;return _&&_.state?(I=_.state,C<0?(R=0,C=-C):(R=1+(C>>4),C<48&&(C&=15)),C&&(C<8||C>15)?-2:(I.window!==null&&I.wbits!==C&&(I.window=null),I.wrap=R,I.wbits=C,h(_))):-2}function f(_,C){var R,I;return _?(I=new g,_.state=I,I.window=null,(R=u(_,C))!==0&&(_.state=null),R):-2}var c,v,m=!0;function b(_){if(m){var C;for(c=new o.Buf32(512),v=new o.Buf32(32),C=0;C<144;)_.lens[C++]=8;for(;C<256;)_.lens[C++]=9;for(;C<280;)_.lens[C++]=7;for(;C<288;)_.lens[C++]=8;for(p(1,_.lens,0,288,c,0,_.work,{bits:9}),C=0;C<32;)_.lens[C++]=5;p(2,_.lens,0,32,v,0,_.work,{bits:5}),m=!1}_.lencode=c,_.lenbits=9,_.distcode=v,_.distbits=5}function w(_,C,R,I){var P,N=_.state;return N.window===null&&(N.wsize=1<<N.wbits,N.wnext=0,N.whave=0,N.window=new o.Buf8(N.wsize)),I>=N.wsize?(o.arraySet(N.window,C,R-N.wsize,N.wsize,0),N.wnext=0,N.whave=N.wsize):((P=N.wsize-N.wnext)>I&&(P=I),o.arraySet(N.window,C,R-I,P,N.wnext),(I-=P)?(o.arraySet(N.window,C,R-I,I,0),N.wnext=I,N.whave=N.wsize):(N.wnext+=P,N.wnext===N.wsize&&(N.wnext=0),N.whave<N.wsize&&(N.whave+=P))),0}i.inflateReset=h,i.inflateReset2=u,i.inflateResetKeep=y,i.inflateInit=function(_){return f(_,15)},i.inflateInit2=f,i.inflate=function(_,C){var R,I,P,N,A,$,T,M,S,E,k,O,x,j,H,F,V,W,U,Y,K,D,L,B,z=0,q=new o.Buf8(4),X=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!_||!_.state||!_.output||!_.input&&_.avail_in!==0)return-2;(R=_.state).mode===12&&(R.mode=13),A=_.next_out,P=_.output,T=_.avail_out,N=_.next_in,I=_.input,$=_.avail_in,M=R.hold,S=R.bits,E=$,k=T,D=0;e:for(;;)switch(R.mode){case 1:if(R.wrap===0){R.mode=13;break}for(;S<16;){if($===0)break e;$--,M+=I[N++]<<S,S+=8}if(2&R.wrap&&M===35615){R.check=0,q[0]=255&M,q[1]=M>>>8&255,R.check=s(R.check,q,2,0),M=0,S=0,R.mode=2;break}if(R.flags=0,R.head&&(R.head.done=!1),!(1&R.wrap)||(((255&M)<<8)+(M>>8))%31){_.msg="incorrect header check",R.mode=30;break}if((15&M)!=8){_.msg="unknown compression method",R.mode=30;break}if(S-=4,K=8+(15&(M>>>=4)),R.wbits===0)R.wbits=K;else if(K>R.wbits){_.msg="invalid window size",R.mode=30;break}R.dmax=1<<K,_.adler=R.check=1,R.mode=512&M?10:12,M=0,S=0;break;case 2:for(;S<16;){if($===0)break e;$--,M+=I[N++]<<S,S+=8}if(R.flags=M,(255&R.flags)!=8){_.msg="unknown compression method",R.mode=30;break}if(57344&R.flags){_.msg="unknown header flags set",R.mode=30;break}R.head&&(R.head.text=M>>8&1),512&R.flags&&(q[0]=255&M,q[1]=M>>>8&255,R.check=s(R.check,q,2,0)),M=0,S=0,R.mode=3;case 3:for(;S<32;){if($===0)break e;$--,M+=I[N++]<<S,S+=8}R.head&&(R.head.time=M),512&R.flags&&(q[0]=255&M,q[1]=M>>>8&255,q[2]=M>>>16&255,q[3]=M>>>24&255,R.check=s(R.check,q,4,0)),M=0,S=0,R.mode=4;case 4:for(;S<16;){if($===0)break e;$--,M+=I[N++]<<S,S+=8}R.head&&(R.head.xflags=255&M,R.head.os=M>>8),512&R.flags&&(q[0]=255&M,q[1]=M>>>8&255,R.check=s(R.check,q,2,0)),M=0,S=0,R.mode=5;case 5:if(1024&R.flags){for(;S<16;){if($===0)break e;$--,M+=I[N++]<<S,S+=8}R.length=M,R.head&&(R.head.extra_len=M),512&R.flags&&(q[0]=255&M,q[1]=M>>>8&255,R.check=s(R.check,q,2,0)),M=0,S=0}else R.head&&(R.head.extra=null);R.mode=6;case 6:if(1024&R.flags&&((O=R.length)>$&&(O=$),O&&(R.head&&(K=R.head.extra_len-R.length,R.head.extra||(R.head.extra=new Array(R.head.extra_len)),o.arraySet(R.head.extra,I,N,O,K)),512&R.flags&&(R.check=s(R.check,I,O,N)),$-=O,N+=O,R.length-=O),R.length))break e;R.length=0,R.mode=7;case 7:if(2048&R.flags){if($===0)break e;O=0;do K=I[N+O++],R.head&&K&&R.length<65536&&(R.head.name+=String.fromCharCode(K));while(K&&O<$);if(512&R.flags&&(R.check=s(R.check,I,O,N)),$-=O,N+=O,K)break e}else R.head&&(R.head.name=null);R.length=0,R.mode=8;case 8:if(4096&R.flags){if($===0)break e;O=0;do K=I[N+O++],R.head&&K&&R.length<65536&&(R.head.comment+=String.fromCharCode(K));while(K&&O<$);if(512&R.flags&&(R.check=s(R.check,I,O,N)),$-=O,N+=O,K)break e}else R.head&&(R.head.comment=null);R.mode=9;case 9:if(512&R.flags){for(;S<16;){if($===0)break e;$--,M+=I[N++]<<S,S+=8}if(M!==(65535&R.check)){_.msg="header crc mismatch",R.mode=30;break}M=0,S=0}R.head&&(R.head.hcrc=R.flags>>9&1,R.head.done=!0),_.adler=R.check=0,R.mode=12;break;case 10:for(;S<32;){if($===0)break e;$--,M+=I[N++]<<S,S+=8}_.adler=R.check=d(M),M=0,S=0,R.mode=11;case 11:if(R.havedict===0)return _.next_out=A,_.avail_out=T,_.next_in=N,_.avail_in=$,R.hold=M,R.bits=S,2;_.adler=R.check=1,R.mode=12;case 12:if(C===5||C===6)break e;case 13:if(R.last){M>>>=7&S,S-=7&S,R.mode=27;break}for(;S<3;){if($===0)break e;$--,M+=I[N++]<<S,S+=8}switch(R.last=1&M,S-=1,3&(M>>>=1)){case 0:R.mode=14;break;case 1:if(b(R),R.mode=20,C===6){M>>>=2,S-=2;break e}break;case 2:R.mode=17;break;case 3:_.msg="invalid block type",R.mode=30}M>>>=2,S-=2;break;case 14:for(M>>>=7&S,S-=7&S;S<32;){if($===0)break e;$--,M+=I[N++]<<S,S+=8}if((65535&M)!=(M>>>16^65535)){_.msg="invalid stored block lengths",R.mode=30;break}if(R.length=65535&M,M=0,S=0,R.mode=15,C===6)break e;case 15:R.mode=16;case 16:if(O=R.length){if(O>$&&(O=$),O>T&&(O=T),O===0)break e;o.arraySet(P,I,N,O,A),$-=O,N+=O,T-=O,A+=O,R.length-=O;break}R.mode=12;break;case 17:for(;S<14;){if($===0)break e;$--,M+=I[N++]<<S,S+=8}if(R.nlen=257+(31&M),M>>>=5,S-=5,R.ndist=1+(31&M),M>>>=5,S-=5,R.ncode=4+(15&M),M>>>=4,S-=4,R.nlen>286||R.ndist>30){_.msg="too many length or distance symbols",R.mode=30;break}R.have=0,R.mode=18;case 18:for(;R.have<R.ncode;){for(;S<3;){if($===0)break e;$--,M+=I[N++]<<S,S+=8}R.lens[X[R.have++]]=7&M,M>>>=3,S-=3}for(;R.have<19;)R.lens[X[R.have++]]=0;if(R.lencode=R.lendyn,R.lenbits=7,L={bits:R.lenbits},D=p(0,R.lens,0,19,R.lencode,0,R.work,L),R.lenbits=L.bits,D){_.msg="invalid code lengths set",R.mode=30;break}R.have=0,R.mode=19;case 19:for(;R.have<R.nlen+R.ndist;){for(;F=(z=R.lencode[M&(1<<R.lenbits)-1])>>>16&255,V=65535&z,!((H=z>>>24)<=S);){if($===0)break e;$--,M+=I[N++]<<S,S+=8}if(V<16)M>>>=H,S-=H,R.lens[R.have++]=V;else{if(V===16){for(B=H+2;S<B;){if($===0)break e;$--,M+=I[N++]<<S,S+=8}if(M>>>=H,S-=H,R.have===0){_.msg="invalid bit length repeat",R.mode=30;break}K=R.lens[R.have-1],O=3+(3&M),M>>>=2,S-=2}else if(V===17){for(B=H+3;S<B;){if($===0)break e;$--,M+=I[N++]<<S,S+=8}S-=H,K=0,O=3+(7&(M>>>=H)),M>>>=3,S-=3}else{for(B=H+7;S<B;){if($===0)break e;$--,M+=I[N++]<<S,S+=8}S-=H,K=0,O=11+(127&(M>>>=H)),M>>>=7,S-=7}if(R.have+O>R.nlen+R.ndist){_.msg="invalid bit length repeat",R.mode=30;break}for(;O--;)R.lens[R.have++]=K}}if(R.mode===30)break;if(R.lens[256]===0){_.msg="invalid code -- missing end-of-block",R.mode=30;break}if(R.lenbits=9,L={bits:R.lenbits},D=p(1,R.lens,0,R.nlen,R.lencode,0,R.work,L),R.lenbits=L.bits,D){_.msg="invalid literal/lengths set",R.mode=30;break}if(R.distbits=6,R.distcode=R.distdyn,L={bits:R.distbits},D=p(2,R.lens,R.nlen,R.ndist,R.distcode,0,R.work,L),R.distbits=L.bits,D){_.msg="invalid distances set",R.mode=30;break}if(R.mode=20,C===6)break e;case 20:R.mode=21;case 21:if($>=6&&T>=258){_.next_out=A,_.avail_out=T,_.next_in=N,_.avail_in=$,R.hold=M,R.bits=S,l(_,k),A=_.next_out,P=_.output,T=_.avail_out,N=_.next_in,I=_.input,$=_.avail_in,M=R.hold,S=R.bits,R.mode===12&&(R.back=-1);break}for(R.back=0;F=(z=R.lencode[M&(1<<R.lenbits)-1])>>>16&255,V=65535&z,!((H=z>>>24)<=S);){if($===0)break e;$--,M+=I[N++]<<S,S+=8}if(F&&(240&F)==0){for(W=H,U=F,Y=V;F=(z=R.lencode[Y+((M&(1<<W+U)-1)>>W)])>>>16&255,V=65535&z,!(W+(H=z>>>24)<=S);){if($===0)break e;$--,M+=I[N++]<<S,S+=8}M>>>=W,S-=W,R.back+=W}if(M>>>=H,S-=H,R.back+=H,R.length=V,F===0){R.mode=26;break}if(32&F){R.back=-1,R.mode=12;break}if(64&F){_.msg="invalid literal/length code",R.mode=30;break}R.extra=15&F,R.mode=22;case 22:if(R.extra){for(B=R.extra;S<B;){if($===0)break e;$--,M+=I[N++]<<S,S+=8}R.length+=M&(1<<R.extra)-1,M>>>=R.extra,S-=R.extra,R.back+=R.extra}R.was=R.length,R.mode=23;case 23:for(;F=(z=R.distcode[M&(1<<R.distbits)-1])>>>16&255,V=65535&z,!((H=z>>>24)<=S);){if($===0)break e;$--,M+=I[N++]<<S,S+=8}if((240&F)==0){for(W=H,U=F,Y=V;F=(z=R.distcode[Y+((M&(1<<W+U)-1)>>W)])>>>16&255,V=65535&z,!(W+(H=z>>>24)<=S);){if($===0)break e;$--,M+=I[N++]<<S,S+=8}M>>>=W,S-=W,R.back+=W}if(M>>>=H,S-=H,R.back+=H,64&F){_.msg="invalid distance code",R.mode=30;break}R.offset=V,R.extra=15&F,R.mode=24;case 24:if(R.extra){for(B=R.extra;S<B;){if($===0)break e;$--,M+=I[N++]<<S,S+=8}R.offset+=M&(1<<R.extra)-1,M>>>=R.extra,S-=R.extra,R.back+=R.extra}if(R.offset>R.dmax){_.msg="invalid distance too far back",R.mode=30;break}R.mode=25;case 25:if(T===0)break e;if(O=k-T,R.offset>O){if((O=R.offset-O)>R.whave&&R.sane){_.msg="invalid distance too far back",R.mode=30;break}O>R.wnext?(O-=R.wnext,x=R.wsize-O):x=R.wnext-O,O>R.length&&(O=R.length),j=R.window}else j=P,x=A-R.offset,O=R.length;O>T&&(O=T),T-=O,R.length-=O;do P[A++]=j[x++];while(--O);R.length===0&&(R.mode=21);break;case 26:if(T===0)break e;P[A++]=R.length,T--,R.mode=21;break;case 27:if(R.wrap){for(;S<32;){if($===0)break e;$--,M|=I[N++]<<S,S+=8}if(k-=T,_.total_out+=k,R.total+=k,k&&(_.adler=R.check=R.flags?s(R.check,P,k,A-k):a(R.check,P,k,A-k)),k=T,(R.flags?M:d(M))!==R.check){_.msg="incorrect data check",R.mode=30;break}M=0,S=0}R.mode=28;case 28:if(R.wrap&&R.flags){for(;S<32;){if($===0)break e;$--,M+=I[N++]<<S,S+=8}if(M!==(4294967295&R.total)){_.msg="incorrect length check",R.mode=30;break}M=0,S=0}R.mode=29;case 29:D=1;break e;case 30:D=-3;break e;case 31:return-4;case 32:default:return-2}return _.next_out=A,_.avail_out=T,_.next_in=N,_.avail_in=$,R.hold=M,R.bits=S,(R.wsize||k!==_.avail_out&&R.mode<30&&(R.mode<27||C!==4))&&w(_,_.output,_.next_out,k-_.avail_out)?(R.mode=31,-4):(E-=_.avail_in,k-=_.avail_out,_.total_in+=E,_.total_out+=k,R.total+=k,R.wrap&&k&&(_.adler=R.check=R.flags?s(R.check,P,k,_.next_out-k):a(R.check,P,k,_.next_out-k)),_.data_type=R.bits+(R.last?64:0)+(R.mode===12?128:0)+(R.mode===20||R.mode===15?256:0),(E===0&&k===0||C===4)&&D===0&&(D=-5),D)},i.inflateEnd=function(_){if(!_||!_.state)return-2;var C=_.state;return C.window&&(C.window=null),_.state=null,0},i.inflateGetHeader=function(_,C){var R;return _&&_.state?(2&(R=_.state).wrap)==0?-2:(R.head=C,C.done=!1,0):-2},i.inflateSetDictionary=function(_,C){var R,I=C.length;return _&&_.state?(R=_.state).wrap!==0&&R.mode!==11?-2:R.mode===11&&a(1,C,I,0)!==R.check?-3:w(_,C,I,I)?(R.mode=31,-4):(R.havedict=1,0):-2},i.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":442,"./adler32":444,"./crc32":446,"./inffast":449,"./inftrees":451}],451:[function(e,n,i){var o=e("../utils/common"),a=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],s=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],l=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],p=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];n.exports=function(d,g,y,h,u,f,c,v){var m,b,w,_,C,R,I,P,N,A=v.bits,$=0,T=0,M=0,S=0,E=0,k=0,O=0,x=0,j=0,H=0,F=null,V=0,W=new o.Buf16(16),U=new o.Buf16(16),Y=null,K=0;for($=0;$<=15;$++)W[$]=0;for(T=0;T<h;T++)W[g[y+T]]++;for(E=A,S=15;S>=1&&W[S]===0;S--);if(E>S&&(E=S),S===0)return u[f++]=20971520,u[f++]=20971520,v.bits=1,0;for(M=1;M<S&&W[M]===0;M++);for(E<M&&(E=M),x=1,$=1;$<=15;$++)if(x<<=1,(x-=W[$])<0)return-1;if(x>0&&(d===0||S!==1))return-1;for(U[1]=0,$=1;$<15;$++)U[$+1]=U[$]+W[$];for(T=0;T<h;T++)g[y+T]!==0&&(c[U[g[y+T]]++]=T);if(d===0?(F=Y=c,R=19):d===1?(F=a,V-=257,Y=s,K-=257,R=256):(F=l,Y=p,R=-1),H=0,T=0,$=M,C=f,k=E,O=0,w=-1,_=(j=1<<E)-1,d===1&&j>852||d===2&&j>592)return 1;for(;;){I=$-O,c[T]<R?(P=0,N=c[T]):c[T]>R?(P=Y[K+c[T]],N=F[V+c[T]]):(P=96,N=0),m=1<<$-O,M=b=1<<k;do u[C+(H>>O)+(b-=m)]=I<<24|P<<16|N|0;while(b!==0);for(m=1<<$-1;H&m;)m>>=1;if(m!==0?(H&=m-1,H+=m):H=0,T++,--W[$]==0){if($===S)break;$=g[y+c[T]]}if($>E&&(H&_)!==w){for(O===0&&(O=E),C+=M,x=1<<(k=$-O);k+O<S&&!((x-=W[k+O])<=0);)k++,x<<=1;if(j+=1<<k,d===1&&j>852||d===2&&j>592)return 1;u[w=H&_]=E<<24|k<<16|C-f|0}}return H!==0&&(u[C+H]=$-O<<24|64<<16|0),v.bits=E,0}},{"../utils/common":442}],452:[function(e,n,i){n.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],453:[function(e,n,i){var o=e("../utils/common");function a(F){for(var V=F.length;--V>=0;)F[V]=0}var s=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],l=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],p=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],d=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],g=new Array(576);a(g);var y=new Array(60);a(y);var h=new Array(512);a(h);var u=new Array(256);a(u);var f=new Array(29);a(f);var c,v,m,b=new Array(30);function w(F,V,W,U,Y){this.static_tree=F,this.extra_bits=V,this.extra_base=W,this.elems=U,this.max_length=Y,this.has_stree=F&&F.length}function _(F,V){this.dyn_tree=F,this.max_code=0,this.stat_desc=V}function C(F){return F<256?h[F]:h[256+(F>>>7)]}function R(F,V){F.pending_buf[F.pending++]=255&V,F.pending_buf[F.pending++]=V>>>8&255}function I(F,V,W){F.bi_valid>16-W?(F.bi_buf|=V<<F.bi_valid&65535,R(F,F.bi_buf),F.bi_buf=V>>16-F.bi_valid,F.bi_valid+=W-16):(F.bi_buf|=V<<F.bi_valid&65535,F.bi_valid+=W)}function P(F,V,W){I(F,W[2*V],W[2*V+1])}function N(F,V){var W=0;do W|=1&F,F>>>=1,W<<=1;while(--V>0);return W>>>1}function A(F,V,W){var U,Y,K=new Array(16),D=0;for(U=1;U<=15;U++)K[U]=D=D+W[U-1]<<1;for(Y=0;Y<=V;Y++){var L=F[2*Y+1];L!==0&&(F[2*Y]=N(K[L]++,L))}}function $(F){var V;for(V=0;V<286;V++)F.dyn_ltree[2*V]=0;for(V=0;V<30;V++)F.dyn_dtree[2*V]=0;for(V=0;V<19;V++)F.bl_tree[2*V]=0;F.dyn_ltree[512]=1,F.opt_len=F.static_len=0,F.last_lit=F.matches=0}function T(F){F.bi_valid>8?R(F,F.bi_buf):F.bi_valid>0&&(F.pending_buf[F.pending++]=F.bi_buf),F.bi_buf=0,F.bi_valid=0}function M(F,V,W,U){var Y=2*V,K=2*W;return F[Y]<F[K]||F[Y]===F[K]&&U[V]<=U[W]}function S(F,V,W){for(var U=F.heap[W],Y=W<<1;Y<=F.heap_len&&(Y<F.heap_len&&M(V,F.heap[Y+1],F.heap[Y],F.depth)&&Y++,!M(V,U,F.heap[Y],F.depth));)F.heap[W]=F.heap[Y],W=Y,Y<<=1;F.heap[W]=U}function E(F,V,W){var U,Y,K,D,L=0;if(F.last_lit!==0)do U=F.pending_buf[F.d_buf+2*L]<<8|F.pending_buf[F.d_buf+2*L+1],Y=F.pending_buf[F.l_buf+L],L++,U===0?P(F,Y,V):(P(F,(K=u[Y])+256+1,V),(D=s[K])!==0&&I(F,Y-=f[K],D),P(F,K=C(--U),W),(D=l[K])!==0&&I(F,U-=b[K],D));while(L<F.last_lit);P(F,256,V)}function k(F,V){var W,U,Y,K=V.dyn_tree,D=V.stat_desc.static_tree,L=V.stat_desc.has_stree,B=V.stat_desc.elems,z=-1;for(F.heap_len=0,F.heap_max=573,W=0;W<B;W++)K[2*W]!==0?(F.heap[++F.heap_len]=z=W,F.depth[W]=0):K[2*W+1]=0;for(;F.heap_len<2;)K[2*(Y=F.heap[++F.heap_len]=z<2?++z:0)]=1,F.depth[Y]=0,F.opt_len--,L&&(F.static_len-=D[2*Y+1]);for(V.max_code=z,W=F.heap_len>>1;W>=1;W--)S(F,K,W);Y=B;do W=F.heap[1],F.heap[1]=F.heap[F.heap_len--],S(F,K,1),U=F.heap[1],F.heap[--F.heap_max]=W,F.heap[--F.heap_max]=U,K[2*Y]=K[2*W]+K[2*U],F.depth[Y]=(F.depth[W]>=F.depth[U]?F.depth[W]:F.depth[U])+1,K[2*W+1]=K[2*U+1]=Y,F.heap[1]=Y++,S(F,K,1);while(F.heap_len>=2);F.heap[--F.heap_max]=F.heap[1],function(q,X){var ee,ye,de,ge,we,be,J=X.dyn_tree,te=X.max_code,ie=X.stat_desc.static_tree,fe=X.stat_desc.has_stree,se=X.stat_desc.extra_bits,oe=X.stat_desc.extra_base,G=X.stat_desc.max_length,Z=0;for(ge=0;ge<=15;ge++)q.bl_count[ge]=0;for(J[2*q.heap[q.heap_max]+1]=0,ee=q.heap_max+1;ee<573;ee++)(ge=J[2*J[2*(ye=q.heap[ee])+1]+1]+1)>G&&(ge=G,Z++),J[2*ye+1]=ge,ye>te||(q.bl_count[ge]++,we=0,ye>=oe&&(we=se[ye-oe]),be=J[2*ye],q.opt_len+=be*(ge+we),fe&&(q.static_len+=be*(ie[2*ye+1]+we)));if(Z!==0){do{for(ge=G-1;q.bl_count[ge]===0;)ge--;q.bl_count[ge]--,q.bl_count[ge+1]+=2,q.bl_count[G]--,Z-=2}while(Z>0);for(ge=G;ge!==0;ge--)for(ye=q.bl_count[ge];ye!==0;)(de=q.heap[--ee])>te||(J[2*de+1]!==ge&&(q.opt_len+=(ge-J[2*de+1])*J[2*de],J[2*de+1]=ge),ye--)}}(F,V),A(K,z,F.bl_count)}function O(F,V,W){var U,Y,K=-1,D=V[1],L=0,B=7,z=4;for(D===0&&(B=138,z=3),V[2*(W+1)+1]=65535,U=0;U<=W;U++)Y=D,D=V[2*(U+1)+1],++L<B&&Y===D||(L<z?F.bl_tree[2*Y]+=L:Y!==0?(Y!==K&&F.bl_tree[2*Y]++,F.bl_tree[32]++):L<=10?F.bl_tree[34]++:F.bl_tree[36]++,L=0,K=Y,D===0?(B=138,z=3):Y===D?(B=6,z=3):(B=7,z=4))}function x(F,V,W){var U,Y,K=-1,D=V[1],L=0,B=7,z=4;for(D===0&&(B=138,z=3),U=0;U<=W;U++)if(Y=D,D=V[2*(U+1)+1],!(++L<B&&Y===D)){if(L<z)do P(F,Y,F.bl_tree);while(--L!=0);else Y!==0?(Y!==K&&(P(F,Y,F.bl_tree),L--),P(F,16,F.bl_tree),I(F,L-3,2)):L<=10?(P(F,17,F.bl_tree),I(F,L-3,3)):(P(F,18,F.bl_tree),I(F,L-11,7));L=0,K=Y,D===0?(B=138,z=3):Y===D?(B=6,z=3):(B=7,z=4)}}a(b);var j=!1;function H(F,V,W,U){I(F,0+(U?1:0),3),function(Y,K,D,L){T(Y),L&&(R(Y,D),R(Y,~D)),o.arraySet(Y.pending_buf,Y.window,K,D,Y.pending),Y.pending+=D}(F,V,W,!0)}i._tr_init=function(F){j||(function(){var V,W,U,Y,K,D=new Array(16);for(U=0,Y=0;Y<28;Y++)for(f[Y]=U,V=0;V<1<<s[Y];V++)u[U++]=Y;for(u[U-1]=Y,K=0,Y=0;Y<16;Y++)for(b[Y]=K,V=0;V<1<<l[Y];V++)h[K++]=Y;for(K>>=7;Y<30;Y++)for(b[Y]=K<<7,V=0;V<1<<l[Y]-7;V++)h[256+K++]=Y;for(W=0;W<=15;W++)D[W]=0;for(V=0;V<=143;)g[2*V+1]=8,V++,D[8]++;for(;V<=255;)g[2*V+1]=9,V++,D[9]++;for(;V<=279;)g[2*V+1]=7,V++,D[7]++;for(;V<=287;)g[2*V+1]=8,V++,D[8]++;for(A(g,287,D),V=0;V<30;V++)y[2*V+1]=5,y[2*V]=N(V,5);c=new w(g,s,257,286,15),v=new w(y,l,0,30,15),m=new w(new Array(0),p,0,19,7)}(),j=!0),F.l_desc=new _(F.dyn_ltree,c),F.d_desc=new _(F.dyn_dtree,v),F.bl_desc=new _(F.bl_tree,m),F.bi_buf=0,F.bi_valid=0,$(F)},i._tr_stored_block=H,i._tr_flush_block=function(F,V,W,U){var Y,K,D=0;F.level>0?(F.strm.data_type===2&&(F.strm.data_type=function(L){var B,z=4093624447;for(B=0;B<=31;B++,z>>>=1)if(1&z&&L.dyn_ltree[2*B]!==0)return 0;if(L.dyn_ltree[18]!==0||L.dyn_ltree[20]!==0||L.dyn_ltree[26]!==0)return 1;for(B=32;B<256;B++)if(L.dyn_ltree[2*B]!==0)return 1;return 0}(F)),k(F,F.l_desc),k(F,F.d_desc),D=function(L){var B;for(O(L,L.dyn_ltree,L.l_desc.max_code),O(L,L.dyn_dtree,L.d_desc.max_code),k(L,L.bl_desc),B=18;B>=3&&L.bl_tree[2*d[B]+1]===0;B--);return L.opt_len+=3*(B+1)+5+5+4,B}(F),Y=F.opt_len+3+7>>>3,(K=F.static_len+3+7>>>3)<=Y&&(Y=K)):Y=K=W+5,W+4<=Y&&V!==-1?H(F,V,W,U):F.strategy===4||K===Y?(I(F,2+(U?1:0),3),E(F,g,y)):(I(F,4+(U?1:0),3),function(L,B,z,q){var X;for(I(L,B-257,5),I(L,z-1,5),I(L,q-4,4),X=0;X<q;X++)I(L,L.bl_tree[2*d[X]+1],3);x(L,L.dyn_ltree,B-1),x(L,L.dyn_dtree,z-1)}(F,F.l_desc.max_code+1,F.d_desc.max_code+1,D+1),E(F,F.dyn_ltree,F.dyn_dtree)),$(F),U&&T(F)},i._tr_tally=function(F,V,W){return F.pending_buf[F.d_buf+2*F.last_lit]=V>>>8&255,F.pending_buf[F.d_buf+2*F.last_lit+1]=255&V,F.pending_buf[F.l_buf+F.last_lit]=255&W,F.last_lit++,V===0?F.dyn_ltree[2*W]++:(F.matches++,V--,F.dyn_ltree[2*(u[W]+256+1)]++,F.dyn_dtree[2*C(V)]++),F.last_lit===F.lit_bufsize-1},i._tr_align=function(F){I(F,2,3),P(F,256,g),function(V){V.bi_valid===16?(R(V,V.bi_buf),V.bi_buf=0,V.bi_valid=0):V.bi_valid>=8&&(V.pending_buf[V.pending++]=255&V.bi_buf,V.bi_buf>>=8,V.bi_valid-=8)}(F)}},{"../utils/common":442}],454:[function(e,n,i){n.exports=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}},{}],455:[function(e,n,i){n.exports={"2.16.840.1.101.3.4.1.1":"aes-128-ecb","2.16.840.1.101.3.4.1.2":"aes-128-cbc","2.16.840.1.101.3.4.1.3":"aes-128-ofb","2.16.840.1.101.3.4.1.4":"aes-128-cfb","2.16.840.1.101.3.4.1.21":"aes-192-ecb","2.16.840.1.101.3.4.1.22":"aes-192-cbc","2.16.840.1.101.3.4.1.23":"aes-192-ofb","2.16.840.1.101.3.4.1.24":"aes-192-cfb","2.16.840.1.101.3.4.1.41":"aes-256-ecb","2.16.840.1.101.3.4.1.42":"aes-256-cbc","2.16.840.1.101.3.4.1.43":"aes-256-ofb","2.16.840.1.101.3.4.1.44":"aes-256-cfb"}},{}],456:[function(e,n,i){var o=e("asn1.js");i.certificate=e("./certificate");var a=o.define("RSAPrivateKey",function(){this.seq().obj(this.key("version").int(),this.key("modulus").int(),this.key("publicExponent").int(),this.key("privateExponent").int(),this.key("prime1").int(),this.key("prime2").int(),this.key("exponent1").int(),this.key("exponent2").int(),this.key("coefficient").int())});i.RSAPrivateKey=a;var s=o.define("RSAPublicKey",function(){this.seq().obj(this.key("modulus").int(),this.key("publicExponent").int())});i.RSAPublicKey=s;var l=o.define("SubjectPublicKeyInfo",function(){this.seq().obj(this.key("algorithm").use(p),this.key("subjectPublicKey").bitstr())});i.PublicKey=l;var p=o.define("AlgorithmIdentifier",function(){this.seq().obj(this.key("algorithm").objid(),this.key("none").null_().optional(),this.key("curve").objid().optional(),this.key("params").seq().obj(this.key("p").int(),this.key("q").int(),this.key("g").int()).optional())}),d=o.define("PrivateKeyInfo",function(){this.seq().obj(this.key("version").int(),this.key("algorithm").use(p),this.key("subjectPrivateKey").octstr())});i.PrivateKey=d;var g=o.define("EncryptedPrivateKeyInfo",function(){this.seq().obj(this.key("algorithm").seq().obj(this.key("id").objid(),this.key("decrypt").seq().obj(this.key("kde").seq().obj(this.key("id").objid(),this.key("kdeparams").seq().obj(this.key("salt").octstr(),this.key("iters").int())),this.key("cipher").seq().obj(this.key("algo").objid(),this.key("iv").octstr()))),this.key("subjectPrivateKey").octstr())});i.EncryptedPrivateKey=g;var y=o.define("DSAPrivateKey",function(){this.seq().obj(this.key("version").int(),this.key("p").int(),this.key("q").int(),this.key("g").int(),this.key("pub_key").int(),this.key("priv_key").int())});i.DSAPrivateKey=y,i.DSAparam=o.define("DSAparam",function(){this.int()});var h=o.define("ECPrivateKey",function(){this.seq().obj(this.key("version").int(),this.key("privateKey").octstr(),this.key("parameters").optional().explicit(0).use(u),this.key("publicKey").optional().explicit(1).bitstr())});i.ECPrivateKey=h;var u=o.define("ECParameters",function(){this.choice({namedCurve:this.objid()})});i.signature=o.define("signature",function(){this.seq().obj(this.key("r").int(),this.key("s").int())})},{"./certificate":457,"asn1.js":167}],457:[function(e,n,i){var o=e("asn1.js"),a=o.define("Time",function(){this.choice({utcTime:this.utctime(),generalTime:this.gentime()})}),s=o.define("AttributeTypeValue",function(){this.seq().obj(this.key("type").objid(),this.key("value").any())}),l=o.define("AlgorithmIdentifier",function(){this.seq().obj(this.key("algorithm").objid(),this.key("parameters").optional(),this.key("curve").objid().optional())}),p=o.define("SubjectPublicKeyInfo",function(){this.seq().obj(this.key("algorithm").use(l),this.key("subjectPublicKey").bitstr())}),d=o.define("RelativeDistinguishedName",function(){this.setof(s)}),g=o.define("RDNSequence",function(){this.seqof(d)}),y=o.define("Name",function(){this.choice({rdnSequence:this.use(g)})}),h=o.define("Validity",function(){this.seq().obj(this.key("notBefore").use(a),this.key("notAfter").use(a))}),u=o.define("Extension",function(){this.seq().obj(this.key("extnID").objid(),this.key("critical").bool().def(!1),this.key("extnValue").octstr())}),f=o.define("TBSCertificate",function(){this.seq().obj(this.key("version").explicit(0).int().optional(),this.key("serialNumber").int(),this.key("signature").use(l),this.key("issuer").use(y),this.key("validity").use(h),this.key("subject").use(y),this.key("subjectPublicKeyInfo").use(p),this.key("issuerUniqueID").implicit(1).bitstr().optional(),this.key("subjectUniqueID").implicit(2).bitstr().optional(),this.key("extensions").explicit(3).seqof(u).optional())}),c=o.define("X509Certificate",function(){this.seq().obj(this.key("tbsCertificate").use(f),this.key("signatureAlgorithm").use(l),this.key("signatureValue").bitstr())});n.exports=c},{"asn1.js":167}],458:[function(e,n,i){var o=/Proc-Type: 4,ENCRYPTED[\n\r]+DEK-Info: AES-((?:128)|(?:192)|(?:256))-CBC,([0-9A-H]+)[\n\r]+([0-9A-z\n\r+/=]+)[\n\r]+/m,a=/^-----BEGIN ((?:.*? KEY)|CERTIFICATE)-----/m,s=/^-----BEGIN ((?:.*? KEY)|CERTIFICATE)-----([0-9A-z\n\r+/=]+)-----END \1-----$/m,l=e("evp_bytestokey"),p=e("browserify-aes"),d=e("safe-buffer").Buffer;n.exports=function(g,y){var h,u=g.toString(),f=u.match(o);if(f){var c="aes"+f[1],v=d.from(f[2],"hex"),m=d.from(f[3].replace(/[\r\n]/g,""),"base64"),b=l(y,v.slice(0,8),parseInt(f[1],10)).key,w=[],_=p.createDecipheriv(c,b,v);w.push(_.update(m)),w.push(_.final()),h=d.concat(w)}else{var C=u.match(s);h=d.from(C[2].replace(/[\r\n]/g,""),"base64")}return{tag:u.match(a)[1],data:h}}},{"browserify-aes":188,evp_bytestokey:368,"safe-buffer":494}],459:[function(e,n,i){function o(h){return(o=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(u){return typeof u}:function(u){return u&&typeof Symbol=="function"&&u.constructor===Symbol&&u!==Symbol.prototype?"symbol":typeof u})(h)}var a=e("./asn1"),s=e("./aesid.json"),l=e("./fixProc"),p=e("browserify-aes"),d=e("pbkdf2"),g=e("safe-buffer").Buffer;function y(h){var u;o(h)!=="object"||g.isBuffer(h)||(u=h.passphrase,h=h.key),typeof h=="string"&&(h=g.from(h));var f,c,v=l(h,u),m=v.tag,b=v.data;switch(m){case"CERTIFICATE":c=a.certificate.decode(b,"der").tbsCertificate.subjectPublicKeyInfo;case"PUBLIC KEY":switch(c||(c=a.PublicKey.decode(b,"der")),f=c.algorithm.algorithm.join(".")){case"1.2.840.113549.1.1.1":return a.RSAPublicKey.decode(c.subjectPublicKey.data,"der");case"1.2.840.10045.2.1":return c.subjectPrivateKey=c.subjectPublicKey,{type:"ec",data:c};case"1.2.840.10040.4.1":return c.algorithm.params.pub_key=a.DSAparam.decode(c.subjectPublicKey.data,"der"),{type:"dsa",data:c.algorithm.params};default:throw new Error("unknown key id "+f)}case"ENCRYPTED PRIVATE KEY":b=function(w,_){var C=w.algorithm.decrypt.kde.kdeparams.salt,R=parseInt(w.algorithm.decrypt.kde.kdeparams.iters.toString(),10),I=s[w.algorithm.decrypt.cipher.algo.join(".")],P=w.algorithm.decrypt.cipher.iv,N=w.subjectPrivateKey,A=parseInt(I.split("-")[1],10)/8,$=d.pbkdf2Sync(_,C,R,A,"sha1"),T=p.createDecipheriv(I,$,P),M=[];return M.push(T.update(N)),M.push(T.final()),g.concat(M)}(b=a.EncryptedPrivateKey.decode(b,"der"),u);case"PRIVATE KEY":switch(f=(c=a.PrivateKey.decode(b,"der")).algorithm.algorithm.join(".")){case"1.2.840.113549.1.1.1":return a.RSAPrivateKey.decode(c.subjectPrivateKey,"der");case"1.2.840.10045.2.1":return{curve:c.algorithm.curve,privateKey:a.ECPrivateKey.decode(c.subjectPrivateKey,"der").privateKey};case"1.2.840.10040.4.1":return c.algorithm.params.priv_key=a.DSAparam.decode(c.subjectPrivateKey,"der"),{type:"dsa",params:c.algorithm.params};default:throw new Error("unknown key id "+f)}case"RSA PUBLIC KEY":return a.RSAPublicKey.decode(b,"der");case"RSA PRIVATE KEY":return a.RSAPrivateKey.decode(b,"der");case"DSA PRIVATE KEY":return{type:"dsa",params:a.DSAPrivateKey.decode(b,"der")};case"EC PRIVATE KEY":return{curve:(b=a.ECPrivateKey.decode(b,"der")).parameters.value,privateKey:b.privateKey};default:throw new Error("unknown key type "+m)}}n.exports=y,y.signature=a.signature},{"./aesid.json":455,"./asn1":456,"./fixProc":458,"browserify-aes":188,pbkdf2:460,"safe-buffer":494}],460:[function(e,n,i){i.pbkdf2=e("./lib/async"),i.pbkdf2Sync=e("./lib/sync")},{"./lib/async":461,"./lib/sync":464}],461:[function(e,n,i){(function(o,a){var s,l=e("safe-buffer").Buffer,p=e("./precondition"),d=e("./default-encoding"),g=e("./sync"),y=e("./to-buffer"),h=a.crypto&&a.crypto.subtle,u={sha:"SHA-1","sha-1":"SHA-1",sha1:"SHA-1",sha256:"SHA-256","sha-256":"SHA-256",sha384:"SHA-384","sha-384":"SHA-384","sha-512":"SHA-512",sha512:"SHA-512"},f=[];function c(v,m,b,w,_){return h.importKey("raw",v,{name:"PBKDF2"},!1,["deriveBits"]).then(function(C){return h.deriveBits({name:"PBKDF2",salt:m,iterations:b,hash:{name:_}},C,w<<3)}).then(function(C){return l.from(C)})}n.exports=function(v,m,b,w,_,C){typeof _=="function"&&(C=_,_=void 0);var R=u[(_=_||"sha1").toLowerCase()];if(!R||typeof a.Promise!="function")return o.nextTick(function(){var I;try{I=g(v,m,b,w,_)}catch(P){return C(P)}C(null,I)});if(p(b,w),v=y(v,d,"Password"),m=y(m,d,"Salt"),typeof C!="function")throw new Error("No callback provided to pbkdf2");(function(I,P){I.then(function(N){o.nextTick(function(){P(null,N)})},function(N){o.nextTick(function(){P(N)})})})(function(I){if(a.process&&!a.process.browser||!h||!h.importKey||!h.deriveBits)return Promise.resolve(!1);if(f[I]!==void 0)return f[I];var P=c(s=s||l.alloc(8),s,10,128,I).then(function(){return!0}).catch(function(){return!1});return f[I]=P,P}(R).then(function(I){return I?c(v,m,b,w,R):g(v,m,b,w,_)}),C)}}).call(this,e("_process"),typeof At!="undefined"?At:typeof self!="undefined"?self:typeof window!="undefined"?window:{})},{"./default-encoding":462,"./precondition":463,"./sync":464,"./to-buffer":465,_process:467,"safe-buffer":494}],462:[function(e,n,i){(function(o){var a;o.browser?a="utf-8":o.version?a=parseInt(o.version.split(".")[0].slice(1),10)>=6?"utf-8":"binary":a="utf-8",n.exports=a}).call(this,e("_process"))},{_process:467}],463:[function(e,n,i){var o=Math.pow(2,30)-1;n.exports=function(a,s){if(typeof a!="number")throw new TypeError("Iterations not a number");if(a<0)throw new TypeError("Bad iterations");if(typeof s!="number")throw new TypeError("Key length not a number");if(s<0||s>o||s!=s)throw new TypeError("Bad key length")}},{}],464:[function(e,n,i){var o=e("create-hash/md5"),a=e("ripemd160"),s=e("sha.js"),l=e("safe-buffer").Buffer,p=e("./precondition"),d=e("./default-encoding"),g=e("./to-buffer"),y=l.alloc(128),h={md5:16,sha1:20,sha224:28,sha256:32,sha384:48,sha512:64,rmd160:20,ripemd160:20};function u(f,c,v){var m=function(I){function P(N){return s(I).update(N).digest()}return I==="rmd160"||I==="ripemd160"?function(N){return new a().update(N).digest()}:I==="md5"?o:P}(f),b=f==="sha512"||f==="sha384"?128:64;c.length>b?c=m(c):c.length<b&&(c=l.concat([c,y],b));for(var w=l.allocUnsafe(b+h[f]),_=l.allocUnsafe(b+h[f]),C=0;C<b;C++)w[C]=54^c[C],_[C]=92^c[C];var R=l.allocUnsafe(b+v+4);w.copy(R,0,0,b),this.ipad1=R,this.ipad2=w,this.opad=_,this.alg=f,this.blocksize=b,this.hash=m,this.size=h[f]}u.prototype.run=function(f,c){return f.copy(c,this.blocksize),this.hash(c).copy(this.opad,this.blocksize),this.hash(this.opad)},n.exports=function(f,c,v,m,b){p(v,m);var w=new u(b=b||"sha1",f=g(f,d,"Password"),(c=g(c,d,"Salt")).length),_=l.allocUnsafe(m),C=l.allocUnsafe(c.length+4);c.copy(C,0,0,c.length);for(var R=0,I=h[b],P=Math.ceil(m/I),N=1;N<=P;N++){C.writeUInt32BE(N,c.length);for(var A=w.run(C,w.ipad1),$=A,T=1;T<v;T++){$=w.run($,w.ipad2);for(var M=0;M<I;M++)A[M]^=$[M]}A.copy(_,R),R+=I}return _}},{"./default-encoding":462,"./precondition":463,"./to-buffer":465,"create-hash/md5":332,ripemd160:493,"safe-buffer":494,"sha.js":499}],465:[function(e,n,i){var o=e("safe-buffer").Buffer;n.exports=function(a,s,l){if(o.isBuffer(a))return a;if(typeof a=="string")return o.from(a,s);if(ArrayBuffer.isView(a))return o.from(a.buffer);throw new TypeError(l+" must be a string, a Buffer, a typed array or a DataView")}},{"safe-buffer":494}],466:[function(e,n,i){(function(o){o===void 0||!o.version||o.version.indexOf("v0.")===0||o.version.indexOf("v1.")===0&&o.version.indexOf("v1.8.")!==0?n.exports={nextTick:function(a,s,l,p){if(typeof a!="function")throw new TypeError('"callback" argument must be a function');var d,g,y=arguments.length;switch(y){case 0:case 1:return o.nextTick(a);case 2:return o.nextTick(function(){a.call(null,s)});case 3:return o.nextTick(function(){a.call(null,s,l)});case 4:return o.nextTick(function(){a.call(null,s,l,p)});default:for(d=new Array(y-1),g=0;g<d.length;)d[g++]=arguments[g];return o.nextTick(function(){a.apply(null,d)})}}}:n.exports=o}).call(this,e("_process"))},{_process:467}],467:[function(e,n,i){var o,a,s=n.exports={};function l(){throw new Error("setTimeout has not been defined")}function p(){throw new Error("clearTimeout has not been defined")}function d(b){if(o===setTimeout)return setTimeout(b,0);if((o===l||!o)&&setTimeout)return o=setTimeout,setTimeout(b,0);try{return o(b,0)}catch{try{return o.call(null,b,0)}catch{return o.call(this,b,0)}}}(function(){try{o=typeof setTimeout=="function"?setTimeout:l}catch{o=l}try{a=typeof clearTimeout=="function"?clearTimeout:p}catch{a=p}})();var g,y=[],h=!1,u=-1;function f(){h&&g&&(h=!1,g.length?y=g.concat(y):u=-1,y.length&&c())}function c(){if(!h){var b=d(f);h=!0;for(var w=y.length;w;){for(g=y,y=[];++u<w;)g&&g[u].run();u=-1,w=y.length}g=null,h=!1,function(_){if(a===clearTimeout)return clearTimeout(_);if((a===p||!a)&&clearTimeout)return a=clearTimeout,clearTimeout(_);try{a(_)}catch{try{return a.call(null,_)}catch{return a.call(this,_)}}}(b)}}function v(b,w){this.fun=b,this.array=w}function m(){}s.nextTick=function(b){var w=new Array(arguments.length-1);if(arguments.length>1)for(var _=1;_<arguments.length;_++)w[_-1]=arguments[_];y.push(new v(b,w)),y.length!==1||h||d(c)},v.prototype.run=function(){this.fun.apply(null,this.array)},s.title="browser",s.browser=!0,s.env={},s.argv=[],s.version="",s.versions={},s.on=m,s.addListener=m,s.once=m,s.off=m,s.removeListener=m,s.removeAllListeners=m,s.emit=m,s.prependListener=m,s.prependOnceListener=m,s.listeners=function(b){return[]},s.binding=function(b){throw new Error("process.binding is not supported")},s.cwd=function(){return"/"},s.chdir=function(b){throw new Error("process.chdir is not supported")},s.umask=function(){return 0}},{}],468:[function(e,n,i){i.publicEncrypt=e("./publicEncrypt"),i.privateDecrypt=e("./privateDecrypt"),i.privateEncrypt=function(o,a){return i.publicEncrypt(o,a,!0)},i.publicDecrypt=function(o,a){return i.privateDecrypt(o,a,!0)}},{"./privateDecrypt":471,"./publicEncrypt":472}],469:[function(e,n,i){var o=e("create-hash"),a=e("safe-buffer").Buffer;function s(l){var p=a.allocUnsafe(4);return p.writeUInt32BE(l,0),p}n.exports=function(l,p){for(var d,g=a.alloc(0),y=0;g.length<p;)d=s(y++),g=a.concat([g,o("sha1").update(l).update(d).digest()]);return g.slice(0,p)}},{"create-hash":331,"safe-buffer":494}],470:[function(e,n,i){arguments[4][181][0].apply(i,arguments)},{buffer:185,dup:181}],471:[function(e,n,i){var o=e("parse-asn1"),a=e("./mgf"),s=e("./xor"),l=e("bn.js"),p=e("browserify-rsa"),d=e("create-hash"),g=e("./withPublic"),y=e("safe-buffer").Buffer;n.exports=function(h,u,f){var c;c=h.padding?h.padding:f?1:4;var v,m=o(h),b=m.modulus.byteLength();if(u.length>b||new l(u).cmp(m.modulus)>=0)throw new Error("decryption error");v=f?g(new l(u),m):p(u,m);var w=y.alloc(b-v.length);if(v=y.concat([w,v],b),c===4)return function(_,C){var R=_.modulus.byteLength(),I=d("sha1").update(y.alloc(0)).digest(),P=I.length;if(C[0]!==0)throw new Error("decryption error");var N=C.slice(1,P+1),A=C.slice(P+1),$=s(N,a(A,P)),T=s(A,a($,R-P-1));if(function(S,E){S=y.from(S),E=y.from(E);var k=0,O=S.length;S.length!==E.length&&(k++,O=Math.min(S.length,E.length));for(var x=-1;++x<O;)k+=S[x]^E[x];return k}(I,T.slice(0,P)))throw new Error("decryption error");for(var M=P;T[M]===0;)M++;if(T[M++]!==1)throw new Error("decryption error");return T.slice(M)}(m,v);if(c===1)return function(_,C,R){for(var I=C.slice(0,2),P=2,N=0;C[P++]!==0;)if(P>=C.length){N++;break}var A=C.slice(2,P-1);if((I.toString("hex")!=="0002"&&!R||I.toString("hex")!=="0001"&&R)&&N++,A.length<8&&N++,N)throw new Error("decryption error");return C.slice(P)}(0,v,f);if(c===3)return v;throw new Error("unknown padding")}},{"./mgf":469,"./withPublic":473,"./xor":474,"bn.js":470,"browserify-rsa":206,"create-hash":331,"parse-asn1":459,"safe-buffer":494}],472:[function(e,n,i){var o=e("parse-asn1"),a=e("randombytes"),s=e("create-hash"),l=e("./mgf"),p=e("./xor"),d=e("bn.js"),g=e("./withPublic"),y=e("browserify-rsa"),h=e("safe-buffer").Buffer;n.exports=function(u,f,c){var v;v=u.padding?u.padding:c?1:4;var m,b=o(u);if(v===4)m=function(w,_){var C=w.modulus.byteLength(),R=_.length,I=s("sha1").update(h.alloc(0)).digest(),P=I.length,N=2*P;if(R>C-N-2)throw new Error("message too long");var A=h.alloc(C-R-N-2),$=C-P-1,T=a(P),M=p(h.concat([I,A,h.alloc(1,1),_],$),l(T,$)),S=p(T,l(M,P));return new d(h.concat([h.alloc(1),S,M],C))}(b,f);else if(v===1)m=function(w,_,C){var R,I=_.length,P=w.modulus.byteLength();if(I>P-11)throw new Error("message too long");return R=C?h.alloc(P-I-3,255):function(N){for(var A,$=h.allocUnsafe(N),T=0,M=a(2*N),S=0;T<N;)S===M.length&&(M=a(2*N),S=0),(A=M[S++])&&($[T++]=A);return $}(P-I-3),new d(h.concat([h.from([0,C?1:2]),R,h.alloc(1),_],P))}(b,f,c);else{if(v!==3)throw new Error("unknown padding");if((m=new d(f)).cmp(b.modulus)>=0)throw new Error("data too long for modulus")}return c?y(m,b):g(m,b)}},{"./mgf":469,"./withPublic":473,"./xor":474,"bn.js":470,"browserify-rsa":206,"create-hash":331,"parse-asn1":459,randombytes:475,"safe-buffer":494}],473:[function(e,n,i){var o=e("bn.js"),a=e("safe-buffer").Buffer;n.exports=function(s,l){return a.from(s.toRed(o.mont(l.modulus)).redPow(new o(l.publicExponent)).fromRed().toArray())}},{"bn.js":470,"safe-buffer":494}],474:[function(e,n,i){n.exports=function(o,a){for(var s=o.length,l=-1;++l<s;)o[l]^=a[l];return o}},{}],475:[function(e,n,i){(function(o,a){var s=e("safe-buffer").Buffer,l=a.crypto||a.msCrypto;l&&l.getRandomValues?n.exports=function(p,d){if(p>4294967295)throw new RangeError("requested too many random bytes");var g=s.allocUnsafe(p);if(p>0)if(p>65536)for(var y=0;y<p;y+=65536)l.getRandomValues(g.slice(y,y+65536));else l.getRandomValues(g);return typeof d=="function"?o.nextTick(function(){d(null,g)}):g}:n.exports=function(){throw new Error(`Secure random number generation is not supported by this browser.
Use Chrome, Firefox or Internet Explorer 11`)}}).call(this,e("_process"),typeof At!="undefined"?At:typeof self!="undefined"?self:typeof window!="undefined"?window:{})},{_process:467,"safe-buffer":494}],476:[function(e,n,i){(function(o,a){function s(){throw new Error(`secure random number generation not supported by this browser
use chrome, FireFox or Internet Explorer 11`)}var l=e("safe-buffer"),p=e("randombytes"),d=l.Buffer,g=l.kMaxLength,y=a.crypto||a.msCrypto,h=Math.pow(2,32)-1;function u(v,m){if(typeof v!="number"||v!=v)throw new TypeError("offset must be a number");if(v>h||v<0)throw new TypeError("offset must be a uint32");if(v>g||v>m)throw new RangeError("offset out of range")}function f(v,m,b){if(typeof v!="number"||v!=v)throw new TypeError("size must be a number");if(v>h||v<0)throw new TypeError("size must be a uint32");if(v+m>b||v>g)throw new RangeError("buffer too small")}function c(v,m,b,w){if(o.browser){var _=v.buffer,C=new Uint8Array(_,m,b);return y.getRandomValues(C),w?void o.nextTick(function(){w(null,v)}):v}if(!w)return p(b).copy(v,m),v;p(b,function(R,I){if(R)return w(R);I.copy(v,m),w(null,v)})}y&&y.getRandomValues||!o.browser?(i.randomFill=function(v,m,b,w){if(!(d.isBuffer(v)||v instanceof a.Uint8Array))throw new TypeError('"buf" argument must be a Buffer or Uint8Array');if(typeof m=="function")w=m,m=0,b=v.length;else if(typeof b=="function")w=b,b=v.length-m;else if(typeof w!="function")throw new TypeError('"cb" argument must be a function');return u(m,v.length),f(b,m,v.length),c(v,m,b,w)},i.randomFillSync=function(v,m,b){if(m===void 0&&(m=0),!(d.isBuffer(v)||v instanceof a.Uint8Array))throw new TypeError('"buf" argument must be a Buffer or Uint8Array');return u(m,v.length),b===void 0&&(b=v.length-m),f(b,m,v.length),c(v,m,b)}):(i.randomFill=s,i.randomFillSync=s)}).call(this,e("_process"),typeof At!="undefined"?At:typeof self!="undefined"?self:typeof window!="undefined"?window:{})},{_process:467,randombytes:475,"safe-buffer":494}],477:[function(e,n,i){function o(p){return(o=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(d){return typeof d}:function(d){return d&&typeof Symbol=="function"&&d.constructor===Symbol&&d!==Symbol.prototype?"symbol":typeof d})(p)}var a={};function s(p,d,g){g||(g=Error);var y=function(h){var u,f;function c(v,m,b){return h.call(this,function(w,_,C){return typeof d=="string"?d:d(w,_,C)}(v,m,b))||this}return f=h,(u=c).prototype=Object.create(f.prototype),u.prototype.constructor=u,u.__proto__=f,c}(g);y.prototype.name=g.name,y.prototype.code=p,a[p]=y}function l(p,d){if(Array.isArray(p)){var g=p.length;return p=p.map(function(y){return String(y)}),g>2?"one of ".concat(d," ").concat(p.slice(0,g-1).join(", "),", or ")+p[g-1]:g===2?"one of ".concat(d," ").concat(p[0]," or ").concat(p[1]):"of ".concat(d," ").concat(p[0])}return"of ".concat(d," ").concat(String(p))}s("ERR_INVALID_OPT_VALUE",function(p,d){return'The value "'+d+'" is invalid for option "'+p+'"'},TypeError),s("ERR_INVALID_ARG_TYPE",function(p,d,g){var y,h,u;if(typeof d=="string"&&(h="not ",d.substr(0,h.length)===h)?(y="must not be",d=d.replace(/^not /,"")):y="must be",function(c,v,m){return(m===void 0||m>c.length)&&(m=c.length),c.substring(m-v.length,m)===v}(p," argument"))u="The ".concat(p," ").concat(y," ").concat(l(d,"type"));else{var f=function(c,v,m){return typeof m!="number"&&(m=0),!(m+v.length>c.length)&&c.indexOf(v,m)!==-1}(p,".")?"property":"argument";u='The "'.concat(p,'" ').concat(f," ").concat(y," ").concat(l(d,"type"))}return u+=". Received type ".concat(o(g))},TypeError),s("ERR_STREAM_PUSH_AFTER_EOF","stream.push() after EOF"),s("ERR_METHOD_NOT_IMPLEMENTED",function(p){return"The "+p+" method is not implemented"}),s("ERR_STREAM_PREMATURE_CLOSE","Premature close"),s("ERR_STREAM_DESTROYED",function(p){return"Cannot call "+p+" after a stream was destroyed"}),s("ERR_MULTIPLE_CALLBACK","Callback called multiple times"),s("ERR_STREAM_CANNOT_PIPE","Cannot pipe, not readable"),s("ERR_STREAM_WRITE_AFTER_END","write after end"),s("ERR_STREAM_NULL_VALUES","May not write null values to stream",TypeError),s("ERR_UNKNOWN_ENCODING",function(p){return"Unknown encoding: "+p},TypeError),s("ERR_STREAM_UNSHIFT_AFTER_END_EVENT","stream.unshift() after end event"),n.exports.codes=a},{}],478:[function(e,n,i){(function(o){var a=Object.keys||function(f){var c=[];for(var v in f)c.push(v);return c};n.exports=y;var s=e("./_stream_readable"),l=e("./_stream_writable");e("inherits")(y,s);for(var p=a(l.prototype),d=0;d<p.length;d++){var g=p[d];y.prototype[g]||(y.prototype[g]=l.prototype[g])}function y(f){if(!(this instanceof y))return new y(f);s.call(this,f),l.call(this,f),this.allowHalfOpen=!0,f&&(f.readable===!1&&(this.readable=!1),f.writable===!1&&(this.writable=!1),f.allowHalfOpen===!1&&(this.allowHalfOpen=!1,this.once("end",h)))}function h(){this._writableState.ended||o.nextTick(u,this)}function u(f){f.end()}Object.defineProperty(y.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),Object.defineProperty(y.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}}),Object.defineProperty(y.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}}),Object.defineProperty(y.prototype,"destroyed",{enumerable:!1,get:function(){return this._readableState!==void 0&&this._writableState!==void 0&&this._readableState.destroyed&&this._writableState.destroyed},set:function(f){this._readableState!==void 0&&this._writableState!==void 0&&(this._readableState.destroyed=f,this._writableState.destroyed=f)}})}).call(this,e("_process"))},{"./_stream_readable":480,"./_stream_writable":482,_process:467,inherits:387}],479:[function(e,n,i){n.exports=a;var o=e("./_stream_transform");function a(s){if(!(this instanceof a))return new a(s);o.call(this,s)}e("inherits")(a,o),a.prototype._transform=function(s,l,p){p(null,s)}},{"./_stream_transform":481,inherits:387}],480:[function(e,n,i){(function(o,a){var s;n.exports=$,$.ReadableState=A,e("events").EventEmitter;var l=function(D,L){return D.listeners(L).length},p=e("./internal/streams/stream"),d=e("buffer").Buffer,g=a.Uint8Array||function(){},y,h=e("util");y=h&&h.debuglog?h.debuglog("stream"):function(){};var u,f,c,v=e("./internal/streams/buffer_list"),m=e("./internal/streams/destroy"),b=e("./internal/streams/state").getHighWaterMark,w=e("../errors").codes,_=w.ERR_INVALID_ARG_TYPE,C=w.ERR_STREAM_PUSH_AFTER_EOF,R=w.ERR_METHOD_NOT_IMPLEMENTED,I=w.ERR_STREAM_UNSHIFT_AFTER_END_EVENT;e("inherits")($,p);var P=m.errorOrDestroy,N=["error","close","destroy","pause","resume"];function A(D,L,B){s=s||e("./_stream_duplex"),D=D||{},typeof B!="boolean"&&(B=L instanceof s),this.objectMode=!!D.objectMode,B&&(this.objectMode=this.objectMode||!!D.readableObjectMode),this.highWaterMark=b(this,D,"readableHighWaterMark",B),this.buffer=new v,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.paused=!0,this.emitClose=D.emitClose!==!1,this.autoDestroy=!!D.autoDestroy,this.destroyed=!1,this.defaultEncoding=D.defaultEncoding||"utf8",this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,D.encoding&&(u||(u=e("string_decoder/").StringDecoder),this.decoder=new u(D.encoding),this.encoding=D.encoding)}function $(D){if(s=s||e("./_stream_duplex"),!(this instanceof $))return new $(D);var L=this instanceof s;this._readableState=new A(D,this,L),this.readable=!0,D&&(typeof D.read=="function"&&(this._read=D.read),typeof D.destroy=="function"&&(this._destroy=D.destroy)),p.call(this)}function T(D,L,B,z,q){y("readableAddChunk",L);var X,ee=D._readableState;if(L===null)ee.reading=!1,function(ye,de){if(y("onEofChunk"),!de.ended){if(de.decoder){var ge=de.decoder.end();ge&&ge.length&&(de.buffer.push(ge),de.length+=de.objectMode?1:ge.length)}de.ended=!0,de.sync?E(ye):(de.needReadable=!1,de.emittedReadable||(de.emittedReadable=!0,k(ye)))}}(D,ee);else if(q||(X=function(ye,de){var ge;we=de,d.isBuffer(we)||we instanceof g||typeof de=="string"||de===void 0||ye.objectMode||(ge=new _("chunk",["string","Buffer","Uint8Array"],de));var we;return ge}(ee,L)),X)P(D,X);else if(ee.objectMode||L&&L.length>0)if(typeof L=="string"||ee.objectMode||Object.getPrototypeOf(L)===d.prototype||(L=function(ye){return d.from(ye)}(L)),z)ee.endEmitted?P(D,new I):M(D,ee,L,!0);else if(ee.ended)P(D,new C);else{if(ee.destroyed)return!1;ee.reading=!1,ee.decoder&&!B?(L=ee.decoder.write(L),ee.objectMode||L.length!==0?M(D,ee,L,!1):O(D,ee)):M(D,ee,L,!1)}else z||(ee.reading=!1,O(D,ee));return!ee.ended&&(ee.length<ee.highWaterMark||ee.length===0)}function M(D,L,B,z){L.flowing&&L.length===0&&!L.sync?(L.awaitDrain=0,D.emit("data",B)):(L.length+=L.objectMode?1:B.length,z?L.buffer.unshift(B):L.buffer.push(B),L.needReadable&&E(D)),O(D,L)}Object.defineProperty($.prototype,"destroyed",{enumerable:!1,get:function(){return this._readableState!==void 0&&this._readableState.destroyed},set:function(D){this._readableState&&(this._readableState.destroyed=D)}}),$.prototype.destroy=m.destroy,$.prototype._undestroy=m.undestroy,$.prototype._destroy=function(D,L){L(D)},$.prototype.push=function(D,L){var B,z=this._readableState;return z.objectMode?B=!0:typeof D=="string"&&((L=L||z.defaultEncoding)!==z.encoding&&(D=d.from(D,L),L=""),B=!0),T(this,D,L,!1,B)},$.prototype.unshift=function(D){return T(this,D,null,!0,!1)},$.prototype.isPaused=function(){return this._readableState.flowing===!1},$.prototype.setEncoding=function(D){u||(u=e("string_decoder/").StringDecoder);var L=new u(D);this._readableState.decoder=L,this._readableState.encoding=this._readableState.decoder.encoding;for(var B=this._readableState.buffer.head,z="";B!==null;)z+=L.write(B.data),B=B.next;return this._readableState.buffer.clear(),z!==""&&this._readableState.buffer.push(z),this._readableState.length=z.length,this};function S(D,L){return D<=0||L.length===0&&L.ended?0:L.objectMode?1:D!=D?L.flowing&&L.length?L.buffer.head.data.length:L.length:(D>L.highWaterMark&&(L.highWaterMark=function(B){return B>=1073741824?B=1073741824:(B--,B|=B>>>1,B|=B>>>2,B|=B>>>4,B|=B>>>8,B|=B>>>16,B++),B}(D)),D<=L.length?D:L.ended?L.length:(L.needReadable=!0,0))}function E(D){var L=D._readableState;y("emitReadable",L.needReadable,L.emittedReadable),L.needReadable=!1,L.emittedReadable||(y("emitReadable",L.flowing),L.emittedReadable=!0,o.nextTick(k,D))}function k(D){var L=D._readableState;y("emitReadable_",L.destroyed,L.length,L.ended),L.destroyed||!L.length&&!L.ended||(D.emit("readable"),L.emittedReadable=!1),L.needReadable=!L.flowing&&!L.ended&&L.length<=L.highWaterMark,V(D)}function O(D,L){L.readingMore||(L.readingMore=!0,o.nextTick(x,D,L))}function x(D,L){for(;!L.reading&&!L.ended&&(L.length<L.highWaterMark||L.flowing&&L.length===0);){var B=L.length;if(y("maybeReadMore read 0"),D.read(0),B===L.length)break}L.readingMore=!1}function j(D){var L=D._readableState;L.readableListening=D.listenerCount("readable")>0,L.resumeScheduled&&!L.paused?L.flowing=!0:D.listenerCount("data")>0&&D.resume()}function H(D){y("readable nexttick read 0"),D.read(0)}function F(D,L){y("resume",L.reading),L.reading||D.read(0),L.resumeScheduled=!1,D.emit("resume"),V(D),L.flowing&&!L.reading&&D.read(0)}function V(D){var L=D._readableState;for(y("flow",L.flowing);L.flowing&&D.read()!==null;);}function W(D,L){return L.length===0?null:(L.objectMode?B=L.buffer.shift():!D||D>=L.length?(B=L.decoder?L.buffer.join(""):L.buffer.length===1?L.buffer.first():L.buffer.concat(L.length),L.buffer.clear()):B=L.buffer.consume(D,L.decoder),B);var B}function U(D){var L=D._readableState;y("endReadable",L.endEmitted),L.endEmitted||(L.ended=!0,o.nextTick(Y,L,D))}function Y(D,L){if(y("endReadableNT",D.endEmitted,D.length),!D.endEmitted&&D.length===0&&(D.endEmitted=!0,L.readable=!1,L.emit("end"),D.autoDestroy)){var B=L._writableState;(!B||B.autoDestroy&&B.finished)&&L.destroy()}}function K(D,L){for(var B=0,z=D.length;B<z;B++)if(D[B]===L)return B;return-1}$.prototype.read=function(D){y("read",D),D=parseInt(D,10);var L=this._readableState,B=D;if(D!==0&&(L.emittedReadable=!1),D===0&&L.needReadable&&((L.highWaterMark!==0?L.length>=L.highWaterMark:L.length>0)||L.ended))return y("read: emitReadable",L.length,L.ended),L.length===0&&L.ended?U(this):E(this),null;if((D=S(D,L))===0&&L.ended)return L.length===0&&U(this),null;var z,q=L.needReadable;return y("need readable",q),(L.length===0||L.length-D<L.highWaterMark)&&y("length less than watermark",q=!0),L.ended||L.reading?y("reading or ended",q=!1):q&&(y("do read"),L.reading=!0,L.sync=!0,L.length===0&&(L.needReadable=!0),this._read(L.highWaterMark),L.sync=!1,L.reading||(D=S(B,L))),(z=D>0?W(D,L):null)===null?(L.needReadable=L.length<=L.highWaterMark,D=0):(L.length-=D,L.awaitDrain=0),L.length===0&&(L.ended||(L.needReadable=!0),B!==D&&L.ended&&U(this)),z!==null&&this.emit("data",z),z},$.prototype._read=function(D){P(this,new R("_read()"))},$.prototype.pipe=function(D,L){var B=this,z=this._readableState;switch(z.pipesCount){case 0:z.pipes=D;break;case 1:z.pipes=[z.pipes,D];break;default:z.pipes.push(D)}z.pipesCount+=1,y("pipe count=%d opts=%j",z.pipesCount,L);var q=(!L||L.end!==!1)&&D!==o.stdout&&D!==o.stderr?ee:te;function X(ie,fe){y("onunpipe"),ie===B&&fe&&fe.hasUnpiped===!1&&(fe.hasUnpiped=!0,y("cleanup"),D.removeListener("close",be),D.removeListener("finish",J),D.removeListener("drain",ye),D.removeListener("error",we),D.removeListener("unpipe",X),B.removeListener("end",ee),B.removeListener("end",te),B.removeListener("data",ge),de=!0,!z.awaitDrain||D._writableState&&!D._writableState.needDrain||ye())}function ee(){y("onend"),D.end()}z.endEmitted?o.nextTick(q):B.once("end",q),D.on("unpipe",X);var ye=function(ie){return function(){var fe=ie._readableState;y("pipeOnDrain",fe.awaitDrain),fe.awaitDrain&&fe.awaitDrain--,fe.awaitDrain===0&&l(ie,"data")&&(fe.flowing=!0,V(ie))}}(B);D.on("drain",ye);var de=!1;function ge(ie){y("ondata");var fe=D.write(ie);y("dest.write",fe),fe===!1&&((z.pipesCount===1&&z.pipes===D||z.pipesCount>1&&K(z.pipes,D)!==-1)&&!de&&(y("false write response, pause",z.awaitDrain),z.awaitDrain++),B.pause())}function we(ie){y("onerror",ie),te(),D.removeListener("error",we),l(D,"error")===0&&P(D,ie)}function be(){D.removeListener("finish",J),te()}function J(){y("onfinish"),D.removeListener("close",be),te()}function te(){y("unpipe"),B.unpipe(D)}return B.on("data",ge),function(ie,fe,se){if(typeof ie.prependListener=="function")return ie.prependListener(fe,se);ie._events&&ie._events[fe]?Array.isArray(ie._events[fe])?ie._events[fe].unshift(se):ie._events[fe]=[se,ie._events[fe]]:ie.on(fe,se)}(D,"error",we),D.once("close",be),D.once("finish",J),D.emit("pipe",B),z.flowing||(y("pipe resume"),B.resume()),D},$.prototype.unpipe=function(D){var L=this._readableState,B={hasUnpiped:!1};if(L.pipesCount===0)return this;if(L.pipesCount===1)return D&&D!==L.pipes||(D||(D=L.pipes),L.pipes=null,L.pipesCount=0,L.flowing=!1,D&&D.emit("unpipe",this,B)),this;if(!D){var z=L.pipes,q=L.pipesCount;L.pipes=null,L.pipesCount=0,L.flowing=!1;for(var X=0;X<q;X++)z[X].emit("unpipe",this,{hasUnpiped:!1});return this}var ee=K(L.pipes,D);return ee===-1||(L.pipes.splice(ee,1),L.pipesCount-=1,L.pipesCount===1&&(L.pipes=L.pipes[0]),D.emit("unpipe",this,B)),this},$.prototype.on=function(D,L){var B=p.prototype.on.call(this,D,L),z=this._readableState;return D==="data"?(z.readableListening=this.listenerCount("readable")>0,z.flowing!==!1&&this.resume()):D==="readable"&&(z.endEmitted||z.readableListening||(z.readableListening=z.needReadable=!0,z.flowing=!1,z.emittedReadable=!1,y("on readable",z.length,z.reading),z.length?E(this):z.reading||o.nextTick(H,this))),B},$.prototype.addListener=$.prototype.on,$.prototype.removeListener=function(D,L){var B=p.prototype.removeListener.call(this,D,L);return D==="readable"&&o.nextTick(j,this),B},$.prototype.removeAllListeners=function(D){var L=p.prototype.removeAllListeners.apply(this,arguments);return D!=="readable"&&D!==void 0||o.nextTick(j,this),L},$.prototype.resume=function(){var D=this._readableState;return D.flowing||(y("resume"),D.flowing=!D.readableListening,function(L,B){B.resumeScheduled||(B.resumeScheduled=!0,o.nextTick(F,L,B))}(this,D)),D.paused=!1,this},$.prototype.pause=function(){return y("call pause flowing=%j",this._readableState.flowing),this._readableState.flowing!==!1&&(y("pause"),this._readableState.flowing=!1,this.emit("pause")),this._readableState.paused=!0,this},$.prototype.wrap=function(D){var L=this,B=this._readableState,z=!1;for(var q in D.on("end",function(){if(y("wrapped end"),B.decoder&&!B.ended){var ee=B.decoder.end();ee&&ee.length&&L.push(ee)}L.push(null)}),D.on("data",function(ee){y("wrapped data"),B.decoder&&(ee=B.decoder.write(ee)),B.objectMode&&ee==null||(B.objectMode||ee&&ee.length)&&(L.push(ee)||(z=!0,D.pause()))}),D)this[q]===void 0&&typeof D[q]=="function"&&(this[q]=function(ee){return function(){return D[ee].apply(D,arguments)}}(q));for(var X=0;X<N.length;X++)D.on(N[X],this.emit.bind(this,N[X]));return this._read=function(ee){y("wrapped _read",ee),z&&(z=!1,D.resume())},this},typeof Symbol=="function"&&($.prototype[Symbol.asyncIterator]=function(){return f===void 0&&(f=e("./internal/streams/async_iterator")),f(this)}),Object.defineProperty($.prototype,"readableHighWaterMark",{enumerable:!1,get:function(){return this._readableState.highWaterMark}}),Object.defineProperty($.prototype,"readableBuffer",{enumerable:!1,get:function(){return this._readableState&&this._readableState.buffer}}),Object.defineProperty($.prototype,"readableFlowing",{enumerable:!1,get:function(){return this._readableState.flowing},set:function(D){this._readableState&&(this._readableState.flowing=D)}}),$._fromList=W,Object.defineProperty($.prototype,"readableLength",{enumerable:!1,get:function(){return this._readableState.length}}),typeof Symbol=="function"&&($.from=function(D,L){return c===void 0&&(c=e("./internal/streams/from")),c($,D,L)})}).call(this,e("_process"),typeof At!="undefined"?At:typeof self!="undefined"?self:typeof window!="undefined"?window:{})},{"../errors":477,"./_stream_duplex":478,"./internal/streams/async_iterator":483,"./internal/streams/buffer_list":484,"./internal/streams/destroy":485,"./internal/streams/from":487,"./internal/streams/state":489,"./internal/streams/stream":490,_process:467,buffer:216,events:367,inherits:387,"string_decoder/":520,util:185}],481:[function(e,n,i){n.exports=y;var o=e("../errors").codes,a=o.ERR_METHOD_NOT_IMPLEMENTED,s=o.ERR_MULTIPLE_CALLBACK,l=o.ERR_TRANSFORM_ALREADY_TRANSFORMING,p=o.ERR_TRANSFORM_WITH_LENGTH_0,d=e("./_stream_duplex");function g(f,c){var v=this._transformState;v.transforming=!1;var m=v.writecb;if(m===null)return this.emit("error",new s);v.writechunk=null,v.writecb=null,c!=null&&this.push(c),m(f);var b=this._readableState;b.reading=!1,(b.needReadable||b.length<b.highWaterMark)&&this._read(b.highWaterMark)}function y(f){if(!(this instanceof y))return new y(f);d.call(this,f),this._transformState={afterTransform:g.bind(this),needTransform:!1,transforming:!1,writecb:null,writechunk:null,writeencoding:null},this._readableState.needReadable=!0,this._readableState.sync=!1,f&&(typeof f.transform=="function"&&(this._transform=f.transform),typeof f.flush=="function"&&(this._flush=f.flush)),this.on("prefinish",h)}function h(){var f=this;typeof this._flush!="function"||this._readableState.destroyed?u(this,null,null):this._flush(function(c,v){u(f,c,v)})}function u(f,c,v){if(c)return f.emit("error",c);if(v!=null&&f.push(v),f._writableState.length)throw new p;if(f._transformState.transforming)throw new l;return f.push(null)}e("inherits")(y,d),y.prototype.push=function(f,c){return this._transformState.needTransform=!1,d.prototype.push.call(this,f,c)},y.prototype._transform=function(f,c,v){v(new a("_transform()"))},y.prototype._write=function(f,c,v){var m=this._transformState;if(m.writecb=v,m.writechunk=f,m.writeencoding=c,!m.transforming){var b=this._readableState;(m.needTransform||b.needReadable||b.length<b.highWaterMark)&&this._read(b.highWaterMark)}},y.prototype._read=function(f){var c=this._transformState;c.writechunk===null||c.transforming?c.needTransform=!0:(c.transforming=!0,this._transform(c.writechunk,c.writeencoding,c.afterTransform))},y.prototype._destroy=function(f,c){d.prototype._destroy.call(this,f,function(v){c(v)})}},{"../errors":477,"./_stream_duplex":478,inherits:387}],482:[function(e,n,i){(function(o,a){function s(x){var j=this;this.next=null,this.entry=null,this.finish=function(){(function(H,F,V){var W=H.entry;for(H.entry=null;W;){var U=W.callback;F.pendingcb--,U(V),W=W.next}F.corkedRequestsFree.next=H})(j,x)}}var l;n.exports=$,$.WritableState=A;var p={deprecate:e("util-deprecate")},d=e("./internal/streams/stream"),g=e("buffer").Buffer,y=a.Uint8Array||function(){},h,u=e("./internal/streams/destroy"),f=e("./internal/streams/state").getHighWaterMark,c=e("../errors").codes,v=c.ERR_INVALID_ARG_TYPE,m=c.ERR_METHOD_NOT_IMPLEMENTED,b=c.ERR_MULTIPLE_CALLBACK,w=c.ERR_STREAM_CANNOT_PIPE,_=c.ERR_STREAM_DESTROYED,C=c.ERR_STREAM_NULL_VALUES,R=c.ERR_STREAM_WRITE_AFTER_END,I=c.ERR_UNKNOWN_ENCODING,P=u.errorOrDestroy;function N(){}function A(x,j,H){l=l||e("./_stream_duplex"),x=x||{},typeof H!="boolean"&&(H=j instanceof l),this.objectMode=!!x.objectMode,H&&(this.objectMode=this.objectMode||!!x.writableObjectMode),this.highWaterMark=f(this,x,"writableHighWaterMark",H),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;var F=x.decodeStrings===!1;this.decodeStrings=!F,this.defaultEncoding=x.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(V){(function(W,U){var Y=W._writableState,K=Y.sync,D=Y.writecb;if(typeof D!="function")throw new b;if(function(B){B.writing=!1,B.writecb=null,B.length-=B.writelen,B.writelen=0}(Y),U)(function(B,z,q,X,ee){--z.pendingcb,q?(o.nextTick(ee,X),o.nextTick(O,B,z),B._writableState.errorEmitted=!0,P(B,X)):(ee(X),B._writableState.errorEmitted=!0,P(B,X),O(B,z))})(W,Y,K,U,D);else{var L=E(Y)||W.destroyed;L||Y.corked||Y.bufferProcessing||!Y.bufferedRequest||S(W,Y),K?o.nextTick(M,W,Y,L,D):M(W,Y,L,D)}})(j,V)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.emitClose=x.emitClose!==!1,this.autoDestroy=!!x.autoDestroy,this.bufferedRequestCount=0,this.corkedRequestsFree=new s(this)}function $(x){var j=this instanceof(l=l||e("./_stream_duplex"));if(!j&&!h.call($,this))return new $(x);this._writableState=new A(x,this,j),this.writable=!0,x&&(typeof x.write=="function"&&(this._write=x.write),typeof x.writev=="function"&&(this._writev=x.writev),typeof x.destroy=="function"&&(this._destroy=x.destroy),typeof x.final=="function"&&(this._final=x.final)),d.call(this)}function T(x,j,H,F,V,W,U){j.writelen=F,j.writecb=U,j.writing=!0,j.sync=!0,j.destroyed?j.onwrite(new _("write")):H?x._writev(V,j.onwrite):x._write(V,W,j.onwrite),j.sync=!1}function M(x,j,H,F){H||function(V,W){W.length===0&&W.needDrain&&(W.needDrain=!1,V.emit("drain"))}(x,j),j.pendingcb--,F(),O(x,j)}function S(x,j){j.bufferProcessing=!0;var H=j.bufferedRequest;if(x._writev&&H&&H.next){var F=j.bufferedRequestCount,V=new Array(F),W=j.corkedRequestsFree;W.entry=H;for(var U=0,Y=!0;H;)V[U]=H,H.isBuf||(Y=!1),H=H.next,U+=1;V.allBuffers=Y,T(x,j,!0,j.length,V,"",W.finish),j.pendingcb++,j.lastBufferedRequest=null,W.next?(j.corkedRequestsFree=W.next,W.next=null):j.corkedRequestsFree=new s(j),j.bufferedRequestCount=0}else{for(;H;){var K=H.chunk,D=H.encoding,L=H.callback;if(T(x,j,!1,j.objectMode?1:K.length,K,D,L),H=H.next,j.bufferedRequestCount--,j.writing)break}H===null&&(j.lastBufferedRequest=null)}j.bufferedRequest=H,j.bufferProcessing=!1}function E(x){return x.ending&&x.length===0&&x.bufferedRequest===null&&!x.finished&&!x.writing}function k(x,j){x._final(function(H){j.pendingcb--,H&&P(x,H),j.prefinished=!0,x.emit("prefinish"),O(x,j)})}function O(x,j){var H=E(j);if(H&&(function(V,W){W.prefinished||W.finalCalled||(typeof V._final!="function"||W.destroyed?(W.prefinished=!0,V.emit("prefinish")):(W.pendingcb++,W.finalCalled=!0,o.nextTick(k,V,W)))}(x,j),j.pendingcb===0&&(j.finished=!0,x.emit("finish"),j.autoDestroy))){var F=x._readableState;(!F||F.autoDestroy&&F.endEmitted)&&x.destroy()}return H}e("inherits")($,d),A.prototype.getBuffer=function(){for(var x=this.bufferedRequest,j=[];x;)j.push(x),x=x.next;return j},function(){try{Object.defineProperty(A.prototype,"buffer",{get:p.deprecate(function(){return this.getBuffer()},"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.","DEP0003")})}catch{}}(),typeof Symbol=="function"&&Symbol.hasInstance&&typeof Function.prototype[Symbol.hasInstance]=="function"?(h=Function.prototype[Symbol.hasInstance],Object.defineProperty($,Symbol.hasInstance,{value:function(x){return!!h.call(this,x)||this===$&&x&&x._writableState instanceof A}})):h=function(x){return x instanceof this},$.prototype.pipe=function(){P(this,new w)},$.prototype.write=function(x,j,H){var F,V=this._writableState,W=!1,U=!V.objectMode&&(F=x,g.isBuffer(F)||F instanceof y);return U&&!g.isBuffer(x)&&(x=function(Y){return g.from(Y)}(x)),typeof j=="function"&&(H=j,j=null),U?j="buffer":j||(j=V.defaultEncoding),typeof H!="function"&&(H=N),V.ending?function(Y,K){var D=new R;P(Y,D),o.nextTick(K,D)}(this,H):(U||function(Y,K,D,L){var B;return D===null?B=new C:typeof D=="string"||K.objectMode||(B=new v("chunk",["string","Buffer"],D)),!B||(P(Y,B),o.nextTick(L,B),!1)}(this,V,x,H))&&(V.pendingcb++,W=function(Y,K,D,L,B,z){if(!D){var q=function(de,ge,we){return de.objectMode||de.decodeStrings===!1||typeof ge!="string"||(ge=g.from(ge,we)),ge}(K,L,B);L!==q&&(D=!0,B="buffer",L=q)}var X=K.objectMode?1:L.length;K.length+=X;var ee=K.length<K.highWaterMark;if(ee||(K.needDrain=!0),K.writing||K.corked){var ye=K.lastBufferedRequest;K.lastBufferedRequest={chunk:L,encoding:B,isBuf:D,callback:z,next:null},ye?ye.next=K.lastBufferedRequest:K.bufferedRequest=K.lastBufferedRequest,K.bufferedRequestCount+=1}else T(Y,K,!1,X,L,B,z);return ee}(this,V,U,x,j,H)),W},$.prototype.cork=function(){this._writableState.corked++},$.prototype.uncork=function(){var x=this._writableState;x.corked&&(x.corked--,x.writing||x.corked||x.bufferProcessing||!x.bufferedRequest||S(this,x))},$.prototype.setDefaultEncoding=function(x){if(typeof x=="string"&&(x=x.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((x+"").toLowerCase())>-1))throw new I(x);return this._writableState.defaultEncoding=x,this},Object.defineProperty($.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}}),Object.defineProperty($.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),$.prototype._write=function(x,j,H){H(new m("_write()"))},$.prototype._writev=null,$.prototype.end=function(x,j,H){var F=this._writableState;return typeof x=="function"?(H=x,x=null,j=null):typeof j=="function"&&(H=j,j=null),x!=null&&this.write(x,j),F.corked&&(F.corked=1,this.uncork()),F.ending||function(V,W,U){W.ending=!0,O(V,W),U&&(W.finished?o.nextTick(U):V.once("finish",U)),W.ended=!0,V.writable=!1}(this,F,H),this},Object.defineProperty($.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}}),Object.defineProperty($.prototype,"destroyed",{enumerable:!1,get:function(){return this._writableState!==void 0&&this._writableState.destroyed},set:function(x){this._writableState&&(this._writableState.destroyed=x)}}),$.prototype.destroy=u.destroy,$.prototype._undestroy=u.undestroy,$.prototype._destroy=function(x,j){j(x)}}).call(this,e("_process"),typeof At!="undefined"?At:typeof self!="undefined"?self:typeof window!="undefined"?window:{})},{"../errors":477,"./_stream_duplex":478,"./internal/streams/destroy":485,"./internal/streams/state":489,"./internal/streams/stream":490,_process:467,buffer:216,inherits:387,"util-deprecate":522}],483:[function(e,n,i){(function(o){var a;function s(_,C,R){return C in _?Object.defineProperty(_,C,{value:R,enumerable:!0,configurable:!0,writable:!0}):_[C]=R,_}var l=e("./end-of-stream"),p=Symbol("lastResolve"),d=Symbol("lastReject"),g=Symbol("error"),y=Symbol("ended"),h=Symbol("lastPromise"),u=Symbol("handlePromise"),f=Symbol("stream");function c(_,C){return{value:_,done:C}}function v(_){var C=_[p];if(C!==null){var R=_[f].read();R!==null&&(_[h]=null,_[p]=null,_[d]=null,C(c(R,!1)))}}function m(_){o.nextTick(v,_)}var b=Object.getPrototypeOf(function(){}),w=Object.setPrototypeOf((s(a={get stream(){return this[f]},next:function(){var _=this,C=this[g];if(C!==null)return Promise.reject(C);if(this[y])return Promise.resolve(c(void 0,!0));if(this[f].destroyed)return new Promise(function(N,A){o.nextTick(function(){_[g]?A(_[g]):N(c(void 0,!0))})});var R,I=this[h];if(I)R=new Promise(function(N,A){return function($,T){N.then(function(){A[y]?$(c(void 0,!0)):A[u]($,T)},T)}}(I,this));else{var P=this[f].read();if(P!==null)return Promise.resolve(c(P,!1));R=new Promise(this[u])}return this[h]=R,R}},Symbol.asyncIterator,function(){return this}),s(a,"return",function(){var _=this;return new Promise(function(C,R){_[f].destroy(null,function(I){I?R(I):C(c(void 0,!0))})})}),a),b);n.exports=function(_){var C,R=Object.create(w,(s(C={},f,{value:_,writable:!0}),s(C,p,{value:null,writable:!0}),s(C,d,{value:null,writable:!0}),s(C,g,{value:null,writable:!0}),s(C,y,{value:_._readableState.endEmitted,writable:!0}),s(C,u,{value:function(I,P){var N=R[f].read();N?(R[h]=null,R[p]=null,R[d]=null,I(c(N,!1))):(R[p]=I,R[d]=P)},writable:!0}),C));return R[h]=null,l(_,function(I){if(I&&I.code!=="ERR_STREAM_PREMATURE_CLOSE"){var P=R[d];return P!==null&&(R[h]=null,R[p]=null,R[d]=null,P(I)),void(R[g]=I)}var N=R[p];N!==null&&(R[h]=null,R[p]=null,R[d]=null,N(c(void 0,!0))),R[y]=!0}),_.on("readable",m.bind(null,R)),R}}).call(this,e("_process"))},{"./end-of-stream":486,_process:467}],484:[function(e,n,i){function o(g,y){var h=Object.keys(g);if(Object.getOwnPropertySymbols){var u=Object.getOwnPropertySymbols(g);y&&(u=u.filter(function(f){return Object.getOwnPropertyDescriptor(g,f).enumerable})),h.push.apply(h,u)}return h}function a(g,y,h){return y in g?Object.defineProperty(g,y,{value:h,enumerable:!0,configurable:!0,writable:!0}):g[y]=h,g}function s(g,y){for(var h=0;h<y.length;h++){var u=y[h];u.enumerable=u.enumerable||!1,u.configurable=!0,"value"in u&&(u.writable=!0),Object.defineProperty(g,u.key,u)}}var l=e("buffer").Buffer,p=e("util").inspect,d=p&&p.custom||"inspect";n.exports=function(){function g(){(function(u,f){if(!(u instanceof f))throw new TypeError("Cannot call a class as a function")})(this,g),this.head=null,this.tail=null,this.length=0}var y,h;return y=g,(h=[{key:"push",value:function(u){var f={data:u,next:null};this.length>0?this.tail.next=f:this.head=f,this.tail=f,++this.length}},{key:"unshift",value:function(u){var f={data:u,next:this.head};this.length===0&&(this.tail=f),this.head=f,++this.length}},{key:"shift",value:function(){if(this.length!==0){var u=this.head.data;return this.length===1?this.head=this.tail=null:this.head=this.head.next,--this.length,u}}},{key:"clear",value:function(){this.head=this.tail=null,this.length=0}},{key:"join",value:function(u){if(this.length===0)return"";for(var f=this.head,c=""+f.data;f=f.next;)c+=u+f.data;return c}},{key:"concat",value:function(u){if(this.length===0)return l.alloc(0);for(var f,c,v,m=l.allocUnsafe(u>>>0),b=this.head,w=0;b;)f=b.data,c=m,v=w,l.prototype.copy.call(f,c,v),w+=b.data.length,b=b.next;return m}},{key:"consume",value:function(u,f){var c;return u<this.head.data.length?(c=this.head.data.slice(0,u),this.head.data=this.head.data.slice(u)):c=u===this.head.data.length?this.shift():f?this._getString(u):this._getBuffer(u),c}},{key:"first",value:function(){return this.head.data}},{key:"_getString",value:function(u){var f=this.head,c=1,v=f.data;for(u-=v.length;f=f.next;){var m=f.data,b=u>m.length?m.length:u;if(b===m.length?v+=m:v+=m.slice(0,u),(u-=b)==0){b===m.length?(++c,f.next?this.head=f.next:this.head=this.tail=null):(this.head=f,f.data=m.slice(b));break}++c}return this.length-=c,v}},{key:"_getBuffer",value:function(u){var f=l.allocUnsafe(u),c=this.head,v=1;for(c.data.copy(f),u-=c.data.length;c=c.next;){var m=c.data,b=u>m.length?m.length:u;if(m.copy(f,f.length-u,0,b),(u-=b)==0){b===m.length?(++v,c.next?this.head=c.next:this.head=this.tail=null):(this.head=c,c.data=m.slice(b));break}++v}return this.length-=v,f}},{key:d,value:function(u,f){return p(this,function(c){for(var v=1;v<arguments.length;v++){var m=arguments[v]!=null?arguments[v]:{};v%2?o(Object(m),!0).forEach(function(b){a(c,b,m[b])}):Object.getOwnPropertyDescriptors?Object.defineProperties(c,Object.getOwnPropertyDescriptors(m)):o(Object(m)).forEach(function(b){Object.defineProperty(c,b,Object.getOwnPropertyDescriptor(m,b))})}return c}({},f,{depth:0,customInspect:!1}))}}])&&s(y.prototype,h),g}()},{buffer:216,util:185}],485:[function(e,n,i){(function(o){function a(p,d){l(p,d),s(p)}function s(p){p._writableState&&!p._writableState.emitClose||p._readableState&&!p._readableState.emitClose||p.emit("close")}function l(p,d){p.emit("error",d)}n.exports={destroy:function(p,d){var g=this,y=this._readableState&&this._readableState.destroyed,h=this._writableState&&this._writableState.destroyed;return y||h?(d?d(p):p&&(this._writableState?this._writableState.errorEmitted||(this._writableState.errorEmitted=!0,o.nextTick(l,this,p)):o.nextTick(l,this,p)),this):(this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(p||null,function(u){!d&&u?g._writableState?g._writableState.errorEmitted?o.nextTick(s,g):(g._writableState.errorEmitted=!0,o.nextTick(a,g,u)):o.nextTick(a,g,u):d?(o.nextTick(s,g),d(u)):o.nextTick(s,g)}),this)},undestroy:function(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finalCalled=!1,this._writableState.prefinished=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)},errorOrDestroy:function(p,d){var g=p._readableState,y=p._writableState;g&&g.autoDestroy||y&&y.autoDestroy?p.destroy(d):p.emit("error",d)}}}).call(this,e("_process"))},{_process:467}],486:[function(e,n,i){var o=e("../../../errors").codes.ERR_STREAM_PREMATURE_CLOSE;function a(){}n.exports=function s(l,p,d){if(typeof p=="function")return s(l,null,p);p||(p={}),d=function(_){var C=!1;return function(){if(!C){C=!0;for(var R=arguments.length,I=new Array(R),P=0;P<R;P++)I[P]=arguments[P];_.apply(this,I)}}}(d||a);var g=p.readable||p.readable!==!1&&l.readable,y=p.writable||p.writable!==!1&&l.writable,h=function(){l.writable||f()},u=l._writableState&&l._writableState.finished,f=function(){y=!1,u=!0,g||d.call(l)},c=l._readableState&&l._readableState.endEmitted,v=function(){g=!1,c=!0,y||d.call(l)},m=function(_){d.call(l,_)},b=function(){var _;return g&&!c?(l._readableState&&l._readableState.ended||(_=new o),d.call(l,_)):y&&!u?(l._writableState&&l._writableState.ended||(_=new o),d.call(l,_)):void 0},w=function(){l.req.on("finish",f)};return function(_){return _.setHeader&&typeof _.abort=="function"}(l)?(l.on("complete",f),l.on("abort",b),l.req?w():l.on("request",w)):y&&!l._writableState&&(l.on("end",h),l.on("close",h)),l.on("end",v),l.on("finish",f),p.error!==!1&&l.on("error",m),l.on("close",b),function(){l.removeListener("complete",f),l.removeListener("abort",b),l.removeListener("request",w),l.req&&l.req.removeListener("finish",f),l.removeListener("end",h),l.removeListener("close",h),l.removeListener("finish",f),l.removeListener("end",v),l.removeListener("error",m),l.removeListener("close",b)}}},{"../../../errors":477}],487:[function(e,n,i){n.exports=function(){throw new Error("Readable.from is not available in the browser")}},{}],488:[function(e,n,i){var o,a=e("../../../errors").codes,s=a.ERR_MISSING_ARGS,l=a.ERR_STREAM_DESTROYED;function p(u){if(u)throw u}function d(u,f,c,v){v=function(w){var _=!1;return function(){_||(_=!0,w.apply(void 0,arguments))}}(v);var m=!1;u.on("close",function(){m=!0}),o===void 0&&(o=e("./end-of-stream")),o(u,{readable:f,writable:c},function(w){if(w)return v(w);m=!0,v()});var b=!1;return function(w){if(!m&&!b)return b=!0,function(_){return _.setHeader&&typeof _.abort=="function"}(u)?u.abort():typeof u.destroy=="function"?u.destroy():void v(w||new l("pipe"))}}function g(u){u()}function y(u,f){return u.pipe(f)}function h(u){return u.length?typeof u[u.length-1]!="function"?p:u.pop():p}n.exports=function(){for(var u=arguments.length,f=new Array(u),c=0;c<u;c++)f[c]=arguments[c];var v,m=h(f);if(Array.isArray(f[0])&&(f=f[0]),f.length<2)throw new s("streams");var b=f.map(function(w,_){var C=_<f.length-1;return d(w,C,_>0,function(R){v||(v=R),R&&b.forEach(g),C||(b.forEach(g),m(v))})});return f.reduce(y)}},{"../../../errors":477,"./end-of-stream":486}],489:[function(e,n,i){var o=e("../../../errors").codes.ERR_INVALID_OPT_VALUE;n.exports={getHighWaterMark:function(a,s,l,p){var d=function(g,y,h){return g.highWaterMark!=null?g.highWaterMark:y?g[h]:null}(s,p,l);if(d!=null){if(!isFinite(d)||Math.floor(d)!==d||d<0)throw new o(p?l:"highWaterMark",d);return Math.floor(d)}return a.objectMode?16:16384}}},{"../../../errors":477}],490:[function(e,n,i){n.exports=e("events").EventEmitter},{events:367}],491:[function(e,n,i){(i=n.exports=e("./lib/_stream_readable.js")).Stream=i,i.Readable=i,i.Writable=e("./lib/_stream_writable.js"),i.Duplex=e("./lib/_stream_duplex.js"),i.Transform=e("./lib/_stream_transform.js"),i.PassThrough=e("./lib/_stream_passthrough.js"),i.finished=e("./lib/internal/streams/end-of-stream.js"),i.pipeline=e("./lib/internal/streams/pipeline.js")},{"./lib/_stream_duplex.js":478,"./lib/_stream_passthrough.js":479,"./lib/_stream_readable.js":480,"./lib/_stream_transform.js":481,"./lib/_stream_writable.js":482,"./lib/internal/streams/end-of-stream.js":486,"./lib/internal/streams/pipeline.js":488}],492:[function(e,n,i){function o(s){return(o=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(l){return typeof l}:function(l){return l&&typeof Symbol=="function"&&l.constructor===Symbol&&l!==Symbol.prototype?"symbol":typeof l})(s)}var a=function(s){var l=Object.prototype,p=l.hasOwnProperty,d=typeof Symbol=="function"?Symbol:{},g=d.iterator||"@@iterator",y=d.asyncIterator||"@@asyncIterator",h=d.toStringTag||"@@toStringTag";function u(k,O,x){return Object.defineProperty(k,O,{value:x,enumerable:!0,configurable:!0,writable:!0}),k[O]}try{u({},"")}catch{u=function(O,x,j){return O[x]=j}}function f(k,O,x,j){var H=O&&O.prototype instanceof m?O:m,F=Object.create(H.prototype),V=new M(j||[]);return F._invoke=function(W,U,Y){var K="suspendedStart";return function(D,L){if(K==="executing")throw new Error("Generator is already running");if(K==="completed"){if(D==="throw")throw L;return E()}for(Y.method=D,Y.arg=L;;){var B=Y.delegate;if(B){var z=A(B,Y);if(z){if(z===v)continue;return z}}if(Y.method==="next")Y.sent=Y._sent=Y.arg;else if(Y.method==="throw"){if(K==="suspendedStart")throw K="completed",Y.arg;Y.dispatchException(Y.arg)}else Y.method==="return"&&Y.abrupt("return",Y.arg);K="executing";var q=c(W,U,Y);if(q.type==="normal"){if(K=Y.done?"completed":"suspendedYield",q.arg===v)continue;return{value:q.arg,done:Y.done}}q.type==="throw"&&(K="completed",Y.method="throw",Y.arg=q.arg)}}}(k,x,V),F}function c(k,O,x){try{return{type:"normal",arg:k.call(O,x)}}catch(j){return{type:"throw",arg:j}}}s.wrap=f;var v={};function m(){}function b(){}function w(){}var _={};_[g]=function(){return this};var C=Object.getPrototypeOf,R=C&&C(C(S([])));R&&R!==l&&p.call(R,g)&&(_=R);var I=w.prototype=m.prototype=Object.create(_);function P(k){["next","throw","return"].forEach(function(O){u(k,O,function(x){return this._invoke(O,x)})})}function N(k,O){var x;this._invoke=function(j,H){function F(){return new O(function(V,W){(function U(Y,K,D,L){var B=c(k[Y],k,K);if(B.type!=="throw"){var z=B.arg,q=z.value;return q&&o(q)==="object"&&p.call(q,"__await")?O.resolve(q.__await).then(function(X){U("next",X,D,L)},function(X){U("throw",X,D,L)}):O.resolve(q).then(function(X){z.value=X,D(z)},function(X){return U("throw",X,D,L)})}L(B.arg)})(j,H,V,W)})}return x=x?x.then(F,F):F()}}function A(k,O){var x=k.iterator[O.method];if(x===void 0){if(O.delegate=null,O.method==="throw"){if(k.iterator.return&&(O.method="return",O.arg=void 0,A(k,O),O.method==="throw"))return v;O.method="throw",O.arg=new TypeError("The iterator does not provide a 'throw' method")}return v}var j=c(x,k.iterator,O.arg);if(j.type==="throw")return O.method="throw",O.arg=j.arg,O.delegate=null,v;var H=j.arg;return H?H.done?(O[k.resultName]=H.value,O.next=k.nextLoc,O.method!=="return"&&(O.method="next",O.arg=void 0),O.delegate=null,v):H:(O.method="throw",O.arg=new TypeError("iterator result is not an object"),O.delegate=null,v)}function $(k){var O={tryLoc:k[0]};1 in k&&(O.catchLoc=k[1]),2 in k&&(O.finallyLoc=k[2],O.afterLoc=k[3]),this.tryEntries.push(O)}function T(k){var O=k.completion||{};O.type="normal",delete O.arg,k.completion=O}function M(k){this.tryEntries=[{tryLoc:"root"}],k.forEach($,this),this.reset(!0)}function S(k){if(k){var O=k[g];if(O)return O.call(k);if(typeof k.next=="function")return k;if(!isNaN(k.length)){var x=-1,j=function H(){for(;++x<k.length;)if(p.call(k,x))return H.value=k[x],H.done=!1,H;return H.value=void 0,H.done=!0,H};return j.next=j}}return{next:E}}function E(){return{value:void 0,done:!0}}return b.prototype=I.constructor=w,w.constructor=b,b.displayName=u(w,h,"GeneratorFunction"),s.isGeneratorFunction=function(k){var O=typeof k=="function"&&k.constructor;return!!O&&(O===b||(O.displayName||O.name)==="GeneratorFunction")},s.mark=function(k){return Object.setPrototypeOf?Object.setPrototypeOf(k,w):(k.__proto__=w,u(k,h,"GeneratorFunction")),k.prototype=Object.create(I),k},s.awrap=function(k){return{__await:k}},P(N.prototype),N.prototype[y]=function(){return this},s.AsyncIterator=N,s.async=function(k,O,x,j,H){H===void 0&&(H=Promise);var F=new N(f(k,O,x,j),H);return s.isGeneratorFunction(O)?F:F.next().then(function(V){return V.done?V.value:F.next()})},P(I),u(I,h,"Generator"),I[g]=function(){return this},I.toString=function(){return"[object Generator]"},s.keys=function(k){var O=[];for(var x in k)O.push(x);return O.reverse(),function j(){for(;O.length;){var H=O.pop();if(H in k)return j.value=H,j.done=!1,j}return j.done=!0,j}},s.values=S,M.prototype={constructor:M,reset:function(k){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(T),!k)for(var O in this)O.charAt(0)==="t"&&p.call(this,O)&&!isNaN(+O.slice(1))&&(this[O]=void 0)},stop:function(){this.done=!0;var k=this.tryEntries[0].completion;if(k.type==="throw")throw k.arg;return this.rval},dispatchException:function(k){if(this.done)throw k;var O=this;function x(U,Y){return F.type="throw",F.arg=k,O.next=U,Y&&(O.method="next",O.arg=void 0),!!Y}for(var j=this.tryEntries.length-1;j>=0;--j){var H=this.tryEntries[j],F=H.completion;if(H.tryLoc==="root")return x("end");if(H.tryLoc<=this.prev){var V=p.call(H,"catchLoc"),W=p.call(H,"finallyLoc");if(V&&W){if(this.prev<H.catchLoc)return x(H.catchLoc,!0);if(this.prev<H.finallyLoc)return x(H.finallyLoc)}else if(V){if(this.prev<H.catchLoc)return x(H.catchLoc,!0)}else{if(!W)throw new Error("try statement without catch or finally");if(this.prev<H.finallyLoc)return x(H.finallyLoc)}}}},abrupt:function(k,O){for(var x=this.tryEntries.length-1;x>=0;--x){var j=this.tryEntries[x];if(j.tryLoc<=this.prev&&p.call(j,"finallyLoc")&&this.prev<j.finallyLoc){var H=j;break}}H&&(k==="break"||k==="continue")&&H.tryLoc<=O&&O<=H.finallyLoc&&(H=null);var F=H?H.completion:{};return F.type=k,F.arg=O,H?(this.method="next",this.next=H.finallyLoc,v):this.complete(F)},complete:function(k,O){if(k.type==="throw")throw k.arg;return k.type==="break"||k.type==="continue"?this.next=k.arg:k.type==="return"?(this.rval=this.arg=k.arg,this.method="return",this.next="end"):k.type==="normal"&&O&&(this.next=O),v},finish:function(k){for(var O=this.tryEntries.length-1;O>=0;--O){var x=this.tryEntries[O];if(x.finallyLoc===k)return this.complete(x.completion,x.afterLoc),T(x),v}},catch:function(k){for(var O=this.tryEntries.length-1;O>=0;--O){var x=this.tryEntries[O];if(x.tryLoc===k){var j=x.completion;if(j.type==="throw"){var H=j.arg;T(x)}return H}}throw new Error("illegal catch attempt")},delegateYield:function(k,O,x){return this.delegate={iterator:S(k),resultName:O,nextLoc:x},this.method==="next"&&(this.arg=void 0),v}},s}((n===void 0?"undefined":o(n))==="object"?n.exports:{});try{regeneratorRuntime=a}catch{Function("r","regeneratorRuntime = r")(a)}},{}],493:[function(e,n,i){var o=e("buffer").Buffer,a=e("inherits"),s=e("hash-base"),l=new Array(16),p=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8,3,10,14,4,9,15,8,1,2,7,0,6,13,11,5,12,1,9,11,10,0,8,12,4,13,3,7,15,14,5,6,2,4,0,5,9,7,12,2,10,14,1,3,8,11,6,15,13],d=[5,14,7,0,9,2,11,4,13,6,15,8,1,10,3,12,6,11,3,7,0,13,5,10,14,15,8,12,4,9,1,2,15,5,1,3,7,14,6,9,11,8,12,2,10,0,4,13,8,6,4,1,3,11,15,0,5,12,2,13,9,7,10,14,12,15,10,4,1,5,8,7,6,2,13,14,0,3,9,11],g=[11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8,7,6,8,13,11,9,7,15,7,12,15,9,11,7,13,12,11,13,6,7,14,9,13,15,14,8,13,6,5,12,7,5,11,12,14,15,14,15,9,8,9,14,5,6,8,6,5,12,9,15,5,11,6,8,13,12,5,12,13,14,11,8,5,6],y=[8,9,9,11,13,15,15,5,7,7,8,11,14,14,12,6,9,13,15,7,12,8,9,11,7,7,12,7,6,15,13,11,9,7,15,11,8,6,6,14,12,13,5,14,13,13,7,5,15,5,8,11,14,14,6,14,6,9,12,9,12,5,15,8,8,5,12,9,12,5,14,6,8,13,6,5,15,13,11,11],h=[0,1518500249,1859775393,2400959708,2840853838],u=[1352829926,1548603684,1836072691,2053994217,0];function f(){s.call(this,64),this._a=1732584193,this._b=4023233417,this._c=2562383102,this._d=271733878,this._e=3285377520}function c(C,R){return C<<R|C>>>32-R}function v(C,R,I,P,N,A,$,T){return c(C+(R^I^P)+A+$|0,T)+N|0}function m(C,R,I,P,N,A,$,T){return c(C+(R&I|~R&P)+A+$|0,T)+N|0}function b(C,R,I,P,N,A,$,T){return c(C+((R|~I)^P)+A+$|0,T)+N|0}function w(C,R,I,P,N,A,$,T){return c(C+(R&P|I&~P)+A+$|0,T)+N|0}function _(C,R,I,P,N,A,$,T){return c(C+(R^(I|~P))+A+$|0,T)+N|0}a(f,s),f.prototype._update=function(){for(var C=l,R=0;R<16;++R)C[R]=this._block.readInt32LE(4*R);for(var I=0|this._a,P=0|this._b,N=0|this._c,A=0|this._d,$=0|this._e,T=0|this._a,M=0|this._b,S=0|this._c,E=0|this._d,k=0|this._e,O=0;O<80;O+=1){var x,j;O<16?(x=v(I,P,N,A,$,C[p[O]],h[0],g[O]),j=_(T,M,S,E,k,C[d[O]],u[0],y[O])):O<32?(x=m(I,P,N,A,$,C[p[O]],h[1],g[O]),j=w(T,M,S,E,k,C[d[O]],u[1],y[O])):O<48?(x=b(I,P,N,A,$,C[p[O]],h[2],g[O]),j=b(T,M,S,E,k,C[d[O]],u[2],y[O])):O<64?(x=w(I,P,N,A,$,C[p[O]],h[3],g[O]),j=m(T,M,S,E,k,C[d[O]],u[3],y[O])):(x=_(I,P,N,A,$,C[p[O]],h[4],g[O]),j=v(T,M,S,E,k,C[d[O]],u[4],y[O])),I=$,$=A,A=c(N,10),N=P,P=x,T=k,k=E,E=c(S,10),S=M,M=j}var H=this._b+N+E|0;this._b=this._c+A+k|0,this._c=this._d+$+T|0,this._d=this._e+I+M|0,this._e=this._a+P+S|0,this._a=H},f.prototype._digest=function(){this._block[this._blockOffset++]=128,this._blockOffset>56&&(this._block.fill(0,this._blockOffset,64),this._update(),this._blockOffset=0),this._block.fill(0,this._blockOffset,56),this._block.writeUInt32LE(this._length[0],56),this._block.writeUInt32LE(this._length[1],60),this._update();var C=o.alloc?o.alloc(20):new o(20);return C.writeInt32LE(this._a,0),C.writeInt32LE(this._b,4),C.writeInt32LE(this._c,8),C.writeInt32LE(this._d,12),C.writeInt32LE(this._e,16),C},n.exports=f},{buffer:216,"hash-base":370,inherits:387}],494:[function(e,n,i){var o=e("buffer"),a=o.Buffer;function s(p,d){for(var g in p)d[g]=p[g]}function l(p,d,g){return a(p,d,g)}a.from&&a.alloc&&a.allocUnsafe&&a.allocUnsafeSlow?n.exports=o:(s(o,i),i.Buffer=l),s(a,l),l.from=function(p,d,g){if(typeof p=="number")throw new TypeError("Argument must not be a number");return a(p,d,g)},l.alloc=function(p,d,g){if(typeof p!="number")throw new TypeError("Argument must be a number");var y=a(p);return d!==void 0?typeof g=="string"?y.fill(d,g):y.fill(d):y.fill(0),y},l.allocUnsafe=function(p){if(typeof p!="number")throw new TypeError("Argument must be a number");return a(p)},l.allocUnsafeSlow=function(p){if(typeof p!="number")throw new TypeError("Argument must be a number");return o.SlowBuffer(p)}},{buffer:216}],495:[function(e,n,i){(function(o){function a(y){return(a=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(h){return typeof h}:function(h){return h&&typeof Symbol=="function"&&h.constructor===Symbol&&h!==Symbol.prototype?"symbol":typeof h})(y)}var s,l=e("buffer"),p=l.Buffer,d={};for(s in l)l.hasOwnProperty(s)&&s!=="SlowBuffer"&&s!=="Buffer"&&(d[s]=l[s]);var g=d.Buffer={};for(s in p)p.hasOwnProperty(s)&&s!=="allocUnsafe"&&s!=="allocUnsafeSlow"&&(g[s]=p[s]);if(d.Buffer.prototype=p.prototype,g.from&&g.from!==Uint8Array.from||(g.from=function(y,h,u){if(typeof y=="number")throw new TypeError('The "value" argument must not be of type number. Received type '+a(y));if(y&&y.length===void 0)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+a(y));return p(y,h,u)}),g.alloc||(g.alloc=function(y,h,u){if(typeof y!="number")throw new TypeError('The "size" argument must be of type number. Received type '+a(y));if(y<0||y>=2*(1<<30))throw new RangeError('The value "'+y+'" is invalid for option "size"');var f=p(y);return h&&h.length!==0?typeof u=="string"?f.fill(h,u):f.fill(h):f.fill(0),f}),!d.kStringMaxLength)try{d.kStringMaxLength=o.binding("buffer").kStringMaxLength}catch{}d.constants||(d.constants={MAX_LENGTH:d.kMaxLength},d.kStringMaxLength&&(d.constants.MAX_STRING_LENGTH=d.kStringMaxLength)),n.exports=d}).call(this,e("_process"))},{_process:467,buffer:216}],496:[function(e,n,i){function o(U,Y){var K;if(typeof Symbol=="undefined"||U[Symbol.iterator]==null){if(Array.isArray(U)||(K=p(U))||Y&&U&&typeof U.length=="number"){K&&(U=K);var D=0,L=function(){};return{s:L,n:function(){return D>=U.length?{done:!0}:{done:!1,value:U[D++]}},e:function(X){throw X},f:L}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var B,z=!0,q=!1;return{s:function(){K=U[Symbol.iterator]()},n:function(){var X=K.next();return z=X.done,X},e:function(X){q=!0,B=X},f:function(){try{z||K.return==null||K.return()}finally{if(q)throw B}}}}function a(U){return(a=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(Y){return typeof Y}:function(Y){return Y&&typeof Symbol=="function"&&Y.constructor===Symbol&&Y!==Symbol.prototype?"symbol":typeof Y})(U)}function s(U,Y){for(var K=0;K<Y.length;K++){var D=Y[K];D.enumerable=D.enumerable||!1,D.configurable=!0,"value"in D&&(D.writable=!0),Object.defineProperty(U,D.key,D)}}function l(U){return function(Y){if(Array.isArray(Y))return d(Y)}(U)||function(Y){if(typeof Symbol!="undefined"&&Symbol.iterator in Object(Y))return Array.from(Y)}(U)||p(U)||function(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}()}function p(U,Y){if(U){if(typeof U=="string")return d(U,Y);var K=Object.prototype.toString.call(U).slice(8,-1);return K==="Object"&&U.constructor&&(K=U.constructor.name),K==="Map"||K==="Set"?Array.from(U):K==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(K)?d(U,Y):void 0}}function d(U,Y){(Y==null||Y>U.length)&&(Y=U.length);for(var K=0,D=new Array(Y);K<Y;K++)D[K]=U[K];return D}Object.defineProperty(i,"__esModule",{value:!0});var g=e("xmlchars/xml/1.0/ed5"),y=e("xmlchars/xml/1.1/ed2"),h=e("xmlchars/xmlns/1.0/ed3"),u=g.isS,f=g.isChar,c=g.isNameStartChar,v=g.isNameChar,m=g.S_LIST,b=g.NAME_RE,w=y.isChar,_=h.isNCNameStartChar,C=h.isNCNameChar,R=h.NC_NAME_RE,I="http://www.w3.org/XML/1998/namespace",P="http://www.w3.org/2000/xmlns/",N={__proto__:null,xml:I,xmlns:P},A={__proto__:null,amp:"&",gt:">",lt:"<",quot:'"',apos:"'"},$=61,T=63,M=function(U){return U===34||U===39},S=[34,39],E=[].concat(S,[91,62]),k=[].concat(S,[60,93]),O=[$,T].concat(l(m)),x=[].concat(l(m),[62,38,60]);function j(U,Y,K){switch(Y){case"xml":K!==I&&U.fail("xml prefix must be bound to ".concat(I,"."));break;case"xmlns":K!==P&&U.fail("xmlns prefix must be bound to ".concat(P,"."))}switch(K){case P:U.fail(Y===""?"the default namespace may not be set to ".concat(K,"."):'may not assign a prefix (even "xmlns") to the URI '.concat(P,"."));break;case I:switch(Y){case"xml":break;case"":U.fail("the default namespace may not be set to ".concat(K,"."));break;default:U.fail("may not assign the xml namespace to another prefix.")}}}var H=function(U){return R.test(U)},F=function(U){return b.test(U)};i.EVENTS=["xmldecl","text","processinginstruction","doctype","comment","opentagstart","attribute","opentag","closetag","cdata","error","end","ready"];var V={xmldecl:"xmldeclHandler",text:"textHandler",processinginstruction:"piHandler",doctype:"doctypeHandler",comment:"commentHandler",opentagstart:"openTagStartHandler",attribute:"attributeHandler",opentag:"openTagHandler",closetag:"closeTagHandler",cdata:"cdataHandler",error:"errorHandler",end:"endHandler",ready:"readyHandler"},W=function(){function U(D){(function(z,q){if(!(z instanceof q))throw new TypeError("Cannot call a class as a function")})(this,U),this.opt=D!=null?D:{},this.fragmentOpt=!!this.opt.fragment;var L=this.xmlnsOpt=!!this.opt.xmlns;if(this.trackPosition=this.opt.position!==!1,this.fileName=this.opt.fileName,L){this.nameStartCheck=_,this.nameCheck=C,this.isName=H,this.processAttribs=this.processAttribsNS,this.pushAttrib=this.pushAttribNS,this.ns=Object.assign({__proto__:null},N);var B=this.opt.additionalNamespaces;B!=null&&(function(z,q){for(var X=0,ee=Object.keys(q);X<ee.length;X++){var ye=ee[X];j(z,ye,q[ye])}}(this,B),Object.assign(this.ns,B))}else this.nameStartCheck=c,this.nameCheck=v,this.isName=F,this.processAttribs=this.processAttribsPlain,this.pushAttrib=this.pushAttribPlain;this.stateTable=[this.sBegin,this.sBeginWhitespace,this.sDoctype,this.sDoctypeQuote,this.sDTD,this.sDTDQuoted,this.sDTDOpenWaka,this.sDTDOpenWakaBang,this.sDTDComment,this.sDTDCommentEnding,this.sDTDCommentEnded,this.sDTDPI,this.sDTDPIEnding,this.sText,this.sEntity,this.sOpenWaka,this.sOpenWakaBang,this.sComment,this.sCommentEnding,this.sCommentEnded,this.sCData,this.sCDataEnding,this.sCDataEnding2,this.sPIFirstChar,this.sPIRest,this.sPIBody,this.sPIEnding,this.sXMLDeclNameStart,this.sXMLDeclName,this.sXMLDeclEq,this.sXMLDeclValueStart,this.sXMLDeclValue,this.sXMLDeclSeparator,this.sXMLDeclEnding,this.sOpenTag,this.sOpenTagSlash,this.sAttrib,this.sAttribName,this.sAttribNameSawWhite,this.sAttribValue,this.sAttribValueQuoted,this.sAttribValueClosed,this.sAttribValueUnquoted,this.sCloseTag,this.sCloseTagSawWhite],this._init()}var Y,K;return Y=U,(K=[{key:"_init",value:function(){var D;this.openWakaBang="",this.text="",this.name="",this.piTarget="",this.entity="",this.q=null,this.tags=[],this.tag=null,this.topNS=null,this.chunk="",this.chunkPosition=0,this.i=0,this.prevI=0,this.carriedFromPrevious=void 0,this.forbiddenState=0,this.attribList=[];var L=this.fragmentOpt;this.state=L?13:0,this.reportedTextBeforeRoot=this.reportedTextAfterRoot=this.closedRoot=this.sawRoot=L,this.xmlDeclPossible=!L,this.xmlDeclExpects=["version"],this.entityReturnState=void 0;var B=this.opt.defaultXMLVersion;if(B===void 0){if(this.opt.forceXMLVersion===!0)throw new Error("forceXMLVersion set but defaultXMLVersion is not set");B="1.0"}this.setXMLVersion(B),this.positionAtNewLine=0,this.doctype=!1,this._closed=!1,this.xmlDecl={version:void 0,encoding:void 0,standalone:void 0},this.line=1,this.column=0,this.ENTITIES=Object.create(A),(D=this.readyHandler)===null||D===void 0||D.call(this)}},{key:"on",value:function(D,L){this[V[D]]=L}},{key:"off",value:function(D){this[V[D]]=void 0}},{key:"makeError",value:function(D){var L,B=(L=this.fileName)!==null&&L!==void 0?L:"";return this.trackPosition&&(B.length>0&&(B+=":"),B+="".concat(this.line,":").concat(this.column)),B.length>0&&(B+=": "),new Error(B+D)}},{key:"fail",value:function(D){var L=this.makeError(D),B=this.errorHandler;if(B===void 0)throw L;return B(L),this}},{key:"write",value:function(D){if(this.closed)return this.fail("cannot write after close; assign an onready handler.");var L=!1;D===null?(L=!0,D=""):a(D)==="object"&&(D=D.toString()),this.carriedFromPrevious!==void 0&&(D="".concat(this.carriedFromPrevious).concat(D),this.carriedFromPrevious=void 0);var B=D.length,z=D.charCodeAt(B-1);!L&&(z===13||z>=55296&&z<=56319)&&(this.carriedFromPrevious=D[B-1],B--,D=D.slice(0,B));var q=this.stateTable;for(this.chunk=D,this.i=0;this.i<B;)q[this.state].call(this);return this.chunkPosition+=B,L?this.end():this}},{key:"close",value:function(){return this.write(null)}},{key:"getCode10",value:function(){var D=this.chunk,L=this.i;if(this.prevI=L,this.i=L+1,L>=D.length)return-1;var B=D.charCodeAt(L);if(this.column++,B<55296){if(B>=32||B===9)return B;switch(B){case 10:return this.line++,this.column=0,this.positionAtNewLine=this.position,10;case 13:return D.charCodeAt(L+1)===10&&(this.i=L+2),this.line++,this.column=0,this.positionAtNewLine=this.position,-2;default:return this.fail("disallowed character."),B}}if(B>56319)return B>=57344&&B<=65533||this.fail("disallowed character."),B;var z=65536+1024*(B-55296)+(D.charCodeAt(L+1)-56320);return this.i=L+2,z>1114111&&this.fail("disallowed character."),z}},{key:"getCode11",value:function(){var D=this.chunk,L=this.i;if(this.prevI=L,this.i=L+1,L>=D.length)return-1;var B=D.charCodeAt(L);if(this.column++,B<55296){if(B>31&&B<127||B>159&&B!==8232||B===9)return B;switch(B){case 10:return this.line++,this.column=0,this.positionAtNewLine=this.position,10;case 13:var z=D.charCodeAt(L+1);z!==10&&z!==133||(this.i=L+2);case 133:case 8232:return this.line++,this.column=0,this.positionAtNewLine=this.position,-2;default:return this.fail("disallowed character."),B}}if(B>56319)return B>=57344&&B<=65533||this.fail("disallowed character."),B;var q=65536+1024*(B-55296)+(D.charCodeAt(L+1)-56320);return this.i=L+2,q>1114111&&this.fail("disallowed character."),q}},{key:"getCodeNorm",value:function(){var D=this.getCode();return D===-2?10:D}},{key:"unget",value:function(){this.i=this.prevI,this.column--}},{key:"captureTo",value:function(D){for(var L=this.i,B=this.chunk;;){var z=this.getCode(),q=z===-2,X=q?10:z;if(X===-1||D.includes(X))return this.text+=B.slice(L,this.prevI),X;q&&(this.text+="".concat(B.slice(L,this.prevI),`
`),L=this.i)}}},{key:"captureToChar",value:function(D){for(var L=this.i,B=this.chunk;;){var z=this.getCode();switch(z){case-2:this.text+="".concat(B.slice(L,this.prevI),`
`),L=this.i,z=10;break;case-1:return this.text+=B.slice(L),!1}if(z===D)return this.text+=B.slice(L,this.prevI),!0}}},{key:"captureNameChars",value:function(){for(var D=this.chunk,L=this.i;;){var B=this.getCode();if(B===-1)return this.name+=D.slice(L),-1;if(!v(B))return this.name+=D.slice(L,this.prevI),B===-2?10:B}}},{key:"skipSpaces",value:function(){for(;;){var D=this.getCodeNorm();if(D===-1||!u(D))return D}}},{key:"setXMLVersion",value:function(D){this.currentXMLVersion=D,D==="1.0"?(this.isChar=f,this.getCode=this.getCode10):(this.isChar=w,this.getCode=this.getCode11)}},{key:"sBegin",value:function(){this.chunk.charCodeAt(0)===65279&&(this.i++,this.column++),this.state=1}},{key:"sBeginWhitespace",value:function(){var D=this.i,L=this.skipSpaces();switch(this.prevI!==D&&(this.xmlDeclPossible=!1),L){case 60:if(this.state=15,this.text.length!==0)throw new Error("no-empty text at start");break;case-1:break;default:this.unget(),this.state=13,this.xmlDeclPossible=!1}}},{key:"sDoctype",value:function(){var D,L=this.captureTo(E);switch(L){case 62:(D=this.doctypeHandler)===null||D===void 0||D.call(this,this.text),this.text="",this.state=13,this.doctype=!0;break;case-1:break;default:this.text+=String.fromCodePoint(L),L===91?this.state=4:M(L)&&(this.state=3,this.q=L)}}},{key:"sDoctypeQuote",value:function(){var D=this.q;this.captureToChar(D)&&(this.text+=String.fromCodePoint(D),this.q=null,this.state=2)}},{key:"sDTD",value:function(){var D=this.captureTo(k);D!==-1&&(this.text+=String.fromCodePoint(D),D===93?this.state=2:D===60?this.state=6:M(D)&&(this.state=5,this.q=D))}},{key:"sDTDQuoted",value:function(){var D=this.q;this.captureToChar(D)&&(this.text+=String.fromCodePoint(D),this.state=4,this.q=null)}},{key:"sDTDOpenWaka",value:function(){var D=this.getCodeNorm();switch(this.text+=String.fromCodePoint(D),D){case 33:this.state=7,this.openWakaBang="";break;case T:this.state=11;break;default:this.state=4}}},{key:"sDTDOpenWakaBang",value:function(){var D=String.fromCodePoint(this.getCodeNorm()),L=this.openWakaBang+=D;this.text+=D,L!=="-"&&(this.state=L==="--"?8:4,this.openWakaBang="")}},{key:"sDTDComment",value:function(){this.captureToChar(45)&&(this.text+="-",this.state=9)}},{key:"sDTDCommentEnding",value:function(){var D=this.getCodeNorm();this.text+=String.fromCodePoint(D),this.state=D===45?10:8}},{key:"sDTDCommentEnded",value:function(){var D=this.getCodeNorm();this.text+=String.fromCodePoint(D),D===62?this.state=4:(this.fail("malformed comment."),this.state=8)}},{key:"sDTDPI",value:function(){this.captureToChar(T)&&(this.text+="?",this.state=12)}},{key:"sDTDPIEnding",value:function(){var D=this.getCodeNorm();this.text+=String.fromCodePoint(D),D===62&&(this.state=4)}},{key:"sText",value:function(){this.tags.length!==0?this.handleTextInRoot():this.handleTextOutsideRoot()}},{key:"sEntity",value:function(){var D=this.i,L=this.chunk;e:for(;;)switch(this.getCode()){case-2:this.entity+="".concat(L.slice(D,this.prevI),`
`),D=this.i;break;case 59:var B=this.entityReturnState,z=this.entity+L.slice(D,this.prevI);this.state=B;var q=void 0;z===""?(this.fail("empty entity name."),q="&;"):(q=this.parseEntity(z),this.entity=""),B===13&&this.textHandler===void 0||(this.text+=q);break e;case-1:this.entity+=L.slice(D);break e}}},{key:"sOpenWaka",value:function(){var D=this.getCode();if(c(D))this.state=34,this.unget(),this.xmlDeclPossible=!1;else switch(D){case 47:this.state=43,this.xmlDeclPossible=!1;break;case 33:this.state=16,this.openWakaBang="",this.xmlDeclPossible=!1;break;case T:this.state=23;break;default:this.fail("disallowed character in tag name"),this.state=13,this.xmlDeclPossible=!1}}},{key:"sOpenWakaBang",value:function(){switch(this.openWakaBang+=String.fromCodePoint(this.getCodeNorm()),this.openWakaBang){case"[CDATA[":this.sawRoot||this.reportedTextBeforeRoot||(this.fail("text data outside of root node."),this.reportedTextBeforeRoot=!0),this.closedRoot&&!this.reportedTextAfterRoot&&(this.fail("text data outside of root node."),this.reportedTextAfterRoot=!0),this.state=20,this.openWakaBang="";break;case"--":this.state=17,this.openWakaBang="";break;case"DOCTYPE":this.state=2,(this.doctype||this.sawRoot)&&this.fail("inappropriately located doctype declaration."),this.openWakaBang="";break;default:this.openWakaBang.length>=7&&this.fail("incorrect syntax.")}}},{key:"sComment",value:function(){this.captureToChar(45)&&(this.state=18)}},{key:"sCommentEnding",value:function(){var D,L=this.getCodeNorm();L===45?(this.state=19,(D=this.commentHandler)===null||D===void 0||D.call(this,this.text),this.text=""):(this.text+="-".concat(String.fromCodePoint(L)),this.state=17)}},{key:"sCommentEnded",value:function(){var D=this.getCodeNorm();D!==62?(this.fail("malformed comment."),this.text+="--".concat(String.fromCodePoint(D)),this.state=17):this.state=13}},{key:"sCData",value:function(){this.captureToChar(93)&&(this.state=21)}},{key:"sCDataEnding",value:function(){var D=this.getCodeNorm();D===93?this.state=22:(this.text+="]".concat(String.fromCodePoint(D)),this.state=20)}},{key:"sCDataEnding2",value:function(){var D,L=this.getCodeNorm();switch(L){case 62:(D=this.cdataHandler)===null||D===void 0||D.call(this,this.text),this.text="",this.state=13;break;case 93:this.text+="]";break;default:this.text+="]]".concat(String.fromCodePoint(L)),this.state=20}}},{key:"sPIFirstChar",value:function(){var D=this.getCodeNorm();this.nameStartCheck(D)?(this.piTarget+=String.fromCodePoint(D),this.state=24):D===T||u(D)?(this.fail("processing instruction without a target."),this.state=D===T?26:25):(this.fail("disallowed character in processing instruction name."),this.piTarget+=String.fromCodePoint(D),this.state=24)}},{key:"sPIRest",value:function(){for(var D=this.chunk,L=this.i;;){var B=this.getCodeNorm();if(B===-1)return void(this.piTarget+=D.slice(L));if(!this.nameCheck(B)){this.piTarget+=D.slice(L,this.prevI);var z=B===T;z||u(B)?this.piTarget==="xml"?(this.xmlDeclPossible||this.fail("an XML declaration must be at the start of the document."),this.state=z?33:27):this.state=z?26:25:(this.fail("disallowed character in processing instruction name."),this.piTarget+=String.fromCodePoint(B));break}}}},{key:"sPIBody",value:function(){if(this.text.length===0){var D=this.getCodeNorm();D===T?this.state=26:u(D)||(this.text=String.fromCodePoint(D))}else this.captureToChar(T)&&(this.state=26)}},{key:"sPIEnding",value:function(){var D,L=this.getCodeNorm();if(L===62){var B=this.piTarget;B.toLowerCase()==="xml"&&this.fail("the XML declaration must appear at the start of the document."),(D=this.piHandler)===null||D===void 0||D.call(this,{target:B,body:this.text}),this.piTarget=this.text="",this.state=13}else L===T?this.text+="?":(this.text+="?".concat(String.fromCodePoint(L)),this.state=25);this.xmlDeclPossible=!1}},{key:"sXMLDeclNameStart",value:function(){var D=this.skipSpaces();D!==T?D!==-1&&(this.state=28,this.name=String.fromCodePoint(D)):this.state=33}},{key:"sXMLDeclName",value:function(){var D=this.captureTo(O);if(D===T)return this.state=33,this.name+=this.text,this.text="",void this.fail("XML declaration is incomplete.");if(u(D)||D===$){if(this.name+=this.text,this.text="",!this.xmlDeclExpects.includes(this.name))switch(this.name.length){case 0:this.fail("did not expect any more name/value pairs.");break;case 1:this.fail("expected the name ".concat(this.xmlDeclExpects[0],"."));break;default:this.fail("expected one of ".concat(this.xmlDeclExpects.join(", ")))}this.state=D===$?30:29}}},{key:"sXMLDeclEq",value:function(){var D=this.getCodeNorm();if(D===T)return this.state=33,void this.fail("XML declaration is incomplete.");u(D)||(D!==$&&this.fail("value required."),this.state=30)}},{key:"sXMLDeclValueStart",value:function(){var D=this.getCodeNorm();if(D===T)return this.state=33,void this.fail("XML declaration is incomplete.");u(D)||(M(D)?this.q=D:(this.fail("value must be quoted."),this.q=32),this.state=31)}},{key:"sXMLDeclValue",value:function(){var D=this.captureTo([this.q,T]);if(D===T)return this.state=33,this.text="",void this.fail("XML declaration is incomplete.");if(D!==-1){var L=this.text;switch(this.text="",this.name){case"version":this.xmlDeclExpects=["encoding","standalone"];var B=L;this.xmlDecl.version=B,/^1\.[0-9]+$/.test(B)?this.opt.forceXMLVersion||this.setXMLVersion(B):this.fail("version number must match /^1\\.[0-9]+$/.");break;case"encoding":/^[A-Za-z][A-Za-z0-9._-]*$/.test(L)||this.fail("encoding value must match /^[A-Za-z0-9][A-Za-z0-9._-]*$/."),this.xmlDeclExpects=["standalone"],this.xmlDecl.encoding=L;break;case"standalone":L!=="yes"&&L!=="no"&&this.fail('standalone value must match "yes" or "no".'),this.xmlDeclExpects=[],this.xmlDecl.standalone=L}this.name="",this.state=32}}},{key:"sXMLDeclSeparator",value:function(){var D=this.getCodeNorm();D!==T?(u(D)||(this.fail("whitespace required."),this.unget()),this.state=27):this.state=33}},{key:"sXMLDeclEnding",value:function(){var D;this.getCodeNorm()===62?(this.piTarget!=="xml"?this.fail("processing instructions are not allowed before root."):this.name!=="version"&&this.xmlDeclExpects.includes("version")&&this.fail("XML declaration must contain a version."),(D=this.xmldeclHandler)===null||D===void 0||D.call(this,this.xmlDecl),this.name="",this.piTarget=this.text="",this.state=13):this.fail("The character ? is disallowed anywhere in XML declarations."),this.xmlDeclPossible=!1}},{key:"sOpenTag",value:function(){var D,L=this.captureNameChars();if(L!==-1){var B=this.tag={name:this.name,attributes:Object.create(null)};switch(this.name="",this.xmlnsOpt&&(this.topNS=B.ns=Object.create(null)),(D=this.openTagStartHandler)===null||D===void 0||D.call(this,B),this.sawRoot=!0,!this.fragmentOpt&&this.closedRoot&&this.fail("documents may contain only one root."),L){case 62:this.openTag();break;case 47:this.state=35;break;default:u(L)||this.fail("disallowed character in tag name."),this.state=36}}}},{key:"sOpenTagSlash",value:function(){this.getCode()===62?this.openSelfClosingTag():(this.fail("forward-slash in opening tag not followed by >."),this.state=36)}},{key:"sAttrib",value:function(){var D=this.skipSpaces();D!==-1&&(c(D)?(this.unget(),this.state=37):D===62?this.openTag():D===47?this.state=35:this.fail("disallowed character in attribute name."))}},{key:"sAttribName",value:function(){var D=this.captureNameChars();D===$?this.state=39:u(D)?this.state=38:D===62?(this.fail("attribute without value."),this.pushAttrib(this.name,this.name),this.name=this.text="",this.openTag()):D!==-1&&this.fail("disallowed character in attribute name.")}},{key:"sAttribNameSawWhite",value:function(){var D=this.skipSpaces();switch(D){case-1:return;case $:this.state=39;break;default:this.fail("attribute without value."),this.text="",this.name="",D===62?this.openTag():c(D)?(this.unget(),this.state=37):(this.fail("disallowed character in attribute name."),this.state=36)}}},{key:"sAttribValue",value:function(){var D=this.getCodeNorm();M(D)?(this.q=D,this.state=40):u(D)||(this.fail("unquoted attribute value."),this.state=42,this.unget())}},{key:"sAttribValueQuoted",value:function(){for(var D=this.q,L=this.chunk,B=this.i;;)switch(this.getCode()){case D:return this.pushAttrib(this.name,this.text+L.slice(B,this.prevI)),this.name=this.text="",this.q=null,void(this.state=41);case 38:return this.text+=L.slice(B,this.prevI),this.state=14,void(this.entityReturnState=40);case 10:case-2:case 9:this.text+="".concat(L.slice(B,this.prevI)," "),B=this.i;break;case 60:return this.text+=L.slice(B,this.prevI),void this.fail("disallowed character.");case-1:return void(this.text+=L.slice(B))}}},{key:"sAttribValueClosed",value:function(){var D=this.getCodeNorm();u(D)?this.state=36:D===62?this.openTag():D===47?this.state=35:c(D)?(this.fail("no whitespace between attributes."),this.unget(),this.state=37):this.fail("disallowed character in attribute name.")}},{key:"sAttribValueUnquoted",value:function(){var D=this.captureTo(x);switch(D){case 38:this.state=14,this.entityReturnState=42;break;case 60:this.fail("disallowed character.");break;case-1:break;default:this.text.includes("]]>")&&this.fail('the string "]]>" is disallowed in char data.'),this.pushAttrib(this.name,this.text),this.name=this.text="",D===62?this.openTag():this.state=36}}},{key:"sCloseTag",value:function(){var D=this.captureNameChars();D===62?this.closeTag():u(D)?this.state=44:D!==-1&&this.fail("disallowed character in closing tag.")}},{key:"sCloseTagSawWhite",value:function(){switch(this.skipSpaces()){case 62:this.closeTag();break;case-1:break;default:this.fail("disallowed character in closing tag.")}}},{key:"handleTextInRoot",value:function(){var D=this.i,L=this.forbiddenState,B=this.chunk,z=this.textHandler;e:for(;;)switch(this.getCode()){case 60:if(this.state=15,z!==void 0){var q=this.text,X=B.slice(D,this.prevI);q.length!==0?(z(q+X),this.text=""):X.length!==0&&z(X)}L=0;break e;case 38:this.state=14,this.entityReturnState=13,z!==void 0&&(this.text+=B.slice(D,this.prevI)),L=0;break e;case 93:switch(L){case 0:L=1;break;case 1:L=2;break;case 2:break;default:throw new Error("impossible state")}break;case 62:L===2&&this.fail('the string "]]>" is disallowed in char data.'),L=0;break;case-2:z!==void 0&&(this.text+="".concat(B.slice(D,this.prevI),`
`)),D=this.i,L=0;break;case-1:z!==void 0&&(this.text+=B.slice(D));break e;default:L=0}this.forbiddenState=L}},{key:"handleTextOutsideRoot",value:function(){var D=this.i,L=this.chunk,B=this.textHandler,z=!1;e:for(;;){var q=this.getCode();switch(q){case 60:if(this.state=15,B!==void 0){var X=this.text,ee=L.slice(D,this.prevI);X.length!==0?(B(X+ee),this.text=""):ee.length!==0&&B(ee)}break e;case 38:this.state=14,this.entityReturnState=13,B!==void 0&&(this.text+=L.slice(D,this.prevI)),z=!0;break e;case-2:B!==void 0&&(this.text+="".concat(L.slice(D,this.prevI),`
`)),D=this.i;break;case-1:B!==void 0&&(this.text+=L.slice(D));break e;default:u(q)||(z=!0)}}z&&(this.sawRoot||this.reportedTextBeforeRoot||(this.fail("text data outside of root node."),this.reportedTextBeforeRoot=!0),this.closedRoot&&!this.reportedTextAfterRoot&&(this.fail("text data outside of root node."),this.reportedTextAfterRoot=!0))}},{key:"pushAttribNS",value:function(D,L){var B,z=this.qname(D),q=z.prefix,X=z.local,ee={name:D,prefix:q,local:X,value:L};if(this.attribList.push(ee),(B=this.attributeHandler)===null||B===void 0||B.call(this,ee),q==="xmlns"){var ye=L.trim();this.currentXMLVersion==="1.0"&&ye===""&&this.fail("invalid attempt to undefine prefix in XML 1.0"),this.topNS[X]=ye,j(this,X,ye)}else if(D==="xmlns"){var de=L.trim();this.topNS[""]=de,j(this,"",de)}}},{key:"pushAttribPlain",value:function(D,L){var B,z={name:D,value:L};this.attribList.push(z),(B=this.attributeHandler)===null||B===void 0||B.call(this,z)}},{key:"end",value:function(){var D,L;this.sawRoot||this.fail("document must contain a root element.");for(var B=this.tags;B.length>0;){var z=B.pop();this.fail("unclosed tag: ".concat(z.name))}this.state!==0&&this.state!==13&&this.fail("unexpected end.");var q=this.text;return q.length!==0&&((D=this.textHandler)===null||D===void 0||D.call(this,q),this.text=""),this._closed=!0,(L=this.endHandler)===null||L===void 0||L.call(this),this._init(),this}},{key:"resolve",value:function(D){var L,B,z=this.topNS[D];if(z!==void 0)return z;for(var q=this.tags,X=q.length-1;X>=0;X--)if((z=q[X].ns[D])!==void 0)return z;return(z=this.ns[D])!==void 0?z:(B=(L=this.opt).resolvePrefix)===null||B===void 0?void 0:B.call(L,D)}},{key:"qname",value:function(D){var L=D.indexOf(":");if(L===-1)return{prefix:"",local:D};var B=D.slice(L+1),z=D.slice(0,L);return(z===""||B===""||B.includes(":"))&&this.fail("malformed name: ".concat(D,".")),{prefix:z,local:B}}},{key:"processAttribsNS",value:function(){var D,L=this.attribList,B=this.tag,z=this.qname(B.name),q=z.prefix,X=z.local;B.prefix=q,B.local=X;var ee=B.uri=(D=this.resolve(q))!==null&&D!==void 0?D:"";if(q!==""&&(q==="xmlns"&&this.fail('tags may not have "xmlns" as prefix.'),ee===""&&(this.fail("unbound namespace prefix: ".concat(JSON.stringify(q),".")),B.uri=q)),L.length!==0){var ye,de=B.attributes,ge=new Set,we=o(L);try{for(we.s();!(ye=we.n()).done;){var be=ye.value,J=be.name,te=be.prefix,ie=be.local,fe=void 0,se=void 0;te===""?(fe=J==="xmlns"?P:"",se=J):((fe=this.resolve(te))===void 0&&(this.fail("unbound namespace prefix: ".concat(JSON.stringify(te),".")),fe=te),se="{".concat(fe,"}").concat(ie)),ge.has(se)&&this.fail("duplicate attribute: ".concat(se,".")),ge.add(se),be.uri=fe,de[J]=be}}catch(oe){we.e(oe)}finally{we.f()}this.attribList=[]}}},{key:"processAttribsPlain",value:function(){var D,L=this.attribList,B=this.tag.attributes,z=o(L);try{for(z.s();!(D=z.n()).done;){var q=D.value,X=q.name,ee=q.value;B[X]!==void 0&&this.fail("duplicate attribute: ".concat(X,".")),B[X]=ee}}catch(ye){z.e(ye)}finally{z.f()}this.attribList=[]}},{key:"openTag",value:function(){var D;this.processAttribs();var L=this.tags,B=this.tag;B.isSelfClosing=!1,(D=this.openTagHandler)===null||D===void 0||D.call(this,B),L.push(B),this.state=13,this.name=""}},{key:"openSelfClosingTag",value:function(){var D,L,B;this.processAttribs();var z=this.tags,q=this.tag;q.isSelfClosing=!0,(D=this.openTagHandler)===null||D===void 0||D.call(this,q),(L=this.closeTagHandler)===null||L===void 0||L.call(this,q),(this.tag=(B=z[z.length-1])!==null&&B!==void 0?B:null)===null&&(this.closedRoot=!0),this.state=13,this.name=""}},{key:"closeTag",value:function(){var D=this.tags,L=this.name;if(this.state=13,this.name="",L==="")return this.fail("weird empty close tag."),void(this.text+="</>");for(var B=this.closeTagHandler,z=D.length;z-- >0;){var q=this.tag=D.pop();if(this.topNS=q.ns,B==null||B(q),q.name===L)break;this.fail("unexpected close tag.")}z===0?this.closedRoot=!0:z<0&&(this.fail("unmatched closing tag: ".concat(L,".")),this.text+="</".concat(L,">"))}},{key:"parseEntity",value:function(D){if(D[0]!=="#"){var L=this.ENTITIES[D];return L!==void 0?L:(this.fail(this.isName(D)?"undefined entity.":"disallowed character in entity name."),"&".concat(D,";"))}var B=NaN;return D[1]==="x"&&/^#x[0-9a-f]+$/i.test(D)?B=parseInt(D.slice(2),16):/^#[0-9]+$/.test(D)&&(B=parseInt(D.slice(1),10)),this.isChar(B)?String.fromCodePoint(B):(this.fail("malformed character entity."),"&".concat(D,";"))}},{key:"closed",get:function(){return this._closed}},{key:"position",get:function(){return this.chunkPosition+this.i}},{key:"columnIndex",get:function(){return this.position-this.positionAtNewLine}}])&&s(Y.prototype,K),U}();i.SaxesParser=W},{"xmlchars/xml/1.0/ed5":541,"xmlchars/xml/1.1/ed2":542,"xmlchars/xmlns/1.0/ed3":543}],497:[function(e,n,i){(function(o){n.exports=typeof o=="function"?o:function(){var a=[].slice.apply(arguments);a.splice(1,0,0),setTimeout.apply(null,a)}}).call(this,e("timers").setImmediate)},{timers:521}],498:[function(e,n,i){var o=e("safe-buffer").Buffer;function a(s,l){this._block=o.alloc(s),this._finalSize=l,this._blockSize=s,this._len=0}a.prototype.update=function(s,l){typeof s=="string"&&(l=l||"utf8",s=o.from(s,l));for(var p=this._block,d=this._blockSize,g=s.length,y=this._len,h=0;h<g;){for(var u=y%d,f=Math.min(g-h,d-u),c=0;c<f;c++)p[u+c]=s[h+c];h+=f,(y+=f)%d==0&&this._update(p)}return this._len+=g,this},a.prototype.digest=function(s){var l=this._len%this._blockSize;this._block[l]=128,this._block.fill(0,l+1),l>=this._finalSize&&(this._update(this._block),this._block.fill(0));var p=8*this._len;if(p<=4294967295)this._block.writeUInt32BE(p,this._blockSize-4);else{var d=(4294967295&p)>>>0,g=(p-d)/4294967296;this._block.writeUInt32BE(g,this._blockSize-8),this._block.writeUInt32BE(d,this._blockSize-4)}this._update(this._block);var y=this._hash();return s?y.toString(s):y},a.prototype._update=function(){throw new Error("_update must be implemented by subclass")},n.exports=a},{"safe-buffer":494}],499:[function(e,n,i){var o=n.exports=function(a){a=a.toLowerCase();var s=o[a];if(!s)throw new Error(a+" is not supported (we accept pull requests)");return new s};o.sha=e("./sha"),o.sha1=e("./sha1"),o.sha224=e("./sha224"),o.sha256=e("./sha256"),o.sha384=e("./sha384"),o.sha512=e("./sha512")},{"./sha":500,"./sha1":501,"./sha224":502,"./sha256":503,"./sha384":504,"./sha512":505}],500:[function(e,n,i){var o=e("inherits"),a=e("./hash"),s=e("safe-buffer").Buffer,l=[1518500249,1859775393,-1894007588,-899497514],p=new Array(80);function d(){this.init(),this._w=p,a.call(this,64,56)}function g(h){return h<<30|h>>>2}function y(h,u,f,c){return h===0?u&f|~u&c:h===2?u&f|u&c|f&c:u^f^c}o(d,a),d.prototype.init=function(){return this._a=1732584193,this._b=4023233417,this._c=2562383102,this._d=271733878,this._e=3285377520,this},d.prototype._update=function(h){for(var u,f=this._w,c=0|this._a,v=0|this._b,m=0|this._c,b=0|this._d,w=0|this._e,_=0;_<16;++_)f[_]=h.readInt32BE(4*_);for(;_<80;++_)f[_]=f[_-3]^f[_-8]^f[_-14]^f[_-16];for(var C=0;C<80;++C){var R=~~(C/20),I=0|((u=c)<<5|u>>>27)+y(R,v,m,b)+w+f[C]+l[R];w=b,b=m,m=g(v),v=c,c=I}this._a=c+this._a|0,this._b=v+this._b|0,this._c=m+this._c|0,this._d=b+this._d|0,this._e=w+this._e|0},d.prototype._hash=function(){var h=s.allocUnsafe(20);return h.writeInt32BE(0|this._a,0),h.writeInt32BE(0|this._b,4),h.writeInt32BE(0|this._c,8),h.writeInt32BE(0|this._d,12),h.writeInt32BE(0|this._e,16),h},n.exports=d},{"./hash":498,inherits:387,"safe-buffer":494}],501:[function(e,n,i){var o=e("inherits"),a=e("./hash"),s=e("safe-buffer").Buffer,l=[1518500249,1859775393,-1894007588,-899497514],p=new Array(80);function d(){this.init(),this._w=p,a.call(this,64,56)}function g(u){return u<<5|u>>>27}function y(u){return u<<30|u>>>2}function h(u,f,c,v){return u===0?f&c|~f&v:u===2?f&c|f&v|c&v:f^c^v}o(d,a),d.prototype.init=function(){return this._a=1732584193,this._b=4023233417,this._c=2562383102,this._d=271733878,this._e=3285377520,this},d.prototype._update=function(u){for(var f,c=this._w,v=0|this._a,m=0|this._b,b=0|this._c,w=0|this._d,_=0|this._e,C=0;C<16;++C)c[C]=u.readInt32BE(4*C);for(;C<80;++C)c[C]=(f=c[C-3]^c[C-8]^c[C-14]^c[C-16])<<1|f>>>31;for(var R=0;R<80;++R){var I=~~(R/20),P=g(v)+h(I,m,b,w)+_+c[R]+l[I]|0;_=w,w=b,b=y(m),m=v,v=P}this._a=v+this._a|0,this._b=m+this._b|0,this._c=b+this._c|0,this._d=w+this._d|0,this._e=_+this._e|0},d.prototype._hash=function(){var u=s.allocUnsafe(20);return u.writeInt32BE(0|this._a,0),u.writeInt32BE(0|this._b,4),u.writeInt32BE(0|this._c,8),u.writeInt32BE(0|this._d,12),u.writeInt32BE(0|this._e,16),u},n.exports=d},{"./hash":498,inherits:387,"safe-buffer":494}],502:[function(e,n,i){var o=e("inherits"),a=e("./sha256"),s=e("./hash"),l=e("safe-buffer").Buffer,p=new Array(64);function d(){this.init(),this._w=p,s.call(this,64,56)}o(d,a),d.prototype.init=function(){return this._a=3238371032,this._b=914150663,this._c=812702999,this._d=4144912697,this._e=4290775857,this._f=1750603025,this._g=1694076839,this._h=3204075428,this},d.prototype._hash=function(){var g=l.allocUnsafe(28);return g.writeInt32BE(this._a,0),g.writeInt32BE(this._b,4),g.writeInt32BE(this._c,8),g.writeInt32BE(this._d,12),g.writeInt32BE(this._e,16),g.writeInt32BE(this._f,20),g.writeInt32BE(this._g,24),g},n.exports=d},{"./hash":498,"./sha256":503,inherits:387,"safe-buffer":494}],503:[function(e,n,i){var o=e("inherits"),a=e("./hash"),s=e("safe-buffer").Buffer,l=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],p=new Array(64);function d(){this.init(),this._w=p,a.call(this,64,56)}function g(c,v,m){return m^c&(v^m)}function y(c,v,m){return c&v|m&(c|v)}function h(c){return(c>>>2|c<<30)^(c>>>13|c<<19)^(c>>>22|c<<10)}function u(c){return(c>>>6|c<<26)^(c>>>11|c<<21)^(c>>>25|c<<7)}function f(c){return(c>>>7|c<<25)^(c>>>18|c<<14)^c>>>3}o(d,a),d.prototype.init=function(){return this._a=1779033703,this._b=3144134277,this._c=1013904242,this._d=2773480762,this._e=1359893119,this._f=2600822924,this._g=528734635,this._h=1541459225,this},d.prototype._update=function(c){for(var v,m=this._w,b=0|this._a,w=0|this._b,_=0|this._c,C=0|this._d,R=0|this._e,I=0|this._f,P=0|this._g,N=0|this._h,A=0;A<16;++A)m[A]=c.readInt32BE(4*A);for(;A<64;++A)m[A]=0|(((v=m[A-2])>>>17|v<<15)^(v>>>19|v<<13)^v>>>10)+m[A-7]+f(m[A-15])+m[A-16];for(var $=0;$<64;++$){var T=N+u(R)+g(R,I,P)+l[$]+m[$]|0,M=h(b)+y(b,w,_)|0;N=P,P=I,I=R,R=C+T|0,C=_,_=w,w=b,b=T+M|0}this._a=b+this._a|0,this._b=w+this._b|0,this._c=_+this._c|0,this._d=C+this._d|0,this._e=R+this._e|0,this._f=I+this._f|0,this._g=P+this._g|0,this._h=N+this._h|0},d.prototype._hash=function(){var c=s.allocUnsafe(32);return c.writeInt32BE(this._a,0),c.writeInt32BE(this._b,4),c.writeInt32BE(this._c,8),c.writeInt32BE(this._d,12),c.writeInt32BE(this._e,16),c.writeInt32BE(this._f,20),c.writeInt32BE(this._g,24),c.writeInt32BE(this._h,28),c},n.exports=d},{"./hash":498,inherits:387,"safe-buffer":494}],504:[function(e,n,i){var o=e("inherits"),a=e("./sha512"),s=e("./hash"),l=e("safe-buffer").Buffer,p=new Array(160);function d(){this.init(),this._w=p,s.call(this,128,112)}o(d,a),d.prototype.init=function(){return this._ah=3418070365,this._bh=1654270250,this._ch=2438529370,this._dh=355462360,this._eh=1731405415,this._fh=2394180231,this._gh=3675008525,this._hh=1203062813,this._al=3238371032,this._bl=914150663,this._cl=812702999,this._dl=4144912697,this._el=4290775857,this._fl=1750603025,this._gl=1694076839,this._hl=3204075428,this},d.prototype._hash=function(){var g=l.allocUnsafe(48);function y(h,u,f){g.writeInt32BE(h,f),g.writeInt32BE(u,f+4)}return y(this._ah,this._al,0),y(this._bh,this._bl,8),y(this._ch,this._cl,16),y(this._dh,this._dl,24),y(this._eh,this._el,32),y(this._fh,this._fl,40),g},n.exports=d},{"./hash":498,"./sha512":505,inherits:387,"safe-buffer":494}],505:[function(e,n,i){var o=e("inherits"),a=e("./hash"),s=e("safe-buffer").Buffer,l=[1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591],p=new Array(160);function d(){this.init(),this._w=p,a.call(this,128,112)}function g(w,_,C){return C^w&(_^C)}function y(w,_,C){return w&_|C&(w|_)}function h(w,_){return(w>>>28|_<<4)^(_>>>2|w<<30)^(_>>>7|w<<25)}function u(w,_){return(w>>>14|_<<18)^(w>>>18|_<<14)^(_>>>9|w<<23)}function f(w,_){return(w>>>1|_<<31)^(w>>>8|_<<24)^w>>>7}function c(w,_){return(w>>>1|_<<31)^(w>>>8|_<<24)^(w>>>7|_<<25)}function v(w,_){return(w>>>19|_<<13)^(_>>>29|w<<3)^w>>>6}function m(w,_){return(w>>>19|_<<13)^(_>>>29|w<<3)^(w>>>6|_<<26)}function b(w,_){return w>>>0<_>>>0?1:0}o(d,a),d.prototype.init=function(){return this._ah=1779033703,this._bh=3144134277,this._ch=1013904242,this._dh=2773480762,this._eh=1359893119,this._fh=2600822924,this._gh=528734635,this._hh=1541459225,this._al=4089235720,this._bl=2227873595,this._cl=4271175723,this._dl=1595750129,this._el=2917565137,this._fl=725511199,this._gl=4215389547,this._hl=327033209,this},d.prototype._update=function(w){for(var _=this._w,C=0|this._ah,R=0|this._bh,I=0|this._ch,P=0|this._dh,N=0|this._eh,A=0|this._fh,$=0|this._gh,T=0|this._hh,M=0|this._al,S=0|this._bl,E=0|this._cl,k=0|this._dl,O=0|this._el,x=0|this._fl,j=0|this._gl,H=0|this._hl,F=0;F<32;F+=2)_[F]=w.readInt32BE(4*F),_[F+1]=w.readInt32BE(4*F+4);for(;F<160;F+=2){var V=_[F-30],W=_[F-30+1],U=f(V,W),Y=c(W,V),K=v(V=_[F-4],W=_[F-4+1]),D=m(W,V),L=_[F-14],B=_[F-14+1],z=_[F-32],q=_[F-32+1],X=Y+B|0,ee=U+L+b(X,Y)|0;ee=(ee=ee+K+b(X=X+D|0,D)|0)+z+b(X=X+q|0,q)|0,_[F]=ee,_[F+1]=X}for(var ye=0;ye<160;ye+=2){ee=_[ye],X=_[ye+1];var de=y(C,R,I),ge=y(M,S,E),we=h(C,M),be=h(M,C),J=u(N,O),te=u(O,N),ie=l[ye],fe=l[ye+1],se=g(N,A,$),oe=g(O,x,j),G=H+te|0,Z=T+J+b(G,H)|0;Z=(Z=(Z=Z+se+b(G=G+oe|0,oe)|0)+ie+b(G=G+fe|0,fe)|0)+ee+b(G=G+X|0,X)|0;var Q=be+ge|0,re=we+de+b(Q,be)|0;T=$,H=j,$=A,j=x,A=N,x=O,N=P+Z+b(O=k+G|0,k)|0,P=I,k=E,I=R,E=S,R=C,S=M,C=Z+re+b(M=G+Q|0,G)|0}this._al=this._al+M|0,this._bl=this._bl+S|0,this._cl=this._cl+E|0,this._dl=this._dl+k|0,this._el=this._el+O|0,this._fl=this._fl+x|0,this._gl=this._gl+j|0,this._hl=this._hl+H|0,this._ah=this._ah+C+b(this._al,M)|0,this._bh=this._bh+R+b(this._bl,S)|0,this._ch=this._ch+I+b(this._cl,E)|0,this._dh=this._dh+P+b(this._dl,k)|0,this._eh=this._eh+N+b(this._el,O)|0,this._fh=this._fh+A+b(this._fl,x)|0,this._gh=this._gh+$+b(this._gl,j)|0,this._hh=this._hh+T+b(this._hl,H)|0},d.prototype._hash=function(){var w=s.allocUnsafe(64);function _(C,R,I){w.writeInt32BE(C,I),w.writeInt32BE(R,I+4)}return _(this._ah,this._al,0),_(this._bh,this._bl,8),_(this._ch,this._cl,16),_(this._dh,this._dl,24),_(this._eh,this._el,32),_(this._fh,this._fl,40),_(this._gh,this._gl,48),_(this._hh,this._hl,56),w},n.exports=d},{"./hash":498,inherits:387,"safe-buffer":494}],506:[function(e,n,i){n.exports=a;var o=e("events").EventEmitter;function a(){o.call(this)}e("inherits")(a,o),a.Readable=e("readable-stream/readable.js"),a.Writable=e("readable-stream/writable.js"),a.Duplex=e("readable-stream/duplex.js"),a.Transform=e("readable-stream/transform.js"),a.PassThrough=e("readable-stream/passthrough.js"),a.Stream=a,a.prototype.pipe=function(s,l){var p=this;function d(v){s.writable&&s.write(v)===!1&&p.pause&&p.pause()}function g(){p.readable&&p.resume&&p.resume()}p.on("data",d),s.on("drain",g),s._isStdio||l&&l.end===!1||(p.on("end",h),p.on("close",u));var y=!1;function h(){y||(y=!0,s.end())}function u(){y||(y=!0,typeof s.destroy=="function"&&s.destroy())}function f(v){if(c(),o.listenerCount(this,"error")===0)throw v}function c(){p.removeListener("data",d),s.removeListener("drain",g),p.removeListener("end",h),p.removeListener("close",u),p.removeListener("error",f),s.removeListener("error",f),p.removeListener("end",c),p.removeListener("close",c),s.removeListener("close",c)}return p.on("error",f),s.on("error",f),p.on("end",c),p.on("close",c),s.on("close",c),s.emit("pipe",p),s}},{events:367,inherits:387,"readable-stream/duplex.js":507,"readable-stream/passthrough.js":516,"readable-stream/readable.js":517,"readable-stream/transform.js":518,"readable-stream/writable.js":519}],507:[function(e,n,i){n.exports=e("./lib/_stream_duplex.js")},{"./lib/_stream_duplex.js":508}],508:[function(e,n,i){var o=e("process-nextick-args"),a=Object.keys||function(c){var v=[];for(var m in c)v.push(m);return v};n.exports=h;var s=Object.create(e("core-util-is"));s.inherits=e("inherits");var l=e("./_stream_readable"),p=e("./_stream_writable");s.inherits(h,l);for(var d=a(p.prototype),g=0;g<d.length;g++){var y=d[g];h.prototype[y]||(h.prototype[y]=p.prototype[y])}function h(c){if(!(this instanceof h))return new h(c);l.call(this,c),p.call(this,c),c&&c.readable===!1&&(this.readable=!1),c&&c.writable===!1&&(this.writable=!1),this.allowHalfOpen=!0,c&&c.allowHalfOpen===!1&&(this.allowHalfOpen=!1),this.once("end",u)}function u(){this.allowHalfOpen||this._writableState.ended||o.nextTick(f,this)}function f(c){c.end()}Object.defineProperty(h.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),Object.defineProperty(h.prototype,"destroyed",{get:function(){return this._readableState!==void 0&&this._writableState!==void 0&&this._readableState.destroyed&&this._writableState.destroyed},set:function(c){this._readableState!==void 0&&this._writableState!==void 0&&(this._readableState.destroyed=c,this._writableState.destroyed=c)}}),h.prototype._destroy=function(c,v){this.push(null),this.end(),o.nextTick(v,c)}},{"./_stream_readable":510,"./_stream_writable":512,"core-util-is":328,inherits:387,"process-nextick-args":466}],509:[function(e,n,i){n.exports=s;var o=e("./_stream_transform"),a=Object.create(e("core-util-is"));function s(l){if(!(this instanceof s))return new s(l);o.call(this,l)}a.inherits=e("inherits"),a.inherits(s,o),s.prototype._transform=function(l,p,d){d(null,l)}},{"./_stream_transform":511,"core-util-is":328,inherits:387}],510:[function(e,n,i){(function(o,a){var s=e("process-nextick-args");n.exports=C;var l,p=e("isarray");C.ReadableState=_,e("events").EventEmitter;var d=function(H,F){return H.listeners(F).length},g=e("./internal/streams/stream"),y=e("safe-buffer").Buffer,h=a.Uint8Array||function(){},u=Object.create(e("core-util-is"));u.inherits=e("inherits");var f=e("util"),c=void 0;c=f&&f.debuglog?f.debuglog("stream"):function(){};var v,m=e("./internal/streams/BufferList"),b=e("./internal/streams/destroy");u.inherits(C,g);var w=["error","close","destroy","pause","resume"];function _(H,F){H=H||{};var V=F instanceof(l=l||e("./_stream_duplex"));this.objectMode=!!H.objectMode,V&&(this.objectMode=this.objectMode||!!H.readableObjectMode);var W=H.highWaterMark,U=H.readableHighWaterMark,Y=this.objectMode?16:16384;this.highWaterMark=W||W===0?W:V&&(U||U===0)?U:Y,this.highWaterMark=Math.floor(this.highWaterMark),this.buffer=new m,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.destroyed=!1,this.defaultEncoding=H.defaultEncoding||"utf8",this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,H.encoding&&(v||(v=e("string_decoder/").StringDecoder),this.decoder=new v(H.encoding),this.encoding=H.encoding)}function C(H){if(l=l||e("./_stream_duplex"),!(this instanceof C))return new C(H);this._readableState=new _(H,this),this.readable=!0,H&&(typeof H.read=="function"&&(this._read=H.read),typeof H.destroy=="function"&&(this._destroy=H.destroy)),g.call(this)}function R(H,F,V,W,U){var Y,K=H._readableState;return F===null?(K.reading=!1,function(D,L){if(!L.ended){if(L.decoder){var B=L.decoder.end();B&&B.length&&(L.buffer.push(B),L.length+=L.objectMode?1:B.length)}L.ended=!0,N(D)}}(H,K)):(U||(Y=function(D,L){var B;z=L,y.isBuffer(z)||z instanceof h||typeof L=="string"||L===void 0||D.objectMode||(B=new TypeError("Invalid non-string/buffer chunk"));var z;return B}(K,F)),Y?H.emit("error",Y):K.objectMode||F&&F.length>0?(typeof F=="string"||K.objectMode||Object.getPrototypeOf(F)===y.prototype||(F=function(D){return y.from(D)}(F)),W?K.endEmitted?H.emit("error",new Error("stream.unshift() after end event")):I(H,K,F,!0):K.ended?H.emit("error",new Error("stream.push() after EOF")):(K.reading=!1,K.decoder&&!V?(F=K.decoder.write(F),K.objectMode||F.length!==0?I(H,K,F,!1):$(H,K)):I(H,K,F,!1))):W||(K.reading=!1)),function(D){return!D.ended&&(D.needReadable||D.length<D.highWaterMark||D.length===0)}(K)}function I(H,F,V,W){F.flowing&&F.length===0&&!F.sync?(H.emit("data",V),H.read(0)):(F.length+=F.objectMode?1:V.length,W?F.buffer.unshift(V):F.buffer.push(V),F.needReadable&&N(H)),$(H,F)}Object.defineProperty(C.prototype,"destroyed",{get:function(){return this._readableState!==void 0&&this._readableState.destroyed},set:function(H){this._readableState&&(this._readableState.destroyed=H)}}),C.prototype.destroy=b.destroy,C.prototype._undestroy=b.undestroy,C.prototype._destroy=function(H,F){this.push(null),F(H)},C.prototype.push=function(H,F){var V,W=this._readableState;return W.objectMode?V=!0:typeof H=="string"&&((F=F||W.defaultEncoding)!==W.encoding&&(H=y.from(H,F),F=""),V=!0),R(this,H,F,!1,V)},C.prototype.unshift=function(H){return R(this,H,null,!0,!1)},C.prototype.isPaused=function(){return this._readableState.flowing===!1},C.prototype.setEncoding=function(H){return v||(v=e("string_decoder/").StringDecoder),this._readableState.decoder=new v(H),this._readableState.encoding=H,this};function P(H,F){return H<=0||F.length===0&&F.ended?0:F.objectMode?1:H!=H?F.flowing&&F.length?F.buffer.head.data.length:F.length:(H>F.highWaterMark&&(F.highWaterMark=function(V){return V>=8388608?V=8388608:(V--,V|=V>>>1,V|=V>>>2,V|=V>>>4,V|=V>>>8,V|=V>>>16,V++),V}(H)),H<=F.length?H:F.ended?F.length:(F.needReadable=!0,0))}function N(H){var F=H._readableState;F.needReadable=!1,F.emittedReadable||(c("emitReadable",F.flowing),F.emittedReadable=!0,F.sync?s.nextTick(A,H):A(H))}function A(H){c("emit readable"),H.emit("readable"),E(H)}function $(H,F){F.readingMore||(F.readingMore=!0,s.nextTick(T,H,F))}function T(H,F){for(var V=F.length;!F.reading&&!F.flowing&&!F.ended&&F.length<F.highWaterMark&&(c("maybeReadMore read 0"),H.read(0),V!==F.length);)V=F.length;F.readingMore=!1}function M(H){c("readable nexttick read 0"),H.read(0)}function S(H,F){F.reading||(c("resume read 0"),H.read(0)),F.resumeScheduled=!1,F.awaitDrain=0,H.emit("resume"),E(H),F.flowing&&!F.reading&&H.read(0)}function E(H){var F=H._readableState;for(c("flow",F.flowing);F.flowing&&H.read()!==null;);}function k(H,F){return F.length===0?null:(F.objectMode?V=F.buffer.shift():!H||H>=F.length?(V=F.decoder?F.buffer.join(""):F.buffer.length===1?F.buffer.head.data:F.buffer.concat(F.length),F.buffer.clear()):V=function(W,U,Y){var K;return W<U.head.data.length?(K=U.head.data.slice(0,W),U.head.data=U.head.data.slice(W)):K=W===U.head.data.length?U.shift():Y?function(D,L){var B=L.head,z=1,q=B.data;for(D-=q.length;B=B.next;){var X=B.data,ee=D>X.length?X.length:D;if(ee===X.length?q+=X:q+=X.slice(0,D),(D-=ee)==0){ee===X.length?(++z,B.next?L.head=B.next:L.head=L.tail=null):(L.head=B,B.data=X.slice(ee));break}++z}return L.length-=z,q}(W,U):function(D,L){var B=y.allocUnsafe(D),z=L.head,q=1;for(z.data.copy(B),D-=z.data.length;z=z.next;){var X=z.data,ee=D>X.length?X.length:D;if(X.copy(B,B.length-D,0,ee),(D-=ee)==0){ee===X.length?(++q,z.next?L.head=z.next:L.head=L.tail=null):(L.head=z,z.data=X.slice(ee));break}++q}return L.length-=q,B}(W,U),K}(H,F.buffer,F.decoder),V);var V}function O(H){var F=H._readableState;if(F.length>0)throw new Error('"endReadable()" called on non-empty stream');F.endEmitted||(F.ended=!0,s.nextTick(x,F,H))}function x(H,F){H.endEmitted||H.length!==0||(H.endEmitted=!0,F.readable=!1,F.emit("end"))}function j(H,F){for(var V=0,W=H.length;V<W;V++)if(H[V]===F)return V;return-1}C.prototype.read=function(H){c("read",H),H=parseInt(H,10);var F=this._readableState,V=H;if(H!==0&&(F.emittedReadable=!1),H===0&&F.needReadable&&(F.length>=F.highWaterMark||F.ended))return c("read: emitReadable",F.length,F.ended),F.length===0&&F.ended?O(this):N(this),null;if((H=P(H,F))===0&&F.ended)return F.length===0&&O(this),null;var W,U=F.needReadable;return c("need readable",U),(F.length===0||F.length-H<F.highWaterMark)&&c("length less than watermark",U=!0),F.ended||F.reading?c("reading or ended",U=!1):U&&(c("do read"),F.reading=!0,F.sync=!0,F.length===0&&(F.needReadable=!0),this._read(F.highWaterMark),F.sync=!1,F.reading||(H=P(V,F))),(W=H>0?k(H,F):null)===null?(F.needReadable=!0,H=0):F.length-=H,F.length===0&&(F.ended||(F.needReadable=!0),V!==H&&F.ended&&O(this)),W!==null&&this.emit("data",W),W},C.prototype._read=function(H){this.emit("error",new Error("_read() is not implemented"))},C.prototype.pipe=function(H,F){var V=this,W=this._readableState;switch(W.pipesCount){case 0:W.pipes=H;break;case 1:W.pipes=[W.pipes,H];break;default:W.pipes.push(H)}W.pipesCount+=1,c("pipe count=%d opts=%j",W.pipesCount,F);var U=(!F||F.end!==!1)&&H!==o.stdout&&H!==o.stderr?K:ye;function Y(de,ge){c("onunpipe"),de===V&&ge&&ge.hasUnpiped===!1&&(ge.hasUnpiped=!0,c("cleanup"),H.removeListener("close",X),H.removeListener("finish",ee),H.removeListener("drain",D),H.removeListener("error",q),H.removeListener("unpipe",Y),V.removeListener("end",K),V.removeListener("end",ye),V.removeListener("data",z),L=!0,!W.awaitDrain||H._writableState&&!H._writableState.needDrain||D())}function K(){c("onend"),H.end()}W.endEmitted?s.nextTick(U):V.once("end",U),H.on("unpipe",Y);var D=function(de){return function(){var ge=de._readableState;c("pipeOnDrain",ge.awaitDrain),ge.awaitDrain&&ge.awaitDrain--,ge.awaitDrain===0&&d(de,"data")&&(ge.flowing=!0,E(de))}}(V);H.on("drain",D);var L=!1,B=!1;function z(de){c("ondata"),B=!1,H.write(de)!==!1||B||((W.pipesCount===1&&W.pipes===H||W.pipesCount>1&&j(W.pipes,H)!==-1)&&!L&&(c("false write response, pause",V._readableState.awaitDrain),V._readableState.awaitDrain++,B=!0),V.pause())}function q(de){c("onerror",de),ye(),H.removeListener("error",q),d(H,"error")===0&&H.emit("error",de)}function X(){H.removeListener("finish",ee),ye()}function ee(){c("onfinish"),H.removeListener("close",X),ye()}function ye(){c("unpipe"),V.unpipe(H)}return V.on("data",z),function(de,ge,we){if(typeof de.prependListener=="function")return de.prependListener(ge,we);de._events&&de._events[ge]?p(de._events[ge])?de._events[ge].unshift(we):de._events[ge]=[we,de._events[ge]]:de.on(ge,we)}(H,"error",q),H.once("close",X),H.once("finish",ee),H.emit("pipe",V),W.flowing||(c("pipe resume"),V.resume()),H},C.prototype.unpipe=function(H){var F=this._readableState,V={hasUnpiped:!1};if(F.pipesCount===0)return this;if(F.pipesCount===1)return H&&H!==F.pipes||(H||(H=F.pipes),F.pipes=null,F.pipesCount=0,F.flowing=!1,H&&H.emit("unpipe",this,V)),this;if(!H){var W=F.pipes,U=F.pipesCount;F.pipes=null,F.pipesCount=0,F.flowing=!1;for(var Y=0;Y<U;Y++)W[Y].emit("unpipe",this,V);return this}var K=j(F.pipes,H);return K===-1||(F.pipes.splice(K,1),F.pipesCount-=1,F.pipesCount===1&&(F.pipes=F.pipes[0]),H.emit("unpipe",this,V)),this},C.prototype.on=function(H,F){var V=g.prototype.on.call(this,H,F);if(H==="data")this._readableState.flowing!==!1&&this.resume();else if(H==="readable"){var W=this._readableState;W.endEmitted||W.readableListening||(W.readableListening=W.needReadable=!0,W.emittedReadable=!1,W.reading?W.length&&N(this):s.nextTick(M,this))}return V},C.prototype.addListener=C.prototype.on,C.prototype.resume=function(){var H=this._readableState;return H.flowing||(c("resume"),H.flowing=!0,function(F,V){V.resumeScheduled||(V.resumeScheduled=!0,s.nextTick(S,F,V))}(this,H)),this},C.prototype.pause=function(){return c("call pause flowing=%j",this._readableState.flowing),this._readableState.flowing!==!1&&(c("pause"),this._readableState.flowing=!1,this.emit("pause")),this},C.prototype.wrap=function(H){var F=this,V=this._readableState,W=!1;for(var U in H.on("end",function(){if(c("wrapped end"),V.decoder&&!V.ended){var K=V.decoder.end();K&&K.length&&F.push(K)}F.push(null)}),H.on("data",function(K){c("wrapped data"),V.decoder&&(K=V.decoder.write(K)),V.objectMode&&K==null||(V.objectMode||K&&K.length)&&(F.push(K)||(W=!0,H.pause()))}),H)this[U]===void 0&&typeof H[U]=="function"&&(this[U]=function(K){return function(){return H[K].apply(H,arguments)}}(U));for(var Y=0;Y<w.length;Y++)H.on(w[Y],this.emit.bind(this,w[Y]));return this._read=function(K){c("wrapped _read",K),W&&(W=!1,H.resume())},this},Object.defineProperty(C.prototype,"readableHighWaterMark",{enumerable:!1,get:function(){return this._readableState.highWaterMark}}),C._fromList=k}).call(this,e("_process"),typeof At!="undefined"?At:typeof self!="undefined"?self:typeof window!="undefined"?window:{})},{"./_stream_duplex":508,"./internal/streams/BufferList":513,"./internal/streams/destroy":514,"./internal/streams/stream":515,_process:467,"core-util-is":328,events:367,inherits:387,isarray:389,"process-nextick-args":466,"safe-buffer":494,"string_decoder/":520,util:185}],511:[function(e,n,i){n.exports=l;var o=e("./_stream_duplex"),a=Object.create(e("core-util-is"));function s(g,y){var h=this._transformState;h.transforming=!1;var u=h.writecb;if(!u)return this.emit("error",new Error("write callback called multiple times"));h.writechunk=null,h.writecb=null,y!=null&&this.push(y),u(g);var f=this._readableState;f.reading=!1,(f.needReadable||f.length<f.highWaterMark)&&this._read(f.highWaterMark)}function l(g){if(!(this instanceof l))return new l(g);o.call(this,g),this._transformState={afterTransform:s.bind(this),needTransform:!1,transforming:!1,writecb:null,writechunk:null,writeencoding:null},this._readableState.needReadable=!0,this._readableState.sync=!1,g&&(typeof g.transform=="function"&&(this._transform=g.transform),typeof g.flush=="function"&&(this._flush=g.flush)),this.on("prefinish",p)}function p(){var g=this;typeof this._flush=="function"?this._flush(function(y,h){d(g,y,h)}):d(this,null,null)}function d(g,y,h){if(y)return g.emit("error",y);if(h!=null&&g.push(h),g._writableState.length)throw new Error("Calling transform done when ws.length != 0");if(g._transformState.transforming)throw new Error("Calling transform done when still transforming");return g.push(null)}a.inherits=e("inherits"),a.inherits(l,o),l.prototype.push=function(g,y){return this._transformState.needTransform=!1,o.prototype.push.call(this,g,y)},l.prototype._transform=function(g,y,h){throw new Error("_transform() is not implemented")},l.prototype._write=function(g,y,h){var u=this._transformState;if(u.writecb=h,u.writechunk=g,u.writeencoding=y,!u.transforming){var f=this._readableState;(u.needTransform||f.needReadable||f.length<f.highWaterMark)&&this._read(f.highWaterMark)}},l.prototype._read=function(g){var y=this._transformState;y.writechunk!==null&&y.writecb&&!y.transforming?(y.transforming=!0,this._transform(y.writechunk,y.writeencoding,y.afterTransform)):y.needTransform=!0},l.prototype._destroy=function(g,y){var h=this;o.prototype._destroy.call(this,g,function(u){y(u),h.emit("close")})}},{"./_stream_duplex":508,"core-util-is":328,inherits:387}],512:[function(e,n,i){(function(o,a,s){var l=e("process-nextick-args");function p($){var T=this;this.next=null,this.entry=null,this.finish=function(){(function(M,S,E){var k=M.entry;for(M.entry=null;k;){var O=k.callback;S.pendingcb--,O(E),k=k.next}S.corkedRequestsFree?S.corkedRequestsFree.next=M:S.corkedRequestsFree=M})(T,$)}}n.exports=_;var d,g=!o.browser&&["v0.10","v0.9."].indexOf(o.version.slice(0,5))>-1?s:l.nextTick;_.WritableState=w;var y=Object.create(e("core-util-is"));y.inherits=e("inherits");var h={deprecate:e("util-deprecate")},u=e("./internal/streams/stream"),f=e("safe-buffer").Buffer,c=a.Uint8Array||function(){},v,m=e("./internal/streams/destroy");function b(){}function w($,T){d=d||e("./_stream_duplex"),$=$||{};var M=T instanceof d;this.objectMode=!!$.objectMode,M&&(this.objectMode=this.objectMode||!!$.writableObjectMode);var S=$.highWaterMark,E=$.writableHighWaterMark,k=this.objectMode?16:16384;this.highWaterMark=S||S===0?S:M&&(E||E===0)?E:k,this.highWaterMark=Math.floor(this.highWaterMark),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;var O=$.decodeStrings===!1;this.decodeStrings=!O,this.defaultEncoding=$.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(x){(function(j,H){var F=j._writableState,V=F.sync,W=F.writecb;if(function(Y){Y.writing=!1,Y.writecb=null,Y.length-=Y.writelen,Y.writelen=0}(F),H)(function(Y,K,D,L,B){--K.pendingcb,D?(l.nextTick(B,L),l.nextTick(A,Y,K),Y._writableState.errorEmitted=!0,Y.emit("error",L)):(B(L),Y._writableState.errorEmitted=!0,Y.emit("error",L),A(Y,K))})(j,F,V,H,W);else{var U=P(F);U||F.corked||F.bufferProcessing||!F.bufferedRequest||I(j,F),V?g(R,j,F,U,W):R(j,F,U,W)}})(T,x)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.bufferedRequestCount=0,this.corkedRequestsFree=new p(this)}function _($){if(d=d||e("./_stream_duplex"),!(v.call(_,this)||this instanceof d))return new _($);this._writableState=new w($,this),this.writable=!0,$&&(typeof $.write=="function"&&(this._write=$.write),typeof $.writev=="function"&&(this._writev=$.writev),typeof $.destroy=="function"&&(this._destroy=$.destroy),typeof $.final=="function"&&(this._final=$.final)),u.call(this)}function C($,T,M,S,E,k,O){T.writelen=S,T.writecb=O,T.writing=!0,T.sync=!0,M?$._writev(E,T.onwrite):$._write(E,k,T.onwrite),T.sync=!1}function R($,T,M,S){M||function(E,k){k.length===0&&k.needDrain&&(k.needDrain=!1,E.emit("drain"))}($,T),T.pendingcb--,S(),A($,T)}function I($,T){T.bufferProcessing=!0;var M=T.bufferedRequest;if($._writev&&M&&M.next){var S=T.bufferedRequestCount,E=new Array(S),k=T.corkedRequestsFree;k.entry=M;for(var O=0,x=!0;M;)E[O]=M,M.isBuf||(x=!1),M=M.next,O+=1;E.allBuffers=x,C($,T,!0,T.length,E,"",k.finish),T.pendingcb++,T.lastBufferedRequest=null,k.next?(T.corkedRequestsFree=k.next,k.next=null):T.corkedRequestsFree=new p(T),T.bufferedRequestCount=0}else{for(;M;){var j=M.chunk,H=M.encoding,F=M.callback;if(C($,T,!1,T.objectMode?1:j.length,j,H,F),M=M.next,T.bufferedRequestCount--,T.writing)break}M===null&&(T.lastBufferedRequest=null)}T.bufferedRequest=M,T.bufferProcessing=!1}function P($){return $.ending&&$.length===0&&$.bufferedRequest===null&&!$.finished&&!$.writing}function N($,T){$._final(function(M){T.pendingcb--,M&&$.emit("error",M),T.prefinished=!0,$.emit("prefinish"),A($,T)})}function A($,T){var M=P(T);return M&&(function(S,E){E.prefinished||E.finalCalled||(typeof S._final=="function"?(E.pendingcb++,E.finalCalled=!0,l.nextTick(N,S,E)):(E.prefinished=!0,S.emit("prefinish")))}($,T),T.pendingcb===0&&(T.finished=!0,$.emit("finish"))),M}y.inherits(_,u),w.prototype.getBuffer=function(){for(var $=this.bufferedRequest,T=[];$;)T.push($),$=$.next;return T},function(){try{Object.defineProperty(w.prototype,"buffer",{get:h.deprecate(function(){return this.getBuffer()},"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.","DEP0003")})}catch{}}(),typeof Symbol=="function"&&Symbol.hasInstance&&typeof Function.prototype[Symbol.hasInstance]=="function"?(v=Function.prototype[Symbol.hasInstance],Object.defineProperty(_,Symbol.hasInstance,{value:function($){return!!v.call(this,$)||this===_&&$&&$._writableState instanceof w}})):v=function($){return $ instanceof this},_.prototype.pipe=function(){this.emit("error",new Error("Cannot pipe, not readable"))},_.prototype.write=function($,T,M){var S,E=this._writableState,k=!1,O=!E.objectMode&&(S=$,f.isBuffer(S)||S instanceof c);return O&&!f.isBuffer($)&&($=function(x){return f.from(x)}($)),typeof T=="function"&&(M=T,T=null),O?T="buffer":T||(T=E.defaultEncoding),typeof M!="function"&&(M=b),E.ended?function(x,j){var H=new Error("write after end");x.emit("error",H),l.nextTick(j,H)}(this,M):(O||function(x,j,H,F){var V=!0,W=!1;return H===null?W=new TypeError("May not write null values to stream"):typeof H=="string"||H===void 0||j.objectMode||(W=new TypeError("Invalid non-string/buffer chunk")),W&&(x.emit("error",W),l.nextTick(F,W),V=!1),V}(this,E,$,M))&&(E.pendingcb++,k=function(x,j,H,F,V,W){if(!H){var U=function(L,B,z){return L.objectMode||L.decodeStrings===!1||typeof B!="string"||(B=f.from(B,z)),B}(j,F,V);F!==U&&(H=!0,V="buffer",F=U)}var Y=j.objectMode?1:F.length;j.length+=Y;var K=j.length<j.highWaterMark;if(K||(j.needDrain=!0),j.writing||j.corked){var D=j.lastBufferedRequest;j.lastBufferedRequest={chunk:F,encoding:V,isBuf:H,callback:W,next:null},D?D.next=j.lastBufferedRequest:j.bufferedRequest=j.lastBufferedRequest,j.bufferedRequestCount+=1}else C(x,j,!1,Y,F,V,W);return K}(this,E,O,$,T,M)),k},_.prototype.cork=function(){this._writableState.corked++},_.prototype.uncork=function(){var $=this._writableState;$.corked&&($.corked--,$.writing||$.corked||$.finished||$.bufferProcessing||!$.bufferedRequest||I(this,$))},_.prototype.setDefaultEncoding=function($){if(typeof $=="string"&&($=$.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf(($+"").toLowerCase())>-1))throw new TypeError("Unknown encoding: "+$);return this._writableState.defaultEncoding=$,this},Object.defineProperty(_.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),_.prototype._write=function($,T,M){M(new Error("_write() is not implemented"))},_.prototype._writev=null,_.prototype.end=function($,T,M){var S=this._writableState;typeof $=="function"?(M=$,$=null,T=null):typeof T=="function"&&(M=T,T=null),$!=null&&this.write($,T),S.corked&&(S.corked=1,this.uncork()),S.ending||S.finished||function(E,k,O){k.ending=!0,A(E,k),O&&(k.finished?l.nextTick(O):E.once("finish",O)),k.ended=!0,E.writable=!1}(this,S,M)},Object.defineProperty(_.prototype,"destroyed",{get:function(){return this._writableState!==void 0&&this._writableState.destroyed},set:function($){this._writableState&&(this._writableState.destroyed=$)}}),_.prototype.destroy=m.destroy,_.prototype._undestroy=m.undestroy,_.prototype._destroy=function($,T){this.end(),T($)}}).call(this,e("_process"),typeof At!="undefined"?At:typeof self!="undefined"?self:typeof window!="undefined"?window:{},e("timers").setImmediate)},{"./_stream_duplex":508,"./internal/streams/destroy":514,"./internal/streams/stream":515,_process:467,"core-util-is":328,inherits:387,"process-nextick-args":466,"safe-buffer":494,timers:521,"util-deprecate":522}],513:[function(e,n,i){var o=e("safe-buffer").Buffer,a=e("util");n.exports=function(){function s(){(function(l,p){if(!(l instanceof p))throw new TypeError("Cannot call a class as a function")})(this,s),this.head=null,this.tail=null,this.length=0}return s.prototype.push=function(l){var p={data:l,next:null};this.length>0?this.tail.next=p:this.head=p,this.tail=p,++this.length},s.prototype.unshift=function(l){var p={data:l,next:this.head};this.length===0&&(this.tail=p),this.head=p,++this.length},s.prototype.shift=function(){if(this.length!==0){var l=this.head.data;return this.length===1?this.head=this.tail=null:this.head=this.head.next,--this.length,l}},s.prototype.clear=function(){this.head=this.tail=null,this.length=0},s.prototype.join=function(l){if(this.length===0)return"";for(var p=this.head,d=""+p.data;p=p.next;)d+=l+p.data;return d},s.prototype.concat=function(l){if(this.length===0)return o.alloc(0);if(this.length===1)return this.head.data;for(var p,d,g,y=o.allocUnsafe(l>>>0),h=this.head,u=0;h;)p=h.data,d=y,g=u,p.copy(d,g),u+=h.data.length,h=h.next;return y},s}(),a&&a.inspect&&a.inspect.custom&&(n.exports.prototype[a.inspect.custom]=function(){var s=a.inspect({length:this.length});return this.constructor.name+" "+s})},{"safe-buffer":494,util:185}],514:[function(e,n,i){var o=e("process-nextick-args");function a(s,l){s.emit("error",l)}n.exports={destroy:function(s,l){var p=this,d=this._readableState&&this._readableState.destroyed,g=this._writableState&&this._writableState.destroyed;return d||g?(l?l(s):!s||this._writableState&&this._writableState.errorEmitted||o.nextTick(a,this,s),this):(this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(s||null,function(y){!l&&y?(o.nextTick(a,p,y),p._writableState&&(p._writableState.errorEmitted=!0)):l&&l(y)}),this)},undestroy:function(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)}}},{"process-nextick-args":466}],515:[function(e,n,i){arguments[4][490][0].apply(i,arguments)},{dup:490,events:367}],516:[function(e,n,i){n.exports=e("./readable").PassThrough},{"./readable":517}],517:[function(e,n,i){(i=n.exports=e("./lib/_stream_readable.js")).Stream=i,i.Readable=i,i.Writable=e("./lib/_stream_writable.js"),i.Duplex=e("./lib/_stream_duplex.js"),i.Transform=e("./lib/_stream_transform.js"),i.PassThrough=e("./lib/_stream_passthrough.js")},{"./lib/_stream_duplex.js":508,"./lib/_stream_passthrough.js":509,"./lib/_stream_readable.js":510,"./lib/_stream_transform.js":511,"./lib/_stream_writable.js":512}],518:[function(e,n,i){n.exports=e("./readable").Transform},{"./readable":517}],519:[function(e,n,i){n.exports=e("./lib/_stream_writable.js")},{"./lib/_stream_writable.js":512}],520:[function(e,n,i){var o=e("safe-buffer").Buffer,a=o.isEncoding||function(c){switch((c=""+c)&&c.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function s(c){var v;switch(this.encoding=function(m){var b=function(w){if(!w)return"utf8";for(var _;;)switch(w){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return w;default:if(_)return;w=(""+w).toLowerCase(),_=!0}}(m);if(typeof b!="string"&&(o.isEncoding===a||!a(m)))throw new Error("Unknown encoding: "+m);return b||m}(c),this.encoding){case"utf16le":this.text=d,this.end=g,v=4;break;case"utf8":this.fillLast=p,v=4;break;case"base64":this.text=y,this.end=h,v=3;break;default:return this.write=u,void(this.end=f)}this.lastNeed=0,this.lastTotal=0,this.lastChar=o.allocUnsafe(v)}function l(c){return c<=127?0:c>>5==6?2:c>>4==14?3:c>>3==30?4:c>>6==2?-1:-2}function p(c){var v=this.lastTotal-this.lastNeed,m=function(b,w,_){if((192&w[0])!=128)return b.lastNeed=0,"\uFFFD";if(b.lastNeed>1&&w.length>1){if((192&w[1])!=128)return b.lastNeed=1,"\uFFFD";if(b.lastNeed>2&&w.length>2&&(192&w[2])!=128)return b.lastNeed=2,"\uFFFD"}}(this,c);return m!==void 0?m:this.lastNeed<=c.length?(c.copy(this.lastChar,v,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal)):(c.copy(this.lastChar,v,0,c.length),void(this.lastNeed-=c.length))}function d(c,v){if((c.length-v)%2==0){var m=c.toString("utf16le",v);if(m){var b=m.charCodeAt(m.length-1);if(b>=55296&&b<=56319)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=c[c.length-2],this.lastChar[1]=c[c.length-1],m.slice(0,-1)}return m}return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=c[c.length-1],c.toString("utf16le",v,c.length-1)}function g(c){var v=c&&c.length?this.write(c):"";if(this.lastNeed){var m=this.lastTotal-this.lastNeed;return v+this.lastChar.toString("utf16le",0,m)}return v}function y(c,v){var m=(c.length-v)%3;return m===0?c.toString("base64",v):(this.lastNeed=3-m,this.lastTotal=3,m===1?this.lastChar[0]=c[c.length-1]:(this.lastChar[0]=c[c.length-2],this.lastChar[1]=c[c.length-1]),c.toString("base64",v,c.length-m))}function h(c){var v=c&&c.length?this.write(c):"";return this.lastNeed?v+this.lastChar.toString("base64",0,3-this.lastNeed):v}function u(c){return c.toString(this.encoding)}function f(c){return c&&c.length?this.write(c):""}i.StringDecoder=s,s.prototype.write=function(c){if(c.length===0)return"";var v,m;if(this.lastNeed){if((v=this.fillLast(c))===void 0)return"";m=this.lastNeed,this.lastNeed=0}else m=0;return m<c.length?v?v+this.text(c,m):this.text(c,m):v||""},s.prototype.end=function(c){var v=c&&c.length?this.write(c):"";return this.lastNeed?v+"\uFFFD":v},s.prototype.text=function(c,v){var m=function(w,_,C){var R=_.length-1;if(R<C)return 0;var I=l(_[R]);return I>=0?(I>0&&(w.lastNeed=I-1),I):--R<C||I===-2?0:(I=l(_[R]))>=0?(I>0&&(w.lastNeed=I-2),I):--R<C||I===-2?0:(I=l(_[R]))>=0?(I>0&&(I===2?I=0:w.lastNeed=I-3),I):0}(this,c,v);if(!this.lastNeed)return c.toString("utf8",v);this.lastTotal=m;var b=c.length-(m-this.lastNeed);return c.copy(this.lastChar,0,b),c.toString("utf8",v,b)},s.prototype.fillLast=function(c){if(this.lastNeed<=c.length)return c.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);c.copy(this.lastChar,this.lastTotal-this.lastNeed,0,c.length),this.lastNeed-=c.length}},{"safe-buffer":494}],521:[function(e,n,i){(function(o,a){var s=e("process/browser.js").nextTick,l=Function.prototype.apply,p=Array.prototype.slice,d={},g=0;function y(h,u){this._id=h,this._clearFn=u}i.setTimeout=function(){return new y(l.call(setTimeout,window,arguments),clearTimeout)},i.setInterval=function(){return new y(l.call(setInterval,window,arguments),clearInterval)},i.clearTimeout=i.clearInterval=function(h){h.close()},y.prototype.unref=y.prototype.ref=function(){},y.prototype.close=function(){this._clearFn.call(window,this._id)},i.enroll=function(h,u){clearTimeout(h._idleTimeoutId),h._idleTimeout=u},i.unenroll=function(h){clearTimeout(h._idleTimeoutId),h._idleTimeout=-1},i._unrefActive=i.active=function(h){clearTimeout(h._idleTimeoutId);var u=h._idleTimeout;u>=0&&(h._idleTimeoutId=setTimeout(function(){h._onTimeout&&h._onTimeout()},u))},i.setImmediate=typeof o=="function"?o:function(h){var u=g++,f=!(arguments.length<2)&&p.call(arguments,1);return d[u]=!0,s(function(){d[u]&&(f?h.apply(null,f):h.call(null),i.clearImmediate(u))}),u},i.clearImmediate=typeof a=="function"?a:function(h){delete d[h]}}).call(this,e("timers").setImmediate,e("timers").clearImmediate)},{"process/browser.js":467,timers:521}],522:[function(e,n,i){(function(o){function a(s){try{if(!o.localStorage)return!1}catch{return!1}var l=o.localStorage[s];return l!=null&&String(l).toLowerCase()==="true"}n.exports=function(s,l){if(a("noDeprecation"))return s;var p=!1;return function(){if(!p){if(a("throwDeprecation"))throw new Error(l);a("traceDeprecation")?console.trace(l):console.warn(l),p=!0}return s.apply(this,arguments)}}}).call(this,typeof At!="undefined"?At:typeof self!="undefined"?self:typeof window!="undefined"?window:{})},{}],523:[function(e,n,i){typeof Object.create=="function"?n.exports=function(o,a){o.super_=a,o.prototype=Object.create(a.prototype,{constructor:{value:o,enumerable:!1,writable:!0,configurable:!0}})}:n.exports=function(o,a){o.super_=a;var s=function(){};s.prototype=a.prototype,o.prototype=new s,o.prototype.constructor=o}},{}],524:[function(e,n,i){function o(a){return(o=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(s){return typeof s}:function(s){return s&&typeof Symbol=="function"&&s.constructor===Symbol&&s!==Symbol.prototype?"symbol":typeof s})(a)}n.exports=function(a){return a&&o(a)==="object"&&typeof a.copy=="function"&&typeof a.fill=="function"&&typeof a.readUInt8=="function"}},{}],525:[function(e,n,i){(function(o,a){function s(k){return(s=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(O){return typeof O}:function(O){return O&&typeof Symbol=="function"&&O.constructor===Symbol&&O!==Symbol.prototype?"symbol":typeof O})(k)}var l=/%[sdj%]/g;i.format=function(k){if(!_(k)){for(var O=[],x=0;x<arguments.length;x++)O.push(g(arguments[x]));return O.join(" ")}x=1;for(var j=arguments,H=j.length,F=String(k).replace(l,function(W){if(W==="%%")return"%";if(x>=H)return W;switch(W){case"%s":return String(j[x++]);case"%d":return Number(j[x++]);case"%j":try{return JSON.stringify(j[x++])}catch{return"[Circular]"}default:return W}}),V=j[x];x<H;V=j[++x])b(V)||!I(V)?F+=" "+V:F+=" "+g(V);return F},i.deprecate=function(k,O){if(C(a.process))return function(){return i.deprecate(k,O).apply(this,arguments)};if(o.noDeprecation===!0)return k;var x=!1;return function(){if(!x){if(o.throwDeprecation)throw new Error(O);o.traceDeprecation?console.trace(O):console.error(O),x=!0}return k.apply(this,arguments)}};var p,d={};function g(k,O){var x={seen:[],stylize:h};return arguments.length>=3&&(x.depth=arguments[2]),arguments.length>=4&&(x.colors=arguments[3]),m(O)?x.showHidden=O:O&&i._extend(x,O),C(x.showHidden)&&(x.showHidden=!1),C(x.depth)&&(x.depth=2),C(x.colors)&&(x.colors=!1),C(x.customInspect)&&(x.customInspect=!0),x.colors&&(x.stylize=y),u(x,k,x.depth)}function y(k,O){var x=g.styles[O];return x?"["+g.colors[x][0]+"m"+k+"["+g.colors[x][1]+"m":k}function h(k,O){return k}function u(k,O,x){if(k.customInspect&&O&&A(O.inspect)&&O.inspect!==i.inspect&&(!O.constructor||O.constructor.prototype!==O)){var j=O.inspect(x,k);return _(j)||(j=u(k,j,x)),j}var H=function(L,B){if(C(B))return L.stylize("undefined","undefined");if(_(B)){var z="'"+JSON.stringify(B).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return L.stylize(z,"string")}if(w(B))return L.stylize(""+B,"number");if(m(B))return L.stylize(""+B,"boolean");if(b(B))return L.stylize("null","null")}(k,O);if(H)return H;var F=Object.keys(O),V=function(L){var B={};return L.forEach(function(z,q){B[z]=!0}),B}(F);if(k.showHidden&&(F=Object.getOwnPropertyNames(O)),N(O)&&(F.indexOf("message")>=0||F.indexOf("description")>=0))return f(O);if(F.length===0){if(A(O)){var W=O.name?": "+O.name:"";return k.stylize("[Function"+W+"]","special")}if(R(O))return k.stylize(RegExp.prototype.toString.call(O),"regexp");if(P(O))return k.stylize(Date.prototype.toString.call(O),"date");if(N(O))return f(O)}var U,Y="",K=!1,D=["{","}"];return v(O)&&(K=!0,D=["[","]"]),A(O)&&(Y=" [Function"+(O.name?": "+O.name:"")+"]"),R(O)&&(Y=" "+RegExp.prototype.toString.call(O)),P(O)&&(Y=" "+Date.prototype.toUTCString.call(O)),N(O)&&(Y=" "+f(O)),F.length!==0||K&&O.length!=0?x<0?R(O)?k.stylize(RegExp.prototype.toString.call(O),"regexp"):k.stylize("[Object]","special"):(k.seen.push(O),U=K?function(L,B,z,q,X){for(var ee=[],ye=0,de=B.length;ye<de;++ye)E(B,String(ye))?ee.push(c(L,B,z,q,String(ye),!0)):ee.push("");return X.forEach(function(ge){ge.match(/^\d+$/)||ee.push(c(L,B,z,q,ge,!0))}),ee}(k,O,x,V,F):F.map(function(L){return c(k,O,x,V,L,K)}),k.seen.pop(),function(L,B,z){return L.reduce(function(q,X){return X.indexOf(`
`)>=0,q+X.replace(/\u001b\[\d\d?m/g,"").length+1},0)>60?z[0]+(B===""?"":B+`
 `)+" "+L.join(`,
  `)+" "+z[1]:z[0]+B+" "+L.join(", ")+" "+z[1]}(U,Y,D)):D[0]+Y+D[1]}function f(k){return"["+Error.prototype.toString.call(k)+"]"}function c(k,O,x,j,H,F){var V,W,U;if((U=Object.getOwnPropertyDescriptor(O,H)||{value:O[H]}).get?W=U.set?k.stylize("[Getter/Setter]","special"):k.stylize("[Getter]","special"):U.set&&(W=k.stylize("[Setter]","special")),E(j,H)||(V="["+H+"]"),W||(k.seen.indexOf(U.value)<0?(W=b(x)?u(k,U.value,null):u(k,U.value,x-1)).indexOf(`
`)>-1&&(W=F?W.split(`
`).map(function(Y){return"  "+Y}).join(`
`).substr(2):`
`+W.split(`
`).map(function(Y){return"   "+Y}).join(`
`)):W=k.stylize("[Circular]","special")),C(V)){if(F&&H.match(/^\d+$/))return W;(V=JSON.stringify(""+H)).match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(V=V.substr(1,V.length-2),V=k.stylize(V,"name")):(V=V.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),V=k.stylize(V,"string"))}return V+": "+W}function v(k){return Array.isArray(k)}function m(k){return typeof k=="boolean"}function b(k){return k===null}function w(k){return typeof k=="number"}function _(k){return typeof k=="string"}function C(k){return k===void 0}function R(k){return I(k)&&$(k)==="[object RegExp]"}function I(k){return s(k)==="object"&&k!==null}function P(k){return I(k)&&$(k)==="[object Date]"}function N(k){return I(k)&&($(k)==="[object Error]"||k instanceof Error)}function A(k){return typeof k=="function"}function $(k){return Object.prototype.toString.call(k)}function T(k){return k<10?"0"+k.toString(10):k.toString(10)}i.debuglog=function(k){if(C(p)&&(p=o.env.NODE_DEBUG||""),k=k.toUpperCase(),!d[k])if(new RegExp("\\b"+k+"\\b","i").test(p)){var O=o.pid;d[k]=function(){var x=i.format.apply(i,arguments);console.error("%s %d: %s",k,O,x)}}else d[k]=function(){};return d[k]},i.inspect=g,g.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},g.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"},i.isArray=v,i.isBoolean=m,i.isNull=b,i.isNullOrUndefined=function(k){return k==null},i.isNumber=w,i.isString=_,i.isSymbol=function(k){return s(k)==="symbol"},i.isUndefined=C,i.isRegExp=R,i.isObject=I,i.isDate=P,i.isError=N,i.isFunction=A,i.isPrimitive=function(k){return k===null||typeof k=="boolean"||typeof k=="number"||typeof k=="string"||s(k)==="symbol"||k===void 0},i.isBuffer=e("./support/isBuffer");var M=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function S(){var k=new Date,O=[T(k.getHours()),T(k.getMinutes()),T(k.getSeconds())].join(":");return[k.getDate(),M[k.getMonth()],O].join(" ")}function E(k,O){return Object.prototype.hasOwnProperty.call(k,O)}i.log=function(){console.log("%s - %s",S(),i.format.apply(i,arguments))},i.inherits=e("inherits"),i._extend=function(k,O){if(!O||!I(O))return k;for(var x=Object.keys(O),j=x.length;j--;)k[x[j]]=O[x[j]];return k}}).call(this,e("_process"),typeof At!="undefined"?At:typeof self!="undefined"?self:typeof window!="undefined"?window:{})},{"./support/isBuffer":524,_process:467,inherits:523}],526:[function(e,n,i){Object.defineProperty(i,"__esModule",{value:!0}),Object.defineProperty(i,"v1",{enumerable:!0,get:function(){return o.default}}),Object.defineProperty(i,"v3",{enumerable:!0,get:function(){return a.default}}),Object.defineProperty(i,"v4",{enumerable:!0,get:function(){return s.default}}),Object.defineProperty(i,"v5",{enumerable:!0,get:function(){return l.default}}),Object.defineProperty(i,"NIL",{enumerable:!0,get:function(){return p.default}}),Object.defineProperty(i,"version",{enumerable:!0,get:function(){return d.default}}),Object.defineProperty(i,"validate",{enumerable:!0,get:function(){return g.default}}),Object.defineProperty(i,"stringify",{enumerable:!0,get:function(){return y.default}}),Object.defineProperty(i,"parse",{enumerable:!0,get:function(){return h.default}});var o=u(e("./v1.js")),a=u(e("./v3.js")),s=u(e("./v4.js")),l=u(e("./v5.js")),p=u(e("./nil.js")),d=u(e("./version.js")),g=u(e("./validate.js")),y=u(e("./stringify.js")),h=u(e("./parse.js"));function u(f){return f&&f.__esModule?f:{default:f}}},{"./nil.js":528,"./parse.js":529,"./stringify.js":533,"./v1.js":534,"./v3.js":535,"./v4.js":537,"./v5.js":538,"./validate.js":539,"./version.js":540}],527:[function(e,n,i){function o(h){return 14+(h+64>>>9<<4)+1}function a(h,u){var f=(65535&h)+(65535&u);return(h>>16)+(u>>16)+(f>>16)<<16|65535&f}function s(h,u,f,c,v,m){return a((b=a(a(u,h),a(c,m)))<<(w=v)|b>>>32-w,f);var b,w}function l(h,u,f,c,v,m,b){return s(u&f|~u&c,h,u,v,m,b)}function p(h,u,f,c,v,m,b){return s(u&c|f&~c,h,u,v,m,b)}function d(h,u,f,c,v,m,b){return s(u^f^c,h,u,v,m,b)}function g(h,u,f,c,v,m,b){return s(f^(u|~c),h,u,v,m,b)}Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var y=function(h){if(typeof h=="string"){var u=unescape(encodeURIComponent(h));h=new Uint8Array(u.length);for(var f=0;f<u.length;++f)h[f]=u.charCodeAt(f)}return function(c){for(var v=[],m=32*c.length,b=0;b<m;b+=8){var w=c[b>>5]>>>b%32&255,_=parseInt("0123456789abcdef".charAt(w>>>4&15)+"0123456789abcdef".charAt(15&w),16);v.push(_)}return v}(function(c,v){c[v>>5]|=128<<v%32,c[o(v)-1]=v;for(var m=1732584193,b=-271733879,w=-1732584194,_=271733878,C=0;C<c.length;C+=16){var R=m,I=b,P=w,N=_;m=l(m,b,w,_,c[C],7,-680876936),_=l(_,m,b,w,c[C+1],12,-389564586),w=l(w,_,m,b,c[C+2],17,606105819),b=l(b,w,_,m,c[C+3],22,-1044525330),m=l(m,b,w,_,c[C+4],7,-176418897),_=l(_,m,b,w,c[C+5],12,1200080426),w=l(w,_,m,b,c[C+6],17,-1473231341),b=l(b,w,_,m,c[C+7],22,-45705983),m=l(m,b,w,_,c[C+8],7,1770035416),_=l(_,m,b,w,c[C+9],12,-1958414417),w=l(w,_,m,b,c[C+10],17,-42063),b=l(b,w,_,m,c[C+11],22,-1990404162),m=l(m,b,w,_,c[C+12],7,1804603682),_=l(_,m,b,w,c[C+13],12,-40341101),w=l(w,_,m,b,c[C+14],17,-1502002290),b=l(b,w,_,m,c[C+15],22,1236535329),m=p(m,b,w,_,c[C+1],5,-165796510),_=p(_,m,b,w,c[C+6],9,-1069501632),w=p(w,_,m,b,c[C+11],14,643717713),b=p(b,w,_,m,c[C],20,-373897302),m=p(m,b,w,_,c[C+5],5,-701558691),_=p(_,m,b,w,c[C+10],9,38016083),w=p(w,_,m,b,c[C+15],14,-660478335),b=p(b,w,_,m,c[C+4],20,-405537848),m=p(m,b,w,_,c[C+9],5,568446438),_=p(_,m,b,w,c[C+14],9,-1019803690),w=p(w,_,m,b,c[C+3],14,-187363961),b=p(b,w,_,m,c[C+8],20,1163531501),m=p(m,b,w,_,c[C+13],5,-1444681467),_=p(_,m,b,w,c[C+2],9,-51403784),w=p(w,_,m,b,c[C+7],14,1735328473),b=p(b,w,_,m,c[C+12],20,-1926607734),m=d(m,b,w,_,c[C+5],4,-378558),_=d(_,m,b,w,c[C+8],11,-2022574463),w=d(w,_,m,b,c[C+11],16,1839030562),b=d(b,w,_,m,c[C+14],23,-35309556),m=d(m,b,w,_,c[C+1],4,-1530992060),_=d(_,m,b,w,c[C+4],11,1272893353),w=d(w,_,m,b,c[C+7],16,-155497632),b=d(b,w,_,m,c[C+10],23,-1094730640),m=d(m,b,w,_,c[C+13],4,681279174),_=d(_,m,b,w,c[C],11,-358537222),w=d(w,_,m,b,c[C+3],16,-722521979),b=d(b,w,_,m,c[C+6],23,76029189),m=d(m,b,w,_,c[C+9],4,-640364487),_=d(_,m,b,w,c[C+12],11,-421815835),w=d(w,_,m,b,c[C+15],16,530742520),b=d(b,w,_,m,c[C+2],23,-995338651),m=g(m,b,w,_,c[C],6,-198630844),_=g(_,m,b,w,c[C+7],10,1126891415),w=g(w,_,m,b,c[C+14],15,-1416354905),b=g(b,w,_,m,c[C+5],21,-57434055),m=g(m,b,w,_,c[C+12],6,1700485571),_=g(_,m,b,w,c[C+3],10,-1894986606),w=g(w,_,m,b,c[C+10],15,-1051523),b=g(b,w,_,m,c[C+1],21,-2054922799),m=g(m,b,w,_,c[C+8],6,1873313359),_=g(_,m,b,w,c[C+15],10,-30611744),w=g(w,_,m,b,c[C+6],15,-1560198380),b=g(b,w,_,m,c[C+13],21,1309151649),m=g(m,b,w,_,c[C+4],6,-145523070),_=g(_,m,b,w,c[C+11],10,-1120210379),w=g(w,_,m,b,c[C+2],15,718787259),b=g(b,w,_,m,c[C+9],21,-343485551),m=a(m,R),b=a(b,I),w=a(w,P),_=a(_,N)}return[m,b,w,_]}(function(c){if(c.length===0)return[];for(var v=8*c.length,m=new Uint32Array(o(v)),b=0;b<v;b+=8)m[b>>5]|=(255&c[b/8])<<b%32;return m}(h),8*h.length))};i.default=y},{}],528:[function(e,n,i){Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0,i.default="00000000-0000-0000-0000-000000000000"},{}],529:[function(e,n,i){Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var o,a=(o=e("./validate.js"))&&o.__esModule?o:{default:o},s=function(l){if(!(0,a.default)(l))throw TypeError("Invalid UUID");var p,d=new Uint8Array(16);return d[0]=(p=parseInt(l.slice(0,8),16))>>>24,d[1]=p>>>16&255,d[2]=p>>>8&255,d[3]=255&p,d[4]=(p=parseInt(l.slice(9,13),16))>>>8,d[5]=255&p,d[6]=(p=parseInt(l.slice(14,18),16))>>>8,d[7]=255&p,d[8]=(p=parseInt(l.slice(19,23),16))>>>8,d[9]=255&p,d[10]=(p=parseInt(l.slice(24,36),16))/1099511627776&255,d[11]=p/4294967296&255,d[12]=p>>>24&255,d[13]=p>>>16&255,d[14]=p>>>8&255,d[15]=255&p,d};i.default=s},{"./validate.js":539}],530:[function(e,n,i){Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0,i.default=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i},{}],531:[function(e,n,i){Object.defineProperty(i,"__esModule",{value:!0}),i.default=function(){if(!o)throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return o(a)};var o=typeof crypto!="undefined"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||typeof msCrypto!="undefined"&&typeof msCrypto.getRandomValues=="function"&&msCrypto.getRandomValues.bind(msCrypto),a=new Uint8Array(16)},{}],532:[function(e,n,i){function o(l,p,d,g){switch(l){case 0:return p&d^~p&g;case 1:return p^d^g;case 2:return p&d^p&g^d&g;case 3:return p^d^g}}function a(l,p){return l<<p|l>>>32-p}Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var s=function(l){var p=[1518500249,1859775393,2400959708,3395469782],d=[1732584193,4023233417,2562383102,271733878,3285377520];if(typeof l=="string"){var g=unescape(encodeURIComponent(l));l=[];for(var y=0;y<g.length;++y)l.push(g.charCodeAt(y))}else Array.isArray(l)||(l=Array.prototype.slice.call(l));l.push(128);for(var h=l.length/4+2,u=Math.ceil(h/16),f=new Array(u),c=0;c<u;++c){for(var v=new Uint32Array(16),m=0;m<16;++m)v[m]=l[64*c+4*m]<<24|l[64*c+4*m+1]<<16|l[64*c+4*m+2]<<8|l[64*c+4*m+3];f[c]=v}f[u-1][14]=8*(l.length-1)/Math.pow(2,32),f[u-1][14]=Math.floor(f[u-1][14]),f[u-1][15]=8*(l.length-1)&4294967295;for(var b=0;b<u;++b){for(var w=new Uint32Array(80),_=0;_<16;++_)w[_]=f[b][_];for(var C=16;C<80;++C)w[C]=a(w[C-3]^w[C-8]^w[C-14]^w[C-16],1);for(var R=d[0],I=d[1],P=d[2],N=d[3],A=d[4],$=0;$<80;++$){var T=Math.floor($/20),M=a(R,5)+o(T,I,P,N)+A+p[T]+w[$]>>>0;A=N,N=P,P=a(I,30)>>>0,I=R,R=M}d[0]=d[0]+R>>>0,d[1]=d[1]+I>>>0,d[2]=d[2]+P>>>0,d[3]=d[3]+N>>>0,d[4]=d[4]+A>>>0}return[d[0]>>24&255,d[0]>>16&255,d[0]>>8&255,255&d[0],d[1]>>24&255,d[1]>>16&255,d[1]>>8&255,255&d[1],d[2]>>24&255,d[2]>>16&255,d[2]>>8&255,255&d[2],d[3]>>24&255,d[3]>>16&255,d[3]>>8&255,255&d[3],d[4]>>24&255,d[4]>>16&255,d[4]>>8&255,255&d[4]]};i.default=s},{}],533:[function(e,n,i){Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;for(var o,a=(o=e("./validate.js"))&&o.__esModule?o:{default:o},s=[],l=0;l<256;++l)s.push((l+256).toString(16).substr(1));var p=function(d){var g=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,y=(s[d[g+0]]+s[d[g+1]]+s[d[g+2]]+s[d[g+3]]+"-"+s[d[g+4]]+s[d[g+5]]+"-"+s[d[g+6]]+s[d[g+7]]+"-"+s[d[g+8]]+s[d[g+9]]+"-"+s[d[g+10]]+s[d[g+11]]+s[d[g+12]]+s[d[g+13]]+s[d[g+14]]+s[d[g+15]]).toLowerCase();if(!(0,a.default)(y))throw TypeError("Stringified UUID is invalid");return y};i.default=p},{"./validate.js":539}],534:[function(e,n,i){Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var o,a,s=p(e("./rng.js")),l=p(e("./stringify.js"));function p(h){return h&&h.__esModule?h:{default:h}}var d=0,g=0,y=function(h,u,f){var c=u&&f||0,v=u||new Array(16),m=(h=h||{}).node||o,b=h.clockseq!==void 0?h.clockseq:a;if(m==null||b==null){var w=h.random||(h.rng||s.default)();m==null&&(m=o=[1|w[0],w[1],w[2],w[3],w[4],w[5]]),b==null&&(b=a=16383&(w[6]<<8|w[7]))}var _=h.msecs!==void 0?h.msecs:Date.now(),C=h.nsecs!==void 0?h.nsecs:g+1,R=_-d+(C-g)/1e4;if(R<0&&h.clockseq===void 0&&(b=b+1&16383),(R<0||_>d)&&h.nsecs===void 0&&(C=0),C>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");d=_,g=C,a=b;var I=(1e4*(268435455&(_+=122192928e5))+C)%4294967296;v[c++]=I>>>24&255,v[c++]=I>>>16&255,v[c++]=I>>>8&255,v[c++]=255&I;var P=_/4294967296*1e4&268435455;v[c++]=P>>>8&255,v[c++]=255&P,v[c++]=P>>>24&15|16,v[c++]=P>>>16&255,v[c++]=b>>>8|128,v[c++]=255&b;for(var N=0;N<6;++N)v[c+N]=m[N];return u||(0,l.default)(v)};i.default=y},{"./rng.js":531,"./stringify.js":533}],535:[function(e,n,i){Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var o=s(e("./v35.js")),a=s(e("./md5.js"));function s(p){return p&&p.__esModule?p:{default:p}}var l=(0,o.default)("v3",48,a.default);i.default=l},{"./md5.js":527,"./v35.js":536}],536:[function(e,n,i){Object.defineProperty(i,"__esModule",{value:!0}),i.default=function(d,g,y){function h(u,f,c,v){if(typeof u=="string"&&(u=function(w){w=unescape(encodeURIComponent(w));for(var _=[],C=0;C<w.length;++C)_.push(w.charCodeAt(C));return _}(u)),typeof f=="string"&&(f=(0,a.default)(f)),f.length!==16)throw TypeError("Namespace must be array-like (16 iterable integer values, 0-255)");var m=new Uint8Array(16+u.length);if(m.set(f),m.set(u,f.length),(m=y(m))[6]=15&m[6]|g,m[8]=63&m[8]|128,c){v=v||0;for(var b=0;b<16;++b)c[v+b]=m[b];return c}return(0,o.default)(m)}try{h.name=d}catch{}return h.DNS=l,h.URL=p,h},i.URL=i.DNS=void 0;var o=s(e("./stringify.js")),a=s(e("./parse.js"));function s(d){return d&&d.__esModule?d:{default:d}}var l="6ba7b810-9dad-11d1-80b4-00c04fd430c8";i.DNS=l;var p="6ba7b811-9dad-11d1-80b4-00c04fd430c8";i.URL=p},{"./parse.js":529,"./stringify.js":533}],537:[function(e,n,i){Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var o=s(e("./rng.js")),a=s(e("./stringify.js"));function s(p){return p&&p.__esModule?p:{default:p}}var l=function(p,d,g){var y=(p=p||{}).random||(p.rng||o.default)();if(y[6]=15&y[6]|64,y[8]=63&y[8]|128,d){g=g||0;for(var h=0;h<16;++h)d[g+h]=y[h];return d}return(0,a.default)(y)};i.default=l},{"./rng.js":531,"./stringify.js":533}],538:[function(e,n,i){Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var o=s(e("./v35.js")),a=s(e("./sha1.js"));function s(p){return p&&p.__esModule?p:{default:p}}var l=(0,o.default)("v5",80,a.default);i.default=l},{"./sha1.js":532,"./v35.js":536}],539:[function(e,n,i){Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var o,a=(o=e("./regex.js"))&&o.__esModule?o:{default:o},s=function(l){return typeof l=="string"&&a.default.test(l)};i.default=s},{"./regex.js":530}],540:[function(e,n,i){Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var o,a=(o=e("./validate.js"))&&o.__esModule?o:{default:o},s=function(l){if(!(0,a.default)(l))throw TypeError("Invalid UUID");return parseInt(l.substr(14,1),16)};i.default=s},{"./validate.js":539}],541:[function(e,n,i){/**
* Character classes and associated utilities for the 5th edition of XML 1.0.
*
* @author Louis-Dominique Dubeau
* @license MIT
* @copyright Louis-Dominique Dubeau
*/Object.defineProperty(i,"__esModule",{value:!0}),i.CHAR=`	
\r -\uD7FF\uE000-\uFFFD\u{10000}-\u{10FFFF}`,i.S=` 	\r
`,i.NAME_START_CHAR=":A-Z_a-z\xC0-\xD6\xD8-\xF6\xF8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\u{10000}-\u{EFFFF}",i.NAME_CHAR="-"+i.NAME_START_CHAR+".0-9\xB7\u0300-\u036F\u203F-\u2040",i.CHAR_RE=new RegExp("^["+i.CHAR+"]$","u"),i.S_RE=new RegExp("^["+i.S+"]+$","u"),i.NAME_START_CHAR_RE=new RegExp("^["+i.NAME_START_CHAR+"]$","u"),i.NAME_CHAR_RE=new RegExp("^["+i.NAME_CHAR+"]$","u"),i.NAME_RE=new RegExp("^["+i.NAME_START_CHAR+"]["+i.NAME_CHAR+"]*$","u"),i.NMTOKEN_RE=new RegExp("^["+i.NAME_CHAR+"]+$","u");function o(a){return a>=65&&a<=90||a>=97&&a<=122||a===58||a===95||a===8204||a===8205||a>=192&&a<=214||a>=216&&a<=246||a>=248&&a<=767||a>=880&&a<=893||a>=895&&a<=8191||a>=8304&&a<=8591||a>=11264&&a<=12271||a>=12289&&a<=55295||a>=63744&&a<=64975||a>=65008&&a<=65533||a>=65536&&a<=983039}i.S_LIST=[32,10,13,9],i.isChar=function(a){return a>=32&&a<=55295||a===10||a===13||a===9||a>=57344&&a<=65533||a>=65536&&a<=1114111},i.isS=function(a){return a===32||a===10||a===13||a===9},i.isNameStartChar=o,i.isNameChar=function(a){return o(a)||a>=48&&a<=57||a===45||a===46||a===183||a>=768&&a<=879||a>=8255&&a<=8256}},{}],542:[function(e,n,i){/**
* Character classes and associated utilities for the 2nd edition of XML 1.1.
*
* @author Louis-Dominique Dubeau
* @license MIT
* @copyright Louis-Dominique Dubeau
*/Object.defineProperty(i,"__esModule",{value:!0}),i.CHAR="-\uD7FF\uE000-\uFFFD\u{10000}-\u{10FFFF}",i.RESTRICTED_CHAR="-\b\v\f-\x7F-\x84\x86-\x9F",i.S=` 	\r
`,i.NAME_START_CHAR=":A-Z_a-z\xC0-\xD6\xD8-\xF6\xF8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\u{10000}-\u{EFFFF}",i.NAME_CHAR="-"+i.NAME_START_CHAR+".0-9\xB7\u0300-\u036F\u203F-\u2040",i.CHAR_RE=new RegExp("^["+i.CHAR+"]$","u"),i.RESTRICTED_CHAR_RE=new RegExp("^["+i.RESTRICTED_CHAR+"]$","u"),i.S_RE=new RegExp("^["+i.S+"]+$","u"),i.NAME_START_CHAR_RE=new RegExp("^["+i.NAME_START_CHAR+"]$","u"),i.NAME_CHAR_RE=new RegExp("^["+i.NAME_CHAR+"]$","u"),i.NAME_RE=new RegExp("^["+i.NAME_START_CHAR+"]["+i.NAME_CHAR+"]*$","u"),i.NMTOKEN_RE=new RegExp("^["+i.NAME_CHAR+"]+$","u");function o(a){return a>=65&&a<=90||a>=97&&a<=122||a===58||a===95||a===8204||a===8205||a>=192&&a<=214||a>=216&&a<=246||a>=248&&a<=767||a>=880&&a<=893||a>=895&&a<=8191||a>=8304&&a<=8591||a>=11264&&a<=12271||a>=12289&&a<=55295||a>=63744&&a<=64975||a>=65008&&a<=65533||a>=65536&&a<=983039}i.S_LIST=[32,10,13,9],i.isChar=function(a){return a>=1&&a<=55295||a>=57344&&a<=65533||a>=65536&&a<=1114111},i.isRestrictedChar=function(a){return a>=1&&a<=8||a===11||a===12||a>=14&&a<=31||a>=127&&a<=132||a>=134&&a<=159},i.isCharAndNotRestricted=function(a){return a===9||a===10||a===13||a>31&&a<127||a===133||a>159&&a<=55295||a>=57344&&a<=65533||a>=65536&&a<=1114111},i.isS=function(a){return a===32||a===10||a===13||a===9},i.isNameStartChar=o,i.isNameChar=function(a){return o(a)||a>=48&&a<=57||a===45||a===46||a===183||a>=768&&a<=879||a>=8255&&a<=8256}},{}],543:[function(e,n,i){/**
* Character class utilities for XML NS 1.0 edition 3.
*
* @author Louis-Dominique Dubeau
* @license MIT
* @copyright Louis-Dominique Dubeau
*/function o(a){return a>=65&&a<=90||a===95||a>=97&&a<=122||a>=192&&a<=214||a>=216&&a<=246||a>=248&&a<=767||a>=880&&a<=893||a>=895&&a<=8191||a>=8204&&a<=8205||a>=8304&&a<=8591||a>=11264&&a<=12271||a>=12289&&a<=55295||a>=63744&&a<=64975||a>=65008&&a<=65533||a>=65536&&a<=983039}Object.defineProperty(i,"__esModule",{value:!0}),i.NC_NAME_START_CHAR="A-Z_a-z\xC0-\xD6\xD8-\xF6\xF8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\u{10000}-\u{EFFFF}",i.NC_NAME_CHAR="-"+i.NC_NAME_START_CHAR+".0-9\xB7\u0300-\u036F\u203F-\u2040",i.NC_NAME_START_CHAR_RE=new RegExp("^["+i.NC_NAME_START_CHAR+"]$","u"),i.NC_NAME_CHAR_RE=new RegExp("^["+i.NC_NAME_CHAR+"]$","u"),i.NC_NAME_RE=new RegExp("^["+i.NC_NAME_START_CHAR+"]["+i.NC_NAME_CHAR+"]*$","u"),i.isNCNameStartChar=o,i.isNCNameChar=function(a){return o(a)||a===45||a===46||a>=48&&a<=57||a===183||a>=768&&a<=879||a>=8255&&a<=8256}},{}]},{},[15])(15)})})(VD);var g6e=WD(VD.exports);export{g6e as E,yt as H};
